```{python}
#| echo: false
import sys
import os

# Quarto executes from project root (execute-dir: project in _book.yml)

appendix_path = os.path.join(os.getcwd(), 'brain', 'book', 'appendix')
if appendix_path not in sys.path:
    sys.path.insert(0, appendix_path)

from economic_parameters import *
```

```{python}
#| echo: false
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path
import sys

# Find project root dynamically

project_root = Path.cwd()
if project_root.name != 'decentralized-institutes-of-health':
    while project_root.name != 'decentralized-institutes-of-health' and project_root.parent != project_root:
        project_root = project_root.parent

# Add paths

sys.path.insert(0, str(project_root / 'brain' / 'book' / 'appendix'))
sys.path.insert(0, str(project_root / 'dih-economic-models' / 'figures'))

from economic_parameters import calculate_personal_lifetime_wealth_disease_eradication
from _chart_style import (
    setup_chart_style, add_watermark, clean_spines, add_png_metadata,
    COLOR_BLACK, COLOR_WHITE, PATTERN_DIAGONAL, PATTERN_HORIZONTAL,
    PATTERN_CROSS, PATTERN_DOTS, get_project_root
)

setup_chart_style()

# Calculate for base case using Disease Eradication Model: Age 30, $50K income, 1% Treaty, 20-year scenario

calc = calculate_personal_lifetime_wealth_disease_eradication(
    treaty_pct=0.01,
    current_age=30,
    annual_income=50000,
    years_elapsed=20,  # 20-year scenario (72yr life extension)
    discount_rate=0.03
)

# Extract components

total = calc['total_lifetime_benefit']
components = [
    (f"Extended\nEarnings\n${calc['npv_breakdown']['extended_earnings']/1000000:.1f}M ({calc['npv_breakdown']['extended_earnings']/total*100:.0f}%)",
     calc['npv_breakdown']['extended_earnings']),
    (f"Economic\nGrowth\n(Milâ†’Res)\n${calc['npv_breakdown']['gdp_boost_benefit']/1000000:.1f}M ({calc['npv_breakdown']['gdp_boost_benefit']/total*100:.0f}%)",
     calc['npv_breakdown']['gdp_boost_benefit']),
    (f"Productivity\nGains\n${calc['npv_breakdown']['productivity_gains_total']/1000:.0f}K ({calc['npv_breakdown']['productivity_gains_total']/total*100:.0f}%)",
     calc['npv_breakdown']['productivity_gains_total']),
    (f"Healthcare\nSavings\n${calc['npv_breakdown']['healthcare_savings_total']/1000:.0f}K ({calc['npv_breakdown']['healthcare_savings_total']/total*100:.0f}%)",
     calc['npv_breakdown']['healthcare_savings_total']),
    (f"Caregiver\nSavings\n${calc['npv_breakdown']['caregiver_savings_total']/1000:.0f}K ({calc['npv_breakdown']['caregiver_savings_total']/total*100:.0f}%)",
     calc['npv_breakdown']['caregiver_savings_total']),
]

labels = [c[0] for c in components]
sizes = [c[1] for c in components]

# Use patterns for distinction

patterns = [PATTERN_DIAGONAL, None, PATTERN_HORIZONTAL, PATTERN_CROSS, PATTERN_DOTS]

# Create figure

fig, ax = plt.subplots(figsize=(10, 8))

# Create pie chart with white fills and patterns

wedges, texts = ax.pie(sizes, labels=labels, startangle=90,
                        counterclock=False,
                        wedgeprops={'edgecolor': COLOR_BLACK, 'linewidth': 2},
                        textprops={'fontsize': 11, 'weight': 'bold'})

# Apply patterns to wedges (white fill with black outline)

for i, wedge in enumerate(wedges):
    wedge.set_facecolor(COLOR_WHITE)
    wedge.set_hatch(patterns[i])
    if patterns[i]:
        wedge.set_hatch(patterns[i] * 3)  # Denser pattern

# Add title

ax.set_title('Where Does the $4.3M Come From?\nDisease Eradication Model Component Breakdown\n(Age 30, $50K Income, 1% Treaty, 20yr scenario)',
             fontsize=32, weight='bold', pad=20)

# Add watermark

add_watermark(fig)

# Equal aspect ratio ensures circle

ax.axis('equal')

# Save figure

output_dir = get_project_root() / 'brain' / 'figures'
output_dir.mkdir(parents=True, exist_ok=True)
output_path = output_dir / 'disease-eradication-lifetime-wealth-component-breakdown-pie-chart.png'

plt.savefig(output_path, dpi=200, bbox_inches=None, facecolor=COLOR_WHITE)

# Add metadata

add_png_metadata(
    output_path,
    title="Personal Lifetime Wealth Component Breakdown (Disease Eradication Model)",
    description="Pie chart showing component breakdown with 72-year life extension"
)

plt.show()
```

*Uses Disease Eradication Model (20-year scenario, 72yr life extension). Base case: Age 30, $50K income, 1% treaty. Each slice shows component amount and percentage of $4.3M total.*