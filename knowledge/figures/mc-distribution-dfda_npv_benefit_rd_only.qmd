```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: NPV of dFDA Benefits (R&D Only, 10-Year Discounted) (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)

setup_chart_style()

# Simulation results
samples = [273848500912.11984, 186718187812.44632, 280470362501.5856, 302249209391.898, 194266062183.23633, 196295134421.93414, 253381361748.68906, 221903857500.18912, 243832811126.84213, 255771956180.98822, 365386720414.84, 283786901283.81726, 279733815428.14215, 375488195845.66895, 286804798614.0579, 258901048972.73416, 273792855713.57986, 210401605350.74503, 299829047920.2826, 284580551980.5493, 268927599749.59616, 265649270584.75873, 298728302803.6921, 292422502936.01337, 246097687841.10287, 276771880840.548, 311206424139.1259, 240785448972.98495, 317101109831.69165, 286316104892.88354, 449840940053.0596, 242352316478.63562, 299176405474.4613, 218760092716.44855, 248566696236.51273, 365840663279.4521, 232456184867.7496, 204063488117.55267, 275931532524.23, 295217286670.3544, 318037387725.97766, 327356662045.16705, 270493520984.83548, 276695078260.1163, 206766496698.2496, 246209749959.89523, 286556601448.61456, 322902314071.4813, 356845876247.84796, 230799019141.353, 275617692064.43, 360999689844.25726, 219752172313.17416, 280083522809.9508, 272720305096.53452, 263047965527.05133, 251817184064.68277, 271464217698.2838, 253648445472.95114, 345298588042.15247, 188517286273.28983, 327943008820.3365, 184379452148.9425, 197682059263.4167, 247714333268.7047, 287786410208.3872, 261041659279.05148, 248732484602.9006, 312612346564.1492, 249213010240.26273, 271410120071.1748, 211192800104.62393, 228058547886.6716, 255745187892.265, 277228641769.77045, 347278327864.61334, 305198758703.2824, 299342215153.2917, 306710395149.26074, 246646908161.08856, 314312320756.5532, 226550300340.6572, 274355853806.05743, 257722253541.18796, 237324292926.13412, 337488663761.256, 217606933131.53815, 280305381431.74603, 361453364488.2236, 269074370027.34943, 301789726720.2272, 267506476989.94577, 243347144646.68396, 208334659808.09528, 179562360392.41525, 228510328939.25433, 307377977900.8044, 197905014244.5889, 276290636842.203, 280790250063.56384, 248015807231.25452, 328155774138.98395, 236654990930.77582, 300561970875.95264, 283091806614.5726, 187808403819.55023, 213006287531.23303, 242596593191.63275, 328603191192.07825, 177913982829.72028, 280891002846.70496, 255618252042.77524, 252066539734.83603, 208377744618.23474, 240751257344.3576, 279396899249.48737, 327460133791.62744, 291093521697.1038, 408370519996.43695, 242133977659.06464, 249213949087.48508, 256947935776.13263, 307839725434.7725, 337845736779.6051, 329597337638.74023, 248767592672.72678, 380485116907.05347, 261761324721.58072, 172218195885.0846, 291148906755.33624, 322002933973.83136, 186673422617.32886, 302785660225.3317, 308246036760.7587, 217310276129.58887, 258259956618.0985, 287813868468.8728, 277885562513.9377, 338067223889.88, 381766855880.47156, 276845384460.81555, 236760869186.82422, 211603808880.0553, 263530380577.2791, 238496538010.34726, 280195755434.7706, 294765800805.6252, 268456872385.3911, 364245084164.171, 220777159579.66385, 312283557648.472, 265190002381.85373, 253303425978.54224, 234650552482.50665, 263598662758.08823, 415309287410.85925, 340825018461.1203, 327724541090.7984, 217707638840.07867, 224384202408.71768, 231488173361.42703, 259077923334.90897, 429413105578.53784, 238183459515.89337, 368465823841.60944, 286801854225.3929, 367826359037.1474, 246924285812.93167, 290649314852.1519, 220225286763.43018, 227622194393.50467, 334053223830.7876, 224377849133.367, 194887431004.8804, 262529872093.7094, 269065112159.07974, 306862452901.61755, 259206643521.74402, 310671097538.7544, 243982806446.34473, 395323536576.0149, 331304600497.87256, 251239410954.4808, 296291828050.2352, 256363112093.13638, 415709497801.2725, 248586247289.75543, 193326166329.90582, 227311435491.59933, 426169293380.2726, 417239088913.75714, 226451519345.46213, 248096574414.41785, 255651684488.89304, 197754221207.31058, 248723994161.1533, 306906209579.975, 188503693984.55786, 278198764461.41614, 236931953374.17432, 240833818754.75815, 335278967194.14075, 267119720357.4577, 364694021043.5656, 199881210123.73825, 240626873413.96155, 270089323782.20392, 224499031183.47366, 258285954089.36084, 243052600166.77042, 332899549215.64136, 182770762558.28473, 293157927598.0336, 244136660210.23785, 210774941966.37997, 320462535265.71246, 221824258519.71902, 321903244853.80536, 280970460437.80615, 298393778672.8858, 240476468137.329, 300328618718.9147, 257417637880.10947, 288052506533.37195, 278424987566.8239, 317143214128.44086, 288286003123.19403, 299942273270.61743, 237568405491.67108, 233273987582.18954, 229477295455.7843, 240054826116.93674, 307473123435.1147, 313975142040.1198, 245734846902.65756, 237052256893.10544, 199217744374.15732, 260009086258.4534, 249730068125.93176, 203695265655.71646, 232915871994.7077, 267461436751.78278, 250960921409.75525, 242585697833.35602, 348689633157.54913, 276660992111.6929, 235853449992.4651, 397345934233.62573, 406721797574.4849, 280996956924.39056, 263193170337.08228, 334476139794.4031, 315724944254.22845, 273626103442.7288, 277444192542.5161, 316106387162.64746, 273342169514.9066, 304625159497.88916, 280944494476.15936, 229687118939.46466, 261213111410.57828, 263741898216.2759, 252424054917.77234, 251322873382.60794, 296900434756.2113, 268969435556.95032, 272842922982.20163, 295185163654.48047, 313218161289.3488, 273181822153.06598, 251411948611.92386, 297405334205.50635, 307089722553.0803, 388668842379.236, 403059644028.15784, 283709421444.8321, 277702536256.94806, 256834981848.73618, 368407108718.8427, 268960790554.4301, 308605569429.69794, 206437154244.53787, 266507583357.664, 290727430192.2379, 240052668338.19785, 230142297467.91956, 284272515907.8998, 327778751974.38257, 223020516355.4509, 297629438944.1897, 321421186488.17285, 247490214070.3181, 296617714423.0063, 226443786199.84082, 231767935979.93753, 251238213411.626, 266603028181.29556, 306049916432.29224, 190314216758.7776, 238584540924.4163, 339193545780.7239, 256827965605.8222, 324264049264.98596, 265124761602.00296, 337739459442.5198, 219903985591.67206, 272973999287.5426, 294752530687.6613, 303563948532.9853, 384641674489.23157, 325848815937.4334, 297526928294.05646, 316766839559.27856, 257780980975.84543, 269791309200.19376, 319536774009.62463, 259841760840.44354, 239180676864.6467, 349066212380.95685, 215775876952.41653, 289817600638.2095, 256561009591.887, 326562857675.30084, 333179470349.93854, 308230965230.1203, 361830646998.4909, 225685032636.34528, 249298538098.63254, 266606502811.92844, 286443565674.65454, 379976100969.8147, 390710601954.72314, 279692453456.2516, 242319224570.0399, 307854961748.8815, 262489699672.35767, 189191575597.6587, 223788599090.11182, 283153975175.1269, 328775040313.5097, 187545782909.2707, 216127900091.80423, 259251003895.71442, 295220333645.0725, 377835987860.5118, 179080164522.526, 259991561672.9566, 306986933741.94885, 263283258191.22607, 345479182414.1033, 401523048510.41254, 301863375387.5325, 245923037931.99295, 334621837898.3942, 376032304518.5126, 252562117812.09256, 251785986776.35278, 287123017178.72314, 258521281790.86722, 221959089929.82965, 272067795119.21445, 347895663069.45575, 321218780096.0104, 248763341815.84952, 342934752626.3789, 362641254889.25037, 267970875441.64417, 285616378454.0311, 303908852525.4373, 303299494883.4453, 300111955405.829, 344920151710.7203, 322433817765.7009, 405241241823.88196, 332673785232.0904, 400639574034.80164, 292025837392.8371, 172255210577.76297, 380642881341.43475, 255512921082.25504, 261914937566.74155, 326409189657.95685, 210875074318.3384, 279958318954.3905, 193741869899.09668, 180786949761.30334, 323181902246.5221, 302708769535.6014, 278195233496.76776, 157114031352.08475, 215961354766.7237, 289320175494.68195, 280021211384.05096, 299030630396.6249, 327462187513.3596, 311738213948.2064, 282675718570.988, 244768030445.75043, 329837552842.7219, 259820638319.8959, 278869600463.2764, 214443806367.99698, 336457458653.0498, 228884381324.77945, 330464791422.55176, 322520728029.82605, 294764363047.57556, 304631263612.49286, 193892225728.04007, 201786532115.5792, 196523411221.1026, 191441111694.68494, 288391735536.2424, 275065179327.61206, 288425602687.6649, 305251837737.6738, 278481790856.65814, 342477954150.8309, 288462333232.22784, 322865673921.64557, 334241297207.02356, 260659460254.61993, 257624279811.0941, 225507676177.3396, 275349920609.1651, 233987706197.2979, 304268327034.46344, 365385907922.3885, 229280306106.5162, 241403687173.29547, 248092796213.6193, 182755820525.04672, 277431345301.4394, 163475177268.79883, 331987711577.79675, 250286452995.93475, 290763210553.43567, 219878025283.65945, 280202927467.4899, 319052571394.8097, 233345601385.02557, 271125479517.09195, 272876156550.7887, 330263331231.5237, 223306712596.23938, 235657401855.96957, 291928646457.73126, 217533650930.489, 310498166705.5284, 323406246122.3793, 238090528360.56967, 316039809792.8179, 457700521647.3903, 398130443731.72015, 275883808524.0108, 286679098322.6754, 344908728985.906, 195657975097.45438, 363925152218.103, 282805352250.85913, 315964224258.99036, 243081054976.24097, 198459366680.06186, 194503494365.41705, 237225233691.19064, 269797398965.60043, 298169873558.34106, 330226482405.24274, 333760885663.2306, 265189353918.42978, 350794800404.9625, 207280154512.29462, 248909331569.43558, 300674322496.583, 317935245625.22626, 337592424462.73553, 356180333759.00555, 230986385127.53018, 305847960295.5899, 308048774043.7966, 321582032672.1308, 373549363201.96783, 242189147998.1423, 295176095295.72705, 274035720984.36798, 325964305378.6249, 240273183138.12408, 285529449211.41986, 264405357928.12674, 293075602682.73987, 309214196115.4352, 350836558918.4414, 237756369625.42596, 335110983419.8506, 269392683537.40915, 294662078682.278, 199208428705.47842, 272481791298.28732, 222248412750.95056, 234921433806.94717, 325973764349.4815, 302448423933.6326, 255619933032.56308, 178992700992.639, 209177168415.82104, 201913414987.76218, 334040155709.37537, 349413891035.94183, 225980938599.2637, 287530106107.6409, 193146176070.85483, 242929112434.33853, 309004623159.2566, 269301298854.1521, 275236043591.1782, 304532667377.2197, 340214334113.47516, 211843314694.2947, 314709307971.0229, 428240587143.9732, 238027672678.06937, 199871852125.95734, 294817263708.7032, 285694809491.81586, 270383514635.89694, 307313081268.1263, 387897236415.4457, 305373150851.24316, 261520663257.0705, 345461750537.5321, 321968574587.77875, 257864398677.37698, 217071752866.6934, 259487497358.51163, 223456849395.49432, 295529485911.18884, 282767186899.9843, 262090742551.9914, 204969461744.5925, 251808580437.72467, 210286631795.2952, 184522190829.6482, 288770655980.35156, 257790844251.2186, 236131813034.2796, 257840361693.06927, 235415255110.62445, 191786522503.81412, 306077943788.1377, 283367742660.6377, 285443080188.9143, 399201440860.4906, 240354206711.31955, 404522677418.62415, 239386049837.23682, 261000602630.30093, 229123120728.24304, 265435079973.7266, 222535977185.5702, 284445060089.09454, 286132287439.2487, 286552312120.5652, 242270389344.63574, 277656525537.83923, 300580866190.03595, 328991988079.03894, 329057050081.2663, 295002844639.64923, 323126549549.40063, 271434333014.37723, 204848122923.46945, 204192159778.36816, 280013115493.31396, 187229405341.70728, 292890640917.7067, 203580805562.56223, 336420198015.3695, 321414534698.57794, 274353561590.47104, 288557878685.83, 250890962940.511, 281174401176.4946, 225952392725.70813, 241271205234.3047, 326018376147.4681, 286559545705.71405, 214040588427.24997, 236110451175.19113, 310395539510.6253, 370703846590.50543, 258611529142.152, 372961829166.8739, 389448074953.0942, 228238216524.9661, 249315889086.94473, 231924540675.49036, 294361801003.0914, 343282809368.06085, 288416760686.95844, 213487764701.21658, 306476193983.73, 280174866679.2274, 399881885571.4301, 318065147417.79736, 228690622325.55447, 301039805611.97406, 284953509796.30176, 260015650906.80872, 180203393155.59668, 219374380608.64743, 204277264824.2629, 195754645409.51044, 182578826594.2181, 333063818007.6035, 223620752821.6759, 184506191045.50287, 332754343020.1701, 312820228736.4219, 277803915204.35785, 367797350899.13776, 321614103567.08984, 244882690952.08133, 276537259229.96716, 273550897829.61066, 325820107672.17224, 185965274792.45035, 291220318721.6976, 327696691203.5018, 256383802075.4605, 200010930989.32925, 383939431819.0535, 328352577196.87524, 251771747535.50958, 214533070951.52884, 240370643122.6763, 263656742414.7697, 283216948545.955, 188699921627.92465, 266783639918.44403, 317982509716.3051, 232085925937.26575, 238984124818.47476, 352793594318.0565, 219070706235.8235, 273215456924.13672, 222050140308.99713, 282088681280.8867, 180497258247.15997, 243520650761.4092, 253053900582.42886, 352788339602.2596, 210070700239.40817, 368971131831.1268, 222728359393.41388, 259111850525.03836, 325803578236.3245, 223381100446.13577, 309077023438.85565, 304961470633.219, 208140129052.4946, 217183424401.29507, 254946805241.57172, 218250287414.603, 222084805707.8428, 293034223262.6116, 188702234295.8148, 221323031194.4708, 316787611839.2631, 260301283423.17007, 272943245398.27118, 299301127684.2846, 246988665367.66925, 262224019353.40195, 231683958967.4354, 251563448178.16837, 290089520955.81696, 366806440053.15015, 302872054825.9327, 298768856537.38116, 242285155719.90222, 271439647232.34705, 327248365441.3507, 260464655443.15793, 318744702839.87354, 236430031431.69513, 224683844659.95737, 342526902880.83813, 373960174716.8408, 249556987242.54932, 256569315807.13004, 283914063183.7681, 225017638068.20074, 385194925389.9119, 228066133963.1144, 265529304386.27206, 272231078214.10663, 189657233306.6425, 181378484174.21753, 186705003619.33856, 268810181217.7968, 246390592501.07455, 276343270450.3543, 197258741729.21783, 273812966288.4493, 308608232835.95935, 209909487826.4935, 246319281496.21725, 348585484988.45624, 314601702239.48676, 270860025413.44797, 271881142879.3293, 300897419973.78235, 262215106734.96695, 224213236175.718, 296845496082.6298, 208008726137.6457, 218589683303.01355, 311377834212.19855, 247885617190.8721, 224682825621.14276, 237612790514.2504, 353132336092.56616, 159859670675.91708, 163672192669.86703, 264368598932.21136, 351344488495.97235, 259835342105.65286, 299051994438.8502, 233012544841.4979, 214534449849.33502, 306746640095.95856, 256933689397.6793, 270758578441.90408, 265364812033.33514, 251582089073.17667, 175786033876.52554, 329743977056.32666, 332088874879.76306, 225473884652.07123, 178051773676.26358, 427973149011.80914, 388108774040.2646, 266012352875.28302, 202585262632.28232, 286369727352.266, 368377786443.5537, 367583238639.6265, 250900942519.25012, 226578325274.28455, 258284552430.6086, 269134205938.19077, 256129732254.88205, 236286105345.83862, 275294132730.8735, 361887712417.61414, 302832725041.001, 174463682098.4015, 281019142038.2199, 268152678825.7656, 299153746409.51184, 314153395399.5091, 255983450102.56635, 206998458074.6448, 277918134742.1362, 242702830943.6061, 212551545455.15173, 290356691877.33826, 251722910738.06784, 222394808795.10675, 323160803975.78467, 324311912071.307, 312555592416.623, 269628099413.5349, 338486681704.88214, 305147046442.97455, 266756972828.4304, 251170261605.74435, 345599755068.83673, 243460237982.7691, 186085060369.01617, 273402092143.25848, 256738389300.7005, 392659872619.8734, 339153103456.6622, 296907042814.0808, 293366346003.2655, 296400820697.82556, 228593044552.50668, 231435287518.7915, 267337197856.92813, 242543165247.23453, 181063207206.02966, 269370805925.51685, 285792346657.15594, 201761028203.17688, 247880688610.157, 300860917531.83655, 282803066308.0506, 327089609163.07697, 289072143458.93524, 253971273193.01874, 188872102818.70847, 337390604416.1597, 340096415964.27844, 350892319025.1337, 332385188102.9224, 297085424985.22266, 194290902474.09302, 293148024828.17456, 303894248699.0043, 288331714447.69965, 233704168051.55215, 305834542037.33026, 221475257392.06433, 277081614428.4806, 209777865523.68982, 263779614738.72144, 331661302261.8354, 254476618153.37936, 265998231672.07516, 258790978631.41635, 356357200424.7765, 268475503550.42233, 151469919944.86136, 214234197667.9992, 260825184004.28143, 293449997701.68756, 222662013323.6575, 311631288607.5722, 198053445502.64523, 253832467996.50522, 342105982917.62396, 225622137116.25375, 280694130373.25055, 239326877986.9334, 214679034964.158, 242733148875.43088, 293082448828.28546, 323392597495.3713, 264194606956.71054, 354708693936.96985, 270882302865.96622, 424410360928.04285, 268198515326.02808, 267359704947.28192, 252119571735.73334, 435269528142.9541, 372708638622.5836, 238975910852.05304, 327847426914.92535, 271192518332.01648, 217703318066.81668, 357698028469.7542, 235002748893.14108, 282694274472.4677, 260065070099.66797, 250242930399.0606, 317906191692.27216, 224709882783.38916, 238930351205.53534, 216752041568.90848, 234208162516.82037, 301367700651.3083, 275307701254.6965, 222610762500.45242, 370349806328.23846, 291227453897.5889, 279400340660.69244, 240931731076.84744, 314854507888.5955, 322689395202.86566, 258082221972.64807, 315650168761.4257, 286651886088.1406, 232693457936.26587, 187867544531.66833, 344411326140.2915, 321083399859.2604, 187551960673.4651, 235382850830.91003, 285231189586.80115, 352476982575.2028, 195769017902.24948, 253714588614.42645, 212914242569.41373, 293365481680.63324, 329226423242.57007, 232272064452.86993, 206948265510.3466, 202790727629.78625, 211388380282.20422, 181141637084.25232, 274809288606.4913, 275746638307.39484, 267849695508.97375, 266678711111.11273, 245752501893.47647, 241622263056.05914, 271677854300.1276, 255815544674.89374, 305239772466.80426, 270874872532.85385, 276310150022.0715, 276794030660.02234, 174770545600.15408, 299657512979.6539, 281609269153.20856, 242523818048.66367, 346708486550.80084, 212481908891.6902, 256982578607.99243, 327093718717.73816, 287522775324.3879, 232123958159.64584, 302817565049.31915, 275099800668.51666, 424198742079.5211, 280562004029.11957, 371126586498.55206, 255146727707.6499, 312398651671.75995, 214148829521.92746, 272149626187.61786, 258290505424.96454, 309264264175.1828, 363887687544.9658, 252831944179.30255, 279674560592.9489, 172547958422.8538, 288613732582.9637, 297695328930.1134, 287138612925.4173, 365160464149.9604, 330435525616.6588, 314174123872.53503, 294366033523.84686, 212111523747.43756, 245874397881.12823, 341182783997.3206, 314658467206.92834, 275897053030.2953, 331265579249.8634, 281321626157.0385, 328202591766.50977, 334875860340.52936, 225461946121.74445, 253890831454.03503, 233346235876.13846, 321204816031.2479, 189359389153.05902, 196020374532.93637, 265788216405.35254, 328495748782.38544, 215486728922.1727, 225597791642.0355, 375382780013.17334, 206960395954.13776, 361529580686.23926, 219254803211.4378, 262051741672.917, 313280110287.2844, 202925428832.5861, 249577165533.25552, 272426504521.03107, 232683273605.25937, 242244966775.33948, 234312399819.76654, 271098472760.93073, 268712166395.60028, 296070537329.5155, 219921726608.14563, 272521223536.70724, 288444486792.6936, 257873941458.48395, 217863873422.05066, 232360023841.67728, 256833911594.08267, 262995584065.45898, 237118427566.3052, 271813080000.97134, 263837394016.362, 239043057480.40466, 290264818670.94836, 293360689234.592, 201667800460.29938, 290344188009.0301, 170859441938.07388, 298978440304.68146, 343914918853.4938, 263111688649.97726, 330445036447.8529, 333309404049.0708, 333090116781.9209, 321773087347.5757, 261688995258.03815, 332127435111.66235, 277753998668.8573, 310585459437.8928, 260586581360.07175, 330784266197.32495]  # Truncate for embedding
baseline = 275468208149.5121
mean = 274147383087.5927
std = 53260996373.944855
p5 = 193186928214.6086
p50 = 270393376897.03662
p95 = 368906817582.197
display_name = "NPV of dFDA Benefits (R&D Only, 10-Year Discounted)"
units = "USD"

# Create figure with two subplots
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
# Handle edge case where all samples are identical (zero variance)
if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Mark key statistics
ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {p50:,.2g}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {p5:,.2g}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {p95:,.2g}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {baseline:,.2g}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---
sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Mark key percentiles
ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"
exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title
fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark
add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from
output_path = get_figure_output_path('mc-distribution-dfda_npv_benefit_rd_only.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 2.755e+11 |
| Mean (expected value) | 2.741e+11 |
| Median (50th percentile) | 2.704e+11 |
| Standard Deviation | 5.326e+10 |
| 90% Confidence Interval | [1.932e+11, 3.689e+11] |

*The histogram shows the distribution of NPV of dFDA Benefits (R&D Only, 10-Year Discounted) across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
