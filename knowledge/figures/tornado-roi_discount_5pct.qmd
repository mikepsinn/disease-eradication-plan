```{python}
#| echo: false
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Display name for chart title
display_name = "1% treaty ROI at 5% Discount Rate"

# Baseline and units
baseline = 338.1197615877601

# Tornado data from sensitivity analysis
drivers = ['TRIAL_COST_REDUCTION_PCT', 'DIH_NPV_UPFRONT_COST_INITIATIVES', 'GLOBAL_CLINICAL_TRIALS_SPENDING_ANNUAL', 'NPV_DISCOUNT_RATE_STANDARD', 'DFDA_OPEX_PLATFORM_MAINTENANCE', 'DFDA_OPEX_STAFF', 'DFDA_OPEX_INFRASTRUCTURE', 'DFDA_NPV_UPFRONT_COST', 'DFDA_OPEX_REGULATORY', 'DFDA_OPEX_COMMUNITY']
impacts_low = [-67.52059878607241, 59.07133335297971, -52.83186256643921, 46.2859322825816, 22.74948297924425, 13.383669102163935, 13.383669102163935, 9.911506658726182, 8.88041170632016, 4.490871919933397]
impacts_high = [101.80788819025503, -61.58150101462047, 57.33365908080998, -40.373437874101285, -27.001085006692676, -19.682527051455793, -15.89287105397591, -14.808674895025035, -12.012118328005783, -3.9638602366962346]

# Convert deltas to absolute values (baseline + delta)
values_low = [baseline + delta for delta in impacts_low]
values_high = [baseline + delta for delta in impacts_high]

# Create tornado chart (horizontal bars showing swing range)
fig, ax = plt.subplots(figsize=(10, max(6, len(drivers) * 0.8)))

y_pos = np.arange(len(drivers))

# Plot low impact (left side)
for i, (low, high) in enumerate(zip(values_low, values_high)):
    left = min(low, high)
    width_low = baseline - left if left < baseline else 0
    width_high = max(low, high) - baseline if max(low, high) > baseline else 0

    # White bar for range below baseline
    if width_low > 0:
        ax.barh(i, width_low, left=left,
                color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=2)

    # Black bar for range above baseline
    if width_high > 0:
        ax.barh(i, width_high, left=baseline,
                color=COLOR_BLACK, edgecolor=COLOR_BLACK, linewidth=2)

# Format axis
ax.set_yticks(y_pos)
# Simplified labels (just parameter names)
ax.set_yticklabels([d.replace('_', ' ').title() for d in drivers], fontsize=11)
ax.set_title(f'Sensitivity Analysis: {display_name}', fontsize=16, weight='bold', pad=20)

# X-axis label with units
units_label = ""
if units_label:
    ax.set_xlabel(f'{display_name} ({units_label})', fontsize=12)
else:
    ax.set_xlabel(f'{display_name}', fontsize=12)

# Add vertical line at baseline
ax.axvline(baseline, color=COLOR_BLACK, linewidth=1, linestyle='--', alpha=0.5)

# Clean spines
clean_spines(ax)

# Add watermark
add_watermark(fig)

# Save PNG (mandatory per design guide)
project_root = Path.cwd()
while project_root.name != 'decentralized-institutes-of-health' and project_root.parent != project_root:
    project_root = project_root.parent

output_path = project_root / 'knowledge' / 'figures' / 'tornado-roi_discount_5pct.png'
plt.savefig(output_path, dpi=200, bbox_inches=None, facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Sensitivity: {display_name}',
    description=f'Tornado diagram showing which input parameters have the largest impact on {display_name}'
)

plt.show()
```