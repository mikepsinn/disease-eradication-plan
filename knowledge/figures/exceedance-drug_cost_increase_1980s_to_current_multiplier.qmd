```{python}
#| echo: false
#| fig-cap: "Probability of Exceeding Threshold: Drug Cost Increase: 1980s to Current"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Monte Carlo samples

samples = [13.9477667140579, 10.79482827971174, 15.184276954073075, 15.744472648806736, 9.074363180033096, 10.26871642513232, 13.48547251514827, 12.391200240029182, 13.118841194825858, 11.186316714382825, 15.562017256224863, 15.263596119386907, 13.327562553300652, 16.31464652520953, 14.387241714766377, 11.173004549398009, 14.119007668335172, 10.962958930758807, 15.559207120255174, 13.036290634673867, 12.705347453092541, 11.559298671550676, 16.613640614689228, 12.779001718800469, 12.129337466390123, 12.30673928638342, 14.566004701438764, 14.110113473749681, 14.237841637266408, 14.287004223563924, 19.793885253091762, 12.180093075283665, 11.936917438505573, 11.270345724408285, 14.800114860252798, 16.320029344252163, 12.878211140695525, 11.213822839749273, 11.24737026433915, 14.898060230518366, 15.163466037170144, 14.596139206492937, 11.593315310698197, 13.756244344045479, 13.456837307974675, 13.720971549050988, 15.538402002460018, 13.73380790169943, 14.978681422231968, 13.331495626113371, 13.906370433268805, 14.843354479637085, 9.96988507443428, 12.383106797984253, 12.032542467365843, 11.652301933555972, 12.488632451526076, 17.49882671197235, 11.1590912669229, 15.827842853158357, 9.550141783984213, 12.347257537559129, 13.575492001676125, 14.716426188826649, 15.071200394486162, 15.30890892893184, 12.314735538385444, 12.050948164493871, 15.49861809051012, 12.689759825924881, 10.320690763135868, 10.604589728891543, 11.045645047356151, 14.468766982364622, 13.523006795822573, 15.011748437360898, 12.131822904521504, 13.56459635162301, 14.827246249516266, 12.407494747203398, 14.3578421329086, 11.60123553571627, 12.281155342235351, 12.237505854296739, 10.478930589988067, 14.4407028223727, 12.034767578914702, 13.192283751127922, 14.423580238048267, 14.329840754522841, 14.940115479150135, 12.916212780030458, 12.140968352419408, 12.962488704328736, 9.54201992218119, 9.988984759150343, 10.228640017297261, 10.883102560667934, 14.202725979149118, 11.075096597134511, 12.24584650833091, 16.858211882758702, 12.297056323619431, 15.146892733301367, 11.015868413818673, 12.655628582891172, 10.98148557950442, 12.337501256148713, 15.446524406908583, 9.469586923283952, 14.296816122956242, 13.770864809035086, 11.752045349768212, 9.990992474224464, 13.343061069970794, 11.89774243339543, 13.75759416478022, 13.215830635988501, 17.858744544724487, 12.574091729100306, 10.828796398514937, 13.618303355445278, 13.724392269615665, 17.051940287739573, 15.431234625028289, 14.08708045925017, 17.39364092649137, 10.493071450423367, 11.65036206588781, 11.030660586117506, 12.218696361056098, 10.123948096641385, 14.854284655318507, 12.615212318519934, 9.943984162381444, 10.845149037695803, 13.97116767857909, 15.440104163947405, 19.254736663250338, 20.61855670103093, 14.242391961278043, 10.899101648276497, 8.766686604799913, 13.849753685094774, 11.272131986690727, 12.159354972401628, 11.711921648657187, 12.812502103866303, 16.12529407496961, 13.56074244915377, 12.769008171640671, 10.803739971929952, 9.565052762389465, 11.99605875138931, 13.026713283091363, 18.433243704192336, 13.491729289228923, 15.8715210997467, 11.96640531372923, 10.500711302953542, 10.949942564038984, 11.46213335617315, 19.744240550141967, 11.254004891942314, 15.4411711969511, 11.080483694231711, 15.71751760990877, 14.162662921110838, 12.773868286997926, 13.059074693646915, 11.617027386976366, 14.328587460788613, 12.067881249130735, 10.419658546083596, 10.316264049583594, 13.600958683565539, 17.781699705083852, 13.568349988749816, 12.866704286946899, 13.897645837443427, 16.879986135543977, 13.722786041898678, 12.169624308416264, 16.249635261092124, 14.28138435572719, 17.6354602319537, 13.628580974966232, 10.421915904521324, 10.140412209404326, 18.026796383254116, 18.2784098876823, 12.71829081066955, 12.234126208252526, 17.38748148717824, 10.657752950649364, 11.097812245860062, 14.877446055120716, 12.207535802879141, 13.14807176086654, 12.757313982150812, 14.035374165339165, 17.209596621918266, 13.390070472280785, 14.879181241074182, 8.904539769480628, 13.039290738557533, 11.20725620199017, 10.433154983512495, 11.13292054056933, 12.349049647881461, 15.67065142570856, 10.221443892680547, 13.237959642749983, 12.00094835102428, 12.364238515983562, 15.932183079563961, 14.582130397417743, 16.98128234767696, 12.779059684115428, 11.52627527732974, 12.611279681599889, 13.783364968700198, 13.61129230864432, 10.703869792457201, 13.389827746033989, 13.745938057768871, 20.61855670103093, 18.81982861102649, 11.185891609624546, 12.459533915153681, 9.95794907207591, 11.759758423879441, 13.976736298754744, 16.560891729157863, 11.453710014510794, 11.618447080013471, 8.741258729473628, 12.759203025835932, 10.748785135256997, 11.897863238897962, 11.135661033641274, 12.926611161670634, 9.414872397416584, 9.951113791951002, 19.7471656967128, 10.297634190854039, 10.678611491603506, 18.67716364914968, 20.61855670103093, 10.52751393705009, 12.269002973847412, 14.046025966397211, 18.295945566685152, 10.904671544428, 12.559909062262863, 15.262274582029077, 14.29774909443904, 12.2505297781631, 12.82952633419176, 10.127402724005883, 12.57692404764038, 12.509485205091723, 13.756266800881527, 11.83931213904807, 14.398292747762422, 15.96244532228279, 13.556558662575876, 14.07335688479217, 13.294902342265114, 13.161122804832127, 11.47014814606053, 13.979105010891743, 12.91916402065197, 19.611862928919912, 17.762272346625306, 14.165080225762564, 11.379796874385315, 10.646860660802108, 16.51453109084176, 13.836663187969254, 14.421922212162876, 9.438481262573317, 15.705138738330254, 14.351400351656538, 10.650880265404783, 12.029900899118424, 13.83921576789284, 13.293157992604517, 12.448171156471254, 12.903904941295227, 12.543884149600128, 13.549154559081561, 17.420805726681323, 8.069869377523686, 12.580096450311919, 13.611134249225058, 13.924600449621046, 12.260435604945384, 9.416678567911417, 14.009776952100607, 18.29124827761181, 9.825211643643101, 15.515911921243056, 12.362230906534185, 13.008004763363823, 10.768294585454262, 12.34826665866215, 16.860834502556745, 14.706425943797296, 18.308550187111184, 16.47137478513038, 14.30952604567329, 18.349147022191275, 14.309271028950679, 15.41030241884296, 12.437738494327693, 13.328870894196859, 11.523022257558788, 15.892235891893895, 10.51400705374687, 15.276860913108331, 12.691339666631704, 16.452035726015346, 15.185485920888569, 18.619354416833197, 15.127447956767554, 9.753987414829684, 12.994059151151045, 10.526630128359342, 11.923192398622627, 17.55322300685555, 14.861031357123599, 11.519714410382138, 10.84899732602185, 13.243386040715894, 10.437635156947719, 11.580882510996664, 13.967162990308504, 16.402152338910433, 14.779771521924756, 8.504647902520595, 13.94683553094617, 13.342817138334139, 14.240983014949572, 17.907923605090392, 8.882395503208837, 11.758870103066974, 14.729567968545558, 9.736244679961118, 17.435608549090773, 14.11794715814204, 15.465008784697202, 11.804131443605417, 15.368586560969574, 16.132951505320303, 13.758123258737282, 13.762116519498221, 13.856701399045875, 11.164378746212403, 12.796061613102374, 12.783890024345455, 14.158461082434883, 15.923278908531962, 10.75673219575676, 12.851093203016648, 17.453914087135832, 11.422095427210403, 11.252153517948948, 13.678202787278739, 15.458530114201174, 13.189598934554624, 16.954000238911135, 15.495127762716269, 15.45097550081154, 14.626662586412193, 20.508082993234797, 12.656293917222227, 8.984052206789928, 17.8671711560251, 12.061636968566559, 13.434275810113345, 16.891405972096614, 9.69797834180797, 10.368078302880699, 9.699792603860312, 11.312598444053675, 14.311025713284575, 14.543479216119467, 13.872371461776451, 10.05457948294004, 8.474211072928838, 13.297938467284814, 12.029324984029465, 14.364986577593964, 15.04459166364249, 13.5122281238839, 15.212318169818715, 13.748513370070912, 14.559775889828014, 11.507114360294581, 12.718067350390767, 13.66379574868409, 15.388411406379678, 12.209545796042129, 14.535110158042057, 12.51079329467959, 12.869392279379749, 15.414798698998773, 9.001981310926954, 10.279890606606784, 9.92244446706309, 8.436325770413458, 11.565170831398266, 15.181333608292848, 12.465469515701743, 13.666436252916212, 16.19685838544506, 16.949883181456148, 12.988650357300019, 17.033747357571094, 13.394005093643715, 11.219718654756504, 11.751484594646866, 9.925562776001648, 11.11176455478508, 12.292949724287753, 15.338805117045167, 18.268325663731762, 10.113351627228669, 14.183936775567833, 10.793676702938694, 14.40696183848966, 12.83621796014491, 9.284493018249128, 15.707708332634152, 11.727769946009088, 11.887753495964331, 10.733764948441818, 11.618144119063915, 14.279027716303526, 12.694742292319772, 14.0115565133861, 14.100645828927972, 16.92720898328937, 12.328680596841977, 9.932523319259378, 16.129111649247456, 12.355252756302264, 16.275368984301203, 14.15841588618252, 12.836093502998361, 14.065365767905407, 19.08771247318416, 19.55145716979801, 13.336074576607915, 13.56886448952379, 16.156852725580205, 11.20206601344273, 14.023332268937548, 13.09620665509171, 13.972217675895818, 11.228337179245036, 9.721462776527625, 8.86591548295552, 10.636776382630314, 12.059394157940282, 12.445750818408335, 19.037649240773806, 16.248720735664925, 10.956257908489073, 14.062504932473223, 12.17855377748322, 12.46670536658353, 13.634013192761188, 14.809119376007626, 12.336971313258218, 16.118754108572354, 10.587121665785185, 13.17681913167027, 20.61855670103093, 13.732458012775599, 17.294195048270083, 13.392457189980458, 14.701163338242786, 13.019266529254812, 12.740393439003247, 11.344233151154201, 14.285589513238179, 11.189529111367058, 14.940685263549586, 16.18473128459392, 14.113037517782598, 12.462228203900935, 14.350156700527181, 12.409087253866906, 15.729425381015561, 9.28360795613893, 12.345558030187759, 9.005839131019712, 9.898128602064416, 17.067137316179288, 15.608905182973118, 11.474690706354606, 9.884100037749196, 7.731958762886598, 11.866036394125238, 20.61855670103093, 14.29807114265633, 11.829738494781305, 14.380583310363983, 9.774607814181019, 12.435955268865913, 13.412780616423468, 12.946732449144548, 15.301497447067185, 14.054298452763316, 14.948490755712674, 11.54291549345806, 15.616731354292385, 17.951409560357273, 10.939445895307268, 11.112692481050175, 16.976060940763677, 12.689663915409941, 17.197596162181323, 12.096541475766527, 17.36629267300605, 13.494843942314597, 13.824749032531756, 17.733061779084654, 12.284159244594166, 11.000126155678926, 12.082652741736231, 14.345695493801037, 9.765669638282061, 14.860853203023497, 11.87672375463099, 16.378728528931973, 8.33939150411775, 11.328930580330582, 9.54359527456414, 11.243623777175733, 13.796948942294755, 12.71899996215168, 12.540537554347853, 12.767669832732537, 13.681023523997213, 10.859714658705467, 15.058634913581752, 14.932375947566962, 14.16289765058353, 14.633400932003783, 13.925725622953493, 19.39594049825214, 12.94428148344415, 12.412847360664056, 11.400481459475124, 10.810723818227293, 10.382265115739985, 11.110359763235952, 12.984833092181773, 14.026605625638691, 13.289802580793767, 11.374424243089594, 15.623783538711713, 15.152369636324789, 12.76654231295943, 11.621171350910018, 14.610815272177303, 13.640894691037227, 9.987053252782033, 12.991516130948753, 13.834782205250105, 11.087311141388017, 13.64575605933433, 9.9743191758816, 16.977360709633686, 16.694278676878383, 12.542593494999972, 14.104764340006186, 8.31453922934743, 10.55809009128199, 12.444357907091877, 10.728896576551636, 15.080307216907155, 19.256812256612204, 10.517391479033135, 11.219579295045557, 13.764863872030352, 17.89054977747509, 10.426076945103642, 13.800552009268936, 18.621670438337752, 9.606928720195562, 10.310109368464476, 12.140255092002088, 11.917948164652811, 15.36518260330865, 13.781166475929284, 9.384003499945802, 14.519173136894842, 11.789305145884935, 16.778788460661776, 11.677399224346487, 11.65732707562937, 14.590514258076912, 15.22041817968821, 14.33412373655643, 9.545179165397284, 14.581905321588321, 10.806510868582498, 13.76441203391411, 10.033585188727837, 14.329269959621175, 11.285763678108449, 10.307034137329238, 15.078651021297887, 13.781126562614128, 11.707726468194833, 17.35350084676572, 12.100883560773184, 13.241684106532178, 13.852926413175458, 11.69504045584569, 14.397189152607384, 11.88876818450892, 12.16797532967838, 17.063171195095247, 10.79359008070124, 8.310011509880695, 17.889938999406073, 20.61855670103093, 12.182752759856141, 9.098946853563259, 12.404805652616842, 12.46228943670575, 12.69309857481124, 10.644879469533203, 14.697757217671178, 14.544364817800387, 9.89936455771371, 15.036689821068434, 19.461145736846614, 13.599332168096542, 12.341517367411909, 12.809542416691729, 14.79807684019926, 9.4635414219959, 13.579729242166861, 12.217173309544712, 18.71604024815088, 12.73125543116122, 18.085151650496027, 10.664467451109896, 14.719334206160957, 13.986848513435532, 11.152254173195873, 13.613426564374821, 16.581939963768235, 12.373387169570918, 9.533607825519256, 13.11693717215169, 11.081548140582598, 12.329726626445892, 12.957871362280873, 9.508769487954936, 9.67324774365978, 14.42720936062235, 11.913110980708732, 8.072813473946118, 15.28412234731522, 13.86205363990155, 11.486954425146081, 10.240087144105404, 15.433283362389414, 14.066906330864873, 20.61855670103093, 14.25808579773518, 14.170092715144298, 12.748844367479244, 15.377410875814382, 14.825818872917822, 16.70629261622424, 11.916280117930377, 12.112984449617237, 12.012540255772949, 15.301484615527666, 17.51027875648068, 12.059014500274314, 12.137555255789858, 13.972667696948445, 12.558751503031372, 15.778981091163882, 8.568926398215641, 11.242604827800925, 11.337892316120408, 8.457670522036322, 10.953027759864735, 11.054691790103881, 12.666082617333304, 16.27032500113586, 12.560428922622473, 10.813709270395579, 13.018841423119886, 16.07373152794147, 10.927342132921478, 11.064346970643262, 14.639022493092476, 12.616862975692493, 14.889238828967736, 13.126729431778234, 15.043760329634571, 10.80492516713394, 13.130637690489479, 12.64296750305449, 10.438966359175087, 9.769915709491698, 14.99820533622549, 12.30950970594262, 10.8313085065435, 12.921891297335035, 16.317064412943502, 8.52176601440485, 9.895152840893731, 11.03841883227644, 17.38660203896441, 13.889069910770251, 15.233158774294296, 10.590708041634803, 10.63241567293453, 14.333343491160209, 13.30787779759179, 14.611680931848493, 12.698549058807394, 13.877314641327883, 13.563509157728284, 15.263524721631141, 15.348814684229723, 9.665483505747774, 8.576292023672673, 15.92910953660904, 16.50377830581617, 10.834729739191259, 9.233448905972955, 13.411649245957692, 15.71531693127611, 18.53774228713022, 14.5216279981215, 12.260897952194782, 11.101188898079712, 13.189662364880082, 12.431355430378707, 10.84620553546396, 19.44657886381052, 18.493897275245068, 16.342051888867914, 11.042702543590975, 15.489888401289909, 14.866958745318103, 14.318961307914572, 16.69973645731688, 14.854907977046512, 15.154106753780773, 14.859254315265746, 14.043980754337971, 9.368549474723729, 13.372312852594474, 11.837361314798367, 10.312522841688315, 18.133220171507205, 18.296983531835107, 17.052047602785503, 13.816807208888838, 17.02413933417614, 13.191175287917137, 13.67948289931649, 10.685357914972572, 14.195195900410035, 13.313233904255465, 10.267791638849667, 13.033133031905072, 12.962460660419284, 18.53762445368364, 15.606015264904483, 13.189647654542831, 13.799897674102734, 13.27226430442366, 12.661716180395876, 10.707870287451927, 12.787473269613653, 11.416633293156476, 10.370709743507462, 14.507588614207386, 14.179713205250671, 9.363023096423385, 12.856786812571828, 15.910773367218173, 16.10454535830545, 16.002407776354058, 13.258868290129755, 11.203380445184585, 10.705275790703151, 14.054190462170974, 14.147365909806478, 16.82003456251425, 16.230110348274554, 12.833424772919972, 10.382791227033659, 12.38443924709703, 13.717161366462644, 12.663720807772169, 11.788507126030813, 13.81067737816703, 11.955778617322975, 11.676334362959194, 13.96568149825741, 12.190362286783953, 13.787588162905394, 13.864257628573197, 10.592185310775752, 12.007647129452414, 17.30923781032186, 10.546563919294819, 8.792438237026632, 9.229913298801094, 13.234121818544427, 13.23868060889071, 12.869223826447477, 16.58722101981679, 7.908229499215599, 14.1923357347799, 17.721981775533077, 10.615723320195807, 12.242010731499628, 11.401862538127151, 11.098617975038222, 12.367563749674348, 17.27532378772195, 18.678847752115676, 12.34477732014314, 18.921293314629256, 13.250440157964436, 18.383294264711463, 12.928985816653272, 13.493743350084069, 14.110195238383548, 20.61855670103093, 15.478870957095262, 11.501433510876268, 15.83001322258703, 12.284013968546212, 11.988192216781698, 15.648863290855273, 13.239105231200723, 13.87845761960168, 13.19603288774439, 14.032722714980245, 14.271072031531602, 9.098723365702432, 14.943496909290408, 10.914729041144628, 9.998151367904265, 13.015227949718636, 13.373230078729152, 11.531628171941984, 15.419243254780728, 10.190748329569422, 12.178865900178904, 11.772837126167852, 13.044587303727116, 13.879220304789504, 10.861045604115724, 15.10874465105383, 13.319873543690468, 9.177120233550214, 9.06130592685634, 13.130050574354884, 12.618230625271574, 12.904072536022165, 13.0909178766476, 13.738949757782144, 15.76574407191964, 10.64951191011283, 10.526701541641865, 10.685658291584927, 13.905833192974868, 16.684729109062083, 12.122378352183347, 8.170385523630678, 9.511776767297329, 11.229047767338166, 11.83389484910996, 12.175513002674988, 13.258029250534, 12.40182191246365, 16.074239974191485, 11.570124375109161, 11.166564586770102, 14.418438152785345, 9.821878205885035, 14.175463484001174, 13.420644434919677, 12.796271787730374, 17.812850375535966, 11.689377665541752, 19.48940051894387, 12.607500800903544, 10.318075068894496, 13.337443043310431, 10.72049232971607, 11.404331245277609, 14.195309502926277, 14.63074822066623, 11.689466201129052, 15.885638807744849, 16.40901687092757, 17.304372564378447, 14.557968925016718, 17.065727405825548, 9.196636640086096, 12.387271725822355, 11.156594705504583, 13.463352580917276, 11.80299427275494, 12.750715415897504, 18.838954748225355, 12.742063397713244, 14.240717148914054, 12.59108320759894, 13.352176707462668, 13.1760096447713, 14.334737540042816, 16.433424717802634, 18.014660462527274, 13.960804731501847, 14.72575261613453, 10.569127938678447, 12.942351242999349, 15.743646823230183, 15.522242571469084, 13.702474713807716, 15.582778155804917, 14.45114787638019, 16.543393961893646, 13.907005821549445, 12.298381941857318, 14.030738993222986, 7.731958762886598, 14.15709016904242, 7.731958762886598, 9.476549723924327, 14.344150035556801, 14.414739748375565, 10.545861984956147, 11.490835710065761, 17.088873071479345, 12.001266931995175, 20.17959697752255, 13.156097030488706, 14.225104846478946, 17.91019217057379, 13.493664382145198, 10.872536541661256, 12.888571746196293, 13.07190171000093, 10.14701843549326, 12.534673203537624, 11.425134721887796, 15.695921325488145, 13.24800469908159, 12.470431249112895, 12.897282855882018, 13.732568645488366, 14.802469432702505, 10.877990686202796, 10.791530152609889, 16.24465205956834, 12.166355651248963, 10.046772314436431, 14.322419201742072, 14.375896836608339, 9.831104055649872, 13.749221676684952, 15.14131574675082, 14.134179033711895, 14.845315569444418, 10.070872898148576, 14.017907868995291, 12.423409929666063, 12.004103103417307, 15.535816706963981, 17.446661256957796, 18.526354919022396, 16.908336817862736, 12.888555216786877, 14.07594179792239, 15.231723739762023, 13.46836186110855, 13.492988301938377, 15.397870566586795, 13.013066842818619, 11.453266725804202, 12.161403947840757, 14.850773393171787, 13.168420466454762, 14.042424765980414, 14.95348591363575, 12.253599136158181, 15.201060232682398, 14.146186651770691, 10.401392362482087, 17.32417948821989, 11.963101180537198, 9.600822958582862, 10.784425132335794, 10.833858173325945, 13.292414569625633, 12.491707041810395, 12.342677343463123, 14.810617554973428, 14.041529367329524, 13.977915911251428, 14.229964188915147, 14.80055271717458, 8.807029263506399, 12.277915773409552, 8.68659141143746, 13.251660955380643, 13.149296770032944, 16.062581654001566, 16.503493052042426, 13.679424953291, 11.963975872766225, 14.435719006141968, 11.901314108735159, 13.157418836148748, 15.881798227379312, 11.833799100510303, 15.344926053796854, 14.974365630052747, 10.971508524681918, 15.84479035232284, 15.034883583662307, 13.4190402217776, 11.381388188330186, 11.173188606189523, 11.879233411957623, 14.594582188937446, 10.969766311338326, 14.30523339610426, 10.38764059942073, 12.658930584523137, 13.438801054936663, 20.61855670103093, 10.122733682030336, 17.422540711816517, 13.542133120420512, 14.233607751703879, 13.461100274632077, 14.324914336450401, 12.781058132661192, 17.362998827736693, 12.064460539716425, 16.33017824470669, 11.640119298264725, 13.010663614555382, 10.729245114257786, 14.353050616274833, 17.333495712097612, 12.96832468224283, 12.67627002726194, 10.642386851072342, 12.598227509368096, 9.715486818743084, 11.059492010116479, 13.742160532395655, 16.921892348017817, 20.61855670103093, 11.768999262133232, 17.3010700053774, 13.786663580795098, 12.786996220862017, 14.29183342243334, 13.317117533887545, 13.44071671370926, 12.175641693029421, 10.082700726775272, 9.806947529695403, 14.905591540464682, 12.484925517571211, 11.747703844047257, 13.18226057023706, 15.313533653201144, 13.621127986849718, 11.614222316629137, 16.625522365805942, 17.78201906810261, 14.461588685078198, 15.844094030625449, 16.67523338303191, 16.32353478402271, 14.794812811387013, 14.750468390417318, 14.53093743474325, 10.677488055160252, 15.04106436536191, 10.164296237608347, 11.311600006455778, 16.872149844385746, 15.446265450218677, 17.473691411807813, 12.496888320446972, 10.566340123022751, 12.571500366216997, 13.419309777763065, 13.360513473612768, 16.334678455804184, 12.285329885176957, 14.074102637666869, 10.9009938814579, 14.340183414571666, 13.168709704316264, 11.40855360528775, 12.582544117173716, 12.707009990493507, 12.500506891797848, 18.445230645965534, 12.916309960743197, 12.563216643855068, 8.824673135595015, 11.0989113172193, 12.517387979258089, 11.548459124529536, 17.125276192964844, 12.753680318672435, 16.8236028820524, 13.316579919268918, 13.254610600560143, 12.940083124679598, 13.170435595884246, 18.261452000920233, 8.45887180757211, 8.987436774742948, 11.866770590718046, 13.197397582766456, 15.010658750305039, 14.402542634960804, 12.231658467410272, 15.981705536559307, 16.015704684070176, 13.630719598443562, 15.810898390414597, 13.862781445400879, 11.825431843223317, 15.032736315532683, 13.441273549058401, 13.164271912258755, 17.425658599507855, 8.249908021128984, 10.04516023772265, 10.496456586065705, 12.280671364700012, 12.537597033081534, 9.875021331363891, 10.908202806577991, 11.16970648116313, 20.61855670103093, 18.552399417215188, 12.16771772605826, 12.27991632020215, 10.57247290524704, 9.148860442953218, 12.871015856036001, 10.881847581081539, 12.949817096754728, 9.70177449215362, 11.3821451548083, 13.538997172382055, 14.112172056047452, 14.250706368119058, 10.232949915118558, 15.488903721963137, 11.299508788058013, 14.847795190124822, 13.134256353022748, 10.124524284985604, 12.391306234957039, 14.10989749788859, 14.791616569656888, 12.812021089299403, 17.62209948338984, 15.946620071961988, 12.532709768589815, 15.183323884852866, 19.025181778327607, 19.122197562022492, 10.4149058319213, 11.03075061788592, 17.465436953347464, 10.757254984246746, 10.228948931759282, 11.996318854119236, 14.258189348231879, 12.906589398042248, 11.626382377170593, 11.574104477720308, 11.49032108221214, 11.130041429334884, 20.3290171593046, 13.928626658735258, 15.583862351256503, 11.989729147887754, 12.702698190724231, 11.487656772879713, 7.940131282087816, 10.121395751877476, 9.32045642322243, 8.5721822887977, 10.479890492066747, 16.94106598925359, 13.049935685337575, 16.830399372286987, 14.23309418840141, 15.277467867297721, 11.084771348569307, 14.542822701193497, 15.121509332199013, 11.791308393718825, 14.64178847210797, 14.660347795959455, 11.852347680512509, 10.625868010600467, 10.502343165023731, 13.37966531798393, 14.007145838487256, 11.316070771993054, 13.227756413590697, 14.672503588511937, 14.806352849186608, 17.68973179486385, 16.786891501075406, 10.87471755443416, 18.13933610523992, 11.894378719065061, 16.06056319491889, 13.332531067509773, 12.16679035856625, 9.325647452454835, 12.737584879772516, 9.777542214930463, 15.824889886967249, 17.571845320196037, 11.306618386384157, 13.940469000815252, 11.461771957220657, 11.675402872381751, 15.254008478154306, 13.064611160884557, 18.334164613468722, 12.0053788951248, 15.921798444454753, 13.407505917979641, 15.316001952515895, 12.085891792718796, 13.03720257007136, 12.874404314192775, 11.222586418890206, 14.930712981301392, 14.897084250696194, 14.737003645348366, 17.639526001507225, 17.347436783125744, 12.25335809323072, 14.130586039716711, 11.686274515302857, 13.219616864594515, 11.739511848709379, 17.921103282788767, 14.105419690743284, 12.625297734011028, 16.522323905619416, 8.702488504995584, 8.965956543239734, 15.316178958611466, 13.313443260767647, 13.804261127083185, 10.221437298103396, 13.10276976152784, 19.27962493875043, 15.399180745929531, 13.593492621309972, 12.104570286932338, 12.207610875837046, 8.77144647308112, 13.82319896992871, 15.461764750288946, 9.747337036290165, 11.602360986704632, 10.555842986564393, 10.949453391583376, 13.295729008110612, 8.846644208372439, 14.79529566729667, 15.194129543017183, 12.54597543845257, 8.203134174132638, 10.884820330425967, 16.646474344385627, 7.751328105419579, 12.317555858045637, 10.510607189872182, 15.341685397886106, 11.572116309607095, 14.214043243366847, 14.65831593873463, 18.674716185890322, 12.661648719348623, 14.138645294870939, 9.917019013281655, 16.512235800434475, 11.38532455468739, 11.827074454451301, 13.105231748312276, 9.771020940388537, 13.747357104044287, 15.825393622281675, 13.91648256220676, 9.722703943174201, 12.854031646223005, 15.159925893834847, 9.201562037425449, 10.723514651979395, 15.553554729296991, 13.856047061695463, 14.235776941653588, 18.75770819207994, 14.390102785105476, 14.91878606777505, 20.61855670103093, 12.6354658586592, 11.304524756852604, 14.278771822032004, 14.30926522256011, 11.904041074453577, 10.81044704411208, 20.438602655045674, 14.006701684251428, 11.446724232473303, 15.670734324530585, 12.890002015022295, 12.541723234676285, 14.64941469469154, 10.2888863837505, 14.075692449018744, 18.949780478748433, 14.383591114973601, 12.250398969996375, 11.948609583310821, 12.170986292179142, 12.53913934987325, 12.24667735598265, 15.67187255490341, 9.458966367830138, 15.510507974894978, 12.24229065059988, 14.141079599307037, 10.617327370168239, 16.952935637713587, 16.686915428952805, 15.801660093294752, 9.861050881417235, 15.413629698587028, 14.216484165077116, 9.69241403499627, 13.10011412219676, 14.10766794126914, 14.632123335132075, 13.613077001667962, 13.911968534335415, 17.427843166824093, 16.62470166865458, 7.731958762886598, 12.388376508905086, 12.754377249155398, 9.424978500457703, 13.399254920788614, 16.696848717740735, 10.69942443546788, 14.03223552778434, 11.05328599497619, 11.5791794658486, 17.44040900206747, 11.868156925233146, 14.37272667579765, 9.21344197104164, 18.7678009876834, 14.762575467465384, 12.711068847203101, 14.686517053880438, 10.060226609770737, 16.487449979032014, 12.372931929979265, 12.65892833957457, 11.9838400030432, 11.782314572178372, 15.02372600305265, 13.818633133943601, 14.90134068747433, 13.138872520705776, 14.513058074886706, 12.151267403674916, 20.128944207651763, 9.761629625331993, 16.735646936192705, 17.08029902334887, 11.188203699938004, 20.127186574416122, 15.910133310058436, 15.83647357397583, 13.231378824176383, 12.627229773542984, 12.646054644768036, 14.177729794500237, 17.18896239147179, 13.623594841264774, 11.062515410607931, 15.399848198965488, 15.686331815239948, 14.909610347651688, 15.169953851445749, 12.498665621759928, 11.02558902685043, 11.154068873017223, 9.636808632169734, 13.76879971329405, 12.953276758305092, 12.102416494201206, 7.731958762886598, 10.37663648654337, 16.294759381896416, 11.595267826317135, 14.09707198936101, 10.09697577003631, 17.312300902192007, 12.804601610012421, 13.908811346769948, 20.500763201246283, 17.57066479988317, 12.414071769677582, 11.754127776561191, 12.369253688338446, 14.503929904244552, 12.899637107843681, 12.20604932186766, 17.406500926080188, 12.877567109537289, 20.398698474896847, 13.390472766810289, 18.494425897057948, 14.088284141213068, 15.811811356619577, 11.463476792567734, 11.18479201366777, 14.365863091967409, 15.88911475220218, 13.262262786653327, 10.299654143618238, 10.15569129504492, 10.027082584259666, 9.397138398652322, 13.438385174307934, 16.30781661359583, 13.127307300414044, 8.554833597212705, 12.691075076654759, 12.758879462011556, 19.622444058319267, 9.969919095982348, 12.216675901207594, 18.216468425901382, 14.339257222267522, 14.652318869342047, 13.451449638951159, 14.014978767436745, 15.263065566955783, 11.279555523634919, 15.558045694233423, 10.131056324648299, 14.010771445987665, 13.616915865174091, 11.70255979552847, 13.104139233905377, 11.688636556794705, 10.729779232389262, 12.30326604709797, 10.663963587281394, 13.995906329658412, 10.570697069395647, 15.073355847788267, 10.507646669802153, 11.814593188481265, 11.684041685033115, 16.94168277797545, 14.015903966706318, 12.640452954077697, 14.473065311046742, 8.808306538213785, 13.053175408701403, 19.257610964724233, 13.497057505538615, 13.33234443643918, 14.609981282843767, 15.610155301440903, 8.994425625079122, 9.551130577856624, 13.699032425195243, 11.484761825050809, 16.899373271403114, 12.39372286706503, 9.102948451893404, 10.335791557407749, 7.793270859909095, 12.586630187355432, 12.696823463103442, 12.138274657596583, 16.164979678843213, 16.537763077888687, 12.74043995168126, 8.762264946070191, 14.80378789063508, 14.630129665361505, 13.960196804503092, 15.86771134760417, 10.541041261657188, 19.298908349670903, 10.961820084808792, 15.180723272285286, 9.541995809799976, 11.022909375856036, 17.570425549385142, 12.52257389518392, 15.445389611650048, 13.768817495549603, 12.90029095542079, 17.067098596910213, 12.580555401131496, 9.37368012149268, 11.292989671915848, 14.618512574887774, 14.191186972796435, 9.763252180830404, 11.464063424346634, 11.77991247663038, 12.275502944609993, 10.125438677034008, 11.675655674650294, 11.45474323337262, 15.245402368468065, 15.354996408712726, 12.800252140006169, 12.213505039434528, 13.516562151229847, 11.264328584969235, 10.577252771615353, 11.002014786876465, 11.661331120611466, 10.543762053145846, 13.573698015781174, 15.124395378437589, 9.726038193124882, 13.224085137117408, 12.620711253916507, 14.045900523584239, 13.128500664050833, 9.976644455242367, 10.34687593822936, 13.23491279986044, 16.011388228522637, 8.630528584120414, 14.057194886052422, 16.509745236085646, 12.782663859741204, 14.615757061036575, 11.510632623596306, 12.864919711950485, 9.663565315728103, 8.419097672570556, 15.751078029908177, 10.908541859912924, 12.066629433640253, 10.105143472769816, 10.059938520105487, 12.732068290681486, 11.452633230937336, 14.143837207461099, 14.346254476063075, 13.990712225608432, 13.773135456425791, 17.77721703103683, 10.738181303437754, 13.023853056590722, 16.331595016914637, 16.747139998342988, 10.037354127408172, 12.400382456101978, 17.048475121881907, 14.498902784650092, 13.659856546412302, 12.626126447934036, 12.232695740584559, 13.903984694682993, 12.542935794642172, 13.054555950124088, 13.359520529288226, 11.565595999242436, 14.565505595453043, 20.61855670103093, 9.380383728463956, 13.999147418687063, 11.386016168362746, 14.691712600978725, 13.278196895890943, 15.217310038606229, 16.46539536440651, 13.652460811685595, 16.32961099632374, 8.419170535244195, 17.820238978543642, 14.135999130493934, 16.161789601830623, 10.431042380514528, 11.233899531983049, 13.53206170363869, 13.118249382189347, 13.890344663809621, 16.182350913276892, 9.401440427534544, 15.844563724307916, 13.181698589978653, 12.659622278167907, 9.943398747833662, 14.485010470824449, 8.307909524491254, 14.891819121913212, 9.903703975807355, 13.295668923724698, 12.86540357289225, 16.44667875610764, 12.720385127554517, 11.53023855255667, 11.94975401299984, 16.773786976005024, 14.577078049548842, 12.228432740499125, 12.581064631850968, 9.763031077438166, 14.172174972648694, 9.41112820436013, 15.18817010415752, 13.48748020529769, 20.61855670103093, 10.671796588819024, 12.905936691681655, 18.540191195275085, 16.51530745409141, 11.525683468207111, 13.734781210398495, 13.165926490051104, 13.887399597982292, 11.520263219217075, 12.938791158163442, 9.705756680254659, 13.504201864381027, 14.339372897361478, 12.602725540868168, 9.6743675656052, 15.889050016991192, 14.107642532925512, 11.460410020178758, 12.47564930284317, 9.887555187425571, 10.824850235034715, 11.8788966384478, 16.63226527966399, 11.650912989798988, 14.868622584056899, 11.87775385205022, 13.797689504229007, 12.81102595463518, 15.543222840722988, 11.88568968480437, 9.753080391026002, 10.113799690882413, 11.892336670582646, 10.373191405639842, 14.231004331831649, 12.043105079395373, 20.61855670103093, 9.45084851142437, 13.681662121103274, 10.615374850268116, 11.979853963578293, 13.5204139009501, 8.449590966653627, 13.768478309934869, 18.913532673657425, 12.071435241545862, 13.82890963126216, 15.999617279557539, 12.756072724043412, 11.781621278834606, 8.529891955779426, 14.870824493115416, 12.880123166938425, 10.851134259832111, 13.482276787573808, 11.775515653282662, 11.900160917256557, 14.772815516258788, 10.198116500989293, 16.068040302358853, 10.083514467976899, 11.599521272398182, 18.985895289552758, 16.314999569569697, 13.4079928564047, 11.001366944947316, 11.898242159257183, 13.345974846262811, 13.255356749593671, 12.934968629511909, 13.083809872196444, 12.634092118855847, 9.998761842025132, 11.92721271366978, 15.666833980411717, 10.140073854714046, 12.69398954109991, 11.257507055080573, 13.443162240772528, 12.221436372987876, 17.440409104447372, 14.494770097773172, 10.249901603492832, 14.95675980859004, 11.354680658083824, 11.790524037490693, 13.971980196308367, 11.983630350894021, 15.601978611270216, 11.354987477495802, 11.696643821878391, 11.613523043550646, 11.816070602969695, 16.227673047008512, 14.836307434282359, 18.23067645699934, 20.274897372629447, 10.813908518722387, 13.338712771958441, 10.518222074866726, 11.34829044141248, 11.671848485748852, 10.759563838385066, 10.7703699001707, 12.803975206116691, 10.437320357958066, 15.451879142826328, 11.049221334503303, 20.61855670103093, 12.076160809018742, 13.342776630370789, 10.282106735119203, 18.217298381443644, 16.29059903381398, 13.927046907102826, 10.181765939885695, 13.70001294746885, 10.628576446172096, 17.390500193982636, 15.35521124821427, 13.402462351845294, 8.272729991147104, 10.911824642011643, 15.003957261315085, 16.583092919157316, 16.258559337636015, 9.716933367174509, 13.93935744646887, 15.970963013918796, 9.594896556685777, 13.1411015295392, 13.865944341261434, 12.427802758438125, 9.246960911395881, 12.368892818865758, 12.365104830749381, 12.79473582393585, 11.820951821881492, 12.095443246928403, 13.061703521675783, 14.318712947245537, 12.419132657323884, 12.172589177966676, 13.394585475305897, 9.126596705093856, 14.413382248452676, 13.159498972248851, 13.260840046307026, 15.805104664282187, 9.071285044975518, 9.035024054976631, 13.86584247092043, 13.143074157501575, 13.594711212200492, 12.05146423529874, 14.93717921637267, 15.72071030866355, 14.432476517135637, 12.522744197778064, 8.80747227069357, 15.23873036120998, 16.61106791782063, 14.880938238355828, 11.129759768130905, 14.964076368376757, 15.506162616825511, 17.71312917728943, 11.137254505623085, 12.605042915463404, 15.17508061971544, 13.305686208672777, 10.636890930437628, 14.242953387364857, 14.69523802669936, 13.3833816339481, 13.723315410845318, 12.527810470250808, 17.44335156945255, 11.085203993522072, 11.767349434494225, 13.18849169241485, 15.560700756720493, 9.893767954669087, 10.252844458406166, 8.925680218366894, 13.243166813092369, 10.63490826010275, 12.230949428979287, 14.928711914671778, 11.64638604756302, 13.75393949427821, 12.431182013498582, 14.959286187839176, 14.408145120132891, 11.535084218001776, 12.744657066996123, 16.05710691125406, 14.185421861714987, 10.084905975474312, 14.912334019593096, 10.703415849276013, 17.226104571126502, 15.99710863087707, 13.908400731994776, 13.561218662697016, 12.646962171479673, 14.97756935430716, 12.26309100878029, 13.765182587724057, 15.539899156260638, 11.82470281846519, 11.702783583380741, 10.481874780554955, 10.744569801100724, 9.288935919866836, 15.124721399521421, 18.577774945260362, 17.268226438993114, 9.654047498398723, 15.1103916203172, 17.25762507328734, 12.063681560294652, 13.417816771817547, 8.976572404066246, 13.847179858393156, 10.746439395612672, 13.67124193258577, 9.774152267519755, 14.59531578224658, 15.998370250239839, 11.336242758634041, 10.597245712295177, 8.726721945868897, 12.509423119754418, 11.780198505268524, 9.793138550488704, 14.34756772374534, 12.07941542632952, 10.721532732807718, 11.841015234831879, 16.14166348627606, 14.763375843679615, 12.838812558039715, 14.80893284112163, 10.548910735332656, 13.24234632927038, 13.535631230305595, 12.033771899008958, 14.299635384104574, 11.342177333225633, 14.503715588490191, 14.620370920140983, 7.731958762886598, 16.511896407452767, 7.731958762886598, 11.703104090296822, 16.000917228709287, 12.388734950976579, 9.952743370185921, 10.68481691501235, 16.0056677187983, 9.125573058398567, 16.320087838315537, 13.023438010789242, 10.485810840870583, 11.776784217041968, 10.841749312218, 15.523001498560987, 15.132214241565517, 9.484322357616554, 12.18664704582011, 11.164718310856149, 16.839851321228434, 10.17537167221149, 17.86708516056506, 13.07767222321222, 10.546855558105408, 11.567353473211133, 11.296479212238243, 10.322791318387317, 13.400898918345304, 10.41507320419057, 8.686332941034816, 12.242314106742487, 9.334253942937718, 11.403451064866108, 11.067451065774517, 11.147645890090544, 19.2702720410422, 13.303154651272223, 13.790916512667229, 9.381435490337624, 11.618852939092, 13.71212101767346, 10.826668185605142, 15.647257454375016, 10.465246827930246, 12.461949393240126, 11.770195708487176, 13.579547983601973, 11.648722517449482, 12.498747801530218, 12.581823052709975, 11.442139156801703, 14.435534023326689, 13.772577945560894, 12.94053316894643, 12.124413958294143, 15.318237889473517, 12.582532412054448, 12.413760292581644, 13.426110527062328, 18.184330718974373, 10.194281348763617, 15.240532912478772, 9.174978324261511, 13.717271059417191, 17.768122090414103, 14.445370893268, 13.595872232000136, 11.827761202709691, 13.23900838417011, 12.54367992061368, 11.330202599718453, 12.453617851302067, 13.667975707678785, 11.37077944247926, 11.286445639484782, 10.155720186799083, 14.17825510900904, 14.602173520849206, 13.754931377303373, 15.818471620238713, 13.383138687265305, 14.181729901690161, 13.945428834635067, 12.93331946496058, 11.894729320900868, 20.069273080757647]
thresholds = [10.246337622052778, 13.128068698718916, 16.7995750717602]
display_name = "Drug Cost Increase: 1980s to Current"
units = "ratio"

# Calculate exceedance probabilities (1 - CDF)

sorted_samples = np.sort(samples)
exceedance = 1 - np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

# Create figure

fig, ax = plt.subplots(figsize=(10, 6))

# Plot exceedance curve

ax.plot(sorted_samples, exceedance * 100, color=COLOR_BLACK, linewidth=2.5)
ax.fill_between(sorted_samples, 0, exceedance * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Annotate thresholds

for thresh in thresholds:
    exceed_pct = (np.array(samples) >= thresh).sum() / len(samples) * 100
    ax.axvline(thresh, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
    ax.axhline(exceed_pct, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.3)

    # Add label with formatted threshold value (use format_parameter_value for full units)
    ax.annotate(f'{exceed_pct:.0f}% chance\nâ‰¥ {format_parameter_value(thresh, units)}',
                xy=(thresh, exceed_pct), xytext=(thresh * 1.05, exceed_pct + 5),
                fontsize=10, ha='left', weight='bold',
                bbox=dict(boxstyle='round,pad=0.3', facecolor=COLOR_WHITE, edgecolor=COLOR_BLACK, alpha=0.9))

ax.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=12)
ax.set_ylabel('Probability of Exceeding Value (%)', fontsize=12)
ax.set_title(f'Exceedance Probability: {display_name}', fontsize=14, weight='bold', pad=15)
ax.set_ylim(0, 100)
ax.set_xlim(left=min(sorted_samples) * 0.95)

clean_spines(ax)
add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from

output_path = get_figure_output_path('exceedance-drug_cost_increase_1980s_to_current_multiplier.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Exceedance: {display_name}',
    description=f'Probability of {display_name} exceeding various thresholds'
)

plt.show()
```

*This exceedance probability chart shows the likelihood that Drug Cost Increase: 1980s to Current will exceed any given threshold. Higher curves indicate more favorable outcomes with greater certainty.*
