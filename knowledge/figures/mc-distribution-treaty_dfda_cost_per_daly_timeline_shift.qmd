```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Cost per DALY Averted (Timeline Shift) (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Simulation results

samples = [0.1255619901424029, 0.09959876847752377, 0.1359056673145141, 0.14057835784974101, 0.0863460745357027, 0.09543633842596584, 0.1216976356458899, 0.11259878720105941, 0.11863938006527167, 0.10274244064832407, 0.1390581468785654, 0.1365681401624373, 0.12037954002839057, 0.14531558517482734, 0.1292395572797555, 0.10263497537879047, 0.1269947360402283, 0.10094449669252581, 0.13903471906221873, 0.1179518903828651, 0.11520092083772267, 0.10576788232383352, 0.14779003870951588, 0.11581239109416148, 0.11043814426993186, 0.11190098949779473, 0.1307355829666269, 0.12692030986133115, 0.12798920352886922, 0.1284006484412983, 0.1734829926663259, 0.11085626702349924, 0.10885616136172366, 0.1034216407523659, 0.13269426475922136, 0.14536019714323686, 0.11663675398536427, 0.10296460848299215, 0.10323578615812226, 0.13351342282873677, 0.13573181611200935, 0.13098774670180896, 0.10604510923017, 0.12396024085842784, 0.1214585258857615, 0.12366535224637165, 0.13886125594690873, 0.12377266255496949, 0.13418751494497597, 0.12041235481052329, 0.12521570996052972, 0.13305592251168907, 0.09310982346281774, 0.11253188527830113, 0.10964169984503296, 0.10652631299180182, 0.11340474567213626, 0.15506695549760097, 0.10252269801504355, 0.14127236525583947, 0.08989676581085351, 0.11223563945590513, 0.12244954581034583, 0.1319941840082117, 0.13496086052491515, 0.13694648105715518, 0.11196701726779312, 0.10979304643754122, 0.13852949639568007, 0.11507157666108887, 0.09584395425314729, 0.0980847219883183, 0.10160878468577374, 0.12992184699707215, 0.12201110890307697, 0.13446394418728932, 0.1104586114830669, 0.12235851964188892, 0.13292119732544472, 0.11273350237119159, 0.1289935058586065, 0.10610968629717575, 0.11168978582561732, 0.11132962783431775, 0.09709002989280177, 0.12968697948982058, 0.10965999386907872, 0.1192513917802913, 0.12954367966769006, 0.12875915597784002, 0.13386507771303452, 0.11695273375602495, 0.1105339294116558, 0.11733766466189305, 0.08983529139211809, 0.09325760923274866, 0.09512261453306499, 0.10030446427648589, 0.12769532528672697, 0.10184577005509177, 0.11139842978203093, 0.14980832679161096, 0.11182104431365646, 0.13559335380829562, 0.10136938255235727, 0.11478843830219047, 0.10109319965500695, 0.1121550424139364, 0.1380949681450942, 0.08928829706371595, 0.12848276581492057, 0.1240824822051096, 0.10734134017351137, 0.09327315163656795, 0.12050885349144588, 0.10853473073268222, 0.12397152631710065, 0.1194476835264923, 0.1580015852080847, 0.11411249329745866, 0.0998700928288907, 0.12280725196153386, 0.12369394848667692, 0.1514030397226268, 0.13796740740450433, 0.12672757454565878, 0.1542064995662541, 0.09720174272441476, 0.10651047825994109, 0.10148828539679611, 0.11117450044873045, 0.09430552250518873, 0.13314733648392976, 0.1144533045386231, 0.09290962117485213, 0.10000081402535409, 0.1257577543193691, 0.1380414062326031, 0.16922476742874282, 0.20528091971721932, 0.12802728515894457, 0.10043257111755272, 0.084110932701658, 0.12474217114716404, 0.10343609472333812, 0.11068538704302751, 0.10701328213702375, 0.11609066446761135, 0.1437448673635187, 0.12232632382806698, 0.11572939764432673, 0.09966992377961648, 0.09000969998347887, 0.10934184036023939, 0.11787215953757994, 0.1626526442449493, 0.12174988585937, 0.14163579230253318, 0.1090982580931973, 0.09726212154787907, 0.10084006979435947, 0.10497715483965524, 0.1730928189148914, 0.10328944430298284, 0.1380503084050936, 0.10188913920872567, 0.14035388589277334, 0.12736005346383117, 0.11576975822529027, 0.11814159199761494, 0.10623847660577518, 0.1287486667566364, 0.1099323256186564, 0.0966224128900762, 0.09580920457134047, 0.12266232186930105, 0.15737468064218862, 0.12238987849346686, 0.11654109816193367, 0.1251427332067666, 0.14998774717510688, 0.12368052072103948, 0.11076999834401326, 0.1447766063824068, 0.1283536151071644, 0.15618279769143165, 0.12289313563219173, 0.09664020290535083, 0.09443378149547438, 0.1593664753066195, 0.1614033516430728, 0.11530834025547676, 0.11130175168229717, 0.15415607508094, 0.09850686686556061, 0.10202868680710857, 0.1333410362336478, 0.11108247699064712, 0.11888292331780997, 0.11563229182112568, 0.12629493251137638, 0.15269804592648079, 0.1209011566055757, 0.13335554699472627, 0.08510589949418128, 0.11797686753256648, 0.10291155504779903, 0.09672880009250379, 0.10231161834402552, 0.11225044519998251, 0.13996350255649745, 0.09506633653214512, 0.11963218535946754, 0.10938201710903342, 0.11237594608619786, 0.14214033471152795, 0.13087052317242362, 0.15082183083781678, 0.11581287261881368, 0.10549894678361504, 0.11442070322966395, 0.12418700054635447, 0.12274866705454866, 0.09887367284776298, 0.12089913079455844, 0.12387407394668702, 0.18732590862302734, 0.16575750208082085, 0.10273900826606099, 0.11316393450630084, 0.09301753380435963, 0.10740443326046108, 0.12580434116966532, 0.14735403601353825, 0.1049086877426703, 0.10625005686858632, 0.08392371953583863, 0.11564797728318733, 0.0992314592320829, 0.10853572156600406, 0.10233371482312723, 0.11703921508577063, 0.08887662891865797, 0.09296470604491361, 0.17311581969769926, 0.09566302621168375, 0.09867270251905455, 0.1646141223806095, 0.20474895986458905, 0.0974740780929046, 0.11158949169243673, 0.12638405638350853, 0.16154500029067448, 0.1004771847403049, 0.11399498521110334, 0.13655710461785442, 0.1284905742221555, 0.11143706584637485, 0.11623211378757171, 0.09433242728995761, 0.11413596245628295, 0.1135773720358663, 0.12396042851423955, 0.1080557381397819, 0.12933204535254877, 0.1423919455582087, 0.1222913728446145, 0.12661274169249204, 0.12010707814570826, 0.11899167976108252, 0.1050423133859063, 0.1258241577576639, 0.11697727772149658, 0.1720504889881131, 0.15721648967385835, 0.1273802827190288, 0.1043084783946267, 0.09842031394715395, 0.1469706391093883, 0.12463269382307521, 0.12952980337050704, 0.08905409736680119, 0.14025078514292688, 0.12893959331338897, 0.09845225082487417, 0.10961998240946437, 0.12465404096365314, 0.120092527845204, 0.1130699243779197, 0.11685038292698341, 0.11386223786754536, 0.1222295211830836, 0.15442883457038603, 0.07405150038038384, 0.11416225055818183, 0.1227473463345217, 0.1253681999879836, 0.11151879555736774, 0.08889019700563691, 0.12608076760772446, 0.16150706077017316, 0.09199470025355119, 0.13867371994849853, 0.11235935639841382, 0.11771643112064757, 0.09938702997514666, 0.11224397623153365, 0.14982993980134107, 0.13191052052138716, 0.16164679222984807, 0.14661357893543192, 0.12858913760375187, 0.1619744988395266, 0.12858700345659274, 0.13779275523360163, 0.11298362170724179, 0.12039045592387057, 0.10547246558343576, 0.14180810928631069, 0.09736723935671761, 0.13667890344644895, 0.11508468499636908, 0.14645352430051012, 0.13591576646394718, 0.16414999548367734, 0.1354308897280538, 0.0914485962579979, 0.11760036517993501, 0.09746708562822891, 0.10874352172972639, 0.15551144867951233, 0.13320376067150277, 0.10544553983046315, 0.10003158663891036, 0.1196774327795322, 0.09676412748798392, 0.10594376150189261, 0.12572425190982153, 0.14604053542730752, 0.13252409917284788, 0.08084726834421598, 0.1255542005815716, 0.12050681812833887, 0.12801549350105274, 0.15840137129521156, 0.08494534269263118, 0.10739716626477461, 0.13210412743845956, 0.09131286119499235, 0.15454995672613467, 0.1269858618276928, 0.13824916652679536, 0.10776759169235309, 0.13744463082936245, 0.14380843869836288, 0.12397594992472312, 0.12400933720275294, 0.12480027719706675, 0.10256536191769665, 0.11595408831398085, 0.11585299019555251, 0.12732489088849164, 0.14206629100700488, 0.0992948183398, 0.11641134140114208, 0.1546997056392553, 0.10465183512487075, 0.10327447026478123, 0.12330784774530365, 0.13819512282336935, 0.11922901270553553, 0.1505972853304309, 0.13850038659449038, 0.13813210115296942, 0.1312431537109869, 0.18019057860275242, 0.11479395635345606, 0.08568463150031425, 0.15807010755275566, 0.10988096017910486, 0.12127015887076545, 0.15008182895313754, 0.09102053903276718, 0.09621632471967076, 0.09103438508595509, 0.10376371401002527, 0.12860168880412648, 0.13054708521613922, 0.1249313359251981, 0.09376613117341051, 0.0803625762532449, 0.12013240409515946, 0.10961524791661865, 0.12905329942152036, 0.13473847076237866, 0.12192108318441051, 0.13613989473865964, 0.1238956048661728, 0.13068345950406246, 0.10534299456562787, 0.11530648559895275, 0.12318743276637899, 0.13761008140557052, 0.11109904905684989, 0.1304770497399963, 0.11358820264415621, 0.11656344226769644, 0.13783027251577978, 0.08581560201866127, 0.0955239021637224, 0.09274331303350358, 0.07976114986497031, 0.10581572423094303, 0.13588108022210538, 0.11321304867052, 0.12320950170691837, 0.1443388215704501, 0.1505633934855161, 0.11755535307128247, 0.15125343832624294, 0.12093399667002544, 0.10301224975389282, 0.10733675345723903, 0.09276737894033885, 0.10214109362476051, 0.11178714250744358, 0.13719605378665825, 0.16132187538180934, 0.0942230220856273, 0.12753808437430858, 0.09958957515199511, 0.12940459833110624, 0.11628771941041063, 0.08790113173993831, 0.1402721873308645, 0.10714282888995565, 0.10845280784984096, 0.0991117533197116, 0.1062475856791553, 0.12833389194620412, 0.11511291820195674, 0.12609565642211124, 0.12684108572728475, 0.15037670898238528, 0.11208218416763517, 0.0928211109787789, 0.14377656110380302, 0.11230169621281094, 0.14498999169902135, 0.12732451255767843, 0.11628668506689274, 0.1265458766886384, 0.16789649867629952, 0.17157393390386502, 0.12045055935903783, 0.12239417675438945, 0.14400683697761102, 0.10286962865097456, 0.12619417995348234, 0.11845083160122905, 0.12576653844848695, 0.10308190518361018, 0.09119987120835363, 0.08482603293736694, 0.09834021026005679, 0.10986251208654013, 0.11304990155909546, 0.16749755478722372, 0.1447690220341793, 0.10089073125468603, 0.12652193938350362, 0.11084358134673218, 0.11322327507540128, 0.12293853100756948, 0.13276958230048144, 0.1121506647358737, 0.1436905699968022, 0.09794618442489905, 0.11912249398766661, 0.1904281830460645, 0.12376137749895627, 0.1533918784319137, 0.12092107713526154, 0.13186649211481044, 0.11781017033578259, 0.11549180892117793, 0.10402005957296967, 0.1283888086557608, 0.1027683789782656, 0.13386984172620092, 0.1442381980990776, 0.12694477809025387, 0.11318622805486567, 0.1289291847260399, 0.11274667005607061, 0.14045305457523866, 0.08789453671967498, 0.11222159878112739, 0.08584380563334663, 0.09255577299417836, 0.15152798028432485, 0.139448987435036, 0.10507924862072232, 0.0924476739575842, 0.06528245494328071, 0.10827475041043995, 0.18364133123084053, 0.12849326935247307, 0.10797730656524793, 0.12918383185810534, 0.09160649994223527, 0.11296887144010094, 0.12109071680584885, 0.11720658333763902, 0.1368846042998062, 0.12645327333724557, 0.1339351042239949, 0.10563443680382716, 0.13951421207602527, 0.1587546290147804, 0.10075588675246135, 0.10214857091456428, 0.1507788617687241, 0.11507078099365034, 0.15259956322870036, 0.11016815204566677, 0.1539825806441959, 0.12177589699102671, 0.12453305812742319, 0.1569785521792236, 0.11171458003865237, 0.10124289771341966, 0.11005385669407015, 0.1288918480070721, 0.09153803423013872, 0.13320227082002178, 0.10836236664380998, 0.1458465381667622, 0.0782318233266674, 0.10389603335571672, 0.08984721299634449, 0.10320549033144033, 0.124300585938961, 0.11531422599675022, 0.11383451850592877, 0.11571828388405195, 0.12333142459980627, 0.10011730578733732, 0.1348558439355166, 0.13380036535979156, 0.127362017734066, 0.13129953594189953, 0.12537761186631585, 0.17034439185779165, 0.11718619445580536, 0.1127777617788828, 0.10447634176146015, 0.0997256999379473, 0.09632793703076603, 0.10212977392286557, 0.1175235869012522, 0.12622156749907787, 0.12006453973434823, 0.10426489110664766, 0.1395729835499306, 0.13563911201228845, 0.11570892056883135, 0.10627227978300953, 0.13111055156888163, 0.12299603894047147, 0.09324265792431505, 0.11757920189152378, 0.12461696333387996, 0.10194411291802463, 0.12303666599190916, 0.09314412122646416, 0.15078955828975626, 0.14845609180084446, 0.11385154730117807, 0.1268755487497075, 0.07784193142398554, 0.09771612377482053, 0.11303837861536609, 0.09907296641613741, 0.1350369682156839, 0.16924124699008344, 0.09739400519614674, 0.1030111235723153, 0.12403230776734994, 0.1582601699880655, 0.09667299993520842, 0.12433071471837753, 0.16416859893468838, 0.0903273633487516, 0.0957609002179311, 0.11052805491976496, 0.10870049021922505, 0.13741622099330714, 0.1241686176746778, 0.08864496388507512, 0.13034368168854396, 0.10764621533435524, 0.14915349717577422, 0.10673123301415, 0.10656733491803226, 0.1309406782515186, 0.13620754824848666, 0.12879500118863038, 0.08985920037981168, 0.1308686398031649, 0.09969205197921067, 0.12402852993099164, 0.09360321023502471, 0.1287543788354507, 0.10354642085433463, 0.0957367688150489, 0.13502312704905642, 0.12416828411557279, 0.10697899678813819, 0.15387781734710915, 0.1102038898171295, 0.11966324118206693, 0.12476870570459916, 0.10687533767152962, 0.1293228093524771, 0.10846112893204801, 0.11075641128385903, 0.15149537549663059, 0.09958888360288708, 0.07777099580919078, 0.1582552052767002, 0.18855179282210316, 0.11087818666148132, 0.08652686377449145, 0.11271126837043631, 0.11318673451378422, 0.11509927929791117, 0.09840457425650845, 0.1318379953593965, 0.13055449600351202, 0.09256530027521016, 0.1346724245578791, 0.17086037516771105, 0.12264873157772123, 0.11218821817881802, 0.11606607581613633, 0.13267721782689354, 0.08924274600536246, 0.12248494653029829, 0.11116194150579103, 0.1649259828590131, 0.11541595128799179, 0.15983960085832521, 0.09856023753352405, 0.13201851272430248, 0.12588894029990197, 0.10246753930158167, 0.12276650079543604, 0.14752804174471526, 0.11245155107766679, 0.08977164956799047, 0.11862351780161155, 0.10189770919963444, 0.11209082386044604, 0.11729924964251189, 0.0895839119757826, 0.09083192858688502, 0.12957405211432252, 0.10866080235803899, 0.07409659109797896, 0.13673953498004002, 0.12484504085878882, 0.10517898352086964, 0.0952121722797986, 0.13798450056857256, 0.12655876718996856, 0.1822263986336324, 0.12815862701274908, 0.12742222952725685, 0.11556196982513937, 0.137518277297342, 0.13290925895383904, 0.14855527466278684, 0.10868680385746052, 0.11030350044430184, 0.10947727867093643, 0.13688449708009223, 0.1551605625277766, 0.10985938929506925, 0.1105058193638955, 0.12577030344390344, 0.11398539529589953, 0.14086567032173536, 0.0818752917192009, 0.10319725088366682, 0.10396866189978352, 0.08009973962630745, 0.10086481794461342, 0.10168155960435817, 0.11487514885254682, 0.14494817062843454, 0.11399929200386423, 0.09974954697507173, 0.11780663173885017, 0.1433166917833696, 0.10065884754115924, 0.10175924925003217, 0.13134657309923287, 0.11446698861108946, 0.13343965489932477, 0.11870509781390692, 0.134731522200027, 0.0996793882471435, 0.11873765950424976, 0.11468343494177126, 0.09677462555910378, 0.0915705548456233, 0.13435073213402923, 0.11192386496160743, 0.09989017006374572, 0.11699995986801272, 0.14533562450992438, 0.08112045724376069, 0.09253283673360793, 0.10155066790465755, 0.15414887522871065, 0.12507100168010293, 0.1363139563187104, 0.09797462082818312, 0.09830557959989532, 0.12878847098862184, 0.12021531663691076, 0.13111779480291388, 0.11514450593474239, 0.12497267997312064, 0.12234943715592726, 0.13656754394720397, 0.13727960512666518, 0.0907727645333477, 0.0819934747415852, 0.14211477688105553, 0.14688168905949914, 0.09991751564206935, 0.08752138846720799, 0.12108127265668005, 0.14033555760409036, 0.16349397228361265, 0.1303642249886302, 0.11152261049230046, 0.10205588670382147, 0.11922954142007926, 0.11293082479405504, 0.10000926189044619, 0.17074516160289982, 0.16314115347473038, 0.14554269248825277, 0.10158511799486136, 0.13845668850096865, 0.13325333193235978, 0.12866810335390863, 0.14850115088439492, 0.13315254946026606, 0.1356536247339959, 0.133188898919545, 0.12636694388259342, 0.08852914661771226, 0.12075295240466992, 0.10803975516438014, 0.09577984064629086, 0.16022899888555153, 0.16155338351984222, 0.15140392212395043, 0.12446664412368759, 0.1511744176936869, 0.11924215242386159, 0.12331854738580704, 0.09872636452142146, 0.12763230837766493, 0.12025999877500015, 0.09542909331992139, 0.11792560283705515, 0.1173374312764588, 0.16349302466528567, 0.13942490144276093, 0.11922941885133745, 0.12432524295172552, 0.1199182587034164, 0.11483893030739392, 0.09890551870406185, 0.11588275163390398, 0.10460747732387601, 0.0962370225088519, 0.13024673564112363, 0.12750273902663542, 0.08848775677518111, 0.11645866344862062, 0.14196229117002826, 0.14357259261913174, 0.14272411472856614, 0.11980653887994767, 0.10288024615423708, 0.0988848648222198, 0.12645236983995928, 0.1272320423478778, 0.1494936365541201, 0.1446146712761872, 0.11626450836155224, 0.09633207733373524, 0.11254289910271187, 0.12363350039811052, 0.1148555579913371, 0.1076396833382101, 0.12441538429256907, 0.10901099804337934, 0.10672253637775637, 0.12571185805138005, 0.11094090474620198, 0.1242223131857164, 0.12486347400560935, 0.09798633515416806, 0.10943706497915776, 0.1535151715400767, 0.09762485003197441, 0.08429596557380307, 0.08749513142130627, 0.11960018528541594, 0.11963819696449142, 0.11656204206431377, 0.14757169446943721, 0.07159531460594981, 0.12760837252508153, 0.15688827240238867, 0.09817306539387206, 0.11136678754524511, 0.10448755263404311, 0.10203517690980846, 0.112403424974067, 0.15323717212759552, 0.1646276364193643, 0.11221514911921013, 0.16656890973870997, 0.11973625503676519, 0.1622499726319928, 0.11705896574102923, 0.12176670569737047, 0.12692099398722118, 0.22513618934256777, 0.13836479528711956, 0.10529677031393089, 0.14129042654577248, 0.11171338096946944, 0.1092772100392281, 0.13978197141004703, 0.11964173777186647, 0.12498223986149519, 0.1192826432431249, 0.12627274812425807, 0.12826730989425592, 0.0865252189805916, 0.1338933503407953, 0.10055776158486984, 0.09332858249353009, 0.1177765534142645, 0.12076060712482214, 0.10554252640537479, 0.13786735734201058, 0.09482646638699004, 0.11084615360350634, 0.10751143973517703, 0.1180209648110144, 0.12498861890539577, 0.10012795291412475, 0.1352746084366643, 0.12031539084689462, 0.08710379392793857, 0.08625017798649211, 0.11873276791494584, 0.11447832700791506, 0.11685177647104476, 0.11840678031206199, 0.1238156494454338, 0.14075546889077528, 0.09844137835834046, 0.09746765062679195, 0.09872875408279184, 0.12521121625134954, 0.14837724474967215, 0.11038084164470365, 0.07559813448290563, 0.08960662801757449, 0.10308764884027272, 0.10801135565765647, 0.11081852287494062, 0.11979954169642344, 0.11268659869086324, 0.14332091498865157, 0.10585608669634573, 0.10258300113385876, 0.1295006450571754, 0.09196909836129756, 0.12746717492007506, 0.1211563616186224, 0.11595583435020038, 0.15762823624653918, 0.10682907485498686, 0.17108375597001704, 0.11438937817795118, 0.09582342039832831, 0.1204619772534704, 0.0990060233102566, 0.10450759321683524, 0.12763325893955652, 0.13127733993936144, 0.1068297980048032, 0.1417532341795061, 0.14609737947713838, 0.15347529787999808, 0.13066833860372862, 0.15151638977061999, 0.08724830339465724, 0.11256631232107725, 0.10250255552660059, 0.12151292631410118, 0.10775828091712608, 0.11557750430035078, 0.16591056635545728, 0.11550567257134993, 0.12801326848668323, 0.11425330017264108, 0.12058491642931268, 0.1191157471724387, 0.12880013836115722, 0.14629946574448394, 0.15926802720386585, 0.12567106046844853, 0.13207220885520163, 0.09780356570791017, 0.11717013790667509, 0.14057148129763222, 0.13872651119821328, 0.12351072967536424, 0.1392312161597638, 0.12977439415054373, 0.1472093531793996, 0.12522102469714672, 0.11183198854429739, 0.1262561504752443, 0.06598543969589361, 0.127313418339903, 0.06073728598237801, 0.08934077937244295, 0.1288789136576498, 0.1294696927880963, 0.09761929267751941, 0.10521055392001571, 0.15170663780023608, 0.10938463492268313, 0.17709819762072335, 0.11894979791812334, 0.12788261019390973, 0.15841980570734715, 0.12176604611743734, 0.10021989448366563, 0.11672289002211889, 0.11824840637285655, 0.09448527054668221, 0.11378594777694823, 0.10467651982437919, 0.140174009749095, 0.11971594610702413, 0.11325410725639276, 0.11679531918146153, 0.12376230234179826, 0.13271395960545235, 0.1002635455636169, 0.09957243986670132, 0.14473527948755774, 0.1107430657433766, 0.09370552798461815, 0.12869704335399265, 0.12914460966140776, 0.09203996662940586, 0.12390152685257488, 0.13554675862946589, 0.12712169165564952, 0.1330723241725301, 0.09389267724820755, 0.12614879551495806, 0.11286511027655355, 0.1094079407805972, 0.1388396994627425, 0.1546403781401775, 0.16340236410251044, 0.15022128989749228, 0.11672275245333613, 0.12663437095684324, 0.1363019711971158, 0.12155475384185402, 0.12176039987897591, 0.13768901787518684]  # Truncate for embedding
baseline = 0.12590044674178746
mean = 0.12093913214036481
std = 0.02158911461319196
p5 = 0.09001784196744192
p50 = 0.11871508711841847
p95 = 0.15913844934180954
display_name = "Cost per DALY Averted (Timeline Shift)"
units = "USD/DALY"

# Create figure with two subplots

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
# Handle edge case where all samples are identical (zero variance)

if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax1.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key statistics with formatted values in legend (use format_parameter_value for full units)

ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {format_parameter_value(p50, units)}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {format_parameter_value(p5, units)}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {format_parameter_value(p95, units)}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {format_parameter_value(baseline, units)}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---

sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax2.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key percentiles

ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"

exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title

fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark

add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from

output_path = get_figure_output_path('mc-distribution-treaty_dfda_cost_per_daly_timeline_shift.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 0.1259 |
| Mean (expected value) | 0.1209 |
| Median (50th percentile) | 0.1187 |
| Standard Deviation | 0.02159 |
| 90% Confidence Interval | [0.09002, 0.1591] |

*The histogram shows the distribution of Cost per DALY Averted (Timeline Shift) across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
