```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Total Economic Burden of Disease Globally (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Simulation results

samples = [113362990396308.36, 89295636144350.95, 122694669734060.5, 126904921443772.02, 76500000000000.0, 85235770802536.38, 109859786081367.03, 101534031499923.77, 107075642028173.5, 92307798093069.16, 125534793330643.86, 123291447099210.36, 108661287200141.58, 131179608866992.88, 116685879107882.48, 92205492983409.36, 114658593634703.31, 90590158930933.88, 125513682333390.39, 106448032745557.78, 103929201046387.84, 95170833430479.2, 133417093865553.94, 104490174819888.94, 99534310057398.55, 100889363594525.4, 118035506954461.44, 114591327155498.03, 115557052180897.83, 115928600937753.52, 153000000000000.0, 99922136338961.88, 98063001330485.3, 92953375489093.06, 119801277561403.94, 131219915280185.72, 105245433746605.75, 92519158496005.64, 92776892767420.69, 120539457289419.5, 122538058220258.62, 118262904492246.44, 95431628636442.77, 111912642558625.28, 109642523606541.16, 111645380323038.83, 125357376837131.95, 111742646922376.81, 121146820529408.53, 108691150085871.02, 113049623965614.53, 120127200583827.19, 82923440754443.02, 101472269530438.67, 98794384783550.77, 95883736561282.7, 102277330713972.11, 140025259617703.08, 92098559282940.11, 127530616722483.94, 79667416948268.17, 101198666397909.33, 110542580307514.56, 119170279632707.47, 121843539542624.22, 123632273534083.64, 100950409847875.72, 98935113947444.47, 125058446659037.16, 103810452225317.9, 85637467866630.33, 87829220572260.06, 91226299523486.53, 117301522031836.7, 110144520057460.83, 121395867298323.44, 99553304014096.11, 110459953824319.98, 120005790798365.47, 101658368316637.52, 116463807666302.47, 95492343036048.86, 100694028276348.83, 100360696599120.44, 86859612540036.4, 117089620823732.25, 98811398675773.89, 107633777535923.28, 116960321165654.62, 116252268582589.62, 120856310427169.14, 105534625593794.5, 99623192102880.12, 105886705692201.16, 79604318546445.19, 83071373413989.88, 84925934582983.22, 89975475802699.33, 115291609841931.97, 91452804075034.16, 100424396760368.39, 135245253940594.28, 100815436737959.03, 122413326087514.28, 90997252639650.39, 103550400408165.23, 90732721145882.69, 101124196586070.3, 124666943004466.0, 79041426012365.33, 116002744342970.52, 112023408122389.58, 96647871055647.58, 83086922626469.34, 108778960241630.31, 97763257091276.25, 111922869224357.36, 107812679655995.48, 142705519304992.84, 102928961722699.0, 89557284844369.66, 110867193450941.36, 111671301214049.08, 136692071435103.72, 124552017324933.22, 114417115733888.05, 139241243107152.83, 86968765632074.02, 95868870787781.17, 91111041832668.39, 100217031712888.28, 84116152419961.95, 120209577556157.67, 103242399593918.48, 82722799474367.6, 89683225387774.89, 113540105482959.17, 124618686186426.83, 152926700933403.6, 153000000000000.0, 115591445184576.5, 90098651274797.6, 76500000000000.0, 112620936019500.25, 92967095371850.3, 99763688845778.78, 96340537098100.02, 104745250587253.47, 129761158692697.38, 110430726903452.81, 104414073914759.14, 89364286351588.92, 79783250114168.75, 98515388123804.73, 106375201118395.28, 146976083869180.53, 109907253568172.78, 127858332490075.33, 98288580716779.72, 87027733334036.08, 90489988332735.25, 94425605512543.4, 153000000000000.0, 92827858255369.34, 124626706479594.81, 91494230419468.2, 126702574615127.39, 114988714587121.7, 104451084225358.27, 106621280913498.69, 95613390790777.75, 116242799791839.12, 99064570535847.0, 86401982211209.36, 85603260295364.34, 110735687537350.06, 142132091500694.1, 110488419812300.8, 105157855221119.36, 112983571322772.28, 135407926854275.4, 111659129899947.23, 99842153045148.6, 130692733902587.61, 115886132952391.34, 141043192967094.88, 110945112108270.69, 86419414198658.89, 84243538766685.66, 143955703594117.38, 145826032119526.3, 104027797827615.72, 100334884345045.1, 139195322812528.33, 88239199196848.06, 91627476209020.88, 120384123295328.77, 100131781387595.03, 107297808872265.55, 104325017413949.62, 114025961106192.19, 137868658795211.77, 109135823411634.62, 120397199011660.78, 76500000000000.0, 106470846484995.1, 92468702895592.78, 86506201820083.64, 91897393372127.4, 101212345157615.66, 126350701452802.23, 84870291528973.34, 107980789202685.9, 98552783033605.6, 101328272766848.84, 128313373634264.69, 118157196844201.8, 136164509852940.42, 104490616214082.95, 94917602677917.66, 103212426474010.19, 112118103711483.14, 110814037642037.53, 88594724447984.22, 109133981021651.92, 111834556623918.64, 153000000000000.0, 149844618216092.44, 92304531256541.88, 102055383175389.97, 82830983029861.62, 96706942320775.31, 113582249743855.77, 133022556572417.56, 94360980690092.66, 95624272472760.97, 76500000000000.0, 104339403709083.53, 88940885902412.47, 97764181528497.36, 91918460178111.78, 105613746911744.83, 78616031496300.28, 82778032690771.75, 153000000000000.0, 85459286402881.11, 88400015512418.17, 148786492580827.38, 153000000000000.0, 87234584414139.22, 100601234246931.02, 114106549349356.69, 145956314555641.56, 90141530465358.81, 102820839337578.56, 123281505934525.94, 116009794139696.38, 100460163037266.0, 104874857457613.61, 84142882786943.12, 102950553063598.66, 102436362122235.77, 111912812699230.72, 97316056536167.58, 116769345658200.16, 128540333982393.6, 110398997587427.6, 114313307450259.19, 108413282580245.9, 107396992335758.03, 94487092850159.34, 113600176208807.53, 105557082037468.23, 153000000000000.0, 141987471018050.9, 115006992196118.5, 93793770438353.69, 88155212633721.78, 132675729123184.23, 112521800905739.44, 116947800172142.77, 78799606488679.38, 126609640573380.03, 116415145128036.53, 88186207058605.47, 98774186253711.47, 112541132251031.56, 108400035721301.3, 101968704672148.88, 105440969554120.9, 102698662388520.56, 110342844140016.17, 139443750753189.33, 76500000000000.0, 102974736538380.61, 110812839257754.31, 113187631572641.28, 100535811048673.42, 78630076817449.39, 113832283290610.11, 145921416591086.38, 81802267282366.7, 125188396306143.05, 101312950437777.73, 106232920280046.34, 89091213775591.2, 101206368800480.9, 135264847992883.22, 119094863070483.89, 146049956079716.38, 132352813402348.69, 116098781401123.28, 146351525669050.22, 116096854534708.06, 124394667659899.62, 101889116434541.58, 108671221188366.66, 94892655101605.89, 128013732898441.58, 87130348688613.28, 123391227230154.14, 103822488138885.16, 132208090636708.39, 122703767299855.27, 148357571866033.8, 122266971043543.28, 81249886134115.19, 106126852855003.64, 87227764140274.28, 97957993052170.81, 140430582636176.31, 120260423046620.05, 94867286554834.45, 89712861245937.25, 108022009490956.31, 86540795710270.78, 95336316255100.47, 113509796610177.72, 131834737102951.34, 119647914959879.19, 76500000000000.0, 113355942120270.19, 108777108254739.75, 115580795936550.28, 143071459322204.94, 76500000000000.0, 96700139172389.58, 119269382635054.97, 81112238895325.33, 139554093422531.1, 114650573186532.56, 124805870435161.34, 97046725388975.05, 124081041208525.1, 129818543065867.03, 111926877787503.27, 111957131501319.44, 112673548854951.02, 92139198487607.4, 104620076542307.03, 104527397798342.67, 114956943334135.03, 128246588618065.77, 89002123344075.78, 105039030844233.66, 139690537008375.38, 94118400876347.47, 92813636688406.47, 111321257746520.28, 124757178451168.28, 107613377717566.81, 135960769944056.22, 125032218360425.78, 124700398192353.8, 118493203629089.53, 153000000000000.0, 103555470165135.97, 76500000000000.0, 142768226395347.88, 99016833300654.75, 109471321509285.92, 135493237361801.67, 80815311857803.22, 86003593533425.67, 80829391410723.72, 93277869238621.25, 116110112606980.81, 117865506616153.23, 112792206619842.45, 83579276039402.16, 76500000000000.0, 108436339094625.17, 98769782526869.25, 116517776513872.38, 121643191273530.61, 110062758926185.48, 122905669179630.72, 111854068943627.17, 117988499782955.58, 94770649644778.61, 104026095664420.11, 111212058497309.73, 124230094832274.78, 100147135187974.72, 117802340540444.72, 102446337527200.69, 105178313980782.7, 124428467923510.28, 76500000000000.0, 85322145109259.64, 82555914988516.08, 76500000000000.0, 95215857252354.16, 122672520628609.73, 102100659541929.69, 111232072992674.77, 130297384908802.34, 135930022238034.62, 106085712589495.7, 136556249831592.89, 109165688452559.48, 92564458014328.73, 96643576358739.97, 82580076451518.22, 91734750400829.81, 100784082731751.64, 123857103798213.22, 145751106850896.75, 84034157751194.92, 115149562090183.34, 89286764819610.95, 116834818727376.2, 104925798121956.33, 77601671028088.6, 126628932146574.38, 96461938317833.84, 97686816738527.33, 88825136770183.73, 95621950341333.48, 115868324055134.06, 103848410471525.58, 113845748883834.56, 114519720490964.11, 135760673750192.75, 101056864905782.92, 82634006657002.97, 129789767623989.62, 101259690982969.81, 130885471950176.2, 114956601589371.2, 104924850696276.69, 114252857594337.27, 151829989336101.94, 153000000000000.0, 108725916204461.95, 110492321525241.97, 129997645497941.06, 92428821981286.8, 113934850768846.6, 106903584900542.31, 113548052128824.88, 92630674077203.47, 80997548475376.45, 76500000000000.0, 88077451096992.69, 98999686703006.39, 101950240911233.14, 151459101321354.56, 130685883989339.81, 90538590614643.72, 114231215854417.1, 99910376118518.23, 102110086343974.6, 110986294246919.97, 119869155401162.17, 101120151409852.62, 129712147052089.48, 87694481378502.2, 107516270092018.69, 153000000000000.0, 111732418523814.44, 138499710143851.12, 109153939438123.12, 119055173866021.33, 106318569225388.83, 104196149952721.34, 93520763915360.08, 115917910421267.19, 92332484381257.75, 120860602882171.34, 130206528892610.25, 114613441918527.0, 102075935214558.25, 116405750159214.45, 101670519491014.23, 126791967137085.7, 77594781854528.44, 101185694328876.98, 76500000000000.0, 82367491475206.67, 136805519125438.47, 125886997781856.72, 94521940854348.72, 82258769737445.97, 76500000000000.0, 97520611362350.8, 153000000000000.0, 116012227619886.53, 97242769504392.66, 116635587198763.03, 81409836534478.06, 101875512183019.66, 109308192407297.56, 105766837434564.22, 123576531816397.5, 114169133533829.84, 120919404209035.17, 95045209789132.75, 125945777948681.98, 143394979577301.5, 90409202720389.05, 91741884557551.84, 136125518678644.47, 103809721533989.3, 137779125631549.69, 99283654880173.9, 139037345903332.39, 109930882553950.5, 112431568695635.1, 141770002240737.62, 100716964742171.36, 90876143351555.02, 99177491156595.1, 116372048207257.95, 81340506837054.97, 120259080435773.67, 97602406505298.98, 131659394068539.06, 76500000000000.0, 93403274953812.06, 79616557681069.61, 92748112312452.17, 112221003097201.4, 104033199631098.44, 102673145963344.16, 104403882147472.47, 111342636810463.47, 89795392147176.72, 121748931810229.19, 120798003765897.84, 114990489421846.7, 118544040046448.62, 113196149121803.1, 153000000000000.0, 105748190416271.36, 101699209503648.7, 93952529612079.42, 89418082897409.83, 86113181316558.25, 91723949892493.92, 106056677071181.31, 113959617884256.95, 108374553873337.11, 93752530956079.78, 125998743184340.7, 122454546775092.73, 104395295760780.64, 95645153244518.62, 118373639647208.66, 111038461894382.06, 83056414214726.27, 106107510329425.12, 112507555582257.62, 91546730951932.62, 111075314137352.58, 82957785904929.2, 136135224858907.69, 134020063063668.97, 102688821728512.58, 114550870443164.98, 76500000000000.0, 87470513703010.67, 101939614853394.31, 88787617550751.17, 121912103034699.72, 152928110549671.0, 87156467940582.73, 92563387285943.9, 111977945623790.03, 142942189053259.94, 86451546301076.39, 112248295369552.75, 148374757550247.3, 80108489427494.64, 85555698122987.19, 99617741607930.39, 97917867990261.61, 124055447134421.38, 112101449346590.52, 78375957075746.02, 117682047799832.0, 96933203906786.9, 134651768250242.31, 96076049121948.52, 95922244904459.1, 118220460603899.14, 122966613685289.98, 116284626617495.1, 79628863012159.83, 118155498410445.06, 89385630845573.69, 111974522488284.69, 83416741207583.89, 116247956162848.31, 93071792439094.52, 85531932607120.16, 121899634072276.7, 112101146987340.97, 96308399263313.6, 138941967795464.44, 99316843508912.0, 108009081294362.78, 112644962308496.31, 96211211269760.42, 116761010591827.53, 97694581844872.48, 99829554115053.14, 136775912212334.78, 89286097511060.9, 76500000000000.0, 142937644391425.25, 153000000000000.0, 99942456062939.28, 76500000000000.0, 101637849693134.58, 102076402294949.62, 103835888145219.62, 88139935739828.53, 119029485268799.47, 117872190613218.64, 82377069655845.3, 121583690307091.98, 153000000000000.0, 110723354836512.72, 101154852100867.72, 104722717037514.92, 119785914165085.38, 78994431763957.23, 110574711925904.42, 100205398144482.69, 149074889633567.1, 104126549668674.48, 144389636961210.22, 88290969376771.75, 119192209701374.27, 113658777748152.89, 92046007885741.2, 110830219175151.58, 133179997980867.56, 101398094283258.72, 79538961431349.78, 107061169329395.62, 91502415762731.9, 101064849848175.52, 105851579553999.62, 79345958805911.02, 80623372364739.39, 116987727039326.81, 97880856303282.11, 76500000000000.0, 123445846504372.2, 112714078442286.17, 94616016572882.8, 85014442390800.05, 124567417117678.72, 114264511569280.14, 153000000000000.0, 115710059116734.55, 115044891709563.58, 104260513995041.8, 124147388683270.05, 119995032041843.88, 134109879858871.17, 97905105056345.44, 99409332062605.8, 98641431965149.78, 123576435308845.02, 140110599403144.66, 98996784145919.16, 99597110173143.0, 113551457989668.16, 102812014247297.81, 127163935633533.47, 76500000000000.0, 92740284645540.4, 93472082037054.28, 76500000000000.0, 90513731942884.92, 91295880185013.23, 103630056610376.53, 130847695644984.2, 102824802671315.5, 89441079097265.22, 106315336264329.38, 129374702922653.81, 90316041804934.6, 91370136170902.66, 118586449823253.72, 103254980107707.64, 120472987192004.73, 107135599901364.17, 121636931419883.52, 89373416074790.0, 107165305353409.0, 103453921212993.27, 86551074460260.58, 81373442381503.44, 121293870952451.5, 100910514278735.8, 89576632799885.6, 105577833991710.17, 131197714062372.25, 76500000000000.0, 82344430134157.86, 91170718162393.16, 139188766195821.05, 112918641455467.94, 123062469459520.56, 87722145988045.62, 88043823374652.17, 116278731893777.23, 108511816431558.53, 118380171060708.8, 103877411117160.86, 112829635741591.6, 110451708906996.89, 123290910016511.78, 123932372671750.23, 80563105492522.98, 76500000000000.0, 128290321063309.22, 132595277171844.78, 89602982228548.86, 77219455696541.28, 109299605830116.31, 126686053447824.53, 147751887583100.3, 117700577699438.38, 100539341761889.9, 91653438900462.1, 107613859678221.47, 101840419333174.86, 89691361601133.44, 153000000000000.0, 147426416286863.7, 131384810028430.38, 91203667179636.3, 124992846071017.11, 120305092595961.03, 116170071106578.72, 134060866246160.94, 120214275191933.75, 122467620587845.45, 120247030795243.4, 114091076231237.98, 78255747239645.97, 109001029865122.6, 97301123147052.53, 85574349204661.39, 144747005177595.9, 145964025914323.84, 136692872579497.6, 112371418090565.3, 136484515905507.92, 107625355226727.67, 111330960071031.73, 88452024833308.61, 115234683447996.88, 108552488055252.97, 85228622090412.53, 106424020945075.16, 105886492352525.88, 147751012950100.97, 125865291909905.47, 107613747905141.0, 112243338991394.17, 108241356559197.6, 103596786389206.33, 88625560208734.47, 104554682513545.77, 94076485063397.12, 86023921198575.97, 117594602052183.83, 115117629810713.14, 78212756748877.53, 105082369124822.62, 128152787481422.38, 129605659507201.53, 128839998553546.66, 108139610186829.84, 92438922069596.8, 88605561953488.28, 114168316564428.98, 114873046580580.62, 134960000753702.77, 130546484033669.98, 104904534929898.62, 86117245130083.81, 101482437790658.92, 111616507717406.78, 103612060816498.25, 96927093377927.34, 112324989720379.97, 98207291926830.56, 96067890005045.94, 113498584012093.92, 100000590403766.47, 112150095397998.17, 112730767728276.11, 87733541169226.03, 98604012566432.69, 138611897500798.14, 87381581892334.39, 76500000000000.0, 77194435794931.75, 107951635420634.58, 107986265910294.44, 105177031865985.95, 133219498278479.22, 76500000000000.0, 115213060432470.14, 141687506655809.25, 87915091116323.22, 100395102113638.31, 93963129018172.97, 91633671417515.9, 101353650994610.2, 138358960759690.0, 148798986563050.22, 101179735252343.7, 150596831862419.28, 108075592610775.27, 146605149594814.3, 105631815055292.69, 109922533070369.5, 114591945551799.72, 153000000000000.0, 124910050171004.81, 94727077620080.47, 127546902364943.38, 100715855487585.9, 98455223872663.56, 126187090664335.7, 107989491478307.89, 112838290096112.58, 107662263811387.22, 114005900397006.27, 115808202219232.38, 76500000000000.0, 120881784172843.4, 90218953109505.62, 83142364582386.31, 106287855260516.06, 109007992595084.77, 94958653249635.28, 124461878689353.84, 84632912009688.3, 99912760741177.34, 96807100643839.19, 106511122362438.8, 112844064936295.66, 89805640959942.53, 122126184632695.06, 108602904630973.23, 76820763652036.31, 76500000000000.0, 107160842906090.17, 103265403588280.34, 105442244901152.25, 106863379149902.98, 111781607238600.88, 127064585543399.53, 88175656015226.17, 87228315231750.34, 88454340435031.48, 113045556679976.31, 133948666861822.11, 99481126415897.28, 76500000000000.0, 79369328266432.72, 92636133364630.89, 97274587237950.31, 99887144327934.9, 108133237217878.23, 101615082475100.16, 129378514088279.84, 95253836514275.62, 92155998322419.97, 116921489111710.66, 81776420881732.98, 115085499157617.56, 109367873768054.34, 104621676832389.6, 142363959609969.12, 96167826092929.52, 153000000000000.0, 103183624622710.02, 85617255127191.92, 108736306259280.7, 88722845550512.66, 93982075459807.4, 115235542283326.27, 118524027263636.44, 96168504414892.22, 127964243709427.16, 131886119499250.38, 138575613735143.06, 117974862845352.19, 136794994263079.27, 76958919180255.34, 101504052911042.31, 92079370422563.12, 109691959400329.67, 97038018685721.02, 104274763895444.53, 149986432057569.25, 104208868940745.44, 115578786431478.77, 103058486214316.8, 108848166657853.98, 107510118969358.56, 116289263863543.17, 132068805161406.38, 143865448024916.62, 113461673870767.81, 119240611444357.88, 87555671523010.25, 105733504920089.64, 126898722467252.39, 125235963715103.97, 111505210798879.19, 125690750373559.1, 117168490537318.84, 132891662297353.4, 113054434286379.9, 100825557718418.9, 113990891510738.3, 76500000000000.0, 114946577342355.47, 76500000000000.0, 79095548263714.3, 116360372956162.0, 116893558873785.4, 87376165802960.83, 94645788702990.73, 136967767156302.16, 98555219455788.48, 153000000000000.0, 107358798972861.03, 115460778867451.53, 143088337987208.28, 109921933989737.97, 89894122193929.22, 105324283590160.38, 106718807383240.02, 84294648548248.28, 102628431549499.2, 94141723491279.64, 126540437828008.89, 108057093071096.3, 102138506177889.27, 105390576502776.38, 111733256814260.84, 119819027073134.88, 89936117339409.06, 89270228410221.78, 130655408760175.48, 99817178938116.62, 83518836780455.92, 116196196994672.66, 116600188612857.88, 81847953669681.69, 111859435512831.75, 122371351091199.73, 114773327416618.84, 120141980949515.14, 83705401262254.22, 113893807395121.95, 101779799828174.52, 98576909541497.69, 125337952924673.56, 139636477924495.19, 147667361701255.12, 135619709904687.08, 105324157795833.38, 114332860861080.6, 123051673037386.52, 109729967088065.61, 109916804979887.36, 124301209127400.47]  # Truncate for embedding
baseline = 109100000000000.0
mean = 108812733945613.12
std = 18574785236574.418
p5 = 79791596704349.86
p50 = 107144713110723.62
p95 = 143746672610765.84
display_name = "Total Economic Burden of Disease Globally"
units = "USD/year"

# Create figure with two subplots

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
# Handle edge case where all samples are identical (zero variance)

if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax1.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key statistics with formatted values in legend (use format_parameter_value for full units)

ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {format_parameter_value(p50, units)}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {format_parameter_value(p5, units)}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {format_parameter_value(p95, units)}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {format_parameter_value(baseline, units)}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---

sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax2.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key percentiles

ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"

exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title

fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark

add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from

output_path = get_figure_output_path('mc-distribution-global_disease_economic_burden_annual.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 1.091e+14 |
| Mean (expected value) | 1.088e+14 |
| Median (50th percentile) | 1.071e+14 |
| Standard Deviation | 1.857e+13 |
| 90% Confidence Interval | [7.979e+13, 1.437e+14] |

*The histogram shows the distribution of Total Economic Burden of Disease Globally across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
