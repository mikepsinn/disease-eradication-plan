```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Unexplored Therapeutic Frontier (10,000 simulations)"

import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Simulation results

samples = [0.9964185671453815, 0.9975081167212695, 0.9959610014763326, 0.995748471232431, 0.9980510538436277, 0.9976782683765143, 0.9965854297185449, 0.9969709070471251, 0.9967160874771438, 0.9973792392695009, 0.9958180430504294, 0.995931103820687, 0.9966418880526039, 0.9955289048907336, 0.9962577947051163, 0.9973836528432847, 0.996356168912468, 0.9974530021473845, 0.9958191119417549, 0.9967452991326332, 0.9968616343783065, 0.9972546973045873, 0.9954124782893686, 0.9968358506404503, 0.997061118771922, 0.9970000912484112, 0.9961918084591475, 0.9963594176355132, 0.9963126817582988, 0.9962946465463532, 0.9947368421052631, 0.9970436960935908, 0.9971268945403636, 0.9973513296072563, 0.9961048822693093, 0.9955268166304359, 0.9968010232732387, 0.9973701128544469, 0.9973589693670042, 0.9960683443193783, 0.9959688349778525, 0.9961806517068763, 0.9972432547161324, 0.9964879794523273, 0.9965956883011524, 0.9965007195971392, 0.9958270230879724, 0.9964960848211251, 0.9960381940447026, 0.9966404852004703, 0.9964336039061861, 0.9960887643276949, 0.9977733249419808, 0.9969737072041828, 0.9970942612510174, 0.9972233795973173, 0.9969371380312512, 0.9950627029477044, 0.9973882633796152, 0.9957165695405354, 0.9979048510874986, 0.996986101131559, 0.9965531212524179, 0.9961360223676102, 0.996003511135037, 0.9959139951136582, 0.996997331820994, 0.9970879676641827, 0.995842138666637, 0.9968670831061438, 0.9976616170191324, 0.9975700495433523, 0.9974257675346909, 0.996227743524473, 0.996571969325399, 0.9960258082891361, 0.9970602663094954, 0.9965570365068518, 0.9960947710928664, 0.996965267192619, 0.9962686144143187, 0.9972405884899717, 0.997008915008885, 0.9970239518466937, 0.9976107063777325, 0.9962380962686237, 0.9970935006157113, 0.9966900345220927, 0.9962444086101675, 0.9962789109979385, 0.9960526251614021, 0.9967876532328044, 0.9970571289538439, 0.996771349986672, 0.9979073727837267, 0.997767284419793, 0.9976910840358917, 0.9974792238302033, 0.9963255480511934, 0.9974160464649934, 0.9970210802894629, 0.9953165934384991, 0.997003431745888, 0.9959750701922205, 0.9974355849621935, 0.9968790041299814, 0.9974469073552087, 0.9969894715205386, 0.9958619068779648, 0.997929822477418, 0.9962910439769836, 0.9964826947192051, 0.9971896766242028, 0.9977666491750026, 0.9966363590307562, 0.9971402322388327, 0.9964874916420324, 0.9966816687362657, 0.9949183462375184, 0.9969074284352535, 0.9974970102539844, 0.9965377247350409, 0.9964994846657836, 0.99524022994627, 0.9958677037042567, 0.9963678267958068, 0.9951046598014285, 0.9976061411867888, 0.9972240338879629, 0.9974307093238526, 0.9970304246773035, 0.9977244640066568, 0.9960846869181172, 0.9968931030575882, 0.9977815087610638, 0.9974916583074097, 0.996410058781773, 0.9958643412799254, 0.9947368421052631, 0.9947368421052631, 0.9963110135646439, 0.9974739767439347, 0.9981439283165368, 0.9964541392404019, 0.9973507353711282, 0.9970508184326772, 0.9972032486386789, 0.9968241028813715, 0.9956021814724023, 0.9965584210594959, 0.9968393526553202, 0.9975052042915804, 0.9979002191694306, 0.9971067245570635, 0.9967486832469362, 0.9947368421052631, 0.9965831870191635, 0.9956998281006051, 0.9971168429583398, 0.9976036736967885, 0.9974572816397197, 0.997287304882856, 0.9947368421052631, 0.9973567638975037, 0.9958639367157701, 0.9974142671833139, 0.9957587706168318, 0.9963402109247259, 0.9968376496788882, 0.9967372443357364, 0.9972352701403527, 0.996279371660075, 0.9970821740893178, 0.9976298137124513, 0.9976630365944491, 0.9965439649358935, 0.9949493501718585, 0.9965556878183943, 0.9968050684764329, 0.9964367706529103, 0.995308028604528, 0.9965000645539746, 0.997047292139919, 0.9955541033356785, 0.9962967094926541, 0.9950080455091224, 0.9965340255330376, 0.9976290868405001, 0.9977192240507333, 0.9948505270008965, 0.9947484938895045, 0.9968571078559078, 0.9970251151747094, 0.9951071134392179, 0.9975527881708895, 0.9974085413714612, 0.9960760426342796, 0.9970342633563517, 0.9967057254893913, 0.9968434491764361, 0.9963866835215092, 0.9951778184887506, 0.9966195723329193, 0.9960753948039323, 0.9981024809469357, 0.9967442388468272, 0.9973722924829822, 0.9976254668709296, 0.9973969292747037, 0.9969854819117352, 0.995776660478392, 0.9976933830109833, 0.9966738010498667, 0.9971050551197562, 0.9969802322714438, 0.995676545196914, 0.9961858394051931, 0.9952681237450863, 0.9968358303244831, 0.9972657924073427, 0.996894473929422, 0.9964781745454157, 0.9965402475409825, 0.9975377856506692, 0.9966196590715849, 0.9964917033745649, 0.9947368421052631, 0.9947368421052631, 0.9973793802443524, 0.9969472347942986, 0.9977770974170614, 0.9971870654346945, 0.9964080332128146, 0.9954330821555152, 0.9972901262686372, 0.9972347918715924, 0.9981515441293498, 0.9968427875425357, 0.9975231481567413, 0.9971401911368586, 0.9973960222134375, 0.9967839919401213, 0.9979467333427816, 0.9977792569197558, 0.9947368421052631, 0.9976690081138784, 0.9975460058995028, 0.9947368421052631, 0.9947368421052631, 0.9975950111882037, 0.9970131036195836, 0.9963828012817071, 0.994741361033943, 0.9974721492805357, 0.9969123648095409, 0.9959316024757375, 0.9962907013705958, 0.9970194675563052, 0.9968181280088538, 0.9977233648119227, 0.996906442350151, 0.9969298964172167, 0.9964879713368376, 0.9971600917877077, 0.9962537252985877, 0.9956649163442046, 0.9965599239412025, 0.9963728344429958, 0.9966535306803251, 0.9967010959119712, 0.9972846195409328, 0.9964071714991833, 0.9967866142190178, 0.9947368421052631, 0.9949571592178642, 0.9963393266916203, 0.9973148463566323, 0.9975563276692289, 0.9954511682564392, 0.9964588823079797, 0.996245019685906, 0.9979394414386135, 0.9957634980634595, 0.9962709839065557, 0.997555021655802, 0.9970951641726027, 0.9964579575803563, 0.9966541521676129, 0.9969511748461064, 0.996791985266986, 0.9969179396038285, 0.9965625831389201, 0.9950938342860176, 0.9983492520012583, 0.9969053377535932, 0.9965403044097539, 0.9964269843341006, 0.9970160555368626, 0.9979461757517056, 0.9963960078787241, 0.9947432719933608, 0.997818923316797, 0.9958355699925202, 0.9969809263035996, 0.9967552908366453, 0.9975167822804274, 0.9969857524590736, 0.9953155620825702, 0.9961397384934569, 0.9947368421052631, 0.9954679853435301, 0.9962863758324182, 0.9947368421052631, 0.9962864695127885, 0.9958756358775417, 0.9969547910700983, 0.996641421411425, 0.9972668846335206, 0.9956918816277712, 0.9975993777079377, 0.9959260976289533, 0.9968665309920279, 0.9954755154250007, 0.9959605462682253, 0.9947368421052631, 0.9959823820998285, 0.9978412698500001, 0.9967602136657667, 0.9975952969780371, 0.9971315695021388, 0.995040963990867, 0.9960821694957367, 0.9972679951370532, 0.9974903983390655, 0.996671870928419, 0.9976240234101558, 0.9972474385071964, 0.9964115152678286, 0.9954949216220891, 0.9961124586624851, 0.9982219674304238, 0.9964189055919009, 0.9966364460728815, 0.9963115301219341, 0.9948985267932747, 0.9981091570075125, 0.9971873662037125, 0.9961311372409802, 0.997846826094739, 0.9950879322208988, 0.9963565563226041, 0.9958548956982854, 0.9971720295454043, 0.9958914305792925, 0.9955992250641784, 0.9964873004278988, 0.9964858571681017, 0.9964516211248335, 0.9973865115138754, 0.9968298697529936, 0.9968341372286773, 0.9963417477786422, 0.9956799650507303, 0.9975205556332181, 0.9968105541079572, 0.9950806307008551, 0.9973007078358049, 0.9973573793818615, 0.9965161489570916, 0.9958573534738907, 0.9966909879954982, 0.9952788810791354, 0.9958434640202516, 0.9958602188832415, 0.9961693412201407, 0.9947368421052631, 0.9968787718760914, 0.9980784526999136, 0.9949149518726786, 0.9970843109337808, 0.9966037645882236, 0.9953035348118534, 0.9978587951082163, 0.9976464047646736, 0.9978582280824967, 0.9973372629124119, 0.996285824915621, 0.9962001418499901, 0.9964459397727367, 0.9977465027173521, 0.9982309679667659, 0.9966524488708114, 0.9970953610167593, 0.9962659859434436, 0.9960134951309003, 0.9965758363203275, 0.9959504393394714, 0.996490772957698, 0.9961941133682006, 0.9972722239858415, 0.9968571860201864, 0.9965213419657252, 0.9958839265987641, 0.9970335721259067, 0.99620323664986, 0.9969294419847411, 0.9968041236544906, 0.995873932408005, 0.9980730223702206, 0.9976746913795573, 0.9977883078408195, 0.9982421523522197, 0.9972527230130037, 0.9959621096612113, 0.996945176023047, 0.9965203903677138, 0.9955745289416182, 0.9952805038104549, 0.9967621223902541, 0.9952474166108649, 0.9966181661976978, 0.9973681554365916, 0.9971898664348751, 0.9977873239150401, 0.9974039284588709, 0.9970048481398203, 0.9959026957132509, 0.9947525944857232, 0.9977278346233738, 0.996332426946124, 0.9975084929951531, 0.9962505321044137, 0.996815778594399, 0.9979868656408332, 0.9957625168719064, 0.9971978901885001, 0.9971436302012772, 0.997528045930258, 0.9972348939356636, 0.9962975744696764, 0.9968653417639709, 0.9963953598625171, 0.9963628748840975, 0.9952894378726679, 0.9969925177380171, 0.9977851271786546, 0.9956007076425053, 0.9969833382912916, 0.9955441339124214, 0.9963417643084793, 0.9968158222956617, 0.9963757494175507, 0.9947368421052631, 0.9947368421052631, 0.9966388517594232, 0.9965555029452744, 0.9955899934454401, 0.9973740148587853, 0.9963910709324206, 0.9967241046430605, 0.9964096768740428, 0.9973652933067838, 0.9978514519260622, 0.9981141209239124, 0.9975596032595876, 0.9970850783299544, 0.996952013908587, 0.9947368421052631, 0.9955544575085566, 0.9974552055585246, 0.9963767928168901, 0.997044224926609, 0.9969447473152196, 0.9965320698579712, 0.9961015273691903, 0.9969896545620409, 0.9956047059843354, 0.9975757133504728, 0.996695525450267, 0.9947368421052631, 0.9964965723054193, 0.9951442302783998, 0.9966187194002161, 0.9961416936744325, 0.9967513138098094, 0.9968493737483185, 0.9973267168418377, 0.9962951658912929, 0.9973781738902722, 0.9960524120644413, 0.9955792184464449, 0.9963583496833356, 0.996946300327018, 0.9962714413101514, 0.9969647158290786, 0.9957542216217234, 0.9979871372776058, 0.9969866883202044, 0.998071853333793, 0.9977959758620637, 0.9952342242954205, 0.9958001964648163, 0.9972830972174883, 0.9978003962196234, 0.998421052631579, 0.9971510136700218, 0.9947368421052631, 0.9962905831056857, 0.9971633418448, 0.996260245953515, 0.9978348071692561, 0.9969554090549654, 0.9966114539324896, 0.9967769037161581, 0.9959167948997564, 0.9963797853817112, 0.9960494925033772, 0.9972602033250382, 0.9957972154786519, 0.9948809828517432, 0.9974607311722271, 0.9974036215824825, 0.9952701831015993, 0.9968671166235081, 0.995182577499285, 0.9970723604308827, 0.9951155513314842, 0.9965820704311915, 0.9964631975324535, 0.9949688940565686, 0.9970078793749941, 0.9974407707705335, 0.9970771173336082, 0.9962730819659714, 0.9978376091971679, 0.9960822359771555, 0.9971473808386834, 0.9955040257633907, 0.9982706739470172, 0.9973318197917865, 0.9979068837340161, 0.9973602145279347, 0.9964732605229221, 0.9968568597976903, 0.9969191034540001, 0.9968398215597873, 0.9965151319580507, 0.997486888397773, 0.9960082268058628, 0.996055519379075, 0.9963401250650782, 0.9961668429930551, 0.996426575649997, 0.9947368421052631, 0.9967777673747646, 0.9969634138743533, 0.9973079351448928, 0.997502921203341, 0.9976418449142282, 0.9974043930200888, 0.9967634692769232, 0.9963898784544609, 0.99665534755844, 0.9973166406271141, 0.9957945287721275, 0.9959730099832247, 0.996840216585175, 0.9972338740462768, 0.9961752146928688, 0.9965295919566082, 0.997767895501941, 0.9967611111204503, 0.9964595636895429, 0.997412011658001, 0.9965278411539109, 0.9977719230282616, 0.9952696704889854, 0.9953809282766112, 0.9969183884718925, 0.9963613710681987, 0.998277964297343, 0.9975851178976913, 0.9969524967606539, 0.99752963279526, 0.996000092435085, 0.9947368421052631, 0.997598283806008, 0.9973682017091202, 0.9964848641082451, 0.9949055311325365, 0.9976277468093339, 0.9964719567706936, 0.9947368421052631, 0.9978871948606711, 0.9976650098804203, 0.9970573736739062, 0.9971333551795161, 0.9958927186203695, 0.9964789696643015, 0.9979562561451358, 0.9962091279647767, 0.9971770560840767, 0.995347795416499, 0.9972149105477595, 0.9972216844756413, 0.99618273496884, 0.9959473868446433, 0.9962773366136137, 0.9979063919998274, 0.9961859227376739, 0.9975042985314948, 0.9964850274356072, 0.9977531602720717, 0.9962791208020678, 0.9973461992260115, 0.9976659956637528, 0.9960007142345336, 0.9964789840990816, 0.9972046665624144, 0.9951206432724453, 0.9970708727974146, 0.9966724763266319, 0.9964529893882714, 0.9972089530072025, 0.9962541317422317, 0.9971432850861891, 0.9970478584509037, 0.9952357918647724, 0.9975085212980068, 0.9982792915181513, 0.9949057773191459, 0.9947368421052631, 0.9970427822809709, 0.9980435758766675, 0.9969661981541365, 0.9969462790885071, 0.9968659162647924, 0.9975569713045411, 0.9961429589728376, 0.9961998143194186, 0.9977955862913924, 0.9960164586089744, 0.9947368421052631, 0.9965445499480265, 0.9969880842553778, 0.9968251412852214, 0.9961056414766141, 0.9979316929877335, 0.9965515982852288, 0.9970309486174351, 0.9947368421052631, 0.9968525719783277, 0.9948269154275782, 0.997550605514856, 0.9961349415412892, 0.9964043540675801, 0.997390528157625, 0.9965394796225091, 0.9954248639190851, 0.996977068981943, 0.9979099836527799, 0.9967167621045377, 0.9974139155692647, 0.996992156538675, 0.9967729777877494, 0.9979176871605376, 0.9978665199613405, 0.9962430709726445, 0.9971350019657201, 0.9983483994744138, 0.9959233563664516, 0.9964496809115759, 0.9972789860938518, 0.9976874255910573, 0.995866927103353, 0.9963751875093542, 0.9947368421052631, 0.996305258350605, 0.996337492958328, 0.9968464151421687, 0.9958880909494023, 0.996095303231424, 0.9953762223381477, 0.9971339230859961, 0.9970667257646609, 0.9971010962108696, 0.995916799746553, 0.9950581285782706, 0.9970852082270912, 0.9970582999351708, 0.996409513187575, 0.9969127676037712, 0.995735275034276, 0.9982029155298232, 0.9973605531502745, 0.9973288316680319, 0.9982358535793824, 0.9974562674868627, 0.9974227826219065, 0.9968753542653559, 0.9955460885029854, 0.9969121839094559, 0.9975019450425661, 0.9967514639595263, 0.9956220737307968, 0.9974647071388762, 0.9974195958392924, 0.9961647584456583, 0.9968925276046411, 0.996071639192966, 0.9967132921081706, 0.9960138069418069, 0.9975048168827684, 0.9967119068727579, 0.9968834228733311, 0.9976235944623664, 0.9978362782295145, 0.9960308824366009, 0.9969991352883567, 0.9974961883010136, 0.9967856539662954, 0.9955279669085503, 0.9982168995124824, 0.9977969137329323, 0.9974281510468581, 0.9951074637415436, 0.9964398826326205, 0.995942584176109, 0.9975745508282219, 0.9975610193123516, 0.9962776234391202, 0.9966489066446073, 0.9961748939226873, 0.996864011130493, 0.9964441470156317, 0.9965574271085823, 0.995931130761626, 0.9958989105056845, 0.9978689435087439, 0.9982007285836663, 0.9956777257522873, 0.995455360096259, 0.997495068758246, 0.9980025141230643, 0.9966118585089836, 0.9957596111612069, 0.9947368421052631, 0.9962082206702568, 0.9970158962553531, 0.9974074252035434, 0.9966909654700742, 0.9969570029798598, 0.997491312417899, 0.9947368421052631, 0.9947368421052631, 0.9955182700218984, 0.9974267381754338, 0.9958454532872476, 0.9960799573950414, 0.9962829093021135, 0.9953787906027458, 0.9960844543556362, 0.9959723564790427, 0.9960828326161664, 0.9963835467908173, 0.9979610187012774, 0.9966259163257212, 0.9971607541413939, 0.9976642361418878, 0.9948074422579793, 0.9947409387396298, 0.9952401875446745, 0.9964660731478155, 0.995251210735059, 0.9966904281863905, 0.9965156874314746, 0.9975438110833063, 0.9963283053344624, 0.9966469973537411, 0.9976785643398791, 0.9967464149716193, 0.9967713598740193, 0.9947368421052631, 0.9958012970767156, 0.996690970694024, 0.9964721935491963, 0.9966615936609544, 0.9968768788916345, 0.9975364829599012, 0.9968328810838052, 0.9973025348089308, 0.9976455591766423, 0.9962134086394858, 0.9963339727119219, 0.9979627210052552, 0.996808553731835, 0.9956847667529664, 0.9956101892796415, 0.995649545958478, 0.9966663622240236, 0.9973735786929866, 0.9975373278351433, 0.9963798247565894, 0.9963458050101002, 0.9953315992739259, 0.9955616630476425, 0.9968167593378894, 0.9976416757645048, 0.9969732462576929, 0.9965020949795281, 0.9968761789641641, 0.9971773265611614, 0.9964682921981486, 0.9971204664858738, 0.9972152700376807, 0.9964120540354695, 0.9970401673470501, 0.9964766470141303, 0.9964488818645094, 0.9975740719244703, 0.9971027675226115, 0.9951382506716929, 0.9975888487321798, 0.9981362061766071, 0.9980035966982497, 0.996675165931327, 0.9966735446275623, 0.996804182867641, 0.9954228012619991, 0.9983958592574308, 0.9963293524799323, 0.9949733431558536, 0.9975664375880725, 0.9970224009886215, 0.9973074735079948, 0.9974082750467926, 0.9969790826325534, 0.9951517286853033, 0.9947368421052631, 0.996986958048332, 0.9947368421052631, 0.9966693613504511, 0.9947368421052631, 0.9967831556472734, 0.9965824650003844, 0.9963593877737655, 0.9947368421052631, 0.9958496354494897, 0.9972741299724848, 0.9957157381121025, 0.9970079294631978, 0.9971094098045845, 0.9957849699297496, 0.9966733936016228, 0.9964437324506499, 0.9966887029360576, 0.9963876496998749, 0.9963004940728794, 0.9980436438960132, 0.9960513604713587, 0.9974688484686666, 0.997764383655988, 0.9967527401750318, 0.9966255887280726, 0.9972639948533989, 0.9958722483319515, 0.9977031818923123, 0.9970441176976297, 0.9971826361352694, 0.996742366706581, 0.9964434558123288, 0.9974864524108051, 0.9959894115052126, 0.9966446300789876, 0.9980197410063907, 0.9980550222348037, 0.9967121149799643, 0.996892050790249, 0.9967919262895935, 0.9967259771019062, 0.9964942277644632, 0.9957403383546982, 0.9975554662723733, 0.9975952738860906, 0.9975437133482895, 0.996433798930932, 0.9953846679010702, 0.9970635052419913, 0.9983200724507814, 0.9979167549096464, 0.9973650572865091, 0.9971619309814066, 0.9970452695175145, 0.996666660829347, 0.9969672310234838, 0.9956218777071421, 0.9972510572474321, 0.9973857871929698, 0.9962463036625162, 0.9978199706855283, 0.9963355278555116, 0.9966086414502461, 0.9968297960489357, 0.994936821408466, 0.9972108657697237, 0.9947368421052631, 0.9968957910362845, 0.9976624558604826, 0.9966383635434426, 0.9975323714886203, 0.9973066482644426, 0.9963282637412285, 0.9961678265371164, 0.9972108358673664, 0.9956944128252986, 0.995492252557725, 0.995140184878476, 0.996194781940689, 0.995234781565607, 0.9980137773031094, 0.9969722663235756, 0.9973890904290396, 0.9965933549964683, 0.9971724151717565, 0.9968457599920623, 0.9947368421052631, 0.9968487891730292, 0.99631162759313, 0.9969015113882078, 0.9966331058239025, 0.996695812796134, 0.9962771109691514, 0.9954827585522839, 0.9948554334246839, 0.9964138273798493, 0.9961325556890751, 0.9975815435393015, 0.9967784474950766, 0.9957487868850862, 0.9958331646759943, 0.9965073950153385, 0.9958101437433456, 0.9962342441102939, 0.9954399108173355, 0.9964333732484894, 0.9970029744892119, 0.9963883725108915, 0.998421052631579, 0.9963422491594699, 0.998421052631579, 0.9979276675349174, 0.9962736502751045, 0.9962476664904227, 0.9975890758822098, 0.9972776846042064, 0.9952256307701254, 0.9971049463380652, 0.9947368421052631, 0.9967028789233794, 0.9963173500135265, 0.9948976120020863, 0.9965824933103699, 0.9974826873221032, 0.9967973797454025, 0.9967327070593366, 0.9977171205238736, 0.996921142596394, 0.9972996910961279, 0.9957670171549368, 0.9966702278538622, 0.996943454726367, 0.9967943153560158, 0.9964965323534664, 0.996104005085189, 0.997480899653427, 0.9975091943288162, 0.9955560331048902, 0.9970484146682024, 0.9977489791439135, 0.9962816386287376, 0.9962619709657053, 0.9978170715552009, 0.9964905170457756, 0.9959771677309158, 0.9963506254068151, 0.9960880328515369, 0.9977413318876407, 0.9963930467769437, 0.9969597556583125, 0.997103977854698, 0.9958280058393307, 0.9950835240140758, 0.9947368421052631, 0.9952968700717985, 0.9967973855592913, 0.9963718913792536, 0.995943125207232, 0.9965915607115908, 0.9965827356821301, 0.995880344758617]  # Truncate for embedding
baseline = 0.996578947368421
mean = 0.9966137466453152
std = 0.0008677686035594085
p5 = 0.9948618877900345
p50 = 0.9967128671587904
p95 = 0.9978998852717099
display_name = "Unexplored Therapeutic Frontier"
units = "percentage"

# Create figure with two subplots

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---

# Handle edge case where all samples are identical (zero variance)

if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax1.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key statistics with formatted values in legend (use format_parameter_value for full units)

ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {format_parameter_value(p50, units)}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {format_parameter_value(p5, units)}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {format_parameter_value(p95, units)}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {format_parameter_value(baseline, units)}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---

sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax2.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key percentiles

ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"

exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title

fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark

add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from

output_path = get_figure_output_path('mc-distribution-unexplored_ratio.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Simulation Results Summary: Unexplored Therapeutic Frontier**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 99.7% |
| Mean (expected value) | 99.7% |
| Median (50th percentile) | 99.7% |
| Standard Deviation | 0.0868% |
| 90% Confidence Interval | [99.5%, 99.8%] |

*The histogram shows the distribution of Unexplored Therapeutic Frontier across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
