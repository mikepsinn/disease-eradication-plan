```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Thalidomide DALYs Per Event (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Simulation results
samples = [44822.20908703902, 29918.70124042235, 51222.494026419874, 54277.38061581756, 22744.367456880194, 27689.138678456122, 42510.021743923935, 37222.95405453765, 40729.30668195396, 31652.624715407503, 53268.95158809652, 51629.449423780236, 41677.83483523766, 57380.646675312, 47086.69356992034, 31621.481414640042, 45704.687216773076, 30651.03949082642, 53265.897145586285, 40284.69161068343, 38716.380249413225, 33349.675951022735, 59007.20490815944, 39012.92755952867, 35969.31347311787, 36760.65476480566, 48012.261463785006, 45670.31710856201, 46326.376293422385, 46507.475547396665, 70824.0, 36217.88449028363, 35089.35484534352, 32022.599434031326, 49186.47746017925, 57416.09986256987, 39517.12420792322, 31775.438922298286, 31903.307518423946, 49769.12820876078, 51173.00922319738, 48149.57780800296, 33500.26151259842, 43898.60280861623, 42378.19030670063, 43679.315193733026, 53135.29058592175, 43771.850088924504, 50174.57005592841, 41761.58038974342, 44650.99265551858, 49418.302751858806, 26383.68111488942, 37135.7227193124, 35499.12997683812, 33752.228859919975, 37640.39711333763, 64055.63699031064, 31530.13598273255, 54694.36342760064, 24676.075792630032, 36978.99374049448, 42934.61544138144, 48779.63454067436, 50673.44034339294, 51945.50707328651, 36847.75763687211, 35595.16022565364, 52904.193616511315, 38622.15625496545, 27845.94517060601, 29073.393001957476, 31017.424762349983, 47487.84739720107, 42674.9512681368, 50316.43399852472, 35971.49103728375, 42899.56485699536, 49321.48824167541, 37259.96797261339, 46950.90885097059, 33506.93991357843, 36635.69715233591, 36472.69047290047, 28560.344196450504, 47353.12790544836, 35501.067941096015, 41029.76337141436, 47255.66810183946, 46816.64286723438, 49947.043296294774, 39735.6183203726, 36001.486350431835, 39905.36290140883, 24652.951991914946, 26477.761211365323, 27480.240842982945, 30287.77905940815, 46105.35940934306, 31161.365148134377, 36502.224540767995, 60410.70873453107, 36752.05350279393, 51048.09363640587, 30893.41676535533, 38465.219292248126, 30765.81322771592, 36970.31063706294, 52632.08788729632, 24327.229677933537, 46597.395972426464, 43937.77463901987, 34220.55033439169, 26497.4036652235, 41796.70692199055, 34873.95518658339, 43899.923258987386, 41155.87090740685, 66151.9644395904, 38082.842425670446, 30125.226046997297, 43160.65054843977, 43682.655603305226, 61539.88653510018, 52587.77087950271, 45487.3079017305, 63435.752048679606, 28590.29202653995, 33750.58641641679, 30925.336098470725, 36376.0802216865, 27069.234807423876, 49509.71195800913, 38245.654699121485, 26266.507627038132, 30157.872948605593, 44950.60760032589, 52625.153722376795, 70824.0, 70824.0, 46330.96120186302, 30400.29713699453, 21733.724181917773, 44330.10792096596, 32024.06843295708, 36097.62747518367, 34005.148045773756, 39226.84360189899, 56352.49631594705, 42895.84144719844, 39003.75627191947, 30005.75135703935, 24766.652557672114, 35343.90183926517, 40252.18373028088, 69560.98940356486, 42540.409878968756, 54959.674465676886, 35216.50486525002, 28676.19001186838, 30620.73807407592, 32885.74323489248, 70824.0, 31988.752169279902, 52626.306172394485, 31165.729995352674, 54139.49503406043, 45933.93434760676, 39008.216519983675, 40385.99541492176, 33600.25545771279, 46815.37356383053, 35711.76064678975, 28316.83645905509, 27842.58167461882, 43063.83297450349, 65722.17959931296, 42903.191375573144, 39483.21513011404, 44562.382580007026, 60546.38218001679, 43681.087088406945, 36128.67605543666, 57008.690404811336, 46501.79345746139, 64857.85143591575, 43195.23353953351, 28318.567357413067, 27099.943182238618, 67111.11834301383, 68643.02969188933, 38751.19722384562, 36469.70602015135, 63428.40006007042, 29313.500348142075, 31259.770004306825, 49640.71339981736, 36344.12347755691, 40860.50544435933, 38969.94874628556, 45304.97736674443, 62390.422433542015, 42025.75154021558, 49642.527623642905, 22132.15966051637, 40343.92204016619, 31749.735824146774, 28407.185149287594, 31408.601115826354, 37002.940476099924, 53819.92424303209, 27456.237835197113, 41280.71806996706, 35369.87779563934, 37096.48519667849, 55244.13186666304, 48108.843908120085, 61155.93197717832, 39012.98075508365, 33221.05285064734, 38242.08651330137, 44030.0245552981, 43153.85261757768, 29529.01288132665, 42025.519548705415, 43808.52068628674, 70824.0, 70630.4, 31652.277326005973, 37511.64791579169, 26356.778153591382, 34248.42719550504, 44956.132087167265, 58727.00807292128, 32857.95040376175, 33601.452511672, 21632.0, 38971.67905826108, 29763.252751300708, 34874.059355118676, 31410.8310820781, 39745.25097904338, 24157.294252478572, 26351.75116724016, 70824.0, 27809.7177931717, 29429.206352897017, 70413.36997824273, 70824.0, 28795.99825475418, 36624.92341080913, 45315.58138578629, 68744.8332985732, 30404.742276097495, 37990.023417261, 51628.03575405354, 46598.33925587861, 36506.368398861036, 39265.69934510931, 27071.811512965753, 38085.402382258566, 37739.17305581957, 43898.62477684209, 34620.673842718286, 47123.90281392754, 55466.44269715689, 42891.79929856945, 45448.193547308365, 41542.70351809473, 40896.5663978322, 32972.43179465551, 44958.48201272071, 39738.35225171972, 70824.0, 65618.59092021539, 45936.35747215271, 32515.12973260076, 29285.64829472117, 58484.18827440083, 44292.22526604457, 47253.97739954582, 24208.14895896257, 54045.93343992146, 46864.373633461146, 29308.12290814443, 35496.82928945197, 44294.735549208606, 41541.04533137066, 37478.9087146081, 39644.21660901017, 37895.53893720126, 42804.64579097717, 63628.17567861717, 21072.0, 38111.031018858936, 43153.69936188917, 44694.1245712908, 36595.1331809306, 24158.556491384632, 45174.20212839435, 68738.99280010004, 25849.808210569936, 53030.88387747959, 37014.69492425404, 40154.72297996607, 29798.164084382603, 36979.891851589506, 60413.757958630486, 48742.74124526219, 68793.37743652452, 58215.550772942974, 46690.2462672045, 69036.86738088969, 46689.9884363046, 52405.1993752079, 37389.55120378598, 41759.08080048263, 33138.326849737874, 55062.58261868679, 28705.547367454506, 51723.63884760398, 38623.597904766546, 58163.89449386272, 51223.78101066832, 70260.80824227551, 50947.46136757186, 25504.822089941837, 40118.21243851492, 28715.314420354098, 34997.49628287492, 64423.92822377949, 49543.55079619245, 33135.55488778377, 30160.930768650214, 41285.8576405472, 28410.620360111578, 33468.78887557819, 44921.41780524752, 57837.58127771766, 49138.623738419905, 21168.0, 44821.28689450753, 41796.47419336695, 46329.54155014379, 66436.26412204062, 22037.417028958025, 34247.668910039654, 48873.261810539974, 25412.02043161932, 63677.17979357869, 45703.62595835008, 52759.91438576577, 34467.688498738324, 52224.82936155335, 56390.11093087662, 43900.440839815645, 43904.347193726775, 44336.95264378923, 31534.447633229804, 39131.727425749035, 39097.41360638489, 45929.72237241885, 55234.25406222082, 29769.51203733436, 39388.80749528559, 63810.428635245386, 32730.914892662935, 31987.232861539957, 43508.13769596999, 52725.054458343104, 41027.22977902817, 60933.53601938366, 52900.41184712128, 52716.89524376221, 48287.40055732736, 70824.0, 38465.824104871004, 22394.191788358483, 66242.239432083, 35626.31139331308, 42252.27450512643, 60639.679300653836, 25269.128013643855, 28079.61642841335, 25270.430694547707, 32237.858872118362, 46691.76248214043, 47882.86176824366, 44432.39015928508, 26740.939693631495, 21072.0, 41545.589661715, 35496.327691882245, 46958.156853548244, 50538.176846940085, 42640.14389513756, 51359.761089488245, 43811.03999951117, 47979.59176736614, 33104.137907288474, 38750.99292311411, 43414.118792367786, 52353.86565501754, 36345.894952382354, 47848.04925460588, 37762.989331928824, 39485.695870643176, 52490.047832886485, 22486.221416668137, 27697.589996945135, 26232.625273546902, 21072.0, 33375.56797760314, 51219.36073092533, 37516.9821653184, 43416.688182369646, 56730.92674344976, 60928.72804821473, 40033.17375781966, 61438.546719445985, 42029.51213819399, 31780.267099091645, 34220.07265333172, 26234.913215698452, 31291.230038049544, 36726.15331032943, 52085.17775773076, 68550.49092119219, 26981.331098244344, 46060.85923432368, 29917.790209395913, 47212.72768736757, 39351.86351997208, 23598.551754267843, 54048.74856065956, 34119.870825291444, 34843.80819511506, 29671.42225054185, 33601.197061911174, 46499.41071213719, 38626.702885468294, 45175.97063785554, 45580.85934308309, 60791.80749994508, 36882.46011737991, 26240.020199927654, 56356.77063259472, 37008.47215864864, 57146.97163711024, 45929.677066995806, 39351.74887345785, 45440.22448012965, 70824.0, 70824.0, 41765.94099968469, 42903.688450952344, 56496.91328218741, 31745.494621975908, 45212.989289369936, 40604.38891565709, 44951.6492794861, 31867.324852450103, 25383.672336629174, 22010.288213548283, 29197.775730170557, 35624.35412511845, 37476.737821903895, 70824.0, 57007.660172833734, 30645.668399927665, 45437.37151597506, 36216.53051830895, 37518.0928024049, 43255.882590803085, 49275.86128134067, 36969.83898315559, 56265.17384642079, 29040.562686514873, 40991.35133299591, 70824.0, 43770.53191299661, 62903.784324036504, 42028.032699077594, 48737.29337661637, 40221.69435830407, 38874.44976055392, 32364.497141511296, 46506.04517798595, 31655.249830569297, 49947.64200225034, 56666.43941521589, 45673.23807509983, 37514.06924564293, 46863.111936590525, 37261.39362010037, 54180.86968291599, 23581.03745928477, 36977.481186793884, 22488.809777441864, 26116.78686584352, 61588.39913620727, 53536.14766052423, 32976.22264200464, 26026.51821727264, 21072.0, 34745.11976417427, 70824.0, 46598.664863345104, 34591.02103943238, 47079.92710172781, 25617.47646366956, 37387.95173480212, 42151.69296264565, 39867.30099047217, 51857.566259580475, 45349.18754946973, 49955.84364448484, 33255.91855716118, 53544.68125327093, 66681.68150330574, 30552.192718982074, 31291.98348283531, 61069.825327739396, 38622.0687337607, 62345.30514185356, 35838.675094303355, 63291.89437783483, 42543.40836287064, 44200.50840494001, 65391.26288494101, 36718.360242940005, 30800.74401422315, 35746.530562728454, 46858.58597800592, 25531.01184752654, 49543.36452269614, 34834.316751028025, 57701.47648172837, 21072.0, 32271.85964228012, 24654.06666021922, 31900.232966430976, 44068.25209972013, 38751.84557199245, 37892.513993457804, 39002.528039092394, 43510.88240475915, 30249.446560869284, 50580.15055404935, 49911.98832994867, 45934.169642584966, 48374.35302693108, 44695.23692745292, 70824.0, 39865.02625624361, 37264.759736693704, 32612.283737166894, 30011.27625478003, 28170.445094557897, 31290.08939230499, 40029.61767477541, 45216.248037288875, 41537.8556490922, 32510.67403268396, 53632.37082197791, 51081.215905672405, 39001.49327911358, 33624.81007397073, 48244.69486839687, 43287.19438193411, 26476.337349299527, 40035.84343755467, 44210.37544550931, 31171.26181081103, 43291.91637723708, 26386.949939362785, 61071.34546431672, 59509.93802805838, 37894.372333323816, 45610.43370276853, 21072.0, 28918.827016650313, 37475.48846316446, 29648.112285869956, 50683.07196579893, 70824.0, 28708.166076399528, 31780.152975805508, 43907.03474108875, 66382.88236333488, 28321.757941914606, 44071.789295855095, 70263.71538466476, 24911.31106992909, 27837.905188852703, 36000.860187985534, 34992.965141935296, 52221.17057648901, 43947.870091139455, 24038.639891915274, 47751.71606690927, 34375.00703753201, 59987.82340663986, 33874.638012304, 33756.4835116778, 48117.46508683654, 51448.39774470868, 46820.98054322922, 24655.187366251284, 48108.61245977308, 30007.94341298958, 43906.59273947191, 26707.11456676677, 46816.064781237415, 32115.278801992754, 27816.8435424824, 50681.32033727321, 43947.83097709216, 34001.581551508105, 63245.45634884286, 35842.47182433437, 41284.24567148532, 44333.23362607129, 33969.604852845194, 47122.779379460444, 34844.68135788861, 36127.225582002975, 61583.740123059106, 29917.721681061073, 21072.0, 66382.13655946642, 70824.0, 36220.22395029334, 22857.562612335947, 37257.560626641745, 37514.124274816124, 38625.20295442642, 29284.101636233834, 48653.76732674773, 47883.77092777429, 26117.691548119437, 50449.83319696186, 70824.0, 43062.255865676416, 36973.88499846959, 39224.12235284707, 49184.353574512155, 24305.75021045472, 42938.716614587654, 36374.73522534741, 70448.6261630643, 38843.050128174305, 67487.83227125088, 29398.753949929356, 48782.650008915305, 45046.16404351797, 31504.332843252665, 43155.92200558551, 58860.950304475125, 37104.64337245466, 24566.999800993523, 40727.51981446144, 31166.5924483354, 36883.39110550436, 39901.06948109232, 24532.12084531141, 25171.37039006629, 47259.368733331095, 34967.207050178695, 21072.0, 51758.94991208987, 44342.22549642004, 33007.27902827977, 27568.87891554808, 52589.98002924574, 45441.7607994694, 70824.0, 46372.5052705271, 45966.95763220675, 38882.19074798626, 52262.02243925391, 49319.99826238902, 59523.80307367722, 34969.939663951634, 35874.98589439565, 35459.95368293216, 51857.55251153743, 64149.36494757874, 35624.022802659856, 35998.49002853414, 44952.0957349473, 37988.97714384782, 54452.07809667792, 21296.0, 31899.396762727556, 32359.260658735333, 21072.0, 30643.079304955427, 31044.77748495328, 38497.63599557489, 57141.28076238791, 37990.4932984674, 30013.63801380202, 40221.2983586402, 56076.88941787095, 30522.662537947603, 31132.583617005606, 48380.15317381605, 38247.15237737499, 49679.88960696851, 40736.7094962915, 50537.299035658856, 30006.688966208232, 40764.113777412116, 38373.7097950968, 28411.641064837502, 25614.0828718528, 50275.11810618645, 36843.115670405445, 30127.21774711596, 39740.87869892521, 57412.744417626425, 21184.0, 26114.608688873148, 31011.595079557243, 63427.35033464085, 44553.91911419583, 51489.43585702308, 29043.350017255398, 29194.37137679988, 46820.19033602778, 41635.03790501639, 48245.586530172994, 38630.176634494885, 44462.31782399884, 42898.51447755106, 51629.37304851885, 52123.57708855483, 25148.212526213938, 21296.0, 55240.722257590765, 58442.19473008717, 30129.930222507515, 23432.794155266925, 42150.609662253046, 54137.08411057, 70078.36141265676, 47754.23197564218, 36595.54226720202, 31262.505796735633, 41027.28963671776, 37383.82587530645, 30158.7124357496, 70824.0, 69863.31942453806, 57550.43231689554, 31015.050933843228, 52894.73496739279, 49549.74829977513, 46725.6243698514, 59516.23676797253, 49510.36259250821, 51083.062135607644, 49541.69276337227, 45313.54536096373, 23947.86649758038, 41928.77903590077, 34618.99843044623, 27839.739014997478, 67739.66825916895, 68746.12387581836, 61540.01241136492, 44167.74708454862, 61347.27657901797, 41028.71734445711, 43509.38330630803, 29434.496716614958, 46097.78496038103, 41640.12931470427, 27688.43923055544, 40258.175193827024, 39905.33682496653, 70078.213490922, 53504.88485067613, 41027.2757549229, 44071.14692457321, 41417.19604337582, 38493.659062557024, 29551.587799681918, 39100.701964042884, 32726.375610105282, 28081.62500621583, 47713.67119882883, 45976.61813858547, 23926.97031656166, 39394.062229439034, 55191.73164746215, 56220.27384937773, 55699.65309717621, 41380.52129526795, 31746.56872371109, 29530.115379580755, 45349.07985447989, 45838.600310608344, 60176.068258490566, 56906.69492475092, 39349.29050692805, 28170.84666472137, 37136.913243698094, 43675.59444574849, 38495.48487251529, 34374.324453420784, 44161.729452624364, 35127.304937199966, 33873.734567883526, 44919.950658222835, 36248.98763418271, 44034.163152985944, 44424.39678183815, 29044.498144969526, 35375.700515879405, 63001.66199392648, 28829.888742525865, 21759.004773997578, 23430.366442541366, 41253.163297123785, 41281.400929921074, 39485.540406225744, 58867.008708546105, 21072.0, 46069.292967523914, 65377.828363412926, 29162.065472010367, 36498.83053854696, 32634.10021583523, 31260.422814509293, 37099.45043868014, 62770.302337916735, 70415.48378317902, 36976.786357033954, 70824.0, 41372.538828231525, 69272.44535009732, 39770.83019224262, 42542.348821744985, 45670.39878730901, 70824.0, 52854.910079530164, 33099.38732073758, 54696.75611173237, 36718.23144968739, 35337.07789327385, 53767.903977693044, 41281.80310874405, 44463.445839534514, 41113.30131757955, 45222.33778466171, 46465.61270011396, 22857.411103084774, 49950.59635682097, 30432.5744151169, 26502.693713119195, 40161.464475071785, 41985.489691034134, 33225.53849319938, 52494.84048631083, 27334.610059765466, 36216.80506285712, 34339.59125809613, 40348.86515840438, 44464.198539344645, 30250.504093183292, 50847.61533816364, 41670.51235141195, 23200.69002186507, 22719.03284472199, 40763.5617578741, 38271.22216656427, 39644.37186657945, 40599.43473389925, 43776.871122844284, 54409.11402443398, 29287.7180388313, 28715.36967540913, 29434.732262281163, 44650.46247031936, 59468.9033044925, 35963.21634339953, 21072.0, 24534.243487518546, 31867.906751681658, 34594.58327622618, 36213.85583135549, 41379.72662730623, 37232.444168201226, 56077.456941122146, 33379.736272896895, 31536.230054556934, 47224.4100624662, 25767.385665936683, 45972.350757263586, 42159.22260865276, 39131.92067289927, 65904.00161414778, 33964.800585690646, 70824.0, 38238.657813091195, 27843.957722999145, 41767.24420709708, 29641.507497750586, 32636.151884050603, 46097.8992329004, 48291.616028376186, 33964.87569895989, 55055.28707668693, 57925.385394136654, 62915.87989512297, 47977.7367746403, 61586.74291325023, 23230.7694066748, 37139.444014545195, 31528.100158731217, 42408.765365876665, 34466.715847521715, 38883.90460015113, 70676.8, 38875.97943861637, 46329.273663694345, 38120.98057311821, 41861.275080303974, 40990.588856986215, 46821.60218284927, 58062.704278435835, 67063.83990075513, 44915.121089798944, 48869.305535175634, 28946.577672325548, 39863.23479941412, 54276.47446962678, 53037.75410535257, 43636.503682088274, 53399.58768524986, 47389.8508665744, 58677.20018095022, 44651.619699273084, 36753.23104209461, 45220.36293564401, 21072.0, 45928.34814629193, 21072.0, 24332.132247842495, 46857.01808159206, 47220.6452728772, 28829.3444025588, 33010.52482556374, 61724.65732756623, 35370.15471448275, 70824.0, 40891.83236371419, 46233.54253775956, 66439.03813504604, 42542.272799171435, 30279.36508868615, 39606.704099803595, 40477.988739081346, 27123.32234836408, 37864.53243315241, 32733.440665907103, 54007.56495343514, 41290.232132841265, 37601.44117274352, 39614.75866988285, 43770.63994671044, 49188.93122772445, 30283.708373846122, 29916.092033364028, 57003.076709897665, 36125.80087776137, 26735.1434669464, 46729.126477800804, 46995.16452947816, 25854.09042452814, 43811.732902600736, 50989.46759332013, 45799.8691072633, 49447.11858327797, 26833.03601359429, 45182.28251133168, 37354.21543043907, 35372.619981606564, 53132.48500581784, 63770.39112420476, 69984.06623761955, 60689.80058890233, 39606.68881607798, 45476.18047707212, 51487.9032478435, 42413.57914780931, 42541.621935194504, 52391.793629504886]  # Truncate for embedding
baseline = 41760.0
mean = 42387.24010203692
std = 12167.157574122293
p5 = 24767.414718437325
p50 = 40749.700701038586
p95 = 66964.2297295446
display_name = "Thalidomide DALYs Per Event"
units = "DALYs"

# Create figure with two subplots
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
# Handle edge case where all samples are identical (zero variance)
if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)
ax1.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key statistics with formatted values in legend (use format_parameter_value for full units)
ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {format_parameter_value(p50, units)}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {format_parameter_value(p5, units)}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {format_parameter_value(p95, units)}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {format_parameter_value(baseline, units)}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---
sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)
ax2.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key percentiles
ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"
exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title
fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark
add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from
output_path = get_figure_output_path('mc-distribution-thalidomide_dalys_per_event.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 4.176e+04 |
| Mean (expected value) | 4.239e+04 |
| Median (50th percentile) | 4.075e+04 |
| Standard Deviation | 1.217e+04 |
| 90% Confidence Interval | [2.477e+04, 6.696e+04] |

*The histogram shows the distribution of Thalidomide DALYs Per Event across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
