```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Patients Fundable Annually (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata
)

setup_chart_style()

# Simulation results
samples = [48217994.78381357, 53696862.392137624, 46578355.38544919, 45896028.48901208, 62822099.01437717, 56254488.39586347, 48884461.65719688, 50598484.49987117, 49436282.99810962, 52750507.22772421, 46114465.62800982, 46479609.57587985, 49119516.604056016, 44691051.97410156, 47612600.789158545, 52776087.1736326, 47978955.811530136, 53185457.32535618, 46117858.069011636, 49563528.01375923, 50085252.50957154, 52050751.435098104, 43941117.62610481, 49967497.286944345, 51040482.00847142, 50739600.35529773, 47373734.61965303, 47991270.896562956, 47815455.14317519, 47748373.47147895, 38357142.85714286, 50953769.39092229, 51373909.354085535, 52590023.39018038, 47067073.13207661, 44677316.57728906, 49810385.22387075, 52697788.23944861, 52633735.87113844, 46940789.94850765, 46604383.40844195, 47333874.090042986, 51988513.28145322, 48490280.87708007, 48926798.215508185, 48541009.48861975, 46143001.16096677, 48522527.31237087, 46837715.70132314, 49113614.60093964, 48276400.68543832, 47011178.906274535, 57823029.32569046, 50611948.22944916, 51207272.41099984, 51881195.35170925, 50437366.74483811, 41866038.41767195, 52802868.02686357, 45797397.77218057, 60185859.27117336, 50671733.84086188, 48752188.60931356, 47175909.20905912, 46720386.91651306, 46423522.013266005, 50726182.08328229, 51175412.055906825, 46191212.24514097, 50110296.41379711, 55990629.16566944, 54593420.92992332, 53022999.93872221, 47503150.80762473, 48829159.00689657, 46795664.754611656, 51036223.93005766, 48768132.812493265, 47031974.62570465, 50571415.46835823, 47652284.68224252, 51974058.96898068, 50782614.48093869, 50856293.66168229, 55202842.715285175, 47540729.68104436, 51203417.09204762, 49324019.752368845, 47563707.87389824, 47690187.61727435, 46886924.72943019, 49750654.25907366, 51020566.405929044, 49678250.5093388, 60233539.898811065, 57720069.10657369, 56459711.21788634, 53343998.50872109, 47863569.6524775, 52965547.4199033, 50842186.33124031, 43346776.17421116, 50755865.46267336, 46625147.43281188, 53081305.96539457, 50165284.79637579, 53148907.70174749, 50688046.59301213, 46254604.27710355, 60662257.92921104, 47735024.10559156, 48469307.59558679, 51701452.73563881, 57709268.22293172, 49096273.567884386, 51442718.91015397, 48488343.22578744, 49288212.156087086, 41079112.97825435, 50297495.77385792, 53539975.415181816, 48689714.18528988, 48536081.854790375, 42887667.83325897, 46273267.26053587, 48023213.667419896, 42101946.62590982, 55133559.31083227, 51884712.517261356, 53052313.556477904, 50888157.59238139, 57003209.77225901, 46997086.11109909, 50230669.10759185, 57963262.26070787, 53464786.32886675, 48185086.12272429, 46262437.77727105, 38357623.47446471, 38357142.85714286, 47809232.62284352, 53312104.296692476, 62822472.55885592, 48356678.00447497, 52586630.14532526, 50989137.59160598, 51773498.887526415, 49914253.52328748, 45179851.67830344, 48773776.75056263, 49983418.521002464, 53655610.28468856, 60098525.46704013, 51270628.87011533, 49578364.05564536, 39884537.04448756, 48875227.96727708, 45746015.46940691, 51322323.97911112, 55096202.61599342, 53211188.164980374, 52229956.18455293, 38357142.85714286, 52621100.12826624, 46261135.546195515, 52955061.7906393, 45928074.70648306, 47918667.596042745, 49975673.434080556, 49528295.284959614, 51945280.39911466, 47691886.52173485, 51146161.15853964, 55495220.725126944, 56013002.42951293, 48714991.87675768, 41244978.79602877, 48762637.87691212, 49828520.58630427, 48288741.38430047, 43294667.328943, 48538395.45108967, 50971612.96285807, 44857635.067661285, 47756025.26638821, 41563654.21600704, 48674757.18327957, 55484026.832037255, 56917020.48467024, 40722069.10303667, 40199334.083982825, 50064489.82928766, 50862013.82277533, 42115846.19753017, 54339764.28027425, 52921381.45279899, 46967271.13330535, 50907096.577936195, 49391495.97658114, 50002071.39237904, 48095189.42417009, 42521406.37863456, 49026005.350973725, 46965040.107677735, 62822405.225874886, 49558883.777226835, 52710357.504888535, 55428363.522229336, 52853369.92190918, 50668739.35639979, 45983977.162928104, 56496725.4506686, 49254642.3713666, 51262122.03792316, 50643384.38209243, 45674982.62401826, 47352389.89163429, 43053946.26486189, 49967404.99047908, 52111419.11634297, 50237046.93838949, 48451400.73133869, 48699926.45718999, 54121697.01400541, 49026367.279728524, 48505084.24244901, 38357142.85714286, 39120430.149496086, 52751323.42477001, 50485299.67980979, 57887565.900261104, 51687642.75191403, 48177266.41118772, 44071523.994170725, 52245592.16199062, 51942695.889902785, 62822484.94230438, 49999056.637, 53911046.59204194, 51442506.230004855, 52848073.74691294, 49734353.11956168, 60990321.81421907, 57924590.71603004, 38357142.85714286, 56107363.855321, 54240907.90391029, 39398862.87663478, 38357142.85714286, 54965559.06271311, 50803090.33624896, 48080331.53942447, 40163420.21045783, 53301016.13951876, 50320615.87221358, 46481248.86828569, 47733755.44210679, 50834270.99791077, 49887271.036561, 56985102.458660744, 50292883.01630728, 50403113.24519825, 48490248.63837802, 51545943.67864461, 47597713.4438542, 45609178.0511454, 48779906.34831663, 48042280.795938484, 49168621.56767791, 49371544.36373959, 52215093.57876001, 48173941.48468038, 49746025.839146174, 38357207.91950035, 41287022.04564094, 47915336.915482506, 52383491.574142806, 54391535.39441945, 44186800.70339762, 48375304.80623548, 47565934.950389445, 60848314.899588875, 45942817.55642837, 47660995.131252825, 54372418.29873651, 51211850.6011924, 48371670.73141492, 49171248.9850961, 50504059.87458952, 49769972.63806071, 50346783.338762045, 48790760.50009032, 42040758.85763374, 62822807.701526046, 50287718.12605859, 48700156.771343976, 48250649.92825747, 50817542.87199755, 60979433.46368704, 48130959.13111187, 40173033.96023292, 58615453.21740849, 46170233.8226317, 50646733.19862881, 49607389.24691611, 53820076.50880683, 50670047.59861052, 43340492.999929234, 47188972.596076235, 40137646.36479043, 44294672.282152176, 47717751.03144894, 40054870.424905404, 47718097.39293049, 46298859.6841085, 50521305.667584464, 49117553.02463567, 52117408.49871349, 45721716.39585605, 55031315.08329748, 46463166.393190615, 50107756.18937232, 44343188.449915215, 46576844.8830318, 39512858.13338786, 46649549.76374383, 59013899.0825052, 49629063.26447719, 54969856.76121908, 51397980.74397664, 41745109.720195785, 46988394.54148379, 52123501.2659261, 53447123.76562272, 49246422.54764662, 55406206.994917944, 52011231.00831104, 48190712.398399025, 44468841.02063968, 47093449.66956512, 62822599.62108516, 48219305.907560326, 49096639.096748985, 47811159.04343009, 40973957.87324969, 62822416.06448529, 51689232.60970729, 47158760.97649015, 59114031.16984497, 42007493.434032924, 47980423.64307399, 46232076.556620225, 51608441.06027742, 46350008.93527336, 45159869.85012354, 48487583.79073626, 48481853.387552395, 48346801.97581743, 52792684.94411346, 49940358.69495949, 49959715.84921336, 47924458.9971142, 45685385.23938996, 53873952.035441816, 49853160.89630715, 41966431.85837236, 52304421.80571976, 52624625.042830735, 48602765.10125899, 46239968.08576664, 49328108.241783656, 43118506.637870155, 46195450.20678535, 46249176.07132098, 47293616.93425157, 38357142.85714286, 50164210.893523514, 62822310.380617276, 41061055.48219444, 51156941.06290866, 48960244.22216753, 43267389.86371094, 59331192.40328073, 55752280.33399536, 59320859.1519974, 52509960.64363727, 47715714.371557176, 47403606.08085048, 48324552.84596818, 57369343.09067967, 62822614.300139464, 49164049.57609066, 51212848.926524915, 47642630.52860406, 46754027.08992307, 48845018.09338863, 46543363.693394415, 48501383.74790233, 47381988.26268054, 52146732.01037701, 50064848.03405412, 48623629.183270246, 46325676.70476027, 50903683.909564205, 47414721.019025624, 50400967.204935834, 49824282.13878157, 46293358.2603856, 62822268.45098276, 56197542.995759286, 58080420.51429816, 62822632.54805263, 52039989.13053266, 46582033.55553374, 50475509.417537875, 48619802.92613327, 44993817.657344036, 43128266.65018524, 49637478.31660752, 42930353.81958168, 49020139.72896232, 52686511.8149674, 51702457.244496346, 58063429.10719792, 52894316.97281704, 50762769.02499317, 46386644.54477702, 40220017.155438304, 57058825.25225109, 47889382.83660841, 53702197.820410684, 47586046.15838635, 49876678.94684235, 61787095.24111717, 45939755.906577624, 51745000.270484254, 51460315.11546615, 53981301.14810238, 51943247.384093225, 47759235.235338464, 50102286.62006751, 48128469.39026671, 48004391.98877587, 43182100.80525085, 50702810.578057975, 58025538.812128894, 45169887.54829998, 50658379.13378117, 44791542.17313963, 47924521.30431571, 49876875.877631135, 48053395.46266037, 38608472.62662942, 38357277.66376134, 49106746.471114196, 48761884.867650084, 45097617.87415222, 52720299.42331919, 48112005.413051486, 49471060.08422612, 48183611.33324363, 52670042.87604521, 59197722.881556705, 62822424.12513777, 54439557.20700828, 51160814.88677947, 50508059.02262546, 38703087.16272711, 44859987.5936871, 53198698.58327999, 48057376.69308331, 50956391.706899814, 50473471.812140435, 48666858.08968083, 47055414.42424035, 50688933.19033054, 45196932.01855688, 54677302.30713165, 49347585.61781118, 38357142.85714286, 48524469.781283885, 42327526.62790793, 49022447.010816544, 47195852.18876782, 49589910.240903474, 50029103.17579013, 52450292.16893432, 47750299.28785643, 52744340.86586347, 46886196.40178953, 45025230.81385647, 47987221.00118151, 50480854.86996542, 47662677.404661216, 50568772.61885026, 45913908.31645412, 61792577.7935977, 50674574.15711515, 62822259.42686403, 58213269.89587172, 42852078.40960218, 46057988.52377188, 52206676.3473279, 58290201.581180364, 62822857.14285714, 51498643.11391476, 38357142.85714286, 47733317.544899784, 51562925.07134014, 47621578.38898281, 58897967.38700577, 50524255.477335565, 48992183.03292438, 49702862.04342441, 46432679.867536545, 48068803.41392143, 46876222.95089244, 52080818.6735272, 46048585.023347154, 40881438.84157729, 53231969.38892626, 52892518.68975567, 43066286.71155912, 50110450.642540485, 42549057.620537795, 51096783.56461455, 42163734.129855245, 48870633.634615295, 48392279.30780416, 41350404.63207837, 50777557.51437735, 53112220.70389794, 51120691.36400577, 47668713.717291154, 58948161.47065111, 46988623.98065807, 51479768.932066165, 44528098.59334091, 62822679.119011566, 52479126.1894442, 60224285.432307445, 52640875.73948254, 48431967.13613162, 50063353.124589205, 50352254.0072697, 49985552.02758491, 48598683.76390448, 53397997.86445642, 46736262.45323825, 46896821.66456428, 47918344.139265165, 47284745.66947431, 48249062.12080479, 38357457.163120076, 49706694.277318306, 50562534.41314173, 52344773.821872376, 53623328.007262126, 55681332.09772976, 52897039.80301961, 49643420.219159536, 48107432.303188175, 49176304.41943154, 52393564.34459093, 46040117.17564982, 46618282.11000691, 49987349.70186824, 51937737.678404704, 47314503.1334062, 48656857.91909572, 57730463.9648683, 49633019.10568008, 48377983.34002594, 52941782.90755095, 48649797.668320544, 57799092.61555805, 43063214.1101151, 43743300.057505965, 50348892.924602896, 47998682.67360066, 62822691.03141583, 54817303.74690338, 50510361.03918161, 54004112.91011274, 46708892.758098565, 38357617.927383274, 55014823.272443, 52686778.26031578, 48477912.2428546, 41011043.04113283, 55463405.12633735, 48426817.005166784, 39508277.993301906, 59854606.41196002, 56044139.894100085, 51021786.95190069, 51407188.527946256, 46354191.256692044, 48454548.48519876, 61177037.49653424, 47435911.859927215, 51634857.99053471, 43537953.25817473, 51835765.65257368, 51872088.115453616, 47341305.72564381, 46533272.837163806, 47684383.38987956, 60214983.77740013, 47352687.58420485, 53642797.21695078, 48478560.33975208, 57481115.32902023, 47690961.33337436, 52560759.791500986, 56059711.394659735, 46710982.3961994, 48454605.63873437, 51781051.79239926, 42192698.99449756, 51089317.09965899, 49249000.101539195, 48352167.17468794, 51803914.56000991, 47599199.42465778, 51458526.72296699, 50974425.54482486, 42861360.64165871, 53702599.19866992, 62822693.2004643, 41012348.036909185, 38357142.85714286, 50949239.50491438, 62822041.40836054, 50575879.24647828, 50480753.868959635, 50104928.56542848, 54400962.99331618, 47200306.71898129, 47402430.44015379, 58206502.08242888, 46764033.13036587, 38357381.91286584, 48717364.643694766, 50681329.356939234, 49918949.61082085, 47069713.26755132, 60698326.41385157, 48745992.87999857, 50890740.71188528, 39322583.33398534, 50043722.79702631, 40599584.63898786, 54307901.052645, 47172112.78830342, 48163077.56783048, 52816045.551312886, 48696816.9232832, 44019392.35983701, 50628133.535957046, 60283007.018221036, 49439205.20430837, 52952990.76393399, 50701058.96183588, 49685458.516753785, 60429560.93033661, 59472420.04773947, 47558834.45687007, 51415686.66804143, 62822806.30424294, 46454173.53843605, 48339198.624018416, 52183975.41061267, 56400934.80171568, 46270765.02689624, 48051252.037303545, 38357142.85714286, 47787792.88901166, 47908433.007996626, 50015595.90592598, 46339172.87493628, 47033818.90012811, 43713985.696285084, 51410118.46507023, 51068528.78418567, 51241974.116986565, 46432695.7279871, 41840519.08759635, 51161470.73873625, 51026407.88057032, 48182979.297119364, 50322504.505597316, 45855114.59619866, 62822568.56608365, 52642818.18090961, 52462233.31180207, 62822622.27028923, 53205085.44274282, 53005329.1387501, 50148420.31569102, 44804480.93485384, 50319767.76575144, 53609540.26395906, 49590569.64770355, 45314880.70525658, 53255967.15090281, 52986492.30370796, 47277349.08264995, 50227992.954776295, 46952115.7043823, 49424182.844540864, 46755079.45379945, 53650128.97726634, 49418191.56096094, 50185735.9301312, 55399627.12056204, 58924305.775682375, 46812871.60366443, 50734950.00961073, 53528410.55770705, 49741749.98228594, 44684881.14272237, 62822591.358035356, 58229571.18133404, 53037129.36605851, 42117831.56121, 48300882.41320766, 46517416.08411559, 54660058.80807028, 54460350.32957686, 47685440.58409035, 49149092.55490112, 47313361.40247026, 50096169.8545323, 48317541.60429152, 48769724.75087091, 46479698.13566246, 46374320.13930244, 59516902.64425619, 62822565.002776, 45678572.47638, 44213626.98083976, 53512668.73245792, 62104946.91987611, 48993866.08214118, 45930694.452952586, 39674958.214908175, 47432645.595983855, 50816762.5630307, 52914827.08754804, 49328011.63539206, 50531867.27145411, 53459936.096604936, 38357398.72511354, 39762614.095721565, 44621212.32366242, 53028751.85114104, 46201814.36758639, 46980763.04458435, 47704942.23721621, 43729977.87135705, 46996282.87213243, 46616105.354002975, 46990683.31200112, 48083183.11682912, 61270959.611563444, 49052508.08230436, 51549402.415567406, 56031925.49402925, 40499262.72203582, 40161296.491878994, 42887416.30113891, 48403605.72042463, 42952932.59003324, 49325707.59931025, 48600912.75445128, 54209013.785459116, 47873908.93813603, 49141039.02457458, 56259206.61059106, 49568417.68569876, 49678294.27703016, 39675193.25400176, 46061462.56734558, 49328034.03964275, 48427752.15449686, 49202757.70990638, 50155461.88478047, 54102865.7623928, 49954014.52497283, 52314609.14935023, 55739106.35687216, 47451335.8850295, 47895191.924771026, 61304618.87850126, 49844169.31260366, 45700009.09879734, 45234086.93423264, 45503042.63155398, 49222996.277664855, 52717780.988643214, 54115077.10896868, 48068953.84278722, 47939763.11157297, 43438453.96885942, 44907916.52436372, 49881099.303381614, 55678704.612510905, 50609730.80228578, 48546500.1857536, 50152228.68278805, 51636281.196258955, 48412354.177986905, 51340893.4488921, 51837690.415355526, 48192794.35421965, 50936286.8878102, 48445356.03391402, 48336068.85431689, 54652959.289682224, 51250475.538021, 42293243.59184021, 54873093.58287791, 62822460.00610438, 62127088.73509799, 49260458.70828906, 49253549.99017639, 49824547.72013185, 44006332.42724215, 62822857.14285714, 47877838.151382275, 41374499.31421618, 54540096.55643922, 50848672.46223528, 52342192.213064484, 52919817.21021284, 50637839.36819675, 42370616.401201844, 39395552.161661014, 50675879.10972019, 38924871.21664806, 49235744.155206494, 39985525.71622634, 49730633.05041692, 48872256.915348746, 47991157.63387203, 38357142.85714286, 46215206.94172756, 52157217.50617933, 45794839.884430416, 50777802.04161464, 51284325.15142538, 46010046.36246536, 49252906.65731228, 48315920.94159868, 49318312.45301346, 48098890.318599544, 47770077.144215934, 62822041.93218535, 46882602.98363732, 53281014.53790701, 57670789.661896296, 49596175.938443996, 49051137.93743465, 52101568.66512032, 46287922.34053475, 56655178.492491536, 50955859.94345486, 51664254.880305424, 49550688.22652778, 48314839.61208628, 53391903.6315202, 46673063.220623426, 49131061.87371923, 62459663.919238046, 62822129.59885239, 49419091.438403845, 50225776.00510518, 49769709.40750219, 49479198.265786886, 48515130.719946235, 45870793.78492475, 54378924.58459167, 54969509.47383612, 54207594.64053803, 48277160.28244236, 43766630.32934806, 51052410.96338297, 62822759.90472122, 60411777.759440884, 52668685.82273356, 51555550.30434454, 50961573.277744725, 49224264.847041376, 50580833.715541415, 45313545.136220865, 52030916.40759634, 52788477.244743936, 47570615.945827976, 58633976.92895518, 47901039.436372966, 48980490.17192984, 49940024.66991894, 41177749.474543266, 51814131.31476861, 38357349.30066702, 50243178.04661655, 56003847.03207636, 49104694.50288133, 54043539.77646423, 52337578.62804231, 47873752.897248134, 47288237.370122604, 51813971.52612864, 45729450.139782466, 44451506.04385183, 42304325.38468457, 47384383.55560362, 42855377.65939579, 62336289.200889476, 50605018.17891902, 52807678.47754466, 48917154.39722946, 51610465.5758454, 50012607.07762296, 39083411.80363691, 50026433.052598156, 47811522.586121924, 50269845.0691779, 49082620.61685291, 49348820.230692685, 47683551.77313528, 44389982.14979744, 40747637.86714596, 48199649.91774731, 47163737.2754295, 54763987.572588354, 49709713.04369359, 45897009.14832948, 46162562.59222748, 48567684.59185178, 46089429.39210469, 47526731.41025631, 44114959.33920112, 48275502.3715267, 50753637.67126911, 48101659.84034758, 62822857.14285714, 47926349.05203396, 62822857.14285714, 60620771.69479378, 47670805.44164146, 47575586.663872354, 54876494.938112, 52176797.99788745, 42801282.27832933, 51261567.94590397, 38357142.85714286, 49379224.15626399, 47832887.44522117, 40969120.647318445, 48872373.39355599, 53365098.05106177, 49794075.88249202, 49508497.88639573, 56882512.88491581, 50361845.39362539, 52298756.22830759, 45953805.821717925, 49239430.00445092, 50467330.49273554, 49780377.381818764, 48524310.5724539, 47064023.55775609, 53354202.93844375, 53712146.04286566, 44870456.956767134, 50977188.6723748, 57410855.30956113, 47700250.96084706, 47627900.71756794, 58582739.085040666, 48500366.14519656, 46632141.79750911, 47957974.373031, 47008649.30625938, 57282907.881239735, 48119586.986503534, 50545024.784862675, 51256636.04544094, 46146128.80953633, 41982690.90751197, 39697685.60881781, 43227014.19262813, 49794101.88789212, 48038687.396647856, 46519201.174772136, 48909744.188927226, 48873370.65534185, 46314082.428777196]  # Truncate for embedding
baseline = 48844000.0
mean = 49665319.5401523
std = 5085273.402037794
p5 = 40781334.97790956
p50 = 49422344.55207033
p95 = 60092242.27422501
display_name = "Patients Fundable Annually"
units = "patients/year"

# Create figure with two subplots
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
# Handle edge case where all samples are identical (zero variance)
if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Mark key statistics
ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {p50:,.2g}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {p5:,.2g}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {p95:,.2g}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {baseline:,.2g}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---
sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Mark key percentiles
ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"
exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title
fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark
add_watermark(fig)

# Save PNG (same directory as the QMD file)
output_path = Path('mc-distribution-dih_patients_fundable_annually.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 4.884e+07 |
| Mean (expected value) | 4.967e+07 |
| Median (50th percentile) | 4.942e+07 |
| Standard Deviation | 5.085e+06 |
| 90% Confidence Interval | [4.078e+07, 6.009e+07] |

*The histogram shows the distribution of Patients Fundable Annually across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
