```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Patients Fundable Annually (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Simulation results

samples = [42851516.387360334, 47722053.16389715, 41393909.846379384, 40787332.42470143, 55833527.585805744, 49995579.71958241, 43443989.78121405, 44967710.169426, 43934545.039249845, 46880790.069005884, 40981519.62517702, 41306126.53471476, 43652947.80571598, 39716178.17334738, 42313334.22257088, 46903529.76231766, 42639016.04223802, 47267445.56239581, 40984535.45093042, 44047662.530435845, 44511461.505492374, 46258730.6112473, 39049536.96768246, 44406780.359068744, 45360632.85736211, 45093158.03753959, 42100987.06225927, 42649963.8838368, 42493667.476646446, 42434033.29513117, 34085714.28571428, 45283547.94897359, 45657039.56128788, 46738125.41504625, 41828370.98804597, 39703968.33549283, 44267112.00899126, 46833924.69441194, 46776984.32455037, 41716107.61884606, 41417048.3020734, 42065551.846206956, 46203402.921516046, 43093572.48213091, 43481625.94416179, 43138669.03112358, 41006887.25607445, 43122238.809639364, 41624476.51939333, 43647701.07305445, 42903437.91311921, 41778682.08131523, 51389885.875792995, 44979679.03344208, 45508904.4544041, 46108000.75850685, 44824481.13480664, 37204927.27477696, 46927337.01937402, 40699651.20790967, 53490240.01483906, 45032826.697550096, 43326402.25014685, 41925124.16853156, 41520173.35876472, 41256265.65057248, 45081229.58837364, 45480581.57273962, 41049746.13019944, 44533724.84115112, 49761030.01899612, 48519023.09985221, 47123026.65239056, 42216035.439439885, 43394827.072580814, 41587093.99584507, 45356847.554192744, 43340576.262649566, 41797169.08264775, 44943646.58627182, 42348612.3786, 46190553.507585146, 45131396.32700723, 45196894.93536544, 49060750.73571046, 42249442.28933198, 45505477.19385268, 43834745.91288265, 42269869.43070629, 42382307.295503594, 41668222.43946472, 44214012.78881166, 45342928.48751002, 44149647.79098987, 53532622.226033695, 51298362.60954036, 50178006.32136906, 47408383.04774051, 42536440.24530865, 47071953.366951026, 45184353.93771287, 38521206.87702786, 45107617.23899258, 41435507.15381063, 47174858.668854184, 44582607.98101755, 47234954.23612051, 45047328.256639786, 41106100.609802276, 53913699.75374701, 42422165.99074928, 43074927.72333308, 45948215.33320427, 51288761.50147343, 43632285.32927423, 45718209.115926415, 43091849.95531118, 43802913.87718963, 36505400.46638597, 44700139.823373586, 47582592.933738545, 43270863.98534081, 43134288.480243415, 38113089.727035284, 41122691.69432797, 42678360.30731704, 37414634.53751982, 48999163.29736187, 46111127.40518474, 47149085.433295555, 45225221.02125926, 50661132.73493877, 41766153.85212585, 44640732.80138867, 51514541.54596034, 47515755.720488176, 42822261.32745088, 41113064.4624181, 34086194.90303614, 34085714.28571428, 42488135.7887873, 47380030.22972448, 55833901.13028449, 42974802.61812929, 46735108.935542256, 45314989.21767727, 46012262.06270685, 44359448.10898669, 40150687.868638225, 43345593.58744773, 44420933.899355024, 47685383.274374336, 53412611.005856514, 45565226.40213823, 44060851.38080476, 35443499.89308382, 43435781.25646093, 40653973.1043084, 45611181.76010057, 48965956.16417048, 47290319.369478196, 46418037.74008696, 34085714.28571428, 46765751.5791635, 41111906.80045613, 47062632.00743279, 40815821.020775035, 42585421.129036486, 44414048.729648486, 44016341.5603673, 46164970.29296664, 42383817.58595292, 45454578.41698319, 49320651.503804214, 49780918.058635674, 43293335.2482295, 36652844.734077774, 43335691.39738219, 44283233.85622416, 42914408.51406195, 38474885.55136084, 43136345.21308904, 45299410.34918056, 39864259.24720666, 42440835.57898504, 36936127.002917886, 43257567.56757592, 49310701.02536114, 50584517.41765026, 36188010.80501042, 35723331.73706859, 44493004.057815805, 45201979.98849441, 37426990.36253927, 48293542.37482228, 47032691.357459545, 41739648.89698289, 45242057.21443666, 43894730.53784678, 44437515.78941807, 42742345.167149805, 37787507.15583965, 43569818.63692634, 41737665.55700079, 55833833.79730345, 44043533.92639174, 46845098.341389105, 49261220.77977816, 46972231.46192477, 45030164.68845558, 40865517.43941402, 50210908.99763315, 43773071.19542543, 45557664.08997685, 45007624.85703668, 40590825.94571691, 42082012.02524528, 38260900.359976545, 44406698.31004127, 46312662.19329056, 44646402.51363652, 43059008.93704732, 43279942.45092746, 48099697.76213516, 43570140.38259825, 43106732.32842271, 34085714.28571428, 34764268.502529465, 46881515.640168816, 44867092.137751825, 51447253.64159816, 45935938.697009504, 42815309.7792183, 39165459.51025303, 46431937.606194526, 46162672.74805866, 55833913.513732955, 44434835.75479587, 47912446.105571575, 45718020.04990848, 46967523.345328584, 44199521.512825616, 54205308.08210962, 51480165.69024456, 34085714.28571428, 49864797.8047702, 48205666.85202848, 35011773.56205086, 34085714.28571428, 48849824.41886714, 45149598.757008635, 42729136.83665531, 35691406.51156441, 47370173.252563104, 44720692.93616518, 41307583.83748119, 42421038.1756732, 45177317.44131534, 44335461.41316112, 50645036.79564209, 44696039.21235408, 44794030.75345171, 43093543.82267656, 45809972.70183509, 42300099.68083532, 40532329.581392415, 43351042.65188782, 42695310.565403275, 43696600.8823415, 43876994.069339454, 46404825.375221655, 42812353.99404614, 44209898.247658744, 34085779.34807178, 36690218.52915464, 42582460.22609609, 46554525.591599256, 48339562.809734635, 39267932.779755145, 42991361.417225875, 42271849.25586789, 54079081.45742207, 40828927.18722556, 42356355.786066525, 48322569.220546804, 45512974.32531554, 42988130.80822726, 43698936.59010179, 44883769.41064793, 44231186.308870636, 44743955.07130765, 43360691.73054317, 37360242.54447304, 55834236.27295461, 44691447.77091354, 43280147.194701076, 42880546.07353883, 45162446.63335569, 54195629.68235973, 42774143.64179488, 35699952.54423813, 52094286.08051479, 41031096.6528048, 45010601.85719723, 44086654.0094212, 47831580.8463882, 45031327.677516095, 38515621.54980003, 41936737.26602447, 35668495.14615627, 39363823.369390465, 42406810.59178876, 35594912.86090309, 42407118.499856666, 41145442.935027696, 44899100.42316552, 43651202.23289748, 46317986.55761712, 40632371.58592754, 48908276.30144735, 41291508.827512324, 44531466.65222759, 39406950.97979376, 41392567.03617037, 35113106.455288365, 41457200.39420134, 52448471.80538165, 44105921.63722889, 48853644.73178288, 45678438.27935694, 37097429.39018595, 41758427.210308634, 46323402.82758694, 47500055.0834476, 43765763.98147039, 49241525.39244779, 46223598.24120875, 42827262.96026977, 39518647.65135351, 41851819.22626935, 55834028.192513734, 42852681.94683097, 43632610.275282525, 42489848.33561389, 36411924.17839991, 55833844.63591386, 45937352.03003328, 41909879.721828505, 52537481.01059717, 37330671.718877696, 42640320.91244262, 41086073.836251326, 45865530.903800026, 41190913.765801184, 40132925.38792835, 43091174.83525517, 43086080.640362285, 42966023.054996185, 46918284.60937982, 44382654.893771656, 44399862.874160275, 42590569.5591815, 40600073.719398856, 47879471.95892798, 44305138.42468536, 37294170.61254579, 46484235.20595616, 46768885.10828682, 43193568.31616153, 41093089.276253514, 43838380.47499916, 38318290.29234554, 41053513.6091973, 41101275.024157226, 42029764.03243296, 34085714.28571428, 44581653.31138247, 55833738.95204584, 36489348.48698721, 45464161.42348446, 43511358.62097106, 38450637.682922214, 52730519.4979297, 49549156.97578135, 52721334.087516114, 46666952.34367231, 42405000.0439993, 42127542.19246943, 42946244.08743754, 50986595.63639374, 55834042.87156804, 43692536.4971865, 45513861.80596363, 42340030.03713752, 41550078.86694957, 43408925.41493985, 41362802.84276325, 43103442.67520211, 42108324.385733955, 46344054.1957109, 44493322.49194112, 43212115.9911632, 41169282.81996062, 45239023.45412665, 42137423.14900306, 44792122.9849445, 44279465.9909674, 41140552.26063156, 55833697.022411324, 49944959.82858866, 51618685.691950865, 55834061.1194812, 46249163.27398511, 41397179.67517074, 44858388.87617346, 43208714.539239086, 39985316.309606016, 38326966.30193895, 44113402.39544686, 38151034.776085936, 43564604.24462187, 46823900.33850719, 45949108.30960409, 51603581.71537656, 47008631.9733439, 45113754.30238198, 41223482.20609932, 35741717.71504324, 50710570.403330415, 42559387.61050576, 47726795.94126072, 42289727.70515462, 44326045.333347075, 54913541.164604105, 40826205.42774015, 45986927.703266025, 45733851.593143135, 47974896.88380765, 46163163.00851766, 42443689.173444934, 44526604.357051134, 42771930.31762909, 42661628.247718886, 38374821.32594679, 45060453.00652683, 51569900.32942326, 40141830.437566735, 45020954.753418975, 39805507.14990689, 42590624.9489339, 44326220.399467476, 42705191.25928148, 34309178.580268525, 34085849.092332765, 43641595.477870956, 43335021.99029406, 40077587.62936322, 46853936.366498485, 42757294.208072156, 43965460.96370575, 42820950.27268211, 46809260.01422935, 52611876.06683483, 55833852.696566336, 48382250.4096636, 45467605.13479226, 44887324.53796503, 34393282.80288591, 39866350.483072564, 47279216.572922766, 42708730.485338874, 45285879.109267905, 44856577.50354821, 43250545.461659655, 41818006.61868653, 45048116.415680274, 40165871.1243437, 48593587.00789654, 43855695.36156755, 34085714.28571428, 43123965.61902001, 37615160.614560805, 43566655.360903986, 41942853.09017927, 44071115.6348912, 44461546.30038128, 46613909.07983085, 42435745.305180065, 46875308.38488326, 41667574.96965602, 40013240.4666085, 42646363.615353175, 44863140.82966982, 42357851.29200728, 44941297.16968445, 40803227.31762715, 54918414.474986695, 45035351.6555953, 55833687.998292595, 51736777.96219599, 38081453.05602086, 40931312.377875485, 46397342.73470486, 51805163.95376958, 55834285.71428572, 45767923.984626725, 34085714.28571428, 42420648.894292295, 45825068.62552943, 42321315.12261084, 52345418.03786171, 44901722.71886989, 43539751.43478051, 44171526.788398065, 41264406.82712612, 42718888.58793787, 41658708.75600935, 46285459.40274789, 40922952.81455495, 36329680.552842796, 47308793.142053895, 47007033.36200679, 38271870.20720673, 44533861.946217574, 37812087.31477985, 45410683.236883305, 37469559.651704386, 43431697.00687772, 43006451.35851187, 36746561.642808795, 45126900.83307884, 47202340.78594819, 45431936.544595554, 42363217.44785036, 52390036.46186495, 41758631.177419685, 45751145.42791678, 39571323.63517384, 55834107.69044014, 46639541.55371641, 53524396.14409921, 46783331.42435634, 43041732.92136137, 44491993.55879095, 44748818.34013017, 44422830.52812382, 43189940.10372327, 47456385.998998106, 41534286.42538771, 41677020.6316788, 42585133.58296244, 42021877.65316585, 42879134.548632294, 34086028.59169151, 44174933.54197611, 44935751.585604884, 46520106.803647734, 47656686.85963424, 49486089.661984675, 47011052.47504299, 44118684.58914987, 42753228.81497603, 43703430.74355659, 46563479.94735122, 40915425.03147761, 41429404.00297828, 44424428.611190766, 46158265.058720954, 42048331.45022853, 43241655.54813093, 51307602.793988496, 44109438.27519268, 42993742.57218406, 47050827.54210853, 43235379.15313658, 51368608.086658515, 38269138.86619185, 38873690.333449855, 44745830.43317331, 42656552.79151308, 55834119.6028444, 48718037.2001183, 44889370.96430247, 47995174.74639768, 41509955.258159555, 34086189.3559547, 48893616.39101333, 46824137.19931747, 43082577.05451283, 36444890.56676666, 49292369.97297488, 43037154.57412595, 35109035.06829725, 53195791.41279453, 49808596.77021611, 45344013.5160865, 45686623.71297648, 41194631.779377185, 43061807.21716414, 54371275.26978751, 42156261.37940306, 45889014.71909752, 38691150.661721125, 46067615.2192941, 46099904.71922478, 42072158.422448106, 41353832.24693393, 42377147.458964586, 53516128.11743762, 42082276.668006025, 47673993.46138333, 43083153.197563976, 51085952.09674652, 42382995.1128973, 46712111.068192214, 49822438.586520724, 41511812.90897069, 43061858.0253304, 46018976.353339665, 37495307.55027219, 45404045.77595862, 43768055.36125914, 42970792.59386508, 46039300.62097252, 42301420.68703285, 45732261.76807501, 45301910.65010809, 38089704.35366841, 47727152.7350587, 55834121.771892875, 36446050.62612875, 34085714.28571428, 45279521.0160649, 55833469.979789115, 44947614.75555948, 44863051.04268071, 44528952.97309807, 48347943.20095231, 41946813.08085917, 42126497.07150827, 51730761.92803428, 41558974.055966236, 34085953.341437265, 43295444.58116926, 45041356.83050739, 44363622.80270605, 41830718.018172875, 53945760.19024678, 43320894.39585699, 45227517.33749316, 34943966.986918904, 44474542.74020894, 36079129.73732131, 48265218.47898316, 41921749.224070534, 42802696.215139635, 46939051.384595305, 43277178.149651706, 39119117.97530481, 44994067.29957663, 53576592.407404594, 43937142.8046352, 47060790.93673328, 45058895.87108472, 44156055.51751252, 53706860.79216812, 52856059.2504429, 42265537.06322349, 45694178.29507307, 55834234.875671506, 41283514.33360761, 42959263.84931096, 46377162.35149184, 50125758.812262975, 41120467.24994921, 42703285.80138374, 34085714.28571428, 42469076.321795985, 42576322.801640205, 44449538.709721915, 41181280.6896897, 41798808.60767026, 38847631.81581928, 45689228.33592507, 45385565.59317115, 45539753.20726514, 41264420.92679645, 37182242.22278282, 45468188.16718111, 45348121.38234582, 42820388.40674225, 44722371.87770481, 40750960.59621178, 55833997.137512214, 46785058.18861367, 46624524.35422279, 55834050.8417178, 47284894.2652182, 47107317.92832758, 44567615.928464465, 39817008.831295, 44719938.99355921, 47644430.636109866, 44071701.83012925, 40270719.440111294, 47330126.30188393, 47090572.63902426, 42015302.233303204, 44638353.77675163, 41726176.004317656, 43923788.316866726, 41551014.39942096, 47680510.821690425, 43918462.22115898, 44600788.467022374, 49235676.408367634, 52368830.705609694, 41602390.57103869, 45089024.01705114, 47572312.68082126, 44206097.1255634, 39710692.72205654, 55834019.92946392, 51751268.47530471, 47135587.2193427, 37428755.2231113, 42925201.61251747, 41339735.86837273, 48578258.90187641, 48400733.8534189, 42378087.28247433, 43679240.082356654, 42047316.474051364, 44521166.72231016, 42940011.25364829, 43341991.45747502, 41306205.26283922, 41212526.01752911, 52895600.61520177, 55833993.57420457, 40594017.272266634, 39291779.54030367, 47558319.43038928, 55196071.931918636, 43541247.62388009, 40818149.93507544, 35257200.754268415, 42153357.7366877, 45161752.96180237, 47026864.75420895, 43838294.59439796, 44908489.38397614, 47511444.2434489, 34085970.15368497, 35335119.96356441, 39654095.44997958, 47128139.901505016, 41059171.24456554, 41751642.95299072, 42395423.84302416, 38861847.796066605, 41765439.78781096, 41427468.905269004, 41760461.884248026, 42731671.82586714, 54454760.42710125, 43593378.90572398, 45813047.410168834, 49797739.147134945, 35989949.77807308, 35689518.65625551, 38112866.131430134, 43016520.27822927, 38171105.82478172, 43836246.365483135, 43191921.623639, 48177315.494332634, 42545631.647997946, 43672080.6966364, 49999773.833752386, 44052009.320033774, 44149686.699301645, 35257409.6856194, 40934400.747655496, 43838314.51120146, 43037985.900243424, 43726947.04958269, 44573875.686909266, 48082958.26197105, 44394794.553041145, 46493291.41532888, 49537446.362890415, 42169973.02594128, 42564551.764598005, 54484679.35618494, 44297145.150406905, 40613074.116981834, 40198899.30507828, 40437982.48976828, 43744938.62302086, 46851697.564315304, 48093813.18775017, 42719022.31587652, 42604174.5850588, 38602702.37957349, 39908956.04590535, 44329974.910179645, 49483754.0374739, 44977707.80521754, 43143550.131990656, 44571001.4605679, 45890279.90391474, 43024297.4550739, 45627689.44455579, 46069326.271510534, 42829113.772250846, 45268006.527338795, 43053635.34126437, 42956481.55564754, 48571947.99181978, 45547310.709500484, 37584685.210526355, 48767629.94190673, 55833888.57753295, 55215753.26099829, 43778241.770713486, 43772100.09637748, 44279702.085608944, 39107508.56849091, 55834285.71428572, 42549124.63402491, 36767980.290940545, 48471621.9479022, 45190119.91553579, 46517811.83956062, 47031300.80009363, 45002695.50145964, 37653464.63667811, 35008830.59434908, 45036511.72027303, 34590431.738939896, 43756271.16225556, 35533270.87806446, 44196214.470992066, 43433140.06383036, 42649863.19578059, 34085714.28571428, 41071077.024564624, 46353375.45635561, 40697377.28392069, 45127118.2105728, 45577401.97456725, 40888692.5508133, 43771528.189849675, 42938570.52149249, 43829672.27021538, 42745635.180236, 42453327.400746614, 55833470.50361393, 41664380.48732209, 47352392.539777525, 51254557.18619154, 44076685.6745533, 43592160.8810705, 46303905.46530756, 41135719.81799381, 50351760.99850864, 45285406.38750752, 45915147.62212691, 44036248.29737844, 42937609.24422407, 47450968.70236184, 41478103.43948988, 43663211.26044101, 55511371.34718587, 55833558.170280956, 43919262.188872054, 44636382.97078937, 44230952.30398081, 43972695.59483275, 43115663.41206614, 40764899.1571992, 48328352.79517432, 48853336.02085991, 48176053.98632434, 42904113.17761274, 38894429.39279392, 45371237.33793074, 55834188.47614979, 53691053.743197516, 46808053.64015141, 45818512.689844444, 45290485.37036885, 43746066.34898477, 44952019.13480405, 40269532.21067288, 46241097.919394165, 46914544.10942804, 42276010.56441654, 52110752.14441525, 42569750.07619764, 43529356.77052611, 44382357.95464303, 36593082.105490334, 46048382.988087066, 34085920.72923844, 44651852.89635573, 49772779.64362983, 43639771.32954339, 48030222.12926763, 46513710.51638282, 42545492.931005344, 42024981.706144504, 46048240.94111586, 40639246.77054995, 39503238.02581823, 37594536.20854759, 42110453.75316749, 38084385.873474486, 55401706.53186545, 44973518.42013252, 46931613.34433815, 43473052.82646295, 45867330.63415466, 44446881.72366483, 34731362.06097446, 44459172.63448856, 42490171.51731428, 44675559.12800613, 43620148.19739111, 43856792.90064484, 42376408.16909533, 39448547.42931012, 36210739.8425773, 42835208.214218065, 41914303.555320665, 48670643.34533929, 44177617.144628756, 40788204.21585215, 41024277.053022645, 43162382.570931636, 40959262.81099939, 42236998.11340132, 39204070.6232318, 42902639.33244159, 45105636.798082165, 42748097.22363375, 55834285.71428572, 42592249.777056165, 55834285.71428572, 53876823.60478291, 42365076.94708074, 42280429.43032275, 48770653.47701519, 46370781.86830418, 38036298.61310204, 45557171.51920858, 34085714.28571428, 43883821.206670016, 42509164.4207475, 36407624.18777376, 43433243.610113434, 47427139.78779329, 44252613.444387294, 43998742.1917889, 50553842.9464, 44757344.80981692, 46479198.69612558, 40838695.58529604, 43759547.788499415, 44851118.047070675, 44240435.8462006, 43123824.08609845, 41825659.9745603, 47417454.4216705, 47735639.13088721, 39875657.035745874, 45304366.987524316, 51023496.63522618, 42391253.39684378, 42326935.54144578, 52065205.893080845, 43102538.05015762, 41441725.02045325, 42620364.000668995, 41776433.31464348, 50909761.73544322, 42764034.05834274, 44920186.03299091, 45552787.21130551, 41009667.68530155, 37308623.86436643, 35277403.62757066, 38414746.37112752, 44252636.562487155, 42692116.11251244, 41341322.78305979, 43466465.33302118, 43434130.15149688, 41158975.701910295]  # Truncate for embedding
baseline = 43408000.0
mean = 44138120.21792799
std = 4520542.14385555
p5 = 36240694.47216533
p50 = 43922154.122550264
p95 = 53407026.02018936
display_name = "Patients Fundable Annually"
units = "patients/year"

# Create figure with two subplots

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
# Handle edge case where all samples are identical (zero variance)

if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax1.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key statistics with formatted values in legend (use format_parameter_value for full units)

ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {format_parameter_value(p50, units)}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {format_parameter_value(p5, units)}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {format_parameter_value(p95, units)}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {format_parameter_value(baseline, units)}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---

sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax2.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key percentiles

ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"

exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title

fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark

add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from

output_path = get_figure_output_path('mc-distribution-dih_patients_fundable_annually.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 4.341e+07 |
| Mean (expected value) | 4.414e+07 |
| Median (50th percentile) | 4.392e+07 |
| Standard Deviation | 4.521e+06 |
| 90% Confidence Interval | [3.624e+07, 5.341e+07] |

*The histogram shows the distribution of Patients Fundable Annually across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
