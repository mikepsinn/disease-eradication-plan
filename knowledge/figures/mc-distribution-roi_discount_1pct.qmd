```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: 1% treaty ROI at 1% Discount Rate (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata
)

setup_chart_style()

# Simulation results
samples = [412.88377275912507, 412.5050815980036, 372.458439300222, 380.215074136139, 542.1634879792316, 467.11005046209084, 401.7471086448389, 399.1951554955979, 402.8467832244754, 535.8837222796336, 467.72133763495515, 373.93854542289847, 451.39848884133016, 447.86998885048064, 412.83472202890897, 543.402106445817, 405.34356243793667, 454.2600315990469, 383.9064524944564, 474.6182405237212, 466.055612482533, 530.046503598868, 346.7627671585301, 502.4211473055165, 457.0453237377615, 503.0044426255358, 439.7689509958608, 356.8126420537648, 463.6187109848902, 416.4590905268263, 412.83916384335924, 447.29622424745895, 569.0247103421829, 453.2594258777727, 342.98087345945197, 436.1474413244897, 394.80897777264715, 425.985739713338, 573.45535926193, 403.3545618708383, 423.21349087129755, 461.16451152664195, 537.3548735314386, 425.88008219726277, 328.879331044663, 380.4138403241635, 367.6470515127659, 498.21379536971165, 483.6400955204409, 372.2697883785384, 417.4002039363795, 495.95249897172624, 546.3855249469055, 504.34896113469966, 512.5737342982274, 518.6277611874517, 447.74717163127116, 291.56357482308806, 533.3659739688189, 430.9518471317668, 499.3753752912963, 593.0886081394545, 289.45189116602404, 275.09014108458337, 332.65577668464255, 377.5316712238975, 473.95711066957034, 466.4250716425954, 402.61658317790886, 432.68160892330684, 641.0277580273821, 479.07976986458874, 486.9060214423908, 365.03156460828103, 437.73764661688335, 469.12404503801406, 566.6329749890383, 470.4922923071778, 422.05260124821814, 442.83808473578404, 453.81473315660224, 449.6008585605856, 500.1631728666649, 472.3403140382168, 547.9855831215252, 483.1056319742226, 408.87626467103115, 459.2619320719068, 518.3285182948966, 389.63348541907015, 410.6007146566805, 452.3460209590238, 451.2918059951371, 350.41305068634335, 476.19493810635055, 566.5487093824377, 735.7094409486906, 431.9534898072167, 405.4446811125576, 597.1171536613313, 454.08929923593354, 372.6833703282792, 430.6012095778877, 400.61331551487683, 606.835446805874, 327.38415759955154, 458.729421068923, 439.25612478393913, 425.34734084587006, 476.64591546661, 408.1491741983887, 392.815652919507, 490.70530578035084, 516.4795247915987, 387.8199942056871, 534.014508719957, 503.9421576830141, 475.6697484384856, 425.44240133820836, 426.17274988593425, 548.0056444687478, 401.4829930811948, 475.46007422179224, 377.18377275661413, 427.26640999877105, 369.541917989079, 412.3606256567804, 603.2003809798966, 339.63119373657986, 622.8614260873451, 591.505732034906, 453.6858441321953, 415.5188475570551, 539.8988126107987, 542.4056292101461, 566.6236814469326, 432.85427860589795, 359.9215888145059, 315.4425249415674, 333.1712221042654, 404.56950646199454, 515.6331245711837, 599.1274696243387, 401.5341621369953, 494.0357148299715, 518.4572551141689, 576.7607718693077, 459.44678839448454, 442.1132555651692, 347.15462301670823, 537.1717336255645, 585.1492363305866, 669.5944042039062, 443.0229639180152, 440.10747607702586, 412.7108109800023, 540.0186815728439, 407.3361360073948, 412.55363986756635, 516.5096172887831, 500.67060352241674, 523.4753936876419, 394.43123306998416, 494.5709088428612, 477.19320376124915, 609.4598790742662, 463.8952300160337, 363.8832138529307, 499.67401342710343, 366.3317815134298, 450.813611243155, 483.78941676553274, 419.87531710168525, 453.80928237268563, 620.4495321010496, 421.2169935879996, 321.7663708856856, 407.2407705968832, 528.3552634787897, 369.83829439652163, 448.09885654943344, 511.79114384781803, 464.293465083548, 355.52435932832424, 373.11043151506425, 441.32138102102994, 387.98048312075423, 450.0288130146539, 551.1191382374617, 437.8040788942863, 419.82771390561027, 391.8482409417388, 454.8861518318022, 277.21605758651043, 445.2710302487833, 527.3156722833762, 420.19386990147126, 346.7453949690392, 458.09999035247927, 408.113856933231, 359.7269683497772, 369.19826829813087, 428.0429731662254, 499.22574370869825, 562.6756998776034, 401.1753079109363, 564.3076092851163, 521.7569426021875, 545.0192964515035, 439.46823167561223, 421.72539817325264, 437.9197386854899, 477.8483320327439, 460.65295155994875, 380.40842132329755, 396.04392001598063, 312.944222361804, 361.6249639507795, 482.74173273027503, 597.9238688139774, 421.3950599378293, 460.8983591264216, 402.5263103436766, 644.4380488327896, 446.17104516010073, 488.68321636121595, 258.1620662667593, 289.13256259644686, 497.77249306891736, 416.22173627049665, 571.581864155348, 466.8651154851745, 462.1454136649913, 366.19942520276453, 497.05921408414696, 469.4047145270663, 564.6645028031043, 447.7651557841617, 555.2328542988269, 389.31921399661945, 491.30485092833976, 451.72708476155, 677.4330318804915, 604.8487932311778, 320.2675731807319, 655.6052564610834, 529.5145731438621, 387.32377030757397, 355.1524180955608, 644.3792372149691, 480.5219002134902, 499.03212772007555, 317.2280483460483, 595.4677426503897, 489.1439162019148, 416.5790068613652, 397.14160621255223, 557.4168326763197, 479.8669106477799, 557.9422245689741, 459.59893298678116, 467.784640579066, 388.5219637585229, 483.893532365957, 426.87663070832673, 331.4640078961761, 429.22163322972943, 439.1336958576455, 507.28586722531355, 449.1731347600895, 507.45746346422914, 446.89995456015464, 519.1031898771346, 357.95247782407125, 423.3278273614721, 417.9855260014357, 567.1639121469957, 579.1797245940521, 431.49111438139977, 410.38752461468914, 442.62016300706694, 555.4928773457361, 336.5102942509866, 420.0436260034142, 541.030676733291, 432.6905913109195, 433.6310802767467, 530.9720866525033, 398.46870714833733, 503.99957979526926, 567.75705155154, 389.6558544565263, 320.71722583154866, 656.0563873401135, 407.6373892827827, 392.8703002088298, 402.9589851082941, 559.3494007537814, 513.60297609982, 357.34033819914987, 340.9394093920321, 652.5829331349639, 416.9270840661475, 478.6153264428294, 565.1045763228284, 487.6024087204121, 493.6163780178729, 334.6697193148168, 422.8625066613141, 386.0746320734059, 383.1423309460793, 431.74843378335, 316.9013003352691, 374.0821008012286, 350.4487192571315, 571.6277524118494, 419.23780718062085, 479.4737247936671, 433.01664175038115, 495.7604628363508, 381.3893864296577, 445.3564286374311, 384.65738195004343, 442.40230719469326, 301.82519397465614, 483.2042254588878, 579.6786759002431, 417.7937598637664, 611.4555308066521, 545.7421716416735, 406.2183358477066, 535.8162141314834, 560.9255158373654, 531.3690697441654, 501.4976590337949, 609.661579420519, 376.4439225961783, 336.7083811065291, 335.04482439300546, 454.5887112855362, 536.9961806873102, 325.89041707469727, 417.6321567991761, 431.48560981497747, 392.01438950860677, 504.58515769098415, 505.69553575341484, 426.62695152917934, 678.0811011644738, 373.07403182909763, 594.5116672683404, 390.0369306684816, 475.60122063248696, 436.42640569878944, 456.09633094052754, 388.65613161930827, 387.29388962957603, 437.15405582545037, 543.2292360899804, 380.59722091923277, 467.1823704139082, 512.9083269418126, 397.3105902124048, 552.4757443712155, 584.2831843655903, 390.9923793832308, 544.2729655038415, 593.2072618357645, 471.7578461381544, 392.1381504754806, 491.8631063748416, 388.41548164274633, 415.4056336265705, 524.3224841906756, 467.1941989530405, 363.24478914394524, 509.0141523792285, 483.1127924374649, 396.2756970816582, 478.5069998026378, 417.6425000340294, 369.61028622219567, 546.2889473023323, 656.7300238498439, 501.7646537191262, 372.49978466512266, 468.9035537830007, 428.75128773844466, 422.8468207346147, 385.76596520754975, 619.175773147287, 468.42116753635594, 526.5055209733817, 431.42970665913003, 440.912429799592, 492.81384514195753, 374.3530681410534, 377.05542431693397, 466.39480291109857, 521.9225080102991, 482.5643346432762, 333.40548575167765, 437.9754751903503, 420.92080306385196, 468.4672157173033, 571.9482446954411, 501.14661289704395, 395.53193420771925, 543.2625899828616, 479.4020127781642, 492.10396443451697, 549.781547895815, 574.9890825740507, 365.3863588204307, 514.2612027820462, 474.45191685424925, 335.78394528113165, 385.80549923513075, 483.7279244706311, 361.03572098410217, 535.3663083998237, 543.7050767944289, 501.5603800406093, 564.4184911513386, 582.6741132578679, 425.96009254657986, 397.99079222365066, 367.9566828538319, 558.1041075878728, 354.9508795070575, 548.1832523884514, 262.5259060439896, 473.4977449610555, 449.0127694780056, 419.0873342781039, 488.7434434569734, 556.4351490086847, 489.879832044053, 554.8721047013198, 464.4630687949927, 404.8955547723135, 406.0015383036278, 404.77254719155343, 372.7915518808477, 404.760458342217, 589.2082672253583, 354.2115952237234, 393.0324723145881, 371.6898470613968, 476.80544854572014, 406.35984761730236, 470.5572959333185, 432.16895444644973, 367.18840479509805, 444.76172267819805, 450.37737240240324, 417.4206048909844, 409.07745394720797, 544.2825776232371, 468.4407656009721, 475.13733552110915, 506.45926234534016, 512.2825242868504, 548.4199539300073, 535.7129530857902, 505.3980665205917, 532.8918911340459, 312.99707557927053, 400.51768021560355, 573.0687543594948, 522.4633550308293, 382.63757345361455, 443.73830317870113, 468.99766792071784, 438.2993511360464, 611.2989343611042, 432.5868323625025, 525.2667141581802, 501.9898503197801, 274.4221942102885, 496.24954136371736, 408.3327680259447, 387.9900087523981, 411.3982868809362, 457.92391853277877, 562.5844157828404, 493.0129716727217, 415.3763174903272, 553.7353477113605, 398.72196230816985, 373.25801350661084, 519.7331333499028, 424.08269966597385, 484.2317773689913, 483.58404216940136, 371.20125332179873, 547.2252092468137, 492.88753763903395, 622.5816733774775, 590.4018315763515, 363.4446397391176, 385.417964775519, 515.6468003884335, 450.79084535269186, 606.2567327688091, 387.4571956816704, 301.03411313752355, 507.64989642022886, 435.6253598674549, 414.165117418344, 494.54872807291366, 434.67522790007484, 493.9098207488306, 453.780079494594, 361.32902626769715, 453.9575867091308, 462.4917971523367, 423.5821461348652, 400.741823563363, 442.7003094203251, 515.5497295655052, 422.90071742094483, 331.3491131869661, 496.0266059890033, 298.0484812598608, 573.0410152191598, 421.3848887567427, 483.68040186422974, 399.54889402816053, 363.7285323474634, 586.7493169901647, 553.9357098957852, 405.4634650224665, 375.1308881946156, 572.9365130076087, 405.29314269024377, 541.8822215996304, 310.7852767398791, 591.1419382692432, 517.7218754685099, 557.5520040235914, 383.67394363275434, 442.50949645943524, 446.04022492744195, 417.26829017757774, 443.5911271068177, 365.3226960831148, 419.94117670071756, 411.5451479940381, 385.835376543437, 420.6365255074783, 560.2373063783344, 363.24118123413837, 374.6553102465164, 403.48604247473, 468.30786495740637, 466.6842461577676, 585.1271825220696, 520.9678800386606, 602.0338327236849, 480.0311419443398, 428.41519502235525, 392.6041567968475, 567.468869287132, 382.4927449276991, 438.27020651067266, 566.1876234444252, 583.9529689349947, 454.5221843368593, 423.0696572246517, 508.02859056942594, 342.3009704987616, 427.3382167064852, 397.5017383946264, 456.2695790662093, 505.8433138133077, 378.0638985908949, 370.4037404944385, 484.69137687080473, 427.847432440282, 724.3765578262557, 642.0113785721792, 403.8915702553939, 537.9058995850406, 437.4151569708012, 267.3455455954889, 491.5382223394897, 492.50782941384165, 477.30402326845734, 385.1738328287981, 601.6443313905478, 571.3004418689807, 381.2848869830108, 599.6057059954085, 589.7431737101731, 430.14604723792905, 561.1961014705206, 447.87068308854793, 442.7233217358468, 578.645520103777, 435.1737899686502, 542.8580303787538, 457.36237677611854, 625.0932332134305, 450.59897385368765, 424.33493083721055, 377.06938145992723, 376.34791529838503, 477.6836995617328, 309.49513361354303, 450.571622145677, 301.03222672428393, 449.6844391929969, 482.32219259707165, 462.3883036788515, 436.632920160319, 446.52603617150106, 480.1850262750959, 543.8621082103256, 399.99061383011815, 599.3871055418581, 398.9919719544933, 421.20827137176474, 536.4016350930349, 468.5103291333256, 355.8374994668758, 538.2874022124329, 365.4927092180328, 566.5097361629449, 577.5905697483965, 398.9464403166035, 293.43226105151734, 464.52990697691183, 597.925679279641, 431.70899632117585, 470.27738489886593, 491.52603189431915, 425.64849520670094, 371.95541905611867, 450.3437593686444, 583.167523534886, 322.03369537408287, 326.11607311284104, 343.012826250356, 494.45595948007656, 380.15564634011173, 389.3157861894276, 483.9786723390015, 382.11782050717534, 464.9356865298743, 342.8431725616229, 362.9510197531694, 377.2149951017974, 501.03419348957596, 360.4680670011613, 489.16813861459684, 470.14926761659376, 483.19342439772964, 355.0112145266531, 375.2389690777518, 576.6438460336242, 421.29995356424985, 463.7200712584656, 402.4947346678562, 493.13744608549337, 502.77131129134057, 575.5323384104279, 454.1065462704243, 496.5606046858301, 790.7670181591496, 393.5896197727603, 375.83137398796777, 528.1279132877995, 553.6147474619086, 326.04413023389867, 431.8487897502333, 331.3791796282812, 441.8760642620413, 439.93980787691066, 417.74842381052457, 353.7180982592544, 450.37892983084294, 299.8411238877177, 607.8084970762503, 439.97484859732407, 423.3384688089584, 449.66882189247025, 401.255298741322, 467.50464804190403, 476.01205117777334, 426.9207445197719, 396.7685901685224, 482.97283859644966, 651.2059856558542, 552.185200534368, 559.0521536264098, 544.1517502838818, 392.1272133058919, 398.1305840353201, 468.0081449082303, 295.0850136383879, 487.17287448142633, 434.6601290189472, 457.57398382914135, 376.3811766003339, 455.39749120194637, 524.5702577547795, 488.922401506896, 550.923348092352, 370.40308562552667, 448.7838364382398, 405.17768922768573, 578.4906269250852, 369.9358383980311, 518.2288203338026, 483.0318537003294, 560.095669315215, 421.19544194143685, 450.3554465289788, 493.89278474024366, 401.533180330136, 421.1112874863638, 457.3837893238653, 411.52277762375763, 564.9781824470247, 381.0094481673484, 394.23145828716434, 395.2307058151516, 529.607408547398, 484.7671309580787, 444.0226877963956, 415.5224163242498, 380.82566992451143, 460.2485936735008, 382.1923667413325, 276.3254521382658, 434.49801566965056, 433.9573041663695, 587.0255029368645, 508.23687051103013, 529.0636574050565, 455.00954506740646, 584.4677372073936, 559.017842390169, 457.78808366187224, 464.6879772190243, 362.2693439414684, 356.17100171485146, 414.0805726850458, 547.336947980228, 441.0895132920951, 458.5481399865945, 518.3378069235101, 254.586521518174, 357.8962096001512, 360.30314064847755, 372.628479101217, 362.2324218272853, 367.52250015663117, 433.6818265598247, 361.8588595410281, 351.26920154610275, 275.7079613819943, 381.2019990035048, 362.1868477982948, 577.2931295525616, 466.20150504480927, 484.78279154275384, 525.8798387717202, 329.0709814373793, 325.82822426768934, 348.9456117604841, 412.28904162636945, 378.8231916435791, 500.0260760923626, 414.02910230178054, 563.3728584848535, 507.5548197084818, 393.4962229106033, 442.8731145002468, 456.13988464125305, 431.8281593372891, 386.9870681702337, 432.31138864621704, 486.6077894706507, 449.40843464471317, 481.27141256915667, 398.19343020292627, 517.4849184226654, 458.8672975672916, 492.9780490159215, 424.58033130706315, 382.94334565366324, 420.4052978865894, 548.3891439381749, 422.0535437620736, 372.56780640476484, 343.9223249221405, 401.58362038589263, 470.0797759140841, 530.9048874513904, 422.46669860111393, 502.94368710978955, 501.9973443218686, 399.8592200722228, 399.55118795902865, 507.20643257034425, 454.81048252675134, 527.7896358822544, 469.73580838468024, 502.135503695284, 452.8635402260424, 467.9624429395629, 420.2493536457353, 544.622312588653, 315.67809175238045, 486.2320804685956, 508.7501438082374, 387.13351432292194, 604.4542197608323, 487.89768634692757, 389.033213908955, 614.0122493131497, 428.4012284300312, 591.3430116288349, 425.329906379308, 478.2855244416595, 378.56846757947244, 362.6028801828793, 574.016923995026, 372.89576092539215, 360.5324483604462, 511.0138552840833, 514.1597764868927, 487.3796076327631, 455.0883288804984, 437.9112296559942, 320.8969907734856, 315.1940698997677, 477.94206469479786, 339.23928238894706, 440.91834949023644, 423.43533686634817, 452.84782674095146, 423.52249223183713, 373.60510009298014, 373.3906516261323, 480.9311815847304, 480.4032468907274, 409.0879286132299, 494.2247270913208, 411.42846359164616, 454.0845510076605, 383.00573445231834, 429.4037961648029, 425.91882925171404, 373.8866074374163, 463.17973203303893, 626.2970985435393, 324.96729609081973, 471.0512354968203, 579.884823684273, 503.8298958602755, 441.99333622058646, 445.7608570267591, 480.6533744315814, 700.9081771318502, 515.7511764018099, 467.795115749247, 524.6102383596661, 490.11490975373704, 565.0010757117586, 422.31316879061325, 462.96064835912654, 645.2436867164314, 524.6792065160708, 568.2920339040784, 562.1830438842766, 317.59048366290784, 390.12491505442233, 439.84415776335123, 442.5048267936483, 441.3085143355611, 581.8823691754237, 477.5449503785695, 444.3034009190723, 379.7312510913462, 431.7380108689755, 599.3581933990291, 540.0801947672583, 440.386095357269, 349.0055140930587, 507.4847349060223, 448.4526310293638, 481.2343654132331, 325.22819378444996, 489.6634673589782, 507.57148226826234, 389.79697364728077, 650.3380200209787, 449.21390318020826, 432.58491839349153, 473.7823451358811, 289.478172205604, 342.95218328000203, 276.77404820376245, 493.6941104653153, 573.0187322657843, 558.8549973566346, 474.27368141249707, 523.1660322765568, 480.3707354691305, 403.6173664046054, 455.49162562179976, 375.87853720022724, 325.31094109769333, 463.29032538495085, 396.79209252467217, 413.83896284901203, 706.3064824862956, 562.2570721059942, 450.457128825339, 432.56392268550775, 499.59091868418494, 533.1171678240512, 350.2512612224994, 436.2793673369233, 408.77575341321153, 303.0853680588727, 464.44666229019674, 488.65370007190705, 415.5792328271805, 430.8503336965826, 339.7990708366512, 473.02245426363726, 409.2458130895596, 483.5666933568023, 414.51441093450876, 429.2253211479807, 404.3298608515494, 427.1427286892192, 423.1992808758316, 402.26922495061274, 383.3992624915319, 507.10719227800405, 410.16917911226244, 379.4170339451214, 676.3057729366784, 473.6260792854986, 548.8190009285361, 524.639888943912, 384.3014476589477, 471.49865167241694, 492.8739698330178, 454.1329032771324, 417.7368847657385, 390.4909036546122, 329.6036813811961, 360.7104049082358, 383.64623642296436, 324.97441036708545, 321.4554501643087, 545.5225692313214, 462.1406169572242, 386.4882152705153, 586.7575895179781, 414.3421754732846, 550.40726497995, 339.591966299265, 482.0497892498125, 391.88651898100954, 461.8354520813381, 445.10795878741243, 355.73873736634795, 475.84883628106275, 513.5722235965181, 308.31972836231597, 486.2136984989531, 582.8749525239447, 393.90405105279314, 380.2227092771104, 606.8521886924947, 447.10701829461584, 391.2301957647001, 298.08557301024103, 398.80503552565006, 418.5075081802286, 447.4074578637987, 616.2970047652085, 496.2618102740229, 424.060638016961, 359.59099060512415, 328.5706709851872, 363.81478905785514, 443.9265018078532, 493.95551538142905, 367.1347259865681, 493.3810490076086, 412.82772745660895, 430.1950791974297]  # Truncate for embedding
baseline = 441.86105207491374
mean = 450.2956239312539
std = 81.77519726391394
p5 = 324.160037495989
p50 = 445.8280863615081
p95 = 591.8817298617488
display_name = "1% treaty ROI at 1% Discount Rate"
units = ""

# Create figure with two subplots
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
# Handle edge case where all samples are identical (zero variance)
if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Mark key statistics
ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {p50:,.2g}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {p5:,.2g}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {p95:,.2g}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {baseline:,.2g}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---
sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Mark key percentiles
ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"
exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title
fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark
add_watermark(fig)

# Save PNG
project_root = Path.cwd()
while project_root.name != 'decentralized-institutes-of-health' and project_root.parent != project_root:
    project_root = project_root.parent

output_path = project_root / 'knowledge' / 'figures' / 'mc-distribution-roi_discount_1pct.png'
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 441.9 |
| Mean (expected value) | 450.3 |
| Median (50th percentile) | 445.8 |
| Standard Deviation | 81.78 |
| 90% Confidence Interval | [324.2, 591.9] |

*The histogram shows the distribution of 1% treaty ROI at 1% Discount Rate across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
