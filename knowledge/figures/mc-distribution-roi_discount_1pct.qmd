```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: 1% treaty ROI at 1% Discount Rate (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)

setup_chart_style()

# Simulation results
samples = [493.97123477414794, 451.8154224290456, 458.92449790652864, 474.41109452248827, 559.8463551619171, 502.96337870901215, 475.0723235471778, 458.45620406847263, 471.854028024943, 594.159801046672, 581.2392805689219, 461.582095575847, 531.6156658962232, 565.7750396946481, 499.24986956696, 602.2497780496252, 487.0042406615497, 500.1895456612858, 477.0522567412041, 554.7085302489463, 539.8852495978795, 594.3427715976957, 440.82349139726523, 583.1741269661336, 521.0446383443976, 576.3156053169364, 534.1035295497562, 428.6026861492752, 558.6394318362519, 502.4140120170917, 558.1682003007456, 510.6644783618233, 645.1421905675046, 503.84223038655125, 418.86314957769554, 551.0295953744275, 459.49110782453727, 472.7087260688401, 637.005592311491, 493.7224761790214, 521.2141787298119, 560.4901313669205, 603.146429335178, 507.08651708459854, 388.6191504538919, 452.54844303101646, 456.6357158008775, 592.8776597885842, 593.104688312915, 438.469889811686, 498.8609063034729, 606.2919457767888, 582.4328581756623, 579.0897584603468, 582.7383720725662, 583.142818557722, 515.6066290404799, 377.39916477613303, 590.8742259933939, 538.7046911325062, 524.5875273861942, 680.2996269892302, 343.0702418350672, 335.2919569090884, 408.8198723792065, 466.49708530774905, 543.1563213593868, 530.5517316411269, 499.6247123238954, 501.0120068670859, 691.4201729526949, 521.5527598906073, 537.518521830055, 442.3059741772316, 518.1296882796453, 575.743472760092, 646.0232636337752, 557.4918376513968, 515.7565219257234, 508.80848895447457, 548.4189129694366, 504.76663137821106, 572.6493303162741, 540.1310535286015, 594.1422878356851, 584.9815786268919, 464.87567318665435, 538.9720291774461, 627.374099855246, 470.53969604800284, 503.08379114807485, 526.9905560820184, 514.65535400131, 408.74160395272725, 500.09023804798034, 604.3198811234563, 791.123458085181, 474.4381368451198, 488.12452709632026, 659.7877144155581, 519.3825697602589, 476.18733477173873, 493.2260159387257, 493.1934328454003, 669.2948054913475, 378.7334456920777, 505.40311053477245, 503.70948394407174, 527.2157301681917, 499.25367560523244, 492.50613670022744, 467.88941565183984, 553.3663732835417, 550.9503332122637, 456.9223599860082, 604.7641373921409, 600.0537806288042, 558.5718436345526, 554.6028662667268, 491.9183618609126, 600.8745565495361, 476.37284076422804, 565.6662823927512, 483.8552587035073, 529.4123668786191, 443.64191723841924, 532.6411014294289, 654.3091675582534, 381.8579933606444, 687.286267933155, 676.0407695008561, 486.1497405775481, 508.0931431068383, 623.8913776914707, 577.678719503315, 621.6097972127021, 518.164544708582, 446.0564850319954, 422.3466053526449, 473.70103498392695, 487.54181088811373, 566.6330297888338, 611.5202528185459, 479.2209845057671, 549.1989334561295, 591.5594636249042, 649.6462515045529, 533.7748889289562, 556.2423285354532, 411.30714415681194, 623.3417067678213, 641.0930261170586, 703.7785726811102, 503.140676212095, 514.2435848512439, 543.980190676614, 638.6831312459359, 509.67179061170935, 468.1376572859603, 560.412476591897, 551.068299390858, 585.2748016620719, 532.8210907127647, 549.4903491839357, 591.4072290963311, 673.5381440142369, 578.4782038235826, 437.65912454382254, 579.9050037516865, 428.4074967478094, 506.3648793431568, 584.2291107568435, 477.8330593718093, 491.08126937340126, 669.1262930325073, 499.567516728448, 418.821785122123, 482.5905668477892, 614.7266701989638, 441.9206666886234, 572.8045805738736, 608.8655620208701, 529.9127031701549, 448.4961796098062, 450.0570561635124, 572.7918572928947, 460.4718665640397, 487.0263275786601, 590.8820747056992, 572.5786944247179, 551.720603721379, 454.081973594544, 520.1223439158895, 358.0324587627738, 485.5762363093592, 583.0696145491232, 514.0874891831703, 396.17574374771243, 536.9849612184664, 473.43133404207225, 431.30914674021295, 475.1287722519434, 504.9260983639015, 610.8039898218046, 577.3510945143104, 468.9096215579697, 626.0762064464064, 564.8591888287533, 603.2980659460445, 504.11528563847094, 525.3473100141795, 470.791080249245, 561.4547643710916, 523.2364390006784, 436.55256847272386, 496.19959708815605, 380.2195421374365, 463.22726180902384, 560.3325634816919, 669.7951204584988, 486.89949795876464, 549.1563485916726, 477.52566697989624, 703.8101171194833, 526.306952175257, 581.7139539229184, 357.70883707514145, 383.9109713612698, 551.8968724816716, 478.9178020766145, 609.0431275781526, 526.6007042449123, 553.3049614821532, 465.0182739020367, 555.5997283959798, 527.2690076985248, 575.7788851917144, 519.4552639837211, 607.2557637949965, 440.90023303228475, 543.8858503027636, 526.4157887240633, 708.1591518095549, 644.3397615255261, 432.65840805890133, 706.6042115483185, 577.8316178818664, 512.9034843012621, 504.66543518350534, 699.7601119568911, 549.9738573542527, 598.4919317495293, 417.0272650677367, 654.478381918237, 564.3842842723893, 514.2011568703759, 479.23434345632654, 637.6515351185307, 557.7541980095916, 597.9357930101622, 530.5424234211695, 538.9910101703016, 462.60524730844975, 547.0752606564927, 516.3684574490832, 415.56185357440165, 508.4854545565212, 527.0101684792579, 596.9280233096276, 526.7014837881147, 567.5020929269537, 535.0836939339546, 604.811481355707, 482.46734346045037, 550.8081961224602, 502.7601982658197, 632.5530803710072, 631.3853143883073, 547.3954441989121, 489.6269165247724, 535.7169270501992, 581.1833502463271, 419.5141630406628, 507.52878946112514, 589.8737555093934, 491.88308380765494, 517.3914811429539, 624.7714727037618, 458.3463616432774, 586.9744894864339, 654.8012592424604, 461.5258645643563, 414.49123958192285, 656.0563873401135, 470.60106782520256, 466.0686604368673, 481.8198408938691, 640.0405401196754, 536.9333082482121, 428.176790936957, 448.1581601609971, 692.1859223514966, 517.5835985921462, 549.22299588917, 659.9686529086068, 533.6196513297945, 566.2164043639697, 427.6394122054473, 515.2819240025059, 507.65435106442413, 485.61780410342107, 521.1433954780254, 417.0203903526205, 451.5342659584422, 434.0254195369536, 657.3358179027232, 493.7565303694299, 537.0550248214614, 542.0495337220183, 538.132256418862, 470.9212197544195, 515.7106314437532, 487.33910386861345, 545.1208645973951, 399.2450864466342, 594.6056535952785, 613.3386853634222, 487.7479892177976, 663.987744598602, 618.5002275221677, 526.3756027197912, 655.2950168212008, 628.2266113219938, 583.0048264538341, 589.3253748600948, 660.1223861788288, 422.3784103162992, 403.02945358244096, 424.03517538229414, 554.898697991034, 542.5114159590173, 389.8839825827185, 492.0433889949821, 519.9602556158993, 511.5151796093895, 517.3099216391614, 570.3846734652552, 520.152677678081, 717.0112981213249, 482.2989447644598, 714.2636412882205, 483.6494259744372, 537.1500037516766, 539.9991307481865, 573.9297011505048, 462.7866161961302, 461.2108777089278, 521.8230433789074, 601.8987358615326, 441.97325846207906, 542.3431123239628, 616.8350839583487, 497.6899538284172, 604.3931487140975, 679.512304763114, 505.64765369516994, 607.7967972729897, 659.042535105177, 560.6071276570264, 486.1842317995268, 577.1908946748267, 497.2668920847564, 515.4549043508058, 649.9598914550119, 568.2299453243829, 497.1185370141848, 588.8622800589465, 497.2005673044858, 516.6661356392212, 544.460950249321, 493.2194853544204, 472.5837374993622, 576.8803869365595, 709.4651622159458, 529.8964601398227, 414.6020658144801, 566.0121641682409, 520.4431356176448, 504.94231763594223, 412.4026670674593, 624.7776706039675, 551.2390890771275, 598.5221203436486, 521.4573106083926, 541.530579315649, 583.1599230808997, 461.55440427146436, 448.86465994815296, 566.3568816216525, 584.3242016463279, 559.202297188489, 396.05346986804835, 542.1583775013838, 480.9525230519579, 568.5391543265556, 659.034210654217, 583.1122252426649, 489.90990709380003, 559.4782511127036, 516.3903653359978, 523.7193018237473, 553.9163568906911, 644.8495536177861, 450.180349482439, 591.8222977144264, 563.6406805971163, 423.1150706058062, 493.8837863024718, 564.6407661789034, 462.96856977629363, 631.5905372859141, 603.4485619462653, 565.5983141820933, 600.7439191518088, 644.5587852103854, 487.8537470767103, 492.1105333863243, 483.4610344305816, 597.8263771908607, 427.1378693519812, 600.4013417360811, 317.62896577958514, 550.4503576548581, 467.1616813900998, 522.4893961659515, 550.7621910627242, 629.9730898418464, 535.5231681427985, 623.2665176804475, 560.2173230628908, 468.9014238612804, 486.5056225123003, 486.0989925037531, 477.0021865276382, 464.03774250085297, 627.278756821709, 445.68599142782915, 450.9267537877359, 469.1468809748569, 573.4163166377239, 472.3996617254144, 564.610949708339, 576.7245070027346, 494.4346005446353, 523.9151546468731, 533.7155286021272, 525.5322211258989, 453.78258941423286, 652.3955435701955, 548.3568434501286, 568.7958773273452, 562.2581907636505, 541.4142913999412, 561.8973522458845, 583.8113732583284, 575.0216618289501, 612.9281323564318, 417.2982542370148, 505.2456534372264, 630.8786721898308, 626.847673121959, 436.8266441729, 510.68056492198104, 556.7033045381917, 535.3831518533748, 700.9862669971487, 544.1800245610619, 571.5122559043751, 588.8770526725417, 382.23072758250055, 590.5200921953208, 526.3882075896083, 457.707216736045, 501.2499027312131, 534.955506341103, 652.3255184705539, 549.2626387478633, 501.0905641287209, 614.0132166186166, 488.53595039236876, 470.21307749095394, 624.3472954648062, 487.99926288778374, 585.0682430343549, 555.6490365044409, 463.0103915885016, 569.3254216645557, 565.3376099365315, 641.2570054308959, 627.8080363155755, 466.374931912914, 479.4610834790923, 576.738862680786, 479.1204701397392, 606.2567327688091, 438.38724512898636, 414.48115531345525, 612.5904716511913, 492.3676822979656, 500.7783897953769, 523.6411976525573, 499.8243478368849, 582.9652329059767, 529.0924095575799, 446.4012478052621, 544.5448378010016, 566.7729271836915, 474.7325414272052, 498.61078207780594, 578.1393268852308, 567.2587743100854, 467.8295652161539, 424.3997325474301, 574.3591405174362, 383.4716750587603, 652.6740622429201, 543.9999988028501, 572.0972145363652, 476.5533637187608, 472.9905503476152, 671.8406019944908, 610.6509740256492, 461.626295087942, 453.19933410150475, 606.4516604558047, 495.6652399228002, 613.3009235904087, 393.13686058421416, 593.2668714166863, 576.5234819411917, 585.5630562214706, 426.14391658231517, 527.4260116571479, 516.8907313737951, 481.1964049796143, 514.7308152221278, 434.15732397044184, 460.90471735601096, 505.6252150467774, 472.65537217906115, 505.9218551889211, 681.5034551386445, 434.34124039648395, 503.1681739000005, 470.42047630494994, 538.1525805572137, 520.8136037962479, 641.2106757659459, 563.0641347031622, 665.9457941317678, 560.2687288016225, 513.5544865751936, 461.91970036968064, 632.7905938464756, 475.97953118159876, 539.6203731456653, 656.9683511552466, 655.9906757960448, 552.6097114030493, 502.2741590537094, 541.8626176630263, 399.5878756474035, 509.8265230057416, 439.3876178994129, 541.7563681960552, 539.2975265526431, 484.2460129765722, 471.6701233370318, 558.9807419988526, 513.8620419863369, 726.2478043417545, 697.8800614606058, 464.53502976129016, 587.9326860032618, 537.677405649561, 357.9649909984959, 533.6078231747799, 546.6233215071187, 568.4391763617724, 502.4198039485995, 651.1951315796625, 680.9931898323481, 504.3741698342561, 631.1581239706003, 635.8813995589422, 490.5307011245689, 635.9181735470789, 554.1167563979583, 527.471821901891, 604.2164108519835, 527.9328963471884, 612.8456787319874, 583.4256452515431, 703.372214959239, 506.72664712773866, 515.6592734675121, 464.98934789771823, 454.5424928481504, 501.7108872531303, 376.0269716053517, 493.6923131749246, 358.5064407057678, 480.39254365767795, 582.4668907553348, 514.2310524971231, 470.74473291955854, 548.8557204056676, 572.1040755524043, 612.5147092419063, 516.248146183316, 682.7657463457527, 468.84694615594645, 502.74141222278814, 603.8873277489513, 566.7153249178884, 402.87647856401617, 614.3356249380073, 468.9651468416281, 620.4718403622726, 578.9760841475953, 520.3785833979641, 407.42393757329825, 530.3795455236296, 617.9865604763312, 495.9844077636302, 541.1571994475117, 569.2010019306671, 463.98569549932574, 453.15608232613806, 546.6648685909462, 620.1417240473309, 395.45110445656144, 438.4757154652946, 406.79976570832497, 567.0725771810763, 441.62100324846335, 475.4266493171071, 506.823023997536, 452.95060769957047, 531.3591421108543, 454.3361022109242, 420.74321620371813, 493.89231722567246, 546.5046853396983, 439.38443325256105, 585.804716722331, 520.7319477285599, 573.2539109819045, 451.0099378641216, 430.72998933416926, 605.3957937391052, 493.44345418139665, 512.4922117727539, 461.45369886940847, 575.1526221718086, 527.3663026139754, 607.2345607845805, 549.6890897020016, 562.5979875249841, 790.7670181591496, 486.0656422701042, 448.6832371995935, 590.9154759552558, 595.5404195518298, 404.00964300582297, 518.1851562838194, 455.13796605315815, 532.7027476684354, 529.2320568099948, 484.4967919287989, 437.7496990063732, 550.3534703307006, 381.91153080647973, 688.7037327776229, 501.3507747603224, 481.0123392494663, 555.5398270650505, 519.5019897220619, 531.9022824469049, 542.7938667593884, 511.0805865282777, 457.78518126242636, 603.0848294920683, 659.570321055329, 613.2890993009864, 622.7169501782499, 548.7125146156037, 431.64054294477086, 439.63847744833896, 541.5682182394283, 372.416163392112, 562.1180826924557, 476.36661908915465, 534.5406753441475, 473.0153442464679, 500.88336860280594, 579.4337341136902, 594.8313025176096, 636.6597539999315, 453.29537581144467, 525.7692688786034, 497.6314728313764, 633.8216106264094, 433.44009281238755, 599.3045055010625, 523.0344798120251, 592.9472556892453, 516.7601224702585, 516.0332357947641, 541.5841545393224, 467.8637869225257, 531.9993040551681, 462.39544064413815, 437.55094744426054, 623.5661850461546, 492.0759364974917, 470.9674397400274, 487.526837730956, 576.301830832374, 528.2173700018128, 536.2680743154215, 489.1140663951217, 463.01873518570613, 533.0598309405117, 456.45112702927395, 327.4121900029836, 536.3345968233396, 536.7041812600497, 619.1919466836861, 514.9143438539608, 662.8143236031838, 577.1006217583134, 640.9745168993421, 580.5700543950397, 540.3147281290859, 579.4385862714498, 478.4529388553064, 432.1156614801518, 473.82154591616194, 605.2708969766629, 517.610023482741, 527.2080668694448, 568.6571442410443, 342.2149456618402, 472.2806214044599, 455.4210651469374, 411.3245910159991, 449.4223066864219, 449.53656361121637, 523.5967004003978, 460.84146198581203, 429.53543887816153, 339.4790463056902, 466.18486316799175, 434.35073768259946, 602.4669157925312, 549.6861461553934, 548.0495566840902, 567.0670390441502, 431.25451612422216, 428.3414840594276, 447.6320318051425, 491.65107879672286, 485.6828061956356, 586.7942065374882, 492.0218831582789, 614.9122116245255, 610.9450863874548, 463.25134871009953, 476.8514715803853, 533.0673913565125, 503.70841559335554, 511.09674576699604, 537.762067010532, 571.0246211716996, 535.688470204316, 565.9829651216596, 460.7254142140538, 565.2330420338945, 532.7418488427996, 550.4246702976615, 458.71368269209825, 464.44077462015787, 505.8516689049063, 572.1878666146711, 490.91682972183133, 466.56864591688685, 432.5104696921932, 503.90940132579607, 552.6284373514372, 588.9473709680805, 461.4092799308558, 603.3045103535018, 603.5493405897278, 510.5082364879198, 503.82581512767894, 589.593054847909, 491.5694624347391, 606.0266505882257, 558.754050027209, 581.0222135078958, 511.23679826465315, 557.955397095368, 476.72440872814786, 612.8048929004806, 377.8429706994904, 555.2775682230501, 606.2356214655453, 462.2016481405012, 657.7790960705157, 554.2890779292468, 501.6604321082144, 667.1953078190833, 437.6962848820379, 614.0650900577286, 499.69739222774984, 561.9790308072301, 440.4836787711792, 460.7054430199411, 574.016923995026, 448.8242811222029, 468.7325272593267, 556.5175818699798, 588.0270631439734, 543.9319841802927, 503.218081722352, 502.58875894250025, 413.51641177930725, 417.4009400805454, 548.1833343134089, 451.30269603153994, 518.2321588192738, 557.5792346053363, 527.7553182555188, 500.9283003549623, 448.77465661037354, 540.0878122401457, 596.5446626524372, 537.7496151936787, 511.3983890018622, 565.8956476141209, 467.15332618638126, 565.3842012241979, 450.0315547597798, 512.8502121811679, 499.89095362118184, 448.2570814029977, 558.5615255035304, 647.3045435650138, 398.19369377966535, 517.8957319263762, 618.7382829958066, 588.5206613953701, 521.155282203358, 499.42157340689107, 595.4017773801652, 752.7477623239679, 588.7969727833237, 527.8514633583628, 613.2713189237613, 585.3705081271154, 620.1406351419228, 519.4532798180948, 545.1237200511539, 668.7872662333302, 541.530679369291, 665.8363957202713, 649.6960190248124, 369.8779834904889, 456.61655225893014, 523.4852363310448, 552.3916889190125, 481.1277531346696, 631.8753173036001, 521.2374727000355, 531.0074839139785, 483.4515866206458, 492.0962926872443, 599.3581933990291, 566.5619174711505, 488.9160559759398, 394.51285745446756, 579.3047986321205, 527.191908901682, 552.8375500626707, 408.7335550202321, 549.237797456828, 562.4276561494977, 471.7438705779299, 689.7251932428788, 540.4594214386502, 510.68654064366245, 550.1887635691847, 377.02372688034427, 386.0353481524778, 372.31394208439997, 570.3782050348041, 618.0113719935329, 658.336760736779, 518.2435347239027, 583.9142393579034, 578.2251352436978, 490.95148616365793, 512.7138264667067, 470.4563015222405, 411.7757613478166, 597.3570054220266, 481.815535847281, 531.026063658556, 732.584984809103, 645.6542827667773, 498.9877446439892, 511.2232907263572, 564.2255709153444, 618.3306237796443, 465.23211845089526, 505.8957085474898, 492.5906342765341, 350.0053463631175, 547.3317376603298, 573.2204343700632, 501.9324305312008, 545.6483256282885, 444.2995710253836, 566.1038789746246, 498.9163958598478, 525.8350605640677, 483.25344953988025, 535.553583314881, 502.0161856978458, 507.9009206541217, 526.1550213174863, 487.22072210902405, 486.6806795997019, 606.0848884036586, 469.83989446144756, 454.8653006607645, 676.3057729366784, 569.5742612599756, 548.8190009285361, 549.6628544272063, 464.26104198646743, 570.5709273608619, 535.5523783819706, 508.18238894092775, 536.2803307586735, 443.5463543031461, 448.590373707025, 422.9140421369343, 462.1329036606188, 424.05755609499903, 380.2060321096829, 598.9780114657125, 538.0031906306813, 452.1328404259194, 629.2314688967949, 477.7448956629083, 614.7032096876476, 423.26966692306854, 566.5398765411425, 451.05291640134675, 537.773408262831, 529.6648237244842, 434.4675792533026, 522.5667204595139, 562.4550951965092, 388.9058038392144, 554.8795990865445, 622.9569746839816, 475.6116326009707, 459.6857588796119, 643.811167003913, 532.2668918477445, 481.58036520657265, 358.2712881447187, 487.5534693077723, 447.6517971573368, 536.2058827882418, 708.4209808181109, 563.7340655697043, 526.673737667458, 464.9708864053901, 433.85221623323116, 465.3356056186959, 516.7989132027599, 592.8402759101151, 452.85494582966516, 583.1747174005337, 488.2694365148839, 532.6408348646033]  # Truncate for embedding
baseline = 518.1491766998197
mean = 524.614432917432
std = 75.06808406573516
p5 = 403.54617248933124
p50 = 523.2336602651346
p95 = 651.4536020278682
display_name = "1% treaty ROI at 1% Discount Rate"
units = ""

# Create figure with two subplots
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
# Handle edge case where all samples are identical (zero variance)
if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Mark key statistics
ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {p50:,.2g}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {p5:,.2g}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {p95:,.2g}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {baseline:,.2g}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---
sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Mark key percentiles
ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"
exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title
fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark
add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from
output_path = get_figure_output_path('mc-distribution-roi_discount_1pct.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 518.1 |
| Mean (expected value) | 524.6 |
| Median (50th percentile) | 523.2 |
| Standard Deviation | 75.07 |
| 90% Confidence Interval | [403.5, 651.5] |

*The histogram shows the distribution of 1% treaty ROI at 1% Discount Rate across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
