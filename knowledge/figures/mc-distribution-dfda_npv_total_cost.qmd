```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: dFDA Total NPV Cost (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Simulation results
samples = [637932469.1570287, 476662192.4529716, 702661547.1798607, 732235280.083641, 400200318.89713573, 450342033.39353895, 613934655.2835362, 557595388.1099057, 594984364.4419421, 496364361.01281023, 722586620.015974, 706839759.4113486, 605763701.6181228, 762488163.6530311, 660849483.9151313, 495692808.2946233, 646850185.3749903, 485111584.91957796, 722438137.4761946, 590727675.6882184, 573700804.4343231, 515224952.9352668, 778412434.1677963, 577484968.1393905, 544213966.9221845, 553274995.689847, 670199640.8543942, 646386627.0505931, 653047639.5171162, 655613704.0355532, 914016865.9513863, 546804495.1847295, 534406798.5786339, 500605903.71817625, 682469082.8361608, 762774488.9416428, 582586914.2328076, 497752303.1832564, 499445728.73888993, 687610404.8358521, 701565819.6939042, 671777412.1454414, 516949347.64166534, 627976743.505977, 612451944.0274179, 626145302.013062, 721338949.7610831, 626811717.5003647, 691845916.6041889, 605967052.0059555, 635778971.9292555, 684738217.8944407, 435475043.2806345, 557181209.0648617, 539277827.2437568, 519941212.3364624, 562584411.292526, 825791684.1258085, 494991050.60349715, 736649337.091279, 414697533.49929535, 555347091.3875805, 618598673.0753704, 678079903.3544557, 696710437.4602649, 709228025.8013151, 553683847.034092, 540216014.7142364, 719237640.1245613, 572900345.8884876, 452933985.7216878, 467123887.2395674, 489273621.44651145, 665111633.412509, 615878822.6998305, 693584051.5099555, 544340786.5844393, 618033925.1457312, 683892779.1713666, 558429368.5459803, 659313301.2754064, 517350946.607204, 551967128.7891335, 549736620.0893328, 460836548.6972751, 663644054.6956294, 539391236.4596612, 598774558.1476084, 662748848.0365331, 657850587.8197263, 689819417.0434512, 584542647.8062011, 544807465.0026957, 586925300.8830494, 414296730.9363681, 436423425.59746313, 448344675.8669046, 481096138.85700506, 651215521.9847728, 490757128.0172157, 550162745.4432448, 791468254.2033465, 552779951.9324205, 700693360.352132, 487774300.9793911, 571148113.0781279, 486043751.23125255, 554848069.9491642, 716487298.9370855, 410724365.1891602, 656125989.2818626, 628736063.5284762, 525005115.58116174, 436523132.04250896, 606565065.0955886, 532412840.84356415, 628046842.2760015, 599990382.9380169, 845153991.6273758, 566964846.2575152, 478367787.628041, 620818304.1733614, 626322884.5082479, 801828934.6492119, 715680306.0663308, 645186355.3216712, 820143608.2170141, 461543562.557891, 519842786.4657246, 488519049.545802, 548775789.1640276, 443132112.8834194, 685311960.3989224, 569074074.4988582, 434189354.4954425, 479189146.78767973, 639150219.6520524, 716148425.5905747, 907853441.229763, 914016865.9513863, 653285093.6856569, 481900298.43653977, 396320582.5257496, 632835138.8953173, 500696117.1360569, 545745855.2189074, 522967338.67848116, 579207141.834311, 752424534.2054161, 617834183.2682528, 576971346.3737216, 477109590.8740063, 415433492.8752273, 537418748.0665258, 590234067.0405188, 874285036.2898939, 614258685.5052657, 738963200.33671, 535908297.36435217, 461925594.6881671, 484456799.23738885, 510303290.96138346, 914016865.9513863, 499780718.73155105, 716204744.3677171, 491028541.547623, 730808841.0115473, 649126056.0361767, 577221126.6347167, 591902151.0075855, 518151794.5931258, 657785128.6446825, 541079316.1382687, 457874516.8506615, 452713155.2213229, 619918920.6322383, 841004581.4728932, 618228478.0712552, 581994879.5512359, 635325219.8615675, 792631917.6607108, 626239498.4015372, 546270053.3945447, 759031107.1931416, 655320309.5488188, 833135532.2542231, 621351311.4529333, 457987282.05272484, 443951358.2180083, 854213526.5081041, 867800070.2407908, 574365578.4574759, 549563964.9913468, 819813018.7664819, 469787036.71731365, 491901716.0505403, 686527935.4881241, 548205780.6706222, 596492528.5202141, 576370390.9627713, 642492895.7496481, 810272726.0207841, 608996522.0190451, 686619043.5841808, 398057502.47862697, 590882308.9682047, 497420911.4607996, 458548775.21375185, 493671383.25814736, 555438761.5582919, 728329539.5481079, 447986145.39401793, 601133273.3763149, 537667858.7002957, 556215778.4516461, 742178266.0886872, 671043887.1413673, 798048185.0436223, 577487947.4505858, 513551586.2966535, 568872313.2397025, 629385354.2544436, 620454736.8638965, 472098706.7623755, 608983964.4668622, 627441550.1688802, 914016865.9513863, 890052695.1092924, 496342914.22224706, 561093846.4514939, 434882497.2676643, 525396953.7631045, 639440044.3151488, 775600102.0434271, 509876901.66305125, 518223798.5643024, 396000444.24039245, 576467462.2458358, 474351485.1853471, 532418988.2806456, 493809553.2347841, 585077935.3321147, 408100063.1478292, 434543213.9249022, 914016865.9513863, 451783933.0452071, 470832427.37847066, 884227709.4990549, 914016865.9513863, 463266171.1463671, 551346025.6945505, 643047650.6048797, 868697734.5070556, 482180295.885154, 566237588.1120152, 706770121.1299012, 656174702.8611662, 550402032.2468055, 580082558.0015333, 443303997.9019904, 567110095.513854, 563652887.0691347, 627977909.7244918, 529440518.7035124, 661427034.8758578, 743782799.8949516, 617617353.0094757, 644471338.0041597, 604075406.3425963, 597166054.6892278, 510709040.0055637, 639563331.3275294, 584694565.5371424, 914016865.9513863, 839958680.6060095, 649252105.694295, 506137301.4304505, 469241249.0393582, 773129403.7249625, 632154727.9951515, 662662170.6878839, 409191410.73657095, 730153876.3003168, 658976765.2023454, 469442653.15502095, 539143195.9193547, 632287397.5544819, 603985252.4908935, 560511924.2848234, 583909143.2916707, 565416001.6350374, 617233648.5685971, 821601794.3569249, 388255070.9193959, 567272790.6750854, 620446540.7815979, 636727214.3520837, 550908202.3109881, 408182723.52872723, 641160012.6965814, 868494024.6878488, 428299619.3496991, 720150973.8872075, 556113067.5180697, 589269992.2932619, 475330412.3735325, 555398709.8021382, 791608401.5010228, 677555659.3727235, 869210396.0428963, 770830351.6047856, 656789655.4509815, 870861955.4329702, 656776338.5869595, 714575689.0348959, 559977700.6822784, 605831345.4098533, 513386784.95733523, 740060883.7057246, 462590543.3266076, 707538793.3537526, 572981467.8794569, 769800383.1461014, 702725207.6730955, 881869395.3332677, 699669910.694716, 424772467.46592396, 588551482.7580637, 463221958.45576406, 533708107.33904356, 828714438.5144694, 685666135.2354861, 513219212.6672416, 479382463.4464283, 601413569.8729806, 458772623.7032521, 516319013.61644197, 638941801.4777007, 767144458.2917738, 681401824.0759904, 393025248.49104184, 637884017.733988, 606552451.400159, 653211568.0736717, 847803953.9211315, 397778337.57999384, 525351823.6214297, 678768912.4441134, 423894371.6638459, 822396533.7908535, 646794910.2779896, 717463052.174413, 527651880.71823704, 712374923.6937801, 752831186.9320614, 628074319.3993098, 628281703.8259062, 633196300.1231763, 495257725.9373315, 578361897.1345968, 577736224.7522564, 648906959.5476701, 741706239.8162398, 474750215.57531023, 581191798.2173088, 823379459.9078672, 508276962.97565377, 499687237.9519364, 623925538.8401766, 717121037.4742699, 598635949.0625414, 796588972.6020856, 719053323.8913097, 716722248.2583361, 673376010.3672987, 914016865.9513863, 571182263.757103, 399060363.3001045, 845607977.7570004, 540760943.5335515, 611284036.6174712, 793242303.1556354, 422001311.78018093, 455298780.50095415, 422091041.0385035, 502740369.8564329, 656867968.1251773, 669020559.0709465, 634010966.1897467, 439682408.32952523, 392643025.5401608, 604232327.4381528, 539113844.1273298, 659686571.1747217, 695310955.7949376, 615320441.0908186, 704138295.0675294, 627575277.8391634, 669873572.1608818, 512580968.061201, 574354100.6790872, 623178010.7748818, 713420700.3346195, 548308432.6287125, 668582551.5116489, 563719920.6790841, 582133171.7770243, 714812945.2229043, 399286598.8399762, 450899134.2496329, 433120505.903884, 392167425.1296215, 515522577.92098606, 702506562.5758958, 561397856.5198848, 623315008.5277333, 756226061.1074369, 796368796.1511586, 588272838.5013281, 800855259.8842089, 609200085.8845892, 498049864.2628174, 524976629.6026741, 433275223.50051665, 492604902.14403385, 552570017.5328603, 710804284.9141372, 867255035.180298, 442604936.3947301, 650235478.6550343, 476604382.98878676, 661880143.9236357, 580426697.8344126, 402943817.93861526, 730289827.2771239, 523772115.5307821, 531904563.3544623, 473597984.85484385, 518208432.89204276, 655197282.1152966, 573156191.4148401, 641252665.9239709, 645893226.004765, 795156335.946841, 554396951.902211, 433620601.27911735, 752627265.5275269, 555756077.8229803, 760399298.1801312, 648904602.9289207, 580420296.9692005, 644055034.7566798, 901009449.5121837, 914016865.9513863, 606203806.588551, 618255145.4966166, 754100651.1894472, 497159002.7506566, 641865814.6760138, 593816848.5393316, 639204866.6214678, 498484879.43034947, 423162978.6686893, 397570617.4373914, 468736018.35595244, 540646596.5982215, 560387980.8524318, 898959922.1641922, 758982490.0117638, 484774477.80483663, 643906005.4472872, 546725908.3499167, 561461156.977891, 621633054.2840555, 682941546.4497125, 554820965.6215184, 752077246.6342857, 466249250.6820158, 597976220.0901586, 914016865.9513863, 626741632.1982495, 814808170.3746803, 609120001.6378714, 677279797.3071793, 589850302.7277926, 575500993.7664444, 504339178.3866206, 655539845.2195415, 496526432.0484868, 689849351.7899549, 755581697.6241606, 646539021.3698134, 561231840.2395784, 658911795.9457337, 558510883.952602, 731438948.326004, 402916147.88646305, 555260159.7696913, 399335283.03737426, 431914285.46929896, 802642382.7878007, 725064649.8031187, 510939024.873907, 431218567.6016842, 388255070.9193959, 530799715.47017515, 914016865.9513863, 656191518.1854296, 528953706.98600984, 660501531.3143778, 425793259.36279833, 559886393.623107, 610171582.6534969, 586113909.452006, 708837326.6348765, 643478529.4506048, 690259444.8523533, 514394698.3834195, 725478365.4833373, 850148004.8846333, 483928845.5173172, 492651673.3154604, 797768886.9914324, 572895421.1008214, 809629618.1215155, 542540889.6188896, 818675898.7895042, 614419997.2052511, 631535538.8248097, 838386389.8400979, 552120670.39074, 486981871.2182399, 541832551.1828115, 658678745.703213, 425350747.23272485, 685656782.5680096, 531343394.89457786, 765897704.2167733, 390951353.83488953, 503565713.26224625, 414374468.67445564, 499256576.46793, 630091034.7165667, 574402003.3888791, 565244442.4817295, 576902566.2603736, 624071909.3857187, 479920893.18363935, 696049514.8275175, 689412821.3853968, 649138295.8049083, 673728980.295886, 636785746.4521995, 913125130.6515787, 585987705.8073684, 558703357.7981385, 507183487.4362482, 477460240.59191644, 456007042.5546712, 492534096.10424966, 588076194.6408913, 642036267.0673025, 603811838.1949003, 505865607.62119514, 725851190.7944417, 700981663.1172786, 576844621.37882, 518361971.5383463, 672545981.8762827, 621989986.8714751, 436327506.43518394, 588420472.233657, 632056966.6912903, 491372549.46261346, 622242153.6836009, 435695193.15803444, 797838411.7404783, 782714121.4897927, 565349837.0309975, 646107854.2094305, 390639763.182153, 464796067.0810355, 560316652.5895255, 473353790.4106457, 697189489.0233865, 907938550.9296051, 462759824.31577873, 498042830.5429759, 628424388.6468554, 846867665.9183012, 458195153.653672, 630278228.5519272, 881963854.3493834, 417501212.1030632, 452406145.4726435, 544771066.6312501, 533441172.3707154, 712195381.242969, 629271152.8491606, 406687638.8327936, 667748560.8653005, 526898313.0148144, 787225490.2815456, 521214816.12046784, 520196190.8793632, 671482868.422472, 704564941.0013243, 658074292.8174042, 414452629.5519248, 671032102.5965908, 477248710.1615269, 628400921.9843688, 438639012.99576515, 657820775.2648113, 501384637.9896518, 452252755.3845632, 697102364.1615392, 629269079.5629354, 522754332.78841615, 817989506.6726565, 542762363.3559053, 601325656.0133666, 633000062.8517468, 522110278.6953641, 661369355.8010842, 531956192.0839889, 546185877.1180744, 802430079.2119, 476600034.563913, 390583004.2893458, 846834752.9847438, 914016865.9513863, 546940285.172742, 400510791.8536999, 558291725.5754335, 561234976.4577734, 573071786.3272173, 469141984.44960517, 677101258.265711, 669066910.4714963, 431975586.73455876, 694895426.6812654, 913911728.7873018, 619834588.2051758, 555053482.2725961, 579054966.0708762, 682362154.27982, 410426374.8882041, 618818316.6750998, 548697997.3387074, 885814329.6440525, 575031539.4840103, 857362205.0649133, 470123523.6925074, 678232360.069538, 639966386.5203495, 494646246.2216754, 620565408.8009822, 776722147.7140554, 556683860.5484049, 413881655.6947113, 594886141.8602982, 491082172.82127345, 554450446.999408, 586687509.7800426, 412656363.3033035, 420778425.8623153, 662938574.1552193, 533194971.07069296, 388255070.9193959, 707921495.7564054, 633474541.6030644, 511559987.04936814, 448915075.1952883, 715788431.6602523, 644135288.9619288, 914016865.9513863, 654104142.7232116, 649513490.1345975, 575935192.1157331, 712840390.0362861, 683817869.6850945, 783355263.419104, 533356271.13297534, 543379643.6713831, 538258488.6269073, 708836650.2383146, 826406904.8594028, 540627240.5142869, 544633294.0766412, 639228288.0831137, 566178235.912681, 734061940.639238, 393832826.0719669, 499205133.37479395, 504018664.5712349, 392435358.73056936, 484611989.5740881, 489729257.05652916, 571684733.0538372, 760131099.5138596, 566264243.4598906, 477610145.84958255, 589828396.0471704, 749686980.4681026, 483320147.09672, 490215593.78504336, 674023467.9669338, 569158762.9638028, 687147159.137635, 595391315.2139325, 695267237.5242673, 477169095.736848, 595592953.3016852, 570498285.4892737, 458839138.7995757, 425560955.1394044, 692872106.6954813, 553416644.0689994, 478493954.3675636, 584834958.8457336, 762616775.3604462, 393240266.28964335, 431766697.2255158, 488909713.3889264, 819765818.3656182, 634879238.7714777, 705236081.6582109, 466428806.30734813, 468517563.8648827, 658033539.0185518, 604746073.4779778, 672591318.9265105, 573351675.1954815, 634267982.4164095, 617977576.741405, 706835997.0919526, 711332130.0769712, 420394587.1685013, 393925398.09513277, 742015327.8001869, 772556494.8032994, 478665787.0475946, 402210682.3614876, 610113037.0603414, 730692398.0462046, 878542045.6408703, 667877016.3576038, 550931828.8274293, 492071885.5273373, 598639223.7357843, 559650875.0899253, 479242218.42259455, 913847733.5829073, 876755440.621253, 763946060.3069687, 489125434.6301676, 718776656.149339, 685977318.0281792, 657282384.2148707, 783005376.091704, 685344681.3470807, 701073107.5925679, 685572845.4600976, 642941129.642296, 405980749.6296731, 608077907.7650206, 529341316.47570896, 452526532.06499934, 859956918.5407441, 868739949.0161668, 801834678.5209541, 631122836.8053396, 800341103.3345485, 598717331.0137097, 623991964.4717348, 471170606.3259336, 650822731.8301333, 605022943.2575504, 450295930.9589045, 590564929.8827602, 586923856.5981302, 878537243.2324588, 724911887.1487317, 598638464.2952515, 630244232.6962988, 602905525.3638325, 571460590.2951192, 472299302.6099796, 577920410.4219303, 508000600.01723003, 455430142.27703524, 667142418.8491383, 650015202.6398785, 405728000.6631315, 581484678.8847156, 741043361.0801336, 751322796.993134, 745902304.2657127, 602213382.2265141, 497225330.3626759, 472169206.1994955, 643472904.4478819, 648328467.7826362, 789428486.384583, 757993224.9773145, 580283045.5394435, 456033310.7143601, 557249394.0755365, 625947508.384675, 571563492.6964859, 526857756.27267873, 630804318.9202945, 535367134.8977724, 521160770.1836045, 638864701.503408, 547328811.8690033, 629604736.5850053, 633589122.4916703, 466502769.78314054, 538009164.6726053, 815614962.6984131, 464219275.6506436, 396644875.7744763, 402165971.4127402, 600935043.1774529, 601170513.4117439, 582124505.0672681, 777003703.3418518, 388255070.9193959, 650673545.181586, 837790092.0642724, 467681457.7505934, 549966769.9464848, 507253349.1467787, 491942320.85320044, 556385905.2456297, 813796183.1226145, 884296429.6452788, 555220226.1778228, 894199794.2141764, 601777969.036552, 872251586.1598458, 585200186.196751, 614362995.5887125, 646390888.3713896, 914016865.9513863, 718194916.0829868, 512293241.4740366, 736764291.6266041, 552113244.6233797, 537018001.1904117, 727177264.7840189, 601192446.5440085, 634327412.383676, 598968121.5193189, 642354815.1399348, 654781979.773854, 400507969.0582441, 689997069.489321, 482685934.54627585, 436878677.2197826, 589642189.6350749, 608125352.3383764, 513822783.60033375, 715047481.6229278, 446457204.0831542, 546741843.253433, 526061457.66460454, 591155320.0930802, 634367069.1236577, 479987763.93074936, 698685661.7834896, 605366183.5379077, 401498525.3625971, 400035444.2735311, 595562661.7880509, 569228932.6417933, 583917769.0973641, 593544087.9068804, 627078687.9691145, 733361189.3338263, 469374089.9014268, 463225530.89900875, 471185664.0404564, 635751029.7796477, 782204540.8116481, 543858896.94193, 388833942.3890108, 412804690.82128143, 498520748.0440285, 529165047.33042055, 546570669.6532873, 602170034.12142, 558139005.8742448, 749713968.8201382, 515773660.11031747, 495367974.4994467, 662480037.5413723, 428134461.9520196, 649793572.0419118, 610578534.7214053, 578372701.7527987, 842681960.8110881, 521822816.91580456, 914016865.9513863, 568678448.6336812, 452803497.917959, 606274565.3546546, 472932275.079363, 507378231.3677411, 650828657.4407396, 673590022.4941173, 521827311.12246597, 739711280.2759266, 767509876.9139403, 815354012.892107, 669778984.0011365, 802566910.5157363, 401745227.9585173, 557394343.0517678, 494865142.03476405, 612789261.5357707, 527594077.7047109, 576031329.7390994, 890834151.3965062, 575586791.0033519, 653197694.0166827, 567836285.658266, 607036457.5168654, 597934435.1424031, 658106353.2366983, 768809350.5253706, 853558888.440536, 638610912.3696542, 678568868.8059154, 465348504.09315896, 585888317.3881271, 732191572.9510541, 720485348.373348, 625185169.1604881, 723683705.4766166, 664190218.4613447, 774667478.6283512, 635812019.0025835, 552847721.2578332, 642251510.4854004, 388255070.9193959, 648835477.9798112, 388255070.9193959, 411067603.09248555, 658598014.4442334, 662286706.0257275, 464184152.36662996, 511756531.6494323, 803806005.3971264, 537684089.9504898, 914016865.9513863, 596906678.1073439, 652383039.2928511, 847926218.0021055, 614358905.7246652, 480565151.110821, 583120037.1094694, 592563485.8440481, 444280132.5379006, 564943829.0872726, 508430747.5785217, 729666231.1790996, 601652155.8661964, 561652002.5240825, 583568328.7643664, 626747376.13607, 682592622.4846509, 480839236.2711824, 476496627.8797865, 758766199.3679407, 546103198.1024808, 439294364.4408847, 657462973.9420309, 660256640.7446209, 428591581.90456635, 627612058.5354125, 700399804.2707715, 647640999.3780277, 684841154.2854779, 440492383.7901313, 641583364.0301008, 559244082.4214681, 537828591.5304826, 721202376.4228842, 822989997.7324766, 878077965.7941606, 794147356.7979722, 583119186.5123155, 644606008.0989664, 705160483.9093721, 613048624.3121102, 614323890.6878312, 713919745.461925]  # Truncate for embedding
baseline = 611384623.6128722
mean = 608938192.3298035
std = 126602890.37078722
p5 = 415486533.1432253
p50 = 595453173.581164
p95 = 852697532.3993205
display_name = "dFDA Total NPV Cost"
units = "USD"

# Create figure with two subplots
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
# Handle edge case where all samples are identical (zero variance)
if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)
ax1.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key statistics with formatted values in legend (use format_parameter_value for full units)
ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {format_parameter_value(p50, units)}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {format_parameter_value(p5, units)}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {format_parameter_value(p95, units)}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {format_parameter_value(baseline, units)}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---
sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)
ax2.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key percentiles
ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"
exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title
fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark
add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from
output_path = get_figure_output_path('mc-distribution-dfda_npv_total_cost.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 6.114e+08 |
| Mean (expected value) | 6.089e+08 |
| Median (50th percentile) | 5.955e+08 |
| Standard Deviation | 1.266e+08 |
| 90% Confidence Interval | [4.155e+08, 8.527e+08] |

*The histogram shows the distribution of dFDA Total NPV Cost across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
