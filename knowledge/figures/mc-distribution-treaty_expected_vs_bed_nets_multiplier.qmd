```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Expected Cost-Effectiveness vs Bed Nets Multiplier (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Simulation results
samples = [71.4552510345016, 41.55160999077492, 61.087208655193756, 63.61881334309936, 89.95349122513558, 70.21306742845742, 59.89895768678351, 69.55125402635194, 58.833758489484936, 83.54495810202052, 90.23983504284864, 53.64428153774869, 86.21205271612418, 79.80251227534936, 61.47477702082376, 72.23144991600276, 68.36902934283475, 66.88059455139754, 47.93198699918602, 79.44050443153151, 84.79103827769913, 79.05608476073904, 52.287517510735555, 92.75431613437803, 50.02756485342676, 87.85378415352494, 67.42912448755044, 47.799139601272564, 83.06581599922337, 69.18128890867885, 93.70029575851102, 74.94142955455165, 120.18474369247289, 66.47456206630497, 40.75661014647728, 102.45260340320336, 38.643578311304815, 59.64461477126515, 89.46320765248885, 65.63306674239738, 63.15349668458429, 108.92475752963844, 102.44425892241007, 60.66871283348755, 40.92565987680273, 60.581169678814646, 55.78589934086148, 85.38683092607332, 109.05560732840361, 47.78896027181052, 68.07668509918399, 84.92361476908367, 70.9577832739786, 96.64246937989844, 90.72792417279547, 92.08594723057215, 69.02609024364278, 49.681660467502915, 70.96007551750736, 76.30745653289226, 46.04928264844844, 142.53217549029586, 32.39837595367993, 36.51398077834734, 50.96467398220053, 59.20321854221731, 74.39839545504812, 78.27438451386287, 68.56160044571796, 60.12939127537149, 134.62537557620277, 79.01551857426496, 84.31134217688381, 47.148164312724795, 67.25855131587474, 101.31225691745635, 98.42304443232953, 103.68476095854567, 68.6839672151139, 79.50547666354954, 100.8914411130396, 72.60804481963685, 93.43973048520544, 87.35031869878426, 85.00654897151597, 90.53606041464795, 50.42652700101836, 83.74657015855384, 94.57598933503364, 71.19595381640269, 78.9431011937243, 76.67450256986217, 70.3659348697277, 45.58705140843392, 61.527244450811345, 111.44929955688279, 178.56850850069586, 62.187129680598495, 50.473926966768765, 106.36588778132135, 73.78675118162532, 63.67930409874692, 59.81690859750211, 60.93665602657483, 114.22560004022655, 30.693927692811542, 75.26856789249793, 60.174668052615935, 71.80294208106825, 60.63258642630768, 49.246266291202325, 62.38828610517891, 70.42589855989847, 77.05181777775586, 58.83527425782718, 105.53206918094668, 116.12561764552184, 94.270059491365, 76.95729209313956, 54.03736667875109, 105.98028840435138, 61.73847132062296, 94.68527473693455, 65.62876732012343, 70.07289005614956, 50.54221059070824, 84.52479041392284, 90.10292868167699, 34.77963802651878, 87.1205050145724, 145.69428621342277, 49.830787840746986, 79.11614341284424, 104.54765985494488, 106.39665373757816, 116.34694387982826, 65.82096742446123, 41.77853293441719, 29.713590415718553, 52.12690092674336, 68.83343178108899, 87.69630559804015, 94.61005847813288, 49.941582491197806, 77.40856284041018, 98.99200595089759, 104.24150784895622, 78.26750153818381, 93.95590631268853, 61.16150723625957, 49.80100146345168, 46.12259337552369, 85.94986016245794, 64.04731712307425, 75.20643726037822, 45.25409472329516, 45.66506624665952, 44.42441728209164, 99.31677294872192, 70.28543701552078, 95.78725601384583, 48.57308930555348, 51.29311582574278, 71.09218085979566, 33.2863199345422, 68.30004047005652, 42.79662472931207, 96.8415093106381, 94.81190486593839, 118.6289229705129, 59.47761796574658, 42.87965848449693, 101.65571745183867, 83.88548349052613, 85.93402714804381, 103.90697119090768, 78.59447412102676, 71.49101659618839, 72.22624806321309, 47.54957012549217, 40.81193739782476, 54.63142529882724, 83.85845379812835, 70.10494426918164, 62.962771663598865, 30.3735693813839, 86.23849265958832, 89.14062183838996, 84.32334631013923, 31.921700332310053, 42.750336029536236, 122.24659240170571, 84.05001186214484, 105.87666559079456, 87.09194779041836, 95.25712185367261, 78.38948990888314, 116.44651639299826, 81.2505474469273, 75.79159743595622, 111.38428422730574, 69.45793301252114, 54.473450316406826, 33.78700384589455, 127.5624794316006, 71.58304495238217, 79.0183363563648, 75.96779486080484, 68.65792638196386, 85.49879270153373, 54.68800419682557, 75.10742829612374, 90.41183304512802, 62.84998892923289, 102.55826816138391, 100.91068330737764, 154.41967353370867, 51.206920902780645, 77.6700524256873, 45.19961042446846, 78.43347892493124, 48.750292001087374, 72.16159178158948, 43.30237444494254, 68.37621048884962, 55.69618341990548, 91.78152470507877, 46.991784692979145, 77.6169756164611, 82.91655958523131, 85.93499628062372, 72.108430796522, 52.76474530503133, 72.62351793041857, 116.5417660398905, 82.17045706492351, 87.95195688152553, 66.49928759852946, 99.35074992528473, 97.81794348644036, 89.34315291148172, 78.06112016524169, 46.6840331587484, 71.24236241568087, 48.25499834440553, 60.94873443704492, 69.3114526439715, 52.80577643686947, 31.199312739027647, 49.69495875057568, 78.13717138587354, 45.82533103667503, 64.12570033055165, 72.73692803787645, 78.10478837600762, 58.70869291560865, 77.79354868493917, 53.78214195750627, 52.89921649346221, 73.36031451730318, 102.96433939382202, 35.48439512705642, 102.2037620076945, 59.940328388180056, 94.2329427988199, 84.4340998563179, 66.7468740947414, 46.52158410812033, 45.70846314942007, 76.41819018188261, 73.03456703310135, 43.52920257076872, 70.95805683842983, 37.45988065301327, 49.459192376461225, 77.89101021612153, 47.166623989895484, 63.19115421871547, 52.16862938050811, 72.3497737297108, 77.91175575269283, 113.35220294472886, 84.49209876428746, 63.83108183271311, 80.88377146330879, 78.46683481005984, 65.78772271629897, 36.340555344956556, 96.65273051106671, 74.39179277677889, 35.36833074765823, 89.85875262882797, 74.26028098931957, 85.48657643957098, 125.67140385644414, 74.24942012584545, 45.31832314009981, 82.19251312898709, 74.44509554709173, 70.32936706723989, 70.95115640286402, 52.60990641836727, 57.394717287571616, 77.67614022084017, 61.00368576563355, 70.93127058834415, 67.01449930776234, 71.33267635701489, 62.71397345054886, 23.96112693196132, 83.45353123779272, 84.70583740925075, 77.40997954044677, 76.59896631392037, 67.24120599949354, 57.916075326306874, 87.90524374651177, 40.64040053426339, 75.09611461791573, 85.27484783144624, 71.38032058109967, 67.4533443029009, 65.58190349834064, 74.02791241606187, 91.66197987276827, 29.338558353777557, 91.85290718833465, 95.89881219564867, 36.51776095112787, 69.22418230988292, 27.80898297782338, 24.98456335075349, 65.49760306941411, 76.67341725555012, 72.20015576124753, 81.40514068418055, 118.43611030779323, 95.5095049672264, 57.825770097829704, 83.16741313152798, 111.40036237013022, 133.73413994140745, 66.24555843796703, 73.43921843126047, 52.96485613646531, 106.09615989702365, 76.34160768984309, 81.89997771384657, 48.618771935397504, 56.149018290670085, 25.04705742457856, 75.32222737281086, 50.49618456115589, 63.55396110522141, 69.92391843065347, 67.4881681851524, 80.91526170500836, 66.45128618911292, 121.09681335777749, 96.80602604713978, 60.92152470596408, 47.94731118600875, 86.97744238729558, 47.92696143185894, 22.343959607108225, 59.31602561518721, 74.38790471565262, 63.16436174542121, 63.866232955001784, 65.4871781467417, 55.624795595976614, 71.97269391731734, 32.77644811014361, 30.740113449081967, 36.0507762619513, 61.319123057545404, 66.49646647644848, 93.44739122871869, 48.068605062102804, 59.8566205673935, 57.537824158039804, 72.18223419998995, 84.35577536209027, 41.293103227127354, 157.22688000258742, 67.66446952843066, 62.03039734672541, 83.7252842036213, 61.93479601819715, 116.31603108069461, 93.67178222263531, 54.28998408611684, 63.59443785870484, 52.89821939861449, 63.4248464608767, 53.066351524247, 81.48934817382498, 66.50566720972843, 41.35689441324359, 87.94279597222967, 70.36723925908453, 96.10717522368103, 45.1506064880933, 84.46296306434017, 43.858350554117685, 41.435790961897325, 80.91319222162272, 60.86900057573109, 121.83893329021193, 65.55626985477778, 104.82879120223718, 131.11525425347887, 60.66308756838025, 81.92922577358237, 67.38308172969896, 71.7891090561698, 62.974387942971624, 50.76940083645219, 65.86244399866781, 61.60144697506573, 62.41966471252158, 82.66910536215687, 74.66021331314187, 71.99458205309, 74.37680921076024, 68.48687591206286, 57.10712414421984, 51.36617405409759, 68.61879808630928, 123.59618335923105, 88.36916829015769, 109.82853556021091, 88.16139719499033, 83.26057406710453, 63.57093835258001, 41.08254915750807, 83.50711314045306, 82.60742146094032, 44.75465466430456, 64.81422472341588, 123.91216777834072, 53.53175153312516, 94.54468871122398, 49.43131883953592, 132.77081594602498, 73.93330502473366, 56.85255057515732, 153.36871397869533, 55.63470108986977, 74.32281916686621, 107.77911928507385, 45.69509191511712, 31.097466968387803, 58.23333367599573, 66.4560312207548, 59.91996130984964, 68.72974171704475, 72.74304605968453, 36.0021364271807, 58.05192823050164, 60.36420567859103, 89.48762764773083, 131.35896773312194, 87.44609312837537, 86.06714129498546, 57.762232793564365, 56.9474809413912, 38.17295624228092, 64.17550813238006, 58.96513026266723, 49.70811229598468, 99.13413102506436, 88.75627214092727, 67.61882452689522, 30.833301524373688, 38.515553698792786, 64.55978940916539, 82.54029763783088, 70.99482855691697, 40.96869489861999, 45.53721046982818, 66.34642422957522, 72.1094123503704, 104.423949074544, 21.449893829240146, 41.65590384577945, 120.03782494105145, 46.861760660879035, 62.433536985446516, 114.1189718226238, 49.60388429369521, 39.83710061242421, 46.732750001673274, 78.91279417152568, 61.584429117004056, 58.17560934255934, 77.54566415362879, 68.21477962122574, 68.70817147093068, 102.76246284774282, 75.12449033667514, 62.59879182175516, 71.12891921424315, 90.34451819187923, 131.06478676075682, 143.1364334869399, 51.2565964701911, 45.833782977959686, 122.72783014979849, 76.97039878239005, 105.11074940372438, 85.09632887544417, 29.992706545178137, 65.79933849548254, 74.30858226226307, 71.52472685962438, 58.77737661975119, 100.44677618344306, 33.803282370799344, 64.05895443803595, 77.54338909255436, 89.11141789779506, 77.1766798060068, 81.68190860492047, 62.994112128275226, 35.04081131664889, 38.53961862584638, 74.09559330793819, 73.8131044906731, 57.365119754071834, 87.29544762297475, 64.80701461548608, 57.512814174791345, 84.79220794264381, 85.05590074177108, 85.34078438124308, 62.31744286448243, 71.10107329124192, 93.6569511808819, 82.53732750893768, 65.15180628700337, 70.00306919664538, 63.8260317083629, 55.859378978278976, 77.21663047507663, 55.85019688836482, 65.2313696874046, 70.20619172486509, 59.391142559212966, 72.98519166595226, 140.95274405394173, 38.804859836541105, 110.25552969205474, 41.05011714467054, 71.13198953499125, 63.3660024056696, 110.40199440421746, 89.47995704533301, 126.76813433025556, 85.48769765096917, 74.72962048694619, 48.76218759814789, 120.39651665223839, 57.436466760348836, 70.74364687575088, 105.829841582713, 99.08311022523843, 85.0327173293334, 74.94222960175416, 70.75131108221872, 36.31890250863021, 79.26632313144624, 36.54975044687762, 94.44672288676219, 49.96712520551282, 106.41702379541182, 66.40082053984455, 78.7176331477415, 93.06009447675194, 137.5241649091627, 111.08433822155017, 76.29406075246725, 98.51536108346174, 112.13185828628586, 49.8546879428048, 58.215141567459575, 45.2657225819175, 91.1976454824614, 80.01652188955929, 108.10326375630376, 147.8483406294503, 89.97789602525802, 82.40475494784758, 95.33333059503104, 77.47581940626016, 118.90825626808798, 130.77550096144626, 56.18188834000922, 70.83044167275918, 99.60020398196271, 73.53569282716215, 109.32326768340975, 102.1914163629051, 49.343390141867125, 72.71872370045617, 58.18196269102777, 49.49408255061843, 33.17975131794928, 43.96219438912698, 51.23368516308915, 37.39457491191501, 59.96302521498691, 97.22228393178911, 51.44425493186335, 52.9580334531153, 93.20012631671642, 87.0271855483669, 92.11137967326069, 94.1781002900745, 95.90591409571785, 51.866139932499266, 61.03294021159662, 88.65323682659132, 93.25062532182719, 32.0772021036961, 121.0068309367112, 73.17995025622697, 87.68179572934204, 94.79235839659485, 132.62333186635135, 48.38109843140993, 60.77367941491536, 104.74838416549632, 71.62172985135616, 77.98125656313337, 89.59930474876224, 58.37677466731598, 72.33986949804019, 90.75950733984384, 70.81794957105049, 46.71250111065254, 70.00429130093218, 40.59126795162847, 83.00717015931166, 38.593457973086174, 81.29553212115877, 58.68765038590736, 61.711932266858454, 76.81102076610358, 77.24320122006178, 37.97953899966695, 93.67803104322795, 69.049235885402, 79.87574589716908, 89.62243734181354, 69.10357006170366, 114.01636007948593, 54.996536530468774, 37.99316044778074, 71.65828090522872, 95.58975512953872, 57.938324445551146, 66.64861372864243, 82.15122467014606, 65.63079840040388, 85.69767270220625, 91.56832069721561, 69.10518764514038, 165.53943646173929, 84.01929078783424, 47.257442120175874, 65.63007900481493, 83.50997765733892, 59.46716952442854, 73.19879882602957, 77.33932951751015, 53.46786820208743, 73.9163151216579, 40.730486419778856, 60.64819433261826, 75.03373388721317, 42.45419721127495, 79.45698211661494, 69.66808411355117, 52.845552710400234, 89.26031160461947, 92.24870420851852, 55.56496384952957, 58.27276052034969, 68.99477594382614, 57.38193410087001, 106.20768445763203, 93.0612546457293, 118.39429657095593, 92.30871507572459, 80.19074932868703, 51.024284317762834, 55.127445256059914, 94.13413350152663, 55.47733944452511, 61.40220395753278, 55.12961649391541, 83.86654011825465, 64.63929773050198, 51.618908574279686, 79.61483379645438, 114.60920509206474, 84.9323561740849, 49.63790923253372, 60.545179488834535, 83.6523575616035, 80.70964873055124, 65.49917477009372, 124.15895279372312, 55.109733695043, 87.6410523506431, 107.27650387266283, 51.48130401213997, 86.67433139362656, 75.078399671431, 83.13004250925431, 57.731766558966164, 53.954052835941525, 106.1015207853984, 53.70799409484258, 50.163910829333766, 81.11403661590784, 71.65900305788259, 71.31381976789264, 75.36749451891072, 65.5166185969087, 48.427883699855, 69.0135167379597, 72.77341097097369, 26.942736915151595, 105.76712899567775, 75.46080771238113, 82.67882809756297, 71.81251995761292, 160.00995093982817, 101.17608921366985, 91.36596597015817, 83.15711323592907, 111.7301153786762, 80.62747778990888, 74.55075951809724, 38.12726427483684, 60.561236923862175, 116.26639991736953, 78.44716108255395, 60.599003844346164, 74.66232885741266, 46.15900481571843, 76.35084044405477, 73.21668301837607, 40.34478336998668, 68.01931972721513, 41.64551039895964, 84.25142944963402, 61.5247535120134, 47.83864068736143, 29.125977137981327, 52.75659261798147, 42.50137304640041, 79.47366156593753, 100.49614657273106, 71.38974466533242, 69.12192364069834, 84.39253403145077, 44.9926236672737, 43.45324703882251, 55.431150268339614, 74.21946072896418, 76.21398842525619, 71.7378366254603, 64.83764355334941, 120.4306010001312, 55.28140289287905, 49.62567931762899, 73.41911877365443, 54.57631766885272, 91.04020470678422, 78.16541359068755, 73.7076983310406, 93.85410367413874, 88.31950126645499, 47.710376134018716, 82.38352427142803, 88.5688727489131, 64.11454361336119, 49.80533988667601, 105.6196119236131, 71.27642480606383, 65.7665188318152, 66.29040154207547, 59.587650855249336, 49.62268793006562, 75.25626724033606, 60.1580361962456, 87.43788934759627, 43.614862701376566, 104.99708174160124, 93.43273778541618, 63.913974666573026, 54.62837738513161, 87.0029914095384, 58.27423419932076, 115.31056326451196, 87.04886195944968, 77.03525586116415, 75.8852871701644, 101.05372492250373, 40.53840660640404, 85.69942487871408, 41.98214938974814, 84.8207562873092, 104.20151444004107, 52.9735471383617, 88.435137275677, 86.89740839330584, 96.79564560900316, 97.48314186642476, 49.82763200166572, 101.08500734349751, 70.02013522830991, 72.40658990779548, 36.75796551671785, 80.9058952763065, 75.38478081729465, 74.66265078719827, 76.68517451310565, 58.69268834819853, 127.06602047964104, 82.17168180023332, 64.88273826379475, 76.81774702481422, 57.02738813264223, 52.06584650202704, 63.270623421240614, 70.11761772183354, 53.11392940799741, 97.26546845318897, 68.12468868722469, 67.47154220333853, 51.70597848712117, 71.65074173712907, 66.57176600805552, 63.54125253542427, 89.85271551335325, 72.65476053615912, 46.90765842948462, 100.22720016531134, 58.686306566852416, 71.12683047399983, 47.390350057370014, 53.686392213451754, 63.753805136679716, 83.0912135000806, 49.978349391077906, 57.57738167065844, 61.153529102041276, 97.43922798511718, 74.7500534440089, 65.33415696506891, 150.36219612629802, 123.9730852633325, 85.61520205125254, 64.13212079623257, 128.05569510851973, 102.61741368748581, 70.07645986356293, 117.1428859915885, 73.20315574260847, 84.54791218706664, 88.62673191314207, 147.9805464041035, 110.82482477202613, 32.060384205682006, 57.65284362963968, 86.76732842398388, 81.87458532883909, 52.284213999744416, 109.865048501202, 72.01240680494452, 87.04558677954907, 78.2610295633027, 50.23015370757435, 86.48499770295024, 82.7739597891447, 62.34433799720429, 41.32294326672869, 105.06800954064583, 90.89552150903691, 77.37541542556772, 59.78265944044894, 54.83908033544534, 95.30669076656031, 70.9115408535525, 94.72530949479132, 115.04750106403951, 74.68876023832789, 80.10500631316675, 38.401747926442766, 32.23677847836332, 63.23160583912412, 63.535024859401105, 102.58620906139484, 161.91402794784827, 84.37504184514408, 111.49026116125683, 116.7693240641745, 57.49358838611845, 65.39770545554003, 64.45626151488942, 48.41864318096432, 115.73946503396147, 65.73364344671496, 74.83130737800697, 100.40580201958873, 143.26011406240318, 48.51993926376094, 79.10266261352636, 84.87400578638027, 126.64194501731403, 80.6750068352136, 38.891179167046914, 73.39703099990183, 29.857388816814765, 87.93791860887494, 88.1284038960548, 75.40838410214386, 99.83447520521423, 44.985880981873656, 64.43538021609243, 57.53173468535625, 59.94597931704927, 70.89404252752914, 81.74961070132414, 72.07510811024576, 73.43196308341128, 96.99070693321616, 65.97885397846275, 64.21149575745302, 99.17953076512937, 52.43681090196542, 62.217582341033406, 105.06010425731775, 148.65180242508222, 64.25141464259642, 106.14216520788717, 77.63233895303232, 92.82030678454319, 70.10466185067753, 62.42054975788032, 95.73374691108727, 47.48498853067101, 68.93159394160125, 31.974041190754043, 52.46693943590254, 53.55832938792989, 23.281583981027545, 82.75410057291238, 78.40613991177803, 62.44426350810653, 95.5219961047211, 69.95399308449697, 87.91583502848636, 65.33815132243416, 79.22728809185142, 45.059730514224604, 77.68222824398009, 88.4903805153149, 45.47085904873884, 49.04018222019309, 61.91879495271347, 44.17496664591519, 69.89912089682957, 74.52528226187174, 72.27320242832022, 66.02031963217239, 95.65931827546378, 80.59229939823365, 49.94876985385491, 33.234780003885916, 71.79568933686504, 50.25796461956714, 70.2924392709997, 143.81512492297188, 74.57330242568565, 88.46093179202555, 72.9447413280855, 41.7000988924501, 65.70857996325411, 63.397727919740724, 111.99306967226222, 65.88574697451118, 94.93610915217718, 57.77930171406455, 77.74802160898246, 48.154912827081425]  # Truncate for embedding
baseline = 70.69077378457
mean = 74.48914534479478
std = 24.446435382938287
p5 = 39.690583536046944
p50 = 71.92816561674942
p95 = 118.73810977936405
display_name = "Expected Cost-Effectiveness vs Bed Nets Multiplier"
units = "ratio"

# Create figure with two subplots
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
# Handle edge case where all samples are identical (zero variance)
if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)
ax1.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key statistics with formatted values in legend (use format_parameter_value for full units)
ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {format_parameter_value(p50, units)}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {format_parameter_value(p5, units)}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {format_parameter_value(p95, units)}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {format_parameter_value(baseline, units)}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---
sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)
ax2.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key percentiles
ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"
exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title
fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark
add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from
output_path = get_figure_output_path('mc-distribution-treaty_expected_vs_bed_nets_multiplier.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 70.69 |
| Mean (expected value) | 74.49 |
| Median (50th percentile) | 71.93 |
| Standard Deviation | 24.45 |
| 90% Confidence Interval | [39.69, 118.7] |

*The histogram shows the distribution of Expected Cost-Effectiveness vs Bed Nets Multiplier across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
