```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Expected Cost-Effectiveness vs Bed Nets Multiplier (10,000 simulations)"

import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Simulation results

samples = [9.002646407155058, 0.8349837631231396, 0.68585598920699, 4.094112074873307, 2.721259380531777, 85.59826482630292, 1.179369965144093, 10.621545727911835, 1.3701183870468667, 0.8196467597844025, 13.720336969710036, 0.6836525613531402, 8.03855396374445, 0.6559953882296229, 2.667081284041924, 3.281352323701536, 0.7171125555766126, 0.8283613149358241, 2.1775074744711325, 0.7521694079917839, 0.7635573266578007, 1.2679566384039413, 0.6486310053611566, 32.51702369123512, 14.206996669258995, 0.77768517211894, 0.7036144821738424, 9.09680141011123, 3.966415816787874, 0.7119736082786117, 0.5764253801658714, 3.0044493499625435, 58.8660654544865, 1.5565633737720548, 1.5324833857118956, 13.527632519761408, 0.7575699420889971, 42.834845117104564, 0.8172825784902058, 51.01132682823691, 41.390114884619784, 9.064423731960723, 0.8040445915865839, 0.7284831456887663, 0.7381521279234006, 0.7296088380638687, 9.992062653704195, 0.7291987674397278, 0.6916457855156098, 0.7422765747633786, 0.723731941453391, 0.6955191650072854, 0.8680296200621497, 4.785912124729921, 56.2589844695296, 0.8018156139727712, 0.7711831968406601, 3.8651144463655576, 14.843424856883939, 4.81128401151219, 18.38023187856271, 0.776228866529398, 0.7342894533763633, 3.1789619647589076, 1.9394072810144176, 0.6824013165702157, 1.0634264931244766, 0.786982157014014, 27.74248879161177, 5.193466225634356, 4.008424105727451, 5.943890117074652, 1.2506218546408217, 0.7065031014479795, 35.61221894957419, 1.9573365895299903, 2.7580804133658248, 0.7346424575538583, 0.6959835478328659, 0.7740722112351718, 13.38185520346111, 3.567357345660475, 1.3263869498123873, 1.9233152437526062, 0.8475500022105406, 8.306834576886363, 12.841148615404201, 0.7469105284589609, 0.707854433492106, 10.641551422061411, 6.544862191316739, 3.546863696715058, 0.7836901001257713, 1.1148332304506734, 0.8852897864462872, 5.743907510956333, 0.8575950760970206, 0.8315004439871138, 0.714541669081353, 0.8239736392189133, 31.29005946834474, 0.6427652550947938, 25.406263756858525, 0.6869003190080885, 0.826288045065855, 8.752241699087788, 82.76347356192862, 2.4521577204847747, 3.107712595807571, 0.8881998803404834, 0.7116759302081, 0.8843455418731034, 1.2655741217543506, 0.8671774006277246, 6.88003651109978, 15.805474238525496, 0.7284401391418145, 35.136680088529204, 0.6201809638898519, 0.7681602168872149, 0.8336417746362046, 15.253165478412187, 0.729499513688074, 8.325446087511732, 0.679050585870861, 2.3730299213963266, 10.466465708672429, 0.8469845118611775, 0.8018887823967875, 0.8257093769259857, 2.486917044666198, 5.853657625637206, 0.6952044637548209, 16.382247387686554, 2.4687639967062793, 0.8329964340280174, 3.7134643702492633, 0.6788091639447382, 0.5909300483577737, 2.949919654221024, 8.14777589316391, 0.8308705911436237, 8.650838569269261, 9.177576200182203, 0.816326019571307, 1.2078681648469394, 0.7995714284593118, 0.7598358358146925, 8.06460059884463, 4.237362305404259, 0.7613424440000992, 12.478458793741822, 4.381399266322895, 0.789000081160488, 13.683103311029486, 3.1886731184491013, 0.73701204633667, 0.6673127835150441, 0.8892410555306612, 0.8466790985226382, 57.47025025366625, 7.677112114072773, 0.577724718026398, 11.158832690754794, 13.73379539228185, 3.449512867289906, 1.4330057288545233, 0.715769478860816, 0.9542162265055595, 0.7513969400586765, 0.8031475396028187, 0.710713895079404, 2.7567740910112923, 13.031605164462546, 0.8540713988256162, 0.7334656990803465, 0.6218423856230323, 0.7345208053441488, 0.7579658511270179, 0.7240062924307992, 9.223149496321009, 0.8007830128308906, 12.615433838817465, 0.6576253273766002, 0.7121442279433021, 4.925663496832896, 24.064632643025558, 2.1220705073141493, 0.8611489895523756, 4.189724338806847, 0.6113481110693412, 25.95632605895157, 0.7803063078458767, 8.951126723046594, 0.840418451559616, 0.8230878538264981, 0.6945386816923831, 25.236329135864047, 8.599598473470001, 8.515882027056408, 0.7197006976585548, 0.6345800452599232, 7.683930420208357, 4.281973360347091, 42.04244064507019, 0.7520676065826106, 0.8188350198245917, 21.90572270644825, 2.311530665660377, 1.5200722458996883, 0.6726058411718073, 20.83671172947291, 0.7453839547450258, 20.269669155965097, 0.7756198847136897, 10.83560949479416, 6.917027946775338, 0.639866292359303, 16.173696865702166, 0.8065881435092641, 0.7668511643472525, 0.7276200486527972, 2.042939605552852, 1.079841104380243, 1.3850656256340448, 0.728811690816328, 21.022960370543434, 0.6004754556773956, 22.52609883801497, 40.42052970602578, 14.17050251878107, 0.797777195722497, 0.7215271883881347, 0.6499146438222899, 46.02103045140332, 5.46164087479873, 0.9294154314346259, 0.7616828334286477, 42.692823200766256, 2.9318838473648454, 1.0645043758405022, 0.9581730889082392, 5.964252609848687, 0.8687875887808298, 0.5776479594679643, 30.563989432850555, 59.48171016254163, 0.6032848648774956, 0.48840296950048057, 1.039639013725114, 5.815901746181247, 31.093221969289544, 5.281753037901515, 0.8306514221342122, 2.6109071381787925, 17.726965960884563, 12.011304721315497, 0.779712920009811, 0.7592475940982262, 0.8616734494109999, 0.8868809748794173, 4.017840409107345, 1.0681441009804153, 0.7948061725179795, 0.708613162480532, 1.405562444289298, 0.7349030872798676, 0.718522811308473, 0.7434892448212803, 0.7479554353161191, 0.8087259016809281, 1.2404930371877896, 0.7561639790849668, 0.5812247357629362, 0.6276555033698362, 0.7156952661745157, 0.8121826468173623, 11.74602139394691, 0.6510483082950735, 1.137432145219877, 0.7079041269266029, 3.0181211727669184, 0.6716897291540536, 19.25838650068791, 0.8406917095687773, 8.304890812839618, 0.8512455782461769, 0.7435471475501391, 0.7726215811479135, 50.83011192568419, 14.387837598183216, 0.7658474308063962, 14.002603151059352, 2.2801149779282466, 3.067968797350863, 0.7331370789151211, 0.7231593878442681, 56.64770060100384, 3.3214865503228346, 0.7204968109225146, 0.6110835771253064, 3.4162855371515226, 29.695426902090823, 45.65042811075499, 0.753130484070979, 0.8360333911377689, 12.144132711619536, 2.7385674529329616, 1.3326909114447179, 18.423144707822527, 0.6521082464593332, 5.201122592749668, 0.6098946954898865, 0.7112984567390088, 1.3532087464149098, 0.77299319900934, 2.126240946570871, 0.8067118392966667, 10.822705856092163, 27.910607437751032, 0.6832857109820231, 0.7640462288965759, 0.6525846747699509, 0.6858222785784651, 27.230122595922097, 0.6874449892402582, 0.8767474666273132, 6.36497195781804, 48.24285995793589, 1.9536412112578898, 1.3035061387623643, 0.730386784014613, 0.8672607236958156, 0.8328446311958824, 2.6832738359048975, 0.8492027845626923, 2.8114020707065017, 0.721826315816312, 51.607601638021215, 0.9225977575317296, 2.357680915764133, 4.849486471599669, 0.7419021715322482, 1.654406754949897, 1.1061029807325926, 0.9182375104687914, 1.607135746569036, 14.731512976208851, 5.561869409027539, 5.549668563446931, 0.835699585427512, 1.637301424932893, 0.7961180444073154, 0.6807617042045158, 0.6605768402643498, 11.612587872904403, 1.3556500127812348, 0.7252967260835869, 2.080257166179938, 1.2749541476616213, 0.7608263372972845, 8.926860363813374, 1.3970505695398807, 8.814993330405068, 21.280826193676354, 1.0765608897617727, 1.6856338623399594, 21.423020935008687, 14.393386939316644, 0.6783082829704747, 2.5204618040283076, 0.6405059167011269, 0.6773160708346563, 0.6785135359058325, 0.701825846933456, 0.7344512474969405, 0.7652718413843573, 2.9202759289112223, 0.9119172471589048, 0.7865901295632257, 4.544504611386167, 0.641979910704661, 1.6558718335510576, 0.8519910685367168, 0.8789342180061, 29.68806180845723, 0.7112453121699599, 10.31873961859806, 15.690754971540269, 0.864610823349229, 21.451021569723714, 29.664611514641326, 8.741947047897575, 1.3385946643403124, 8.377865118565078, 8.626208867710709, 54.930536535474594, 0.7287295660120902, 0.7037987308312795, 17.87304479852445, 0.7631138552358093, 5.7174889206562725, 5.449539673387687, 0.7811968585856681, 61.01129307057527, 12.49370836998616, 16.49538823899013, 52.18470488883132, 3.0072025851270165, 0.8555333056992082, 4.637681003399586, 39.955891210746074, 0.805111097386029, 0.6859380748795502, 11.416480320506896, 2.2740862964212125, 1.3777830836973377, 0.6406025893085955, 7.4460998010170965, 0.6386410555132853, 0.740213999649864, 5.9223305244965525, 8.343175595235392, 1.641034831930601, 1.240274793209728, 1.1411944664831486, 1.8829288915643803, 0.611556129458733, 1.520434578576251, 0.7151169346941542, 1.583241103518642, 3.2142010957541145, 4.846888892014848, 10.881186130413699, 0.67162159404063, 3.7052886778707403, 0.7930050204900707, 1.3696448158904317, 17.00654886147304, 2.561920612128015, 0.7639274182835998, 1.031822155111551, 0.7176790828950653, 0.6411357004059831, 0.7768959966330174, 0.9338715116848005, 23.349491267586902, 2.250117127814055, 9.07083496506749, 0.7158999034546522, 0.7590208974863487, 1.2182651205140558, 8.758235734593542, 3.152123030233922, 1.2749461704280964, 31.447990323418832, 31.285437487852825, 81.9036136208025, 0.7200749870785196, 0.8712952367578559, 0.7216683457925932, 2.334662583188235, 0.87805998939152, 73.12118365852525, 0.8412526930137728, 49.30540522283518, 0.7727077671805171, 0.5962607384590345, 0.657648330489937, 1.26997914937028, 23.90570253075967, 0.7823220450962916, 2.1024006829814326, 0.7628443124140218, 0.6965069735093496, 0.7765981459838205, 2.06810538862598, 12.251126773727185, 13.067332703798582, 0.5251323538376147, 0.7292418682730635, 18.507834623980628, 1.3410552329157976, 0.6996429632009161, 75.27475646136514, 2.0295708799419265, 2.6957907949209012, 0.7120165500678369, 0.8195221681212028, 0.6927282960140146, 14.380614758017579, 0.717296649693382, 0.7721213393840799, 44.640134374359114, 0.7740153316765157, 35.44667670405102, 0.8956381532431538, 0.9100492519449902, 0.9086270048785017, 2.3966444515667837, 8.541449034255379, 7.889794364080906, 0.8085526100232303, 9.389978792493059, 1.1948080087945323, 1.054889418850098, 16.645013613663853, 0.7817054325196485, 0.7951628543419599, 0.7091455851343214, 18.051677661703863, 14.917987960465824, 0.7395966784471844, 4.011508395021823, 0.6826056012630949, 23.175488706816985, 8.174323666904165, 20.177993965252686, 0.6740443037725564, 0.6181992530388688, 26.900666446457524, 0.8225081744466793, 0.6399885746206319, 0.7641047529847503, 0.6348549589233091, 0.7853120852286394, 0.6310198965702676, 0.7369104463351471, 25.84729420734379, 4.549040712829817, 2.9497316691493096, 8.857993266074532, 12.919700356977069, 1.693908498917909, 1.297588000339073, 0.6950154997439107, 0.7934145966388814, 3.181630480462647, 0.9970367132349788, 1.203979452112156, 1.981022607462404, 0.8174274219513608, 0.7271885406419886, 0.7630813590009357, 0.7693446959750871, 2.6560489697430576, 0.7703896977893888, 3.0119543785277982, 6.132253790966936, 20.01169358691214, 0.7157622721671755, 0.7016277804316791, 1.2538289832974736, 0.5870460360296619, 1.0053431616195374, 0.7902559513385872, 0.8113896146480372, 0.8343555286698396, 6.360517361770969, 4.6002356383715055, 2.399520674948585, 38.88737004318909, 0.7436585519316087, 81.23887882681234, 0.6738557408067202, 37.29468435344968, 0.7614280227322046, 7.4095182285317795, 8.295702887867368, 49.48702533828561, 10.689250194206112, 3.1917362225096335, 2.68458558260301, 11.668173765987678, 0.7320211978011975, 5.619557644097092, 3.490031015240759, 18.03971120158634, 0.7692720297179982, 31.695454099694494, 1.002030635328837, 4.2331750849847065, 32.328526068615744, 0.8375940473207325, 5.021040855808558, 0.5908725076095629, 6.385959880467233, 0.8183577400164513, 0.728208605722293, 2.3678881268899055, 0.8496657397215639, 3.5779378188266677, 45.38906340699883, 0.8826774101679281, 0.8543186801060166, 0.7837160985690904, 5.960149589077584, 0.6808549729789712, 3.0443498969399996, 5.198134536661337, 5.7519377261682925, 23.086108863640735, 14.634256337723839, 0.8008698357235021, 0.8016261192151809, 19.448729274751994, 0.684849932749963, 0.7105465470278544, 0.8851627292397248, 5.561289819040804, 1.9777547940223803, 0.7282229919771394, 18.45658860072802, 0.710693259701395, 1.8707225884870011, 0.8544422507736787, 0.6888163194831283, 18.675066390563103, 15.946473569221551, 1.006097200047279, 57.314854426987544, 0.7452597409904814, 0.7254159415504022, 0.8002059678687662, 1.5573924492986486, 2.190531699020306, 0.7827066977112435, 2.1572249057006085, 6.555192787979598, 1.0029445963553183, 0.6195118369709872, 13.121633777905135, 10.74731644919942, 0.9029564597646866, 0.7741682721723635, 0.7721191629522169, 2.5398750295272574, 1.1639006914079038, 0.6997424286787283, 0.7042550555931674, 1.3237976700033764, 10.972608674988827, 0.585273208617523, 10.009022843030326, 10.677416995827164, 2.608603426196143, 0.6968262763240884, 14.012309625870142, 10.722029321961612, 0.7809203358261606, 0.6025154119362182, 0.7626545462827862, 2.0342492280925932, 0.8401515557634258, 3.289280996563141, 5.176691414957299, 0.8209692024466027, 0.7330630901441693, 0.7825422117435414, 0.7752921220215235, 1.7623282600031729, 0.7494418877830685, 7.357449579786829, 0.7768584065546235, 1.160222057102003, 0.886626407590304, 0.8800047623324775, 10.451426784513174, 8.866047145079886, 1.052680006518242, 0.8317364007832323, 3.964817602873288, 0.8080850072500966, 0.8571343811659383, 2.188431834408968, 0.7187225608205314, 3.578776545497032, 0.712852528533147, 29.43181944659361, 4.6955190217104645, 3.041677080502711, 5.823651453577315, 18.72826156896769, 0.7919471826825679, 4.309154697096578, 6.658950630397583, 30.977175563686156, 0.6277964111553781, 0.7866862845124583, 0.7838145204659273, 18.834970626258105, 37.87786545771288, 0.6697384681586309, 5.414104578751236, 0.8174668229623875, 4.553388368577025, 20.55126991556738, 22.257760768133792, 5.353718141016999, 3.466135640373532, 10.866884273947555, 1.6571125365991726, 0.8342375828379249, 7.940938656582862, 8.670497654111623, 10.6966641467392, 0.824393176755631, 2.775917135338879, 19.60889337095393, 0.6942002564517249, 7.4419903087169414, 4.959087157458488, 1.6293542083767696, 3.2072378293437684, 0.7657388016536777, 1.8205455451833936, 0.8761045403651031, 23.536324631715633, 0.7775854534091013, 51.45853521666789, 44.69021071574727, 0.6559349670696232, 11.90934414659225, 1.2447365470689604, 45.67379460401694, 0.6305624578547239, 0.724276180219715, 5.87571260177675, 0.8430870872533199, 6.671516574677482, 0.7105701274689266, 0.7430588074419094, 0.7022666662056767, 7.45807613831542, 0.7246464645646742, 10.26646954553234, 19.217990431387744, 17.19273438274117, 0.8803178142136593, 0.9512952127694156, 0.6658142282854843, 0.6513119825037204, 83.34075675409974, 24.55432844916083, 53.73787084509875, 0.6714199429946526, 0.6060684641953814, 2.344328445836468, 2.671795480869851, 12.953344526940691, 36.744262446441304, 0.7732207158826796, 13.80682390523829, 0.5856681329135927, 0.6069517111258178, 0.6553113852542978, 1.1773169583976297, 0.677457902944051, 0.6948399616776839, 40.425471954474695, 0.646550056665, 0.695186527258017, 0.686698503669038, 0.6950614862823892, 0.7194334376345635, 74.88813280256069, 5.7394403890300065, 0.7948788331295344, 4.811572764457206, 0.6143629893817593, 61.09655095422875, 0.6382151632776265, 0.7265586762889968, 0.6388649641754518, 3.4877516051363338, 0.730937477722542, 1.2893910523889094, 13.173750652175002, 0.7428812699878422, 0.8560198411360882, 21.78298259609163, 27.083787808494645, 3.9206767333404273, 0.8700700573319452, 0.7469988151011349, 1.61050649357912, 0.7442413829087672, 0.7650819873445796, 1.014197237683894, 1.8209670127555986, 1.0418287245987914, 34.36620762881405, 2.1292878402911857, 0.7152463844122686, 9.193723046702246, 0.7583073783782636, 20.77286366527391, 1.756843762024085, 1.5333383716761586, 3.6603497906486115, 22.029135461721328, 0.8385309211304438, 40.06551737482414, 0.7162394846150457, 0.6436716617583524, 0.6581168725179192, 6.712088657671022, 7.731540143251255, 41.716499899152616, 1.1182423602597336, 13.669033309744291, 0.7967016817666395, 3.1128114254373784, 14.609240263245288, 1.5479066901127554, 7.415060580336743, 0.7818930212584377, 17.514834205422574, 7.4515931900428924, 0.8852354289669613, 4.917363259761696, 3.7370175068415272, 48.83898804339626, 2.09770271893231, 0.8977741705385502, 0.7455119901058161, 0.7453599067726211, 14.843679139979617, 0.6492730941190183, 1.0894567672382005, 14.252061568229129, 1.5177470185457602, 42.45338058169999, 1.5671708558111181, 1.5432765674695048, 0.8230564547374103, 0.7755007264860708, 0.6330800526617132, 8.4513084331772, 1.4394682039315911, 0.5985010325340467, 24.449498396683047, 0.6091966729719499, 0.7558274974446036, 0.7369463442542893, 24.585602874476233, 0.4441755911922261, 0.6777563825359754, 2.7953462648234364, 0.6683981049699412, 1.0761091522174402, 0.7892899352369607, 0.6731861941644484, 10.114805450616274, 23.587037565852555, 0.7467849979522861, 0.8880554345999786, 25.22061587198763, 0.9905929957491568, 3.627398030638396, 0.8302558172090663, 3.822337795940502, 0.7528848418817046, 0.7408982456083261, 0.8634641415593884, 1.9528273695255358, 0.8591207431256185, 0.7823107000390475, 9.378817185641104, 7.672174804877544, 14.160661869559268, 2.31392425869806, 16.15922189345265, 10.3581399313266, 2.9582403058446722, 0.9044376139567188, 0.749000151119332, 0.766606916714201, 1.4424057248488424, 0.7503198327575467, 0.7290346370816086, 1.5423588536973012, 46.39505864518611, 10.460657630872744, 14.777490548836244, 39.519949423597865, 0.6469115243107267, 0.7843681579918993, 6.253535458722149, 0.8865055689304163, 0.8179912419317175, 36.603591321182215, 2.6547850901403893, 0.7799161663035614, 11.930645808121936, 7.95740485981978, 39.016084053189225, 0.8204133189834766, 9.962211686176957, 6.397362132294056, 7.715783629792316, 0.7393384250354459, 0.7603974145183838, 0.621169130673748, 0.8004189829008982, 0.5845090285341018, 0.7669840058291457, 1.0176799044722118, 1.1074559695225328, 19.904211025925925, 5.7996413479012885, 3.9671251131241143, 0.7017057382863988, 2.605278577289558, 15.031380273187478, 1.2361966615982678, 0.6324201910400837, 1.0737387835064216, 22.627546574190827, 19.47638193700545, 3.302691292975335, 0.8208005521565876, 0.7379389785991122, 4.134624082524524, 0.7619777051977269, 60.01017810715055, 3.3379792766300596, 0.713381549432631, 0.7675616153377421, 0.7415929302108416, 0.7474558922523458, 0.7105279980001098, 5.380198450003937, 0.6168568813389131, 1.1770235472624115, 0.6989258550560349, 1.626568359053136, 0.7553700608530777, 0.6706704224897834, 3.393517945495802, 0.73020057350715, 8.534326921965535, 21.21703574953201, 4.483357075611615, 0.7237119698667924, 0.7779861118070079, 14.083982928908167, 56.92234142174723, 0.7159406267545025, 12.064168232658412, 22.97492018558421, 14.948353126612094, 8.04849509775002, 0.8448756669634431, 0.8079370916843654, 3.01593559720553, 0.7888082674921475, 30.326283746563213, 0.7481242244317231, 0.7138578014122536, 3.829510346968095, 4.318731113869062, 0.8319166622347302, 1.690039465069311, 1.6255600939224997, 27.97485128292627, 12.337417342279165, 0.81044570787688, 26.705875454732983, 1.9477941681406639, 19.663912685295227, 2.201415974855996, 0.7292383359204968, 0.8084106645520194, 1.5767041777817663, 0.8351141664738104, 0.6577506923507777, 0.7827656197779872, 1.6821369159816386, 0.7109004467354485, 70.92866289188085, 0.8736340749774111, 0.728706981102947, 6.378327671185126, 1.8833672774663666, 0.6954626774073347, 4.738768637947818, 0.7202437252769771, 0.7735040845215589, 0.7887038434253739, 5.970750844095796, 0.6292150342325905, 0.6062974959274751, 0.6415803234975717, 0.7572143651628575, 16.362396736662102, 10.575979604647358, 0.7377751794419923, 0.7369709752565989, 0.6799605789651143]  # Truncate for embedding
baseline = 7.069077378457
mean = 7.6070454009006
std = 13.577563911791296
p5 = 0.6469105844844047
p50 = 1.2250472532994805
p95 = 37.445097191850685
display_name = "Expected Cost-Effectiveness vs Bed Nets Multiplier"
units = "ratio"

# Create figure with two subplots

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---

# Handle edge case where all samples are identical (zero variance)

if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax1.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key statistics with formatted values in legend (use format_parameter_value for full units)

ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {format_parameter_value(p50, units)}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {format_parameter_value(p5, units)}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {format_parameter_value(p95, units)}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {format_parameter_value(baseline, units)}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---

sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax2.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key percentiles

ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"

exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title

fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark

add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from

output_path = get_figure_output_path('mc-distribution-treaty_expected_vs_bed_nets_multiplier.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Simulation Results Summary: Expected Cost-Effectiveness vs Bed Nets Multiplier**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 7.07 |
| Mean (expected value) | 7.61 |
| Median (50th percentile) | 1.23 |
| Standard Deviation | 13.6 |
| 90% Confidence Interval | [0.647, 37.4] |

*The histogram shows the distribution of Expected Cost-Effectiveness vs Bed Nets Multiplier across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
