```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Ratio of Industry to Government Clinical Trials Spending (10,000 simulations)"

import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Simulation results

samples = [17.290538605066118, 19.090195875012636, 16.730311474412417, 16.496615775204866, 19.42643323346153, 19.46120805701434, 17.517723625872907, 18.100629572458253, 17.70560074512022, 18.829786772166177, 16.57146650293702, 16.696511866430125, 17.597777186087963, 16.270142475927504, 17.08390792468946, 18.838436258008578, 17.208981016467874, 18.976803487465993, 16.572628701818086, 17.74889454796601, 17.92629341051306, 18.593015634740254, 16.155658349131187, 17.886269552840968, 18.250630912487367, 18.1485340483197, 17.00230910129553, 17.213183755876617, 17.153173606969293, 17.130271379235346, 17.333333333333332, 18.22121310968138, 18.363703088227453, 18.775512186957638, 16.897492243817233, 16.268056123899324, 17.8328544167135, 18.811959328012463, 18.790297056226848, 16.854309436647014, 16.73921942393338, 16.988688506957075, 18.57194164686733, 17.383391987962874, 17.53214510297391, 17.400685557726067, 16.581242085887634, 17.394385119245097, 16.81905462599499, 17.595767574233424, 17.31046011504611, 16.878380480351908, 19.683716598221288, 18.10520065250322, 18.307201964125806, 18.53559777650438, 18.045919195748926, 16.111451004395935, 18.847491376355496, 16.462807190741106, 20.012122890946497, 18.125497079900665, 17.47265846870229, 16.9346999608396, 16.778915133657698, 16.677310609511196, 18.143979516684638, 18.296397129255883, 16.597756705493953, 17.934804411357923, 19.42341053755787, 19.221444381171406, 18.92190528355818, 17.0465237712973, 17.498883567527233, 16.804669647978375, 18.249186445951658, 17.478091254594784, 16.885491362464332, 18.091438989401095, 17.097460446618488, 18.56704703122762, 18.163133440378726, 18.18813804495504, 19.309916007713927, 17.059360295623797, 18.305894540608612, 17.66739535083414, 17.067208905259385, 17.110403727968343, 16.835886682890845, 17.81254272576134, 18.243874848499804, 17.787918441308882, 20.018671145216054, 19.66922373518267, 19.49053192112553, 19.030362591522767, 17.169598371562827, 18.902486801746896, 18.183350693472168, 16.064085535281254, 18.154054717512626, 16.74632545264367, 18.94161015214942, 17.95349039083035, 18.964453926337704, 18.131034640237512, 16.619468989087906, 20.07740906279057, 17.125713425005287, 17.37624160643472, 18.47471046619416, 19.66770247780448, 17.589862876200424, 18.387028954357202, 17.3827314007269, 17.655207545263497, 16.387433891439553, 17.998409772929357, 19.06709304824453, 17.45136943530146, 17.39900578621897, 15.992828070147944, 16.62586066211213, 17.224084300745712, 16.03056647313721, 19.2998877769587, 18.536789001779994, 18.931812258325706, 18.19895066033537, 19.567881228098617, 16.873561420772756, 17.97570649329378, 19.70343095171792, 19.05600635963748, 17.279312848238497, 16.622151825940485, 17.333333333333332, 17.333333333333332, 17.151049319195046, 19.019589189101577, 19.0, 17.33783787166389, 18.77436444002978, 18.2332125819373, 18.499118366089185, 17.868169507825208, 16.344138415550255, 17.480014313904377, 17.89168156091806, 19.084125140946757, 20.00012069270187, 18.32868616434554, 17.753941655027262, 16.8255056028314, 17.51457811122317, 16.445191597893764, 18.346214084775735, 19.29447752519862, 18.985497051176633, 18.653681123133016, 17.333333333333332, 18.786023392551893, 16.621705837616116, 18.89894252377274, 16.50759904442408, 17.1884050914728, 17.889048841631343, 17.73690805733444, 18.557301446031445, 17.11098385487727, 18.28647666690169, 19.35215181798613, 19.426619655070635, 17.459983481219787, 16.328457330538992, 17.476218944156752, 17.839020932039553, 17.31466907105485, 16.056020816426404, 17.39979446562029, 18.227267051318645, 16.295414998774792, 17.13288392182274, 16.216362605055927, 17.446272234524056, 19.350537271586376, 19.555644838749007, 16.515886268560994, 16.707731974176767, 17.919237041178658, 18.190079156572324, 16.025826818889456, 19.184444268132015, 18.88755767329643, 16.863365667421146, 18.205377049980047, 17.690359850326097, 17.898021904855078, 17.248643617608185, 15.935650059225985, 17.565934166019233, 16.862602703935522, 19.125409785163548, 17.747314584359135, 18.81620990606674, 19.342505771222758, 18.86456581742655, 18.12448054724448, 16.52675683648215, 19.495813943338206, 17.643780641236997, 18.325801644214028, 18.115873102351472, 16.42083597583092, 16.99501561142891, 16.018688864795756, 17.886238178577784, 18.61355549938209, 17.977873384790872, 17.370136415160687, 17.45484959090806, 19.152551891727246, 17.566057423556952, 17.38843869086631, 17.333333333333332, 17.11864038252684, 18.830062763598107, 18.062197441315565, 19.69279292488619, 18.470031522421788, 17.276645289713645, 16.175650364683875, 18.658973349152003, 18.55642620122778, 19.0, 17.896997167415606, 19.121670361694882, 18.38695686223233, 18.862775281330013, 17.806999063908748, 20.026408605444647, 19.697997276832037, 17.333333333333332, 19.44014589941726, 19.16999611351959, 17.01061368299582, 17.333333333333332, 19.275539369817448, 18.170082712911793, 17.24357415422238, 16.721081103515093, 19.015843623530987, 18.006263770252133, 16.69707303503181, 17.125280251172804, 18.18066455237292, 17.858996183053804, 19.565311441493154, 17.99684275729869, 18.034285628840507, 17.38338099711302, 18.422015606123267, 17.078823436441787, 16.40873308256138, 17.482102827596428, 17.23059066740446, 17.614496349512102, 17.683569941819464, 18.648650513309704, 17.275511036161333, 17.81096871907126, 17.333333333333332, 16.313577375350118, 17.187268281485668, 18.70564076718606, 19.192004430175714, 16.193293178748107, 17.344189720779276, 17.067969583212214, 20.067833336419074, 16.512651643725857, 17.10043502209757, 19.18921325794056, 18.3087545167684, 17.34295049849845, 17.61539088183255, 18.068568081037604, 17.81911225654539, 18.015152548873075, 17.48580105747669, 16.051465350092506, 19.0, 17.995088158215303, 17.45492807694532, 17.301677147804384, 18.174987575429558, 20.029578544443574, 17.260847505571714, 16.717505535860795, 19.794740854079276, 16.59057079026155, 18.117009974420373, 17.763815377244555, 19.10831151187435, 18.124924654768176, 16.063113419210875, 16.93916537233599, 16.730674745759092, 16.209777485725684, 17.11981559196185, 16.761564246036553, 17.119933857958863, 16.634625114076144, 18.074424253145636, 17.597108596620213, 18.615583159736662, 16.436860385250583, 19.285074794014463, 16.690882869536804, 17.933941152161204, 16.217183536427566, 16.72979449834976, 16.966789958502684, 16.754676219276053, 19.85022314810524, 17.77118802839046, 19.27616279909272, 18.37186343390412, 16.153239165702068, 16.870589251248443, 18.617645797009494, 19.053400633864936, 17.640982559407973, 19.339307511937697, 18.579634207646478, 17.28123212830108, 16.236341819116074, 16.9065103383892, 19.0, 17.290985838377253, 17.589987342475343, 17.151706977076106, 16.425051162950464, 19.086067398442243, 18.470570186393456, 16.92883805896646, 19.864130569095504, 16.06285076650721, 17.209481945297043, 16.61175339321031, 18.443194945929427, 16.652140420842187, 16.34112301703432, 17.382472492192978, 17.380518855840684, 17.334469991407595, 18.844048334078714, 17.877044110563347, 17.88362439520271, 17.190381763105368, 16.424403036279294, 19.116224716750942, 17.847398956831235, 16.0769273934306, 18.678883726277142, 18.78721559994919, 17.42173590559198, 16.614456231421798, 17.6687868923579, 16.028713485650414, 16.599208331675108, 16.61760989767789, 16.97493125377523, 17.333333333333332, 17.953125479589502, 19.26650258011344, 16.393881015263844, 18.29013274316143, 17.5435372561707, 16.05179683210456, 19.894243374227834, 19.389174641559254, 19.892812019140333, 18.748429470584256, 17.119120167646805, 17.012515639314383, 17.32688244545707, 19.61973724212755, 19.0, 17.61293975508433, 18.30909306636278, 17.094163539025626, 16.790424812371167, 17.50428652419075, 16.718334997270418, 17.38717714738282, 17.00512928423008, 18.625510087173673, 17.919358782452694, 17.428847161187978, 16.643808441104472, 18.20421907815369, 17.016313253395715, 18.033556740441693, 17.837579764392125, 16.632741120966532, 19.29828030653036, 19.453059783842296, 19.71987929379174, 19.0, 18.589371667886226, 16.73157033742279, 18.058872745193547, 17.42754305254248, 16.316033326380378, 16.030228183672712, 17.774050414986924, 15.999472666672927, 17.56393657236356, 18.808145869132144, 18.475050797877536, 19.717495043262762, 18.878408648256336, 18.156397858433024, 16.664684593389726, 16.700054062936132, 19.57577108136954, 17.178409512101062, 19.090980840216897, 17.074838590265642, 17.855395023780464, 19.79723897863859, 16.511602382602756, 18.489463958162684, 18.392993434340575, 19.131977835393172, 18.556612965252654, 17.1339798853406, 17.9320823822777, 17.259998085729816, 17.217661444283877, 16.03857921716646, 18.13604630365331, 19.712176720611964, 16.342634858952984, 18.12096353468589, 16.285394763320475, 17.190403029142118, 17.85546197811445, 17.234383262226437, 17.321011411487326, 17.333333333333332, 17.59342897002691, 17.475962366832633, 16.331723584066907, 18.819571918194253, 17.254380996637337, 17.717434362947223, 17.278809752683305, 18.802576264199963, 19.875743646628745, 19.05677470573052, 19.199013190713142, 18.291446558004743, 18.069926093250476, 17.283237936961925, 16.295771496922768, 18.981277303138544, 17.235741734247235, 18.22210281821639, 18.058180782539768, 17.44358023893094, 16.893505994704746, 18.13133560142239, 16.34671532035025, 19.233657020366554, 17.675415978620872, 17.333333333333332, 17.395047303617982, 15.953999376150804, 17.564722342026652, 16.94151695104108, 17.757869476749192, 17.90720993800111, 18.728242885869733, 17.130928912092028, 18.827701645784362, 16.835637569303458, 16.320783989630424, 17.211801669382133, 18.060688026589315, 17.101009504113023, 18.090541653234432, 16.502743858638667, 19.795680947657175, 18.126461271938492, 19.30511617354108, 19.738506319666282, 15.987285085622528, 16.55211708502594, 18.645801435203357, 19.749281282369907, 19.0, 18.40598455971199, 17.333333333333332, 17.125130734817475, 18.427770569003243, 17.086973977779625, 19.834103467815385, 18.075425903702023, 17.554415333341517, 17.796289136314517, 16.680445902195647, 17.239640689461748, 16.832226261687044, 18.603195595996834, 16.54889516226332, 16.458295329415268, 18.992518011923092, 18.87780073067516, 16.020605731064865, 17.93485682366925, 15.939977124326473, 18.26972897024911, 16.00951939762157, 17.513013001364122, 17.349977919101946, 16.291197626250238, 18.161417121497685, 18.952057117912297, 18.277838119202386, 17.10307083718245, 19.841085039414878, 16.87066771096353, 18.399587346968165, 16.24536548835318, 19.0, 18.73799807109976, 20.017400421602282, 18.79271185992368, 17.363510450323172, 17.91885071444104, 18.017010813480535, 17.892406778088052, 17.420344799293424, 19.046150439949198, 16.784346903934523, 16.839271744493104, 17.188294691280127, 16.971899485139314, 17.30113556978191, 17.333333333333332, 17.7975924914634, 18.08842355482033, 18.69253925342375, 19.079372454407594, 19.37896670533952, 18.87932910928226, 17.77607152942725, 17.2528207350996, 17.617112045389682, 18.709049089124328, 16.545993767770412, 16.743975981510253, 17.893017837499865, 18.55474708959693, 16.982068927286736, 17.4401721395958, 19.670687643091462, 17.77253361675449, 17.345103097057954, 18.89445399202491, 17.43776593610292, 19.680348617799446, 16.020128488765547, 16.125263273462284, 18.015869130659937, 17.21571310473615, 19.0, 19.254015203746427, 18.070707796659715, 19.135322943213996, 16.7749823279741, 17.333333333333332, 19.282683928092506, 18.80823597647991, 17.379175209009016, 16.41176437870024, 19.34756239287385, 17.361754448578473, 16.968546235832903, 19.966550000685775, 19.43108457914431, 18.24428890744895, 18.37498482972908, 16.653572512245663, 17.37120963061305, 19.972211657603616, 17.023553237609846, 18.45214646159172, 16.093623338532957, 18.52021053151551, 18.532513219304786, 16.991228028050944, 16.714881075061527, 17.10842173647227, 20.016123099512384, 16.995117335121012, 19.082238972527872, 17.379396164157765, 19.6355278178238, 17.110667929965746, 18.76561369440931, 19.433316875447897, 16.775697319060015, 17.37122911684464, 18.501676958901246, 15.999672438008576, 18.26719638740684, 17.64185998051388, 17.336299616428576, 18.50942164047121, 17.07933095171346, 18.392387242730905, 18.22822128132823, 15.988731043483824, 19.091039890357777, 19.0, 16.41129723065435, 17.333333333333332, 18.219676183634892, 19.469909048464903, 18.09295458164167, 18.060653727467933, 17.932980219320395, 19.193380678820017, 16.943039578451696, 17.012113955946667, 19.737558015515923, 16.793848132951343, 17.333333333333332, 17.460792042408777, 18.128754414460428, 17.869766002942782, 16.89839492384043, 20.08233927244324, 17.470547305651966, 18.199827179911537, 17.040068718912366, 17.912178908470114, 16.560430728300187, 19.179789099406005, 16.933402221239046, 17.27180490541061, 18.851946785290856, 17.45378992608858, 16.167662591425124, 18.110695580635312, 20.02546143428385, 17.706595116895112, 18.898242481955794, 18.135451721535958, 17.790370017773803, 20.045558934564898, 19.913791039371333, 17.065544333906008, 18.377865611376247, 19.0, 16.687804262700382, 17.331877084025894, 18.638117362784556, 19.482140076989992, 16.62500371506698, 17.233651879947452, 17.333333333333332, 17.143729866557802, 17.184911852473107, 17.902618912255626, 16.648429928266125, 16.886121978391074, 16.12075200130531, 18.37597805335459, 18.260144918448074, 18.31896964602115, 16.680451332144308, 16.120250969117745, 18.291668990505087, 18.245856506106968, 17.278594145477328, 18.00690533168606, 16.4825921882709, 19.0, 18.79336881536969, 18.732282901166933, 19.0, 18.98343518869953, 18.915932915578153, 17.947759767573835, 16.287357090728953, 18.00597567101606, 19.07734205728998, 17.75809379338203, 16.36449415502935, 19.000625352148717, 18.90956623843913, 16.969371647831714, 17.974797252561807, 16.858182762739585, 17.701483229834245, 16.79078485612472, 19.083318289535367, 17.69944444247946, 17.96043952323305, 19.338357568653777, 19.837767362971903, 16.81055599615425, 18.146955605975553, 19.065388414045227, 17.809514597383625, 16.269205199176437, 19.0, 19.740790177589776, 18.92668060095226, 16.025150059057957, 17.318809825168266, 16.709453441304483, 19.23114739309706, 19.202046777146034, 17.10878274232372, 17.607847343092764, 16.98167875875198, 17.93000364689408, 17.324491355041328, 17.478633678027403, 16.696542182589443, 16.660464777139467, 19.919942169647467, 19.0, 16.42206694635551, 16.197394883867418, 19.063067746209192, 19.707330697869846, 17.554988545959002, 16.508496882936246, 16.904872214269794, 17.02243731842233, 18.174722759742956, 18.88534204153098, 17.668754011931075, 18.078010572221615, 19.055290865558227, 17.333333333333332, 16.871583650016458, 16.259530084304732, 18.923849270229617, 16.601388219192508, 16.86797954028184, 17.115441938541426, 16.123213310056933, 16.873286747376103, 16.743231038610247, 16.871371924484727, 17.244547115219152, 19.945064477356922, 17.574959635367744, 18.42318778067235, 19.42933328691846, 16.5970998676879, 16.721871174126708, 15.992788904254773, 17.353840045000993, 16.002985714879408, 17.66796982086829, 17.421104542547827, 19.165331295894312, 17.173127666006465, 17.605105298010905, 19.461882958889795, 17.750557992864405, 17.787933327613395, 16.904782773880395, 16.553307380969258, 17.668761637320692, 17.362073300817645, 17.626118002280496, 17.950152545871354, 19.149794175803507, 17.881686308757008, 18.682331322196827, 19.387279781721308, 17.028822755627605, 17.18039233809515, 19.935354285490995, 17.844341748430406, 16.429417429704184, 16.352318837565672, 16.392798693428357, 17.633007854895485, 18.818720276731646, 19.15158251526908, 17.239692017271896, 17.19560512143119, 16.07826000794799, 16.303032114649334, 17.856897890920113, 19.37858851532086, 18.10444782041569, 17.402557251293725, 17.949053883495033, 18.452628709693602, 17.356823069345385, 18.35250989377567, 18.520862483977233, 17.281942336175405, 18.215281471176567, 17.36807547815823, 17.330809753379853, 19.23011398659322, 18.32185244145328, 15.965587400078272, 19.262119071104653, 19.0, 19.701099200705656, 17.64576053302974, 17.643408790137673, 17.837670068384213, 16.165660612222204, 19.0, 17.174468875683687, 16.282706589396902, 19.21367476300467, 18.18555179133769, 18.691665641752106, 18.88702890055652, 18.113990638762104, 15.9394590583789, 17.01188992329686, 18.126904257789274, 17.19536330509519, 17.637347496969575, 16.787535021323414, 17.805733924839434, 17.513565991398394, 17.213145103467642, 17.333333333333332, 16.60597542261677, 18.62905962429469, 16.461930305541035, 18.161500113671163, 18.33333023948563, 16.535689988755657, 17.643189796581062, 17.323938644865414, 17.665452819056416, 17.24990632746745, 17.137681530811278, 19.469513927307837, 16.834408488821662, 19.00908691595692, 19.66228154032191, 17.76000092650214, 17.574493045989463, 18.610220653936167, 16.63087953870561, 19.51840195889599, 18.221922400014765, 18.46210722895997, 17.74452643293069, 17.323569867667427, 19.04525074790071, 16.762722402037447, 17.60170824310674, 19.60799064789586, 19.40333144690824, 17.699750665328448, 17.974044025591112, 17.819022742352413, 17.72020342972961, 17.39186360982476, 16.487966507643623, 19.19016326823634, 19.27611242226508, 19.16512369391541, 17.310719188508525, 16.12885233157012, 18.254677505580478, 19.0, 20.043121833563248, 18.802117316892506, 18.425271296607875, 18.223860826612693, 17.63343970712639, 18.09463676358373, 16.364292996470063, 18.58629971299705, 18.84262563339245, 17.069568407931854, 19.797325267833006, 17.18238825566364, 17.550432927946602, 17.876930559682226, 16.35230923388854, 18.512882422556643, 17.333333333333332, 17.979956426196274, 19.425306540915248, 17.592730266890452, 19.14110246945967, 18.690104402634642, 17.173074402311645, 16.973092785889083, 18.51282829691113, 16.43951203350332, 16.233700697017685, 15.961839748169643, 17.00594772168542, 15.987799054388264, 19.64242411010989, 18.10284784105972, 18.84911783435476, 17.52886015025051, 18.443880979424357, 17.901603014329282, 17.13310944493173, 17.90630239151118, 17.15183108609091, 17.989016248547415, 17.585213843868576, 17.675836168101508, 17.108137759238375, 16.224322013476385, 16.506618652696712, 17.2842809215316, 16.93053916378784, 19.246265991252578, 17.798619176805992, 16.496951889708228, 16.587943020277436, 17.409778494527497, 16.56288921161103, 17.05457875740862, 16.18230130636732, 17.310153729315306, 18.153298575309734, 17.250851255689664, 19.0, 17.19102685551893, 19.0, 20.07173610556078, 17.103785131682976, 17.07126617260263, 19.26261298078103, 18.635687802513928, 15.979368865850821, 18.32561375954977, 17.333333333333332, 17.686183550959843, 17.159124626104024, 16.426785864148133, 17.513605671026934, 19.037489366685744, 17.82730861188744, 17.730172441328424, 19.5507426149356, 18.0202687471025, 18.67696635605285, 16.516417387459576, 17.638602216214775, 18.05609519858573, 17.82265045725415, 17.39499302969345, 16.896449567795536, 19.033809367634127, 19.092444328468407, 16.29735787099522, 18.229158727862465, 19.625604033368916, 17.11384004053055, 17.089133162128018, 19.790175397091865, 17.386830232637827, 16.748719050385375, 17.201820490408693, 16.877515488869633, 19.60751338246812, 17.25696765928614, 18.082478261609346, 18.323941414074714, 16.58231350695343, 16.071350476816942, 16.896228174947108, 16.045541603361176, 17.82731745486637, 17.22936449389117, 16.710064471843165, 17.526335984497525, 17.51394539924212, 16.639838114452363]  # Truncate for embedding
baseline = 17.444444444444443
mean = 17.791905608017434
std = 1.0488193894444404
p5 = 16.178090142025503
p50 = 17.7008576756944
p95 = 19.63390792437917
display_name = "Ratio of Industry to Government Clinical Trials Spending"
units = "ratio"

# Create figure with two subplots

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---

# Handle edge case where all samples are identical (zero variance)

if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax1.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key statistics with formatted values in legend (use format_parameter_value for full units)

ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {format_parameter_value(p50, units)}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {format_parameter_value(p5, units)}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {format_parameter_value(p95, units)}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {format_parameter_value(baseline, units)}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---

sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax2.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key percentiles

ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"

exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title

fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark

add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from

output_path = get_figure_output_path('mc-distribution-industry_vs_government_clinical_trials_spending_ratio.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Simulation Results Summary: Ratio of Industry to Government Clinical Trials Spending**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 17.4 |
| Mean (expected value) | 17.8 |
| Median (50th percentile) | 17.7 |
| Standard Deviation | 1.05 |
| 90% Confidence Interval | [16.2, 19.6] |

*The histogram shows the distribution of Ratio of Industry to Government Clinical Trials Spending across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
