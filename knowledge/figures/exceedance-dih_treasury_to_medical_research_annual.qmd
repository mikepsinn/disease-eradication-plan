```{python}
#| echo: false
#| fig-cap: "Probability of Exceeding Threshold: DIH Annual Funding for Medical Research"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Monte Carlo samples
samples = [25091814219.2817, 22014000000.0, 26232634935.52546, 26734859771.81577, 22014000000.0, 22014000000.0, 24652984786.09151, 23584744975.169643, 24299840573.847668, 22355076872.965454, 26572234597.87932, 26304276207.839214, 24501451937.24743, 26910000000.0, 25502600143.6602, 22341147299.574303, 25252599839.58042, 22120303526.971043, 26569722797.777977, 24219680606.582657, 23895865640.31828, 22742196820.355755, 26910000000.0, 23968277949.083027, 23322520789.04898, 23500458516.86326, 25667979594.68686, 25244271649.693974, 25363632604.670086, 25409438568.754143, 26910000000.0, 23373555654.35, 23128111515.897194, 22442821395.183697, 25883106665.69056, 26910000000.0, 24065500863.065926, 22383833710.49754, 22418861086.282127, 25972628496.317844, 26213808947.41582, 25695762537.81209, 22777204635.606728, 24910866948.478416, 24625569016.414494, 24877411158.064632, 26551119709.509506, 24889591011.181847, 26046105831.08892, 24505236532.236195, 25052804480.108112, 25922662272.08778, 22014000000.0, 23576680139.11209, 23224910304.42209, 22837794176.415657, 23681636533.128242, 26910000000.0, 22326580273.882935, 26808869813.72527, 22014000000.0, 23540927343.726425, 24738990575.175102, 25806391498.083923, 26130194829.27812, 26345123237.862988, 23508450038.038746, 23243499798.894936, 26515513475.50531, 23880515225.633682, 22014000000.0, 22014000000.0, 22207479028.91077, 25578142561.61789, 24688878680.57775, 26076188254.534496, 23325022269.022766, 24728595216.26888, 25907932888.264248, 23600974279.12947, 25475308068.324017, 22785348611.612766, 23474873070.984234, 23431162314.031044, 22014000000.0, 25552160880.000023, 23227158355.434326, 24370954473.412136, 25536297043.088516, 25449289193.688396, 26010980798.905903, 24102646990.210175, 23334224642.718384, 24147810872.05842, 22014000000.0, 22014000000.0, 22014000000.0, 22035813478.359234, 25330868339.563835, 22238454473.92702, 23439520410.5634, 26910000000.0, 23490777969.659676, 26198807583.202156, 22176121640.631714, 23846871981.161076, 22139863230.29541, 23531188754.76138, 26468824187.049385, 22014000000.0, 25418571554.917282, 24924722284.857964, 22939916467.671715, 22014000000.0, 24516362286.209007, 23088348992.694202, 24912146423.37366, 24393714790.123627, 26910000000.0, 23766325453.080807, 22014000000.0, 24779797725.939175, 24880657460.587875, 26910000000.0, 26455106386.006294, 25222692764.263103, 26910000000.0, 22014000000.0, 22835803921.86774, 22191704128.363075, 23412303515.229565, 22014000000.0, 25932652499.456993, 23806977612.06278, 22014000000.0, 22014000000.0, 25113841683.565674, 26463064813.83544, 26910000000.0, 26910000000.0, 25367875413.03692, 22052764520.607548, 22014000000.0, 24999362039.21803, 22444683250.415684, 23352715718.912014, 22898885667.972153, 24001147635.198723, 26910000000.0, 24724917319.28311, 23958464596.891094, 22014000000.0, 22014000000.0, 23188022169.796333, 24210364966.092804, 26910000000.0, 24658971419.662533, 26847570045.62363, 23158000622.531857, 22014000000.0, 22106551938.880344, 22641928984.144978, 26910000000.0, 22425782502.13386, 26464022090.522667, 22244116064.02394, 26710891103.949104, 25293440777.467125, 23963237535.85399, 24241828967.90647, 22801578687.695076, 25448124067.19243, 23260590029.40975, 22014000000.0, 22014000000.0, 24763272417.766514, 26910000000.0, 24732176948.300903, 24054242757.511673, 25044575809.532494, 26910000000.0, 24879133180.334373, 23363037596.817337, 26910000000.0, 25404206209.24809, 26910000000.0, 24789585097.620186, 22014000000.0, 22014000000.0, 26910000000.0, 26910000000.0, 23908605207.04565, 23427774827.427746, 26910000000.0, 22014000000.0, 22262318680.848984, 25953810548.047672, 23401107161.59101, 24328166992.068687, 23946976618.39391, 25174189487.67952, 26910000000.0, 24561537274.97971, 25955395016.393284, 22014000000.0, 24222598058.618248, 22376971542.967537, 22014000000.0, 22299156392.4939, 23542715805.44867, 26669170577.047993, 22014000000.0, 24415086983.824112, 23192969069.63463, 23557868786.543304, 26901234279.24399, 25682850316.85313, 26910000000.0, 23968334858.547768, 22708164195.10024, 23803092507.777397, 24936562719.357727, 24773119089.99301, 22014000000.0, 24561304214.752407, 24901095800.74405, 26910000000.0, 26910000000.0, 22354632174.304462, 23652737310.569065, 22014000000.0, 22947796261.321022, 25119080867.806583, 26910000000.0, 22633217637.057457, 22803037262.062054, 22014000000.0, 23948832691.130478, 22014000000.0, 23088471705.77166, 22302029549.959682, 24112802199.651978, 22014000000.0, 22014000000.0, 26910000000.0, 22014000000.0, 22014000000.0, 26910000000.0, 26910000000.0, 22014000000.0, 23462711091.829605, 25184188403.291054, 26910000000.0, 22058663045.66588, 23752289660.170242, 26303084047.24858, 25419439815.91424, 23444212285.07533, 24017835661.762077, 22014000000.0, 23769127536.56575, 23702326720.596138, 24910888235.466938, 23028926291.519882, 25512852110.703716, 26910000000.0, 24720924039.87111, 25209827597.74452, 24470004101.299576, 24340804654.84376, 22650214978.552998, 25121309146.9144, 24105529610.195877, 26910000000.0, 26910000000.0, 25295700492.042137, 22556645982.039333, 22014000000.0, 26910000000.0, 24986990671.226048, 25534760428.62823, 22014000000.0, 26699877134.451786, 25469324509.76058, 22014000000.0, 23222241246.09758, 24989403462.27031, 24468323468.32557, 23641443651.68503, 24090621941.199665, 23736421608.13591, 24713855639.85901, 26910000000.0, 22014000000.0, 23772265716.75686, 24772968505.663353, 25069990325.16274, 23454133496.873306, 22014000000.0, 25150146418.356056, 26910000000.0, 22014000000.0, 26530996639.587936, 23555866429.473736, 24192158256.270763, 22014000000.0, 23541934425.5513, 26910000000.0, 25797210650.67426, 26910000000.0, 26910000000.0, 25430397602.477592, 26910000000.0, 25430160369.384224, 26436315764.282326, 23631070106.447018, 24502710945.905853, 22704809246.923977, 26865906226.602898, 22014000000.0, 26316239672.108055, 23882071433.38469, 26910000000.0, 26233728214.02413, 26910000000.0, 26181197122.982254, 22014000000.0, 24178578581.67952, 22014000000.0, 23114187724.83317, 26910000000.0, 25938817265.337883, 22701397290.552727, 22014000000.0, 24420325198.81868, 22014000000.0, 22764415252.461765, 25110073294.85068, 26910000000.0, 25864477529.547783, 22014000000.0, 25090937326.985306, 24516127675.70905, 25366561753.823406, 26910000000.0, 22014000000.0, 22946888864.807617, 25818451950.430855, 22014000000.0, 26910000000.0, 25251606948.956833, 26485399502.400368, 22993080651.179703, 26398831566.343716, 26910000000.0, 24912647927.305363, 24916432659.8963, 25005925815.513092, 22332117214.947998, 23985021787.668945, 23973076780.96687, 25289512429.599068, 26893363366.02761, 22014000000.0, 24038961471.47732, 26910000000.0, 22600494839.676476, 22423851296.33768, 24836790515.069595, 26479591022.729446, 24368358112.258507, 26910000000.0, 26512387587.216377, 26472816436.606724, 25723876157.914043, 26910000000.0, 23847528215.662506, 22014000000.0, 26910000000.0, 23254289130.261295, 24603948718.61985, 26910000000.0, 22014000000.0, 22014000000.0, 22014000000.0, 22486824603.10887, 25431792649.78433, 25647194003.42057, 25020724179.593834, 22014000000.0, 22014000000.0, 24472929073.738693, 23221659300.535324, 25481942811.752705, 26106035846.150692, 24678575940.931015, 26257982167.221947, 24903537720.901, 25662233436.72603, 22688396395.670227, 23908385317.53606, 24823093464.46411, 26416651415.830833, 23403123961.477654, 25639467472.414024, 23703624064.386784, 24056873071.906124, 26440353053.015156, 22014000000.0, 22014000000.0, 22014000000.0, 22014000000.0, 22748243585.56354, 26229973070.61371, 23658634863.619957, 24825604357.8899, 26910000000.0, 26910000000.0, 24173309847.315502, 26910000000.0, 24565314928.221195, 22389993233.751488, 22939343495.635857, 22014000000.0, 22276964913.74538, 23486671297.836655, 26372041482.885536, 26910000000.0, 22014000000.0, 25313321432.57354, 22014000000.0, 25520891742.069084, 24024392248.437237, 22014000000.0, 26702163743.844566, 22915100248.223206, 23078200270.107067, 22014000000.0, 22802726011.007812, 25402011775.851643, 23885422845.43885, 25151818609.691113, 25235403753.23542, 26910000000.0, 23522380931.82254, 22014000000.0, 26910000000.0, 23548905330.02669, 26910000000.0, 25289470172.07698, 24024270317.745712, 25202333570.019962, 26910000000.0, 26910000000.0, 24509641952.05446, 24732667849.714622, 26910000000.0, 22371546415.552917, 25162881324.493843, 24277885488.007908, 25114829639.84574, 22398994473.20643, 22014000000.0, 22014000000.0, 22014000000.0, 23252025604.039352, 23639037397.728607, 26910000000.0, 26910000000.0, 22113224973.95575, 25199650200.286476, 23372009379.221527, 23659862624.298527, 24794756774.934, 25891348532.666092, 23530659667.82383, 26910000000.0, 22014000000.0, 24355995905.50576, 26910000000.0, 24888310415.999115, 26910000000.0, 24563828839.867626, 25792378056.44322, 24203119446.84854, 23930345558.36191, 22519718654.819054, 25408121499.737415, 22358437075.220592, 26011500060.55532, 26910000000.0, 25247009890.705856, 23655414494.691036, 25468169175.77196, 23602559868.315758, 26721482016.68171, 22014000000.0, 23539231182.13889, 22014000000.0, 22014000000.0, 26910000000.0, 26614112859.556313, 22654910024.993706, 22014000000.0, 22014000000.0, 23056121745.193535, 26910000000.0, 25419739520.74235, 23019176730.198902, 25496421376.12163, 22014000000.0, 23629296570.777313, 24583334140.38425, 24132441890.5335, 26338446135.731956, 25191951347.895157, 26018612490.28442, 22725318753.981773, 26621097014.959324, 26910000000.0, 22095456697.400333, 22277938679.91716, 26910000000.0, 23880420746.878723, 26910000000.0, 23289490215.83805, 26910000000.0, 24661951102.22617, 24975726173.143948, 26910000000.0, 23477878464.866203, 22159527349.2866, 23275489277.11336, 25464024386.34234, 22014000000.0, 25938654495.043793, 23066989372.486828, 26910000000.0, 22014000000.0, 22503812370.517216, 22014000000.0, 22414951793.992874, 24949423966.46218, 23909303014.494953, 23733106552.04709, 23957150111.89122, 24839471439.154953, 22014000000.0, 26118788731.56179, 26003926596.202255, 25293660212.401077, 25730078756.13614, 25071050699.868576, 26910000000.0, 24130050366.2899, 23606303257.351883, 22578098374.228256, 22014000000.0, 22014000000.0, 22275490651.221046, 24169590800.042583, 25165955687.83149, 24465090325.68718, 22551070880.498554, 26627389028.002594, 26203765879.559208, 23956042637.52475, 22805835905.09898, 25709283450.810036, 24801306812.554844, 22014000000.0, 24176101542.609, 24985212562.44935, 22251289511.131233, 24805933074.570312, 22014000000.0, 26910000000.0, 26910000000.0, 23735143166.927296, 25239261716.935257, 22014000000.0, 22014000000.0, 23637652490.756897, 22014000000.0, 26138458557.459282, 26910000000.0, 22014000000.0, 22389847658.55513, 24919036241.73518, 26910000000.0, 22014000000.0, 24952834321.90986, 26910000000.0, 22014000000.0, 22014000000.0, 23333507061.411037, 23108865532.902, 26395770768.015182, 24934480628.156513, 22014000000.0, 25624748137.161655, 22977958877.11025, 26910000000.0, 22863529132.45684, 22842949109.31836, 25690578611.628983, 26265299844.872345, 25453270508.196, 22014000000.0, 25682642811.37506, 22014000000.0, 24918608065.60882, 22014000000.0, 25448758559.330288, 22458887194.12442, 22014000000.0, 26136955866.600437, 24934442826.631886, 22894591779.3413, 26910000000.0, 23293865807.76023, 24418682396.408363, 25002359633.777344, 22881602815.53387, 25511828481.66917, 23079231375.21539, 23361380461.0868, 26910000000.0, 22014000000.0, 22014000000.0, 26910000000.0, 26910000000.0, 23376227175.290928, 22014000000.0, 23598296645.177917, 23655475335.555187, 23883803921.32347, 22014000000.0, 25789249812.98764, 25648011489.827606, 22014000000.0, 26098857570.576477, 26910000000.0, 24761722224.11382, 23535198027.29952, 23998245319.559486, 25881240926.705517, 22014000000.0, 24743032182.185, 23410775866.050163, 26910000000.0, 23921359509.72981, 26910000000.0, 22014000000.0, 25809060680.99612, 25128592307.78746, 22319418754.11224, 24775152328.975136, 26910000000.0, 23566991543.961086, 22014000000.0, 24297994402.733128, 22245234592.73697, 23523425596.09089, 24143307942.48065, 22014000000.0, 22014000000.0, 25539660123.997128, 23103955452.437057, 22014000000.0, 26322786633.858643, 25010981216.75862, 22667580994.655266, 22014000000.0, 26456944863.229446, 25203778459.76823, 26910000000.0, 25382503689.907066, 25300385619.29195, 23938653219.98514, 26406764781.543247, 25906627325.773323, 26910000000.0, 23107172455.959564, 23306056129.917156, 23204692981.222355, 26338434574.29185, 26910000000.0, 23251642419.833115, 23330790687.778793, 25115253059.73922, 23751143755.17443, 26765516470.986996, 22014000000.0, 22413888458.388046, 22513128904.03373, 22014000000.0, 22109812104.148083, 22216998055.86922, 23857181135.46029, 26910000000.0, 23752804270.23078, 22014000000.0, 24202705768.830276, 26910000000.0, 22082656417.80563, 22227153189.738247, 25735252320.98693, 23808608146.253025, 25964577272.077667, 24307487775.73136, 26105280721.48406, 22014000000.0, 24311275801.34837, 23834380933.142525, 22014000000.0, 22014000000.0, 26063871360.455284, 23503227577.422203, 22014000000.0, 24108193194.75273, 26910000000.0, 22014000000.0, 22014000000.0, 22199872900.67229, 26910000000.0, 25036484957.91588, 26276806146.32536, 22014000000.0, 22014000000.0, 25452545260.833076, 24482502299.45855, 25710080772.252357, 23889171808.158916, 25025390725.57573, 24727557724.31664, 26304211801.086746, 26381048414.688248, 22014000000.0, 22014000000.0, 26898517633.329346, 26910000000.0, 22014000000.0, 22014000000.0, 24582248683.953373, 26708933375.715107, 26910000000.0, 25627015933.445557, 23454596468.882492, 22265864076.76034, 24368419455.678864, 23624721167.56909, 22014000000.0, 26910000000.0, 26910000000.0, 26910000000.0, 22204382111.375473, 26507694659.14193, 25944232286.8821, 25439173479.473465, 26910000000.0, 25933222112.583405, 26205338331.361195, 25937193631.40975, 25182268829.672295, 22014000000.0, 24544481494.330666, 23026939925.472393, 22014000000.0, 26910000000.0, 26910000000.0, 26910000000.0, 24968214832.9381, 26910000000.0, 24369882560.752834, 24838007209.724644, 22014000000.0, 25323837460.485214, 24487659706.88314, 22014000000.0, 24216609649.087654, 24147783525.352413, 26910000000.0, 26611533445.221024, 24368405229.335274, 24952215015.664677, 24448184799.250748, 23852875705.303413, 22014000000.0, 23976593884.48587, 22594836866.56148, 22014000000.0, 25614043909.8695, 25309375589.948166, 22014000000.0, 24044535822.80815, 26882305450.358067, 26910000000.0, 26910000000.0, 24435264917.100258, 22372920459.555573, 22014000000.0, 25191850022.986206, 25279136752.410946, 26910000000.0, 26910000000.0, 24021655626.77464, 22014000000.0, 23578008051.423473, 24873794797.592865, 23854852412.357628, 22977144696.403408, 24962415860.296738, 23147233381.903477, 22862437751.12154, 25108679088.84838, 23383869032.0467, 24940561868.038918, 25013062700.043625, 22014000000.0, 23199744790.589844, 26910000000.0, 22014000000.0, 22014000000.0, 22014000000.0, 24411381634.386078, 24415783006.394844, 24056708241.27027, 26910000000.0, 22014000000.0, 25321166441.167484, 26910000000.0, 22014000000.0, 23435676949.149143, 22579530057.372486, 22263164721.960747, 23561184979.827938, 26910000000.0, 26910000000.0, 23538451971.76318, 26910000000.0, 24427133156.325996, 26910000000.0, 24115120775.863903, 24660898240.55712, 25244348222.418957, 26910000000.0, 26497823798.539867, 22682532602.916893, 26810794026.60446, 23477733124.74442, 23180061431.94971, 26649754417.476357, 24416192929.415276, 25026469626.961414, 24374579667.657978, 25171699991.756393, 25394602400.824802, 22014000000.0, 26014062259.661602, 22069310308.01111, 22014000000.0, 24199189176.392307, 24545362732.95329, 22713683832.504192, 26444343346.01787, 22014000000.0, 23372322924.23443, 22961152035.467075, 24227747924.43094, 25027189531.445026, 22014000000.0, 26164248006.139137, 24494051658.552002, 22014000000.0, 22014000000.0, 24310706781.466362, 23809959045.95807, 24090785721.902287, 24272752864.886654, 24894468371.471294, 26753760714.621655, 22014000000.0, 22014000000.0, 22014000000.0, 25052297848.830864, 26910000000.0, 23315515458.63232, 22014000000.0, 22014000000.0, 22399736468.79097, 23023409919.798954, 23368954547.449463, 24434455492.37407, 23595325297.649895, 26910000000.0, 22753343282.510315, 22334405817.749355, 25531531220.36812, 22014000000.0, 25305404750.64294, 24590877618.830055, 23985228002.192482, 26910000000.0, 22875802626.127434, 26910000000.0, 23799358757.3465, 22014000000.0, 24510958417.410107, 22014000000.0, 22582089015.243107, 25323943545.029835, 25727637117.075214, 22875893320.20042, 26860067900.55111, 26910000000.0, 26910000000.0, 25660566269.492027, 26910000000.0, 22014000000.0, 23580830659.776794, 22323965490.881683, 24631809276.071026, 22991921138.02374, 23940492194.033813, 26910000000.0, 23931987414.749615, 25366313861.375774, 23783131040.149887, 24525128131.302284, 24355212677.233353, 25453841032.605835, 26910000000.0, 26910000000.0, 25104089151.85273, 25814951059.971897, 22014000000.0, 24128166786.63978, 26734125730.65129, 26536662413.362247, 24859850766.930126, 26590784739.819492, 25561833676.04859, 26910000000.0, 25053403655.397327, 23492103471.75984, 25169837292.008053, 22014000000.0, 25288230626.518887, 22014000000.0, 22014000000.0, 25462588398.628548, 25528102939.03593, 22014000000.0, 22671589825.297043, 26910000000.0, 23193291350.657463, 26910000000.0, 24335938775.20025, 25351753142.4736, 26910000000.0, 24660822695.732018, 22024612263.637764, 24075633398.74323, 24254289996.341904, 22014000000.0, 23727296451.550777, 22603642546.7332, 26691673351.933147, 24424782880.223644, 23663563765.246403, 24084149745.851757, 24888415371.868324, 25885262045.34501, 22030394941.56395, 22014000000.0, 26910000000.0, 23359752666.417465, 22014000000.0, 25442389027.607723, 25492071674.073475, 22014000000.0, 24904209301.495228, 26193757802.184273, 25266799969.16671, 25924454974.573475, 22014000000.0, 25157785930.768684, 23616815974.13937, 23196160282.156036, 26548807214.723087, 26910000000.0, 26910000000.0, 26910000000.0, 24075617236.29071, 25212251281.70285, 26275510365.420425, 24636606133.252697, 24660175913.724815, 26425150063.599106, 24197085788.662827, 22632759107.16336, 23354775509.351906, 25929443572.861473, 24347868565.722324, 25180808337.258125, 26023163191.2774, 23447286818.808033, 26247808483.376316, 25278033738.499317, 22014000000.0, 26910000000.0, 23154653278.5737, 22014000000.0, 22014000000.0, 22014000000.0, 24467607168.770287, 23684688188.386955, 23536355912.3903, 25892719589.72991, 25179967857.105125, 25120190567.512344, 25356285994.561108, 25883507493.03468, 22014000000.0, 23471631500.97898, 22014000000.0, 24428311177.588356, 24329353454.21441, 26910000000.0, 26910000000.0, 24837952135.54638, 23155539452.719296, 25547544368.650528, 23091976815.74628, 24337218613.53293, 26856668509.187492, 23023312409.143654, 26377549632.0309, 26042177243.626106, 22129331805.972294, 26823891839.638184, 26097216476.847996, 24589338925.87761, 22558297024.639015, 22341339946.68753, 23069540685.172333, 25694327693.010605, 22127492319.529953, 25426404032.94737, 22014000000.0, 23850128659.406033, 24608286569.788246, 26910000000.0, 22014000000.0, 26910000000.0, 24707150853.90552, 25359684269.13005, 24629652203.671764, 25444709061.5874, 23970296829.71477, 26910000000.0, 23257138495.981667, 26910000000.0, 22825292485.200794, 24194746550.69006, 22014000000.0, 25470857508.167202, 26910000000.0, 24153501147.636963, 23867223460.04989, 22014000000.0, 23790193953.66255, 22014000000.0, 22222047363.388042, 24897513543.463745, 26910000000.0, 26910000000.0, 22957233599.734344, 26910000000.0, 24939686386.035862, 23976125668.49788, 25413933995.027977, 24491398644.40853, 24610122690.03752, 23369083840.083984, 22014000000.0, 22014000000.0, 25979500466.4527, 23677956775.10183, 22935480035.44261, 24361260236.38531, 26349288932.67094, 24782487971.609104, 22798696544.750793, 26910000000.0, 26910000000.0, 25571499211.56066, 26823274780.718693, 26910000000.0, 26910000000.0, 25878252562.714092, 25837622093.45069, 25635614314.242966, 22014000000.0, 26102831762.52507, 22014000000.0, 22485785705.64105, 26910000000.0, 26468591908.22943, 26910000000.0, 23689830007.342342, 22014000000.0, 23763761489.546364, 24589597478.630535, 24533142496.04814, 26910000000.0, 23479049591.86666, 25210526857.435635, 22054768558.334457, 25458902410.592632, 24348148500.592163, 22586465124.037983, 23774686721.5399, 23897502347.4398, 23693420417.816795, 26910000000.0, 24102741916.327408, 23755563663.903805, 22014000000.0, 22263472733.257565, 23710163590.23533, 22731031119.18657, 26910000000.0, 23943406007.76176, 26910000000.0, 24490881090.6483, 24431157255.203075, 24125953325.746452, 24349818820.009983, 26910000000.0, 22014000000.0, 22014000000.0, 23056868474.866795, 24375899125.50013, 26075197424.8706, 25516793703.369225, 23425301079.88896, 26910000000.0, 26910000000.0, 24791621265.48211, 26793842814.234917, 25011668585.72657, 23014789717.185772, 26095265410.47811, 24610656382.081047, 24343853122.378082, 26910000000.0, 22014000000.0, 22014000000.0, 22014000000.0, 23474388820.374348, 23730193395.027557, 22014000000.0, 22062401911.814533, 22337695047.10592, 26910000000.0, 26910000000.0, 23361121573.515488, 23473633331.696148, 22014000000.0, 22014000000.0, 24058461683.57574, 22034483324.657528, 24135451421.852226, 22014000000.0, 22559082364.61776, 24704155795.6225, 25246199451.321686, 25375626255.391087, 22014000000.0, 26506812591.40861, 22473201041.846275, 25926721523.163456, 24314782660.854687, 22014000000.0, 23584850578.806416, 25244069386.899426, 25875325956.340347, 24000675966.518726, 26910000000.0, 26910000000.0, 23725350890.629253, 26231773038.057198, 26910000000.0, 26910000000.0, 22014000000.0, 22191798939.845047, 26910000000.0, 22014000000.0, 22014000000.0, 23188285344.811253, 25382600184.17949, 24093245184.71932, 22811188320.661774, 22757440063.375183, 22671058322.99513, 22296137543.435524, 26910000000.0, 25073784476.94519, 26591753159.29428, 23181616963.72118, 23893257327.727383, 22668306470.57747, 22014000000.0, 22014000000.0, 22014000000.0, 22014000000.0, 22014000000.0, 26910000000.0, 24232947160.47471, 26910000000.0, 25359205304.512383, 26316786963.197212, 22248621253.173424, 25646587968.45099, 26175816566.43218, 22980002577.39323, 25737797524.706623, 25754869554.581, 23042195324.428734, 22014000000.0, 22014000000.0, 24551544674.81447, 25147673867.683727, 22490437300.647312, 24405234822.5552, 25766045633.291264, 25888816574.525143, 26910000000.0, 26910000000.0, 22026924816.743237, 26910000000.0, 23084931925.28188, 26910000000.0, 24506232796.09956, 23360189562.199898, 22014000000.0, 23927584030.69931, 22014000000.0, 26806251561.83958, 26910000000.0, 22480601561.387726, 25084941237.338352, 22641555291.12516, 22861483023.24945, 26295626067.62848, 24247208180.561577, 26910000000.0, 23197450704.957085, 26892054494.62276, 24578273130.721825, 26351511994.252075, 23278755181.287525, 24220567452.311935, 24061776861.052177, 22392988709.748318, 26002410656.78072, 25971737838.95438, 25825273536.020554, 26910000000.0, 26910000000.0, 23447045382.6993, 25263437647.02809, 22872623614.669334, 24397372738.17122, 22927106794.529358, 26910000000.0, 25239875559.024837, 23816938490.862877, 26910000000.0, 22014000000.0, 22014000000.0, 26351671407.3565, 24487861276.668285, 24956344612.827732, 22014000000.0, 24284253440.340458, 26910000000.0, 26426327007.078854, 24756155961.188686, 23297580396.268414, 23401182491.623844, 22014000000.0, 24974260292.614243, 26482491194.4917, 22014000000.0, 22786505642.222355, 22014000000.0, 22106034983.98509, 24470800534.430046, 22014000000.0, 25878694658.640217, 26241543503.549057, 23738492974.172653, 22014000000.0, 22037634025.18032, 26910000000.0, 22014000000.0, 23511268099.175488, 22014000000.0, 26374633539.55847, 22755393695.2761, 25341431995.762787, 25753001027.14924, 26910000000.0, 23852809181.255524, 25270978926.527393, 22014000000.0, 26910000000.0, 22562380666.68946, 23016463069.090206, 24286641827.834145, 22014000000.0, 24902441372.365124, 26806698215.97882, 25062338735.77938, 22014000000.0, 24041838513.044987, 26210605235.021866, 22014000000.0, 22014000000.0, 26564669833.604122, 25005307704.410534, 25361707230.2201, 26910000000.0, 25505254698.772667, 25991535871.5123, 26910000000.0, 23826977219.584454, 22478422492.002987, 25401773484.236183, 25430154967.8797, 23094746300.836754, 22014000000.0, 26910000000.0, 25147256458.379677, 22625990685.512245, 26669244426.47619, 24077031877.857735, 23734281106.440403, 25744813849.859734, 22014000000.0, 25212017494.719387, 26910000000.0, 25499212682.903534, 23444081248.17669, 23139966956.86938, 23364406237.208286, 23731721399.74426, 23440352847.136166, 26670258386.621216, 22014000000.0, 26526159371.026264, 23435957448.448654, 25273256373.154972, 22014000000.0, 26910000000.0, 26910000000.0, 26785646705.202015, 22014000000.0, 26439303441.054794, 25343709852.82195, 22014000000.0, 24281676949.632088, 25241981306.430477, 25728902842.07071, 24774819321.871395, 25058083077.10116, 26910000000.0, 26910000000.0, 22014000000.0, 23581931509.628807, 23944090882.386604, 22014000000.0, 24570354494.87239, 26910000000.0, 22014000000.0, 25171242538.284073, 22215519115.039806, 22762662853.085754, 26910000000.0, 23058278414.729824, 25489128939.007458, 22014000000.0, 26910000000.0, 25848720943.732193, 23901497714.438133, 25778924188.99038, 22014000000.0, 26910000000.0, 23566537668.981194, 23850126445.409286, 23175656029.99541, 22970825843.038467, 26087076946.6234, 24969941966.54435, 25975621964.208965, 24319255538.122337, 25619098259.50815, 23344583846.576717, 26910000000.0, 22014000000.0, 26910000000.0, 26910000000.0, 22357050736.136684, 26910000000.0, 26881739374.007553, 26816520921.08059, 24408733009.4422, 23818846240.355915, 23837427165.46281, 25307522408.30926, 26910000000.0, 24784837244.553577, 22225227114.657207, 26426926566.57044, 26683135954.105217, 25983166764.09562, 26219679279.290955, 23691593539.0307, 22186362728.51981, 22321319766.938835, 22014000000.0, 24922765686.476196, 24138826428.480984, 23295410391.790916, 22014000000.0, 22014000000.0, 26910000000.0, 22779212557.117035, 25232055568.573235, 22014000000.0, 26910000000.0, 23993399574.961597, 25055106206.244244, 26910000000.0, 26910000000.0, 23607522105.90091, 22942044149.319923, 23562870161.166092, 25610662375.02396, 24086450891.002686, 23399615544.906776, 26910000000.0, 24064870880.857433, 26910000000.0, 24561923544.612896, 26910000000.0, 25223820871.1028, 26794652663.235893, 22643318072.32221, 22353481858.47715, 25482756685.251106, 26863144206.15349, 24438539351.844734, 22014000000.0, 22014000000.0, 22014000000.0, 22014000000.0, 24607887940.125843, 26910000000.0, 24308047900.75742, 22014000000.0, 23881810807.86527, 23948514784.011833, 26910000000.0, 22014000000.0, 23410276936.516323, 26910000000.0, 25458041675.145424, 25747485309.18835, 24620407676.234924, 25155034097.371212, 26303797601.702484, 22452419438.55744, 26568684610.494873, 22014000000.0, 25151080921.863895, 24778476150.041267, 22889302532.618965, 24285581999.73666, 22875043436.41021, 22014000000.0, 23496986561.647614, 22014000000.0, 25137109210.040817, 22014000000.0, 26132150949.26027, 22014000000.0, 23003745444.285576, 22870335950.60413, 26910000000.0, 25155903333.528004, 23831899443.86506, 25582119814.738598, 22014000000.0, 24236096046.715027, 26910000000.0, 24664068543.57803, 24506053229.229465, 25708515278.245277, 26615228590.047466, 22014000000.0, 22014000000.0, 24856581505.480747, 22665316056.60864, 26910000000.0, 23587258172.887302, 22014000000.0, 22014000000.0, 22014000000.0, 23778727782.75284, 23887472481.099754, 23331514524.30557, 26910000000.0, 26910000000.0, 23930391289.7058, 22014000000.0, 25886468892.637257, 25727067748.960743, 25103516926.86297, 26844196513.39501, 22014000000.0, 26910000000.0, 22119100664.726967, 26229421072.059517, 22014000000.0, 22183540029.570656, 26910000000.0, 23715304977.412323, 26467806285.310993, 24922782535.072796, 24087089953.687103, 26910000000.0, 23772719685.39, 22014000000.0, 22466413216.288597, 25716372311.638103, 25320093576.039375, 22014000000.0, 22643924614.307022, 22968374329.821026, 23469216916.85691, 22014000000.0, 22861742135.60187, 22634286347.305805, 26287859275.70302, 26386609531.904564, 23989133052.093586, 23407096149.88758, 24682719069.907455, 22436548581.100246, 22014000000.0, 22161518797.820957, 22847055813.929028, 22014000000.0, 24737279236.507534, 26178431529.13903, 22014000000.0, 24401688979.71154, 23812409115.812046, 25184070670.3298, 24309204584.660233, 22014000000.0, 22014000000.0, 24412145354.342865, 26910000000.0, 22014000000.0, 25194668861.38941, 26910000000.0, 23971873141.781662, 25713834814.908714, 22692027267.69294, 24052496330.68619, 22014000000.0, 22014000000.0, 26740730353.43741, 22062760867.849136, 23259326987.906513, 22014000000.0, 22014000000.0, 23922158976.437035, 22632103816.746273, 25275836065.287693, 25464543755.66628, 25132225608.461246, 24926873474.09336, 26910000000.0, 22014000000.0, 24207582265.390785, 26910000000.0, 26910000000.0, 22014000000.0, 23593891698.086887, 26910000000.0, 25606015434.92682, 24819347190.57155, 23817756803.0446, 23426340906.84859, 25050554596.608315, 23735482233.515587, 24237437766.597572, 24532188076.14501, 22748681338.72499, 25667519206.225563, 26910000000.0, 22014000000.0, 25140156109.8295, 22563098086.986958, 25783697475.743977, 24453904544.154186, 26262492120.30548, 26910000000.0, 24812312282.187286, 26910000000.0, 22014000000.0, 26910000000.0, 25268503059.475624, 26910000000.0, 22014000000.0, 22404802080.156666, 24697530744.64022, 24299266756.44094, 25037687758.462612, 26910000000.0, 22014000000.0, 26823691010.26464, 24360716595.392292, 23850810807.556145, 22014000000.0, 25593169742.93973, 22014000000.0, 25966932520.435875, 22014000000.0, 24470742648.23775, 24052969859.72617, 26910000000.0, 23910665968.446983, 22712251043.806694, 23141127072.918858, 26910000000.0, 25678192008.708874, 23422067142.6148, 23773223378.868107, 22014000000.0, 25302331653.83949, 22014000000.0, 26236155394.460705, 24654905937.03799, 26910000000.0, 22014000000.0, 24092607385.840836, 26910000000.0, 26910000000.0, 22707553876.12344, 24890514319.886463, 24345454683.533886, 25034908845.06752, 22701963404.56918, 24124692410.56351, 22014000000.0, 24670901536.68278, 25458149176.57275, 23794639764.225082, 22014000000.0, 26863086916.65798, 25241957509.462868, 22640146973.26243, 23668746282.99745, 22014000000.0, 22014000000.0, 23069198336.809376, 26910000000.0, 22836369171.746964, 25945752117.556297, 23068036598.571526, 24950124953.784134, 23999700140.063812, 26555431362.63186, 23076102939.29886, 22014000000.0, 22014000000.0, 23082857262.488964, 22014000000.0, 25357256156.322716, 23235580049.106766, 26910000000.0, 22014000000.0, 24840078346.988647, 22014000000.0, 23171620608.349117, 24686400632.55908, 22014000000.0, 24922461156.642265, 26910000000.0, 23264175553.050774, 24979660427.439148, 26910000000.0, 23945756953.62406, 22970118311.2092, 22014000000.0, 25947763323.055786, 24067371091.76113, 22014000000.0, 24649926525.553883, 22963886434.618107, 23090805552.504875, 25858104858.596416, 22014000000.0, 26910000000.0, 22014000000.0, 22783586144.08557, 26910000000.0, 26910000000.0, 24578740382.027897, 22160835705.647903, 23088856605.60722, 24519164563.019806, 24431877157.713493, 24120961401.7694, 24265853173.080437, 23825621186.484383, 22014000000.0, 23118267048.36235, 26665769649.66709, 22014000000.0, 23884681460.915222, 22429435265.56782, 24612466497.12973, 23415051570.038708, 26910000000.0, 25602194710.352867, 22014000000.0, 26026145390.085957, 22530572461.519043, 22979202402.03185, 25114606195.27584, 23175443796.449444, 26607930123.867332, 22530891141.076828, 22883244841.700077, 22797978006.671234, 23005251170.673843, 26910000000.0, 25916219383.619118, 26910000000.0, 26910000000.0, 22014000000.0, 24512179839.16041, 22014000000.0, 22523934297.14547, 22857839634.06564, 22014000000.0, 22014000000.0, 23992785159.558174, 22014000000.0, 26473626859.077515, 22211242459.63237, 26910000000.0, 23268942266.983696, 24516088715.44162, 22014000000.0, 26910000000.0, 26910000000.0, 25072295839.265903, 22014000000.0, 24857512781.52282, 22014000000.0, 26910000000.0, 26386802783.650345, 24573433002.266483, 22014000000.0, 22066236076.948536, 26069103147.23758, 26910000000.0, 26910000000.0, 22014000000.0, 25083894225.668655, 26910000000.0, 22014000000.0, 24321415088.198555, 25014655552.83734, 23621186815.926006, 22014000000.0, 23562510316.786247, 23558732786.970554, 23983720941.77828, 23010225291.29291, 23288383393.61872, 24244383263.71529, 25438942510.8617, 23612559402.645546, 23366016863.53164, 24565872111.328674, 22014000000.0, 25526844482.668472, 24339232581.23901, 24437166981.79338, 26788702955.16366, 22014000000.0, 22014000000.0, 25014559353.858585, 24323326100.96347, 24757317617.541748, 23244020828.053448, 26008304744.74027, 26713731103.11321, 25544540441.70468, 23715473800.497955, 22014000000.0, 26281836523.407623, 26910000000.0, 25956999311.8228, 22295842191.806446, 26032808937.81696, 26522269100.677334, 26910000000.0, 22303700005.324417, 23796929939.583237, 26224317257.48343, 24480391728.27119, 22014000000.0, 25368398852.592255, 25786935919.651016, 24555114067.49749, 24879635551.019634, 23720495559.2783, 26910000000.0, 22249075802.30587, 22955548948.647346, 24367287276.565998, 26571057890.41982, 22014000000.0, 22014000000.0, 22014000000.0, 24420113593.655647, 22014000000.0, 23424590271.61259, 26000586402.59348, 22831724135.267216, 24908682077.5323, 23624548656.134533, 26028446462.39558, 25521988927.253124, 22717246885.847412, 23934537234.069366, 26910000000.0, 25314708731.424576, 22014000000.0, 25985651261.50409, 22014000000.0, 26910000000.0, 26910000000.0, 25054719019.28134, 24725371811.400513, 23838322598.641422, 26045093587.391808, 23456792375.582592, 24919338262.804287, 26552458799.615562, 23014047013.591614, 22889531652.66427, 22014000000.0, 22014000000.0, 22014000000.0, 26178726912.428833, 26910000000.0, 26910000000.0, 22014000000.0, 26165740906.959946, 26910000000.0, 23256352431.984703, 24588165385.83943, 22014000000.0, 24996930046.46035, 22014000000.0, 24830173554.56362, 22014000000.0, 25695003733.36225, 26910000000.0, 22511414303.682827, 22014000000.0, 22014000000.0, 23702265143.67541, 22968666255.343494, 22014000000.0, 25465763900.55967, 23272224705.99188, 22014000000.0, 23030660288.25117, 26910000000.0, 25849454515.075367, 24026934048.2306, 25891177820.814407, 22014000000.0, 24419321622.92669, 24700940708.443058, 23226152435.199753, 25421195190.89676, 22517582326.060566, 25610464282.716133, 25718083495.336266, 22014000000.0, 26910000000.0, 22014000000.0, 22889859792.662056, 26910000000.0, 23582288665.5289, 22014000000.0, 22014000000.0, 26910000000.0, 22014000000.0, 26910000000.0, 24207178445.117577, 22014000000.0, 22965181356.219696, 22014000000.0, 26537341560.22253, 26185514779.483276, 22014000000.0, 23380138290.60022, 22332472757.44727, 26910000000.0, 22014000000.0, 26910000000.0, 24259893961.481255, 22014000000.0, 22750490754.00449, 22470046823.068233, 22014000000.0, 24571932455.313316, 22014000000.0, 22014000000.0, 23435980953.070976, 22014000000.0, 22581176687.578033, 22230417120.346188, 22314590623.542683, 26910000000.0, 24477953550.19749, 24943713233.546196, 22014000000.0, 22803454220.84816, 24869010113.3139, 22014000000.0, 26648322891.541893, 22014000000.0, 23655137466.848263, 22958455229.470284, 24742859304.63706, 22834121664.012077, 23691675079.223293, 23773973534.847607, 22621246177.171307, 25547373004.362915, 24926345309.381535, 24126392539.48711, 23317564781.67649, 26353525632.450638, 23774675144.4569, 23607212048.76342, 24596119803.701607, 26910000000.0, 22014000000.0, 26283463791.757786, 22014000000.0, 24873898917.212498, 26910000000.0, 25556484227.70794, 24758424346.458748, 23017162636.67948, 24416099435.52163, 23736219315.9317, 22505134963.339912, 23646857836.55694, 24827068140.86591, 22547288009.31636, 22459597569.13279, 22014000000.0, 25308013243.128372, 25701322675.376637, 24909622349.529152, 26800559992.9548, 24554880740.0595, 25311259745.11343, 25089612592.44783, 24119351559.650448, 23085288109.635643, 26910000000.0]
thresholds = [22014000000.0, 24308785902.185135, 26910000000.0]
display_name = "DIH Annual Funding for Medical Research"
units = "USD/year"

# Calculate exceedance probabilities (1 - CDF)
sorted_samples = np.sort(samples)
exceedance = 1 - np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

# Create figure
fig, ax = plt.subplots(figsize=(10, 6))

# Plot exceedance curve
ax.plot(sorted_samples, exceedance * 100, color=COLOR_BLACK, linewidth=2.5)
ax.fill_between(sorted_samples, 0, exceedance * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)
ax.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Annotate thresholds
for thresh in thresholds:
    exceed_pct = (np.array(samples) >= thresh).sum() / len(samples) * 100
    ax.axvline(thresh, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
    ax.axhline(exceed_pct, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.3)

    # Add label with formatted threshold value (use format_parameter_value for full units)
    ax.annotate(f'{exceed_pct:.0f}% chance\nâ‰¥ {format_parameter_value(thresh, units)}',
                xy=(thresh, exceed_pct), xytext=(thresh * 1.05, exceed_pct + 5),
                fontsize=10, ha='left', weight='bold',
                bbox=dict(boxstyle='round,pad=0.3', facecolor=COLOR_WHITE, edgecolor=COLOR_BLACK, alpha=0.9))

ax.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=12)
ax.set_ylabel('Probability of Exceeding Value (%)', fontsize=12)
ax.set_title(f'Exceedance Probability: {display_name}', fontsize=14, weight='bold', pad=15)
ax.set_ylim(0, 100)
ax.set_xlim(left=min(sorted_samples) * 0.95)

clean_spines(ax)
add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from
output_path = get_figure_output_path('exceedance-dih_treasury_to_medical_research_annual.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Exceedance: {display_name}',
    description=f'Probability of {display_name} exceeding various thresholds'
)

plt.show()
```

*This exceedance probability chart shows the likelihood that DIH Annual Funding for Medical Research will exceed any given threshold. Higher curves indicate more favorable outcomes with greater certainty.*
