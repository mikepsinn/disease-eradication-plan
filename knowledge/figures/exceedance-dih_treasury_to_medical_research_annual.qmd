```{python}
#| echo: false
#| fig-cap: "Probability of Exceeding Threshold: DIH Annual Funding for Pragmatic Clinical Trials"

import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Monte Carlo samples

samples = [22303834861.583733, 19568000000.0, 23317897720.467075, 23764319797.16957, 19568000000.0, 19568000000.0, 21913764254.303566, 20964217755.70635, 21599858287.864594, 19871179442.63596, 23619764087.003838, 23381578851.412636, 21779068388.664383, 23920000000.0, 22668977905.47573, 19858797599.6216, 22446755412.960373, 19662492023.97426, 23617531375.802647, 21528604983.62903, 21240769458.06069, 20215286062.53845, 23920000000.0, 21305135954.740467, 20731129590.265762, 20889296459.434006, 22815981861.943874, 22439352577.505753, 22545451204.151188, 22586167616.67035, 23920000000.0, 20776493914.977776, 20558321347.464172, 19949174573.49662, 23007205925.058273, 23920000000.0, 21391556322.725266, 19896741075.997814, 19927876521.139668, 23086780885.61586, 23301163508.814064, 22840677811.388527, 20246404120.539314, 22142992843.091927, 21889394681.257328, 22113254362.724117, 23600995297.34178, 22124080898.82831, 23152094072.07904, 21782432473.09884, 22269159537.87388, 23042366464.078026, 19568000000.0, 20957049012.544083, 20644364715.041855, 20300261490.14725, 21050343585.002884, 23920000000.0, 19845849132.340385, 23830106501.089127, 19568000000.0, 20925268749.979042, 21990213844.60009, 22939014664.963486, 23226839848.247215, 23417887322.544876, 20896400033.812218, 20660888710.12883, 23569345311.560276, 21227124645.007717, 19568000000.0, 19568000000.0, 19739981359.031796, 22736126721.438126, 21945669938.291336, 23178834004.030663, 20733353128.020237, 21980973525.57234, 23029273678.457108, 20978643803.67064, 22644718282.95468, 20253643210.32246, 20866553840.874874, 20827699834.69426, 19568000000.0, 22713031893.33335, 20646362982.60829, 21663070643.03301, 22698930704.967567, 22621590394.389687, 23120871821.24969, 21424575102.409042, 20741533015.749676, 21464720775.16304, 19568000000.0, 19568000000.0, 19568000000.0, 19587389758.541542, 22516327412.945633, 19767515087.93513, 20835129253.834133, 23920000000.0, 20880691528.58638, 23287828962.84636, 19712108125.005966, 21197219538.809845, 19679878426.929253, 20916612226.45456, 23527843721.821674, 19568000000.0, 22594285826.59314, 22155308697.651524, 20391036860.152634, 19568000000.0, 21792322032.185783, 20522976882.394848, 22144130154.10992, 21683302035.665447, 23920000000.0, 21125622624.960716, 19568000000.0, 22026486867.501488, 22116139964.967, 23920000000.0, 23515650120.894485, 22420171346.011646, 23920000000.0, 19568000000.0, 20298492374.993546, 19725959225.211624, 20810936457.981834, 19568000000.0, 23051246666.183994, 21161757877.389137, 19568000000.0, 19568000000.0, 22323414829.836155, 23522724278.964836, 23920000000.0, 23920000000.0, 22549222589.36615, 19602457351.651154, 19568000000.0, 22221655145.97158, 19950829555.925053, 20757969527.92179, 20354565038.197468, 21334353453.509975, 23920000000.0, 21977704283.80721, 21296412975.014305, 19568000000.0, 19568000000.0, 20611575262.041183, 21520324414.304714, 23920000000.0, 21919085706.366695, 23864506707.221004, 20584889442.250538, 19568000000.0, 19650268390.11586, 20126159097.017757, 23920000000.0, 19934028890.785656, 23523575191.575703, 19772547612.465725, 23743014314.621426, 22483058468.859665, 21300655587.425766, 21548292415.916862, 20268069944.617844, 22620554726.39327, 20676080026.142002, 19568000000.0, 19568000000.0, 22011797704.681347, 23920000000.0, 21984157287.37858, 21381549117.788155, 22261845164.028885, 23920000000.0, 22114785049.18611, 20767144530.5043, 23920000000.0, 22581516630.442745, 23920000000.0, 22035186753.440163, 19568000000.0, 19568000000.0, 23920000000.0, 23920000000.0, 21252093517.373913, 20824688735.49133, 23920000000.0, 19568000000.0, 19788727716.310207, 23070053820.48682, 20800984143.63645, 21625037326.28328, 21286201438.572365, 22377057322.381794, 23920000000.0, 21832477577.759743, 23071462236.79403, 19568000000.0, 21531198274.32733, 19890641371.5267, 19568000000.0, 19821472348.88347, 20926858493.73215, 23705929401.82044, 19568000000.0, 21702299541.176987, 20615972506.341892, 20940327810.260715, 23912208248.21688, 22829200281.64723, 23920000000.0, 21305186540.93135, 20185034840.0891, 21158304451.357685, 22165833528.317978, 22020550302.21601, 19568000000.0, 21832270413.11325, 22134307378.439156, 23920000000.0, 23920000000.0, 19870784154.9373, 21024655387.1725, 19568000000.0, 20398041121.17424, 22328071882.49474, 23920000000.0, 20118415677.384407, 20269366455.16627, 19568000000.0, 21287851281.004868, 19568000000.0, 20523085960.68592, 19824026266.63083, 21433601955.2462, 19568000000.0, 19568000000.0, 23920000000.0, 19568000000.0, 19568000000.0, 23920000000.0, 23920000000.0, 19568000000.0, 20855743192.737427, 22385945247.369827, 23920000000.0, 19607700485.036335, 21113146364.59577, 23380519153.109848, 22595057614.145992, 20839299808.95585, 21349187254.899624, 19568000000.0, 21128113365.83622, 21068734862.75212, 22143011764.8595, 20470156703.573227, 22678090765.06997, 23920000000.0, 21974154702.10765, 22408735642.43957, 21751114756.71073, 21636270804.305565, 20133524425.380444, 22330052575.03502, 21427137431.285225, 23920000000.0, 23920000000.0, 22485067104.037453, 20050351984.03496, 19568000000.0, 23920000000.0, 22210658374.423153, 22697564825.447315, 19568000000.0, 23733224119.5127, 22639399564.231625, 19568000000.0, 20641992218.753403, 22212803077.57361, 21749620860.73384, 21014616579.275585, 21413886169.955257, 21099041429.45414, 21967871679.874672, 23920000000.0, 19568000000.0, 21130902859.33943, 22020416449.478535, 22284435844.5891, 20848118663.887383, 19568000000.0, 22355685705.205383, 23920000000.0, 19568000000.0, 23583108124.078167, 20938547937.309986, 21504140672.240677, 19568000000.0, 20926163933.82338, 23920000000.0, 22930853911.710453, 23920000000.0, 23920000000.0, 22604797868.868973, 23920000000.0, 22604586995.008198, 23498947346.028732, 21005395650.175125, 21780187507.47187, 20182052663.932423, 23880805534.758133, 19568000000.0, 23392213041.873825, 21228507940.786392, 23920000000.0, 23318869523.577003, 23920000000.0, 23272175220.42867, 19568000000.0, 21492069850.381794, 19568000000.0, 20545944644.296154, 23920000000.0, 23056726458.078117, 20179019813.824646, 19568000000.0, 21706955732.28327, 19568000000.0, 20235035779.966015, 22320065150.978382, 23920000000.0, 22990646692.931362, 19568000000.0, 22303055401.764717, 21792113489.519154, 22548054892.28747, 23920000000.0, 19568000000.0, 20397234546.49566, 22949735067.04965, 19568000000.0, 23920000000.0, 22445872843.517185, 23542577335.466995, 20438293912.159737, 23465628058.97219, 23920000000.0, 22144575935.382545, 22147940142.130047, 22227489613.789413, 19850770857.731552, 21320019366.81684, 21309401583.08166, 22479566604.08806, 23905211880.91343, 19568000000.0, 21367965752.424286, 23920000000.0, 20089328746.37909, 19932312263.41127, 22077147124.506306, 23537414242.426174, 21660762766.452007, 23920000000.0, 23566566744.192337, 23531392388.094864, 22865667695.923595, 23920000000.0, 21197802858.366673, 19568000000.0, 23920000000.0, 20670479226.89893, 21870176638.7732, 23920000000.0, 19568000000.0, 19568000000.0, 19568000000.0, 19988288536.096775, 22606037910.919403, 22797505780.818283, 22240643715.19452, 19568000000.0, 19568000000.0, 21753714732.212173, 20641474933.809177, 22650615832.66907, 23205365196.578392, 21936511947.494236, 23340428593.086174, 22136477974.134224, 22810874165.97869, 20167463462.817978, 21251898060.032055, 22064971968.412544, 23481467925.182964, 20802776854.646805, 22790637753.256912, 21069888057.232697, 21383887175.027664, 23502536047.124584, 19568000000.0, 19568000000.0, 19568000000.0, 19568000000.0, 20220660964.94537, 23315531618.323296, 21029897656.55107, 22067203873.679913, 23920000000.0, 23920000000.0, 21487386530.947113, 23920000000.0, 21835835491.752174, 19902216207.7791, 20390527551.676315, 19568000000.0, 19801746589.995895, 20877041153.632584, 23441814651.45381, 23920000000.0, 19568000000.0, 22500730162.28759, 19568000000.0, 22685237104.06141, 21355015331.94421, 19568000000.0, 23735256661.195168, 20368977998.420628, 20513955795.650726, 19568000000.0, 20269089787.5625, 22579566022.979237, 21231486973.723423, 22357172097.503212, 22431470002.87593, 23920000000.0, 20908783050.508926, 19568000000.0, 23920000000.0, 20932360293.35706, 23920000000.0, 22479529041.846207, 21354906949.1073, 22402074284.46219, 23920000000.0, 23920000000.0, 21786348401.826187, 21984593644.190773, 23920000000.0, 19885819036.04704, 22367005621.772305, 21580342656.00703, 22324293013.196213, 19910217309.516827, 19568000000.0, 19568000000.0, 19568000000.0, 20668467203.590534, 21012477686.869873, 23920000000.0, 23920000000.0, 19656199976.849556, 22399689066.92131, 20775119448.196915, 21030988999.37647, 22039783799.94133, 23014532029.036526, 20916141926.954514, 23920000000.0, 19568000000.0, 21649774138.22734, 23920000000.0, 22122942591.999214, 23920000000.0, 21834514524.32678, 22926558272.39397, 21513883952.754257, 21271418274.099476, 20017527693.172493, 22584996888.65548, 19874166289.084972, 23121333387.160286, 23920000000.0, 22441786569.516315, 21027035106.392033, 22638372600.686188, 20980053216.280674, 23752428459.27263, 19568000000.0, 20923761050.790123, 19568000000.0, 19568000000.0, 23920000000.0, 23656989208.4945, 20137697799.994404, 19568000000.0, 19568000000.0, 20494330440.17203, 23920000000.0, 22595324018.437645, 20461490426.843468, 22663485667.663673, 19568000000.0, 21003819174.024277, 21851852569.230446, 21451059458.252, 23411952120.650627, 22392845642.57347, 23127655546.919483, 20200283336.87269, 23663197346.63051, 23920000000.0, 19640405953.24474, 19802612159.926365, 23920000000.0, 21227040663.892197, 23920000000.0, 20701769080.744934, 23920000000.0, 21921734313.089928, 22200645487.239063, 23920000000.0, 20869225302.10329, 19697357643.81031, 20689323801.878544, 22634688343.415413, 19568000000.0, 23056581773.37226, 20503990553.321625, 23920000000.0, 19568000000.0, 20003388773.79308, 19568000000.0, 19924401594.66033, 22177265747.966385, 21252713790.66218, 21096094712.930744, 21295244543.903305, 22079530168.137737, 19568000000.0, 23216701094.721592, 23114601418.84645, 22483253522.134293, 22871181116.565456, 22285378399.88318, 23920000000.0, 21448933658.92436, 20983380673.201675, 20069420777.09178, 19568000000.0, 19568000000.0, 19800436134.41871, 21484080711.148964, 22369738389.183548, 21746746956.16638, 20045396338.220936, 23668790247.11342, 23292236337.385963, 21294260122.24422, 20271854137.86576, 22852696400.72003, 22045606055.604305, 19568000000.0, 21489868037.87467, 22209077833.288307, 19778924009.89443, 22049718288.506943, 19568000000.0, 23920000000.0, 23920000000.0, 21097905037.268707, 22434899303.94245, 19568000000.0, 19568000000.0, 21011246658.450577, 19568000000.0, 23234185384.40825, 23920000000.0, 19568000000.0, 19902086807.60456, 22150254437.09794, 23920000000.0, 19568000000.0, 22180297175.030983, 23920000000.0, 19568000000.0, 19568000000.0, 20740895165.6987, 20541213807.024002, 23462907349.34683, 22163982780.58357, 19568000000.0, 22777553899.69925, 20424852335.20911, 23920000000.0, 20323137006.628304, 20304843652.727432, 22836069877.00354, 23346933195.442085, 22625129340.618668, 19568000000.0, 22829015832.33339, 19568000000.0, 22149873836.09673, 19568000000.0, 22621118719.4047, 19963455283.666153, 19568000000.0, 23232849659.20039, 22163949179.228344, 20350748248.30338, 23920000000.0, 20705658495.786873, 21705495463.4741, 22224319674.46875, 20339202502.696774, 22677180872.59482, 20514872333.52479, 20765671520.96604, 23920000000.0, 19568000000.0, 19568000000.0, 23920000000.0, 23920000000.0, 20778868600.258602, 19568000000.0, 20976263684.602592, 21027089187.160168, 21230047930.065308, 19568000000.0, 22923777611.54457, 22798232435.402317, 19568000000.0, 23198984507.179092, 23920000000.0, 22010419754.767838, 20920176024.26624, 21331773617.386208, 23005547490.404903, 19568000000.0, 21993806384.164444, 20809578547.600143, 23920000000.0, 21263430675.315384, 23920000000.0, 19568000000.0, 22941387271.99655, 22336526495.811073, 19839483336.98866, 22022357625.755676, 23920000000.0, 20948436927.96541, 19568000000.0, 21598217246.87389, 19773541860.21064, 20909711640.96968, 21460718171.09391, 19568000000.0, 19568000000.0, 22701920110.21967, 20536849291.05516, 19568000000.0, 23398032563.429905, 22231983303.78544, 20148960884.138016, 19568000000.0, 23517284322.87062, 22403358630.905094, 23920000000.0, 22562225502.139614, 22489231661.592846, 21278802862.209015, 23472679805.81622, 23028113178.465176, 23920000000.0, 20539708849.741837, 20716494337.70414, 20626393761.086536, 23411941843.81498, 23920000000.0, 20668126595.40721, 20738480611.358925, 22324669386.43486, 21112127782.377274, 23791570196.432884, 19568000000.0, 19923456407.45604, 20011670136.91887, 19568000000.0, 19653166314.798294, 19748442716.328197, 21206383231.520256, 23920000000.0, 21113603795.760696, 19568000000.0, 21513516238.960243, 23920000000.0, 19629027926.93834, 19757469501.98955, 22875779840.877274, 21163207241.1138, 23079624241.846817, 21606655800.6501, 23204693974.652496, 19568000000.0, 21610022934.531883, 21186116385.01558, 19568000000.0, 19568000000.0, 23167885653.73803, 20891757846.59751, 19568000000.0, 21429505062.002426, 23920000000.0, 19568000000.0, 19568000000.0, 19733220356.15315, 23920000000.0, 22254653295.925224, 23357161018.955875, 19568000000.0, 19568000000.0, 22624484676.296066, 21762224266.18538, 22853405130.890984, 21234819385.030148, 22244791756.067314, 21980051310.503677, 23381521600.965996, 23449820813.05622, 19568000000.0, 19568000000.0, 23909793451.84831, 23920000000.0, 19568000000.0, 19568000000.0, 21850887719.069664, 23741274111.74676, 23920000000.0, 22779569718.61827, 20848530194.562214, 19791879179.342525, 21660817293.936768, 20999752148.950302, 19568000000.0, 23920000000.0, 23920000000.0, 23920000000.0, 19737228543.444866, 23562395252.570602, 23061539810.561867, 22612598648.420856, 23920000000.0, 23051752988.963028, 23293634072.32106, 23055283227.919777, 22384238959.708706, 19568000000.0, 21817316883.84948, 20468391044.86435, 19568000000.0, 23920000000.0, 23920000000.0, 23920000000.0, 22193968740.38942, 23920000000.0, 21662117831.780296, 22078228630.86635, 19568000000.0, 22510077742.653522, 21766808628.34057, 19568000000.0, 21525875243.63347, 21464696466.979923, 23920000000.0, 23654696395.75202, 21660804648.29802, 22179746680.590824, 21731719821.55622, 21202556182.491924, 19568000000.0, 21312527897.320774, 20084299436.94354, 19568000000.0, 22768039030.99511, 22497222746.62059, 19568000000.0, 21372920731.385025, 23895382622.540504, 23920000000.0, 23920000000.0, 21720235481.866898, 19887040408.493843, 19568000000.0, 22392755575.98774, 22470343779.92084, 23920000000.0, 23920000000.0, 21352582779.355236, 19568000000.0, 20958229379.043087, 22110039820.082546, 21204313255.429, 20424128619.025253, 22188814098.041546, 20575318561.69198, 20322166889.885815, 22318825856.754116, 20785661361.81929, 22169388327.145706, 22233833511.149887, 19568000000.0, 20621995369.413193, 23920000000.0, 19568000000.0, 19568000000.0, 19568000000.0, 21699005897.23207, 21702918227.90653, 21383740658.906906, 23920000000.0, 19568000000.0, 22507703503.259987, 23920000000.0, 19568000000.0, 20831712843.688126, 20070693384.3311, 19789479752.853996, 20943275537.624832, 23920000000.0, 23920000000.0, 20923068419.345047, 23920000000.0, 21713007250.06755, 23920000000.0, 21435662911.879025, 21920798436.050774, 22439420642.150185, 23920000000.0, 23553621154.25766, 20162251202.592793, 23831816912.5373, 20869096110.883926, 20604499050.621964, 23688670593.312317, 21703282603.92469, 22245750779.521255, 21666293037.9182, 22374844437.116795, 22572979911.84427, 19568000000.0, 23123610897.47698, 19617164718.232098, 19568000000.0, 21510390379.015385, 21818100207.06959, 20189941184.44817, 23506082974.23811, 19568000000.0, 20775398154.875046, 20409912920.415176, 21535775932.8275, 22246390694.6178, 19568000000.0, 23257109338.790344, 21772490363.157333, 19568000000.0, 19568000000.0, 21609517139.08121, 21164408040.851616, 21414031752.802032, 21575780324.343693, 22128416330.196705, 23781120635.21925, 19568000000.0, 19568000000.0, 19568000000.0, 22268709198.96077, 23920000000.0, 20724902629.895397, 19568000000.0, 19568000000.0, 19910876861.14753, 20465253262.043514, 20772404042.1773, 21719515993.221394, 20973622486.799908, 23920000000.0, 20225194028.898056, 19852805171.33276, 22694694418.104996, 19568000000.0, 22493693111.682613, 21858557883.404495, 21320202668.61554, 23920000000.0, 20334046778.77994, 23920000000.0, 21154985562.085777, 19568000000.0, 21787518593.25343, 19568000000.0, 20072968013.549427, 22510172040.02652, 22869010770.733524, 20334127395.733707, 23875615911.600986, 23920000000.0, 23920000000.0, 22809392239.54847, 23920000000.0, 19568000000.0, 20960738364.24604, 19843524880.78372, 21894941578.7298, 20437263233.798878, 21280437505.807835, 23920000000.0, 21272877701.999657, 22547834543.445133, 21140560924.577675, 21800113894.49092, 21649077935.318535, 22625636473.42741, 23920000000.0, 23920000000.0, 22314745912.75798, 22946623164.419464, 19568000000.0, 21447259365.902023, 23763667316.13448, 23588144367.43311, 22097645126.16011, 23636253102.06177, 22721629934.265415, 23920000000.0, 22269692138.13096, 20881869752.67541, 22373188704.007156, 19568000000.0, 22478427223.572342, 19568000000.0, 19568000000.0, 22633411909.892044, 22691647056.920826, 19568000000.0, 20152524289.152927, 23920000000.0, 20616258978.36219, 23920000000.0, 21631945577.955776, 22534891682.198753, 23920000000.0, 21920731285.095127, 19577433123.233566, 21400563021.10509, 21559368885.63725, 19568000000.0, 21090930179.156246, 20092126708.20729, 23725931868.38502, 21710918115.75435, 21034278902.441246, 21408133107.423782, 22123035886.10518, 23009121818.08445, 19582573281.39018, 19568000000.0, 23920000000.0, 20764224592.37108, 19568000000.0, 22615456913.42909, 22659619265.84309, 19568000000.0, 22137074934.662426, 23283340268.608242, 22459377750.370407, 23043959977.398643, 19568000000.0, 22362476382.905495, 20992725310.346107, 20618809139.694256, 23598939746.42052, 23920000000.0, 23920000000.0, 23920000000.0, 21400548654.48063, 22410890028.180313, 23356009213.707047, 21899205451.780174, 21920156367.75539, 23489022278.75476, 21508520701.033623, 20118008095.25632, 20759800452.757248, 23048394286.987976, 21642549836.19762, 22382940744.229446, 23131700614.4688, 20842032727.82936, 23331385318.556725, 22469363323.110504, 19568000000.0, 23920000000.0, 20581914025.398846, 19568000000.0, 19568000000.0, 19568000000.0, 21748984150.018032, 21053056167.45507, 20921205255.458046, 23015750746.42659, 22382193650.76011, 22329058282.233192, 22538920884.054317, 23007562216.030827, 19568000000.0, 20863672445.31465, 19568000000.0, 21714054380.078537, 21626091959.301697, 23920000000.0, 23920000000.0, 22078179676.041225, 20582701735.750484, 22708928327.689358, 20526201613.996693, 21633083212.02927, 23872594230.38888, 20465166585.90547, 23446710784.027466, 23148601994.334316, 19670517160.86426, 23843459413.01172, 23197525757.19822, 21857190156.33565, 20051819577.4569, 19858968841.500027, 20506258386.81985, 22839402393.787205, 19668882061.8044, 22601248029.28655, 19568000000.0, 21200114363.916473, 21874032506.47844, 23920000000.0, 19568000000.0, 23920000000.0, 21961911870.13824, 22541941572.560043, 21893024181.04157, 22617519165.855465, 21306930515.302017, 23920000000.0, 20673011996.428146, 23920000000.0, 20289148875.73404, 21506441378.391163, 19568000000.0, 22640762229.481956, 23920000000.0, 21469778797.89952, 21215309742.266567, 19568000000.0, 21146839069.922268, 19568000000.0, 19752930989.67826, 22131123149.745552, 23920000000.0, 23920000000.0, 20406429866.430527, 23920000000.0, 22168610120.920765, 21312111705.331448, 22590163551.13598, 21770132128.363136, 21875664613.366684, 20772518968.963543, 19568000000.0, 19568000000.0, 23092889303.51351, 21047072688.979404, 20387093364.837875, 21654453543.45361, 23421590162.37417, 22028878196.98587, 20265508039.778484, 23920000000.0, 23920000000.0, 22730221521.387253, 23842910916.194393, 23920000000.0, 23920000000.0, 23002891166.85697, 22966775194.17839, 22787212723.771523, 19568000000.0, 23202517122.244507, 19568000000.0, 19987365071.68093, 23920000000.0, 23527637251.759495, 23920000000.0, 21057626673.19319, 19568000000.0, 21123343546.263435, 21857419981.00492, 21807237774.265015, 23920000000.0, 20870266303.881477, 22409357206.60945, 19604238718.519516, 22630135476.08234, 21642798667.193035, 20076857888.033764, 21133054863.591022, 21242224308.835377, 21060818149.170486, 23920000000.0, 21424659481.179916, 21116056590.136715, 19568000000.0, 19789753540.67339, 21075700969.09807, 20205360994.832504, 23920000000.0, 21283027562.4549, 23920000000.0, 21769672080.576267, 21716584226.84718, 21445291845.107956, 21644283395.56443, 23920000000.0, 19568000000.0, 19568000000.0, 20494994199.881596, 21667465889.33345, 23177953266.551647, 22681594402.994865, 20822489848.790188, 23920000000.0, 23920000000.0, 22036996680.428543, 23816749168.208817, 22232594298.42362, 20457590859.720688, 23195791475.980545, 21876139006.294266, 21638980553.22496, 23920000000.0, 19568000000.0, 19568000000.0, 19568000000.0, 20866123395.88831, 21093505240.024494, 19568000000.0, 19611023921.61292, 19855728930.76082, 23920000000.0, 23920000000.0, 20765441398.680435, 20865451850.396576, 19568000000.0, 19568000000.0, 21385299274.289547, 19586207399.69558, 21453734597.20198, 19568000000.0, 20052517657.438007, 21959249596.10889, 22441066178.95261, 22556112227.014297, 19568000000.0, 23561611192.36321, 19976178703.863358, 23045974687.256405, 21613140142.981945, 19568000000.0, 20964311625.6057, 22439172788.355045, 23000289738.969196, 21333934192.46109, 23920000000.0, 23920000000.0, 21089200791.67045, 23317131589.384174, 23920000000.0, 23920000000.0, 19568000000.0, 19726043502.084488, 23920000000.0, 19568000000.0, 19568000000.0, 20611809195.38778, 22562311274.82621, 21416217941.97273, 20276611840.58824, 20228835611.889053, 20152051842.66234, 19818788927.498245, 23920000000.0, 22287808423.95128, 23637113919.372696, 20605881745.529938, 21238450957.979897, 20149605751.624416, 19568000000.0, 19568000000.0, 19568000000.0, 19568000000.0, 19568000000.0, 23920000000.0, 21540397475.977516, 23920000000.0, 22541515826.23323, 23392699522.841965, 19776552225.043045, 22796967083.067543, 23267392503.49527, 20426668957.682873, 22878042244.183666, 22893217381.849777, 20481951399.492207, 19568000000.0, 19568000000.0, 21823595266.501747, 22353487882.385536, 19991499822.79761, 21693542064.49351, 22903151674.03668, 23012281399.577904, 23920000000.0, 23920000000.0, 19579488725.993988, 23920000000.0, 20519939489.13945, 23920000000.0, 21783318040.977386, 20764612944.17769, 19568000000.0, 21268963582.84383, 19568000000.0, 23827779166.079628, 23920000000.0, 19982756943.455757, 22297725544.30076, 20125826925.444588, 20321318242.8884, 23373889837.891983, 21553073938.27696, 23920000000.0, 20619956182.184074, 23904048439.664677, 21847353893.974957, 23423566217.112957, 20692226827.811134, 21529393290.943943, 21388246098.713047, 19904878853.109615, 23113253917.138416, 23085989190.18167, 22955798698.684937, 23920000000.0, 23920000000.0, 20841818117.954933, 22456389019.580524, 20331220990.817184, 21686553545.041084, 20379650484.026096, 23920000000.0, 22435444941.35541, 21170611991.878113, 23920000000.0, 19568000000.0, 19568000000.0, 23423707917.650223, 21766987801.48292, 22183417433.62465, 19568000000.0, 21586003058.080406, 23920000000.0, 23490068450.73676, 22005471965.501053, 20708960352.23859, 20801051103.665638, 19568000000.0, 22199342482.323772, 23539992172.881508, 19568000000.0, 20254671681.975426, 19568000000.0, 19649808874.65341, 21751822697.271152, 19568000000.0, 23003284141.013527, 23325816447.599163, 21100882643.709023, 19568000000.0, 19589008022.382507, 23920000000.0, 19568000000.0, 20898904977.044876, 19568000000.0, 23444118701.82975, 20227016618.0232, 22525717329.56692, 22891556468.577103, 23920000000.0, 21202497050.00491, 22463092379.13546, 19568000000.0, 23920000000.0, 20055449481.501743, 20459078283.63574, 21588126069.185905, 19568000000.0, 22135503442.102333, 23828176191.981174, 22277634431.803894, 19568000000.0, 21370523122.706654, 23298315764.463882, 19568000000.0, 19568000000.0, 23613039852.092552, 22226940181.698254, 22543739760.195644, 23920000000.0, 22671337510.02015, 23103587441.344265, 23920000000.0, 21179535306.29729, 19980819992.891544, 22579354208.209938, 22604582193.670845, 20528663378.52156, 19568000000.0, 23920000000.0, 22353116851.893044, 20111991720.45533, 23705995045.75661, 21401806113.65132, 21097138761.280357, 22884278977.653095, 19568000000.0, 22410682217.528343, 23920000000.0, 22665966829.247585, 20839183331.712612, 20568859517.217228, 20768361099.7407, 21094863466.439342, 20835869197.45437, 23706896343.663303, 19568000000.0, 23578808329.801125, 20831962176.398804, 22465116776.137753, 19568000000.0, 23920000000.0, 23920000000.0, 23809463737.957348, 19568000000.0, 23501603058.71537, 22527742091.39729, 19568000000.0, 21583712844.117413, 22437316716.82709, 22870135859.61841, 22022061619.44124, 22273851624.08992, 23920000000.0, 23920000000.0, 19568000000.0, 20961716897.44783, 21283636339.899204, 19568000000.0, 21840315106.553238, 23920000000.0, 19568000000.0, 22374437811.808064, 19747128102.257607, 20233478091.631783, 23920000000.0, 20496247479.759842, 22657003501.339962, 19568000000.0, 23920000000.0, 22976640838.873062, 21245775746.16723, 22914599279.10256, 19568000000.0, 23920000000.0, 20948033483.538837, 21200112395.919365, 20600583137.773697, 20418511860.478638, 23188512841.443024, 22195503970.261642, 23089441745.963524, 21617116033.88652, 22772531786.229465, 20750741196.95708, 23920000000.0, 19568000000.0, 23920000000.0, 23920000000.0, 19872933987.67705, 23920000000.0, 23894879443.56227, 23836907485.40497, 21696651563.948624, 21172307769.205257, 21188824147.078053, 22495575474.052677, 23920000000.0, 22030966439.60318, 19755757435.25085, 23490601392.507057, 23718343070.31575, 23096148234.751663, 23306381581.591957, 21059194256.91618, 19721211314.23983, 19841173126.167854, 19568000000.0, 22153569499.08995, 21456734603.094208, 20707031459.369705, 19568000000.0, 19568000000.0, 23920000000.0, 20248188939.659588, 22428493838.731766, 19568000000.0, 23920000000.0, 21327466288.85475, 22271205516.66155, 23920000000.0, 23920000000.0, 20984464094.13414, 20392928132.72882, 20944773476.59208, 22765033222.24352, 21410178569.780167, 20799658262.13936, 23920000000.0, 21390996338.53994, 23920000000.0, 21832820928.544796, 23920000000.0, 22421174107.64693, 23817469033.98746, 20127393842.064186, 19869761651.97969, 22651339275.778763, 23878350405.469765, 21723146090.528652, 19568000000.0, 19568000000.0, 19568000000.0, 19568000000.0, 21873678169.000748, 23920000000.0, 21607153689.56215, 19568000000.0, 21228276273.658016, 21287568696.899406, 23920000000.0, 19568000000.0, 20809135054.681175, 23920000000.0, 22629370377.907043, 22886653608.167423, 21884806823.31993, 22360030308.77441, 23381153423.735542, 19957706167.606613, 23616608542.66211, 19568000000.0, 22356516374.990128, 22025312133.370014, 20346046695.6613, 21587183999.76592, 20333371943.475742, 19568000000.0, 20886210277.0201, 19568000000.0, 22344097075.591835, 19568000000.0, 23228578621.564682, 19568000000.0, 20447773728.253845, 20329187511.648117, 23920000000.0, 22360802963.136, 21183910616.76894, 22739662057.54542, 19568000000.0, 21543196485.96891, 23920000000.0, 21923616483.18047, 21783158425.981747, 22852013580.662468, 23657980968.93108, 19568000000.0, 19568000000.0, 22094739115.982887, 20146947605.874344, 23920000000.0, 20966451709.23316, 19568000000.0, 19568000000.0, 19568000000.0, 21136646918.00252, 21233308872.08867, 20739124021.60495, 23920000000.0, 23920000000.0, 21271458924.182934, 19568000000.0, 23010194571.233116, 22868504665.74288, 22314237268.32264, 23861508011.906677, 19568000000.0, 23920000000.0, 19661422813.090637, 23315040952.94179, 19568000000.0, 19718702248.507248, 23920000000.0, 21080271091.033176, 23526938920.27644, 22153584475.620262, 21410746625.49965, 23920000000.0, 21131306387.013332, 19568000000.0, 19970145081.14542, 22858997610.344982, 22506749845.368332, 19568000000.0, 20127932990.495132, 20416332737.61869, 20861526148.317253, 19568000000.0, 20321548564.979443, 20119365642.049606, 23366986022.847126, 23454764028.35961, 21323673824.083187, 20806307688.78896, 21940194728.806625, 19943598738.755775, 19568000000.0, 19699127820.285294, 20308494056.8258, 19568000000.0, 21988692654.673363, 23269716914.79025, 19568000000.0, 21690390204.188034, 21166585880.721817, 22385840595.84871, 21608181853.03132, 19568000000.0, 19568000000.0, 21699684759.41588, 23920000000.0, 19568000000.0, 22395261210.123917, 23920000000.0, 21308331681.5837, 22856742057.696636, 20170690904.615948, 21379996738.387726, 19568000000.0, 19568000000.0, 23769538091.944363, 19611342993.643677, 20674957322.58357, 19568000000.0, 19568000000.0, 21264141312.388474, 20117425614.885574, 22467409835.811283, 22635150005.036694, 22339756096.409996, 22157220865.860764, 23920000000.0, 19568000000.0, 21517850902.569588, 23920000000.0, 23920000000.0, 19568000000.0, 20972348176.077232, 23920000000.0, 22760902608.823837, 22061641947.17471, 21171339380.48409, 20823414139.42097, 22267159641.42961, 21098206429.791634, 21544389125.86451, 21806389401.017788, 20221050078.866657, 22815572627.756058, 23920000000.0, 19568000000.0, 22346805430.959553, 20056087188.43285, 22918842200.661312, 21736804039.248165, 23344437440.271538, 23920000000.0, 22055388695.277588, 23920000000.0, 19568000000.0, 23920000000.0, 22460891608.422775, 23920000000.0, 19568000000.0, 19915379626.805923, 21953360661.90242, 21599348227.947502, 22255722451.966766, 23920000000.0, 19568000000.0, 23843280898.013016, 21653970307.01537, 21200720717.827682, 19568000000.0, 22749484215.946426, 19568000000.0, 23081717795.943, 19568000000.0, 21751771242.878002, 21380417653.089928, 23920000000.0, 21253925305.28621, 20188667594.49484, 20569890731.48343, 23920000000.0, 22825059563.296776, 20819615237.87982, 21131754114.549427, 19568000000.0, 22490961470.079544, 19568000000.0, 23321027017.298405, 21915471944.033768, 23920000000.0, 19568000000.0, 21415651009.6363, 23920000000.0, 23920000000.0, 20184492334.331947, 22124901617.676857, 21640404163.14123, 22253252306.726685, 20179523026.283714, 21444171031.61201, 19568000000.0, 21929690254.82914, 22629465934.731335, 21150790901.533405, 19568000000.0, 23878299481.473763, 22437295563.966995, 20124575087.34438, 21038885584.886623, 19568000000.0, 19568000000.0, 20505954077.16389, 23920000000.0, 20298994819.330635, 23062890771.16115, 20504921420.95247, 22177888847.80812, 21333066791.16783, 23604827877.894985, 20512091501.598984, 19568000000.0, 19568000000.0, 20518095344.434635, 19568000000.0, 22539783250.064636, 20653848932.539345, 23920000000.0, 19568000000.0, 22080069641.767685, 19568000000.0, 20596996096.310326, 21943467228.941402, 19568000000.0, 22153298805.904236, 23920000000.0, 20679267158.267353, 22204142602.16813, 23920000000.0, 21285117292.110275, 20417882943.29707, 19568000000.0, 23064678509.38292, 21393218748.232117, 19568000000.0, 21911045800.49234, 20412343497.438316, 20525160491.115444, 22984982096.530148, 19568000000.0, 23920000000.0, 19568000000.0, 20252076572.520508, 23920000000.0, 23920000000.0, 21847769228.469242, 19698520627.24258, 20523428093.873085, 21794812944.906494, 21717224140.189774, 21440854579.35058, 21569647264.96039, 21178329943.54167, 19568000000.0, 20549570709.655422, 23702906355.259636, 19568000000.0, 21230827965.257973, 19937275791.61584, 21877747997.44865, 20813379173.36774, 23920000000.0, 22757506409.20255, 19568000000.0, 23134351457.854183, 20027175521.35026, 20425957690.694977, 22324094395.800747, 20600394485.732838, 23651493443.43763, 20027458792.06829, 20340662081.51118, 20264869339.26332, 20449112151.710083, 23920000000.0, 23036639452.10588, 23920000000.0, 23920000000.0, 19568000000.0, 21788604301.47592, 19568000000.0, 20021274930.795975, 20318079674.725014, 19568000000.0, 19568000000.0, 21326920141.829487, 19568000000.0, 23532112763.62446, 19743326630.78433, 23920000000.0, 20683504237.31884, 21792078858.17033, 19568000000.0, 23920000000.0, 23920000000.0, 22286485190.45858, 19568000000.0, 22095566916.909172, 19568000000.0, 23920000000.0, 23454935807.689194, 21843051557.570206, 19568000000.0, 19614432068.398697, 23172536130.87785, 23920000000.0, 23920000000.0, 19568000000.0, 22296794867.261024, 23920000000.0, 19568000000.0, 21619035633.95427, 22235249380.29986, 20996610503.045338, 19568000000.0, 20944453614.92111, 20941095810.64049, 21318863059.35847, 20453533592.260365, 20700785238.772198, 21550562901.080257, 22612393342.988174, 20988941691.240486, 20769792767.58368, 21836330765.62549, 19568000000.0, 22690528429.038643, 21634873405.545788, 21721926206.03856, 23812180404.58992, 19568000000.0, 19568000000.0, 22235163870.09652, 21620734311.96753, 22006504548.926, 20661351847.15862, 23118493106.435795, 23745538758.322853, 22706258170.40416, 21080421155.998184, 19568000000.0, 23361632465.25122, 23920000000.0, 23072888277.17582, 19818526392.716843, 23140274611.392853, 23575350311.713184, 23920000000.0, 19825511115.843925, 21152826612.962875, 23310504228.87416, 21760348202.907726, 19568000000.0, 22549687868.970894, 22921720817.467567, 21826768059.99777, 22115231600.90634, 21084884941.58071, 23920000000.0, 19776956268.716328, 20404932398.79764, 21659810912.50311, 23618718124.817616, 19568000000.0, 19568000000.0, 19568000000.0, 21706767638.80502, 19568000000.0, 20821858019.211193, 23111632357.86087, 20294865898.015305, 22141050735.584267, 20999598805.45292, 23136396855.462738, 22686212379.780556, 20193108342.97548, 21275144208.06166, 23920000000.0, 22501963316.821846, 19568000000.0, 23098356676.892525, 19568000000.0, 23920000000.0, 23920000000.0, 22270861350.472305, 21978108276.800457, 21189620087.681263, 23151194299.903828, 20850482111.62897, 22150522900.270477, 23602185599.65828, 20456930678.7481, 20346250357.923794, 19568000000.0, 19568000000.0, 19568000000.0, 23269979477.71452, 23920000000.0, 23920000000.0, 19568000000.0, 23258436361.742172, 23920000000.0, 20672313272.87529, 21856147009.635048, 19568000000.0, 22219493374.631424, 19568000000.0, 22071265381.834328, 19568000000.0, 22840003318.544224, 23920000000.0, 20010146047.718067, 19568000000.0, 19568000000.0, 21068680127.711475, 20416592226.971996, 19568000000.0, 22636234578.27526, 20686421960.881668, 19568000000.0, 20471698034.00104, 23920000000.0, 22977292902.289215, 21357274709.538307, 23014380285.16836, 19568000000.0, 21706063664.823723, 21956391740.838272, 20645468831.28867, 22596617947.463787, 20015628734.27606, 22764857140.19212, 22860518662.521126, 19568000000.0, 23920000000.0, 19568000000.0, 20346542037.92183, 23920000000.0, 20962034369.359024, 19568000000.0, 19568000000.0, 23920000000.0, 19568000000.0, 23920000000.0, 21517491951.215622, 19568000000.0, 20413494538.861954, 19568000000.0, 23588748053.53114, 23276013137.318466, 19568000000.0, 20782345147.200195, 19851086895.508682, 23920000000.0, 19568000000.0, 23920000000.0, 21564350187.983337, 19568000000.0, 20222658448.00399, 19973374953.83843, 19568000000.0, 21841717738.056282, 19568000000.0, 19568000000.0, 20831983069.396423, 19568000000.0, 20072157055.62492, 19760370773.641056, 19835191665.371273, 23920000000.0, 21758180933.50888, 22172189540.92995, 19568000000.0, 20269737085.198364, 22105786767.390133, 19568000000.0, 23687398125.815018, 19568000000.0, 21026788859.420677, 20407515759.52914, 21993652715.23294, 20296997034.677402, 21059266737.08737, 21132420919.86454, 20107774379.70783, 22708776003.878147, 22156751386.11692, 21445682257.321877, 20726724250.379105, 23425356117.733902, 21133044572.85058, 20984188487.789707, 21863217603.290318, 23920000000.0, 19568000000.0, 23363078926.00692, 19568000000.0, 22110132370.855553, 23920000000.0, 22716874869.073723, 22007488307.963333, 20459700121.492874, 21703199498.241447, 21098861614.161514, 20004564411.8577, 21019429188.050613, 22068505014.10303, 20042033786.058987, 19964086728.118034, 19568000000.0, 22496011771.669662, 22845620155.890343, 22141886532.914803, 23822719993.7376, 21826560657.83067, 22498897551.211937, 22301877859.95363, 21439423608.578175, 20520256097.453903, 23920000000.0]
thresholds = [19568000000.0, 21607809690.83123, 23920000000.0]
display_name = "DIH Annual Funding for Pragmatic Clinical Trials"
units = "USD/year"

# Calculate exceedance probabilities (1 - CDF)

sorted_samples = np.sort(samples)
exceedance = 1 - np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

# Create figure

fig, ax = plt.subplots(figsize=(10, 6))

# Plot exceedance curve

ax.plot(sorted_samples, exceedance * 100, color=COLOR_BLACK, linewidth=2.5)
ax.fill_between(sorted_samples, 0, exceedance * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Annotate thresholds

for thresh in thresholds:
    exceed_pct = (np.array(samples) >= thresh).sum() / len(samples) * 100
    ax.axvline(thresh, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
    ax.axhline(exceed_pct, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.3)

    # Add label with formatted threshold value (use format_parameter_value for full units)

    ax.annotate(f'{exceed_pct:.0f}% chance\nâ‰¥ {format_parameter_value(thresh, units)}',
                xy=(thresh, exceed_pct), xytext=(thresh * 1.05, exceed_pct + 5),
                fontsize=10, ha='left', weight='bold',
                bbox=dict(boxstyle='round,pad=0.3', facecolor=COLOR_WHITE, edgecolor=COLOR_BLACK, alpha=0.9))

ax.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=12)
ax.set_ylabel('Probability of Exceeding Value (%)', fontsize=12)
ax.set_title(f'Exceedance Probability: {display_name}', fontsize=14, weight='bold', pad=15)
ax.set_ylim(0, 100)
ax.set_xlim(left=min(sorted_samples) * 0.95)

clean_spines(ax)
add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from

output_path = get_figure_output_path('exceedance-dih_treasury_to_medical_research_annual.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Exceedance: {display_name}',
    description=f'Probability of {display_name} exceeding various thresholds'
)

plt.show()
```

*This exceedance probability chart shows the likelihood that DIH Annual Funding for Pragmatic Clinical Trials will exceed any given threshold. Higher curves indicate more favorable outcomes with greater certainty.*
