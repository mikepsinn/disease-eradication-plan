```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Total Annual Infrastructure Destruction (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Simulation results

samples = [1948173918723.655, 1535319704349.0237, 2108199901527.1772, 2180391873161.3445, 1311000000000.0, 1465655293787.5286, 1888091730862.4116, 1745283729863.9968, 1840339089835.0457, 1587002055867.901, 2156899228612.646, 2118432975823.4268, 1867535815372.0273, 2253683681859.4995, 2005160059527.6724, 1585246773120.0413, 1970393369986.5562, 1557531418292.694, 2156537248762.756, 1829574211140.8975, 1786369394417.7356, 1636122503060.0076, 2292044599659.2104, 1795991804854.9814, 1710979885016.5232, 1734225048275.285, 2028304652816.5369, 1969239770076.272, 1985801531444.0227, 1992173354242.1785, 2623000000000.0, 1717632887454.5227, 1685739696138.8054, 1598078349909.055, 2058584806195.277, 2254374733375.306, 1808946630840.6104, 1590628423884.384, 1595050418026.3599, 2071243140780.5168, 2105514432162.7734, 2032204210191.938, 1640596755307.3682, 1923299996987.1067, 1884365412813.3557, 1918716293708.2332, 2153857151683.2197, 1920384475239.1868, 2081658109946.8823, 1868048010840.8184, 1942799641377.8823, 2064173766470.8916, 1425974330343.4114, 1744224266656.037, 1698286619731.1758, 1648353145678.3032, 1758034161751.7715, 2405331730965.2656, 1583412071836.0278, 2191120066532.355, 1370095159264.426, 1739530869774.6736, 1899802391513.1394, 2047764302538.6194, 2093605206045.1902, 2124277156966.133, 1735272246476.2656, 1700700814438.999, 2148731516948.813, 1784332476477.5105, 1472548428521.6138, 1510157817545.3801, 1568446223120.1023, 2015717708051.3447, 1892975245087.518, 2085928693734.098, 1711305719869.4846, 1898385265720.826, 2062091823080.139, 1747416596358.084, 2001351732704.8022, 1641638379517.4753, 1730874223032.1802, 1725156146950.9436, 1493520064867.8718, 2012083831206.9778, 1698578491722.0989, 1849912231912.6387, 2009866475106.31, 1997724012566.2622, 2076676501863.6619, 1813907038145.8296, 1712504625114.143, 1819946108179.7573, 1369012232625.188, 1428513010281.793, 1460338448686.389, 1546984628215.093, 1981249339924.0154, 1572332516513.9753, 1726248882489.7617, 2323386800961.663, 1732956892195.371, 2103375604043.6226, 1564516289084.8162, 1779871748457.338, 1559977493000.7483, 1738253407742.0718, 2142018524293.8794, 1359351508679.7043, 1993444861057.2815, 1925199684453.7146, 1661462512165.2163, 1428779850574.3057, 1869554091479.0283, 1680597511808.2957, 1923475389825.2563, 1852980740108.5508, 2451277625013.3423, 1769211976111.7312, 1539809184658.8499, 1905369806519.0232, 1919160853097.1091, 2348190601788.803, 2140047920842.911, 1966252090076.9111, 2391891522425.609, 1495393069676.1462, 1648098108780.1956, 1566468660558.4854, 1722691662461.6465, 1446442253452.8733, 2065586370028.225, 1774588510667.891, 1422531100239.5781, 1541970116783.6648, 1951211453321.3687, 2141191076499.8367, 2623000000000.0, 2623000000000.0, 1986391351152.7012, 1549098096177.6443, 1311000000000.0, 1935447534717.2173, 1598313742829.5542, 1714914791430.12, 1656189966655.081, 1800367096852.8142, 2229364143625.4697, 1897883994642.0073, 1794686448546.1868, 1536497636573.9617, 1372083141984.5662, 1693500439136.953, 1828324980239.9084, 2524481406376.396, 1888905854497.4595, 2196739049575.1602, 1689609543376.469, 1496404919807.4175, 1555812691914.5493, 1623337092172.4, 2623000000000.0, 1595924839262.4548, 2141328598540.35, 1573043294482.8047, 2176922404103.0942, 1976054825050.1191, 1795321285423.3354, 1832545810990.6423, 1643715086638.8071, 1997561630328.4941, 1702921623028.2676, 1485667336844.4788, 1471961428067.1675, 1903114362761.7102, 2441447886714.479, 1898873485774.2158, 1807444421305.1082, 1941666825582.962, 2326175643152.9106, 1918952107522.9685, 1716260810853.7473, 2245336199580.4688, 1991445057661.7788, 2422781690132.826, 1906706178429.282, 1485966463368.635, 1448628273698.8901, 2472708088528.3975, 2504768256016.4863, 1788060637499.2795, 1724713353830.958, 2391104316936.4473, 1517192632355.073, 1575329472221.6514, 2068579480664.271, 1721229241117.0435, 1844149708504.9116, 1793158862856.8142, 1959543857232.7659, 2368361261917.658, 1875674823828.0413, 2068803702712.0981, 1311000000000.0, 1829965519191.1794, 1589762744946.0671, 1487455705346.5146, 1579960581624.4602, 1739765516272.9617, 2170889107048.3481, 1459383599693.2385, 1855864125838.9045, 1694141949472.9346, 1741754144808.0945, 2204541092336.0205, 2030391470232.5847, 2339146308500.3594, 1795999376069.3103, 1631778003972.3162, 1774074370304.5378, 1926823760379.959, 1904458137627.5132, 1523293028609.3408, 1875643224214.2986, 1921960779968.967, 2623000000000.0, 2573649863212.0093, 1586946005730.1443, 1754226930303.085, 1424387653890.4475, 1662475920267.5908, 1951934228549.1052, 2285280488641.945, 1622228354653.4438, 1643901773575.3176, 1311000000000.0, 1793405631082.4226, 1529232704892.772, 1680613370800.2207, 1580322034617.4016, 1815264173772.86, 1352050520745.2056, 1423478966080.1826, 2623000000000.0, 1469490836981.6055, 1519952057908.5254, 2555513160573.047, 2623000000000.0, 1499954348239.2766, 1729282409065.534, 1960925935235.81, 2507001456055.9736, 1549833824020.0308, 1767357298577.067, 2118262513293.1672, 1993565759984.4873, 1726862429479.559, 1802590223625.8604, 1446900961913.4236, 1769582342739.6196, 1760762135537.6882, 1923302914990.601, 1672925618907.915, 2006591432452.848, 2208432487015.386, 1897339804662.3613, 1964471800919.2668, 1863282134838.9536, 1845850903832.8691, 1624391999903.9658, 1952241667746.957, 1814292224557.289, 2623000000000.0, 2438968779768.4146, 1976368278466.5356, 1612496929697.84, 1515751514106.504, 2279334301011.0103, 1933747334292.8916, 2009651752683.559, 1355201203150.5444, 2175328939285.6912, 2000517211661.593, 1516283345117.8047, 1697940115397.188, 1934078873584.113, 1863054929212.2861, 1752740064767.884, 1812300591682.4443, 1765261531242.8901, 1896376715249.617, 2395363077658.0117, 1311000000000.0, 1769997173294.4421, 1904437584272.3228, 1945166494559.8147, 1728160119956.92, 1352291579962.0884, 1956222299419.7673, 2506403262731.4624, 1406733512149.4485, 2150959714017.0815, 1741491305006.6052, 1825884529638.2358, 1531812119153.851, 1739662997390.039, 2323722719079.323, 2046471033415.486, 2508606583596.8296, 2273798039664.978, 1995091826016.3503, 2513775832130.374, 1995058781701.054, 2137349877297.8293, 1751374821935.8196, 1867706198929.669, 1631349994946.2937, 2199403519710.8916, 1498165733931.9944, 2120143918013.5408, 1784538930687.8997, 2271316816539.4805, 2108355900277.226, 2548161210289.29, 2100865994152.8442, 1397253723540.5298, 1824065219783.3198, 1499837317102.5059, 1683938257604.3977, 2412280026493.08, 2066458269505.3743, 1630914763372.7314, 1542478618353.9016, 1856571127654.7222, 1488049322253.1458, 1638961560840.7397, 1950691654983.7385, 2264915770087.7207, 2055954918332.3806, 1311000000000.0, 1948053040156.1936, 1869522327051.3862, 1986208722874.4553, 2457550551243.7437, 1311000000000.0, 1662359207651.715, 2049463752325.135, 1394891445130.5781, 2397254659518.3916, 1970255821782.777, 2144400675124.5386, 1668305107431.938, 2131972165766.3696, 2230348017738.1265, 1923544138838.2554, 1924063006132.1992, 1936349861231.1267, 1584109334304.4758, 1798220000302.1304, 1796630288663.5686, 1975509960990.6394, 2203396013609.823, 1530283454091.7693, 1805406256468.3135, 2399593679823.0435, 1618066513607.4802, 1595680838162.5247, 1913157372221.7954, 2143565767550.6528, 1849562335955.3928, 2335653458204.6934, 2148281789733.9517, 2142592171789.5662, 2036153510364.1094, 2623000000000.0, 1779958711372.052, 1311000000000.0, 2452352549289.174, 1702102698525.635, 1881429076099.9622, 2327638192083.723, 1389795606021.1936, 1478831099193.5437, 1390037239096.9436, 1603645691217.6987, 1995286147684.001, 2025389369006.2444, 1938384875684.36, 1437229082820.1074, 1311000000000.0, 1863677592209.0864, 1697864569759.0576, 2002277251592.6353, 2090169717765.3303, 1891572950573.28, 2111817967614.7651, 1922295427235.9666, 2027498542070.1208, 1629256824892.8726, 1788031440106.1792, 1911284523747.404, 2134527972128.266, 1721492627108.547, 2024306151096.3008, 1760933250146.508, 1807795344819.4932, 2137929444313.9656, 1311000000000.0, 1467137485318.0513, 1419667161669.3005, 1311000000000.0, 1636894942119.9038, 2107820103925.8196, 1755003590919.451, 1911627787535.1865, 2238557885243.514, 2335126328667.4946, 1823359564896.1577, 2345862140347.2505, 1876187051687.135, 1591405637851.08, 1661388833642.2085, 1420081802179.0012, 1577170034766.8506, 1732419038727.841, 2128132323382.918, 2503483943570.1475, 1445035175946.9866, 1978813289536.758, 1535167485892.551, 2007714232612.4697, 1803463999487.9534, 1334640863219.6199, 2175659716478.8845, 1658272700125.7646, 1679286154052.3662, 1527246606964.7063, 1643861934921.398, 1991139647226.6802, 1784983580998.964, 1956453233555.295, 1968011735766.0527, 2332223064120.9004, 1737098392217.865, 1421007310134.6294, 2229854653353.6753, 1740577689708.4995, 2248640705377.3774, 1975504100205.3372, 1803447748477.1663, 1963435097702.595, 2607679222393.578, 2623000000000.0, 1868644304103.2817, 1898940404018.1743, 2233418782612.5146, 1589078497769.6963, 1957981324256.522, 1837387944811.2695, 1951347738557.503, 1592541720248.1038, 1392923141453.0784, 1311000000000.0, 1514417208044.7104, 1701808551235.3062, 1752423340808.2847, 2601322253148.365, 2245218757208.6123, 1556646609992.384, 1963063945818.6353, 1717431146425.5127, 1755165296074.384, 1907412486707.983, 2059748784682.7156, 1738184016360.297, 2228523822083.5483, 1507845815806.8743, 1847896752319.4778, 2623000000000.0, 1920209052102.546, 2379179456458.7944, 1875985539440.6687, 2045790428625.4385, 1827353611046.0776, 1790948395240.324, 1607813010737.0898, 1991990019328.949, 1587425606116.8447, 2076750108186.5964, 2237000140059.42, 1969619031771.6597, 1754579475451.6902, 2000356095873.7844, 1747625036606.9482, 2178455143085.2744, 1334522621464.2092, 1739308345842.6113, 1311000000000.0, 1416433573212.895, 2350135491790.6494, 2162938286102.7334, 1624989869189.9792, 1414567762258.7327, 1311000000000.0, 1676434842457.902, 2623000000000.0, 1993607492410.413, 1671668345566.0571, 2004297599519.825, 1399998754701.4316, 1751141456744.683, 1878631192907.2124, 1817890067021.49, 2123321351044.982, 1961999244568.0315, 2077758423273.525, 1633967270968.9744, 2163946154165.246, 2463096292543.4004, 1554426570139.343, 1577292439276.7039, 2338477857403.1416, 1784319942794.9229, 2366826375148.652, 1706679968941.5342, 2388396135773.7046, 1889311119328.8923, 1932199818980.6965, 2435240886206.3833, 1731267680928.7524, 1562438315435.1396, 1704858754685.795, 1999778135616.1538, 1398808936094.354, 2066435246397.7136, 1677838068102.663, 2261909547852.833, 1311000000000.0, 1605797267223.3762, 1369222286972.2988, 1594556627734.4277, 1928588532265.4626, 1788153295223.9104, 1764823833546.467, 1794511629350.96, 1913524038654.311, 1543894708243.7231, 2091982913684.3127, 2075676668151.8035, 1976085262734.2783, 2037025279950.7651, 1945312571736.3691, 2623000000000.0, 1817570223475.8655, 1748117182528.5264, 1615220716612.4255, 1537420701463.21, 1480711601184.2346, 1576984724681.115, 1822861535312.807, 1958406078008.6316, 1862617873048.2698, 1611789393844.1484, 2164854316284.805, 2104082430948.3477, 1794364347192.1487, 1644260005509.562, 2034103161379.1084, 1908307204921.4834, 1428256295119.238, 1823733448836.719, 1933503021968.8672, 1573944078345.958, 1908939250787.1504, 1426563730054.4778, 2338644256810.0537, 2302382074525.6265, 1765092728853.328, 1968545948945.2292, 1311000000000.0, 1504002718549.1018, 1752241063312.7544, 1526602826970.42, 2094780901455.2285, 2623000000000.0, 1498613922980.668, 1591387267133.7205, 1924419979243.6216, 2455334610253.732, 1486517838161.1033, 1929056606757.0364, 2548455783740.127, 1377665018910.3938, 1471145262432.1262, 1712411123878.6335, 1683249902899.4304, 2131533306313.4875, 1926538130034.919, 1347930120575.9016, 2022243280201.7832, 1666357581362.1392, 2313212105047.944, 1651652448631.2083, 1649013793628.6199, 2031476356610.3267, 2112862997606.4175, 1998278926949.5955, 1369433477350.6294, 2030362344415.6433, 1536863874963.5178, 1924361270684.5894, 1434439848625.3755, 1997650057997.578, 1600110034875.6929, 1470737446452.5981, 2094567089490.1426, 1926532944427.9775, 1655638615905.7979, 2386761076075.107, 1707249311413.608, 1856349385973.707, 1935859593163.5054, 1653971274369.7556, 2006448493989.2363, 1679419366935.331, 1716044681800.0706, 2349627926119.4585, 1535156035890.257, 1311000000000.0, 2455256705935.966, 2623000000000.0, 1717981462610.5125, 1311778068416.6162, 1747064621457.102, 1754587487644.0483, 1784768783371.4463, 1515489378889.3374, 2045349911049.036, 2025503990990.4468, 1416597947407.211, 2089149417858.6458, 2623000000000.0, 1902902845656.7224, 1738779275508.599, 1799980581754.34, 2058321352384.6191, 1358544956781.3237, 1900353479916.6738, 1722492095294.246, 2560456429192.674, 1789754537048.4946, 2480146417038.682, 1518080951041.051, 2048140366576.6516, 1953246684511.817, 1582510426362.783, 1904735665252.5215, 2287979734384.2163, 1742951864660.4922, 1367890538953.6536, 1840090852699.456, 1573183735511.4695, 1737235366936.6519, 1819343607333.9727, 1364578113917.162, 1386501534714.636, 2010336458061.598, 1682614958347.9297, 1311000000000.0, 2121080480231.7886, 1937044955687.6558, 1626603875655.6135, 1461857262592.834, 2140311977663.8057, 1963634961183.0605, 2623000000000.0, 1988425507304.6099, 1977018239083.6294, 1792052434383.08, 2133109819515.2424, 2061907330971.6514, 2303921910953.9194, 1683030951698.9897, 1708835926936.1338, 1695662721461.4685, 2123319696224.5615, 2406794681279.1934, 1701758758296.97, 1712057199110.63, 1951406149176.2197, 1767205917198.098, 2184832952740.3235, 1311000000000.0, 1594422327303.9128, 1606977782430.4294, 1311000000000.0, 1556220084953.1338, 1569640068186.313, 1781238111864.3005, 2247993029065.1104, 1767425283700.2688, 1537815280067.9868, 1827298158183.329, 2222738208006.416, 1552828109419.1113, 1570914129072.4175, 2037752544492.7444, 1774804308930.4058, 2070103315499.0835, 1841367492368.8914, 2090062376227.731, 1536654288476.454, 1841877002368.5188, 1778216813022.7336, 1488225701275.5095, 1399374167777.6196, 2084179691321.5347, 1734587870991.0566, 1540141164087.035, 1814648174392.7942, 2253994094617.4155, 1311000000000.0, 1416037810067.7993, 1567492572701.4604, 2390991917686.8433, 1940553264285.8347, 2114506657308.6199, 1508320515881.468, 1513840191002.8213, 1998177837182.4492, 1864972152214.3022, 2034215165763.1401, 1785481033882.257, 1939026794868.8406, 1898243857126.4841, 2118423766392.5854, 2129422956179.3035, 1385467229542.5889, 1311000000000.0, 2204145839016.3027, 2277954986953.5254, 1540593277163.3286, 1327820212910.8245, 1878483921339.182, 2176639129190.4258, 2537779355475.321, 2022561045216.088, 1728220686905.5466, 1575774928860.0537, 1849570602505.3025, 1750539479222.4224, 1542109720579.2478, 2623000000000.0, 2532200512407.0977, 2257201841373.2754, 1568057903442.91, 2147606686867.2246, 2067224263198.2793, 1996314390260.0684, 2303081612403.8022, 2065666925211.211, 2104306612516.975, 2066228618986.9336, 1960660573405.852, 1345866948000.964, 1873362919527.5483, 1672669429783.5432, 1471465314617.0266, 2486272259059.0347, 2507133638031.767, 2348204336215.942, 1931168212751.9165, 2344632365872.1465, 1849767773194.8901, 1913323774132.9224, 1520844476655.9917, 1980273080481.1074, 1865669736439.649, 1465532621052.151, 1829162353405.2263, 1819942448873.6636, 2537764363587.249, 2162566108366.1416, 1849568685382.5361, 1928971602705.9453, 1860333313677.113, 1780667419430.7437, 1523822131724.2507, 1797098301664.798, 1617347379199.436, 1479179917778.217, 2020743691672.0466, 1978265665507.2488, 1345129096641.6099, 1806149627710.153, 2201787721360.1978, 2226698054025.4146, 2213570425121.5894, 1858588187305.628, 1589251787658.0767, 1523478986701.716, 1961985233673.6885, 1974071164324.739, 2318496442716.54, 2242828729827.8403, 1803099275964.5386, 1480781335226.3706, 1744398692816.5698, 1918221110330.2163, 1780929425552.959, 1666252751605.9666, 1930371947404.665, 1688215024441.585, 1651512471577.7793, 1950499358421.8809, 1718978728648.465, 1927372432902.333, 1937331181748.6995, 1508516046958.0933, 1695020792200.6592, 2381102688173.15, 1502476717758.927, 1311000000000.0, 1327347677206.5325, 1855364085895.4695, 1855958061221.2095, 1807773353058.8096, 2288656944080.9194, 1311000000000.0, 1979902256222.2727, 2433826727214.673, 1511631274010.2795, 1725746351731.444, 1615402567333.7898, 1575435766954.8728, 1742189483689.7092, 2376766580412.773, 2555727314036.1743, 1739206123337.2803, 2586542950441.843, 1857490173360.7524, 2518123220106.224, 1815574088961.6963, 1889167915908.9197, 1969250375393.391, 2623000000000.0, 2146187013124.6184, 1628509286029.6587, 2191399299290.5566, 1731248652501.1667, 1692468319301.9314, 2168083787632.0017, 1856013385507.4573, 1939175219240.3167, 1850400825870.1052, 1959199818339.7354, 1990108598057.472, 1311770311408.0833, 2077113321448.898, 1551162252012.7258, 1429731290063.9592, 1826826794391.4956, 1873482340561.4143, 1632482280912.1316, 2138502332365.0269, 1455310092201.826, 1717472053505.2402, 1664194202154.0693, 1830656342611.379, 1939274259198.7722, 1544070560252.5237, 2098451866083.9136, 1866534461633.2532, 1320290333585.8394, 1311000000000.0, 1841800462177.199, 1774983106753.8584, 1812322467245.1445, 1836698329426.476, 1921052667601.0605, 2183129489742.999, 1516102300599.0366, 1499846773448.0889, 1520884209631.7917, 1942729886669.7358, 2301158042786.736, 1710067537096.4153, 1311000000000.0, 1364979195277.2534, 1592635386273.525, 1672214193920.221, 1717032615884.1333, 1858478879746.8865, 1746674074166.7588, 2222803552132.4873, 1637546522504.3762, 1584397575349.1514, 2009200544354.2153, 1406289947419.7383, 1977714639146.2322, 1879654809392.553, 1798247449934.16, 2445422595338.259, 1653226964162.0923, 2623000000000.0, 1773580320870.2493, 1472201578838.6372, 1868822509703.98, 1525491424126.68, 1615727625449.118, 1980287809088.7046, 2036682090330.8877, 1653238601366.9463, 2198554986842.3906, 2265796709728.9414, 2380480674681.319, 2027264686524.482, 2349955058996.296, 1322899607675.1636, 1744769478100.0203, 1583082840957.423, 1885213298669.2432, 1668155739114.4392, 1792296863339.0435, 2576080589986.231, 1791166564691.1575, 1986174261052.1992, 1771433769463.3545, 1870741087315.7715, 1847791248562.4893, 1998358451979.44, 2268928808668.686, 2471160954500.782, 1949866347561.5967, 2048970375099.771, 1505463957610.9897, 1817318329976.7756, 2180285584749.1384, 2151775333062.2822, 1916312295596.4475, 2159573343184.8843, 2013436363181.5251, 2283036373811.046, 1942882139270.5571, 1733130509630.5464, 1958942417557.0542, 1311000000000.0, 1975332188383.254, 1311000000000.0, 1360280395699.711, 1999577914755.4485, 2008721568525.1167, 1502383781769.6428, 1627114659381.4417, 2352916984479.148, 1694183746321.064, 2623000000000.0, 1845195811437.4377, 1984150499040.9202, 2457839883715.638, 1889157640973.7476, 1545588744414.055, 1810299117585.9243, 1834218607256.2488, 1449505343946.4006, 1764056821336.8037, 1618466650973.0618, 2174142374247.83, 1857172873492.7144, 1755652803065.5134, 1811436217609.8164, 1920223429284.986, 2058889177382.537, 1546309307035.3074, 1534883746144.4749, 2244696256541.1846, 1715832391078.0981, 1436191895684.879, 1996762428991.0327, 2003690545856.502, 1407517561432.532, 1922387466897.8237, 2102655842216.9023, 1972361016677.474, 2064427220908.4277, 1439393489891.8755, 1957277433754.0742, 1749499620255.9365, 1694555839875.8066, 2153524098482.423, 2398666958221.753, 2536330515450.692, 2329806412521.8457, 1810296959876.7654, 1964807137853.3936, 2114321528853.3372, 1885865177642.8906, 1889069672437.124, 2135747359037.977]  # Truncate for embedding
baseline = 1875000000000.0
mean = 1869834127046.295
std = 318544070298.885
p5 = 1372226389821.7358
p50 = 1841523802806.4355
p95 = 2469124938770.4927
display_name = "Total Annual Infrastructure Destruction"
units = "USD/year"

# Create figure with two subplots

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
# Handle edge case where all samples are identical (zero variance)

if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax1.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key statistics with formatted values in legend (use format_parameter_value for full units)

ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {format_parameter_value(p50, units)}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {format_parameter_value(p5, units)}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {format_parameter_value(p95, units)}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {format_parameter_value(baseline, units)}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---

sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax2.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key percentiles

ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"

exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title

fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark

add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from

output_path = get_figure_output_path('mc-distribution-global_annual_infrastructure_destruction_conflict.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 1.875e+12 |
| Mean (expected value) | 1.87e+12 |
| Median (50th percentile) | 1.842e+12 |
| Standard Deviation | 3.185e+11 |
| 90% Confidence Interval | [1.372e+12, 2.469e+12] |

*The histogram shows the distribution of Total Annual Infrastructure Destruction across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
