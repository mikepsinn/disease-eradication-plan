```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Annual Global Industry Spending on Clinical Trials (10,000 simulations)"

import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Simulation results

samples = [81209835064.37898, 66741234619.496414, 86657179268.555, 89088688096.25073, 58279299700.38459, 64232305658.150894, 79143038096.4374, 74179814983.76862, 77491532427.89236, 68588903557.99797, 88299134047.76111, 87002792364.38081, 78433094985.33974, 91541605381.11035, 83159036611.40782, 68526336594.368034, 81971112255.33687, 67536706828.54119, 88286955660.92332, 77118126642.97903, 75615281349.66078, 70334640308.22531, 92819371900.56062, 75950574099.49834, 72976445208.41188, 73792366726.03015, 83947690256.48479, 81931627956.77383, 82498070283.8483, 82715760053.64124, 104000000000.0, 73210180783.28552, 72088146723.28781, 68983421493.24237, 84976921667.70805, 91564660227.89334, 76401453235.76804, 68718124544.941345, 68875622571.4478, 85406330038.16348, 86566427164.00641, 84080399802.33844, 70493166101.26344, 80355663740.94868, 79014450028.64932, 80198032523.79202, 88196774836.5394, 80255408644.58504, 85759263604.5013, 78450802570.1165, 81025457326.23601, 85166577376.53021, 62793392003.39247, 74142715928.42526, 72530029046.37881, 70767789604.18138, 74625965046.73224, 96668706026.37561, 68460924996.574165, 89448707776.14305, 60754485072.40311, 73978317224.10233, 79546839950.47333, 84609461067.59521, 86163704282.27824, 87200032091.47383, 73829075783.99371, 72614983009.78181, 88024246230.74777, 75544261590.57666, 64481526593.83372, 65837523945.142334, 67926828065.05096, 83519001746.18245, 79311486459.58868, 85903884577.1836, 72987896502.09448, 79498000229.26192, 85095940127.8004, 74254488450.7614, 83029103019.31157, 70530059988.42508, 73674877186.8771, 73474286729.50227, 65238433924.43095, 83395144346.07181, 72540301032.76617, 77823255241.31511, 83319546979.65262, 82905287919.1913, 85590493027.52396, 76573934410.51381, 73030027885.71979, 76783802928.25568, 60714822020.29814, 62885669104.86058, 64039927396.63868, 67159256954.27066, 82342466340.94801, 68065611644.36388, 73512629557.8238, 93860317109.24532, 73747906537.43417, 86494132395.65962, 67786421074.451485, 75388679457.17569, 67624179398.85079, 73933556356.3594, 87798168768.42406, 60360734276.4788, 82759184607.42795, 80420972254.74689, 71231394440.28705, 62895366580.09909, 78502865390.50021, 71906870097.3413, 80361694003.14047, 77929515001.85587, 98324603348.63731, 75016589377.95189, 66902188404.75043, 79738648553.9483, 80213323800.89513, 94682202078.51468, 87731778009.87889, 81829348223.65576, 96183398838.82326, 65305938313.151535, 70758763578.06017, 67856182737.74774, 73387794135.45488, 63536511636.599365, 85214497225.60431, 75204315082.4091, 62668187452.0423, 66979629630.657486, 81314002650.53484, 87770292993.7288, 104000000000.0, 104000000000.0, 82518226685.06192, 67234932175.063065, 57000000000.0, 80773069314.20139, 68991800242.72536, 73114708179.91718, 71045016337.10692, 76102919578.04703, 90729394316.17314, 79480722814.80476, 75905108768.1141, 66783473477.97937, 60827281518.6142, 72361539685.03362, 77074767367.61143, 100953033616.98839, 79171125574.06075, 89637137091.85367, 72224501768.29439, 65342399580.45039, 67475229260.70492, 69881198472.60153, 104000000000.0, 68906757185.17659, 87774926096.7254, 68090987368.99274, 88972186555.2378, 82164823796.04916, 75927220799.7371, 77221244897.57587, 70603603059.47517, 82899744774.31888, 72693111947.4982, 64955245359.08642, 64460312036.36507, 79660956737.87018, 97970743983.23395, 79514826985.22556, 76349201540.67908, 80986581032.40833, 93952810173.5067, 80206143771.58421, 73161990387.79991, 91263010062.10475, 82690884878.04958, 97298175630.33557, 79784673518.95944, 64966037658.06556, 63615763327.057625, 99095317611.36597, 100246391845.0606, 75674237174.04152, 73458748337.18633, 96154960913.33675, 66090464416.720055, 68172592537.056595, 85316012200.73328, 73336458624.15225, 77623614478.62209, 75851895349.03001, 81599592670.57721, 95349339723.94475, 78714368284.854, 85323615841.30188, 57376229355.49064, 77131707322.46606, 68687282163.62912, 65019762602.74449, 68337832718.88338, 73986538311.11513, 88769509804.15195, 64005364603.181206, 78029333985.17068, 72384128123.41075, 74056203677.22021, 89898621824.44962, 84018714728.3197, 94382708938.20534, 75950837785.48218, 70180634462.62862, 75186368102.48633, 80476796006.19849, 79707246971.42065, 66309631494.57816, 78713276688.96532, 80309616082.55325, 104000000000.0, 102711842295.16104, 68586905852.58068, 74492809936.79279, 62735703372.41536, 71267204544.2609, 81338784607.4936, 92594364330.36089, 69841845199.69125, 70610213413.17676, 57000000000.0, 75860492091.2119, 66522868194.21981, 71907429330.93677, 68350725744.27115, 76621108720.32356, 60079225816.33394, 62702659820.9115, 104000000000.0, 64371006200.96318, 66189621645.207016, 102063682097.97493, 104000000000.0, 65470264539.56755, 73619048722.15125, 81646940682.63354, 100326486621.09056, 67261271284.761856, 74951807147.32924, 86997037743.75296, 82763313279.91905, 73534156223.31271, 76180301121.43388, 63553143425.35678, 75029524429.14172, 74721340705.52773, 80355764067.02289, 71636221435.45306, 83207860531.41861, 90028975597.25975, 79461965132.50671, 81768388148.46701, 78286001719.67842, 77682564024.57945, 69918636478.16568, 81349325319.32085, 76587324241.52586, 104000000000.0, 97881464252.10071, 82175545807.39775, 69496224970.24782, 66038665977.770996, 92396459729.94017, 80714677971.0417, 83312225509.06415, 60203500009.25722, 88918667643.45718, 83000624345.31866, 66057782761.842094, 72517833930.46147, 80726065050.01329, 78278143120.08513, 74440793223.48474, 76518085441.42987, 74878588535.34703, 79428765923.23079, 96308792100.55504, 57000000000.0, 75044011780.35086, 79706538997.67665, 81106669863.43044, 73579681763.53316, 60088735633.33072, 81485775058.40996, 100305033215.16476, 62093028186.513664, 88099256840.51721, 74046996762.82657, 76990046255.84123, 66615422336.45131, 73982946479.6841, 93871459093.17276, 84565517505.03369, 100384048474.55455, 92212109811.78929, 82815424038.82225, 100569385476.21931, 82814295750.50214, 87640860519.2475, 74393024099.75623, 78438985574.80159, 70165458067.83313, 89726456430.45474, 65405838330.853134, 87060546949.5286, 75551460573.65714, 92129460650.9435, 86662450377.7256, 101800739751.01611, 86409286988.33752, 61747316494.4045, 76926874429.65483, 65466049491.996376, 72024652652.82341, 96919434994.2124, 85244071630.82343, 70150024814.61978, 66997849851.56471, 78053804995.46095, 65041174773.61084, 70435239402.41307, 81296179136.64586, 91916163051.18555, 84887645322.58537, 57000000000.0, 81205689085.47485, 78501767426.0654, 82511985697.41214, 98550306977.70279, 57258202195.32673, 71263080558.43141, 84667198113.42778, 61661101072.009415, 96377104599.04326, 81966404618.21722, 87878409288.5695, 71473107546.80968, 87459579615.20477, 90762285932.27698, 80364057666.42868, 80381896355.31302, 80804054704.52715, 68485785771.15072, 76028167439.4461, 75972810121.0757, 82146185369.77979, 89860255676.29453, 66560574504.75413, 76278294558.13618, 96461564360.5836, 69694081068.40936, 68898069609.19058, 80006768752.82812, 87850288139.26927, 77811136545.8985, 94266987188.80861, 88009104701.73132, 87817493097.83661, 84214753049.42946, 104000000000.0, 75391713264.57918, 57799507740.34032, 98363286091.58307, 72664304071.48491, 78913088971.43669, 94001307704.63692, 61475027978.243515, 64708488397.99273, 61483853974.59702, 69181528155.46947, 82822059022.89062, 83848445901.30643, 80873925971.30046, 63202255050.444, 57000000000.0, 78299679389.12413, 72515175062.7059, 83060684438.16743, 86047448928.49734, 79263125124.1635, 86779412613.67136, 80321123166.14146, 83920250711.65167, 70091227510.19753, 75673219457.34319, 79942306762.95, 87545745842.31996, 73345704888.8585, 83811563265.96556, 74727322306.67279, 76361408522.2292, 87660392354.45764, 57894840919.59108, 64285912469.665184, 62564004820.65007, 57000000000.0, 70362014110.32121, 86644345813.54547, 74519977458.63293, 79954122526.64496, 91036639880.728, 94249519963.35866, 76902368817.74489, 94605118458.37001, 78732062506.56033, 68745812440.7335, 71228790754.2588, 62579090761.17067, 68238275474.531006, 73729048135.20462, 87330086586.15704, 100200324377.61679, 63485487934.82098, 82259169017.33069, 66735775858.735214, 83246154468.35985, 76210710194.86583, 59391716935.915764, 88929777906.64531, 71118651645.85782, 71860624448.12308, 66451583615.59645, 70608802787.41814, 82680452986.4331, 75566964837.68925, 81493689504.48862, 81889591187.92065, 94153302411.517, 73893080581.13223, 62612760754.454636, 90745792753.751, 74014992060.41542, 91373320797.65375, 82145984881.80542, 76210144653.79951, 81732884891.33157, 103926068468.92397, 104000000000.0, 78471416427.06091, 79517133293.50829, 90864926003.25107, 68662901618.138275, 81546054933.95326, 77389205773.4883, 81318675625.66354, 68786280339.47026, 61589243895.66667, 57170324117.19156, 65990698578.351006, 72653956015.91469, 74429711840.6595, 103699427621.77155, 91259089040.57922, 67505059465.37795, 81720173449.19582, 73203095639.05684, 74525633607.91855, 79808996487.84503, 85016428139.22627, 73931124782.26854, 90701299572.33119, 65754347092.08702, 77753442913.10362, 104000000000.0, 80249375511.41754, 95723996256.90483, 78725101645.82362, 84542389347.45955, 77041048486.23157, 75774878694.40857, 69329733126.86172, 82709498359.81548, 68603999058.1821, 85592987275.22894, 90984598578.96863, 81944609440.15958, 74505142214.9736, 82995125886.08026, 74261785205.42963, 89023658860.03838, 59387042842.97152, 73970520672.24347, 57915348520.623245, 62446328689.32364, 94746576356.02353, 88502253731.97498, 69939852469.65611, 62378405920.98969, 57000000000.0, 71760048331.32341, 104000000000.0, 82764738422.3413, 71591845343.99593, 83129615044.21811, 61847467417.062485, 74384858077.72346, 78816479560.18803, 76712366509.86154, 87167780928.83908, 81683706375.05621, 85627153678.78888, 70258250161.55576, 88536142187.7697, 98749771976.49161, 67425639530.15744, 68242643138.080605, 94360565023.27795, 75543824540.60435, 95298612270.56088, 72825288718.029, 96057116385.72942, 79185106466.55931, 80661521995.20636, 97747185757.50142, 73688675151.92647, 67712153664.083305, 72761245473.79877, 82975400929.20003, 61804061998.473564, 85243290728.65532, 71809549183.00366, 91815949074.28537, 57000000000.0, 69258054923.28882, 60722515879.395836, 68858039288.50848, 80537445788.06029, 75677466870.29385, 74863294888.79225, 75899019375.3057, 80019387734.108, 67048584179.75973, 86108811165.98259, 85556610677.0208, 82165864963.87141, 84244403568.86171, 81111681518.3805, 104000000000.0, 76701252296.60489, 74279012844.24142, 69593001715.71729, 66816568984.80086, 64776386929.35557, 68231663081.103905, 76885072436.1818, 81560609251.8981, 78263025692.65378, 69471081090.6847, 88566675567.8068, 86518025474.66682, 75893889080.46284, 70622897571.49695, 84145007352.85007, 79839805247.93283, 62876339280.350716, 76915353084.44612, 80706286561.8138, 68123143498.59176, 79861567497.98819, 62814818473.59598, 94366077483.47986, 93163001990.63824, 74872690475.41435, 81907878415.97845, 57000000000.0, 65616035074.66087, 74423334234.89159, 66428473522.42866, 86203480958.76997, 104000000000.0, 65421983517.195946, 68745158021.25429, 80394168585.70015, 98470586272.20145, 64985929864.56057, 80553530312.13791, 101811277414.99742, 61031576453.47637, 64430812708.812515, 73026742306.01837, 72000387338.0945, 87444781971.9099, 80466978784.95473, 59916634972.810844, 83741313955.97543, 71404330493.43036, 93522688791.79134, 70884531984.73116, 70791169425.02261, 84055633187.9046, 86814710673.7649, 82924230054.92871, 60730251130.08794, 84017723531.29706, 66796605005.82984, 80392150298.02005, 63100982892.77109, 82902763387.08795, 69055731234.23318, 64416071556.02468, 86196247487.79976, 80466800551.17752, 71025520371.15382, 95998034628.05145, 72845307102.04446, 78046130178.41977, 80787219509.95532, 70966555191.76248, 83202985217.64804, 71865322570.70744, 73154398796.12762, 94729777329.85095, 66735365242.0302, 57000000000.0, 98467783383.92609, 104000000000.0, 73222422374.92119, 58409727145.39471, 74242166686.55971, 74505422481.72603, 75559475269.27678, 66029243011.86848, 84527419001.92697, 83852348462.45795, 62452311757.693054, 86012915462.6774, 104000000000.0, 79653669855.1373, 73951982930.96194, 76089464114.8033, 84967979221.96602, 60331151404.49908, 79565830767.96057, 73380789191.05392, 102240412313.4742, 75733275121.32166, 99362584369.80112, 66122388914.48117, 84622238235.75267, 81383780652.38795, 68428773964.045616, 79716806450.77779, 92684169755.85025, 74098154854.34534, 60673733008.96179, 77482926355.25853, 68096001049.63475, 73897880916.47215, 76762870821.08548, 60552358627.66219, 61354679068.63719, 83335571647.4311, 71978003151.83795, 57000000000.0, 87092157803.9732, 80827922003.85399, 69997119852.73871, 64094895499.564804, 87740674909.68497, 81739729752.97296, 104000000000.0, 82587732924.24237, 82197777385.71165, 75813347624.49759, 87497936795.7491, 85089679932.38504, 93214162721.9415, 71992668661.91676, 72901086766.81064, 72437670161.91098, 87167725088.87418, 96721505814.70647, 72652204275.07993, 73014305289.29393, 81320678401.64816, 74946518968.83157, 89237763909.31084, 57000000000.0, 68853256835.35417, 69300035115.7116, 57000000000.0, 67489802546.92772, 67969468303.37106, 75436343501.62965, 91351702561.25443, 74954182031.80307, 66830715055.35943, 77039123464.13876, 90507812341.04312, 67368442995.712654, 68014966944.81371, 84269137361.66914, 75211847612.59296, 85367684203.68413, 77527183540.6622, 86043815955.8627, 66789090324.52952, 77544845080.97993, 75330939717.54271, 65047536581.90924, 61824682895.11559, 85844662371.49706, 73805085781.15216, 66914086846.20173, 76599697277.71317, 91551961532.28938, 57000000000.0, 62431922752.30281, 67892762462.8082, 96150900354.34775, 80948361348.17719, 86870221987.15587, 65771426884.98978, 65969952781.73047, 82920779405.56572, 78344450470.15501, 84148817693.70204, 75584309387.01872, 80895963093.51819, 79493126356.87962, 87002481466.74629, 87373616227.80188, 61316879868.88524, 57000000000.0, 89885379192.85162, 92350538474.19469, 66930290220.70603, 59121992093.60954, 78811393601.68347, 88962672886.71613, 101429233285.61876, 83752136056.27005, 73581806415.28757, 68188490560.411446, 77811422863.98174, 74363792462.85184, 66984631912.9992, 104000000000.0, 101229501900.09875, 91658964098.60507, 67912957258.15382, 87986374036.57355, 85270051810.92314, 82857165647.93552, 93186244796.04398, 85217229717.37733, 86525603232.16267, 85236282226.77377, 81637850255.52844, 59835193432.07076, 78634495344.45782, 71627179617.10857, 64442380971.51706, 99582599206.12738, 100331227044.76024, 94682656712.6962, 80626082643.73523, 94564400909.46857, 77818251945.65485, 80012495601.88864, 66221682689.931786, 82309086845.14052, 78368573308.57785, 64227868472.174644, 77103832179.79128, 76783675800.43239, 101428696643.28236, 88489738904.87895, 77811356463.0353, 80550609358.04834, 78183993725.42857, 75416436374.34851, 66328632747.45984, 75989108335.57474, 69668541388.86362, 64721084256.49304, 83690238231.75325, 82240441115.09311, 59806062856.472984, 76304157901.42033, 89806363025.09776, 90640251106.25163, 90201018974.80486, 78123610586.94968, 68669076328.67651, 66316309796.75716, 81683226463.11424, 82096963091.91835, 93698075087.81361, 91179285235.02013, 76198017453.94167, 64778904481.666275, 74148824071.63017, 80180999173.3892, 75425575927.72423, 71400627996.29721, 80598725648.64331, 72175372268.40309, 70879579926.815, 81289585197.65149, 73257442741.52641, 80495653315.05122, 80837749612.92467, 65778461838.32581, 72415070760.25356, 95793524400.46964, 65561096579.14283, 57000000000.0, 59103297602.11697, 78012025357.9484, 78032585412.59648, 76360643545.18362, 92706697724.22415, 57000000000.0, 82296407098.48485, 97696239536.38141, 65890520886.294815, 73494996897.67865, 69599461829.62073, 68176386194.61235, 74071452423.65147, 95636754350.27339, 102071339539.78116, 73966939048.55516, 103172179830.57112, 78085612728.50569, 100725210127.94049, 76631880506.43896, 79180166276.0567, 81931990965.1766, 104000000000.0, 87938569288.27068, 70064713069.27734, 89458073855.93336, 73688007867.6509, 72325194008.74992, 88675234100.91325, 78034500362.39497, 80901058314.71013, 77840177040.39995, 81587805410.91476, 82645233247.54675, 58408541781.923515, 85605294991.96031, 67308823227.00257, 62929940951.16011, 77022759831.36134, 78638621622.13048, 70205605184.34721, 87679698114.18268, 63857868345.8647, 73204532308.12831, 71327912986.14102, 77155681606.7263, 80904458190.45007, 67054883836.40047, 86327651487.75531, 78398473616.60344, 58823971943.687584, 58209994340.724724, 77542191967.57117, 75218088496.68509, 76518846019.43944, 77365289914.64214, 80278388091.02373, 89180589793.04144, 66051275215.80248, 65466390078.37533, 66223110056.1365, 81023063587.98705, 93122329131.81456, 72944379054.33374, 57000000000.0, 60567057992.88878, 68789616536.83105, 71611112099.30869, 73189098790.5476, 78119828080.03381, 74228494055.25659, 90509998168.67087, 70385103034.93741, 68496062362.36233, 83296840007.92328, 62076861733.12514, 82221595869.45229, 78851827629.93324, 76029123216.44037, 98113855403.33124, 70940229242.05711, 104000000000.0, 75169121513.67795, 64468991421.97704, 78477576754.12357, 66388572685.58362, 69611008944.30255, 82309590457.22198, 84232731332.83359, 70940640862.26685, 89698013841.57233, 91945524815.41528, 95771038489.01785, 83912290017.24239, 94740604606.99469, 58927272330.329666, 74161808037.80771, 68449185618.57247, 79043713142.65765, 71467833122.12512, 75821863859.56053, 102798656669.59038, 75782480901.80196, 82510808015.45097, 75094177887.8443, 78543892394.64027, 77749788072.18658, 82926944579.41425, 92049900181.42714, 99039711916.18027, 81267878092.40514, 84650437068.29312, 65668632370.483795, 76692499014.65158, 89085119554.79231, 88126710357.28596, 80115331879.7822, 88389089447.48239, 83441249114.81334, 92519685926.92741, 81028288345.19023, 73753993737.54475, 81578986239.9896, 57000000000.0, 82140104006.76166, 57000000000.0, 60394800182.09429, 82968567426.1673, 83280506962.95436, 65557750399.61995, 70015241025.06328, 94838623765.01558, 72385599790.99422, 104000000000.0, 77659865078.16922, 82441642156.33333, 98560715184.8888, 79179811811.57953, 67109265165.730644, 76448490122.80742, 77279279212.79138, 63647554306.95527, 74836492911.49786, 69708290821.22025, 88878810223.55807, 78074631466.16135, 74542685116.48795, 76488031170.42516, 80249869973.79959, 84987252706.98868, 67135072237.58461, 66725600297.758705, 91241643956.02124, 73146941852.8924, 63164600861.09795, 82872461676.50319, 83108904856.41972, 62121601867.31765, 80324287948.95224, 86469800506.77313, 82038448882.37422, 85175175786.74715, 63280815844.6991, 81521934596.70177, 74327400419.78233, 72398700911.1917, 88185566657.36847, 96428102860.90166, 101377369049.68265, 94073194282.26324, 76448415087.0877, 81779871442.70816, 86863970054.24411, 79066209779.46542, 79176777060.16718, 87586849230.87932]  # Truncate for embedding
baseline = 78500000000.0
mean = 78324867767.79265
std = 11094930537.049343
p5 = 60832526251.12057
p50 = 77532601947.6579
p95 = 98966527082.74483
display_name = "Annual Global Industry Spending on Clinical Trials"
units = "USD"

# Create figure with two subplots

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---

# Handle edge case where all samples are identical (zero variance)

if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax1.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key statistics with formatted values in legend (use format_parameter_value for full units)

ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {format_parameter_value(p50, units)}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {format_parameter_value(p5, units)}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {format_parameter_value(p95, units)}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {format_parameter_value(baseline, units)}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---

sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax2.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key percentiles

ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"

exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title

fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark

add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from

output_path = get_figure_output_path('mc-distribution-global_industry_clinical_trials_spending_annual.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 7.85e+10 |
| Mean (expected value) | 7.832e+10 |
| Median (50th percentile) | 7.753e+10 |
| Standard Deviation | 1.109e+10 |
| 90% Confidence Interval | [6.083e+10, 9.897e+10] |

*The histogram shows the distribution of Annual Global Industry Spending on Clinical Trials across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
