```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: dFDA Annual Net Savings (R&D Only) (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)

setup_chart_style()

# Simulation results
samples = [41216222097.23078, 28102466410.578915, 42212861177.085106, 45490738497.803986, 29238477253.772503, 29543867612.905167, 38135766477.99187, 33398169588.28298, 36698639081.54507, 38495568597.55017, 54993400255.38297, 42712024760.552765, 42102005402.22055, 56513746919.6153, 43166240599.65921, 38966520174.9292, 41207847083.84189, 31666995681.430107, 45126486320.43942, 42831475052.50316, 40475590125.32825, 39982177371.503716, 44960816050.02814, 44011746593.80957, 37039519755.95772, 41656212369.236496, 46838865477.37365, 36239988568.85017, 47726059213.65094, 43092688585.01477, 67704384109.82521, 36475813701.70549, 45028258811.77147, 32925009767.737953, 37411123756.14831, 55061722009.436714, 34986372799.09271, 30713062222.998016, 41529733740.61873, 44432382188.76319, 47866975952.3115, 49269595571.71921, 40711272837.497284, 41644653013.59946, 31119884979.45516, 37056385932.553345, 43128885093.01687, 48599183300.80926, 53707940123.55063, 34736957117.051056, 41482498433.31879, 54333119750.86232, 33074325074.78028, 42154638946.20439, 41046420293.8634, 39590661746.46283, 37900346183.16168, 40857369862.667336, 38175964551.23702, 51969987957.58493, 28373244017.50366, 49357845092.27851, 27750469418.765472, 29752610045.70401, 37282836833.73823, 43313980395.02174, 39288697837.08521, 37436076129.841866, 47050467186.816025, 37508398787.54115, 40849227770.209526, 31786076335.840923, 34324495951.451057, 38491539772.3804, 41724958262.828995, 52267953423.693016, 45934667455.237885, 45053214393.14505, 46162179905.66282, 37122181470.78706, 47306325859.18528, 34097493555.50191, 41292582455.19716, 38789102755.61895, 35719059018.87992, 50794536667.35755, 32751450732.69883, 42188030307.484955, 54401401135.72773, 40497680136.21018, 45421582961.86957, 40261700653.25121, 36625542689.033485, 31355905110.311474, 27025461529.22628, 34392492336.82673, 46262656040.694626, 29786166417.168777, 41583781592.903305, 42261006617.928215, 37328210891.86014, 49389867844.27005, 35618324124.95527, 45236796638.810486, 42607407878.69741, 28266551972.241974, 32059019588.3937, 36512579151.29728, 49457207415.489174, 26777368530.73318, 42276170655.9749, 38472434989.45391, 37937876053.31985, 31362389692.472084, 36234842476.194275, 42051297028.79023, 49285168833.828354, 43811725101.18315, 61462779580.9484, 36442952096.65777, 37508540090.982666, 38672562212.68352, 46332152455.1336, 50848278794.04507, 49606833798.71317, 37441360153.66723, 57265820447.79739, 39397012801.80545, 25920110525.13268, 43820060961.53431, 48463819953.07829, 28095728918.06739, 45571478310.588806, 46393305310.80631, 32706801662.726513, 38870031040.2964, 43318113066.03804, 41823829686.99854, 50881614240.09775, 57458731630.524765, 41667275207.00194, 35634259584.532455, 31847936192.351612, 39663268774.75405, 35895490562.53413, 42171530785.21655, 44364430231.339806, 40404742180.111465, 54821575567.26126, 33228593229.18595, 47000982026.49372, 39913054114.702675, 38124036568.93269, 35316641333.23313, 39673545747.3142, 62507115328.20025, 51296682692.79398, 49324964085.32858, 32766607685.67042, 33771479817.43211, 34840679917.428665, 38993141072.87248, 64629844136.58086, 35848369936.64683, 55456828064.09973, 43165797447.41717, 55360583887.789536, 37163928856.16656, 43744868690.00082, 33145532294.079315, 34258821527.719074, 50277477582.8482, 33770523602.565037, 29331997851.007378, 39512684857.98393, 40496286758.654785, 46185065720.52713, 39012514411.74898, 46758294869.968544, 36721214485.0312, 59499112208.06192, 49863789469.26085, 37813387062.5071, 44594108603.25266, 38584541928.7462, 62567349948.00628, 37414066334.070045, 29097015985.552643, 34212050017.64339, 64141626441.17594, 62797564708.35784, 34082626286.1052, 37340366949.49178, 38477466819.534615, 29763470951.265266, 37434798255.64648, 46191651423.81713, 28371198277.65363, 41870968893.47789, 35660009018.39702, 36247268578.27771, 50461961012.66395, 40203490923.385574, 54889143883.564384, 30083598493.632072, 36216121775.94047, 40650438173.00486, 33788762396.185444, 38873943851.744865, 36581211569.23113, 50103841031.954445, 27508349753.20874, 44122433437.46455, 36744370612.89749, 31723185599.635925, 48231978569.75632, 33386189353.78529, 48448816004.186905, 42288129610.32823, 44910467697.46725, 36193484670.878235, 45201675415.58192, 38743255848.66314, 43354029857.38249, 41905017141.77926, 47732396221.304016, 43389172818.81188, 45143527571.9741, 35755799763.06652, 35109458148.10067, 34538027939.80845, 36130024432.461266, 46276976146.3758, 47255577971.880104, 36984909514.6925, 35678115586.586464, 29983741997.80481, 39133287970.65605, 37586219818.44648, 30657642022.71326, 35055559107.058014, 40254921764.729805, 37771472329.0361, 36510939319.40093, 52480365294.51536, 41639522796.49336, 35497686293.36809, 59803497993.44096, 61214634678.589905, 42292117527.26852, 39612516142.88964, 50341129559.129906, 47518936129.55749, 41182749635.40699, 41757400246.236336, 47576346104.70231, 41140015482.06644, 45848336538.08647, 42284221541.30965, 34569607923.90834, 39314502649.26609, 39695103741.7425, 37991684729.04367, 37825948774.41352, 44685708407.8155, 40481886723.34424, 41064875191.34108, 44427547437.60596, 47141646777.649765, 41115882019.7458, 37839355254.35633, 44761699504.24145, 46219271481.739815, 58497531578.29755, 60663453520.3333, 42700363472.50104, 41796282883.44627, 38655561812.30586, 55447991004.43952, 40480585586.61091, 46447417633.075195, 31070316507.5701, 40111359783.5276, 43756625625.662186, 36129699670.8232, 34638115654.49734, 42785113348.34194, 49333123223.72244, 33566234993.906944, 44795428922.704025, 48376262659.56183, 37249105238.983505, 44643156909.42873, 34081462390.570347, 34882786257.907524, 37813206823.46212, 40125724934.46225, 46062772980.30666, 28643695328.124184, 35908735651.11191, 51051134003.95029, 38654505815.923676, 48804134505.53071, 39903234895.45126, 50832283269.82411, 33097174094.523083, 41084603143.45557, 44362432980.57001, 45688616449.51264, 57891413065.23501, 49042653595.196434, 44780000312.691, 47675749068.65328, 38797941668.309654, 40605584777.20597, 48092644662.82297, 39108104259.340355, 35998458513.31798, 52537043249.141655, 32475863253.12595, 43619689557.564095, 38614326964.02602, 49150122150.827065, 50145971230.230034, 46391036934.12333, 54458184940.22104, 33967264374.93055, 37521271361.95485, 40126247892.03694, 43111872374.12686, 57189209789.530556, 58804831475.32868, 42095780119.94169, 36470833125.03715, 46334445632.94602, 39506638611.847466, 28474729541.281994, 33681837118.7146, 42616764706.25256, 49483071977.58296, 28227025585.46459, 32528845335.730167, 39019190975.68776, 44432840780.96395, 56867106959.197624, 26952887489.194927, 39130650391.09804, 46203801006.44199, 39626075030.34853, 51997168744.47638, 60432184545.25381, 45432667630.28554, 37013233654.631035, 50363058199.941315, 56595639293.79393, 38012464214.40414, 37895650760.83745, 43214134844.079094, 38909362409.007774, 33406482476.9037, 40948212722.683334, 52360866931.805984, 48345799002.519775, 37440720368.309364, 51614213267.66217, 54580187415.12241, 40331596050.38889, 42987374587.6221, 45740527047.91934, 45648814221.939514, 45169065986.63592, 51913030494.48391, 48528671146.36452, 60991800102.38835, 50069861884.88371, 60299215111.12242, 43952045499.695786, 25925681509.78007, 57289565160.45729, 38456581901.89617, 39420132669.623055, 49126993979.18838, 31738256258.206963, 42135794841.1572, 29159582443.20099, 27209771274.351368, 48641263386.25745, 45559905693.851524, 41870437457.217766, 23646822199.97579, 32503779034.162292, 43544823399.36315, 42145260616.359505, 45006318585.827805, 49285477934.11832, 46918903771.56588, 42544783554.81298, 36839396496.79239, 49642987961.19887, 39104925163.981995, 41971934666.71163, 32275376791.18164, 50639332681.84709, 34448789983.68787, 49737392000.39612, 48541751783.05516, 44364213838.13371, 45849255252.42077, 29182212106.02077, 30370363526.564114, 29578224957.286583, 28813301339.49142, 43405086327.94033, 41399341185.437614, 43410183584.38023, 45942656241.96813, 41913566456.461876, 51545461723.07034, 43415711802.637474, 48593668687.62614, 50305784015.12625, 39231174060.89565, 38774356985.58262, 33940570917.85334, 41442196851.47796, 35216878071.36939, 45794630616.69172, 54993277969.26775, 34508379587.73356, 36333037984.45083, 37339798302.364914, 27506100866.841022, 41755466641.56152, 24604221645.373215, 49966602732.40984, 37669959850.972496, 43762010834.30467, 33093266876.418194, 42172610229.11514, 48019768592.858, 35120236554.38402, 40806387264.39744, 41069877088.88445, 49707070753.61366, 33609309642.0589, 35468179600.767494, 43937417546.087074, 32740421220.16123, 46732267502.259895, 48675028796.631004, 35834383111.35906, 47566325718.78671, 68887309192.50514, 59921572467.47733, 41522550926.08496, 43147321777.35399, 51911311290.02841, 29447970428.361122, 54773423446.28481, 42564294381.13869, 47554949537.653, 36585494228.23042, 29869600553.285984, 29274212550.921097, 35704149872.34593, 40606501331.88013, 44876768323.912, 49701524733.084206, 50233478529.351845, 39912956516.16766, 52797208514.515495, 31197194274.46734, 37462692904.539, 45253706387.57107, 47851602811.702644, 50810153419.33137, 53607771063.12522, 34765157081.90032, 46032377090.03705, 46363615814.87431, 48400471198.29555, 56221938286.060684, 36451255640.19016, 44426182582.63252, 41244400100.95597, 49060035609.12815, 36162888776.986694, 42974291094.529106, 39794959328.84679, 44110042929.64149, 46539020444.73966, 52803493479.23235, 35784089753.54429, 50436678213.86529, 40545588670.61323, 44348819285.65986, 29982339920.860897, 41010522205.50774, 33450027698.489353, 35357410973.35512, 49061459254.10827, 45520721757.78088, 38472687990.83317, 26939723581.920567, 31482708878.742535, 30389460336.014633, 50275510734.051414, 52589371454.75387, 34011800407.981373, 43275404734.736565, 29069926122.11474, 36562625753.390465, 46507478166.87924, 40531834600.794106, 41425057519.14828, 45834415790.75699, 51204770187.81401, 31883983586.441372, 47366075367.20466, 64453371451.679726, 35824922866.87579, 30082190045.845654, 44372175778.370255, 42999179038.11894, 40694716069.44906, 46252888618.13466, 58381399181.48251, 45960914761.607735, 39360791473.814026, 51994545118.29644, 48458648611.6908, 38810496648.53307, 32670902149.87137, 39054784988.63553, 33631906339.292767, 44479370480.4864, 42558550213.9337, 39446592618.44046, 30849417945.603527, 37899051273.75606, 31649691312.11297, 27771952644.513416, 43462116653.575005, 38799426164.105804, 35539581987.2166, 38806878904.8519, 35431734727.03978, 28865288217.55149, 46066991304.3781, 42648938291.75927, 42961291918.69994, 60082765445.99601, 36175083423.21193, 60883650851.90998, 36029368662.62626, 39282518508.194115, 34484722027.294975, 39949940102.48074, 33493308269.918705, 42811082522.06399, 43065022700.52344, 43128239517.46345, 36463483062.90527, 41789357930.37431, 45239640523.1453, 49515724218.72275, 49525516530.621346, 44400107079.22239, 48632932396.492516, 40852871997.00403, 30831155556.787205, 30732428258.350143, 42144042125.00542, 28179408424.70657, 44082204817.83255, 30640414933.26416, 50633724680.6603, 48375261516.0961, 41292237459.82056, 43430092099.12597, 37760943062.685, 42318824197.8555, 34007504043.16467, 36313098474.08971, 49068173659.21857, 43129328225.45732, 32214689512.8359, 35536366869.64003, 46716821351.398186, 55793667018.37523, 38922945301.96447, 56133510074.11336, 58614811836.25975, 34351537408.589542, 37523882813.85435, 34906356421.30764, 44303625277.020134, 51666598378.114914, 43408852797.9648, 32131485458.78076, 46126930900.38511, 42168386873.217995, 60185177400.91837, 47871153990.97003, 34419627823.1546, 45308714295.98237, 42887607958.528755, 39134275998.72157, 27121941694.905064, 33017464632.7899, 30745237196.36335, 29462520024.355408, 27479461972.93218, 50128564698.47299, 33656575015.56266, 27769544558.821346, 50081986427.00864, 47081754989.21008, 41811541163.840385, 55356217948.758095, 48405298104.870125, 36856653749.90488, 41620900083.87324, 41171430635.146225, 49038332789.22858, 27989147439.875443, 43830808989.9374, 49320772471.58457, 38587655923.9071, 30103122442.05259, 57785720356.44235, 49419488158.11674, 37893507649.91614, 32288811770.33256, 36177557224.52435, 39682287164.63488, 42626242663.69844, 28400731987.36423, 40152908334.94421, 47858716406.513794, 34930646095.23464, 35968875978.58909, 53098041762.00189, 32971759396.66898, 41120944301.22633, 33420186231.4881, 42456430106.656136, 27166170561.74258, 36651656640.85694, 38086481153.76389, 53097250888.46188, 31617192018.0303, 55532880648.84671, 33522263213.17978, 38998247365.58123, 49035844987.04317, 33620505562.914604, 46518374943.724525, 45898953848.0274, 31326626794.743286, 32687709540.661354, 38371377286.40751, 32848280304.267365, 33425403630.061226, 44103815021.27397, 28401080060.96361, 33310750939.15157, 47678875450.21994, 39177265802.18345, 41079974455.9647, 45047030425.5777, 37173618454.677216, 39466651761.466805, 34870147097.25183, 37862157058.087845, 43660615573.83196, 55207078547.33451, 45584481336.11025, 44966919686.48784, 36465705511.45083, 40853671826.06056, 49253296132.94046, 39201854497.896095, 47973432101.34996, 35584466058.739426, 33816578189.472397, 51552828868.48336, 56283768453.400314, 37560169867.08098, 38615577110.77177, 42731163565.74332, 33866816562.89028, 57974681412.22973, 34325637711.98826, 39964121572.532684, 40972788034.51226, 28544814465.942303, 27298801572.708378, 28100482092.13462, 40457917769.01133, 37083604070.74672, 41591703339.69438, 29688897630.083405, 41210873873.901215, 46447818495.39009, 31592928359.133537, 37072871237.79571, 52464690225.80381, 47349879909.80702, 40766434461.09207, 40920120181.92292, 45287284205.74043, 39465310346.56162, 33745748136.568523, 44677439731.65141, 31306849685.48544, 32899361892.331657, 46864663959.446526, 37308616329.168076, 33816424816.603935, 35762480036.80301, 53149024901.09266, 24060061198.155586, 24633873918.436447, 39789426828.45087, 52879940632.33905, 39107138192.34406, 45009534031.9826, 35070109084.54851, 32289019304.63726, 46167635037.854614, 38670418027.49916, 40751165942.56333, 39939364258.43616, 37864962650.472664, 26457096495.74187, 49628904114.17343, 49981828556.57191, 33935485043.70823, 26798107070.89381, 64413120037.427574, 58413237156.48481, 40036823938.039505, 30490578368.94091, 43100759161.22003, 55443577785.427246, 55323992472.217735, 37762445062.99677, 34101711515.01163, 38873732891.74967, 40506685882.75403, 38549416539.2901, 35562804119.74583, 41433800363.732574, 54466773707.2978, 45578561912.97892, 26258072785.930443, 42295456550.76434, 40358958802.54207, 45024848455.131355, 47282406419.089775, 38527399994.89193, 31154796879.924362, 41828732047.92862, 36528568717.6665, 31990577547.110676, 43700826770.90868, 37886157351.18099, 33472061384.450752, 48638087940.67463, 48811338211.40806, 47041925268.41374, 40581020498.80763, 50944745739.47044, 45926884378.10254, 40148894740.927704, 37802979574.76878, 52015315819.59198, 36642564071.448494, 28007176053.91327, 41149034280.23614, 38641023920.37103, 59098211108.2091, 51045047135.4624, 44686702969.333534, 44153801946.8797, 44610512801.76055, 34404941647.57834, 34832720207.48464, 40236222893.39625, 36504537851.03388, 27251350060.285664, 40542295928.43021, 43013859101.93526, 30366524999.369625, 37307874541.36679, 45281790318.6119, 42563950329.86149, 49229402140.448746, 43507492745.959854, 38224552507.58928, 28426646528.348293, 50779778011.63099, 51187022635.3885, 52811885787.14691, 50026425885.29711, 44713550803.66339, 29242215901.022713, 44120942997.45655, 45738329064.17384, 43396052710.78466, 35174203486.154686, 46030357543.05854, 33333662106.268185, 41702829561.98608, 31573118230.368046, 39700780356.95373, 49917475719.42106, 38300610656.721245, 40034698592.65417, 38949953775.55523, 53634390802.70288, 40407546308.06287, 22797341744.443607, 32243829133.61242, 39256116709.29462, 44166392145.363495, 33512277639.633644, 46902810718.02452, 29808506417.854725, 38203661300.2659, 51489477305.004974, 33957798134.595554, 42246539894.57324, 36020462862.09828, 32310780432.35805, 36533131790.34155, 44111073325.11335, 48672974577.45431, 39763239750.992004, 53386278400.028206, 40769787382.242615, 63876894115.223236, 40365857534.39083, 40239610376.7372, 37945857761.16183, 65511278989.45111, 56095403027.07228, 35967639715.97231, 49343459309.52352, 40816477101.20816, 32765957377.380234, 53836195327.145874, 35369649494.439804, 42547576355.04397, 39141713952.26877, 37663409378.67472, 47847229980.19381, 33820497119.372635, 35960782652.65705, 32622783238.09129, 35250058375.80017, 45358064921.312675, 41435842526.78827, 33504564012.190548, 55740381343.87873, 43831882886.61115, 42051814986.59567, 36262005105.95577, 47387929027.28036, 48567137438.41335, 38843280663.365875, 47507681865.58116, 43143226135.06048, 35022084148.45955, 28275453086.24307, 51836448487.82808, 48325423276.93837, 28227955384.606277, 35426857643.59707, 42929400818.00769, 53050389356.13301, 29464683190.671272, 38185919582.57798, 32045166141.773983, 44153671859.93945, 49551008442.42789, 34958661316.69628, 31147242528.263298, 30521502368.67844, 31815512597.168324, 27263154336.25985, 41360827741.8394, 41501905795.312515, 40313357575.45828, 40137115774.4118, 36987566721.21469, 36365935269.260056, 40889523749.215416, 38502128987.837906, 45940840329.585304, 40768669062.227, 41586718470.602486, 41659546080.67121, 26304258009.510788, 45100669044.87706, 42384275040.38892, 36501625954.74597, 52182188096.98118, 31980096729.957546, 38677776214.75859, 49230020658.7794, 43274301397.710075, 34936370225.61786, 45576280222.25551, 41404551952.96519, 63845043915.45372, 42226653903.86503, 55857292496.99344, 38401467094.22701, 47018304527.110306, 32230980597.07925, 40960528902.90172, 38874628861.37047, 46546556057.546234, 54767784736.25471, 38053075075.67076, 42093087111.85371, 25969742222.771233, 43438498523.19471, 44805345852.264595, 43216482119.150444, 54959347016.33617, 49732987280.44505, 47285526207.38559, 44304262302.65624, 31924351029.99503, 37005912967.70895, 51350529048.53321, 47358423456.68649, 41524544322.10784, 49857916483.21528, 42340982644.86597, 49396914243.018776, 50401290453.75264, 33933688206.713234, 38212445431.71047, 35120332049.98301, 48343697307.631134, 28499986720.88045, 29502514220.16932, 40003089743.789856, 49441036539.23529, 32432344338.858345, 33954133960.90426, 56497881058.19838, 31149068249.652206, 54412872236.479996, 32999467351.28285, 39440722698.07002, 47150970559.409065, 30541775894.63484, 37563206848.8739, 41002201137.169426, 35020551331.41919, 36459656778.44906, 35265746859.815, 40802322548.11687, 40443165814.310036, 44560802715.27861, 33099844248.54171, 41016457048.6458, 43413025781.66953, 38811932907.57491, 32790122144.24287, 34971899854.40069, 38655400731.075356, 39582777949.591286, 35688074761.65531, 40909876216.00149, 39709476565.01008, 35977745779.50015, 43686999174.749725, 44152950561.412094, 30352493535.464344, 43698944846.37177, 25715608020.028755, 44998463591.50192, 51761735524.5831, 39600252547.137276, 49734418730.78902, 50165527211.67055, 50132522858.25674, 48429226338.12514, 39386126683.29973, 49987632156.287766, 41804028356.55219, 46745405703.24556, 39220205248.965355, 49785475313.71592]  # Truncate for embedding
baseline = 41460000000.0
mean = 41261206072.25406
std = 8016173352.626009
p5 = 29076059620.754673
p50 = 40696200412.59558
p95 = 55523200879.3425
display_name = "dFDA Annual Net Savings (R&D Only)"
units = "USD/year"

# Create figure with two subplots
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
# Handle edge case where all samples are identical (zero variance)
if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Mark key statistics
ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {p50:,.2g}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {p5:,.2g}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {p95:,.2g}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {baseline:,.2g}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---
sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Mark key percentiles
ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"
exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title
fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark
add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from
output_path = get_figure_output_path('mc-distribution-dfda_net_savings_rd_only_annual.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 4.146e+10 |
| Mean (expected value) | 4.126e+10 |
| Median (50th percentile) | 4.07e+10 |
| Standard Deviation | 8.016e+09 |
| 90% Confidence Interval | [2.908e+10, 5.552e+10] |

*The histogram shows the distribution of dFDA Annual Net Savings (R&D Only) across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
