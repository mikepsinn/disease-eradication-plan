```{python}
#| echo: false
#| fig-cap: "Probability of Exceeding Threshold: NPV of dFDA Benefits (R&D Only, 10-Year Discounted)"

import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Monte Carlo samples

samples = [273848500912.11984, 186718187812.44632, 280470362501.5856, 302249209391.898, 194266062183.23633, 196295134421.93414, 253381361748.68906, 221903857500.18912, 243832811126.84213, 255771956180.98822, 365386720414.84, 283786901283.81726, 279733815428.14215, 375488195845.66895, 286804798614.0579, 258901048972.73416, 273792855713.57986, 210401605350.74503, 299829047920.2826, 284580551980.5493, 268927599749.59616, 265649270584.75873, 298728302803.6921, 292422502936.01337, 246097687841.10287, 276771880840.548, 311206424139.1259, 240785448972.98495, 317101109831.69165, 286316104892.88354, 449840940053.0596, 242352316478.63562, 299176405474.4613, 218760092716.44855, 248566696236.51273, 365840663279.4521, 232456184867.7496, 204063488117.55267, 275931532524.23, 295217286670.3544, 318037387725.97766, 327356662045.16705, 270493520984.83548, 276695078260.1163, 206766496698.2496, 246209749959.89523, 286556601448.61456, 322902314071.4813, 356845876247.84796, 230799019141.353, 275617692064.43, 360999689844.25726, 219752172313.17416, 280083522809.9508, 272720305096.53452, 263047965527.05133, 251817184064.68277, 271464217698.2838, 253648445472.95114, 345298588042.15247, 188517286273.28983, 327943008820.3365, 184379452148.9425, 197682059263.4167, 247714333268.7047, 287786410208.3872, 261041659279.05148, 248732484602.9006, 312612346564.1492, 249213010240.26273, 271410120071.1748, 211192800104.62393, 228058547886.6716, 255745187892.265, 277228641769.77045, 347278327864.61334, 305198758703.2824, 299342215153.2917, 306710395149.26074, 246646908161.08856, 314312320756.5532, 226550300340.6572, 274355853806.05743, 257722253541.18796, 237324292926.13412, 337488663761.256, 217606933131.53815, 280305381431.74603, 361453364488.2236, 269074370027.34943, 301789726720.2272, 267506476989.94577, 243347144646.68396, 208334659808.09528, 179562360392.41525, 228510328939.25433, 307377977900.8044, 197905014244.5889, 276290636842.203, 280790250063.56384, 248015807231.25452, 328155774138.98395, 236654990930.77582, 300561970875.95264, 283091806614.5726, 187808403819.55023, 213006287531.23303, 242596593191.63275, 328603191192.07825, 177913982829.72028, 280891002846.70496, 255618252042.77524, 252066539734.83603, 208377744618.23474, 240751257344.3576, 279396899249.48737, 327460133791.62744, 291093521697.1038, 408370519996.43695, 242133977659.06464, 249213949087.48508, 256947935776.13263, 307839725434.7725, 337845736779.6051, 329597337638.74023, 248767592672.72678, 380485116907.05347, 261761324721.58072, 172218195885.0846, 291148906755.33624, 322002933973.83136, 186673422617.32886, 302785660225.3317, 308246036760.7587, 217310276129.58887, 258259956618.0985, 287813868468.8728, 277885562513.9377, 338067223889.88, 381766855880.47156, 276845384460.81555, 236760869186.82422, 211603808880.0553, 263530380577.2791, 238496538010.34726, 280195755434.7706, 294765800805.6252, 268456872385.3911, 364245084164.171, 220777159579.66385, 312283557648.472, 265190002381.85373, 253303425978.54224, 234650552482.50665, 263598662758.08823, 415309287410.85925, 340825018461.1203, 327724541090.7984, 217707638840.07867, 224384202408.71768, 231488173361.42703, 259077923334.90897, 429413105578.53784, 238183459515.89337, 368465823841.60944, 286801854225.3929, 367826359037.1474, 246924285812.93167, 290649314852.1519, 220225286763.43018, 227622194393.50467, 334053223830.7876, 224377849133.367, 194887431004.8804, 262529872093.7094, 269065112159.07974, 306862452901.61755, 259206643521.74402, 310671097538.7544, 243982806446.34473, 395323536576.0149, 331304600497.87256, 251239410954.4808, 296291828050.2352, 256363112093.13638, 415709497801.2725, 248586247289.75543, 193326166329.90582, 227311435491.59933, 426169293380.2726, 417239088913.75714, 226451519345.46213, 248096574414.41785, 255651684488.89304, 197754221207.31058, 248723994161.1533, 306906209579.975, 188503693984.55786, 278198764461.41614, 236931953374.17432, 240833818754.75815, 335278967194.14075, 267119720357.4577, 364694021043.5656, 199881210123.73825, 240626873413.96155, 270089323782.20392, 224499031183.47366, 258285954089.36084, 243052600166.77042, 332899549215.64136, 182770762558.28473, 293157927598.0336, 244136660210.23785, 210774941966.37997, 320462535265.71246, 221824258519.71902, 321903244853.80536, 280970460437.80615, 298393778672.8858, 240476468137.329, 300328618718.9147, 257417637880.10947, 288052506533.37195, 278424987566.8239, 317143214128.44086, 288286003123.19403, 299942273270.61743, 237568405491.67108, 233273987582.18954, 229477295455.7843, 240054826116.93674, 307473123435.1147, 313975142040.1198, 245734846902.65756, 237052256893.10544, 199217744374.15732, 260009086258.4534, 249730068125.93176, 203695265655.71646, 232915871994.7077, 267461436751.78278, 250960921409.75525, 242585697833.35602, 348689633157.54913, 276660992111.6929, 235853449992.4651, 397345934233.62573, 406721797574.4849, 280996956924.39056, 263193170337.08228, 334476139794.4031, 315724944254.22845, 273626103442.7288, 277444192542.5161, 316106387162.64746, 273342169514.9066, 304625159497.88916, 280944494476.15936, 229687118939.46466, 261213111410.57828, 263741898216.2759, 252424054917.77234, 251322873382.60794, 296900434756.2113, 268969435556.95032, 272842922982.20163, 295185163654.48047, 313218161289.3488, 273181822153.06598, 251411948611.92386, 297405334205.50635, 307089722553.0803, 388668842379.236, 403059644028.15784, 283709421444.8321, 277702536256.94806, 256834981848.73618, 368407108718.8427, 268960790554.4301, 308605569429.69794, 206437154244.53787, 266507583357.664, 290727430192.2379, 240052668338.19785, 230142297467.91956, 284272515907.8998, 327778751974.38257, 223020516355.4509, 297629438944.1897, 321421186488.17285, 247490214070.3181, 296617714423.0063, 226443786199.84082, 231767935979.93753, 251238213411.626, 266603028181.29556, 306049916432.29224, 190314216758.7776, 238584540924.4163, 339193545780.7239, 256827965605.8222, 324264049264.98596, 265124761602.00296, 337739459442.5198, 219903985591.67206, 272973999287.5426, 294752530687.6613, 303563948532.9853, 384641674489.23157, 325848815937.4334, 297526928294.05646, 316766839559.27856, 257780980975.84543, 269791309200.19376, 319536774009.62463, 259841760840.44354, 239180676864.6467, 349066212380.95685, 215775876952.41653, 289817600638.2095, 256561009591.887, 326562857675.30084, 333179470349.93854, 308230965230.1203, 361830646998.4909, 225685032636.34528, 249298538098.63254, 266606502811.92844, 286443565674.65454, 379976100969.8147, 390710601954.72314, 279692453456.2516, 242319224570.0399, 307854961748.8815, 262489699672.35767, 189191575597.6587, 223788599090.11182, 283153975175.1269, 328775040313.5097, 187545782909.2707, 216127900091.80423, 259251003895.71442, 295220333645.0725, 377835987860.5118, 179080164522.526, 259991561672.9566, 306986933741.94885, 263283258191.22607, 345479182414.1033, 401523048510.41254, 301863375387.5325, 245923037931.99295, 334621837898.3942, 376032304518.5126, 252562117812.09256, 251785986776.35278, 287123017178.72314, 258521281790.86722, 221959089929.82965, 272067795119.21445, 347895663069.45575, 321218780096.0104, 248763341815.84952, 342934752626.3789, 362641254889.25037, 267970875441.64417, 285616378454.0311, 303908852525.4373, 303299494883.4453, 300111955405.829, 344920151710.7203, 322433817765.7009, 405241241823.88196, 332673785232.0904, 400639574034.80164, 292025837392.8371, 172255210577.76297, 380642881341.43475, 255512921082.25504, 261914937566.74155, 326409189657.95685, 210875074318.3384, 279958318954.3905, 193741869899.09668, 180786949761.30334, 323181902246.5221, 302708769535.6014, 278195233496.76776, 157114031352.08475, 215961354766.7237, 289320175494.68195, 280021211384.05096, 299030630396.6249, 327462187513.3596, 311738213948.2064, 282675718570.988, 244768030445.75043, 329837552842.7219, 259820638319.8959, 278869600463.2764, 214443806367.99698, 336457458653.0498, 228884381324.77945, 330464791422.55176, 322520728029.82605, 294764363047.57556, 304631263612.49286, 193892225728.04007, 201786532115.5792, 196523411221.1026, 191441111694.68494, 288391735536.2424, 275065179327.61206, 288425602687.6649, 305251837737.6738, 278481790856.65814, 342477954150.8309, 288462333232.22784, 322865673921.64557, 334241297207.02356, 260659460254.61993, 257624279811.0941, 225507676177.3396, 275349920609.1651, 233987706197.2979, 304268327034.46344, 365385907922.3885, 229280306106.5162, 241403687173.29547, 248092796213.6193, 182755820525.04672, 277431345301.4394, 163475177268.79883, 331987711577.79675, 250286452995.93475, 290763210553.43567, 219878025283.65945, 280202927467.4899, 319052571394.8097, 233345601385.02557, 271125479517.09195, 272876156550.7887, 330263331231.5237, 223306712596.23938, 235657401855.96957, 291928646457.73126, 217533650930.489, 310498166705.5284, 323406246122.3793, 238090528360.56967, 316039809792.8179, 457700521647.3903, 398130443731.72015, 275883808524.0108, 286679098322.6754, 344908728985.906, 195657975097.45438, 363925152218.103, 282805352250.85913, 315964224258.99036, 243081054976.24097, 198459366680.06186, 194503494365.41705, 237225233691.19064, 269797398965.60043, 298169873558.34106, 330226482405.24274, 333760885663.2306, 265189353918.42978, 350794800404.9625, 207280154512.29462, 248909331569.43558, 300674322496.583, 317935245625.22626, 337592424462.73553, 356180333759.00555, 230986385127.53018, 305847960295.5899, 308048774043.7966, 321582032672.1308, 373549363201.96783, 242189147998.1423, 295176095295.72705, 274035720984.36798, 325964305378.6249, 240273183138.12408, 285529449211.41986, 264405357928.12674, 293075602682.73987, 309214196115.4352, 350836558918.4414, 237756369625.42596, 335110983419.8506, 269392683537.40915, 294662078682.278, 199208428705.47842, 272481791298.28732, 222248412750.95056, 234921433806.94717, 325973764349.4815, 302448423933.6326, 255619933032.56308, 178992700992.639, 209177168415.82104, 201913414987.76218, 334040155709.37537, 349413891035.94183, 225980938599.2637, 287530106107.6409, 193146176070.85483, 242929112434.33853, 309004623159.2566, 269301298854.1521, 275236043591.1782, 304532667377.2197, 340214334113.47516, 211843314694.2947, 314709307971.0229, 428240587143.9732, 238027672678.06937, 199871852125.95734, 294817263708.7032, 285694809491.81586, 270383514635.89694, 307313081268.1263, 387897236415.4457, 305373150851.24316, 261520663257.0705, 345461750537.5321, 321968574587.77875, 257864398677.37698, 217071752866.6934, 259487497358.51163, 223456849395.49432, 295529485911.18884, 282767186899.9843, 262090742551.9914, 204969461744.5925, 251808580437.72467, 210286631795.2952, 184522190829.6482, 288770655980.35156, 257790844251.2186, 236131813034.2796, 257840361693.06927, 235415255110.62445, 191786522503.81412, 306077943788.1377, 283367742660.6377, 285443080188.9143, 399201440860.4906, 240354206711.31955, 404522677418.62415, 239386049837.23682, 261000602630.30093, 229123120728.24304, 265435079973.7266, 222535977185.5702, 284445060089.09454, 286132287439.2487, 286552312120.5652, 242270389344.63574, 277656525537.83923, 300580866190.03595, 328991988079.03894, 329057050081.2663, 295002844639.64923, 323126549549.40063, 271434333014.37723, 204848122923.46945, 204192159778.36816, 280013115493.31396, 187229405341.70728, 292890640917.7067, 203580805562.56223, 336420198015.3695, 321414534698.57794, 274353561590.47104, 288557878685.83, 250890962940.511, 281174401176.4946, 225952392725.70813, 241271205234.3047, 326018376147.4681, 286559545705.71405, 214040588427.24997, 236110451175.19113, 310395539510.6253, 370703846590.50543, 258611529142.152, 372961829166.8739, 389448074953.0942, 228238216524.9661, 249315889086.94473, 231924540675.49036, 294361801003.0914, 343282809368.06085, 288416760686.95844, 213487764701.21658, 306476193983.73, 280174866679.2274, 399881885571.4301, 318065147417.79736, 228690622325.55447, 301039805611.97406, 284953509796.30176, 260015650906.80872, 180203393155.59668, 219374380608.64743, 204277264824.2629, 195754645409.51044, 182578826594.2181, 333063818007.6035, 223620752821.6759, 184506191045.50287, 332754343020.1701, 312820228736.4219, 277803915204.35785, 367797350899.13776, 321614103567.08984, 244882690952.08133, 276537259229.96716, 273550897829.61066, 325820107672.17224, 185965274792.45035, 291220318721.6976, 327696691203.5018, 256383802075.4605, 200010930989.32925, 383939431819.0535, 328352577196.87524, 251771747535.50958, 214533070951.52884, 240370643122.6763, 263656742414.7697, 283216948545.955, 188699921627.92465, 266783639918.44403, 317982509716.3051, 232085925937.26575, 238984124818.47476, 352793594318.0565, 219070706235.8235, 273215456924.13672, 222050140308.99713, 282088681280.8867, 180497258247.15997, 243520650761.4092, 253053900582.42886, 352788339602.2596, 210070700239.40817, 368971131831.1268, 222728359393.41388, 259111850525.03836, 325803578236.3245, 223381100446.13577, 309077023438.85565, 304961470633.219, 208140129052.4946, 217183424401.29507, 254946805241.57172, 218250287414.603, 222084805707.8428, 293034223262.6116, 188702234295.8148, 221323031194.4708, 316787611839.2631, 260301283423.17007, 272943245398.27118, 299301127684.2846, 246988665367.66925, 262224019353.40195, 231683958967.4354, 251563448178.16837, 290089520955.81696, 366806440053.15015, 302872054825.9327, 298768856537.38116, 242285155719.90222, 271439647232.34705, 327248365441.3507, 260464655443.15793, 318744702839.87354, 236430031431.69513, 224683844659.95737, 342526902880.83813, 373960174716.8408, 249556987242.54932, 256569315807.13004, 283914063183.7681, 225017638068.20074, 385194925389.9119, 228066133963.1144, 265529304386.27206, 272231078214.10663, 189657233306.6425, 181378484174.21753, 186705003619.33856, 268810181217.7968, 246390592501.07455, 276343270450.3543, 197258741729.21783, 273812966288.4493, 308608232835.95935, 209909487826.4935, 246319281496.21725, 348585484988.45624, 314601702239.48676, 270860025413.44797, 271881142879.3293, 300897419973.78235, 262215106734.96695, 224213236175.718, 296845496082.6298, 208008726137.6457, 218589683303.01355, 311377834212.19855, 247885617190.8721, 224682825621.14276, 237612790514.2504, 353132336092.56616, 159859670675.91708, 163672192669.86703, 264368598932.21136, 351344488495.97235, 259835342105.65286, 299051994438.8502, 233012544841.4979, 214534449849.33502, 306746640095.95856, 256933689397.6793, 270758578441.90408, 265364812033.33514, 251582089073.17667, 175786033876.52554, 329743977056.32666, 332088874879.76306, 225473884652.07123, 178051773676.26358, 427973149011.80914, 388108774040.2646, 266012352875.28302, 202585262632.28232, 286369727352.266, 368377786443.5537, 367583238639.6265, 250900942519.25012, 226578325274.28455, 258284552430.6086, 269134205938.19077, 256129732254.88205, 236286105345.83862, 275294132730.8735, 361887712417.61414, 302832725041.001, 174463682098.4015, 281019142038.2199, 268152678825.7656, 299153746409.51184, 314153395399.5091, 255983450102.56635, 206998458074.6448, 277918134742.1362, 242702830943.6061, 212551545455.15173, 290356691877.33826, 251722910738.06784, 222394808795.10675, 323160803975.78467, 324311912071.307, 312555592416.623, 269628099413.5349, 338486681704.88214, 305147046442.97455, 266756972828.4304, 251170261605.74435, 345599755068.83673, 243460237982.7691, 186085060369.01617, 273402092143.25848, 256738389300.7005, 392659872619.8734, 339153103456.6622, 296907042814.0808, 293366346003.2655, 296400820697.82556, 228593044552.50668, 231435287518.7915, 267337197856.92813, 242543165247.23453, 181063207206.02966, 269370805925.51685, 285792346657.15594, 201761028203.17688, 247880688610.157, 300860917531.83655, 282803066308.0506, 327089609163.07697, 289072143458.93524, 253971273193.01874, 188872102818.70847, 337390604416.1597, 340096415964.27844, 350892319025.1337, 332385188102.9224, 297085424985.22266, 194290902474.09302, 293148024828.17456, 303894248699.0043, 288331714447.69965, 233704168051.55215, 305834542037.33026, 221475257392.06433, 277081614428.4806, 209777865523.68982, 263779614738.72144, 331661302261.8354, 254476618153.37936, 265998231672.07516, 258790978631.41635, 356357200424.7765, 268475503550.42233, 151469919944.86136, 214234197667.9992, 260825184004.28143, 293449997701.68756, 222662013323.6575, 311631288607.5722, 198053445502.64523, 253832467996.50522, 342105982917.62396, 225622137116.25375, 280694130373.25055, 239326877986.9334, 214679034964.158, 242733148875.43088, 293082448828.28546, 323392597495.3713, 264194606956.71054, 354708693936.96985, 270882302865.96622, 424410360928.04285, 268198515326.02808, 267359704947.28192, 252119571735.73334, 435269528142.9541, 372708638622.5836, 238975910852.05304, 327847426914.92535, 271192518332.01648, 217703318066.81668, 357698028469.7542, 235002748893.14108, 282694274472.4677, 260065070099.66797, 250242930399.0606, 317906191692.27216, 224709882783.38916, 238930351205.53534, 216752041568.90848, 234208162516.82037, 301367700651.3083, 275307701254.6965, 222610762500.45242, 370349806328.23846, 291227453897.5889, 279400340660.69244, 240931731076.84744, 314854507888.5955, 322689395202.86566, 258082221972.64807, 315650168761.4257, 286651886088.1406, 232693457936.26587, 187867544531.66833, 344411326140.2915, 321083399859.2604, 187551960673.4651, 235382850830.91003, 285231189586.80115, 352476982575.2028, 195769017902.24948, 253714588614.42645, 212914242569.41373, 293365481680.63324, 329226423242.57007, 232272064452.86993, 206948265510.3466, 202790727629.78625, 211388380282.20422, 181141637084.25232, 274809288606.4913, 275746638307.39484, 267849695508.97375, 266678711111.11273, 245752501893.47647, 241622263056.05914, 271677854300.1276, 255815544674.89374, 305239772466.80426, 270874872532.85385, 276310150022.0715, 276794030660.02234, 174770545600.15408, 299657512979.6539, 281609269153.20856, 242523818048.66367, 346708486550.80084, 212481908891.6902, 256982578607.99243, 327093718717.73816, 287522775324.3879, 232123958159.64584, 302817565049.31915, 275099800668.51666, 424198742079.5211, 280562004029.11957, 371126586498.55206, 255146727707.6499, 312398651671.75995, 214148829521.92746, 272149626187.61786, 258290505424.96454, 309264264175.1828, 363887687544.9658, 252831944179.30255, 279674560592.9489, 172547958422.8538, 288613732582.9637, 297695328930.1134, 287138612925.4173, 365160464149.9604, 330435525616.6588, 314174123872.53503, 294366033523.84686, 212111523747.43756, 245874397881.12823, 341182783997.3206, 314658467206.92834, 275897053030.2953, 331265579249.8634, 281321626157.0385, 328202591766.50977, 334875860340.52936, 225461946121.74445, 253890831454.03503, 233346235876.13846, 321204816031.2479, 189359389153.05902, 196020374532.93637, 265788216405.35254, 328495748782.38544, 215486728922.1727, 225597791642.0355, 375382780013.17334, 206960395954.13776, 361529580686.23926, 219254803211.4378, 262051741672.917, 313280110287.2844, 202925428832.5861, 249577165533.25552, 272426504521.03107, 232683273605.25937, 242244966775.33948, 234312399819.76654, 271098472760.93073, 268712166395.60028, 296070537329.5155, 219921726608.14563, 272521223536.70724, 288444486792.6936, 257873941458.48395, 217863873422.05066, 232360023841.67728, 256833911594.08267, 262995584065.45898, 237118427566.3052, 271813080000.97134, 263837394016.362, 239043057480.40466, 290264818670.94836, 293360689234.592, 201667800460.29938, 290344188009.0301, 170859441938.07388, 298978440304.68146, 343914918853.4938, 263111688649.97726, 330445036447.8529, 333309404049.0708, 333090116781.9209, 321773087347.5757, 261688995258.03815, 332127435111.66235, 277753998668.8573, 310585459437.8928, 260586581360.07175, 330784266197.32495, 223478532211.31134, 260970211504.1732, 246732027867.90244, 248575658338.1166, 247842964645.6482, 297219476030.3131, 313947628116.70654, 203671436933.78833, 321475229632.94415, 277992203770.01764, 207527682464.69754, 304126140628.73303, 265184960125.3994, 206485439258.9333, 205926970626.85535, 222705619535.0268, 261887533821.30972, 249812143323.61646, 215577120031.62704, 223794902314.5816, 265662875798.42294, 310644218159.41327, 289949126625.1589, 311611183113.24646, 194024370786.30182, 265849614312.3056, 183766519522.6351, 255071632670.71695, 270715893298.8818, 364361523123.70734, 281807068825.6841, 257264537583.0152, 243676863584.52817, 369288488166.0495, 251736745936.99088, 269230706035.17093, 302973128752.07715, 162256398789.42197, 341080294141.1884, 249050549967.6294, 234749632718.75433, 264756596056.8417, 335388589879.7731, 292791132469.8817, 190147381940.0849, 219951476335.48492, 255304659724.60593, 195792191423.94672, 168348144930.72076, 283076760348.1644, 243476219146.5614, 264665645202.20654, 311175052272.01996, 361689916366.0909, 216683950267.2858, 374803599774.97485, 225134681175.16974, 309592542425.0853, 307431028929.3189, 286628473439.185, 217010811094.48206, 216797930478.7276, 228330018881.70203, 303678751361.9546, 243173343816.62112, 258400763138.66425, 201715545766.26788, 262425855664.56418, 282797145510.09875, 216338916717.4646, 271313462587.90234, 255597338831.5267, 231936321195.61053, 231342181179.93835, 221422183197.5265, 308199653373.459, 366856134648.15936, 372105196853.6475, 205693914910.43872, 285163720661.035, 273223105276.728, 224389105914.1547, 322275313256.45264, 259871982755.75134, 288122548038.63104, 264175078088.71075, 261869911865.87967, 201400075796.15973, 298313392947.20337, 268035891311.66486, 234782384220.00714, 266651011324.36023, 289779194483.56934, 291485604128.2384, 253237262378.1389, 339759507089.2485, 413782150903.0058, 306446683886.2541, 277215220440.5301, 319363253965.5189, 267525695283.54202, 276722973766.4753, 351139522991.88824, 310054709886.48254, 221497482881.5461, 369025759726.1717, 175897712992.91898, 236566434590.3175, 374184374278.8446, 345318314194.3917, 300916456404.63495, 237714405923.8024, 216293757796.4213, 251075639565.48074, 292765903167.60223, 241570684809.29718, 300527769698.0161, 247407546753.68512, 296587249139.1597, 222602186979.8789, 274158458148.13953, 316785588922.56824, 215508114359.93845, 235754183178.8661, 271187474111.95593, 216587293912.9716, 339492687338.13214, 282537983473.95667, 282973067400.3315, 197873667691.5964, 246095334735.23602, 240126302914.78574, 239751538232.73706, 348221058127.9174, 280479015950.07825, 343471366275.6663, 230055217050.38882, 280765077351.9831, 330857426999.1506, 291603198546.9337, 298120733148.16705, 229492519299.8363, 210209979214.73923, 281030503676.2193, 243504067541.95328, 352962737636.64044, 294111409449.59644, 266732487768.84573, 287819882117.76263, 304946955791.9758, 322461471484.1464, 352879129604.4723, 287413503426.01495, 246353304554.72614, 195573485667.27985, 256177720771.43146, 254919392686.3852, 325948199533.2692, 189954708831.27646, 204287088524.70697, 194459483841.00378, 299475777311.90125, 250535161779.0395, 188457556615.58163, 224212910500.34158, 216309745687.40344, 288746037792.5189, 283957942046.25146, 218527494712.9964, 237541926290.19415, 221273669117.71475, 215524223928.6448, 268245726919.61328, 224694873873.58038, 254050807068.84915, 212923485366.0615, 216426367587.52512, 269092587142.1368, 315151918543.89966, 299178152353.7988, 225300587999.45316, 289661412400.0251, 247744411218.95465, 336156034588.7955, 325402624098.879, 235330388522.01117, 229798859064.96594, 297838895660.094, 289175978463.9097, 331199963616.5673, 351784791856.11444, 280708706091.8504, 301835750926.52686, 320420038252.9356, 267795004832.60098, 384065432316.2243, 236576473830.1224, 290332405833.258, 290913127834.6029, 228919287070.09567, 204587982353.94867, 208994338935.44705, 258437368642.25067, 297243944246.68134, 244403396919.14014, 294820045233.65234, 205529992130.80054, 262786564843.23074, 433089046646.3148, 254885265869.0174, 365894757647.9187, 240264828648.66364, 186087843339.03278, 206354678637.7355, 183956188153.96652, 230831597021.19666, 253448838611.1315, 200692209647.23947, 194512832015.1144, 363937914278.0539, 287079765581.1769, 279586055312.2439, 283157676757.40405, 318862667926.574, 259154751712.005, 252586349379.08276, 348871930800.2162, 199244395663.05862, 331257051269.62854, 327353860811.015, 286184239507.5923, 169585618949.21402, 231868128346.29565, 226313450095.1725, 313870649024.6928, 218173134687.16913, 283425954429.71136, 342243811786.51447, 258541839477.72842, 421887453160.7559, 271362036334.38467, 261996178077.07144, 313799305756.8625, 318604363216.1715, 336570633630.7461, 316827426618.8576, 249609472495.74823, 189297186264.6704, 249831581564.03546, 221976020038.28607, 311828899997.0238, 384016364742.71454, 267565421291.61594, 311175132984.5822, 272756524574.0826, 268664638021.37885, 303681790293.9386, 242688416679.7965, 334035428401.101, 265328066442.25266, 307619713971.0459, 298806198978.7187, 277017896803.8374, 272690142127.2897, 278047615907.837, 244634091096.85974, 220503065484.66315, 361572509209.6243, 311896506633.0407, 260331359556.2588, 409085425345.59814, 256758820830.31967, 192837141934.36304, 327051268527.7199, 256625575486.9721, 300043133496.7034, 301967932755.25635, 333916518043.5595, 314652786352.40784, 255263263593.7154, 323401740829.4492, 234693747862.327, 197688345393.66263, 324142930034.2095, 264404812812.9957, 254064045703.44165, 257842294420.0243, 227012499930.61472, 302188222911.9291, 364438220928.5674, 230986232427.4063, 235727248132.86923, 255058246351.7378, 170938126411.76566, 321935972914.8809, 323340794911.26666, 195692230954.33755, 274283339052.87524, 240827274056.76898, 257267485277.61072, 282350756592.61145, 141130589041.27573, 256566092751.75098, 288157090781.32605, 261771749515.90256, 170288554998.06497, 257691816419.72437, 335865740549.55176, 156479312480.32022, 345708637017.7215, 215296403034.6801, 311580721209.5201, 270428990786.21313, 287872117224.2033, 353458765968.93384, 367250957831.21783, 240207172034.39597, 297695052056.39197, 241305732973.22363, 269919231456.925, 301919601100.66077, 250576366489.28885, 272415780633.5495, 147086605137.55768, 267122032934.59726, 330037400318.63257, 301843460818.0425, 203860608139.24622, 225561026712.05582, 312393962043.97516, 167062492031.0487, 263664762082.89673, 246008303294.08038, 321864362246.6427, 268610894936.56375, 397745150390.11395, 257006956176.55847, 249498384252.60046, 369640490173.6813, 284534179595.27875, 272385134177.54047, 277483213540.14185, 260020785323.84418, 217449464120.19736, 217004683727.7165, 275486836598.1334, 268016256469.53503, 274984904495.7054, 314779264906.06104, 275095838519.2545, 265280376197.44858, 301781559751.92896, 189285146457.39407, 247020262396.78665, 328073066871.13055, 294138667292.1967, 268415644588.36777, 256214365985.11163, 288524444731.4054, 226226405316.17786, 227323009609.67365, 282336639458.3108, 236432491198.50092, 344338181101.20374, 235338274751.4087, 284439866876.8394, 197681902220.17032, 283580584551.90027, 311894236191.96, 351818182211.2835, 231147086487.8051, 275281490953.4927, 266165366471.56458, 181608443854.94992, 260061688773.4575, 278034580340.8936, 304871501008.7629, 269223635549.9719, 209924261733.7174, 282034084033.47595, 363901104042.5454, 200315445854.9056, 257529367733.94882, 275977713642.7389, 194870454028.65088, 305819895735.54913, 334590117645.56946, 215182609669.6225, 358872240322.65814, 236463155661.33862, 277228189356.8721, 377258868871.69653, 223617107987.31458, 273452693706.69138, 243399831475.90808, 343934152829.98816, 301605943198.7641, 248936202105.24667, 315318775200.97314, 206624138753.69485, 362864909846.6005, 269549989466.68094, 280068481365.5116, 282959972070.3575, 253199237107.63565, 290684560092.99585, 228321577854.73187, 334077653144.7143, 307051747538.19574, 359954828301.7945, 271923942993.10135, 323399569892.9915, 254383328886.6424, 317377015660.2537, 308542858166.67554, 253893627559.65344, 321070644425.1684, 336666986697.3844, 302184467379.5693, 313175462712.638, 284420023065.57654, 208631155396.71463, 318871210898.4375, 319075457282.10834, 349827350141.0354, 173432649081.98825, 310443860750.19904, 281450905871.874, 372754666926.286, 247682102129.82025, 292946641528.8185, 192380487592.1043, 253218799822.4353, 226071754160.08093, 279780644759.69977, 277871353355.5027, 209672452362.37778, 196308859833.67255, 175366442530.17374, 289013955616.03577, 225947565174.39853, 310363279209.99255, 203645010957.58853, 276414716778.144, 250039387862.02414, 335002363646.97375, 331283313165.19476, 346034938723.341, 306293046989.3396, 324871265936.162, 298470063006.1348, 355833593633.4964, 272436302329.08463, 313162603866.8171, 304128391247.33594, 315719269872.8451, 325450451092.3719, 346719022618.9512, 360522703084.49005, 254190104707.02594, 246203567346.5995, 218893113549.93738, 260465973142.41336, 276236370335.0175, 263308255334.8736, 288482125705.4094, 283398390591.73425, 198643421803.66138, 233613666933.5455, 164544451542.72064, 272064900549.03796, 317573121478.7211, 258606751886.16302, 146711632836.9723, 282941832579.33105, 275009361240.85913, 396227847496.0041, 207366395089.42914, 267370200467.49005, 338157297076.32495, 331133568615.48486, 287212624804.11383, 332867594491.7336, 289988891339.5455, 285207602296.97894, 241305586072.6403, 287331484426.74835, 224610473031.60318, 264807029115.76373, 266749878878.20105, 223983169388.84537, 258056112941.98557, 256715783513.60947, 194205378665.10492, 243029165483.1807, 251652933383.96487, 297955395936.5172, 243780823931.00806, 404859129729.79254, 213962099429.72498, 267787844870.83286, 236642211568.7013, 398017056208.23676, 272309301420.9831, 259207055483.53937, 279256459007.7055, 212436080612.32916, 243442848467.15176, 355595015138.45245, 254033525192.11313, 291105814407.8674, 340150771287.68896, 317317752298.0642, 247056224336.136, 205125677020.5938, 217499430376.1925, 217577962528.9826, 330857367097.8958, 353813150986.5214, 188150452872.06207, 175126498679.78406, 165105199226.43686, 290063779171.53033, 294911005814.32526, 238240238086.49405, 289842678489.0586, 325967584953.8988, 198181511390.7275, 160261906226.74634, 299971204539.2921, 309378648349.25854, 266892009044.12195, 306552088462.8363, 214507642471.86365, 316014149879.89636, 275051705944.0597, 252311170047.51114, 175971212133.9883, 295744502041.22516, 387465956502.61816, 239024528765.9402, 324598731926.0416, 269217498182.85046, 299839914743.1028, 307416442040.40125, 226573104606.16672, 200617613876.59424, 281022270647.0329, 232480880625.8505, 320814134960.3883, 206091842112.82983, 221858917480.70267, 290767188783.088, 217360882510.31146, 240449331747.08875, 285750473676.2517, 256982970431.83423, 398612575142.3716, 269601975010.15247, 230939632246.84943, 273856572880.45456, 318406666611.9242, 293464903418.66565, 170394825729.83377, 172321785032.9188, 216071334609.61115, 254109299283.68338, 304209117345.52356, 347847248834.82904, 239881510945.8198, 238173756515.6399, 302681851531.7269, 292483645880.53436, 249814105102.9045, 247078643360.8032, 226605541263.50366, 256423093930.35446, 319414542226.5322, 215501143517.9705, 328329985872.7658, 394688133220.72, 314196000238.94147, 316316950631.64325, 244080318885.6488, 261508436815.34143, 206440122018.2168, 190979827076.24673, 332367760071.37445, 230325434000.9481, 253116311483.17517, 202967635605.12265, 233265907749.2521, 296600811190.3218, 194544767545.91248, 333770831223.66516, 361233716558.3249, 207243309708.61026, 294675748340.1758, 399291608587.1771, 242480496371.02292, 265839353925.58795, 290137006291.4709, 377918086817.9913, 178753958476.23657, 294391380807.6395, 383159417357.7498, 286438437348.27203, 240419345899.3128, 280504470580.3337, 258760121935.1195, 292457947564.4256, 278751135574.87524, 259342115829.15463, 275197629943.19073, 262495587723.7375, 302946696694.94476, 479118061262.9757, 244322596165.1672, 292353335485.6503, 198553801032.97623, 309401676683.61127, 301014018765.2161, 262545261350.56815, 344005363166.84814, 267983933799.29523, 405894427497.4688, 181221843476.0734, 412101896409.52, 273870701693.62125, 323356626597.6477, 214547352581.61862, 207436243083.789, 246915503197.53845, 264163711054.14688, 297402444786.01624, 364689786006.9536, 198021221029.03583, 364126310092.1938, 322142054438.46783, 276437438789.42773, 221121695339.58453, 312968653882.50793, 167221521442.29224, 265956371753.14023, 208187683865.47366, 240099571825.72748, 285465797452.6157, 324648148230.217, 323910849706.2714, 209846646300.64288, 252361573121.08658, 308903349449.6313, 335901955274.52527, 317896716334.21265, 239420243875.87524, 170684258250.1894, 277911557066.766, 151166516544.93237, 316306024599.8375, 304955792983.27606, 349582692641.2933, 232838083080.11862, 276716230937.6892, 417581609794.4483, 392055499002.025, 195894634199.10052, 256848834894.29007, 246649402843.51562, 320108067661.5025, 263352711662.45087, 274461249209.6876, 231105921792.21558, 360031165861.49, 247342573523.1347, 239555660414.91324, 184682839079.40762, 280572579099.8536, 264584845254.99194, 232333102762.56317, 236020681155.232, 239830081903.15604, 237946978983.66327, 210413524492.38516, 289301413499.9719, 214957385131.1382, 424006892048.5774, 244149592689.25076, 284256190843.60095, 192778427190.332, 291217328730.7487, 297315849155.676, 194250694167.82767, 255270279125.2168, 233744330771.50314, 226698579727.41043, 304932015149.41797, 241236135469.58978, 352776248907.917, 233089759955.2124, 321394759863.8824, 272661998028.00903, 238647154702.9241, 299646099982.67267, 182430452429.30695, 340769031826.59576, 341253495564.2446, 273742598492.01285, 265156643931.3135, 295677534424.9254, 215102263300.1148, 276210636429.91925, 160803346797.06165, 331800286456.4397, 298117492157.224, 244671644019.9888, 335517017589.83673, 283529940960.0644, 200544675083.21225, 306108743851.36633, 249204559594.96826, 308120876931.1517, 212897317023.67676, 256019112387.92282, 356751446468.5543, 302350364019.8151, 218537663868.27042, 287369318056.07275, 247829027317.51797, 288015846470.7022, 249328163761.85907, 292224548703.9177, 270422328539.36136, 159326642743.7817, 213740106729.89447, 266290316117.22827, 371964005607.4994, 257578862751.92282, 234976980870.0883, 239461245306.6063, 254730712564.33932, 242563419043.80405, 344499383883.4636, 326696164821.79443, 251224409057.37225, 350061018739.16406, 257767816769.28754, 241787765615.42426, 290758788282.6001, 239972997300.31543, 378333438136.06366, 244744544516.3138, 283251418482.61914, 277864159257.0276, 266066356476.9604, 284069524990.19226, 284267096102.65186, 342789405476.7446, 308296356731.0971, 227060141671.4345, 303685613977.4587, 236681426950.7435, 191732218007.38214, 248160823761.1556, 275234752583.81335, 195476067781.29837, 274487825904.01724, 240994183155.659, 295568149590.41125, 231853827996.18768, 398185301627.39185, 291753968868.93915, 276456570527.0717, 196762711475.20227, 315820476414.3639, 285000780686.7806, 260048815150.80066, 242228428747.39713, 312689136059.0236, 207178605160.8091, 365371462456.55176, 321694978121.51855, 256330068860.81128, 188772552190.77966, 219973818414.01898, 402158182613.8576, 308370279635.26025, 308413646257.6297, 267612547998.53082, 271201775554.1155, 388508720244.7113, 199491930888.59967, 275921904065.3221, 298338486886.7797, 301429722717.51105, 173631091952.76276, 249454256866.5034, 203595659715.04144, 254748273176.29016, 240982554106.30917, 261922509776.75537, 277899802721.1315, 286187639810.2153, 291794948480.78156, 239933924720.99258, 207806879376.07108, 185982160415.4808, 290875758428.1285, 247450534249.49487, 269734893145.28793, 294550551532.31274, 232021252547.51147, 200582719259.4094, 299099313615.22955, 316069585957.6803, 233145630113.09824, 249970207771.22403, 303205066554.65314, 310257355586.5431, 306953747280.82623, 209722687888.4297, 180945120610.99365, 323789390157.95197, 279988506674.73975, 333046496065.1267, 263383560869.2598, 287538956882.1891, 313203541454.0558, 330865622343.3604, 235941608323.96167, 219791736588.40387, 313939155864.50867, 313626395897.8308, 231259268842.1554, 289100234236.73694, 302685440634.3271, 284599161866.67554, 321631357202.55115, 257523817513.85577, 333843150715.81934, 260945038189.61877, 218373713275.005, 260461039123.55588, 284132543910.4715, 255036817581.79395, 226258564558.01514, 194933862926.81006, 261442247512.7487, 218012251119.9888, 214357718617.6745, 306022918525.7877, 249925967549.71823, 231473487496.2162, 302789509628.2248, 267916903144.0378, 307953623452.9817, 245836570418.24854, 280218166976.4832, 271630946005.51257, 307788878584.2896, 243676424243.24445, 272430306270.0896, 197849073740.21613, 324913367789.414, 318695444080.33685, 280367530804.0595, 235107775037.6029, 254993484871.91733, 291468653277.4993, 258106356063.53403, 291545824013.3474, 334920415041.68396, 304915247806.42126, 255618362970.81512, 252248733354.10062, 279980062019.0066, 217495843422.80182, 294140550958.03064, 318694058886.93134, 328474890091.58826, 272238519941.4257, 275287161814.4278, 359309211437.35986, 250954169006.41592, 305635483511.4616, 165819218168.9139, 269681857323.6671, 246412131696.99582, 248146103616.3836, 214746779150.40417, 246538455843.7551, 361102693594.9741, 260333334244.71158, 211808172785.51923, 220534983656.2488, 257198526835.09747, 255373173227.58823, 244929783194.48895, 294755715511.9483, 253969590066.7341, 201949279003.10837, 251603834403.65576, 263312923132.90543, 272076311619.15756, 237466264714.32846, 240791567032.18375, 231565073302.54047, 278823953825.42316, 225163052549.19174, 237851892925.63037, 291125471916.2663, 213635096091.39252, 321048443125.15454, 327403823673.7428, 194029904811.6763, 330956274248.7978, 196029469246.76624, 227227294296.44852, 276334651371.23694, 193083515789.9253, 249212704790.3959, 226275947285.51334, 387833142581.9149, 190538691429.27255, 287504495714.98755, 273209774151.4103, 196682100428.47354, 285648562176.304, 240805114418.36765, 268517799453.53723, 263372462150.16208, 197254423992.44562, 242368128570.14706, 195467911429.34964, 428116619572.3539, 191402407079.3002, 341882436539.28406, 254978850410.36206, 188794988108.0363, 186019114764.9613, 281186964100.43475, 210742238552.45038, 243788126969.34653, 218683757880.60098, 222783759741.34192, 229136004051.8955, 203847188957.9158, 262650203986.36746, 240145051356.55502, 233077541770.7734, 421924327816.7301, 218094344473.66742, 240769064190.2669, 139788782593.1313, 303567893339.145, 303689861863.81696, 221588929914.24518, 311894883109.058, 241292289530.15237, 304142062712.3081, 254050206099.7172, 266218610523.27957, 223145048000.51425, 273783804450.7564, 228197790509.1791, 209089757126.35617, 292047276580.3112, 296080630133.39856, 214051830659.06445, 277434666689.0827, 272880831986.81982, 255284607530.39465, 216865124444.17514, 219877336678.53708, 351626353214.5056, 189252456651.12598, 251962540587.39352, 212119416431.8581, 320392382403.6854, 352602681551.0164, 331801641684.5027, 217980904681.54355, 303545971422.66736, 230524318248.87897, 257763560511.9124, 306758137450.49725, 242409246052.29306, 333207763023.87274, 235828972012.96603, 224960952624.38943, 229866818556.71683, 293745233940.8258, 293180440470.5839, 357596045616.72485, 256180262634.98923, 279076633383.63727, 248676364400.01974, 313598102082.69116, 237965618448.1512, 280941847568.7024, 415537954097.435]
thresholds = [207178605160.8091, 270395574194.45624, 345028896174.0641]
display_name = "NPV of dFDA Benefits (R&D Only, 10-Year Discounted)"
units = "USD"

# Calculate exceedance probabilities (1 - CDF)

sorted_samples = np.sort(samples)
exceedance = 1 - np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

# Create figure

fig, ax = plt.subplots(figsize=(10, 6))

# Plot exceedance curve

ax.plot(sorted_samples, exceedance * 100, color=COLOR_BLACK, linewidth=2.5)
ax.fill_between(sorted_samples, 0, exceedance * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Annotate thresholds

for thresh in thresholds:
    exceed_pct = (np.array(samples) >= thresh).sum() / len(samples) * 100
    ax.axvline(thresh, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
    ax.axhline(exceed_pct, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.3)

    # Add label with formatted threshold value (use format_parameter_value for full units)

    ax.annotate(f'{exceed_pct:.0f}% chance\nâ‰¥ {format_parameter_value(thresh, units)}',
                xy=(thresh, exceed_pct), xytext=(thresh * 1.05, exceed_pct + 5),
                fontsize=10, ha='left', weight='bold',
                bbox=dict(boxstyle='round,pad=0.3', facecolor=COLOR_WHITE, edgecolor=COLOR_BLACK, alpha=0.9))

ax.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=12)
ax.set_ylabel('Probability of Exceeding Value (%)', fontsize=12)
ax.set_title(f'Exceedance Probability: {display_name}', fontsize=14, weight='bold', pad=15)
ax.set_ylim(0, 100)
ax.set_xlim(left=min(sorted_samples) * 0.95)

clean_spines(ax)
add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from

output_path = get_figure_output_path('exceedance-dfda_npv_benefit_rd_only.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Exceedance: {display_name}',
    description=f'Probability of {display_name} exceeding various thresholds'
)

plt.show()
```

*This exceedance probability chart shows the likelihood that NPV of dFDA Benefits (R&D Only, 10-Year Discounted) will exceed any given threshold. Higher curves indicate more favorable outcomes with greater certainty.*
