```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: US Per Capita Chronic Disease Cost (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Simulation results
samples = [12539.690605086711, 10993.449448784228, 13098.800502731485, 13344.79116423589, 10055.698770594314, 10714.948476147405, 12324.495850607454, 11800.343042180275, 12151.267173546907, 11196.424696894508, 13265.146697178025, 13133.895938163843, 12250.169865954802, 13590.829189474702, 12741.068775051008, 11189.580027005764, 12618.519355805473, 11081.051693606372, 13263.916489658228, 12111.939507462423, 11953.045952230783, 11386.614393041682, 13718.177726973536, 11988.581639720578, 11671.609726210525, 11758.967387161712, 12822.124801621583, 12614.43650781434, 12672.95011166256, 12695.40391036954, 14705.882352941177, 11696.666329612746, 11576.151028447084, 11239.53847180599, 12927.548439031038, 13593.131845258493, 12036.28971648495, 11210.554886074173, 11227.765753306287, 12971.413978712506, 13089.57777736534, 12835.740849120006, 11403.81048769972, 12450.965726288496, 12311.049216031819, 12434.55983067089, 13254.805163059957, 12440.532578921697, 13007.415606878963, 12252.026293492623, 12520.563769353628, 12946.930969833033, 10553.663524026382, 11796.384189576665, 11623.682986823555, 11433.571332306576, 11847.903001851271, 14088.80113804788, 11182.4220414889, 13381.033994175275, 10323.094214709909, 11778.833611456585, 12366.677345613376, 12889.955859353466, 13048.61426666818, 13153.905162932298, 11762.890491374996, 11632.810720118277, 13237.365784915404, 11945.512613276042, 10742.765781891498, 10893.52390900923, 11123.894423019336, 12778.094968453508, 12342.100330466936, 13022.154512297286, 11672.837902743211, 12361.579094706567, 12939.713531529862, 11808.309576913192, 12727.691388018446, 11407.810796538626, 11746.407109258933, 11724.948246095186, 10827.040749097652, 12765.360598184392, 11624.786822464199, 12186.154651177296, 12757.585154558998, 12714.937816201089, 12990.205664220013, 12054.516660955267, 11677.356062361323, 12076.677059722908, 10318.584684176885, 10564.041744141145, 10693.45229214288, 11039.525693616937, 12656.888802351657, 11139.116655972666, 11729.051533683754, 13821.519603396564, 11754.215092233648, 13082.228619943582, 11108.484083095473, 11929.001601230511, 11090.664660993089, 11774.052978605861, 13214.497428383218, 10278.284576698052, 12699.880751819914, 12457.759919962175, 11483.729181309729, 10565.132117951573, 12257.483690467898, 11556.624998677378, 12451.593140988836, 12197.32013510627, 14236.881741766772, 11889.470189561656, 11011.201295825067, 12386.690221144581, 12436.151755741716, 13902.861577358735, 13207.778321243251, 12603.85746275359, 14045.245503529088, 10834.541624905076, 11432.593767247328, 11116.142024649098, 11715.689687672015, 10637.103537845338, 12951.82616439128, 11909.422169273234, 10539.574249286157, 11019.737577708287, 12550.490625997796, 13211.676441584856, 14705.882352941177, 14705.882352941177, 12675.02994213879, 11047.857199625465, 10000.0, 12494.359532087006, 11240.453270488137, 11686.4346652481, 11463.57721739572, 12004.711471477169, 13509.591726898807, 12359.775314510072, 11983.76594468815, 10998.109353657488, 10331.368437065612, 11605.569925078484, 12107.368956904105, 14470.271220380238, 12327.43208195822, 13399.984802867904, 11590.828139428182, 10838.592061181222, 11074.293132512965, 11337.359326535456, 14705.882352941177, 11231.16656362341, 13212.145324122861, 11141.898882357866, 13333.053264711076, 12638.541026190916, 11986.108168193003, 12122.806067002508, 11415.782905024407, 12714.366704856933, 11641.202169504952, 10795.546789925576, 10740.399209036035, 12378.58586043964, 14205.306277050337, 12363.335707085958, 12030.765459139087, 12516.529104203777, 13830.684698631232, 12435.404278159116, 11691.502360404487, 13562.989508860665, 12692.839079030908, 14145.189020677208, 12391.490107064988, 10796.747821990173, 10645.983803009827, 14305.525730850826, 14407.722764499003, 11959.29792714924, 11723.285200262097, 14042.691019279833, 10921.53584046063, 11150.843946612864, 12962.193454789085, 11710.192871387135, 12165.163946444978, 11978.128414823701, 12580.078114406859, 13968.726526176715, 12279.642413122434, 12962.969826355938, 10000.0, 12113.370895713166, 11207.183067874292, 10802.725713832555, 11168.946178856359, 11779.711555818363, 13312.621476632117, 10689.58809874782, 12207.804470906773, 11607.999016964714, 11787.15000622193, 13426.262359912684, 12829.412777591477, 13873.24631732107, 11988.60956672802, 11369.896839003946, 11907.515397499208, 12463.566016531151, 12383.41488910594, 10945.779997853317, 12279.528097044407, 12446.174239196827, 14705.882352941177, 14625.333968003708, 11196.206183513968, 11833.717983963983, 10547.17293204697, 11487.599203727139, 12553.059360993939, 13695.792243202888, 11333.079813813518, 11416.499342071455, 10000.0, 11979.039254382735, 10969.343718674709, 11556.685259895294, 11170.358038747425, 12059.499549267315, 10247.743123768452, 10543.454320516095, 14705.882352941177, 10730.434050247879, 10932.507724655992, 14568.29176713192, 14705.882352941177, 10852.790744480091, 11740.436521106321, 12584.980280816555, 14414.819588243538, 11050.756320206416, 11882.581307079681, 13133.311940515046, 12700.306357672069, 11731.354930040769, 12012.900469806835, 10638.967445742977, 11890.845465944823, 11858.058460788046, 12450.976164770691, 11527.443335117558, 12746.093772964932, 13439.353162025807, 12357.816853063217, 12597.550235541068, 12234.743797149102, 12171.36381017758, 11341.429852762622, 12554.151867417255, 12055.931089134974, 14705.882352941177, 14197.333817206743, 12639.648800238925, 11295.462088922624, 10915.802192089704, 13676.089138551728, 12488.29337339909, 12756.831999055903, 10260.932069299552, 13327.659453562881, 12724.758471924, 10917.918424448488, 11622.372425992267, 12489.476462327268, 12233.919387747335, 11828.174467136847, 12048.616241286707, 11874.793044055172, 12354.350216733552, 14056.50622661476, 10000.0, 11892.385696608195, 12383.34103945031, 12528.990217404898, 11736.225552301894, 10248.752697579152, 12568.290372752726, 14412.918883910776, 10474.735929474913, 13244.949251606553, 11786.167073884924, 12098.436067923785, 10979.563944779162, 11779.327981605225, 13822.623806574486, 12885.456845655943, 14419.918731033735, 13657.723668555549, 12705.677643026269, 14436.330402346925, 12705.561356625465, 13198.574392189292, 11823.082545955322, 12250.787438146426, 11368.248790999622, 13408.963521066124, 10845.637679917681, 13139.756391886203, 11946.276338864298, 13649.486201477572, 13099.336088692617, 14545.117391795218, 13073.601166743514, 10435.67140515594, 12091.773291750515, 10852.32282778228, 11569.313598051127, 14111.275752629215, 12954.846871480457, 11366.572734190766, 11021.745521989773, 12210.374101320034, 10805.107775322156, 11397.528307226463, 12548.643005385109, 13628.216615402975, 12918.41983475613, 10000.0, 12539.260662868717, 12257.368609974745, 12674.385985295025, 14257.002270925477, 10000.0, 11487.153553128268, 12895.865958457733, 10425.918436105418, 14062.638898873969, 12618.032598129668, 13222.616084884843, 11509.83935049174, 13180.213698808857, 13512.885952116225, 12451.839062755334, 12453.694973649564, 12497.577981611688, 11185.142809359193, 11996.798238298174, 11990.936551395596, 12636.6152378925, 13422.408302457867, 10973.507956360447, 12023.26698287247, 14070.219212237062, 11317.004222856012, 11230.2176752865, 12414.639906953347, 13219.771078986474, 12184.88094685209, 13861.795376739634, 13235.834752442597, 13216.452857150938, 12849.518673589577, 14705.882352941177, 11929.323664027126, 10001.7009380829, 14240.33121583446, 11638.108387692695, 12300.444891573285, 13835.489172572086, 10404.854413011031, 10768.068847037266, 10405.854000607276, 11261.158499919207, 12706.36146386045, 12811.937880114627, 12504.834079480768, 10599.610733167292, 10000.0, 12236.178596135418, 11622.086678744916, 12730.943475292188, 13036.778043916589, 12337.047309708149, 13111.217743930896, 12447.371689259473, 12819.308651964133, 11360.186255293462, 11959.190016345012, 12407.9228827285, 13188.942366173644, 11711.183016922623, 12808.151103445145, 11858.695236362235, 12032.056136581554, 13200.551927346261, 10012.744135494162, 10720.9348047388, 10527.84373656415, 10000.0, 11389.584644037299, 13097.496480555556, 11836.612790707195, 12409.154228388017, 13540.349073123769, 13860.066573041195, 12089.18820355429, 13895.24198750584, 12281.495349768426, 11213.581433922567, 11483.447775165523, 10529.542733139786, 11158.041245099083, 11752.199067358486, 13167.090946903987, 14403.640101764135, 10631.384393306413, 12648.287004292262, 10992.847155231239, 12750.034368638564, 12016.117829615816, 10174.615925870632, 13328.779265756659, 11471.540966185174, 11551.641202579729, 10961.469089988635, 11416.346458759403, 12691.76339470605, 11947.921076957853, 12569.11021504934, 12610.089043728283, 13850.541732302008, 11769.729222709157, 10533.334217374026, 13511.23414179241, 11782.749943908042, 13574.01589137489, 12636.594522017767, 12016.057997582458, 12593.876214189348, 14705.882352941177, 14705.882352941177, 12254.187242510194, 12363.576462717645, 13523.163363805099, 11204.51734480054, 12574.53401907675, 12140.495927844195, 12550.97501475298, 11218.004261206319, 10417.786396774678, 10000.0, 10910.491332844334, 11636.99697795964, 11826.993345720739, 14707.239828196847, 13562.597496878614, 11077.57277203066, 12592.560660564788, 11695.907169649785, 11837.215433827128, 12394.02636708398, 12931.587059122094, 11773.79325095562, 13506.777631939958, 10884.305007424051, 12178.816348486336, 14705.882352941177, 12439.90460411033, 14003.948679913627, 12280.766424966496, 12883.088652576262, 12103.814050911305, 11969.966914640936, 11277.31976085636, 12694.7583020233, 11198.075810416656, 12990.460086067273, 13535.14167263953, 12615.778917794189, 11835.032078226062, 12724.192169013593, 11809.087895021452, 13338.23985491479, 10174.117811063223, 11778.000975472261, 10015.119025121287, 10514.586427695185, 13909.223388411747, 13285.657142687323, 11343.736299662072, 10506.930674528045, 10000.0, 11540.798821340955, 14705.882352941177, 12700.453267499659, 11522.655325031013, 12738.040235943918, 10446.995355290695, 11822.211990371776, 12290.333688377861, 12069.136105120275, 13150.63437438574, 12588.786192775971, 12993.944942869019, 11378.323584715712, 13289.07766792879, 14274.771211416597, 11068.840041294983, 11158.519759907063, 13871.055463304388, 11945.466246786887, 13963.723376588167, 11655.392143051635, 14033.900087748267, 12328.893505507027, 12482.769906302818, 14185.338606347956, 11747.882515460962, 11100.328783452398, 11648.517732459952, 12722.16053923482, 10442.088272501633, 12954.767114955264, 11546.135749428013, 13618.218170517868, 10000.0, 11269.504859286579, 10319.459518659798, 11225.844929220757, 12469.872621522607, 11959.640376117723, 11873.165955490362, 11983.120886143903, 12415.95462208831, 11027.335743057934, 13043.02609727698, 12986.749317643942, 12638.648599294705, 12852.558382849977, 12529.51012962598, 14705.882352941177, 12067.96267009523, 11810.925408343648, 11306.001351854744, 11001.759885327168, 10775.633094637895, 11157.316782489721, 12087.363458114802, 12576.041303316117, 12232.333414908187, 11292.723087789282, 13292.159198437457, 13084.657694525868, 11982.57741361618, 11417.874004933536, 12842.367166364465, 12397.238579153469, 10562.992658042433, 12090.55794152996, 12487.421493445807, 11145.424048361172, 12399.5073403767, 10556.07374881383, 13871.600864932112, 13752.332053476608, 11874.16556285183, 12611.980404344225, 10000.0, 10868.966992864463, 11826.313556391147, 10958.915600057557, 13052.66287166398, 14705.882352941177, 10847.430445740023, 11213.509904169347, 12454.971683184245, 14249.897226229348, 10798.961380369223, 12471.544903523938, 14546.046503356387, 10354.572249136583, 10737.108023488387, 11677.003747203838, 11566.700056727032, 13178.714421821975, 12462.545042356289, 10230.474112466309, 12800.937090237376, 11502.412811219183, 13788.040238079584, 11446.21157733923, 11436.103303600254, 12833.200297615896, 13114.802525910414, 12716.889337808767, 10320.3390239519, 12829.311082007678, 10999.55786851031, 12454.761720092802, 10588.23881255526, 12714.677714631773, 11247.432148781494, 10735.463200653201, 13051.926668015449, 12462.526505987002, 11461.468267341468, 14028.590418767859, 11657.540526928575, 12209.568218177754, 12495.829359723028, 11455.08867210213, 12745.592043282515, 11552.147555646663, 11690.688765306846, 13907.563348535492, 10992.801849115292, 10000.0, 14249.647386851711, 14705.882352941177, 11697.977938550333, 10069.679917641575, 11806.995204584555, 11835.061941895989, 11947.126574731969, 10914.758995994835, 12881.55566516456, 12812.33852934519, 10515.260667834953, 13033.261147848863, 14705.882352941177, 12377.82560743375, 11776.021118362703, 12003.28726225652, 12926.634199722104, 10274.91422535672, 12368.659481400073, 11714.939695811801, 14583.85687287312, 11965.557070672325, 14329.289187155337, 10925.068900720056, 12891.263869148846, 12557.722726887152, 11178.902961648664, 12384.412030534206, 13704.72881054127, 11791.628235090953, 10313.912036625163, 12150.361442310461, 11142.448549690773, 11770.242049478526, 12074.467658731559, 10300.10342735748, 10391.219736303068, 12759.233530494768, 11564.288878759415, 10000.0, 13142.963482267187, 12500.056811102757, 11349.960882799378, 10699.59647559673, 13208.678828389711, 12594.584587313533, 14705.882352941177, 12682.200693080165, 12641.945572125302, 11974.043816812176, 13184.099626228126, 12939.073798600508, 13757.413693925646, 11565.868643784508, 11663.525846392648, 11613.755807262087, 13150.628710983232, 14093.535536725843, 11636.8088312041, 11675.670071248476, 12551.182614755422, 11882.01888409445, 13359.80402626117, 10000.0, 11225.322459992645, 11274.082169268388, 10000.0, 11075.895429268527, 11128.572391928608, 11934.061046217854, 13571.855314707307, 11882.833883284717, 11003.320063302404, 12103.611085351988, 13487.389685066706, 11062.54889331761, 11133.562923310797, 12855.093782803711, 11910.222418000503, 12967.469010133129, 12155.01887564032, 13036.40808197168, 10998.728948810596, 12156.87726523659, 11922.871288328748, 10805.815465810181, 10444.419649396039, 13016.119879908332, 11760.326744877117, 11012.513055046857, 12057.238039367516, 13591.86355626094, 10000.0, 10512.962918551351, 11120.156489405468, 14042.326252670082, 12512.561989726479, 13120.439191610141, 10886.198347494128, 10908.194017731317, 12716.533843615878, 12240.874567987252, 12842.757914903343, 11949.760911740035, 12507.12221518789, 12361.070269811376, 13133.864387568137, 13171.502896007762, 10386.935596195046, 10000.0, 13424.932134285487, 13671.51540104556, 11014.299298130192, 10145.85034028578, 12289.801280584628, 13332.09452022571, 14512.341321293621, 12802.048552624048, 11736.4528382806, 11152.586196178092, 12184.911040299028, 11819.966107756058, 11020.288867340652, 14705.882352941177, 14494.703834765227, 13602.54877711685, 11122.372485765047, 13233.536191315116, 12957.500196073772, 12709.979368876911, 13754.640798783314, 12952.10527278758, 13085.42803849641, 12954.051299597873, 12584.039174687328, 10221.818275176487, 12271.276495853337, 11526.467833755141, 10738.398730334491, 14348.83566803335, 14415.23955695383, 13902.906511469262, 12479.086747492347, 13891.21634354288, 12185.628800225839, 12415.236569789873, 10936.054206027762, 12653.442157049263, 12243.404426053625, 10714.45289974126, 12110.432801371153, 12076.66364185074, 14512.293947768783, 13284.3938572494, 12184.90406123418, 12471.241224447804, 12224.040581132926, 11931.948066379438, 10947.88070715688, 11992.662479949531, 11314.224609602292, 10769.472281468417, 12795.690850506775, 12646.352668293042, 10218.721251406561, 12026.00230898315, 13416.993666979777, 13500.661806114369, 13456.621585700117, 12217.70279146154, 11205.19250444068, 10946.518348407475, 12588.736516706735, 12631.528757455133, 13805.436311458932, 13554.617808156901, 12014.774953551276, 10775.913514490105, 11797.036034607892, 12432.786431588578, 11932.918177577416, 11502.012951744538, 12476.243227661991, 11585.540903743544, 11445.675528750775, 12547.959432391359, 11701.72976608008, 12465.527034429077, 12501.077428058892, 10886.978145181296, 11611.326104773521, 14010.202878939996, 10862.871775916872, 10000.0, 10143.855010140338, 12205.986788434126, 12208.145908574732, 12031.975255384277, 13706.970152132639, 10000.0, 12652.132777464323, 14180.786129998427, 10899.395891361693, 11727.164644876944, 11306.70471119673, 11151.259701717765, 11788.777881043703, 13996.098995772003, 14568.96636136823, 11777.618465192563, 14665.775032002974, 12213.713760553564, 14450.121090443043, 12060.637206728652, 12328.377116372589, 12614.474047275677, 14705.882352941177, 13228.70149238447, 11357.305739498981, 13381.976258887662, 11747.811165255798, 11601.660918200865, 13303.11259735242, 12208.34699846182, 12507.65122903143, 12187.933068805722, 12578.8575840012, 12688.131396998431, 10069.55289917255, 12991.715481493206, 11055.989404442724, 10569.019187834212, 12101.885713890493, 12271.708749028216, 11372.60823522203, 13202.506437555921, 10673.090235442492, 11696.061107933245, 11494.15860051509, 12115.897564229374, 12508.0042169728, 11028.029784309156, 13065.297605364141, 12246.539849930294, 10114.016744743012, 10048.265399718613, 12156.598106801071, 11910.885424330716, 12048.696605148567, 12137.977817543067, 12442.92432010948, 13354.047164821268, 10917.19805946603, 10852.360636976651, 10936.212083632632, 12520.315359652255, 13748.291520572415, 11668.170236119582, 10000.0, 10301.776225114076, 11218.368844865432, 11524.73424937959, 11694.407365217157, 12217.30572971918, 11805.536653535502, 13487.608783214331, 11392.089670979303, 11186.267389929119, 12755.249233614946, 10472.910709703074, 12644.406072632622, 12294.033692607549, 11996.899431977723, 14218.08082689588, 11452.239857637118, 14705.882352941177, 11905.682903194007, 10741.367460843836, 12254.832994414583, 10954.506196040298, 11307.961877577149, 12653.494161462717, 12851.361809681754, 11452.284402940468, 13406.104667644333, 13631.145422201023, 14008.180387112154, 12818.491583361132, 13908.63328485967, 10125.05698301768, 11798.42159309128, 11181.137172812878, 12314.109906070953, 11509.26989875288, 11974.946271387655, 14632.965221651784, 11970.77264142688, 12674.264468139452, 11897.718408575365, 12261.783473621334, 12178.432113759349, 12717.168991382685, 13641.554398707858, 14300.579038130198, 12545.709001652634, 12894.150388916767, 10874.800942933878, 12067.038463684856, 13344.43169366945, 13247.724258226532, 12425.948480433377, 13274.231955638266, 12770.101542639783, 13688.358911198002, 12520.857554793369, 11754.86579905371, 12577.944352782471, 10000.0, 12635.986860196927, 10000.0, 10282.165023376278, 12721.456667181454, 12753.568890275295, 10862.500477594964, 11351.930197433552, 13918.317667497102, 11608.157267295543, 14705.882352941177, 12168.976683683406, 12667.126748011362, 14257.92975557029, 12328.340064454973, 11034.020184659317, 12041.261624410392, 12128.919687662788, 10649.545037974009, 11870.314244329964, 11318.550602777532, 13323.64183260052, 12212.560829188567, 11839.03212560885, 12045.440458309666, 12439.956072109362, 12928.6046049402, 11036.862435249963, 10991.724390735126, 13560.85332583732, 11689.889574571102, 10595.38319629299, 12711.555546948573, 12735.90820975816, 10477.961575765405, 12447.70101340699, 13079.754717994878, 12625.480830310371, 12947.809393652911, 10608.428383290493, 12572.035865999405, 11816.085744785949, 11609.566002951635, 13253.672552611044, 14067.216282003501, 14507.762489301376, 13842.609292979561, 12041.253693729559, 12598.738466198369, 13119.804421438997, 12316.462633617715, 12328.022841929274, 13193.105205518488]  # Truncate for embedding
baseline = 12238.805970149253
mean = 12211.21779824697
std = 1146.6194153653712
p5 = 10331.964443756702
p50 = 12155.589027510243
p95 = 14294.067118776316
display_name = "US Per Capita Chronic Disease Cost"
units = "USD/person/year"

# Create figure with two subplots
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
# Handle edge case where all samples are identical (zero variance)
if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)
ax1.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key statistics with formatted values in legend (use format_parameter_value for full units)
ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {format_parameter_value(p50, units)}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {format_parameter_value(p5, units)}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {format_parameter_value(p95, units)}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {format_parameter_value(baseline, units)}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---
sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)
ax2.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key percentiles
ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"
exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title
fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark
add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from
output_path = get_figure_output_path('mc-distribution-per_capita_chronic_disease_cost.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 1.224e+04 |
| Mean (expected value) | 1.221e+04 |
| Median (50th percentile) | 1.216e+04 |
| Standard Deviation | 1,147 |
| 90% Confidence Interval | [1.033e+04, 1.429e+04] |

*The histogram shows the distribution of US Per Capita Chronic Disease Cost across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
