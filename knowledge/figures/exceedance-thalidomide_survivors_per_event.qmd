```{python}
#| echo: false
#| fig-cap: "Probability of Exceeding Threshold: Thalidomide Survivors Per Event"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata
)

setup_chart_style()

# Monte Carlo samples
samples = [533, 563, 523, 518, 582, 569, 537, 547, 541, 559, 520, 522, 539, 513, 529, 559, 532, 562, 520, 541, 544, 555, 511, 544, 550, 548, 528, 532, 531, 530, 495, 549, 552, 558, 526, 513, 543, 559, 559, 525, 523, 528, 555, 535, 538, 535, 520, 535, 524, 539, 534, 525, 572, 547, 551, 555, 546, 504, 560, 517, 577, 548, 536, 527, 524, 522, 548, 551, 520, 545, 568, 565, 561, 529, 537, 524, 550, 537, 526, 547, 530, 555, 548, 549, 567, 529, 551, 540, 529, 530, 525, 542, 550, 542, 577, 572, 569, 562, 531, 560, 549, 509, 548, 523, 561, 545, 561, 548, 520, 578, 530, 535, 554, 572, 539, 552, 535, 540, 502, 546, 563, 536, 535, 508, 521, 532, 505, 566, 555, 561, 549, 570, 525, 545, 572, 563, 533, 521, 495, 495, 531, 562, 585, 534, 558, 550, 554, 543, 515, 537, 544, 563, 577, 551, 541, 497, 537, 517, 551, 566, 562, 556, 495, 559, 521, 560, 518, 531, 544, 541, 555, 530, 550, 567, 568, 536, 502, 537, 543, 534, 509, 535, 550, 514, 530, 503, 536, 567, 570, 500, 499, 544, 549, 505, 565, 560, 525, 549, 540, 544, 532, 507, 538, 525, 584, 541, 559, 567, 560, 548, 519, 569, 540, 551, 548, 517, 528, 508, 544, 556, 545, 535, 536, 564, 538, 535, 495, 495, 559, 547, 572, 553, 533, 512, 557, 555, 585, 544, 564, 552, 560, 542, 578, 572, 495, 569, 564, 496, 495, 566, 549, 532, 498, 562, 546, 522, 530, 549, 543, 570, 546, 546, 535, 553, 529, 516, 537, 532, 539, 540, 556, 533, 542, 495, 502, 531, 557, 565, 512, 534, 529, 578, 518, 530, 565, 551, 534, 539, 547, 543, 546, 537, 505, 585, 546, 536, 533, 549, 578, 533, 498, 574, 520, 548, 542, 564, 548, 509, 527, 498, 512, 530, 498, 530, 521, 547, 539, 556, 517, 566, 522, 545, 512, 523, 496, 523, 574, 542, 566, 552, 504, 525, 556, 563, 539, 567, 555, 533, 513, 526, 585, 533, 539, 531, 501, 584, 554, 526, 575, 505, 532, 520, 553, 521, 515, 535, 535, 534, 559, 544, 544, 531, 517, 564, 543, 505, 557, 559, 536, 520, 540, 508, 520, 520, 527, 495, 545, 583, 502, 551, 538, 509, 575, 568, 575, 558, 530, 528, 534, 571, 585, 539, 551, 530, 524, 537, 522, 535, 528, 556, 544, 536, 521, 549, 528, 546, 543, 521, 583, 569, 573, 585, 555, 523, 547, 536, 514, 509, 542, 508, 538, 559, 554, 573, 560, 548, 521, 499, 571, 531, 563, 529, 543, 580, 518, 554, 552, 564, 555, 530, 545, 533, 532, 509, 548, 572, 515, 548, 514, 531, 543, 532, 495, 495, 539, 537, 515, 559, 533, 541, 533, 559, 575, 585, 565, 551, 547, 495, 514, 562, 532, 549, 547, 536, 526, 548, 515, 565, 540, 495, 535, 506, 538, 527, 542, 544, 558, 530, 559, 525, 515, 532, 547, 530, 547, 518, 580, 548, 583, 573, 508, 519, 556, 573, 585, 552, 495, 530, 553, 529, 574, 547, 538, 542, 522, 532, 525, 556, 519, 501, 562, 560, 508, 545, 507, 550, 505, 537, 534, 503, 548, 561, 550, 530, 574, 525, 552, 513, 585, 558, 577, 559, 535, 544, 546, 544, 536, 563, 524, 525, 531, 527, 533, 495, 542, 547, 557, 563, 568, 560, 542, 532, 539, 557, 519, 523, 544, 555, 527, 536, 572, 542, 534, 560, 536, 572, 508, 510, 546, 532, 585, 566, 547, 564, 523, 495, 566, 559, 535, 501, 567, 534, 496, 576, 568, 550, 552, 521, 535, 579, 528, 553, 510, 554, 555, 528, 522, 530, 577, 528, 563, 535, 571, 530, 558, 568, 524, 535, 554, 505, 550, 539, 534, 554, 529, 552, 550, 508, 563, 585, 501, 495, 549, 582, 547, 547, 545, 565, 527, 528, 573, 524, 495, 536, 548, 543, 526, 578, 536, 549, 495, 544, 500, 565, 527, 533, 560, 536, 511, 548, 577, 541, 560, 548, 542, 577, 575, 529, 552, 585, 522, 534, 556, 569, 521, 532, 495, 530, 531, 544, 521, 526, 510, 552, 550, 551, 522, 504, 551, 550, 533, 546, 518, 585, 559, 558, 585, 562, 561, 545, 514, 546, 563, 542, 515, 562, 560, 527, 545, 525, 541, 524, 563, 541, 545, 567, 574, 524, 548, 563, 542, 513, 585, 573, 561, 505, 534, 522, 565, 565, 530, 539, 527, 544, 534, 537, 522, 521, 575, 585, 517, 512, 563, 580, 538, 518, 497, 528, 549, 560, 540, 547, 563, 495, 497, 513, 561, 520, 525, 530, 510, 525, 523, 525, 532, 579, 538, 553, 568, 500, 498, 508, 534, 508, 540, 536, 564, 531, 539, 569, 541, 542, 497, 519, 540, 534, 539, 545, 564, 544, 557, 568, 528, 531, 579, 543, 517, 515, 516, 539, 559, 564, 532, 531, 510, 514, 543, 568, 547, 535, 545, 553, 534, 552, 554, 533, 549, 535, 534, 565, 551, 506, 566, 585, 580, 540, 540, 543, 511, 585, 531, 503, 565, 549, 557, 560, 548, 506, 496, 548, 495, 539, 498, 542, 537, 532, 495, 520, 556, 517, 548, 551, 519, 540, 534, 540, 532, 530, 582, 525, 562, 572, 542, 538, 556, 521, 570, 549, 553, 541, 534, 563, 523, 539, 581, 582, 541, 545, 543, 541, 535, 518, 565, 566, 564, 534, 511, 550, 585, 577, 559, 553, 549, 539, 547, 515, 555, 559, 529, 574, 531, 538, 544, 502, 554, 495, 545, 568, 539, 564, 557, 531, 527, 554, 517, 513, 506, 528, 508, 581, 547, 560, 537, 553, 544, 495, 544, 531, 546, 538, 540, 530, 513, 500, 533, 526, 566, 542, 518, 520, 535, 519, 529, 512, 534, 548, 532, 585, 531, 585, 578, 530, 529, 566, 556, 507, 551, 495, 540, 531, 501, 537, 562, 543, 541, 570, 546, 557, 518, 539, 547, 543, 535, 526, 562, 563, 514, 550, 571, 530, 529, 574, 535, 523, 532, 525, 571, 533, 547, 551, 520, 505, 497, 509, 543, 532, 522, 537, 537, 521, 542, 557, 550, 525, 540, 532, 525, 549, 522, 531, 567, 506, 552, 576, 563, 563, 539, 546, 548, 526, 532, 533, 531, 526, 585, 548, 585, 539, 540, 515, 512, 536, 552, 529, 552, 540, 517, 553, 521, 524, 561, 517, 524, 538, 557, 559, 552, 528, 561, 530, 568, 545, 538, 495, 570, 505, 537, 531, 538, 530, 544, 505, 551, 513, 555, 542, 564, 530, 506, 542, 545, 565, 545, 575, 561, 535, 509, 495, 553, 506, 535, 544, 530, 539, 538, 549, 571, 574, 525, 547, 554, 540, 522, 536, 555, 511, 502, 529, 517, 511, 513, 526, 526, 528, 564, 524, 570, 558, 509, 520, 505, 546, 566, 546, 538, 538, 513, 548, 532, 562, 530, 540, 557, 546, 544, 546, 497, 542, 546, 585, 560, 546, 556, 507, 544, 509, 539, 539, 542, 540, 499, 585, 583, 552, 540, 524, 529, 549, 516, 516, 536, 518, 534, 553, 524, 538, 540, 505, 585, 571, 566, 548, 546, 573, 562, 559, 495, 497, 550, 548, 566, 581, 543, 562, 542, 575, 557, 537, 532, 531, 569, 520, 558, 525, 540, 570, 547, 532, 526, 543, 503, 516, 546, 523, 495, 495, 567, 561, 505, 564, 569, 551, 530, 543, 555, 555, 556, 560, 495, 533, 519, 551, 544, 556, 585, 570, 579, 585, 567, 509, 541, 509, 531, 522, 560, 528, 523, 553, 527, 527, 553, 565, 566, 538, 533, 558, 540, 527, 526, 503, 510, 562, 500, 552, 515, 539, 550, 579, 544, 574, 517, 504, 558, 533, 556, 554, 522, 541, 498, 551, 517, 538, 522, 550, 541, 543, 559, 525, 525, 526, 503, 505, 549, 532, 554, 540, 554, 501, 532, 545, 512, 585, 583, 522, 539, 534, 569, 541, 495, 521, 536, 550, 549, 585, 534, 520, 575, 555, 566, 562, 539, 585, 526, 523, 546, 585, 562, 511, 585, 548, 566, 521, 555, 531, 527, 496, 545, 532, 573, 512, 557, 553, 541, 574, 535, 517, 533, 575, 543, 523, 581, 564, 520, 534, 531, 495, 529, 525, 495, 545, 558, 530, 530, 552, 563, 495, 533, 557, 519, 543, 546, 527, 569, 532, 495, 529, 549, 552, 550, 546, 549, 519, 578, 520, 549, 531, 565, 508, 511, 518, 573, 521, 531, 575, 541, 532, 527, 536, 534, 505, 511, 585, 547, 544, 578, 538, 510, 564, 532, 561, 555, 505, 552, 529, 581, 495, 526, 544, 527, 571, 512, 548, 545, 551, 553, 524, 534, 525, 540, 528, 550, 495, 574, 510, 508, 559, 495, 517, 517, 540, 545, 545, 531, 507, 536, 560, 521, 519, 525, 523, 546, 561, 560, 576, 535, 542, 550, 585, 568, 514, 555, 532, 571, 506, 544, 534, 495, 504, 547, 554, 548, 528, 543, 549, 505, 543, 495, 538, 497, 532, 517, 556, 559, 530, 517, 539, 569, 570, 571, 578, 538, 514, 541, 585, 545, 544, 495, 572, 549, 499, 530, 527, 538, 533, 522, 558, 520, 570, 533, 536, 554, 541, 554, 564, 548, 565, 533, 566, 524, 566, 553, 554, 509, 533, 545, 529, 585, 541, 495, 537, 539, 527, 519, 583, 577, 535, 556, 509, 547, 582, 568, 585, 546, 545, 550, 515, 512, 544, 585, 526, 527, 533, 517, 566, 495, 562, 523, 577, 561, 504, 546, 520, 535, 543, 508, 546, 579, 558, 527, 531, 574, 556, 553, 548, 570, 554, 557, 522, 521, 544, 549, 537, 558, 566, 561, 554, 566, 537, 523, 575, 540, 545, 532, 541, 572, 568, 540, 516, 585, 532, 512, 544, 527, 556, 543, 575, 585, 518, 562, 551, 571, 571, 544, 557, 531, 530, 533, 535, 502, 564, 541, 513, 510, 571, 547, 508, 528, 536, 545, 549, 534, 546, 541, 538, 555, 528, 495, 579, 533, 557, 527, 539, 522, 512, 536, 513, 585, 502, 532, 515, 567, 559, 537, 541, 534, 515, 578, 517, 540, 545, 572, 529, 585, 525, 573, 539, 543, 512, 544, 556, 552, 510, 528, 549, 546, 574, 531, 578, 523, 537, 495, 565, 543, 497, 512, 556, 535, 540, 534, 556, 542, 575, 537, 530, 545, 575, 517, 532, 556, 547, 573, 563, 552, 511, 555, 525, 552, 535, 543, 520, 552, 574, 571, 552, 568, 531, 551, 495, 578, 536, 565, 551, 537, 585, 535, 495, 550, 534, 516, 544, 553, 585, 525, 543, 563, 537, 553, 552, 526, 570, 515, 571, 555, 495, 513, 538, 561, 552, 539, 539, 542, 541, 545, 572, 552, 519, 570, 545, 559, 538, 549, 505, 528, 569, 525, 558, 553, 533, 551, 519, 558, 554, 555, 553, 514, 526, 499, 495, 563, 539, 566, 558, 554, 564, 564, 544, 567, 520, 561, 495, 550, 539, 569, 499, 514, 533, 570, 535, 565, 505, 521, 538, 585, 562, 524, 511, 514, 575, 533, 516, 576, 540, 534, 547, 580, 548, 548, 544, 553, 550, 541, 530, 547, 549, 538, 582, 529, 540, 539, 518, 582, 583, 534, 540, 536, 551, 525, 518, 529, 546, 585, 522, 511, 525, 560, 524, 520, 503, 560, 545, 523, 539, 565, 531, 527, 538, 535, 546, 505, 560, 553, 540, 520, 573, 569, 584, 539, 565, 549, 525, 555, 535, 547, 525, 529, 556, 544, 516, 531, 571, 525, 564, 506, 516, 534, 537, 545, 524, 549, 535, 520, 553, 554, 567, 564, 580, 523, 496, 506, 576, 523, 506, 551, 538, 583, 534, 564, 536, 574, 528, 516, 558, 565, 585, 546, 553, 574, 530, 550, 564, 553, 515, 526, 543, 526, 566, 539, 537, 551, 530, 558, 528, 527, 585, 512, 585, 554, 516, 547, 572, 564, 516, 582, 513, 541, 567, 553, 563, 520, 523, 578, 549, 559, 509, 570, 502, 541, 566, 555, 558, 568, 538, 567, 585, 549, 579, 557, 560, 560, 495, 539, 535, 579, 555, 535, 563, 519, 567, 547, 553, 536, 555, 546, 546, 557, 529, 535, 542, 550, 522, 546, 547, 538, 499, 570, 522, 581, 535, 502, 529, 536, 553, 540, 546, 558, 547, 536, 557, 558, 570, 531, 528, 535, 517, 538, 531, 533, 542, 552, 495]
thresholds = [510, 541, 569]
display_name = "Thalidomide Survivors Per Event"
units = "cases"

# Calculate exceedance probabilities (1 - CDF)
sorted_samples = np.sort(samples)
exceedance = 1 - np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

# Create figure
fig, ax = plt.subplots(figsize=(10, 6))

# Plot exceedance curve
ax.plot(sorted_samples, exceedance * 100, color=COLOR_BLACK, linewidth=2.5)
ax.fill_between(sorted_samples, 0, exceedance * 100, alpha=0.1, color=COLOR_BLACK)

# Annotate thresholds
for thresh in thresholds:
    exceed_pct = (np.array(samples) >= thresh).sum() / len(samples) * 100
    ax.axvline(thresh, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
    ax.axhline(exceed_pct, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.3)
    
    # Add label
    ax.annotate(f'{exceed_pct:.0f}% chance\nâ‰¥ {thresh:,.2g}',
                xy=(thresh, exceed_pct), xytext=(thresh * 1.05, exceed_pct + 5),
                fontsize=10, ha='left', weight='bold',
                bbox=dict(boxstyle='round,pad=0.3', facecolor=COLOR_WHITE, edgecolor=COLOR_BLACK, alpha=0.9))

ax.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=12)
ax.set_ylabel('Probability of Exceeding Value (%)', fontsize=12)
ax.set_title(f'Exceedance Probability: {display_name}', fontsize=14, weight='bold', pad=15)
ax.set_ylim(0, 100)
ax.set_xlim(left=min(sorted_samples) * 0.95)

clean_spines(ax)
add_watermark(fig)

# Save PNG
project_root = Path.cwd()
while project_root.name != 'decentralized-institutes-of-health' and project_root.parent != project_root:
    project_root = project_root.parent

output_path = project_root / 'knowledge' / 'figures' / 'exceedance-thalidomide_survivors_per_event.png'
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Exceedance: {display_name}',
    description=f'Probability of {display_name} exceeding various thresholds'
)

plt.show()
```

*This exceedance probability chart shows the likelihood that Thalidomide Survivors Per Event will exceed any given threshold. Higher curves indicate more favorable outcomes with greater certainty.*
