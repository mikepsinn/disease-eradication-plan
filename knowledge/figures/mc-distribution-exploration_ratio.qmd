```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Therapeutic Frontier Exploration Ratio (10,000 simulations)"

import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Simulation results

samples = [0.0035814328546185724, 0.0024918832787305515, 0.004038998523667412, 0.004251528767568945, 0.00194894615637232, 0.0023217316234857414, 0.003414570281455113, 0.003029092952874859, 0.003283912522856185, 0.0026207607304991076, 0.004181956949570598, 0.004068896179313014, 0.0033581119473960626, 0.004471095109266321, 0.0037422052948836585, 0.0026163471567153714, 0.003643831087531987, 0.0025469978526154913, 0.0041808880582450735, 0.0032547008673668187, 0.0031383656216934057, 0.0027453026954127385, 0.0045875217106313895, 0.0031641493595496962, 0.0029388812280779658, 0.002999908751588788, 0.0038081915408525653, 0.003640582364486828, 0.003687318241701172, 0.00370535345364676, 0.005263157894736842, 0.002956303906409258, 0.002873105459636384, 0.0026486703927437257, 0.003895117730690753, 0.004473183369564204, 0.0031989767267613036, 0.0026298871455531694, 0.0026410306329957677, 0.0039316556806217135, 0.00403116502214746, 0.0038193482931236397, 0.0027567452838676188, 0.0035120205476727533, 0.003404311698847637, 0.003499280402860884, 0.004172976912027519, 0.0035039151788748973, 0.003961805955297332, 0.003359514799529691, 0.003566396093813895, 0.003911235672305082, 0.002226675058019178, 0.003026292795817236, 0.0029057387489825966, 0.0027766204026827158, 0.003062861968748808, 0.0049372970522956125, 0.0026117366203847843, 0.0042834304594645215, 0.002095148912501422, 0.0030138988684409768, 0.003446878747582083, 0.003863977632389751, 0.003996488864962925, 0.004086004886341852, 0.0030026681790059607, 0.0029120323358173086, 0.00415786133336305, 0.0031329168938561748, 0.0023383829808676262, 0.0024299504566477254, 0.0025742324653090917, 0.00377225647552709, 0.0034280306746009804, 0.003974191710863935, 0.002939733690504577, 0.0034429634931481584, 0.003905228907133665, 0.0030347328073809447, 0.0037313855856813583, 0.0027594115100283718, 0.0029910849911149937, 0.002976048153306294, 0.0023892936222674227, 0.003761903731376295, 0.002906499384288632, 0.003309965477907269, 0.0037555913898325273, 0.00372108900206148, 0.003947374838597903, 0.0032123467671956044, 0.002942871046156118, 0.003228650013327908, 0.0020926272162733015, 0.0022327155802069855, 0.0023089159641082667, 0.002520776169796759, 0.0036744519488065984, 0.0025839535350066, 0.0029789197105371313, 0.004683406561500866, 0.0029965682541119587, 0.004024929807779483, 0.0025644150378065166, 0.0031209958700185534, 0.002553092644791307, 0.0030105284794613306, 0.004138093122035121, 0.0020701775225820313, 0.0037089560230163725, 0.0035173052807948523, 0.0028103233757972097, 0.0022333508249974734, 0.003363640969243826, 0.0028597677611672855, 0.0035125083579676023, 0.003318331263734215, 0.00508165376248155, 0.003092571564746519, 0.002502989746015605, 0.0034622752649590915, 0.0035005153342163855, 0.0047597700537299805, 0.004132296295743243, 0.0036321732041932234, 0.0048953401985715374, 0.0023938588132112037, 0.00277596611203707, 0.002569290676147457, 0.002969575322696503, 0.0022755359933431646, 0.00391531308188275, 0.0031068969424118673, 0.002218491238936238, 0.0025083416925902897, 0.0035899412182269514, 0.004135658720074561, 0.005263157894736842, 0.005263157894736842, 0.003688986435356134, 0.0025260232560652793, 0.0018560716834631948, 0.003545860759598031, 0.0026492646288718514, 0.0029491815673227816, 0.0027967513613211085, 0.0031758971186285566, 0.004397818527597732, 0.003441578940504122, 0.0031606473446798367, 0.00249479570841962, 0.0020997808305693497, 0.0028932754429365193, 0.003251316753063737, 0.005263157894736842, 0.0034168129808365235, 0.004300171899394949, 0.002883157041660189, 0.002396326303211529, 0.0025427183602803284, 0.002712695117144019, 0.005263157894736842, 0.0026432361024963046, 0.004136063284229938, 0.002585732816686042, 0.004241229383168122, 0.003659789075274044, 0.0031623503211117418, 0.003262755664263596, 0.0027647298596472094, 0.0037206283399249876, 0.0029178259106822308, 0.0023701862875487195, 0.002336963405550922, 0.0034560350641064776, 0.0050506498281415145, 0.0034443121816056643, 0.003194931523567072, 0.0035632293470897235, 0.004691971395471913, 0.0034999354460254176, 0.0029527078600809263, 0.004445896664321475, 0.0037032905073458335, 0.004991954490877606, 0.003465974466962437, 0.0023709131594999142, 0.0022807759492666246, 0.005149472999103518, 0.005251506110495541, 0.003142892144092232, 0.0029748848252906116, 0.004892886560782142, 0.0024472118291104924, 0.002591458628538866, 0.0039239573657203295, 0.0029657366436482923, 0.0032942745106086697, 0.003156550823563921, 0.0036133164784908495, 0.004822181511249371, 0.0033804276670807093, 0.003924605196067773, 0.001897519053064374, 0.0032557611531728666, 0.0026277075170177563, 0.0023745331290704755, 0.002603070725296339, 0.0030145180882648432, 0.004223339521608012, 0.0023066169890166906, 0.0033261989501332753, 0.0028949448802437607, 0.0030197677285561334, 0.004323454803086056, 0.0038141605948068527, 0.0047318762549136495, 0.003164169675516897, 0.0027342075926573505, 0.0031055260705780342, 0.0035218254545842944, 0.0034597524590175475, 0.002462214349330776, 0.003380340928415119, 0.003508296625435047, 0.005263157894736842, 0.005263157894736842, 0.002620619755647676, 0.0030527652057014314, 0.002222902582938611, 0.0028129345653055034, 0.0035919667871854165, 0.004566917844484803, 0.0027098737313628126, 0.002765208128407643, 0.0018484558706501686, 0.003157212457464233, 0.0024768518432586924, 0.002859808863141464, 0.002603977786562517, 0.0032160080598786487, 0.0020532666572183967, 0.0022207430802442447, 0.005263157894736842, 0.0023309918861216224, 0.002453994100497218, 0.005263157894736842, 0.005263157894736842, 0.0024049888117962546, 0.0029868963804164047, 0.003617198718292902, 0.005258638966057098, 0.0025278507194642368, 0.003087635190459019, 0.004068397524262474, 0.0037092986294041974, 0.0029805324436947955, 0.0031818719911461623, 0.002276635188077321, 0.003093557649849, 0.00307010358278322, 0.003512028663162404, 0.00283990821229226, 0.0037462747014122585, 0.004335083655795336, 0.0034400760587974576, 0.0036271655570041263, 0.0033464693196748646, 0.003298904088028792, 0.0027153804590671843, 0.003592828500816653, 0.0032133857809821757, 0.005263157894736842, 0.005042840782135754, 0.003660673308379675, 0.0026851536433677124, 0.002443672330771162, 0.004548831743560837, 0.003541117692020303, 0.0037549803140940227, 0.002060558561386548, 0.004236501936540433, 0.003729016093444309, 0.002444978344198, 0.002904835827397361, 0.0035420424196437243, 0.003345847832387167, 0.0030488251538935704, 0.003208014733014048, 0.0030820603961714903, 0.003437416861079955, 0.004906165713982379, 0.0016507479987416843, 0.003094662246406752, 0.003459695590246006, 0.003573015665899383, 0.002983944463137464, 0.002053824248294365, 0.003603992121275947, 0.005256728006639213, 0.0021810766832029618, 0.004164430007479739, 0.003019073696400431, 0.0032447091633546845, 0.0024832177195725767, 0.003014247540926368, 0.004684437917429833, 0.0038602615065430304, 0.005263157894736842, 0.004532014656469867, 0.0037136241675818126, 0.005263157894736842, 0.003713530487211504, 0.004124364122458299, 0.0030452089299016346, 0.0033585785885750143, 0.002733115366479354, 0.004308118372228795, 0.0024006222920623333, 0.004073902371046681, 0.00313346900797211, 0.0045244845749992865, 0.004039453731774727, 0.005263157894736842, 0.0040176179001715304, 0.002158730149999923, 0.00323978633423325, 0.00240470302196297, 0.0028684304978612326, 0.004959036009133042, 0.0039178305042633175, 0.002732004862946762, 0.002509601660934485, 0.0033281290715810297, 0.0023759765898442326, 0.002752561492803527, 0.003588484732171439, 0.004505078377910897, 0.0038875413375148485, 0.001778032569576234, 0.003581094408099035, 0.003363553927118499, 0.0036884698780658776, 0.005101473206725235, 0.0018908429924875882, 0.0028126337962875157, 0.0038688627590197466, 0.002153173905261005, 0.004912067779101248, 0.003643443677395845, 0.004145104301714535, 0.0028279704545957044, 0.004108569420707474, 0.00440077493582153, 0.0035126995721012624, 0.0035141428318982743, 0.0035483788751664597, 0.002613488486124646, 0.0031701302470064116, 0.0031658627713227186, 0.0036582522213578755, 0.004320034949269732, 0.0024794443667819402, 0.0031894458920428796, 0.004919369299144988, 0.002699292164195041, 0.0026426206181384454, 0.0034838510429084034, 0.004142646526109287, 0.0033090120045018386, 0.0047211189208645815, 0.004156535979748432, 0.004139781116758531, 0.0038306587798593783, 0.005263157894736842, 0.0031212281239085564, 0.001921547300086441, 0.005085048127321333, 0.0029156890662192206, 0.0033962354117763297, 0.004696465188146617, 0.0021412048917837504, 0.0023535952353264506, 0.0021417719175032914, 0.0026627370875881335, 0.003714175084379015, 0.0037998581500099933, 0.0035540602272633197, 0.002253497282647905, 0.0017690320332340336, 0.003347551129188589, 0.002904638983240722, 0.0037340140565563272, 0.003986504869099724, 0.0034241636796724273, 0.004049560660528673, 0.0035092270423020848, 0.0038058866317993503, 0.0027277760141585384, 0.0031428139798136316, 0.0034786580342747956, 0.004116073401235821, 0.0029664278740932394, 0.0037967633501399885, 0.0030705580152588998, 0.0031958763455094954, 0.004126067591994944, 0.0019269776297794073, 0.002325308620442652, 0.0022116921591804855, 0.0017578476477803522, 0.002747276986996285, 0.004037890338788651, 0.0030548239769530327, 0.0034796096322862163, 0.004425471058381805, 0.004719496189545198, 0.0032378776097459587, 0.004752583389135122, 0.003381833802302158, 0.0026318445634084205, 0.002810133565124943, 0.0022126760849599443, 0.00259607154112903, 0.0029951518601796946, 0.004097304286749202, 0.005247405514276842, 0.0022721653766261717, 0.0036675730538760255, 0.0024915070048469475, 0.003749467895586235, 0.003184221405601094, 0.0020131343591668154, 0.00423748312809361, 0.002802109811499818, 0.002856369798722848, 0.002471954069741979, 0.0027651060643364084, 0.003702425530323641, 0.0031346582360290455, 0.003604640137482869, 0.0036371251159025247, 0.004710562127332111, 0.003007482261982925, 0.0022148728213453955, 0.004399292357494726, 0.0030166617087084334, 0.0044558660875786225, 0.003658235691520639, 0.003184177704338342, 0.003624250582449276, 0.005263157894736842, 0.005263157894736842, 0.0033611482405767955, 0.0034444970547256146, 0.004410006554559953, 0.002625985141214678, 0.003608929067579384, 0.003275895356939544, 0.0035903231259571513, 0.002634706693216183, 0.0021485480739378187, 0.001885879076087652, 0.002440396740412435, 0.002914921670045563, 0.003047986091412953, 0.005263157894736842, 0.004445542491443307, 0.002544794441475335, 0.003623207183109984, 0.002955775073391008, 0.0030552526847803427, 0.003467930142028808, 0.0038984726308096225, 0.0030103454379590672, 0.004395294015664627, 0.0024242866495271993, 0.0033044745497330676, 0.005263157894736842, 0.0035034276945806603, 0.004855769721600171, 0.0033812805997838805, 0.003858306325567513, 0.0032486861901905523, 0.0031506262516814766, 0.0026732831581622444, 0.0037048341087071467, 0.002621826109727809, 0.0039475879355587665, 0.004420781553555127, 0.0036416503166644475, 0.0030536996729819237, 0.0037285586898485605, 0.0030352841709213405, 0.0042457783782766005, 0.0020128627223942475, 0.003013311679795624, 0.0019281466662070283, 0.002204024137936352, 0.004765775704579518, 0.004199803535183632, 0.0027169027825116716, 0.002199603780376638, 0.0015789473684210526, 0.0028489863299782188, 0.005263157894736842, 0.003709416894314276, 0.0028366581551999186, 0.0037397540464850112, 0.0021651928307439227, 0.0030445909450346623, 0.00338854606751038, 0.0032230962838418497, 0.004083205100243581, 0.003620214618288719, 0.003950507496622836, 0.0027397966749618335, 0.004202784521348131, 0.005119017148256764, 0.0025392688277729083, 0.0025963784175174294, 0.004729816898400699, 0.0031328833764918827, 0.004817422500715089, 0.0029276395691172985, 0.004884448668515773, 0.0034179295688085078, 0.0035368024675464715, 0.005031105943431421, 0.0029921206250058357, 0.002559229229466515, 0.002922882666391872, 0.0037269180340285773, 0.0021623908028320427, 0.003917764022844453, 0.002852619161316615, 0.004495974236609275, 0.0017293260529828575, 0.0026681802082135094, 0.0020931162659838898, 0.002639785472065361, 0.003526739477077935, 0.003143140202309679, 0.0030808965459998383, 0.003160178440212633, 0.003484868041949225, 0.0025131116022270466, 0.00399177319413726, 0.00394448062092505, 0.003659874934921865, 0.0038331570069448247, 0.003573424350002936, 0.005263157894736842, 0.0032222326252353524, 0.0030365861256467543, 0.0026920648551071995, 0.002497078796658936, 0.0023581550857718, 0.0025956069799112223, 0.0032365307230768072, 0.00361012154553904, 0.0033446524415600564, 0.0026833593728858933, 0.004205471227872487, 0.00402699001677528, 0.003159783414824982, 0.0027661259537231178, 0.0038247853071311485, 0.0034704080433918256, 0.0022321044980590245, 0.0032388888795497153, 0.0035404363104570556, 0.0025879883419989962, 0.00347215884608912, 0.002228076971738436, 0.004730329511014628, 0.004619071723388779, 0.003081611528107502, 0.003638628931801288, 0.0017220357026570805, 0.0024148821023086404, 0.0030475032393461323, 0.0024703672047399847, 0.003999907564915006, 0.005263157894736842, 0.002401716193992026, 0.0026317982908798158, 0.003515135891754878, 0.005094468867463476, 0.002372253190666195, 0.0035280432293064573, 0.005263157894736842, 0.0021128051393288663, 0.002334990119579687, 0.002942626326093803, 0.0028666448204839223, 0.004107281379630435, 0.003521030335698508, 0.0020437438548642196, 0.003790872035223305, 0.0028229439159233177, 0.004652204583501058, 0.0027850894522404913, 0.00277831552435866, 0.0038172650311599954, 0.00405261315535662, 0.0037226633863862517, 0.0020936080001725567, 0.003814077262326073, 0.0024957014685052198, 0.0035149725643928136, 0.0022468397279282928, 0.003720879197932126, 0.0026538007739885217, 0.0023340043362471844, 0.003999285765466398, 0.003521015900918318, 0.0027953334375856306, 0.00487935672755463, 0.002929127202585458, 0.003327523673368085, 0.003547010611728597, 0.0027910469927974893, 0.0037458682577683035, 0.002856714913810872, 0.0029521415490962673, 0.004764208135227546, 0.0024914787019932245, 0.0017207084818486467, 0.0050942226808541, 0.005263157894736842, 0.0029572177190291256, 0.0019564241233325495, 0.0030338018458635455, 0.003053720911492937, 0.0031340837352076454, 0.0024430286954588284, 0.0038570410271624705, 0.00380018568058134, 0.002204413708607571, 0.003983541391025601, 0.005263157894736842, 0.0034554500519734764, 0.0030119157446222822, 0.003174858714778621, 0.0038943585233859115, 0.0020683070122664428, 0.003448401714771213, 0.0029690513825649124, 0.005263157894736842, 0.003147428021672295, 0.005173084572421804, 0.002449394485144046, 0.003865058458710755, 0.003595645932419914, 0.002609471842375026, 0.003460520377490916, 0.0045751360809148205, 0.0030229310180569595, 0.0020900163472200328, 0.003283237895462287, 0.0025860844307352723, 0.0030078434613250216, 0.003227022212250579, 0.0020823128394623766, 0.002133480038659533, 0.0037569290273554547, 0.002864998034279853, 0.001651600525586162, 0.004076643633548384, 0.003550319088424024, 0.0027210139061481994, 0.0023125744089427447, 0.004133072896647006, 0.003624812490645782, 0.005263157894736842, 0.0036947416493950157, 0.0036625070416720492, 0.0031535848578313017, 0.004111909050597645, 0.003904696768575944, 0.0046237776618523446, 0.002866076914003878, 0.0029332742353391067, 0.002898903789130333, 0.004083200253446939, 0.004941871421729368, 0.0029147917729087707, 0.002941700064829187, 0.0035904868124250183, 0.0030872323962287188, 0.004264724965723999, 0.0017970844701768094, 0.0026394468497255305, 0.0026711683319681446, 0.001764146420617582, 0.002543732513137355, 0.002577217378093411, 0.00312464573464411, 0.004453911497014527, 0.0030878160905440464, 0.0024980549574339867, 0.0032485360404736897, 0.0043779262692031475, 0.0025352928611238044, 0.002580404160707556, 0.003835241554341707, 0.0031074723953589114, 0.003928360807033952, 0.003286707891829421, 0.0039861930581931194, 0.002495183117231625, 0.0032880931272420656, 0.003116577126668902, 0.0023764055376336137, 0.0021637217704855638, 0.0039691175633991774, 0.0030008647116432623, 0.002503811698986373, 0.003214346033704675, 0.004472033091449768, 0.001783100487517634, 0.002203086267067654, 0.0025718489531418765, 0.004892536258456405, 0.003560117367379453, 0.004057415823890936, 0.0024254491717781057, 0.0024389806876483912, 0.003722376560879804, 0.003351093355392741, 0.003825106077312734, 0.0031359888695069683, 0.0035558529843682895, 0.003442572891417667, 0.004068869238374028, 0.004101089494315558, 0.0021310564912560837, 0.0017992714163337414, 0.00432227424771275, 0.00454463990374097, 0.0025049312417539846, 0.0019974858769356714, 0.003388141491016362, 0.004240388838793101, 0.005263157894736842, 0.003791779329743217, 0.002984103744646847, 0.0025925747964566275, 0.003309034529925775, 0.003042997020140256, 0.0025086875821009797, 0.005263157894736842, 0.005263157894736842, 0.004481729978101562, 0.0025732618245662307, 0.004154546712752436, 0.003920042604958595, 0.0037170906978865074, 0.004621209397254208, 0.003915545644363804, 0.004027643520957251, 0.00391716738383368, 0.003616453209182685, 0.00203898129872257, 0.0033740836742788562, 0.002839245858606088, 0.0023357638581121966, 0.005192557742020678, 0.005259061260370254, 0.004759812455325551, 0.003533926852184416, 0.004748789264941062, 0.003309571813609432, 0.003484312568525459, 0.0024561889166937675, 0.003671694665537637, 0.0033530026462588822, 0.0023214356601208765, 0.003253585028380708, 0.003228640125980668, 0.005263157894736842, 0.004198702923284367, 0.003309029305975963, 0.003527806450803722, 0.0033384063390456092, 0.0031231211083654967, 0.002463517040098792, 0.0031671189161948444, 0.0026974651910691297, 0.002354440823357728, 0.0037865913605141526, 0.0036660272880780454, 0.0020372789947448455, 0.003191446268165023, 0.004315233247033641, 0.004389810720358459, 0.0043504540415220515, 0.003333637775976403, 0.00262642130701337, 0.0024626721648567784, 0.0036201752434105983, 0.0036541949898998634, 0.0046684007260741605, 0.004438336952357521, 0.0031832406621106206, 0.002358324235495246, 0.0030267537423071186, 0.0034979050204719236, 0.0031238210358358236, 0.0028226734388385596, 0.003531707801851428, 0.0028795335141261415, 0.0027847299623192296, 0.0035879459645304598, 0.0029598326529498794, 0.003523352985869693, 0.0035511181354905973, 0.0024259280755296697, 0.0028972324773884747, 0.004861749328307079, 0.0024111512678202493, 0.0018637938233928392, 0.001996403301750294, 0.0033248340686730096, 0.0033264553724377532, 0.003195817132358957, 0.00457719873800087, 0.0016041407425692444, 0.003670647520067744, 0.005026656844146417, 0.00243356241192751, 0.002977599011378486, 0.002692526492005298, 0.0025917249532073326, 0.0030209173674466015, 0.0048482713146966215, 0.005263157894736842, 0.003013041951667927, 0.005263157894736842, 0.0033306386495488885, 0.005263157894736842, 0.003216844352726599, 0.0034175349996156575, 0.003640612226234454, 0.005263157894736842, 0.004150364550510305, 0.002725870027515286, 0.0042842618878975655, 0.0029920705368021725, 0.0028905901954155294, 0.004215030070250397, 0.003326606398377177, 0.0035562675493501163, 0.0033112970639423717, 0.0036123503001251212, 0.0036995059271206924, 0.001956356103986842, 0.003948639528641295, 0.002531151531333441, 0.002235616344012071, 0.0032472598249681964, 0.0033744112719273646, 0.002736005146601072, 0.004127751668048485, 0.002296818107687695, 0.0029558823023703657, 0.0028173638647306844, 0.0032576332934189543, 0.0035565441876711664, 0.0025135475891948163, 0.004010588494787413, 0.0033553699210123827, 0.001980258993609277, 0.0019449777651962998, 0.003287885020035796, 0.0031079492097509783, 0.0032080737104065622, 0.0032740228980937098, 0.003505772235536842, 0.00425966164530179, 0.002444533727626618, 0.002404726113909352, 0.002456286651710471, 0.0035662010690679746, 0.004615332098929887, 0.0029364947580086823, 0.0016799275492186455, 0.0020832450903536773, 0.0026349427134908553, 0.002838069018593354, 0.0029547304824855355, 0.003333339170653015, 0.003032768976516208, 0.004378122292857908, 0.0027489427525678864, 0.0026142128070301782, 0.0037536963374837774, 0.0021800293144716913, 0.0036644721444884292, 0.0033913585497539634, 0.0031702039510643058, 0.005063178591534071, 0.002789134230276255, 0.005263157894736842, 0.003104208963715604, 0.002337544139517387, 0.0033616364565573972, 0.0024676285113796955, 0.002693351735557417, 0.0036717362587714735, 0.0038321734628835365, 0.0027891641326336495, 0.004305587174701463, 0.00450774744227498, 0.0048598151215240165, 0.0038052180593109806, 0.00476521843439307, 0.0019862226968906578, 0.0030277336764243383, 0.0026109095709604276, 0.003406645003531722, 0.0028275848282434974, 0.003154240007937748, 0.005263157894736842, 0.003151210826970791, 0.0036883724068699835, 0.003098488611792216, 0.0033668941760975025, 0.003304187203866068, 0.0037228890308486137, 0.0045172414477161514, 0.005144566575316166, 0.0035861726201507163, 0.0038674443109249427, 0.0024184564606984827, 0.003221552504923346, 0.004251213114913865, 0.004166835324005703, 0.0034926049846615826, 0.004189856256654351, 0.003765755889706017, 0.004560089182664513, 0.003566626751510606, 0.0029970255107880303, 0.0036116274891084773, 0.0015789473684210526, 0.0036577508405300683, 0.0015789473684210526, 0.002072332465082665, 0.0037263497248954487, 0.0037523335095772416, 0.002410924117790174, 0.0027223153957936356, 0.004774369229874659, 0.0028950536619348054, 0.005263157894736842, 0.0032971210766205624, 0.003682649986473499, 0.005102387997913783, 0.0034175066896301788, 0.002517312677896826, 0.003202620254597464, 0.0032672929406634007, 0.0022828794761264237, 0.0030788574036059737, 0.0027003089038720287, 0.004232982845063199, 0.0033297721461378453, 0.003056545273632943, 0.003205684643984231, 0.003503467646533665, 0.0038959949148109933, 0.0025191003465729455, 0.0024908056711837124, 0.00444396689510982, 0.0029515853317975843, 0.0022510208560865053, 0.0037183613712623185, 0.003738029034294623, 0.0021829284447990307, 0.003509482954224399, 0.004022832269084158, 0.003649374593184917, 0.003911967148463069, 0.0022586681123593117, 0.0036069532230562596, 0.0030402443416874952, 0.002896022145301997, 0.004171994160669243, 0.004916475985924164, 0.005263157894736842, 0.004703129928201508, 0.003202614440708676, 0.0036281086207463945, 0.004056874792767948, 0.0034084392884091677, 0.0034172643178699462, 0.00411965524138305]  # Truncate for embedding
baseline = 0.0034210526315789475
mean = 0.003386253354684891
std = 0.0008677686035594065
p5 = 0.0021001147282901306
p50 = 0.0032871328412095997
p95 = 0.005138112209965529
display_name = "Therapeutic Frontier Exploration Ratio"
units = "percentage"

# Create figure with two subplots

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---

# Handle edge case where all samples are identical (zero variance)

if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax1.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key statistics with formatted values in legend (use format_parameter_value for full units)

ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {format_parameter_value(p50, units)}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {format_parameter_value(p5, units)}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {format_parameter_value(p95, units)}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {format_parameter_value(baseline, units)}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---

sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax2.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key percentiles

ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"

exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title

fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark

add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from

output_path = get_figure_output_path('mc-distribution-exploration_ratio.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Simulation Results Summary: Therapeutic Frontier Exploration Ratio**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 0.342% |
| Mean (expected value) | 0.339% |
| Median (50th percentile) | 0.329% |
| Standard Deviation | 0.0868% |
| 90% Confidence Interval | [0.21%, 0.514%] |

*The histogram shows the distribution of Therapeutic Frontier Exploration Ratio across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
