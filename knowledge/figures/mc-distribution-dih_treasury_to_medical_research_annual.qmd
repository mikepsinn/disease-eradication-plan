```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: DIH Annual Funding for Medical Research (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Simulation results
samples = [25091814219.2817, 22014000000.0, 26232634935.52546, 26734859771.81577, 22014000000.0, 22014000000.0, 24652984786.09151, 23584744975.169643, 24299840573.847668, 22355076872.965454, 26572234597.87932, 26304276207.839214, 24501451937.24743, 26910000000.0, 25502600143.6602, 22341147299.574303, 25252599839.58042, 22120303526.971043, 26569722797.777977, 24219680606.582657, 23895865640.31828, 22742196820.355755, 26910000000.0, 23968277949.083027, 23322520789.04898, 23500458516.86326, 25667979594.68686, 25244271649.693974, 25363632604.670086, 25409438568.754143, 26910000000.0, 23373555654.35, 23128111515.897194, 22442821395.183697, 25883106665.69056, 26910000000.0, 24065500863.065926, 22383833710.49754, 22418861086.282127, 25972628496.317844, 26213808947.41582, 25695762537.81209, 22777204635.606728, 24910866948.478416, 24625569016.414494, 24877411158.064632, 26551119709.509506, 24889591011.181847, 26046105831.08892, 24505236532.236195, 25052804480.108112, 25922662272.08778, 22014000000.0, 23576680139.11209, 23224910304.42209, 22837794176.415657, 23681636533.128242, 26910000000.0, 22326580273.882935, 26808869813.72527, 22014000000.0, 23540927343.726425, 24738990575.175102, 25806391498.083923, 26130194829.27812, 26345123237.862988, 23508450038.038746, 23243499798.894936, 26515513475.50531, 23880515225.633682, 22014000000.0, 22014000000.0, 22207479028.91077, 25578142561.61789, 24688878680.57775, 26076188254.534496, 23325022269.022766, 24728595216.26888, 25907932888.264248, 23600974279.12947, 25475308068.324017, 22785348611.612766, 23474873070.984234, 23431162314.031044, 22014000000.0, 25552160880.000023, 23227158355.434326, 24370954473.412136, 25536297043.088516, 25449289193.688396, 26010980798.905903, 24102646990.210175, 23334224642.718384, 24147810872.05842, 22014000000.0, 22014000000.0, 22014000000.0, 22035813478.359234, 25330868339.563835, 22238454473.92702, 23439520410.5634, 26910000000.0, 23490777969.659676, 26198807583.202156, 22176121640.631714, 23846871981.161076, 22139863230.29541, 23531188754.76138, 26468824187.049385, 22014000000.0, 25418571554.917282, 24924722284.857964, 22939916467.671715, 22014000000.0, 24516362286.209007, 23088348992.694202, 24912146423.37366, 24393714790.123627, 26910000000.0, 23766325453.080807, 22014000000.0, 24779797725.939175, 24880657460.587875, 26910000000.0, 26455106386.006294, 25222692764.263103, 26910000000.0, 22014000000.0, 22835803921.86774, 22191704128.363075, 23412303515.229565, 22014000000.0, 25932652499.456993, 23806977612.06278, 22014000000.0, 22014000000.0, 25113841683.565674, 26463064813.83544, 26910000000.0, 26910000000.0, 25367875413.03692, 22052764520.607548, 22014000000.0, 24999362039.21803, 22444683250.415684, 23352715718.912014, 22898885667.972153, 24001147635.198723, 26910000000.0, 24724917319.28311, 23958464596.891094, 22014000000.0, 22014000000.0, 23188022169.796333, 24210364966.092804, 26910000000.0, 24658971419.662533, 26847570045.62363, 23158000622.531857, 22014000000.0, 22106551938.880344, 22641928984.144978, 26910000000.0, 22425782502.13386, 26464022090.522667, 22244116064.02394, 26710891103.949104, 25293440777.467125, 23963237535.85399, 24241828967.90647, 22801578687.695076, 25448124067.19243, 23260590029.40975, 22014000000.0, 22014000000.0, 24763272417.766514, 26910000000.0, 24732176948.300903, 24054242757.511673, 25044575809.532494, 26910000000.0, 24879133180.334373, 23363037596.817337, 26910000000.0, 25404206209.24809, 26910000000.0, 24789585097.620186, 22014000000.0, 22014000000.0, 26910000000.0, 26910000000.0, 23908605207.04565, 23427774827.427746, 26910000000.0, 22014000000.0, 22262318680.848984, 25953810548.047672, 23401107161.59101, 24328166992.068687, 23946976618.39391, 25174189487.67952, 26910000000.0, 24561537274.97971, 25955395016.393284, 22014000000.0, 24222598058.618248, 22376971542.967537, 22014000000.0, 22299156392.4939, 23542715805.44867, 26669170577.047993, 22014000000.0, 24415086983.824112, 23192969069.63463, 23557868786.543304, 26901234279.24399, 25682850316.85313, 26910000000.0, 23968334858.547768, 22708164195.10024, 23803092507.777397, 24936562719.357727, 24773119089.99301, 22014000000.0, 24561304214.752407, 24901095800.74405, 26910000000.0, 26910000000.0, 22354632174.304462, 23652737310.569065, 22014000000.0, 22947796261.321022, 25119080867.806583, 26910000000.0, 22633217637.057457, 22803037262.062054, 22014000000.0, 23948832691.130478, 22014000000.0, 23088471705.77166, 22302029549.959682, 24112802199.651978, 22014000000.0, 22014000000.0, 26910000000.0, 22014000000.0, 22014000000.0, 26910000000.0, 26910000000.0, 22014000000.0, 23462711091.829605, 25184188403.291054, 26910000000.0, 22058663045.66588, 23752289660.170242, 26303084047.24858, 25419439815.91424, 23444212285.07533, 24017835661.762077, 22014000000.0, 23769127536.56575, 23702326720.596138, 24910888235.466938, 23028926291.519882, 25512852110.703716, 26910000000.0, 24720924039.87111, 25209827597.74452, 24470004101.299576, 24340804654.84376, 22650214978.552998, 25121309146.9144, 24105529610.195877, 26910000000.0, 26910000000.0, 25295700492.042137, 22556645982.039333, 22014000000.0, 26910000000.0, 24986990671.226048, 25534760428.62823, 22014000000.0, 26699877134.451786, 25469324509.76058, 22014000000.0, 23222241246.09758, 24989403462.27031, 24468323468.32557, 23641443651.68503, 24090621941.199665, 23736421608.13591, 24713855639.85901, 26910000000.0, 22014000000.0, 23772265716.75686, 24772968505.663353, 25069990325.16274, 23454133496.873306, 22014000000.0, 25150146418.356056, 26910000000.0, 22014000000.0, 26530996639.587936, 23555866429.473736, 24192158256.270763, 22014000000.0, 23541934425.5513, 26910000000.0, 25797210650.67426, 26910000000.0, 26910000000.0, 25430397602.477592, 26910000000.0, 25430160369.384224, 26436315764.282326, 23631070106.447018, 24502710945.905853, 22704809246.923977, 26865906226.602898, 22014000000.0, 26316239672.108055, 23882071433.38469, 26910000000.0, 26233728214.02413, 26910000000.0, 26181197122.982254, 22014000000.0, 24178578581.67952, 22014000000.0, 23114187724.83317, 26910000000.0, 25938817265.337883, 22701397290.552727, 22014000000.0, 24420325198.81868, 22014000000.0, 22764415252.461765, 25110073294.85068, 26910000000.0, 25864477529.547783, 22014000000.0, 25090937326.985306, 24516127675.70905, 25366561753.823406, 26910000000.0, 22014000000.0, 22946888864.807617, 25818451950.430855, 22014000000.0, 26910000000.0, 25251606948.956833, 26485399502.400368, 22993080651.179703, 26398831566.343716, 26910000000.0, 24912647927.305363, 24916432659.8963, 25005925815.513092, 22332117214.947998, 23985021787.668945, 23973076780.96687, 25289512429.599068, 26893363366.02761, 22014000000.0, 24038961471.47732, 26910000000.0, 22600494839.676476, 22423851296.33768, 24836790515.069595, 26479591022.729446, 24368358112.258507, 26910000000.0, 26512387587.216377, 26472816436.606724, 25723876157.914043, 26910000000.0, 23847528215.662506, 22014000000.0, 26910000000.0, 23254289130.261295, 24603948718.61985, 26910000000.0, 22014000000.0, 22014000000.0, 22014000000.0, 22486824603.10887, 25431792649.78433, 25647194003.42057, 25020724179.593834, 22014000000.0, 22014000000.0, 24472929073.738693, 23221659300.535324, 25481942811.752705, 26106035846.150692, 24678575940.931015, 26257982167.221947, 24903537720.901, 25662233436.72603, 22688396395.670227, 23908385317.53606, 24823093464.46411, 26416651415.830833, 23403123961.477654, 25639467472.414024, 23703624064.386784, 24056873071.906124, 26440353053.015156, 22014000000.0, 22014000000.0, 22014000000.0, 22014000000.0, 22748243585.56354, 26229973070.61371, 23658634863.619957, 24825604357.8899, 26910000000.0, 26910000000.0, 24173309847.315502, 26910000000.0, 24565314928.221195, 22389993233.751488, 22939343495.635857, 22014000000.0, 22276964913.74538, 23486671297.836655, 26372041482.885536, 26910000000.0, 22014000000.0, 25313321432.57354, 22014000000.0, 25520891742.069084, 24024392248.437237, 22014000000.0, 26702163743.844566, 22915100248.223206, 23078200270.107067, 22014000000.0, 22802726011.007812, 25402011775.851643, 23885422845.43885, 25151818609.691113, 25235403753.23542, 26910000000.0, 23522380931.82254, 22014000000.0, 26910000000.0, 23548905330.02669, 26910000000.0, 25289470172.07698, 24024270317.745712, 25202333570.019962, 26910000000.0, 26910000000.0, 24509641952.05446, 24732667849.714622, 26910000000.0, 22371546415.552917, 25162881324.493843, 24277885488.007908, 25114829639.84574, 22398994473.20643, 22014000000.0, 22014000000.0, 22014000000.0, 23252025604.039352, 23639037397.728607, 26910000000.0, 26910000000.0, 22113224973.95575, 25199650200.286476, 23372009379.221527, 23659862624.298527, 24794756774.934, 25891348532.666092, 23530659667.82383, 26910000000.0, 22014000000.0, 24355995905.50576, 26910000000.0, 24888310415.999115, 26910000000.0, 24563828839.867626, 25792378056.44322, 24203119446.84854, 23930345558.36191, 22519718654.819054, 25408121499.737415, 22358437075.220592, 26011500060.55532, 26910000000.0, 25247009890.705856, 23655414494.691036, 25468169175.77196, 23602559868.315758, 26721482016.68171, 22014000000.0, 23539231182.13889, 22014000000.0, 22014000000.0, 26910000000.0, 26614112859.556313, 22654910024.993706, 22014000000.0, 22014000000.0, 23056121745.193535, 26910000000.0, 25419739520.74235, 23019176730.198902, 25496421376.12163, 22014000000.0, 23629296570.777313, 24583334140.38425, 24132441890.5335, 26338446135.731956, 25191951347.895157, 26018612490.28442, 22725318753.981773, 26621097014.959324, 26910000000.0, 22095456697.400333, 22277938679.91716, 26910000000.0, 23880420746.878723, 26910000000.0, 23289490215.83805, 26910000000.0, 24661951102.22617, 24975726173.143948, 26910000000.0, 23477878464.866203, 22159527349.2866, 23275489277.11336, 25464024386.34234, 22014000000.0, 25938654495.043793, 23066989372.486828, 26910000000.0, 22014000000.0, 22503812370.517216, 22014000000.0, 22414951793.992874, 24949423966.46218, 23909303014.494953, 23733106552.04709, 23957150111.89122, 24839471439.154953, 22014000000.0, 26118788731.56179, 26003926596.202255, 25293660212.401077, 25730078756.13614, 25071050699.868576, 26910000000.0, 24130050366.2899, 23606303257.351883, 22578098374.228256, 22014000000.0, 22014000000.0, 22275490651.221046, 24169590800.042583, 25165955687.83149, 24465090325.68718, 22551070880.498554, 26627389028.002594, 26203765879.559208, 23956042637.52475, 22805835905.09898, 25709283450.810036, 24801306812.554844, 22014000000.0, 24176101542.609, 24985212562.44935, 22251289511.131233, 24805933074.570312, 22014000000.0, 26910000000.0, 26910000000.0, 23735143166.927296, 25239261716.935257, 22014000000.0, 22014000000.0, 23637652490.756897, 22014000000.0, 26138458557.459282, 26910000000.0, 22014000000.0, 22389847658.55513, 24919036241.73518, 26910000000.0, 22014000000.0, 24952834321.90986, 26910000000.0, 22014000000.0, 22014000000.0, 23333507061.411037, 23108865532.902, 26395770768.015182, 24934480628.156513, 22014000000.0, 25624748137.161655, 22977958877.11025, 26910000000.0, 22863529132.45684, 22842949109.31836, 25690578611.628983, 26265299844.872345, 25453270508.196, 22014000000.0, 25682642811.37506, 22014000000.0, 24918608065.60882, 22014000000.0, 25448758559.330288, 22458887194.12442, 22014000000.0, 26136955866.600437, 24934442826.631886, 22894591779.3413, 26910000000.0, 23293865807.76023, 24418682396.408363, 25002359633.777344, 22881602815.53387, 25511828481.66917, 23079231375.21539, 23361380461.0868, 26910000000.0, 22014000000.0, 22014000000.0, 26910000000.0, 26910000000.0, 23376227175.290928, 22014000000.0, 23598296645.177917, 23655475335.555187, 23883803921.32347, 22014000000.0, 25789249812.98764, 25648011489.827606, 22014000000.0, 26098857570.576477, 26910000000.0, 24761722224.11382, 23535198027.29952, 23998245319.559486, 25881240926.705517, 22014000000.0, 24743032182.185, 23410775866.050163, 26910000000.0, 23921359509.72981, 26910000000.0, 22014000000.0, 25809060680.99612, 25128592307.78746, 22319418754.11224, 24775152328.975136, 26910000000.0, 23566991543.961086, 22014000000.0, 24297994402.733128, 22245234592.73697, 23523425596.09089, 24143307942.48065, 22014000000.0, 22014000000.0, 25539660123.997128, 23103955452.437057, 22014000000.0, 26322786633.858643, 25010981216.75862, 22667580994.655266, 22014000000.0, 26456944863.229446, 25203778459.76823, 26910000000.0, 25382503689.907066, 25300385619.29195, 23938653219.98514, 26406764781.543247, 25906627325.773323, 26910000000.0, 23107172455.959564, 23306056129.917156, 23204692981.222355, 26338434574.29185, 26910000000.0, 23251642419.833115, 23330790687.778793, 25115253059.73922, 23751143755.17443, 26765516470.986996, 22014000000.0, 22413888458.388046, 22513128904.03373, 22014000000.0, 22109812104.148083, 22216998055.86922, 23857181135.46029, 26910000000.0, 23752804270.23078, 22014000000.0, 24202705768.830276, 26910000000.0, 22082656417.80563, 22227153189.738247, 25735252320.98693, 23808608146.253025, 25964577272.077667, 24307487775.73136, 26105280721.48406, 22014000000.0, 24311275801.34837, 23834380933.142525, 22014000000.0, 22014000000.0, 26063871360.455284, 23503227577.422203, 22014000000.0, 24108193194.75273, 26910000000.0, 22014000000.0, 22014000000.0, 22199872900.67229, 26910000000.0, 25036484957.91588, 26276806146.32536, 22014000000.0, 22014000000.0, 25452545260.833076, 24482502299.45855, 25710080772.252357, 23889171808.158916, 25025390725.57573, 24727557724.31664, 26304211801.086746, 26381048414.688248, 22014000000.0, 22014000000.0, 26898517633.329346, 26910000000.0, 22014000000.0, 22014000000.0, 24582248683.953373, 26708933375.715107, 26910000000.0, 25627015933.445557, 23454596468.882492, 22265864076.76034, 24368419455.678864, 23624721167.56909, 22014000000.0, 26910000000.0, 26910000000.0, 26910000000.0, 22204382111.375473, 26507694659.14193, 25944232286.8821, 25439173479.473465, 26910000000.0, 25933222112.583405, 26205338331.361195, 25937193631.40975, 25182268829.672295, 22014000000.0, 24544481494.330666, 23026939925.472393, 22014000000.0, 26910000000.0, 26910000000.0, 26910000000.0, 24968214832.9381, 26910000000.0, 24369882560.752834, 24838007209.724644, 22014000000.0, 25323837460.485214, 24487659706.88314, 22014000000.0, 24216609649.087654, 24147783525.352413, 26910000000.0, 26611533445.221024, 24368405229.335274, 24952215015.664677, 24448184799.250748, 23852875705.303413, 22014000000.0, 23976593884.48587, 22594836866.56148, 22014000000.0, 25614043909.8695, 25309375589.948166, 22014000000.0, 24044535822.80815, 26882305450.358067, 26910000000.0, 26910000000.0, 24435264917.100258, 22372920459.555573, 22014000000.0, 25191850022.986206, 25279136752.410946, 26910000000.0, 26910000000.0, 24021655626.77464, 22014000000.0, 23578008051.423473, 24873794797.592865, 23854852412.357628, 22977144696.403408, 24962415860.296738, 23147233381.903477, 22862437751.12154, 25108679088.84838, 23383869032.0467, 24940561868.038918, 25013062700.043625, 22014000000.0, 23199744790.589844, 26910000000.0, 22014000000.0, 22014000000.0, 22014000000.0, 24411381634.386078, 24415783006.394844, 24056708241.27027, 26910000000.0, 22014000000.0, 25321166441.167484, 26910000000.0, 22014000000.0, 23435676949.149143, 22579530057.372486, 22263164721.960747, 23561184979.827938, 26910000000.0, 26910000000.0, 23538451971.76318, 26910000000.0, 24427133156.325996, 26910000000.0, 24115120775.863903, 24660898240.55712, 25244348222.418957, 26910000000.0, 26497823798.539867, 22682532602.916893, 26810794026.60446, 23477733124.74442, 23180061431.94971, 26649754417.476357, 24416192929.415276, 25026469626.961414, 24374579667.657978, 25171699991.756393, 25394602400.824802, 22014000000.0, 26014062259.661602, 22069310308.01111, 22014000000.0, 24199189176.392307, 24545362732.95329, 22713683832.504192, 26444343346.01787, 22014000000.0, 23372322924.23443, 22961152035.467075, 24227747924.43094, 25027189531.445026, 22014000000.0, 26164248006.139137, 24494051658.552002, 22014000000.0, 22014000000.0, 24310706781.466362, 23809959045.95807, 24090785721.902287, 24272752864.886654, 24894468371.471294, 26753760714.621655, 22014000000.0, 22014000000.0, 22014000000.0, 25052297848.830864, 26910000000.0, 23315515458.63232, 22014000000.0, 22014000000.0, 22399736468.79097, 23023409919.798954, 23368954547.449463, 24434455492.37407, 23595325297.649895, 26910000000.0, 22753343282.510315, 22334405817.749355, 25531531220.36812, 22014000000.0, 25305404750.64294, 24590877618.830055, 23985228002.192482, 26910000000.0, 22875802626.127434, 26910000000.0, 23799358757.3465, 22014000000.0, 24510958417.410107, 22014000000.0, 22582089015.243107, 25323943545.029835, 25727637117.075214, 22875893320.20042, 26860067900.55111, 26910000000.0, 26910000000.0, 25660566269.492027, 26910000000.0, 22014000000.0, 23580830659.776794, 22323965490.881683, 24631809276.071026, 22991921138.02374, 23940492194.033813, 26910000000.0, 23931987414.749615, 25366313861.375774, 23783131040.149887, 24525128131.302284, 24355212677.233353, 25453841032.605835, 26910000000.0, 26910000000.0, 25104089151.85273, 25814951059.971897, 22014000000.0, 24128166786.63978, 26734125730.65129, 26536662413.362247, 24859850766.930126, 26590784739.819492, 25561833676.04859, 26910000000.0, 25053403655.397327, 23492103471.75984, 25169837292.008053, 22014000000.0, 25288230626.518887, 22014000000.0, 22014000000.0, 25462588398.628548, 25528102939.03593, 22014000000.0, 22671589825.297043, 26910000000.0, 23193291350.657463, 26910000000.0, 24335938775.20025, 25351753142.4736, 26910000000.0, 24660822695.732018, 22024612263.637764, 24075633398.74323, 24254289996.341904, 22014000000.0, 23727296451.550777, 22603642546.7332, 26691673351.933147, 24424782880.223644, 23663563765.246403, 24084149745.851757, 24888415371.868324, 25885262045.34501, 22030394941.56395, 22014000000.0, 26910000000.0, 23359752666.417465, 22014000000.0, 25442389027.607723, 25492071674.073475, 22014000000.0, 24904209301.495228, 26193757802.184273, 25266799969.16671, 25924454974.573475, 22014000000.0, 25157785930.768684, 23616815974.13937, 23196160282.156036, 26548807214.723087, 26910000000.0, 26910000000.0, 26910000000.0, 24075617236.29071, 25212251281.70285, 26275510365.420425, 24636606133.252697, 24660175913.724815, 26425150063.599106]  # Truncate for embedding
baseline = 24462000000.0
mean = 24386378405.758633
std = 1748424197.7774565
p5 = 22014000000.0
p50 = 24308649936.61558
p95 = 26910000000.0
display_name = "DIH Annual Funding for Medical Research"
units = "USD/year"

# Create figure with two subplots
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
# Handle edge case where all samples are identical (zero variance)
if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)
ax1.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key statistics with formatted values in legend (use format_parameter_value for full units)
ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {format_parameter_value(p50, units)}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {format_parameter_value(p5, units)}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {format_parameter_value(p95, units)}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {format_parameter_value(baseline, units)}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---
sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)
ax2.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key percentiles
ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"
exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title
fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark
add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from
output_path = get_figure_output_path('mc-distribution-dih_treasury_to_medical_research_annual.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 2.446e+10 |
| Mean (expected value) | 2.439e+10 |
| Median (50th percentile) | 2.431e+10 |
| Standard Deviation | 1.748e+09 |
| 90% Confidence Interval | [2.201e+10, 2.691e+10] |

*The histogram shows the distribution of DIH Annual Funding for Medical Research across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
