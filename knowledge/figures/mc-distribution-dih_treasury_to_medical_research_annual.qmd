```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: DIH Annual Funding for Pragmatic Clinical Trials (10,000 simulations)"

import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Simulation results

samples = [22303834861.583733, 19568000000.0, 23317897720.467075, 23764319797.16957, 19568000000.0, 19568000000.0, 21913764254.303566, 20964217755.70635, 21599858287.864594, 19871179442.63596, 23619764087.003838, 23381578851.412636, 21779068388.664383, 23920000000.0, 22668977905.47573, 19858797599.6216, 22446755412.960373, 19662492023.97426, 23617531375.802647, 21528604983.62903, 21240769458.06069, 20215286062.53845, 23920000000.0, 21305135954.740467, 20731129590.265762, 20889296459.434006, 22815981861.943874, 22439352577.505753, 22545451204.151188, 22586167616.67035, 23920000000.0, 20776493914.977776, 20558321347.464172, 19949174573.49662, 23007205925.058273, 23920000000.0, 21391556322.725266, 19896741075.997814, 19927876521.139668, 23086780885.61586, 23301163508.814064, 22840677811.388527, 20246404120.539314, 22142992843.091927, 21889394681.257328, 22113254362.724117, 23600995297.34178, 22124080898.82831, 23152094072.07904, 21782432473.09884, 22269159537.87388, 23042366464.078026, 19568000000.0, 20957049012.544083, 20644364715.041855, 20300261490.14725, 21050343585.002884, 23920000000.0, 19845849132.340385, 23830106501.089127, 19568000000.0, 20925268749.979042, 21990213844.60009, 22939014664.963486, 23226839848.247215, 23417887322.544876, 20896400033.812218, 20660888710.12883, 23569345311.560276, 21227124645.007717, 19568000000.0, 19568000000.0, 19739981359.031796, 22736126721.438126, 21945669938.291336, 23178834004.030663, 20733353128.020237, 21980973525.57234, 23029273678.457108, 20978643803.67064, 22644718282.95468, 20253643210.32246, 20866553840.874874, 20827699834.69426, 19568000000.0, 22713031893.33335, 20646362982.60829, 21663070643.03301, 22698930704.967567, 22621590394.389687, 23120871821.24969, 21424575102.409042, 20741533015.749676, 21464720775.16304, 19568000000.0, 19568000000.0, 19568000000.0, 19587389758.541542, 22516327412.945633, 19767515087.93513, 20835129253.834133, 23920000000.0, 20880691528.58638, 23287828962.84636, 19712108125.005966, 21197219538.809845, 19679878426.929253, 20916612226.45456, 23527843721.821674, 19568000000.0, 22594285826.59314, 22155308697.651524, 20391036860.152634, 19568000000.0, 21792322032.185783, 20522976882.394848, 22144130154.10992, 21683302035.665447, 23920000000.0, 21125622624.960716, 19568000000.0, 22026486867.501488, 22116139964.967, 23920000000.0, 23515650120.894485, 22420171346.011646, 23920000000.0, 19568000000.0, 20298492374.993546, 19725959225.211624, 20810936457.981834, 19568000000.0, 23051246666.183994, 21161757877.389137, 19568000000.0, 19568000000.0, 22323414829.836155, 23522724278.964836, 23920000000.0, 23920000000.0, 22549222589.36615, 19602457351.651154, 19568000000.0, 22221655145.97158, 19950829555.925053, 20757969527.92179, 20354565038.197468, 21334353453.509975, 23920000000.0, 21977704283.80721, 21296412975.014305, 19568000000.0, 19568000000.0, 20611575262.041183, 21520324414.304714, 23920000000.0, 21919085706.366695, 23864506707.221004, 20584889442.250538, 19568000000.0, 19650268390.11586, 20126159097.017757, 23920000000.0, 19934028890.785656, 23523575191.575703, 19772547612.465725, 23743014314.621426, 22483058468.859665, 21300655587.425766, 21548292415.916862, 20268069944.617844, 22620554726.39327, 20676080026.142002, 19568000000.0, 19568000000.0, 22011797704.681347, 23920000000.0, 21984157287.37858, 21381549117.788155, 22261845164.028885, 23920000000.0, 22114785049.18611, 20767144530.5043, 23920000000.0, 22581516630.442745, 23920000000.0, 22035186753.440163, 19568000000.0, 19568000000.0, 23920000000.0, 23920000000.0, 21252093517.373913, 20824688735.49133, 23920000000.0, 19568000000.0, 19788727716.310207, 23070053820.48682, 20800984143.63645, 21625037326.28328, 21286201438.572365, 22377057322.381794, 23920000000.0, 21832477577.759743, 23071462236.79403, 19568000000.0, 21531198274.32733, 19890641371.5267, 19568000000.0, 19821472348.88347, 20926858493.73215, 23705929401.82044, 19568000000.0, 21702299541.176987, 20615972506.341892, 20940327810.260715, 23912208248.21688, 22829200281.64723, 23920000000.0, 21305186540.93135, 20185034840.0891, 21158304451.357685, 22165833528.317978, 22020550302.21601, 19568000000.0, 21832270413.11325, 22134307378.439156, 23920000000.0, 23920000000.0, 19870784154.9373, 21024655387.1725, 19568000000.0, 20398041121.17424, 22328071882.49474, 23920000000.0, 20118415677.384407, 20269366455.16627, 19568000000.0, 21287851281.004868, 19568000000.0, 20523085960.68592, 19824026266.63083, 21433601955.2462, 19568000000.0, 19568000000.0, 23920000000.0, 19568000000.0, 19568000000.0, 23920000000.0, 23920000000.0, 19568000000.0, 20855743192.737427, 22385945247.369827, 23920000000.0, 19607700485.036335, 21113146364.59577, 23380519153.109848, 22595057614.145992, 20839299808.95585, 21349187254.899624, 19568000000.0, 21128113365.83622, 21068734862.75212, 22143011764.8595, 20470156703.573227, 22678090765.06997, 23920000000.0, 21974154702.10765, 22408735642.43957, 21751114756.71073, 21636270804.305565, 20133524425.380444, 22330052575.03502, 21427137431.285225, 23920000000.0, 23920000000.0, 22485067104.037453, 20050351984.03496, 19568000000.0, 23920000000.0, 22210658374.423153, 22697564825.447315, 19568000000.0, 23733224119.5127, 22639399564.231625, 19568000000.0, 20641992218.753403, 22212803077.57361, 21749620860.73384, 21014616579.275585, 21413886169.955257, 21099041429.45414, 21967871679.874672, 23920000000.0, 19568000000.0, 21130902859.33943, 22020416449.478535, 22284435844.5891, 20848118663.887383, 19568000000.0, 22355685705.205383, 23920000000.0, 19568000000.0, 23583108124.078167, 20938547937.309986, 21504140672.240677, 19568000000.0, 20926163933.82338, 23920000000.0, 22930853911.710453, 23920000000.0, 23920000000.0, 22604797868.868973, 23920000000.0, 22604586995.008198, 23498947346.028732, 21005395650.175125, 21780187507.47187, 20182052663.932423, 23880805534.758133, 19568000000.0, 23392213041.873825, 21228507940.786392, 23920000000.0, 23318869523.577003, 23920000000.0, 23272175220.42867, 19568000000.0, 21492069850.381794, 19568000000.0, 20545944644.296154, 23920000000.0, 23056726458.078117, 20179019813.824646, 19568000000.0, 21706955732.28327, 19568000000.0, 20235035779.966015, 22320065150.978382, 23920000000.0, 22990646692.931362, 19568000000.0, 22303055401.764717, 21792113489.519154, 22548054892.28747, 23920000000.0, 19568000000.0, 20397234546.49566, 22949735067.04965, 19568000000.0, 23920000000.0, 22445872843.517185, 23542577335.466995, 20438293912.159737, 23465628058.97219, 23920000000.0, 22144575935.382545, 22147940142.130047, 22227489613.789413, 19850770857.731552, 21320019366.81684, 21309401583.08166, 22479566604.08806, 23905211880.91343, 19568000000.0, 21367965752.424286, 23920000000.0, 20089328746.37909, 19932312263.41127, 22077147124.506306, 23537414242.426174, 21660762766.452007, 23920000000.0, 23566566744.192337, 23531392388.094864, 22865667695.923595, 23920000000.0, 21197802858.366673, 19568000000.0, 23920000000.0, 20670479226.89893, 21870176638.7732, 23920000000.0, 19568000000.0, 19568000000.0, 19568000000.0, 19988288536.096775, 22606037910.919403, 22797505780.818283, 22240643715.19452, 19568000000.0, 19568000000.0, 21753714732.212173, 20641474933.809177, 22650615832.66907, 23205365196.578392, 21936511947.494236, 23340428593.086174, 22136477974.134224, 22810874165.97869, 20167463462.817978, 21251898060.032055, 22064971968.412544, 23481467925.182964, 20802776854.646805, 22790637753.256912, 21069888057.232697, 21383887175.027664, 23502536047.124584, 19568000000.0, 19568000000.0, 19568000000.0, 19568000000.0, 20220660964.94537, 23315531618.323296, 21029897656.55107, 22067203873.679913, 23920000000.0, 23920000000.0, 21487386530.947113, 23920000000.0, 21835835491.752174, 19902216207.7791, 20390527551.676315, 19568000000.0, 19801746589.995895, 20877041153.632584, 23441814651.45381, 23920000000.0, 19568000000.0, 22500730162.28759, 19568000000.0, 22685237104.06141, 21355015331.94421, 19568000000.0, 23735256661.195168, 20368977998.420628, 20513955795.650726, 19568000000.0, 20269089787.5625, 22579566022.979237, 21231486973.723423, 22357172097.503212, 22431470002.87593, 23920000000.0, 20908783050.508926, 19568000000.0, 23920000000.0, 20932360293.35706, 23920000000.0, 22479529041.846207, 21354906949.1073, 22402074284.46219, 23920000000.0, 23920000000.0, 21786348401.826187, 21984593644.190773, 23920000000.0, 19885819036.04704, 22367005621.772305, 21580342656.00703, 22324293013.196213, 19910217309.516827, 19568000000.0, 19568000000.0, 19568000000.0, 20668467203.590534, 21012477686.869873, 23920000000.0, 23920000000.0, 19656199976.849556, 22399689066.92131, 20775119448.196915, 21030988999.37647, 22039783799.94133, 23014532029.036526, 20916141926.954514, 23920000000.0, 19568000000.0, 21649774138.22734, 23920000000.0, 22122942591.999214, 23920000000.0, 21834514524.32678, 22926558272.39397, 21513883952.754257, 21271418274.099476, 20017527693.172493, 22584996888.65548, 19874166289.084972, 23121333387.160286, 23920000000.0, 22441786569.516315, 21027035106.392033, 22638372600.686188, 20980053216.280674, 23752428459.27263, 19568000000.0, 20923761050.790123, 19568000000.0, 19568000000.0, 23920000000.0, 23656989208.4945, 20137697799.994404, 19568000000.0, 19568000000.0, 20494330440.17203, 23920000000.0, 22595324018.437645, 20461490426.843468, 22663485667.663673, 19568000000.0, 21003819174.024277, 21851852569.230446, 21451059458.252, 23411952120.650627, 22392845642.57347, 23127655546.919483, 20200283336.87269, 23663197346.63051, 23920000000.0, 19640405953.24474, 19802612159.926365, 23920000000.0, 21227040663.892197, 23920000000.0, 20701769080.744934, 23920000000.0, 21921734313.089928, 22200645487.239063, 23920000000.0, 20869225302.10329, 19697357643.81031, 20689323801.878544, 22634688343.415413, 19568000000.0, 23056581773.37226, 20503990553.321625, 23920000000.0, 19568000000.0, 20003388773.79308, 19568000000.0, 19924401594.66033, 22177265747.966385, 21252713790.66218, 21096094712.930744, 21295244543.903305, 22079530168.137737, 19568000000.0, 23216701094.721592, 23114601418.84645, 22483253522.134293, 22871181116.565456, 22285378399.88318, 23920000000.0, 21448933658.92436, 20983380673.201675, 20069420777.09178, 19568000000.0, 19568000000.0, 19800436134.41871, 21484080711.148964, 22369738389.183548, 21746746956.16638, 20045396338.220936, 23668790247.11342, 23292236337.385963, 21294260122.24422, 20271854137.86576, 22852696400.72003, 22045606055.604305, 19568000000.0, 21489868037.87467, 22209077833.288307, 19778924009.89443, 22049718288.506943, 19568000000.0, 23920000000.0, 23920000000.0, 21097905037.268707, 22434899303.94245, 19568000000.0, 19568000000.0, 21011246658.450577, 19568000000.0, 23234185384.40825, 23920000000.0, 19568000000.0, 19902086807.60456, 22150254437.09794, 23920000000.0, 19568000000.0, 22180297175.030983, 23920000000.0, 19568000000.0, 19568000000.0, 20740895165.6987, 20541213807.024002, 23462907349.34683, 22163982780.58357, 19568000000.0, 22777553899.69925, 20424852335.20911, 23920000000.0, 20323137006.628304, 20304843652.727432, 22836069877.00354, 23346933195.442085, 22625129340.618668, 19568000000.0, 22829015832.33339, 19568000000.0, 22149873836.09673, 19568000000.0, 22621118719.4047, 19963455283.666153, 19568000000.0, 23232849659.20039, 22163949179.228344, 20350748248.30338, 23920000000.0, 20705658495.786873, 21705495463.4741, 22224319674.46875, 20339202502.696774, 22677180872.59482, 20514872333.52479, 20765671520.96604, 23920000000.0, 19568000000.0, 19568000000.0, 23920000000.0, 23920000000.0, 20778868600.258602, 19568000000.0, 20976263684.602592, 21027089187.160168, 21230047930.065308, 19568000000.0, 22923777611.54457, 22798232435.402317, 19568000000.0, 23198984507.179092, 23920000000.0, 22010419754.767838, 20920176024.26624, 21331773617.386208, 23005547490.404903, 19568000000.0, 21993806384.164444, 20809578547.600143, 23920000000.0, 21263430675.315384, 23920000000.0, 19568000000.0, 22941387271.99655, 22336526495.811073, 19839483336.98866, 22022357625.755676, 23920000000.0, 20948436927.96541, 19568000000.0, 21598217246.87389, 19773541860.21064, 20909711640.96968, 21460718171.09391, 19568000000.0, 19568000000.0, 22701920110.21967, 20536849291.05516, 19568000000.0, 23398032563.429905, 22231983303.78544, 20148960884.138016, 19568000000.0, 23517284322.87062, 22403358630.905094, 23920000000.0, 22562225502.139614, 22489231661.592846, 21278802862.209015, 23472679805.81622, 23028113178.465176, 23920000000.0, 20539708849.741837, 20716494337.70414, 20626393761.086536, 23411941843.81498, 23920000000.0, 20668126595.40721, 20738480611.358925, 22324669386.43486, 21112127782.377274, 23791570196.432884, 19568000000.0, 19923456407.45604, 20011670136.91887, 19568000000.0, 19653166314.798294, 19748442716.328197, 21206383231.520256, 23920000000.0, 21113603795.760696, 19568000000.0, 21513516238.960243, 23920000000.0, 19629027926.93834, 19757469501.98955, 22875779840.877274, 21163207241.1138, 23079624241.846817, 21606655800.6501, 23204693974.652496, 19568000000.0, 21610022934.531883, 21186116385.01558, 19568000000.0, 19568000000.0, 23167885653.73803, 20891757846.59751, 19568000000.0, 21429505062.002426, 23920000000.0, 19568000000.0, 19568000000.0, 19733220356.15315, 23920000000.0, 22254653295.925224, 23357161018.955875, 19568000000.0, 19568000000.0, 22624484676.296066, 21762224266.18538, 22853405130.890984, 21234819385.030148, 22244791756.067314, 21980051310.503677, 23381521600.965996, 23449820813.05622, 19568000000.0, 19568000000.0, 23909793451.84831, 23920000000.0, 19568000000.0, 19568000000.0, 21850887719.069664, 23741274111.74676, 23920000000.0, 22779569718.61827, 20848530194.562214, 19791879179.342525, 21660817293.936768, 20999752148.950302, 19568000000.0, 23920000000.0, 23920000000.0, 23920000000.0, 19737228543.444866, 23562395252.570602, 23061539810.561867, 22612598648.420856, 23920000000.0, 23051752988.963028, 23293634072.32106, 23055283227.919777, 22384238959.708706, 19568000000.0, 21817316883.84948, 20468391044.86435, 19568000000.0, 23920000000.0, 23920000000.0, 23920000000.0, 22193968740.38942, 23920000000.0, 21662117831.780296, 22078228630.86635, 19568000000.0, 22510077742.653522, 21766808628.34057, 19568000000.0, 21525875243.63347, 21464696466.979923, 23920000000.0, 23654696395.75202, 21660804648.29802, 22179746680.590824, 21731719821.55622, 21202556182.491924, 19568000000.0, 21312527897.320774, 20084299436.94354, 19568000000.0, 22768039030.99511, 22497222746.62059, 19568000000.0, 21372920731.385025, 23895382622.540504, 23920000000.0, 23920000000.0, 21720235481.866898, 19887040408.493843, 19568000000.0, 22392755575.98774, 22470343779.92084, 23920000000.0, 23920000000.0, 21352582779.355236, 19568000000.0, 20958229379.043087, 22110039820.082546, 21204313255.429, 20424128619.025253, 22188814098.041546, 20575318561.69198, 20322166889.885815, 22318825856.754116, 20785661361.81929, 22169388327.145706, 22233833511.149887, 19568000000.0, 20621995369.413193, 23920000000.0, 19568000000.0, 19568000000.0, 19568000000.0, 21699005897.23207, 21702918227.90653, 21383740658.906906, 23920000000.0, 19568000000.0, 22507703503.259987, 23920000000.0, 19568000000.0, 20831712843.688126, 20070693384.3311, 19789479752.853996, 20943275537.624832, 23920000000.0, 23920000000.0, 20923068419.345047, 23920000000.0, 21713007250.06755, 23920000000.0, 21435662911.879025, 21920798436.050774, 22439420642.150185, 23920000000.0, 23553621154.25766, 20162251202.592793, 23831816912.5373, 20869096110.883926, 20604499050.621964, 23688670593.312317, 21703282603.92469, 22245750779.521255, 21666293037.9182, 22374844437.116795, 22572979911.84427, 19568000000.0, 23123610897.47698, 19617164718.232098, 19568000000.0, 21510390379.015385, 21818100207.06959, 20189941184.44817, 23506082974.23811, 19568000000.0, 20775398154.875046, 20409912920.415176, 21535775932.8275, 22246390694.6178, 19568000000.0, 23257109338.790344, 21772490363.157333, 19568000000.0, 19568000000.0, 21609517139.08121, 21164408040.851616, 21414031752.802032, 21575780324.343693, 22128416330.196705, 23781120635.21925, 19568000000.0, 19568000000.0, 19568000000.0, 22268709198.96077, 23920000000.0, 20724902629.895397, 19568000000.0, 19568000000.0, 19910876861.14753, 20465253262.043514, 20772404042.1773, 21719515993.221394, 20973622486.799908, 23920000000.0, 20225194028.898056, 19852805171.33276, 22694694418.104996, 19568000000.0, 22493693111.682613, 21858557883.404495, 21320202668.61554, 23920000000.0, 20334046778.77994, 23920000000.0, 21154985562.085777, 19568000000.0, 21787518593.25343, 19568000000.0, 20072968013.549427, 22510172040.02652, 22869010770.733524, 20334127395.733707, 23875615911.600986, 23920000000.0, 23920000000.0, 22809392239.54847, 23920000000.0, 19568000000.0, 20960738364.24604, 19843524880.78372, 21894941578.7298, 20437263233.798878, 21280437505.807835, 23920000000.0, 21272877701.999657, 22547834543.445133, 21140560924.577675, 21800113894.49092, 21649077935.318535, 22625636473.42741, 23920000000.0, 23920000000.0, 22314745912.75798, 22946623164.419464, 19568000000.0, 21447259365.902023, 23763667316.13448, 23588144367.43311, 22097645126.16011, 23636253102.06177, 22721629934.265415, 23920000000.0, 22269692138.13096, 20881869752.67541, 22373188704.007156, 19568000000.0, 22478427223.572342, 19568000000.0, 19568000000.0, 22633411909.892044, 22691647056.920826, 19568000000.0, 20152524289.152927, 23920000000.0, 20616258978.36219, 23920000000.0, 21631945577.955776, 22534891682.198753, 23920000000.0, 21920731285.095127, 19577433123.233566, 21400563021.10509, 21559368885.63725, 19568000000.0, 21090930179.156246, 20092126708.20729, 23725931868.38502, 21710918115.75435, 21034278902.441246, 21408133107.423782, 22123035886.10518, 23009121818.08445, 19582573281.39018, 19568000000.0, 23920000000.0, 20764224592.37108, 19568000000.0, 22615456913.42909, 22659619265.84309, 19568000000.0, 22137074934.662426, 23283340268.608242, 22459377750.370407, 23043959977.398643, 19568000000.0, 22362476382.905495, 20992725310.346107, 20618809139.694256, 23598939746.42052, 23920000000.0, 23920000000.0, 23920000000.0, 21400548654.48063, 22410890028.180313, 23356009213.707047, 21899205451.780174, 21920156367.75539, 23489022278.75476]  # Truncate for embedding
baseline = 21744000000.0
mean = 21676780805.118786
std = 1554154842.4688504
p5 = 19568000000.0
p50 = 21607688832.547184
p95 = 23920000000.0
display_name = "DIH Annual Funding for Pragmatic Clinical Trials"
units = "USD/year"

# Create figure with two subplots

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---

# Handle edge case where all samples are identical (zero variance)

if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax1.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key statistics with formatted values in legend (use format_parameter_value for full units)

ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {format_parameter_value(p50, units)}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {format_parameter_value(p5, units)}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {format_parameter_value(p95, units)}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {format_parameter_value(baseline, units)}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---

sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax2.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key percentiles

ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"

exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title

fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark

add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from

output_path = get_figure_output_path('mc-distribution-dih_treasury_to_medical_research_annual.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Simulation Results Summary: DIH Annual Funding for Pragmatic Clinical Trials**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | $21.7B |
| Mean (expected value) | $21.7B |
| Median (50th percentile) | $21.6B |
| Standard Deviation | $1.55B |
| 90% Confidence Interval | [$19.6B, $23.9B] |

*The histogram shows the distribution of DIH Annual Funding for Pragmatic Clinical Trials across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
