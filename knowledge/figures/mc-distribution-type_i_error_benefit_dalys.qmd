```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Maximum DALYs Saved by FDA Preventing Unsafe Drugs (1962-2024) (10,000 simulations)"

import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Simulation results

samples = [2778976.963396419, 1854959.4769061857, 3175794.629638032, 3365197.5981806885, 1410150.782326572, 1716726.5980642796, 2635621.348123284, 2307823.1513813343, 2525217.0142811453, 1962462.7323552652, 3302674.998461984, 3201025.8642743747, 2584025.7597847353, 3557600.093869344, 2919375.001335061, 1960531.8477076825, 2833690.6074399306, 1900364.448431238, 3302485.6230263496, 2497650.8798623728, 2400415.57546362, 2067679.9089634095, 3658446.7043058854, 2418801.5086907772, 2230097.4353333083, 2279160.595417951, 2976760.21075467, 2831559.660730845, 2872235.330192188, 2883463.4839385934, 4391088.0, 2245508.838397585, 2175540.000411298, 1985401.1649099423, 3049561.6025311137, 3559798.191479332, 2450061.7008912396, 1970077.2131824938, 1978005.0661422845, 3085685.9489431684, 3172726.571838238, 2985273.8240961838, 2077016.2137811023, 2721713.3741342067, 2627447.799015439, 2708117.5420114477, 3294388.0163271483, 2713854.7055133195, 3110823.3434675615, 2589217.984164092, 2768361.5446421523, 3063934.770615246, 1635788.229123144, 2302414.8085973687, 2200946.0585639635, 2092638.1893150385, 2333704.621026933, 3971449.4933992596, 1954868.4309294182, 3391050.53251124, 1529916.6991430619, 2292697.611910658, 2661946.157365649, 3024337.3415218103, 3141753.301290362, 3220621.438543764, 2284560.973486071, 2206899.933990526, 3280060.0042237015, 2394573.687807858, 1726448.6005775726, 1802550.3661213636, 1923080.3352656988, 2944246.5386264664, 2645846.9786244817, 3119618.907908533, 2230232.4443115923, 2659773.0211337125, 3057932.2709838757, 2310118.01430203, 2910956.3487601765, 2077430.2746418628, 2271413.2234448264, 2261306.809319829, 1770741.3401799311, 2935893.930137798, 2201066.212347953, 2543845.3290276905, 2929851.4223140464, 2902631.857768532, 3096716.684370276, 2463608.3358631013, 2232092.153726774, 2474132.499887347, 1528483.0234987265, 1641621.19510465, 1703774.9322649427, 1877842.3016833053, 2858532.2833792698, 1932004.6391843313, 2263137.9215276157, 3745463.9415409267, 2278627.317173224, 3164981.805457164, 1915391.8394520306, 2384843.596119384, 1907480.420118387, 2292159.2594979024, 3263189.449012372, 1508288.2400318794, 2889038.5502904407, 2724142.027619232, 2121674.120732285, 1642839.027243857, 2591395.8291634144, 2162185.2215681705, 2721795.2420572178, 2551663.9962592246, 4101421.795254605, 2361136.2303915676, 1867764.0149138323, 2675960.334003266, 2708324.647404924, 3815472.965176211, 3260441.794529168, 2820213.089907291, 3933016.6270181355, 1772598.105645477, 2092536.3578178408, 1917370.838105185, 2255316.973744563, 1678292.5580602803, 3069602.1413965663, 2371230.591345532, 1628523.4728763641, 1869788.1228135468, 2786937.6712202053, 3262759.5307873613, 4391088.0, 4391088.0, 2872519.594515507, 1884818.4224936608, 1347490.899278902, 2748466.6910998896, 1985492.242843339, 2238052.9034613874, 2108319.1788379727, 2432064.3033177373, 3493854.771588717, 2659542.1697263033, 2418232.888859007, 1860356.5841364397, 1535532.458575671, 2191321.9140344406, 2495635.3912774143, 4312781.343021021, 2637505.412496063, 3407499.816871967, 2183423.301645501, 1777923.7807358396, 1898485.7605927072, 2038916.0805633336, 4391088.0, 1983302.634495354, 3262830.982688458, 1932275.2597118658, 3356648.6921117464, 2847903.929551619, 2418509.4242389877, 2503931.715725149, 2083215.8383781929, 2902553.160957493, 2214129.1601009644, 1755643.8604614155, 1726240.0638263668, 2669957.6444192166, 4074775.1351574035, 2659997.865285535, 2447959.3380670706, 2762867.7199604358, 3753875.6951610413, 2708227.3994812304, 2239977.915437073, 3534538.8050983027, 2883111.1943626064, 4021186.7890267763, 2678104.4794510775, 1755751.17615961, 1680196.4772987943, 4160889.3372668577, 4255867.840897138, 2402574.2278784285, 2261121.773249384, 3932560.803724366, 1817437.0215848086, 1938105.7402670232, 3077724.230788676, 2253335.6556085283, 2533351.3375502788, 2416136.8222697047, 2808908.5967381545, 3868206.190879605, 2605596.5954933655, 3077836.71266586, 1372193.8989520147, 2501323.166490304, 1968483.6210971, 1761245.4792558309, 1947333.2691812338, 2294182.309518195, 3336835.3030679896, 1702286.745782221, 2559404.5203379574, 2192932.423329639, 2299982.0821940666, 3425136.1757331085, 2982748.322303445, 3791667.7825850556, 2418804.806815186, 2059705.2767401352, 2371009.363824685, 2729861.5224284823, 2675538.862289816, 1830798.7986422523, 2605582.212019736, 2716128.282549778, 4391088.0, 4379084.8, 1962441.1942123703, 2325722.170779085, 1634120.2455226658, 2123402.4861213127, 2787280.1894043703, 3641074.500521119, 2037192.9250332287, 2083290.0557236641, 1341184.0, 2416244.101612187, 1845321.670580644, 2162191.6800173577, 1947471.5270888424, 2464205.56070069, 1497752.2436536716, 1633808.5723688898, 4391088.0, 1724202.5031766454, 1824610.7938796151, 4365628.9386510495, 4391088.0, 1785351.891794759, 2270745.2514701663, 2809566.04591875, 4262179.664511538, 1885094.0211180446, 2355381.451870182, 3200938.2167513194, 2889097.0338644735, 2263394.840729384, 2434473.359396777, 1678452.3138038768, 2361294.947700031, 2339828.7294608136, 2721714.7361642094, 2146481.7782485336, 2921681.9744635075, 3438919.447223727, 2659291.5565113057, 2817787.9999331185, 2575647.618121873, 2535587.116665596, 2044290.7712686416, 2787425.884788684, 2463777.8396066227, 4391088.0, 4068352.6370533537, 2848054.163273468, 2015938.043421247, 1815710.1942727126, 3626019.6730128517, 2746117.9664947633, 2929746.5987718413, 1500905.2354556795, 3350847.8732751305, 2905591.165274591, 1817103.6203049547, 2200803.415946022, 2746273.6040509334, 2575544.810544981, 2323692.3403057023, 2457941.42975863, 2349523.414106478, 2653888.0390405846, 3944946.8920742646, 1306464.0, 2362883.923169254, 2675529.3604371287, 2771035.7234200295, 2268898.2572176973, 1497830.5024658472, 2800800.5319604496, 4261817.553606202, 1602688.109055336, 3287914.8004037347, 2294911.085303751, 2489592.8247578964, 1847486.1732317214, 2292753.2947985493, 3745652.99343509, 3022049.9572062558, 4265189.40106452, 3609364.147922464, 2894795.268566679, 4280285.777615161, 2894779.2830508854, 3249122.3612628896, 2318152.174634731, 2589063.0096299234, 2054576.2646837481, 3413880.122358581, 1779743.9367821794, 3206865.608551447, 2394663.070095526, 3606161.4586194884, 3175874.422661436, 4356170.111021082, 3158742.604789455, 1581298.969576394, 2487329.171187925, 1780349.494061954, 2169844.769538245, 3994283.5498743285, 3071700.149363932, 2054404.403042594, 1869977.7076563132, 2559723.173713926, 1761458.4623269178, 2075064.9102858477, 2785127.903925346, 3585930.039218495, 3046594.671782034, 1312416.0, 2778919.787459467, 2591381.399988751, 2872431.576108915, 4119048.3755665184, 1366319.8557953977, 2123355.4724224587, 3030142.2322534784, 1575545.2667603977, 3947985.147201879, 2833624.809417705, 3271114.6919174776, 2136996.6869217763, 3237939.4204163076, 3496186.8777143504, 2721827.33206857, 2722069.52601106, 2748891.0639149323, 1955135.7532602479, 2426167.1003964404, 2424039.643595863, 2847642.787089969, 3424523.7518576905, 1845709.7463147303, 2442106.0647077067, 3956246.575385214, 2029316.723345102, 1983208.4374154774, 2697504.5371501395, 3268953.3764172723, 2543688.2462997464, 3777879.233201787, 3279825.534521519, 3268447.5051132566, 2993818.8345542965, 4391088.0, 2384881.0945020025, 1388439.890878226, 4107018.8447891464, 2208831.306385411, 2619641.0193178384, 3759660.116640538, 1566685.936845919, 1740936.2185616277, 1566766.7030619578, 1998747.2500713384, 2894889.2738927067, 2968737.429631107, 2754808.189875675, 1657938.2610051527, 1306464.0, 2575826.55902633, 2200772.3168966994, 2911405.724919991, 3133366.9645102853, 2643688.9214985287, 3184305.1875482714, 2716284.479969693, 2974734.689576701, 2052456.5502518853, 2402561.5612330744, 2691675.3651268026, 3245939.670611087, 2253445.487047706, 2966579.053785565, 2341305.338579587, 2448113.143979877, 3254382.965638962, 1394145.7278334245, 1717250.5798105984, 1626422.766959908, 1306464.0, 2069285.2146113946, 3175600.3653173703, 2326052.8942497405, 2691834.667306918, 3517317.4580938853, 3777581.1389893135, 2482056.772984819, 3809189.896605651, 2605829.7525680275, 1970376.560143682, 2121644.5045065666, 1626564.619373304, 1940056.2623590718, 2277021.5052404245, 3229281.020979307, 4250130.437113916, 1672842.5280911494, 2855773.272528068, 1854902.9929825466, 2927189.1166167897, 2439815.538238269, 1463110.2087646062, 3351022.4107608926, 2115431.9911680697, 2160316.1080971337, 1839628.1795335948, 2083274.2178384927, 2882963.464152506, 2394855.5788990343, 2800910.1795470435, 2826013.2792711514, 3769092.0649965946, 2286712.5272775544, 1626881.2523955146, 3494119.7792208726, 2294525.273836216, 3543112.241500835, 2847639.97815374, 2439808.430154387, 2817293.9177680383, 4391088.0, 4391088.0, 2589488.341980451, 2660028.6839590454, 3502808.6234956193, 1968220.6665625062, 2803205.335940936, 2517472.1127707395, 2787002.255328138, 1975774.1408519065, 1573787.6848710089, 1364637.8692399936, 1810262.0952705746, 2208709.955757344, 2323557.7449580412, 4391088.0, 3534474.9307156913, 1900031.4407955152, 2817117.0339904535, 2245424.892135155, 2326121.7537491038, 2681864.7206297913, 3055103.3994431216, 2292130.0169556467, 3488440.778478089, 1800514.886563922, 2541463.7826457466, 4391088.0, 2713772.9786057896, 3900034.6280902633, 2605738.0273428108, 3021712.189350215, 2493745.050214852, 2410215.885154343, 2006598.8227737003, 2883374.801035129, 1962625.4894952965, 3096753.804139521, 3513319.243743385, 2831740.760656189, 2325872.2932298617, 2905512.9400686123, 2310206.404446223, 3359213.9203407913, 1462024.3224756557, 2292603.833581221, 1394306.2062013955, 1619240.7856822982, 3818480.7464448507, 3319241.1549525023, 2044525.803804288, 1613644.129470904, 1306464.0, 2154197.4253788046, 4391088.0, 2889117.2215273962, 2144643.3044448076, 2918955.480307124, 1588283.5407475128, 2318053.007557731, 2613404.9636840303, 2471772.6614092747, 3215169.1080939895, 2811649.6280671232, 3097262.30595806, 2061866.9505439932, 3319770.2377027976, 4134264.2532049557, 1894235.9485768885, 1940102.975935789, 3786329.1703198426, 2394568.2614931636, 3865408.9187949207, 2221997.855846808, 3924097.4514257596, 2637691.31849798, 2740431.521106281, 4054258.2988663428, 2276538.3350622803, 1909646.1288818354, 2216284.8948891643, 2905232.3306363667, 1582922.7345466455, 3071688.6004071604, 2159727.6385637377, 3577491.5418671593, 1306464.0, 2000855.2978213674, 1528552.1329335917, 1977814.4439187206, 2732231.630182648, 2402614.425463532, 2349335.8675943837, 2418156.7384237284, 2697674.7090950673, 1875465.6867738958, 3135969.33435106, 3094543.2764568175, 2847918.517840268, 2999209.8876697267, 2771104.689502081, 4391088.0, 2471631.6278871037, 2310415.1036750097, 2021961.5917043474, 1860699.127796362, 1746567.5958625895, 1939985.5423229095, 2481836.295836075, 2803407.37831191, 2575347.050243716, 2015661.7900264056, 3325206.99096263, 3167035.386151689, 2418092.583305042, 2084738.2245861853, 2991171.081840606, 2683806.051679915, 1641532.9156565706, 2482222.2931283894, 2741043.277621577, 1932618.2322702839, 2684098.815388699, 1635990.8962404926, 3786423.418787637, 3689616.1577396197, 2349451.0846660766, 2827846.889571649, 1306464.0, 1792967.2750323194, 2323480.2847161964, 1838182.9617239372, 3142350.4618795337, 4391088.0, 1779906.2967367708, 1970369.4844999416, 2722236.1539475024, 4115738.706526763, 1755948.9923987056, 2732450.936343016, 4356350.3538492145, 1544501.2863356036, 1725950.1217088676, 2232053.3316551032, 2169563.8387999884, 3237712.5757423183, 2724767.9456506465, 1490395.673298747, 2960606.396148375, 2131250.4363269843, 3719245.051211671, 2100227.556762848, 2092901.9777240234, 2983282.8353838655, 3189800.660171938, 2902900.7936802115, 1528621.6167075797, 2982733.972505931, 1860492.491605354, 2722208.7498472584, 1655841.1031395397, 2902596.01643672, 1991147.2857235507, 1724644.2996339088, 3142241.860910939, 2724765.520579714, 2108098.0561935026, 3921218.2936282572, 2222233.2531087305, 2559623.2316320897, 2748660.48481642, 2106115.500876402, 2921612.3215265474, 2160370.244189094, 2239887.9860841846, 3818191.8876296645, 1854898.7442257865, 1306464.0, 4115692.4666869184, 4391088.0, 2245653.884918187, 1417168.8819648288, 2309968.758851788, 2325875.7050385997, 2394762.583174438, 1815614.3014464977, 3016533.574258359, 2968793.797522006, 1619296.8759834052, 3127889.6582116354, 4391088.0, 2669859.863671938, 2292380.8699051146, 2431895.5858765184, 3049429.921619754, 1506956.5130481927, 2662200.4301044345, 2255233.5839715395, 4367814.822109986, 2408269.107946807, 4184245.6008175546, 1822722.74489562, 3024524.300552749, 2792862.170698114, 1953268.6362816652, 2675667.164346302, 3649378.9188774577, 2300487.889092189, 1523153.9876615985, 2525106.2284966093, 1932328.7317967948, 2286770.2485412704, 2473866.307827724, 1520991.4924093073, 1560624.96418411, 2930080.861466528, 2167966.837111079, 1306464.0, 3209054.894549572, 2749217.9807780427, 2046451.2997533458, 1709270.492763981, 3260578.7618132355, 2817389.1695671026, 4391088.0, 2875095.32677268, 2849951.3731968184, 2410695.826375148, 3240245.3912337422, 3057839.892268119, 3690475.7905679876, 2168136.259165001, 2224249.12545253, 2198517.128341794, 3215168.255715321, 3977260.626749882, 2208689.4137649112, 2231906.381769117, 2787029.9355667327, 2355316.582918565, 3376028.841994031, 1320352.0, 1977762.5992891085, 2006274.1608415907, 1306464.0, 1899870.9169072364, 1924776.2040671033, 2386853.431725643, 3542759.4072680506, 2355410.5845049787, 1860845.5568557254, 2493720.4982356923, 3476767.143907999, 1892405.0773527513, 1930220.1842543476, 2999569.496776595, 2371323.4473972493, 3080153.1556320474, 2525675.988770073, 3133312.540210849, 1860414.7159049104, 2527375.054199551, 2379170.0072960015, 1761521.7460199252, 1588073.1380548736, 3117057.32258356, 2284273.171565138, 1867887.5003211894, 2463934.479333363, 3559590.1538928384, 1313408.0, 1619105.7387101352, 1922718.894932549, 3932495.7207477326, 2762342.9850801416, 3192345.023135431, 1800687.7010698346, 1810051.0253615926, 2902851.800833722, 2581372.350111016, 2991226.3648707257, 2395070.951338683, 2756663.705087928, 2659707.897608166, 3201021.129008169, 3231661.7794903996, 1559189.176625264, 1320352.0, 3424924.7799706273, 3623416.0732654044, 1868055.6737954658, 1452833.2376265493, 2613337.799059689, 3356499.2148553403, 4344858.407584718, 2960762.382489815, 2268923.6205665255, 1938275.3593976093, 2543691.9574765014, 2317797.204269, 1869840.1710164752, 4391088.0, 4331525.80432136, 3568126.8036475233, 1922933.15789828, 3279473.567978353, 3072084.394586058, 2896988.710930787, 3690006.6796142966, 3069642.4807355087, 3167149.852407674, 3071584.951329081, 2809439.8123797514, 1484767.7228499835, 2599584.300225848, 2146377.902687666, 1726063.8189298436, 4199859.432068475, 4262259.680300739, 3815480.7695046254, 2738400.319242014, 3803531.147899114, 2543780.475356341, 2697581.764991098, 1824938.7964301275, 2858062.667543624, 2581688.0175116644, 1716683.2322944372, 2496006.8620172753, 2474130.8831479247, 4344849.236437164, 3317302.86074192, 2543691.0968052195, 2732411.109323539, 2567866.154689301, 2386606.8618785357, 1832198.443580279, 2424243.521770659, 2029035.2878265276, 1741060.7503853813, 2958247.6143273874, 2850550.3245922993, 1483472.159626823, 2442431.85822522, 3421887.362142653, 3485656.9786614194, 3453378.492024925, 2565592.320306613, 1968287.2608700877, 1830867.1535340068, 2811642.950977753, 2841993.2192577175, 3730916.232026415, 3528215.085334557, 2439656.0114295394, 1746592.493212725, 2302488.6211092817, 2707886.855636406, 2386720.062095948, 2131208.116112089, 2738027.2260627104, 2177892.906106398, 2100171.543208779, 2785036.9408098157, 2247437.233319328, 2730118.1154851285, 2754312.6004739655, 1800758.8849881105, 2193293.4319845233, 3906103.043623442, 1787453.1020366037, 1349058.2959878498, 1452682.7194375647, 2557696.1244216748, 2559446.8576551066, 2448103.505185996, 3649754.5399298584, 1306464.0, 2856296.1639864827, 4053425.3585316013, 1808048.0592646427, 2262927.4933899115, 2023314.2133817843, 1938146.2144995763, 2300165.927198169, 3891758.7449508375, 4365759.994557099, 2292560.754136105, 4391088.0, 2565097.4073503544, 4294891.611706033, 2465791.4719190425, 2637625.626948189, 2831564.7248131586, 4391088.0, 3277004.42493087, 2052162.01388573, 3391198.878927407, 2276530.349880618, 2190898.8293829784, 3333610.0466169687, 2559471.792742131, 2756733.64205114, 2549024.681689932, 2803784.942649026, 2880867.9874070655, 1417159.488391256, 3096936.9741229, 1886819.6137372477, 1643167.01021339, 2490010.7974544507, 2603100.360844116, 2059983.3865783617, 3254680.1101512713, 1694745.8237054588, 2245441.9138971413, 2129054.6580019603, 2501629.639821071, 2756780.309439368, 1875531.253777364, 3152552.1509661456, 2583571.765787541, 1438442.7813556343, 1408580.0363727633, 2527340.828988194, 2372815.774326985, 2457951.055727926, 2517164.9535017535, 2714166.0096163456, 3373365.0695149065, 1815838.5184075406, 1780352.919875366, 1824953.4002614322, 2768328.6731598005, 3687072.004878535, 2229719.4132907707, 1306464.0, 1521123.09622615, 1975810.2186042627, 2144864.163126023, 2245259.06154404, 2565543.050892986, 2308411.538428476, 3476802.330349573, 2069543.6489196075, 1955246.2633825298, 2927913.4238729044, 1597577.9112880745, 2850285.7469503423, 2613871.8017364712, 2426179.0817197547, 4086048.1000771625, 2105817.63631282, 4391088.0, 2370796.784411654, 1726325.378825947, 2589569.140840019, 1837773.4648605364, 2023441.4168111375, 2858069.752439825, 2994080.1937593236, 2105822.293335513, 3413427.7987545896, 3591373.8944364726, 3900784.553497624, 2974619.6800276986, 3818378.060621514, 1440307.7032138377, 2302645.528901802, 1954742.2098413354, 2629343.452684353, 2136936.382546346, 2410802.08520937, 4381961.600000001, 2410310.725194215, 2872414.9671490495, 2363500.7955333292, 2595399.0549788466, 2541416.509133145, 2902939.3353366544, 3599887.665263022, 4157958.0738468184, 2784737.5075675347, 3029896.9431808894, 1794687.815684184, 2471520.557563675, 3365141.4171168604, 3288340.7545318594, 2705463.228289473, 3310774.4364854917, 2938170.753727613, 3637986.4112189137, 2768400.4213549313, 2278700.324609866, 2803662.502009928, 1306464.0, 2847557.5850700997, 1306464.0, 1508592.1993662347, 2905135.1210587076, 2927680.006918386, 1787419.3529586457, 2046652.539184952, 3826928.754309106, 2192949.5922979303, 4391088.0, 2535293.6065502795, 2866479.637341093, 4119220.364372854, 2637620.913548629, 1877320.6354985414, 2455615.6541878227, 2509635.3018230433, 1681645.985598573, 2347601.0108554494, 2029473.3212862404, 3348469.0271129785, 2559994.3922361583, 2331289.3527100985, 2456115.037532737, 2713779.676696047, 3049713.736118916, 1877589.9191784596, 1854797.7060685698, 3534190.756013655, 2239799.654421205, 1657578.8949506767, 2897205.84162365, 2913700.200827646, 1602953.6063207448, 2716327.4399612457, 3161346.990785848, 2839591.8846503245, 3065721.352163234, 1663648.232842846, 2801301.5157025643, 2315961.3566872226, 2193102.438859607, 3294214.070360706, 3953764.2497006953, 4339012.106732412, 3762767.6365119447, 2455614.7065968346, 2819523.1895784717, 3192250.001366297, 2629641.907164177, 2637580.559982059, 3248291.2050293027]  # Truncate for embedding
baseline = 2589120.0
mean = 2628008.886326289
std = 754363.7695955822
p5 = 1535579.712543114
p50 = 2526481.443464392
p95 = 4151782.243231766
display_name = "Maximum DALYs Saved by FDA Preventing Unsafe Drugs (1962-2024)"
units = "DALYs"

# Create figure with two subplots

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---

# Handle edge case where all samples are identical (zero variance)

if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax1.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key statistics with formatted values in legend (use format_parameter_value for full units)

ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {format_parameter_value(p50, units)}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {format_parameter_value(p5, units)}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {format_parameter_value(p95, units)}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {format_parameter_value(baseline, units)}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---

sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax2.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key percentiles

ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"

exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title

fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark

add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from

output_path = get_figure_output_path('mc-distribution-type_i_error_benefit_dalys.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 2.589e+06 |
| Mean (expected value) | 2.628e+06 |
| Median (50th percentile) | 2.526e+06 |
| Standard Deviation | 7.544e+05 |
| 90% Confidence Interval | [1.536e+06, 4.152e+06] |

*The histogram shows the distribution of Maximum DALYs Saved by FDA Preventing Unsafe Drugs (1962-2024) across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
