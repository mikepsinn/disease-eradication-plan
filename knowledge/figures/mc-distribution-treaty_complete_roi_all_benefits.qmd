```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Treaty ROI - Lag Elimination (PRIMARY) (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata
)

setup_chart_style()

# Simulation results
samples = [1264026.5901440405, 943606.4754911964, 1370237.678568419, 1415538.5950078976, 794278.35713, 881129.6358753134, 1221879.7953157646, 1116062.141684642, 1187414.0969608834, 988151.2368891402, 1400963.569316249, 1376752.5258934402, 1207151.5618887213, 1460020.5238829423, 1302817.3013870644, 986662.313981073, 1279284.765786434, 962931.6266349003, 1400737.7543378084, 1179521.0145280862, 1147367.8833714304, 1029163.2557398673, 1482728.973496656, 1154595.7087512724, 1089354.0800247649, 1107509.9183033565, 1318258.0353109566, 1278496.829014803, 1289764.909896731, 1294075.07524086, 1588556.71426, 1094575.5402369197, 1069358.5417053816, 997508.9159940233, 1338195.2728317452, 1460433.0130672918, 1164265.7358554238, 991222.1038188224, 994957.2600498651, 1346443.066897209, 1368522.746305047, 1320842.2396642792, 1032837.5486072006, 1246737.7499773682, 1219221.8395304047, 1243527.4214948956, 1399064.6411263475, 1244696.6672377007, 1353191.4405480057, 1207520.5133820032, 1260309.9199967682, 1341843.1081633645, 844201.336491787, 1115245.157129992, 1079335.4899678323, 1039183.4813821587, 1125855.6751105862, 1547637.3943029072, 985104.2608575409, 1422142.2979138382, 794278.35713, 1111619.9562616404, 1230198.9068458427, 1331104.6487744898, 1360891.0994985173, 1380459.0972774676, 1108322.1024523412, 1081246.7290068832, 1395859.0377216288, 1145832.8702313502, 887442.5245607836, 921373.8837464642, 972327.2203395653, 1309882.7413999655, 1225355.2395927478, 1355948.807490382, 1089610.276691512, 1229194.929305493, 1340485.4088020057, 1117705.3572891478, 1300259.5412744298, 1033691.5009913553, 1104907.7918551704, 1100455.6915052223, 906468.6709681848, 1307455.0462967677, 1079566.699812241, 1194394.6781240446, 1305971.5356244566, 1297818.5503663172, 1349967.8330591014, 1167950.069043811, 1090552.5293351004, 1172422.000817377, 794278.35713, 846594.5005414374, 876240.0331717973, 953790.0641308773, 1286677.1405024421, 975656.8107428962, 1101307.6360498527, 1501002.2110656968, 1106525.7072032162, 1367155.3319189504, 968951.8405752699, 1142465.1539082297, 965042.9485915072, 1110631.5453332912, 1391649.1057657893, 794278.35713, 1294933.5250632095, 1248066.008790538, 1049841.4004850865, 846845.7986254217, 1208604.8077612706, 1065248.155974747, 1246860.439364414, 1196624.5415688378, 1573095.027580167, 1134383.0373272717, 947534.9636050892, 1234135.9627369624, 1243839.1171107425, 1515289.5179830447, 1390410.7722227457, 1276454.0232655548, 1540098.4806214357, 908154.9059536814, 1038975.2967738393, 970629.770746271, 1098532.2886818803, 863375.9322256038, 1342763.5308645926, 1138465.5320644164, 840948.6535187898, 949421.7904478638, 1266122.714802074, 1391129.2737192465, 1588556.71426, 1588556.71426, 1290164.46884749, 955626.9220060746, 794278.35713, 1255208.7618435996, 997707.0804070355, 1092444.7510237384, 1045564.9637064732, 1157869.3895064953, 1445423.0436279206, 1228839.6191370324, 1153617.4703709977, 944638.3272899985, 794278.35713, 1075538.3815715727, 1178602.040863129, 1588556.71426, 1222459.8055624142, 1425588.15298564, 1072443.6293760247, 909064.9792706554, 961446.128791634, 1018608.125568806, 1588556.71426, 995694.6370521565, 1391215.6838594838, 976264.881009303, 1413396.0203587199, 1283145.0019752516, 1154093.3080901506, 1181704.4980076037, 1035392.4271966215, 1297709.1843013647, 1083002.4763090909, 899375.8959347673, 886906.0885814148, 1232542.3900196438, 1567688.9383650082, 1229540.8984901065, 1163147.9792684368, 1259525.1906714952, 1502616.2110385445, 1243692.767524906, 1093500.3539530197, 1455027.8894363507, 1293583.1235600603, 1557362.859577539, 1235079.2800248768, 899646.7604335437, 865407.7633742571, 1584806.4334207994, 1588556.71426, 1148641.067955188, 1100110.3169235187, 1539655.6071387457, 927626.8080145913, 978218.8436861832, 1344711.7005699968, 1097389.643085001, 1190197.079329843, 1152471.7886176156, 1271855.9831036755, 1526797.24984336, 1213002.4250054078, 1344857.5297398653, 794278.35713, 1179808.744020884, 990489.6695638478, 900994.48511044, 982168.3099008033, 1111801.430427461, 1409662.0056851176, 875360.027068387, 1198716.5151793, 1076047.9450707727, 1113338.4415753437, 1430358.1871196576, 1319641.5692699312, 1510097.4471775182, 1154601.3805704403, 1025585.8894186297, 1138075.6717047272, 1249200.5215890608, 1233492.0548146623, 933025.7427435342, 1212979.758221532, 1245800.5826289759, 1588556.71426, 1588556.71426, 988103.7176808132, 1122938.8204116672, 842703.44300276, 1050661.796716174, 1266621.002821123, 1478752.5655765105, 1017688.8818390914, 1035545.2277731538, 794278.35713, 1152656.9296555654, 938261.7036020854, 1065260.852124548, 982476.0742005943, 1168956.3236758206, 794278.35713, 841844.8494916399, 1588556.71426, 884645.9678590796, 930071.6214813517, 1588556.71426, 1588556.71426, 912252.5305314827, 1103669.88277127, 1272804.590255898, 1588556.71426, 956265.7700021723, 1132971.8703404148, 1376644.2595499218, 1295015.1207039617, 1101785.7478106646, 1159529.7303743798, 863802.5405258904, 1134664.6606722905, 1127941.790317711, 1246739.791247219, 1059092.2183850582, 1303777.388598198, 1432731.0125002495, 1228453.781004099, 1275235.2863469808, 1204083.5783390468, 1191437.6451768004, 1019482.1568580901, 1266832.8983558842, 1168235.7438274105, 1588556.71426, 1566322.05983114, 1283358.4054556554, 1009593.5876212313, 926348.2287691338, 1475247.2560609202, 1254026.342561115, 1305827.7897848086, 794278.35713, 1412410.829736352, 1299698.407600009, 926820.2177779581, 1079060.9508727845, 1254256.9960419638, 1203919.5084156806, 1121797.9608567685, 1166757.988232502, 1131375.4822961732, 1227770.6661367125, 1542049.8037466963, 794278.35713, 1134980.0240008328, 1233477.5345132235, 1261948.0216497073, 1102796.4249016303, 794278.35713, 1269573.4498801508, 1588556.71426, 825923.660666429, 1397253.5043639205, 1113135.3933456542, 1176804.9554978975, 940529.1859030331, 1111722.145961756, 1501196.7211569676, 1330254.6702087536, 1588556.71426, 1471975.3699477597, 1296044.6494883555, 1588556.71426, 1296022.3651691894, 1388713.4623318296, 1120749.5687711923, 1207274.3060833572, 1025232.9411167199, 1427219.0662386722, 910647.2159045994, 1377838.719097678, 1145988.5330729114, 1470506.400852753, 1370337.231731799, 1588556.71426, 1365549.0920279357, 816826.2702142557, 1175463.698842733, 912147.5514513738, 1067919.997176516, 1551518.3468643534, 1343331.3280753952, 1024873.941927092, 949865.406371871, 1199228.967756912, 901531.3166549192, 1031495.8766147014, 1265764.2468368164, 1466709.3394984028, 1336475.3543077405, 794278.35713, 1263943.107344756, 1208581.9481566125, 1290040.764464367, 1576533.6469108565, 794278.35713, 1050567.3384585876, 1332220.7666808108, 814549.6753217141, 1543111.8512236588, 1279190.8412471553, 1393144.5369294798, 1055371.0776488048, 1385324.0017225225, 1446016.6853343325, 1246908.527068871, 1247271.4024837578, 1255835.8708823677, 985696.5981410517, 1156263.8843637404, 1155073.93174453, 1282773.9703087248, 1429659.1637713944, 939185.8456480086, 1161629.9455264055, 1544423.959261708, 1014232.724666265, 995488.9178299591, 1239623.7646004723, 1392620.6002600745, 1194140.176286759, 1508086.926033842, 1395577.4107565433, 1392009.3736135517, 1323454.3589940972, 1588556.71426, 1142530.8889414386, 794278.35713, 1573684.8913003418, 1082355.310071083, 1217123.6663247717, 1503461.8656598458, 809625.5129045546, 893170.6478170302, 809859.4129340166, 1002187.955361388, 1296175.688043416, 1316322.853280054, 1257249.116077357, 854778.7261147978, 794278.35713, 1204369.0986473993, 1079001.0878155304, 1300881.5885093906, 1358681.507599943, 1224358.1889578605, 1372544.7131707473, 1246034.825795288, 1317723.212756319, 1023505.519231282, 1148619.0980850458, 1238306.0341275427, 1386935.9385248793, 1097595.508272308, 1315603.097196856, 1128072.5360238086, 1163409.175827334, 1389078.2422670794, 794278.35713, 882489.5624526817, 838237.2009621122, 794278.35713, 1029798.3061271542, 1369995.2736909837, 1123534.3612293405, 1238547.6500974149, 1450960.10084841, 1507783.24367156, 1174943.1061321083, 1513954.7286754593, 1213369.7989676762, 991879.350049423, 1049781.7351284286, 838630.1030336638, 979789.8862184697, 1106108.0636463354, 1382898.5923968945, 1588556.71426, 862066.4767082613, 1285021.8425325078, 943473.0765403125, 1304530.022762684, 1160181.7488300235, 794278.35713, 1412615.3985125213, 1047255.8440253407, 1064197.9144330013, 936513.1793624908, 1035512.6218634925, 1293376.7705750372, 1146323.7304304645, 1269732.2702621957, 1277657.5443594137, 1506109.4267182497, 1109737.2494683573, 839506.6755513521, 1445719.036013131, 1112429.3714725696, 1457006.5324195288, 1282769.9787809446, 1160169.6250806006, 1274525.0789338916, 1588556.71426, 1588556.71426, 1207949.9159037236, 1229588.31208127, 1447867.81493992, 989910.4589564076, 1270782.7122065716, 1185254.8455799525, 1266216.6852408368, 992839.4938731348, 812649.81855519, 794278.35713, 925163.3304304356, 1082122.7801616755, 1121554.816164685, 1588556.71426, 1454957.5147489922, 962167.0903058414, 1274270.7252068883, 1094417.5058574858, 1123658.3230632995, 1235577.5814005102, 1338955.8009670686, 1110577.834328457, 1444915.8099901434, 919312.4902336994, 1192928.029706654, 1588556.71426, 1244573.759139416, 1532928.9148116102, 1213225.2847240982, 1329807.1388361852, 1177887.036988554, 1150812.2196121195, 1005679.7364501536, 1293951.2526340834, 988510.2677965291, 1350015.520103704, 1450023.529366751, 1278755.92488808, 1123209.1835492528, 1299590.046053064, 1117865.8374600895, 1414342.9858446456, 794278.35713, 1111447.8349979997, 794278.35713, 835169.1976823165, 1516403.411069475, 1404725.352737376, 1019977.2623907143, 833395.7427011068, 794278.35713, 1061911.5199505195, 1588556.71426, 1295043.2850989467, 1058080.68887734, 1302238.479115674, 819466.904845567, 1120570.2820770466, 1215121.3768465156, 1170901.1704121265, 1379853.5918383033, 1273540.8089212407, 1350668.6032020163, 1027389.7740677771, 1405352.139974499, 1579566.3444831423, 960246.9057032452, 979894.3015792804, 1509712.9121347268, 1145823.419475343, 1525925.0203933725, 1085968.5742310763, 1538130.8986558726, 1222748.4372624392, 1252949.205360709, 1564264.0335821027, 1105213.5975502525, 967163.6620319947, 1084532.0830289759, 1299201.2558522865, 818322.9726411204, 1343316.3380777733, 1063037.216587144, 1464922.3620331408, 794278.35713, 1003991.8842076728, 794278.35713, 994540.680748213, 1250432.2352099798, 1148710.7868101445, 1131041.8399357132, 1153486.4062590885, 1239881.598980751, 951100.0305447106, 1359848.1471483684, 1349319.9071801216, 1283165.7258612635, 1324030.2762739128, 1262049.0565068184, 1588556.71426, 1170664.431165244, 1118244.6694467058, 1011864.3411214794, 945446.3662610428, 894880.4336098752, 979631.7947626165, 1174575.5664690216, 1271074.551332918, 1203603.844769117, 1009003.1049504207, 1405916.6706820684, 1367607.3804738896, 1153375.9770936766, 1035838.3868766178, 1322098.8640832745, 1236208.5413706885, 846352.693537994, 1175218.961882829, 1253856.3479920994, 977035.1066160244, 1236654.085147473, 844757.3316430979, 1509808.6457962827, 1488783.4348690242, 1131246.8196638983, 1278022.7100001771, 794278.35713, 915878.9597349996, 1121414.8642776425, 935945.9192298753, 1361646.4350639991, 1588556.71426, 911049.6537980156, 991863.8186690147, 1247520.9986460453, 1575319.9419677674, 900145.8974663677, 1250758.736322595, 1588556.71426, 797830.572917917, 886159.8721999981, 1090479.0678602613, 1067369.902903887, 1385047.020446606, 1249001.0612681373, 794278.35713, 1314231.3341141304, 1053799.5441067398, 1495097.2882112965, 1041873.7764760858, 1039722.613339112, 1320360.2737412802, 1373210.3335954656, 1298192.2236804739, 794278.35713, 1319622.2690026716, 944958.9856799182, 1247479.9527102783, 852165.101193548, 1297768.7423253716, 999218.3199221647, 885786.8528529182, 1361509.1012824657, 1248997.4398010622, 1045116.9901571153, 1537209.5213256765, 1086417.3312540685, 1199068.26485487, 1255495.1751246972, 1043761.3636562695, 1303681.5440268042, 1064304.6395210582, 1093330.912604508, 1516112.8028844853, 943463.0416224098, 794278.35713, 1575277.252646396, 1588556.71426, 1094848.5537880869, 794278.35713, 1117434.3249365687, 1123215.3273832954, 1146161.8167669068, 926115.528259238, 1329517.3973257807, 1316398.9925984403, 835325.3235162245, 1358024.5851033842, 1588556.71426, 1232392.846796891, 1111038.5130310848, 1157580.5117409646, 1338023.0759192712, 794278.35713, 1230589.1289414773, 1098376.4164056564, 1588556.71426, 1149915.0458359672, 1588556.71426, 928414.3312554562, 1331351.7095602963, 1267525.3507322958, 984337.9096042839, 1233688.1040435222, 1480340.7766073348, 1114263.3128150748, 794278.35713, 1187232.6038066805, 976384.9957446099, 1109843.336192913, 1171976.5157947806, 794278.35713, 806432.8002632963, 1306286.1119394219, 1066862.2915245632, 794278.35713, 1378432.9252951161, 1256318.756220337, 1021312.9389653502, 877638.6146974526, 1390576.77252325, 1274662.0272598923, 1588556.71426, 1291541.5486590003, 1283800.79992372, 1151641.3630692773, 1386041.7538781026, 1340365.0297090977, 1489682.9607095094, 1067194.8822901682, 1087667.1160073834, 1077255.1518486775, 1379852.5432690873, 1548455.4523363416, 1082083.4137699963, 1090200.9620959554, 1266256.9581111767, 1132856.6235521846, 1418276.21914967, 794278.35713, 994427.3577461309, 1004980.6275958277, 794278.35713, 961798.3875568312, 973350.9268315277, 1143497.6133142763, 1456618.951685892, 1133023.6242675122, 945791.6272217893, 1177846.2078671474, 1441418.3058097702, 958862.6461679142, 974442.5588415095, 1324510.5406197004, 1138629.1330807135, 1345702.4586160642, 1188165.730284821, 1358612.410593727, 944775.4925185743, 1188537.9627226219, 1141213.5801533808, 901690.7820009881, 818866.5269423624, 1354820.2208374324, 1107791.3712213135, 947825.0049050297, 1168499.6812920077, 1460205.825143119, 794278.35713, 834793.2197449172, 971508.9176291627, 1539592.3606145096, 1258753.3530568385, 1374256.5788403205, 919735.993182776, 924650.600967609, 1298124.1586606381, 1205303.347646477, 1322172.9459572565, 1146698.633788317, 1257694.5983233193, 1229094.7057917987, 1376746.6769044993, 1383714.2994069476, 805428.7557550826, 794278.35713, 1430116.9423077533, 1474432.83643445, 948219.903138566, 794278.35713, 1215015.900173479, 1413220.9328488505, 1588556.71426, 1314442.7319026846, 1102843.577570437, 978599.2388505238, 1194146.189635555, 1120107.692490307, 949543.595133698, 1588556.71426, 1588556.71426, 1462119.2002932315, 971994.0733546978, 1395154.5389601735, 1343829.9598088863, 1296868.8590993597, 1489192.1582759863, 1342815.9999508997, 1367750.7232543856, 1343181.798615796, 1272622.5075965798, 794278.35713, 1211343.0592911295, 1058886.1650979202, 886452.5437283997, 1588556.71426, 1588556.71426, 1515297.3873090153, 1252230.6837323452, 1513249.226345635, 1194289.6098409828, 1239740.7820724417, 930861.34258523, 1286014.0160346702, 1205806.5065018148, 881017.0207136415, 1179218.1083359537, 1172419.2955965367, 1588556.71426, 1404493.823743614, 1194144.7950624605, 1250699.448406079, 1201952.6162086239, 1143066.4797503673, 933492.9868786804, 1155424.36453889, 1013634.6264295455, 893487.9640500039, 1313233.26259135, 1284649.4510834392, 794278.35713, 1162183.8100005842, 1428676.7539903964, 1443813.0830440999, 1435857.536370094, 1200689.9111095052, 990057.1712550842, 933189.9784296997, 1273531.2009762162, 1281793.7124713317, 1498167.3078174025, 1453524.5445600427, 1159909.6276724744, 894943.7952770704, 1115379.6966080517, 1243180.1466544473, 1143264.4312495817, 1053714.900867292, 1251675.8163082246, 1071332.7176218305, 1041759.7465498612, 1265631.6093612055, 1095629.3338579575, 1249583.5856087843, 1256517.5484246872, 919910.3971790121, 1076745.7129208357, 1534016.067421874, 914513.1538262939, 794278.35713, 794278.35713, 1198353.9558579174, 1198784.613135823, 1163392.8085866843, 1480738.946464586, 794278.35713, 1285762.0478895092, 1563482.5066015692, 922685.9797526984, 1100915.9080314739, 1012015.8091611585, 978309.6232397488, 1113674.680891908, 1531563.735480654, 1588556.71426, 1111368.758966876, 1588556.71426, 1199894.8234025466, 1588556.71426, 1169186.0062442333, 1222646.4541232882, 1278504.0748061112, 1588556.71426, 1394264.848045856, 1022888.063023149, 1422313.746634553, 1105198.809761541, 1074718.144491333, 1407922.254321357, 1198824.7185705875, 1257797.5816093276, 1194749.9834091787, 1271619.7435463532, 1292679.9001505582, 794278.35713, 1350250.808934282, 957418.5042592299, 847741.4393303555, 1177499.0996520016, 1211428.8236978203, 1026166.4545782005, 1389438.7212843632, 871599.3298572695, 1094449.5520291827, 1052051.6755882758, 1180316.5575305095, 1257866.2954565524, 951253.2688380304, 1364002.1522392952, 1206429.9609798554, 794278.35713, 794278.35713, 1188482.051370331, 1138764.6682497698, 1166774.2283237225, 1184749.777814615, 1245164.7253231958, 1417226.808268558, 926659.5631050331, 912156.0342713182, 930896.492398853, 1260261.6124188707, 1488067.9632823798, 1088636.4615839233, 794278.35713, 794278.35713, 992918.6238115873, 1058519.9403499074, 1094105.2613170622, 1200610.780988254, 1117133.5266489123, 1441457.8582751553, 1030333.7612105862, 985941.3880422217, 1305525.678496733, 825499.3575628109, 1284274.641941628, 1215854.2679815653, 1156284.4220959926, 1569877.5368116044, 1043155.7634621772, 1588556.71426, 1137700.939353501, 887125.5785133163, 1208078.2186721363, 934966.0548215283, 1012286.5157657467, 1286024.022873662, 1323803.5842821626, 1043165.2340498093, 1426699.8966237493, 1467232.5438168768, 1533664.5555588072, 1317568.0190713243, 1516300.1109447903, 794278.35713, 1115665.648345355, 984824.4825103064, 1219827.0920261026, 1055250.6115929584, 1151824.8623765702, 1588556.71426, 1150976.107373035, 1290017.4202622578, 1136071.5851598277, 1209458.7634863795, 1192851.2114106417, 1298245.766469901, 1469091.1021606862, 1583964.3550836586, 1265194.8946929807, 1331896.8353224397, 917185.5042044593, 1170477.9573162552, 1415473.0071133152, 1397763.5799294238, 1241840.6449701514, 1402630.5970876764, 1308359.1483011122, 1477430.7205539215, 1260367.050437525, 1106660.493577299, 1271442.968238971, 794278.35713, 1282652.8917943283, 794278.35713, 794278.35713, 1299066.542342497, 1305204.9009406946, 914429.9291639478, 1021735.3637152434, 1517994.8491397274, 1076081.1383829112, 1588556.71426, 1190960.0663469483, 1288645.8269618577, 1576692.0379725092, 1222639.1364718773, 952575.4966163299, 1165271.2936758592, 1182932.0845838236, 866222.1084697377, 1130456.9724972737, 1014565.4005664525, 1411676.743928762, 1199664.9744645164, 1124031.9727841162, 1166116.1328714627, 1244583.8327607538, 1338394.1864502162, 953202.5997179139, 943224.3816013951, 1454644.3734046738, 1093164.459663331, 853807.432808857, 1297170.784599668, 1301830.9181787868, 826673.3357646954, 1246099.2436799423, 1366694.854750984, 1280627.6524328943, 1342008.3000925744, 856803.3700350159, 1270298.9448313315, 1119308.2380788215, 1076376.6034618972, 1398856.579467062, 1543904.2541197836, 1588556.71426, 1504714.5665313907, 1165269.6900431318, 1275464.933179557, 1374138.7789381496, 1220292.2424419879, 1222576.4849987463, 1387704.3209751917]  # Truncate for embedding
baseline = 1191417.535695
mean = 1189216.036940636
std = 218667.79109438573
p5 = 794278.35713
p50 = 1188279.9367991947
p95 = 1582855.3830886346
display_name = "Treaty ROI - Lag Elimination (PRIMARY)"
units = "ratio"

# Create figure with two subplots
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
n, bins, patches = ax1.hist(samples, bins=50, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Mark key statistics
ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {p50:,.2g}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {p5:,.2g}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {p95:,.2g}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {baseline:,.2g}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---
sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Mark key percentiles
ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"
exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title
fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark
add_watermark(fig)

# Save PNG
project_root = Path.cwd()
while project_root.name != 'decentralized-institutes-of-health' and project_root.parent != project_root:
    project_root = project_root.parent

output_path = project_root / 'knowledge' / 'figures' / 'mc-distribution-treaty_complete_roi_all_benefits.png'
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 1.191e+06 |
| Mean (expected value) | 1.189e+06 |
| Median (50th percentile) | 1.188e+06 |
| Standard Deviation | 2.187e+05 |
| 90% Confidence Interval | [7.943e+05, 1.583e+06] |

*The histogram shows the distribution of Treaty ROI - Lag Elimination (PRIMARY) across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
