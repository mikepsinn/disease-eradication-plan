```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Ratio of Military Spending to Medical Research Spending (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Simulation results

samples = [40.25003699050127, 40.492108291521845, 40.21371716844378, 40.19823609093949, 44.426265315588424, 41.5872020290367, 40.26445854964818, 40.30068943093835, 40.27625567372064, 40.34452833999053, 40.20321629127503, 40.211490425812705, 40.269499394054904, 39.700089564249375, 40.23676836246852, 40.34503891927349, 40.24481730521366, 40.35317748439486, 40.20329345577512, 40.278957851275486, 40.2899672710191, 40.33046709794015, 39.316886651871144, 40.287492159265334, 40.30983914933939, 40.30361904818088, 40.23148797100689, 40.245086834753266, 40.241232533876904, 40.239758318842064, 36.91358024691358, 40.30805020434405, 40.3166906335047, 40.341319566167485, 40.224670899220776, 39.693095653182056, 40.284180972602265, 40.34347530316577, 40.3421945106791, 40.22185109684509, 40.21430334432069, 40.23060429764001, 40.32920758154063, 40.255952166074174, 40.265368207573935, 40.25705063831664, 40.203865189268676, 40.25665055616267, 40.21954407181694, 40.269373110031744, 40.25130853261743, 40.2234237323131, 42.24835641150274, 40.30096928487235, 40.31327188016012, 40.32703234229675, 40.29733485678459, 38.24183779882451, 40.34557321150816, 40.19597984768282, 43.23013705099075, 40.302211102568656, 40.261611552434104, 40.227095239811774, 40.21691199834854, 40.2102235930568, 40.30334082030382, 40.312616998068826, 40.20496062550199, 40.29049294372942, 41.47521782620564, 40.8784561178319, 40.34995501937977, 40.234352051349816, 40.263269145729545, 40.2186014658057, 40.309751370940646, 40.26195512667165, 40.223887914788314, 40.300126561615244, 40.23764312709053, 40.3289148595469, 40.30451046501492, 40.30603567766632, 41.13953404213935, 40.23518228287694, 40.31319265602107, 40.273866039809434, 40.23568962739591, 40.23847797389293, 40.220646090190534, 40.28291946398078, 40.309428536892874, 40.28138833618779, 43.24978522524381, 42.205193110097056, 41.67414633993921, 40.35631306976601, 40.242288683425706, 40.34881311087598, 40.305743811720774, 39.01121496619147, 40.30395620947094, 40.21477074227206, 40.35111266468217, 40.29164625858241, 40.35245332879819, 40.30254969077186, 40.20639931169042, 43.42615497768984, 40.23946470787012, 40.255497686944715, 40.323379317682864, 42.200663236615135, 40.26900198208376, 40.31809920413355, 40.25591018626506, 40.273102729619765, 37.82826490680741, 40.29441421104162, 40.42422141424693, 40.26026426873733, 40.25694398468233, 38.77387564081069, 40.20682250489991, 40.245785625744034, 38.36517703372072, 41.10991470139628, 40.32710370131262, 40.350537185142564, 40.30669462009259, 41.90375810641358, 40.22310905296382, 40.29301601994763, 42.30709284641816, 40.39165626810015, 40.24931988491048, 40.20657696069436, 36.91358024691358, 36.91358024691358, 40.24109586960656, 40.35568300204159, 45.25230301934647, 40.253053799281666, 40.34125161780638, 40.308780232818016, 40.324845035802085, 40.28637116316021, 39.94839046617523, 40.26207671915803, 40.28782714038054, 40.474266176841205, 43.19413148894664, 40.314572983037856, 40.27927247145458, 37.1939558924822, 40.26426004986096, 40.194802575577036, 40.315633450242245, 41.09393778869724, 40.35368699835926, 40.33408552575873, 36.91358024691358, 40.34194166744735, 40.20654743057247, 40.34860457201555, 40.19896815738213, 40.2434968602642, 40.287664197489086, 40.27821032288366, 40.32833181403625, 40.23851537874322, 40.31201540427379, 41.264355105324476, 41.48472191838779, 40.26080959326876, 37.915714027324256, 40.26183673116338, 40.28456369812577, 40.251577008278566, 38.98433073496637, 40.25699406143487, 40.30841857164946, 39.78483936964703, 40.23992657939312, 38.08331134680886, 40.25994146670498, 41.2595813919623, 41.86740793506484, 37.639511848686084, 37.36189500125168, 40.28953126797398, 40.30615399944265, 38.37243495530088, 40.769424578857496, 40.347934464076076, 40.222443009742165, 40.30708608643749, 40.27530296970885, 40.288219463175345, 40.24735854070347, 38.58376064871105, 40.26749681828939, 40.222393153887566, 44.87678763266637, 40.278859344600214, 40.343726461094604, 41.235837313721106, 40.34658003581576, 40.30214893742612, 40.20024401262979, 41.689813429628636, 40.27238663400028, 40.31439837548678, 40.30162242821823, 40.193172956240446, 40.23101486664553, 38.85995832053497, 40.28749021705527, 40.33169342653535, 40.29314953897538, 40.25510950431982, 40.26048461473405, 40.675517934714655, 40.267504576260556, 40.256272831818976, 36.91358024691358, 36.91358024691358, 40.34454463510867, 40.2983339363813, 42.27539499882518, 40.32309813883318, 40.24914941738443, 39.38372000039682, 40.334400669128144, 40.32827943728525, 45.2962962962963, 40.28815606394107, 40.58465259495154, 40.31809485326815, 40.34647449316747, 40.28257493119175, 43.56075938485437, 42.2909013359889, 36.91358024691358, 41.524788636611845, 40.7268737633642, 36.933734538910706, 36.91358024691358, 41.03802725481094, 40.30493454548411, 40.247034032550225, 37.342765659455104, 40.35546387062514, 40.29489752511975, 40.2115274297066, 40.23943680026383, 40.30558001731261, 40.28580262983106, 41.89612331776572, 40.29431775785842, 40.29662033685082, 40.25595146762609, 40.32020884828423, 40.236440013548744, 40.16554176376177, 40.26220875918912, 40.24620252988869, 40.27054951303082, 40.2748782915423, 40.33378588480665, 40.24907692678233, 40.282821651132885, 36.91358024691358, 37.93785671098675, 40.243423864039194, 40.33717607673062, 40.79169534385786, 39.442729586952126, 40.25345835291483, 40.23573878724992, 43.50253188529097, 40.19930477789694, 40.2378350396903, 40.78347264896466, 40.31336595128521, 40.25337943667727, 40.27060567216726, 40.29872470975793, 40.2833276258425, 40.29544428300504, 40.26244253317472, 38.33321460751383, 45.2962962962963, 40.29420974934168, 40.26048958361104, 40.250748102565986, 40.30523377565514, 43.556296843574074, 40.24813938112935, 37.34788708476298, 42.579473379077164, 40.20448409710756, 40.30169198279271, 40.27988772939667, 40.54536551416266, 40.30217609681793, 39.007974049375726, 40.22738586403085, 37.32903288245682, 39.497889420948376, 40.239084679144675, 37.284900897411056, 40.23909230083137, 40.207402557815314, 40.2990838140186, 40.2694573813588, 40.331814419966186, 40.194245388111334, 41.066175404299536, 40.211119182334144, 40.29043963592029, 39.5226794543384, 40.21368314073669, 36.99493411974194, 40.215319780463936, 42.745247020414524, 40.280346933968666, 41.03986740506508, 40.31718359662208, 38.1784987560247, 40.222914932451154, 40.33193748806112, 40.384003616256386, 40.272211220227135, 41.22638327523227, 40.32966749074929, 40.24944251954597, 39.586830025331395, 40.22525893958029, 45.2962962962963, 40.250065551081605, 40.26900980634245, 40.241138181133735, 37.77274663436293, 44.93650592132936, 40.32313051292426, 40.22671362055999, 42.78683224658932, 38.31582959598938, 40.2448494338869, 40.20588826281744, 40.32148413936761, 40.20856092554856, 39.93826248365125, 40.25589373242796, 40.25576957007461, 40.2528392414739, 40.345370084602415, 40.286920927290204, 40.287328400938904, 40.24362377468127, 40.1934117642289, 40.56863603796985, 40.28508348639927, 38.29436214653098, 40.33558556192121, 40.34201220747669, 40.25838638586071, 40.20606731227518, 40.273953159896195, 38.893343350694224, 40.20505686602678, 40.20627619310748, 40.22971109842148, 36.91358024691358, 40.29162374651573, 44.66422381164183, 37.818735459566305, 40.31223714994207, 40.266086300205714, 38.970252150556824, 42.87691747932117, 41.373867728384816, 42.87263410085613, 40.3397152064484, 40.239039861344885, 40.23214972272312, 40.25235572083716, 42.05791475098776, 45.2962962962963, 40.270451783093705, 40.313386463457284, 40.23743038259265, 40.217667313948304, 40.263610363526915, 40.21292862131294, 40.256192681796804, 40.231670856973935, 40.3324065988984, 40.28953879153295, 40.25883729493117, 40.20801003267786, 40.30701555747088, 40.232395852125855, 40.29657555527168, 40.284474262773855, 40.20727789415519, 44.61669156644315, 41.56305279564349, 42.356118231389445, 45.2962962962963, 40.330249405247166, 40.21380002361275, 40.29812995002923, 40.258754616923206, 39.85402368232859, 38.898388538343944, 40.280525170134965, 38.79598774382716, 40.26737108047312, 40.34324992918056, 40.3233997671907, 42.349010707295214, 40.3473956859738, 40.30409928251635, 40.20938984367366, 37.37290844647343, 41.9272014466699, 40.242854877730096, 40.49441551406913, 40.236182615248346, 40.28557936809745, 43.88640045975051, 40.199234880484475, 40.32426549229844, 40.318459114840536, 40.61497404625982, 40.32829061388392, 40.23999715780842, 40.290324845522676, 40.24808504917358, 40.245373930849645, 38.926208026610354, 40.30285604154588, 42.33315797476438, 39.94334028820979, 40.30193383292271, 39.75123034918937, 40.24362514001806, 40.28558351945529, 40.24644547882761, 36.91358024691358, 36.91358024691358, 40.269226135443134, 40.261820505594464, 39.906697277827426, 40.34392507843986, 40.247725698118295, 40.27699487016096, 40.24928773696573, 40.34292069191388, 42.82156678458085, 44.98109740508032, 40.812345201375095, 40.31231682451396, 40.29880799348107, 36.91358024691358, 39.786035269810974, 40.35343971348128, 40.246532488932345, 40.30810434795842, 40.29808749039545, 40.259770949623025, 40.22441087729665, 40.30256808999497, 39.95704629560469, 40.91446427594176, 40.27436809982195, 36.91358024691358, 40.256692611580334, 38.482842633179494, 40.267420542030116, 40.2275388845634, 40.27951726215727, 40.28878776629354, 40.33851797813744, 40.239800669398676, 40.34440522259977, 40.220629787737884, 39.86996977500001, 40.244998205626025, 40.29824133069461, 40.237872100387754, 40.30007159093902, 40.1986446003116, 43.888634976805186, 40.30227006390301, 44.60648299680832, 42.411658869767734, 38.755432549175566, 40.20193085299203, 40.33361615057436, 42.44379726854184, 45.2962962962963, 40.319242657950106, 36.91358024691358, 40.23942716739033, 40.32055551071888, 40.23696632043352, 42.69706271934491, 40.2991452251573, 40.26677158890055, 40.281909041023006, 40.21043054010706, 40.24678218198344, 40.22040652322833, 40.33107504647513, 40.20171667764129, 37.723849801377696, 40.35409832704912, 40.347359877707525, 38.86634137029821, 40.29049618020804, 38.598137722858276, 40.31099911320746, 38.39743276218132, 40.26416127036563, 40.25382688881334, 37.971220003713526, 40.30440570338608, 40.351725965128765, 40.31149130319048, 40.23800507067902, 42.717929656090256, 40.222920057272255, 40.31885688191689, 39.61705666464359, 45.2962962962963, 40.33909668824157, 43.2459721729816, 40.34233735453411, 40.25468806789438, 40.2895073928344, 40.29555855540161, 40.28787202127069, 40.258298159106694, 40.36271320974548, 40.21726851408104, 40.22086759295541, 40.243489771501274, 40.22951416947988, 40.25071353660858, 36.91358024691358, 40.281990096866515, 40.29994182660387, 40.33639754757994, 40.460299578017036, 41.343663790705165, 40.34744990201273, 40.28065100575749, 40.2476258619491, 40.27071372020877, 40.33737852651752, 40.20152377653744, 40.21461622627995, 40.28790983607952, 40.32817894884065, 40.23017459965414, 40.25955503824514, 42.209552357376715, 40.28043072485821, 40.25351651529182, 40.34834042321838, 40.259402576068155, 42.238324502909684, 38.86475215124818, 39.215344229278195, 40.295488349874965, 40.24524901751948, 45.2962962962963, 40.97451117496294, 40.29885593091718, 40.62481586510354, 40.21665380155334, 36.91358024691358, 41.059117104345354, 40.34325525497694, 40.25568416785412, 37.79233321260285, 41.250786052062125, 40.25457635479152, 36.992476666894426, 43.09347238597064, 41.49794633386971, 40.30945370612733, 40.31737210554467, 40.208655586973826, 40.25517775099217, 43.63723137535575, 40.23286494747264, 40.322022739742145, 39.109730747303956, 40.32611020666391, 40.32684754571652, 40.230769105289234, 40.21270111434578, 40.2383501722239, 43.242139427195106, 40.23102146640229, 40.4687231604673, 40.25569821218446, 42.104892017538035, 40.23849500899279, 40.34073343444209, 41.50455854741129, 40.21670074631637, 40.25517899010222, 40.32499857861482, 38.412546764393326, 40.310845355258024, 40.272266229142105, 40.25295580628367, 40.32546322279249, 40.23647279218113, 40.3184225407247, 40.30847662389969, 38.76024339783649, 40.49458907988738, 45.2962962962963, 37.79302231097857, 36.91358024691358, 40.307956668282905, 44.36211844348772, 40.30021940086705, 40.298239226290484, 40.29038029381215, 40.79574991555078, 40.22763795368323, 40.23212368603935, 42.40883073656149, 40.21789187571234, 36.91358024691358, 40.26086076770899, 40.302410280332325, 40.28647008140135, 40.22472977297951, 43.44096895901268, 40.26147801412354, 40.30674802115989, 36.91358024691358, 40.28909499798631, 37.57459833195016, 40.75571325995037, 40.227010765313274, 40.24884003601042, 40.34583601356683, 40.26041752634542, 39.3570125790813, 40.30130561325594, 43.27016259307385, 40.27631780542386, 40.34856337856501, 40.30281970026298, 40.28154086150839, 43.33049200750677, 42.93542798508041, 40.23558204518223, 40.31754605700932, 45.2962962962963, 40.21091609360238, 40.25267402884816, 40.333158251683685, 41.64925896446398, 40.206765775014496, 40.246398631201195, 36.91358024691358, 40.24062485979343, 40.243272540189686, 40.288503833252335, 40.20831562682003, 40.22392907133442, 39.20028022054518, 40.317432082626105, 40.31041714367782, 40.3139847157926, 40.21043089848356, 38.228477957255016, 40.312330313118636, 40.30954899035158, 40.24927395934269, 40.294936996533856, 40.19730072973647, 45.2962962962963, 40.34237621275588, 40.33875767901131, 45.2962962962963, 40.35356617581804, 40.34960392796539, 40.29129267696459, 39.757811517753474, 40.29487979968658, 40.45433336359749, 40.27953124057305, 40.01678150079444, 40.35457312770806, 40.349229544112255, 40.229349948804426, 40.292959990149356, 40.22210429210518, 40.27599836333555, 40.2176909339446, 40.47189499640019, 40.27587093575695, 40.29207488344251, 41.22357537885269, 42.70801318772586, 40.21898727053228, 40.303522631346546, 40.419213822476884, 40.28273128118663, 39.69694755843921, 45.2962962962963, 42.418470276329856, 40.3502356675025, 38.37347156722203, 40.25184107510803, 40.21234351361439, 40.9070639927435, 40.8212840522486, 40.23837345141324, 40.27013200330942, 40.23014926777966, 40.29019645794833, 40.252203306975545, 40.26198942462905, 40.21149242491308, 40.209111062296884, 42.95384487106709, 45.2962962962963, 40.19325537276669, 39.45645245990691, 40.41239686259791, 44.01580809793324, 40.26680768888493, 40.19902798118011, 37.08183053159965, 40.23279265641219, 40.305217621984625, 40.34780400954194, 40.27395110142783, 40.29930367657408, 40.389554916759444, 36.91358024691358, 37.12875719413164, 39.66451851769519, 40.350069276465746, 40.2052013746515, 40.22274445924828, 40.23880278384602, 39.208498780201516, 40.22309111460834, 40.21456723000374, 40.22296605401921, 40.24709632083776, 43.67566099281776, 40.268064759515426, 40.32027946480012, 41.49275911890101, 37.521368507666146, 37.34163424455434, 38.77374531503169, 40.25407272846544, 38.80768018013184, 40.273902006355925, 40.25834634435086, 40.713138534967186, 40.242515504046736, 40.269959780435755, 41.58920244965714, 40.27906155408494, 40.2813892624005, 37.0819564187559, 40.20200996753255, 40.27395157881317, 40.2545966402647, 40.271278921509484, 40.291440324913296, 40.667401077137974, 40.287208402347076, 40.335790614661875, 41.36826056395425, 40.23320625671776, 40.24298225524054, 43.68942708583661, 40.28489383749319, 40.193747388183056, 39.975870557455664, 40.111939918652816, 40.27171113993134, 40.34387476917325, 40.672664685547495, 40.24678546872289, 40.243959081819625, 39.05848054593407, 39.81039402231516, 40.28567254666124, 41.34254490946979, 40.3009231989198, 40.257169466511904, 40.29137253348102, 40.32205174911425, 40.25426257543375, 40.316014129037924, 40.32614929156098, 40.24948789593684, 40.30768916960032, 40.25497843674797, 40.25260601500657, 40.904016849452375, 40.31415927886667, 38.464977299164914, 40.99842140543279, 45.18146944367423, 44.024812247797215, 40.27251073940592, 40.27236332385882, 40.28447986701467, 39.35031977847542, 45.2962962962963, 40.24260168966693, 37.983897261610046, 40.85555309954658, 40.305878012761774, 40.336345617209616, 40.347903331664135, 40.30150724903604, 38.50528857252348, 36.93195602484464, 40.30229715197547, 36.91358024691358, 40.271983297349315, 37.24789595317182, 40.2824962903013, 40.264196172405164, 40.24508435617723, 36.91358024691358, 40.20550541178259, 40.3326182716837, 40.195921271625174, 40.30441076931834, 40.314854047905214, 40.20083847267791, 40.27234959565055, 40.25216807315003, 40.273744413390766, 40.24743935608468, 40.24023550763887, 44.36270039884406, 40.22054935120723, 40.3550684739596, 42.18452246310773, 40.279650078078625, 40.26803540524611, 40.331494405059736, 40.20715470071514, 41.75683297500847, 40.3080933687242, 40.32262178258385, 40.278685490850094, 40.252144563995984, 40.36007148382954, 40.215848556029165, 40.26974638340096, 44.15989303858212, 44.46044448671552, 40.27589007605189, 40.29291357235382, 40.28332206529732, 40.277167776625205, 40.25649040130615, 40.19765927829205, 40.7862712872839, 41.03971870891596, 40.71252729933978, 40.25132505980447, 39.22733008635285, 40.310085021618164, 45.2962962962963, 43.32317482085316, 40.342893558052296, 40.32040497397807, 40.30821132519882, 40.27173822597966, 40.300322436373854, 40.01610547018979, 40.330065854333014, 40.34528614047192, 40.235842106935706, 42.58719076394777, 40.24311046013639, 40.266520753681995, 40.286913894622266, 37.88028684093482, 40.32567079541609, 36.91358024691358, 40.29327787739334, 41.480832929156804, 40.26918222046609, 40.641821881124294, 40.33625280641563, 40.24251208121475, 40.2295916843407, 40.32566754931471, 40.19442275710064, 39.57798441443813, 38.47075283629858, 40.23172392659527, 38.757142553961714, 44.10981813597226, 40.30082524748691, 40.34566915468471, 40.26516106434905, 40.321525425576915, 40.28844099576408, 36.91358024691358, 40.288731644181595, 40.24114616572915, 40.293835903728855, 40.26870969593743, 40.27439439627264, 40.23833185984995, 39.54657847309838, 37.653052167569825, 40.24963730004193, 40.22682437769932, 40.951651444097884, 40.28205394273296, 40.19825850055442, 40.204309791379764, 40.25762781157591, 40.20264664646746, 40.23487309295971, 39.40596201857655, 40.25128898692505, 40.30391003552327, 40.247499829398606, 45.2962962962963, 40.24366519066419, 45.2962962962963, 43.409111200447, 40.23805114420268, 40.235951810628805, 40.99987881362601, 40.3330134364021, 38.729097808476475, 40.31438700145858, 36.91358024691358, 40.27504177874822, 40.24161530502886, 37.77019129340742, 40.26419867675134, 40.356729688669795, 40.2838366676123, 40.277790057502635, 41.85284786910176, 40.29575887308527, 40.33547150735424, 40.19955560260262, 40.27206197466426, 40.2979595074815, 40.28354739527272, 40.2566891646914, 40.224602891184105, 40.356514580282926, 40.498717207529765, 39.79135701933027, 40.30853365237376, 42.07536664361347, 40.238699520100276, 40.237105707385204, 42.56584142381332, 40.256170640221676, 40.21492813988246, 40.244357948124005, 40.22336725537526, 42.021559852948, 40.24789119217448, 40.299577516209254, 40.314285757466806, 40.20393628832507, 38.302863623204686, 37.09400188219652, 38.949406342968715, 40.28383721669704, 40.24612397223004, 40.21238377679859, 40.265001870757125, 40.26422011819626, 40.20774743421176]  # Truncate for embedding
baseline = 40.266666666666666
mean = 40.33936358773478
std = 1.3760454985472919
p5 = 37.670891472897424
p50 = 40.27595926659385
p95 = 43.19154022453778
display_name = "Ratio of Military Spending to Medical Research Spending"
units = "ratio"

# Create figure with two subplots

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
# Handle edge case where all samples are identical (zero variance)

if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax1.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key statistics with formatted values in legend (use format_parameter_value for full units)

ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {format_parameter_value(p50, units)}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {format_parameter_value(p5, units)}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {format_parameter_value(p95, units)}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {format_parameter_value(baseline, units)}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---

sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax2.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key percentiles

ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"

exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title

fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark

add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from

output_path = get_figure_output_path('mc-distribution-military_vs_medical_research_ratio.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 40.27 |
| Mean (expected value) | 40.34 |
| Median (50th percentile) | 40.28 |
| Standard Deviation | 1.376 |
| 90% Confidence Interval | [37.67, 43.19] |

*The histogram shows the distribution of Ratio of Military Spending to Medical Research Spending across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
