```{python}
#| echo: false
#| fig-cap: "Probability of Exceeding Threshold: Ratio of Military to Government Clinical Trials Spending"

import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Monte Carlo samples

samples = [593.5939246298082, 699.6367294745922, 562.7284650342084, 550.057001105255, 815.3333333333334, 741.0930437527662, 606.3061183942327, 639.4353031808993, 616.9036393621042, 681.9070804577981, 554.1024461850081, 560.8883320570147, 610.8122994762684, 531.4274946401772, 582.1296564161381, 682.4177231223683, 589.0578051748084, 690.6082350152822, 554.1653568959163, 619.3565576810387, 629.4499252894213, 667.9907798177236, 520.4238886215786, 627.1667611873405, 648.0793108487719, 642.1905897242208, 577.6281260406025, 589.2912006510059, 585.9622492102923, 584.6938667424905, 498.3333333333333, 646.3802562130124, 654.6272278755251, 678.7064960983465, 571.8671552830439, 531.2255589590592, 624.1250877664868, 680.8550989282264, 679.5777401931797, 569.5007453902484, 563.2138543560638, 576.8781451111953, 666.7579580434164, 598.77597056978, 607.1168685425909, 599.7431821497985, 554.6316988608756, 599.3907296451092, 567.5718262639584, 610.6990088717084, 594.7041378980638, 570.8193289090452, 766.7426342671235, 639.6980011879131, 651.3518594099698, 664.6340867855051, 636.2946179989599, 498.3333333333333, 682.9524842034983, 548.2338124493425, 805.6961149933248, 640.8649720885905, 603.7755497258754, 573.9094154584378, 565.3789752353923, 559.8440896887039, 641.9284173609691, 650.7262847409779, 555.5262838655277, 629.935882468169, 736.7949346814912, 714.1163600793981, 687.3537087899563, 580.0654888723244, 605.2476447677183, 566.7855565848871, 647.9958407763858, 604.0803857280125, 571.2090982210913, 638.9072606468696, 582.8787152463663, 666.47176058952, 643.0312752529519, 644.4721966933353, 723.9912381952577, 580.7739130267169, 651.2761493022241, 614.7423934798474, 581.2072411445909, 583.5944761961598, 568.4924286319782, 622.9700784131079, 647.6889429261686, 621.5710344387703, 806.4862580809065, 765.0538181605863, 744.4393367874952, 693.7895575220878, 586.8725999810085, 686.2040611001522, 644.1962154072588, 511.73506791572305, 642.5084357429272, 563.6011832475708, 688.5211327405616, 631.0033549508619, 689.8755574950638, 641.183515855657, 556.7033381787761, 813.5975010284545, 584.441572775844, 598.376247516726, 661.082281655693, 764.8766972276698, 610.3661859878687, 655.9814271838087, 598.7390375266781, 614.0536061612714, 498.3333333333333, 633.5725468613199, 697.1088795160332, 602.5816317706312, 599.6492056831389, 505.0427100342373, 557.0500381357649, 589.8967327794755, 498.3333333333333, 722.8672724381354, 664.703655036313, 687.9405486718989, 645.0957040198249, 753.3154756383942, 570.5552445751705, 632.2734740507477, 769.0439769744994, 695.8980187364127, 592.9687017491946, 556.8488508301818, 498.3333333333333, 498.3333333333333, 585.8445525855819, 693.1491448420936, 815.3333333333334, 596.2312956410436, 678.6388810809246, 647.0730729045279, 662.5051399544957, 626.1353801548775, 538.6233891543133, 604.1883048214878, 627.4752871094304, 698.9718812716078, 804.2492446317583, 652.5964897497842, 619.6427785284814, 498.3333333333333, 606.1293431587499, 547.28486138969, 653.6126580535888, 722.2613850985013, 691.1242033982915, 671.5449975010204, 498.3333333333333, 679.3258534205554, 556.8246600580198, 685.9943131157988, 550.6498373068229, 587.9156961640837, 627.3251940290077, 618.6770264462424, 665.9020704911585, 583.6265656869494, 650.1521341425565, 728.7381193791834, 737.1591941642469, 603.064600360528, 498.3333333333333, 603.9753223137782, 624.4759188287481, 594.9388111778283, 510.9746281399932, 599.6933283612383, 646.7297555131075, 533.8777541216346, 584.8384978868223, 498.3333333333333, 602.2959201991061, 728.5562714386054, 751.9065208675295, 498.3333333333333, 498.3333333333333, 629.0471426941457, 644.5841119746685, 498.3333333333333, 710.0139345968862, 685.3207464198376, 569.9966857138977, 645.4663997452051, 616.0410956256783, 627.836815852878, 591.2619694726213, 499.7160317526574, 609.0182011373204, 569.9548971024556, 815.3333333333334, 619.2669694759203, 681.1058601819323, 727.6521356356633, 683.961311851218, 640.8065040319725, 551.6845418982681, 745.0431881929334, 613.408113587956, 652.4293250615265, 640.3115176308548, 545.9739558503023, 577.2264792992853, 507.46455833449227, 627.1649727986417, 669.1932702122924, 632.3974146897029, 598.0350412325226, 602.7767361793672, 706.4907596567674, 609.0251414618311, 599.0581601385464, 498.3333333333333, 498.3333333333333, 681.9233717941903, 637.2284067766878, 767.8015692010422, 660.8096685442458, 592.8201714879564, 522.3341068344724, 671.8554272123114, 665.8509169382157, 815.3333333333334, 627.7783790580048, 703.0906359622311, 655.9772400260654, 683.855490499277, 622.6549973102015, 815.3333333333334, 768.4092106578001, 498.3333333333333, 738.695876859901, 708.4163548329385, 498.3333333333333, 498.3333333333333, 720.1432532791918, 643.4316006335185, 590.980053352277, 498.3333333333333, 692.9265517855201, 634.0222086199524, 560.9188629018405, 584.4175979049573, 644.0413863293242, 625.6129341901466, 753.0194291978656, 633.4828470798108, 635.6276178357454, 598.7753560700628, 658.0147910802317, 581.8487363732661, 544.9591266742332, 604.3055180726421, 590.2582892545862, 611.7551718438206, 615.6569895257059, 671.2499691111589, 592.7570207002992, 622.8806109682193, 498.3333333333333, 498.3333333333333, 587.8526221627928, 674.5954216030436, 710.8508650373299, 524.0238288996638, 596.585841560966, 581.2492459638681, 815.3333333333334, 550.9226474234376, 583.0431762428096, 710.5417963867142, 651.4417691939785, 596.516664054824, 611.8056358429067, 637.5940091402609, 623.3435522301982, 634.5312749304481, 604.5130963977973, 498.3333333333333, 815.3333333333334, 633.3824158572974, 602.781136565902, 594.2145619054098, 643.7142166926102, 815.3333333333334, 591.9408656962482, 498.3333333333333, 779.7644525185851, 555.136954071005, 640.3768863259357, 620.2028757694717, 701.6232625829886, 640.8320475550885, 511.643364100363, 574.154717548172, 498.3333333333333, 525.6059619636127, 584.1151806866251, 498.3333333333333, 584.1217248995789, 557.5255898913082, 637.9301641195302, 610.774607191723, 669.3120269670418, 546.8362984533688, 721.2092092994062, 560.5821201759652, 629.8865853610547, 526.3178404748627, 562.7003006534319, 498.3333333333333, 564.0565012259158, 786.3280313512137, 620.6212348775754, 720.2129129900393, 655.1008495401014, 498.3333333333333, 570.3923951996809, 669.4328412880476, 695.6136361642536, 613.2500963811417, 727.2923088928007, 667.2078602985603, 593.0755773043933, 528.1624083037798, 572.3618621461536, 815.3333333333334, 593.6188391593801, 610.3732008445697, 585.8809892083221, 498.3333333333333, 815.3333333333334, 660.8410507711394, 573.5874652509779, 787.9791720758552, 498.3333333333333, 589.0856217955455, 556.2849454482401, 659.2469740057327, 558.4764630993712, 538.3288589424673, 598.7245623625122, 598.6153423725465, 596.0433438387987, 682.7491305308736, 626.6409863196654, 627.0159899822041, 588.0253752105297, 546.1658656054651, 702.4922186306109, 624.9527009757078, 498.3333333333333, 673.0238602045755, 679.3961173773337, 600.921385695964, 556.4314970027237, 614.8210562067268, 508.4054847971687, 555.6049461799029, 556.6025134350206, 576.1210523620388, 498.3333333333333, 630.982501472508, 815.3333333333334, 498.3333333333333, 650.3637063543827, 607.7576351120729, 510.5766472823775, 791.5623773377199, 732.9165361051008, 791.3918053822873, 677.1117736343879, 584.0767002128767, 578.1903878248986, 595.6199951595356, 759.3064085441498, 815.3333333333334, 611.6673625246076, 651.461375607421, 582.696455492618, 566.0073953798044, 605.5511151446116, 562.0761486601849, 598.9876149379725, 577.7834625572003, 669.8935578364153, 629.054090860526, 601.319626029966, 558.0240511723409, 645.3995974777608, 578.3996505700102, 635.5858373921213, 624.3939192240666, 557.4233517250065, 815.3333333333334, 740.1650284380894, 770.9676656871246, 815.3333333333334, 667.7775409085224, 562.797049195036, 637.0376417433145, 601.2465858618285, 535.8824722638391, 508.54776011395376, 620.7836919700305, 505.6642183097403, 608.905726224534, 680.6301581598583, 661.1021125088688, 770.6886164243542, 684.7796589882389, 642.6433591634161, 559.1578783644293, 498.3333333333333, 754.2249043464789, 587.3612049369618, 699.7227279415573, 581.6286115669407, 625.4078880707632, 815.3333333333334, 550.8659889633446, 661.9421836795009, 656.3278867242219, 704.2242673414377, 665.8618321963227, 584.8991752030682, 629.7804442867748, 591.8936023628909, 589.5399076435024, 509.3326588772072, 641.4718647788661, 770.0664158174259, 538.4765149483978, 640.6042326891205, 532.9053373266319, 588.0265552398173, 625.4117001222412, 590.4690850577023, 498.3333333333333, 498.3333333333333, 610.567182574151, 603.9609252477791, 537.4114706769573, 681.304228123062, 591.5810965112975, 617.5736989355079, 592.940688086598, 680.3016850734019, 789.3597304427122, 815.3333333333334, 711.627354705567, 650.439742069134, 637.6719549355993, 498.3333333333333, 533.9123728720689, 690.8737386526609, 590.5445977866685, 646.4316149148452, 636.9979411788466, 602.1450495582902, 571.6485379760148, 641.2008303023094, 538.875176412106, 715.4739899695259, 615.1958508191445, 498.3333333333333, 599.4277687997387, 498.3333333333333, 608.949968108891, 574.2839163269773, 619.8655630303625, 628.3608751283954, 675.9241376394145, 584.7302665532692, 681.7840040058309, 568.4787992233107, 536.3451055580636, 589.2144434210605, 637.1417963422887, 583.0749409510148, 638.8557141911573, 550.3877394832213, 815.3333333333334, 640.9204317199705, 815.3333333333334, 773.1501190102493, 504.52464083122874, 553.0554855191284, 671.0829042421366, 774.4144997527433, 815.3333333333334, 657.0827682239471, 498.3333333333333, 584.4093227189708, 658.3495111663403, 582.2990844525825, 784.4171977993124, 637.9876680986249, 608.3697501204118, 622.0464733516143, 560.0145441526679, 590.7613495156489, 568.2921747703484, 668.5866448891875, 552.8812336079953, 498.3333333333333, 691.5410191653456, 684.7437121272106, 507.64438644540786, 629.9388755669987, 500.1177925490021, 649.1833348136454, 498.3333333333333, 606.0413933391084, 596.9090023746064, 498.3333333333333, 642.9324196231372, 689.1404034152226, 649.6523471802554, 583.1889237349086, 785.2444068742184, 570.396693869161, 656.7109970740229, 529.0327366858302, 815.3333333333334, 676.497955136686, 806.3328852922742, 679.7200842827797, 597.6648219446885, 629.0250939958213, 634.637720543986, 627.5166348564624, 600.8434946625626, 694.822784791616, 565.6755096578114, 568.6776443654506, 587.9095706701451, 575.9542630916065, 594.1843790294514, 498.3333333333333, 622.1205149978791, 638.7340493215918, 673.8257195775991, 698.4516824576377, 731.7628353207695, 684.8340883994606, 620.8984126638645, 591.4943038368083, 611.9027381685448, 674.7957175396109, 552.7243365078889, 563.4731081314486, 627.5514748620295, 665.7527860997628, 576.5138028688998, 601.954068114115, 765.2242882727402, 620.6976026350379, 596.6368314039688, 685.7287232429911, 601.819245661685, 766.349945584451, 507.599610567628, 517.5288060435967, 634.5723214783751, 589.431684441866, 815.3333333333334, 717.741038981959, 637.7168241516307, 704.592435099361, 565.164313687542, 498.3333333333333, 720.941835640263, 680.6354728759276, 598.5402292830707, 498.3333333333333, 728.2212890020858, 597.5667231113289, 498.3333333333333, 800.2116959719393, 737.6662016570574, 647.7128645839459, 655.2820513240947, 558.5542385707587, 598.0950150989188, 815.3333333333334, 578.7986883599486, 659.7680493277954, 514.5268426717552, 663.7357359301353, 664.4539609715024, 577.0179460745923, 561.8880844049597, 583.4848486762197, 806.1787361381589, 577.2320803409352, 698.7654016656907, 598.5525809369954, 761.1371303678885, 583.6090903339395, 678.1234576102405, 737.9197757504327, 565.2033370088664, 598.0961040597165, 662.6543670402922, 498.3333333333333, 649.0368856968246, 613.2996455091544, 596.1454469298824, 663.1061524968889, 581.8767742553923, 656.2926713056501, 646.7848512336855, 504.65975079360885, 699.7291975920043, 815.3333333333334, 498.3333333333333, 498.3333333333333, 646.2915406918379, 815.3333333333334, 638.9943260619448, 637.1398283108681, 629.831712416432, 711.0032918589607, 574.367577920441, 578.1682554169438, 773.038908363627, 566.1943624346036, 498.3333333333333, 603.1099427105373, 641.0523396736735, 626.2263235211137, 571.9166656836389, 814.1963267210748, 603.6571087695816, 645.1462593756238, 498.3333333333333, 628.644367112665, 498.3333333333333, 709.4989292934139, 573.8381338774989, 592.5506974602315, 683.2156680044633, 602.7173264813221, 521.5703099644998, 640.0138519614435, 807.3061642840303, 616.9599323786747, 685.9528882778797, 641.437652327046, 621.7102634175618, 809.7362062383258, 793.8943471256952, 581.1153275350584, 655.4493036503156, 815.3333333333334, 560.4146765281356, 595.898657918226, 670.6324104598609, 743.4806509457696, 557.0035500046826, 590.4284317330277, 498.3333333333333, 585.4390923163111, 587.7218886357335, 628.098993263633, 558.2749709401492, 571.2436695800754, 517.1000530003894, 655.3397138561843, 648.6292001700775, 652.0334661020524, 560.0148393780235, 498.3333333333333, 650.4526154940048, 647.803433673531, 592.9286826884619, 634.0589455626146, 549.3004473209182, 815.3333333333334, 679.7588116231333, 676.1617539292732, 815.3333333333334, 691.0018160341504, 687.0000364389249, 630.675901878465, 533.0956767732391, 634.0057118371207, 698.2295286452897, 619.8782871905667, 540.6145199838097, 692.022460891584, 686.6230975215901, 575.815212436236, 632.2214708319374, 569.7128357085289, 616.6705628926387, 566.0270582090219, 698.8835498341895, 616.5551687075803, 631.4005299349751, 727.1854569521464, 784.8512389808442, 567.1072439676456, 642.0997248366691, 696.9226101514337, 622.7979626224322, 531.3367701944978, 815.3333333333334, 773.4179990893131, 687.6365487295416, 498.3333333333333, 595.169719525555, 561.5926056701578, 715.1948612240104, 711.9636203515131, 583.5048159198209, 611.3801303500018, 576.4923309573884, 629.6617513980325, 595.4866098002508, 604.110824871482, 560.8899814151686, 558.9286139129734, 794.6291241685049, 815.3333333333334, 546.040179539861, 524.4171988915508, 696.6690799258245, 815.3333333333334, 608.4020122236335, 550.6983110908047, 498.3333333333333, 578.7371760513761, 643.6989568041738, 685.1896941746215, 614.8191974540878, 638.1360619020368, 695.819923556381, 498.3333333333333, 498.3333333333333, 530.4008771010213, 687.4688443996824, 555.723081052563, 570.2494214418334, 583.873187400405, 517.3339466847667, 570.5401940171577, 563.4325021046824, 570.4352770919949, 591.0341559871014, 815.3333333333334, 609.5264901015014, 658.0829613206238, 737.4673080562898, 498.3333333333333, 498.3333333333333, 505.03904816297467, 597.1246692995524, 505.993025147991, 614.7748673011625, 600.8860337989452, 707.9010747772011, 587.0682898803511, 611.2254914905476, 741.1699446022835, 619.4508853468938, 621.5718798167181, 498.3333333333333, 553.119866337406, 614.8196285222821, 597.5845352551455, 612.4109291993517, 630.8126187986855, 706.1866740470269, 626.9055306971319, 673.2262671484049, 732.702285365883, 579.0891944864295, 587.4711821577374, 815.3333333333334, 624.7787017479299, 546.4356902507328, 539.422968577247, 543.3915120963502, 612.7998309097552, 681.2539766593903, 706.3838590524057, 590.7642031659996, 588.3152433874297, 513.0734796708433, 534.6177686867754, 625.4934562911021, 731.720116104927, 639.6547331530168, 599.8479031255793, 630.7498426477158, 659.796126277497, 597.2912681293526, 653.9778140436896, 663.7737884674202, 593.1151274325681, 646.0378940709946, 597.9198781446363, 595.8391044331659, 715.0799440524618, 652.2004885171337, 498.3333333333333, 718.6448321688214, 815.3333333333334, 815.3333333333334, 613.5199350845102, 613.3871129112829, 624.3990572116077, 521.3789986817147, 815.3333333333334, 587.1426634963208, 498.3333333333333, 713.2535581470064, 644.3230981909372, 673.7744087310984, 685.2894691282938, 640.2032844984718, 498.3333333333333, 498.3333333333333, 640.9459126185961, 498.3333333333333, 613.0448374100082, 498.3333333333333, 622.5831008404466, 606.0724674652662, 589.2890539472648, 498.3333333333333, 555.9717100909761, 670.1015449847872, 548.186558460344, 642.937199616609, 652.8656623245981, 552.167295001157, 613.3747451633699, 595.455779011916, 614.6325907419017, 591.3321983108011, 585.1041338522551, 815.3333333333334, 568.4115562320859, 692.5250867852005, 764.2457615676625, 619.9864720135408, 609.5002087656403, 668.9979728932443, 557.3223374102525, 747.6292652438854, 646.4212000803749, 660.3480760464255, 619.1088869539838, 595.4352085802745, 694.7246891519754, 564.4953572252451, 611.0339357056474, 815.3333333333334, 815.3333333333334, 616.5725001684195, 632.1783920343283, 623.338462775068, 617.7305367244682, 599.2496982497839, 549.5903333024413, 710.6469814662428, 720.2072838965751, 707.8781488151085, 594.7185816035366, 517.8700846617769, 648.313171535628, 815.3333333333334, 809.4412644353937, 680.2746211433204, 658.2041397849296, 646.5331015042099, 612.8242104905548, 639.0909672649833, 540.5948187985032, 667.5977972711507, 682.6651100707147, 581.3375375796122, 780.0693568128563, 587.581894181331, 608.1456282706041, 626.6345159935615, 498.3333333333333, 663.308078526664, 498.3333333333333, 632.5165688777894, 737.0101307786458, 610.5277992286943, 705.228848073506, 673.6827147272132, 587.0653363491078, 576.019908756441, 663.3049202635613, 546.9790498640815, 527.9078582837675, 498.3333333333333, 577.8285456002232, 504.57266312496785, 815.3333333333334, 639.5627804994415, 683.0485551922981, 606.932154488352, 659.2869025167378, 628.0410504446143, 498.3333333333333, 628.3091031343232, 585.8878654022458, 633.0349180725138, 610.10419296694, 615.2196106629044, 583.4691420880072, 527.0046216745641, 498.3333333333333, 593.2453665920696, 573.6808863852312, 716.8775245540717, 622.1788420386271, 550.0751393673879, 554.9946110758082, 600.2520021298959, 553.6382430713531, 580.5099865496686, 522.9706566908702, 594.6870566568832, 642.4648978670772, 591.3847551882022, 815.3333333333334, 588.0611711278846, 815.3333333333334, 812.9088326507515, 583.2284232943977, 581.4312990670292, 718.6999411020597, 670.4899990110642, 503.7853884012032, 652.4184373259139, 498.3333333333333, 615.8048299321085, 586.2920192645901, 498.3333333333333, 606.0746972051325, 694.2133362475006, 623.8096410284217, 618.2953114379077, 751.3425607133923, 634.824360362926, 672.9113031783439, 551.1260117273822, 613.1156836753343, 636.878289436739, 623.5447354924108, 599.4247329623383, 571.8099685768497, 693.9944993405362, 699.8830826405074, 534.0664407336116, 646.8389798109351, 759.9862393048918, 583.7845652074927, 582.4184118809296, 779.2260271181713, 598.9682161589243, 563.7316763019737, 588.6602404899252, 570.7719236429689, 757.891267571806, 591.724996515483, 638.3925997216072, 652.3215298558988, 554.6897187088487, 498.3333333333333, 498.3333333333333, 509.9876724723426, 623.8101439662452, 590.1901441581106, 561.6258667464319, 606.79023569611, 606.0937878855276, 557.808523222123, 620.0511973964553, 671.8717742557874, 647.0045352608402, 570.6400457829171, 615.4424818858372, 591.0753256298667, 568.1728269176701, 643.9399655204937, 562.3378040036957, 588.3460739930606, 730.2127284146046, 498.3333333333333, 653.7261385354524, 800.7980344185855, 700.4143420887766, 696.7336509022256, 611.8271463318862, 636.196159598637, 641.0144649100064, 571.6121852487187, 591.0990202051069, 592.7887203809888, 586.16614862569, 571.8565197064067, 815.3333333333334, 643.1379305917634, 815.3333333333334, 613.0093330106091, 616.005015900167, 541.046890757976, 524.427641863588, 600.8876339345801, 653.6960922560252, 580.899954096732, 655.8576609943267, 615.7659381972729, 547.0621989719378, 658.2074877229733, 559.0176522413586, 567.674656041934, 690.2698719373001, 547.8651062492484, 566.2371226449096, 608.1913315939477, 674.536125723791, 682.4106561147495, 656.6237749711839, 576.9168340255167, 690.33878781449, 584.2253635370722, 731.3265757371927, 630.8998783424354, 607.6289736886647, 498.3333333333333, 753.4195973066943, 498.3333333333333, 604.7101172332475, 586.0718160138932, 606.9959930011269, 583.7206391626323, 627.1033232670203, 498.3333333333333, 650.268014445861, 530.8452140628897, 665.0712979821865, 620.123194901614, 704.566065192339, 583.0010329391688, 498.3333333333333, 621.3951748541244, 630.3572235154476, 711.1951530809488, 632.8092173422323, 789.9191392846003, 686.8125685254445, 599.1616763605874, 509.5170291654343, 498.3333333333333, 660.4834408912399, 498.3333333333333, 597.9450858380787, 626.9202335813162, 584.569658004264, 611.1134286138438, 607.5745290763887, 646.5288055962147, 756.8670614111502, 781.4377792836056, 569.3198341423389, 636.4133786088454, 661.235857292678, 615.036196841327, 559.7377951143819, 602.5030737488955, 666.0031710904836, 519.9954093086963, 498.3333333333333, 580.2464776557217, 547.8802426225642, 518.2098561854791, 531.0941299409815, 571.9959831236414, 573.0764046202769, 578.5040600754762, 708.5022290046976, 566.0908357131157, 749.8713187900883, 677.1493452051205, 511.24805797983447, 556.7092054387388, 498.3333333333333, 636.0303274388806, 717.0954381053955, 633.6546443870022, 608.1836514410961, 609.8648404358282, 530.676724813232, 642.8939055918275, 590.2386271588491, 693.0735036326244, 583.3298358188293, 615.4339840100962, 673.5259605432237, 633.3049563460423, 629.3981516128514, 635.9145777313651, 498.3333333333333, 622.9671318304241, 633.9172677557488, 815.3333333333334, 685.2780829090733, 635.3753111521685, 668.3848659159166, 502.55180804509325, 627.9492613840018, 512.9481054103528, 611.1289384124148, 612.9235705855658, 622.2473970112746, 615.3832832318099, 498.3333333333333, 815.3333333333334, 815.3333333333334, 657.0572109750882, 614.5926348851798, 566.8114222813957, 581.7407966395187, 644.6658617839861, 544.2025495697611, 542.8717781093703, 602.2365118701608, 548.6030959500597, 595.8789903432801, 658.500227075181, 566.2879671794342, 607.5587057242259, 615.5644008325631, 498.3333333333333, 815.3333333333334, 760.126756980966, 722.5986932447126, 643.0472061865995, 634.7312882979161, 775.2348151330647, 692.7855257547543, 682.5443872342897, 498.3333333333333, 498.3333333333333, 646.7934593907866, 643.0720617867571, 716.616223712542, 815.3333333333334, 624.3444040823067, 693.8398567940354, 621.9533211376784, 791.2055521184475, 674.507924216492, 604.7981653630369, 589.2371594107948, 585.6296540037579, 744.0781160956354, 555.7452904443252, 677.6047713165663, 570.7119985705684, 616.4483749239331, 753.2660837141865, 639.4318646375068, 589.2968711240951, 572.0736809284962, 626.1501581329345, 498.3333333333333, 545.5822438636995, 634.8868807563584, 562.750670537791, 498.3333333333333, 498.3333333333333, 729.1212651176825, 687.9370188605302, 498.3333333333333, 702.4528857674704, 744.4134351846442, 652.5875946134611, 585.4364194371246, 623.2620445790294, 665.5651842929667, 667.4534665721152, 670.5088771436876, 684.0725315101764, 498.3333333333333, 594.1065768020411, 553.6140286895512, 652.8130498887683, 629.5324497277836, 670.6066342286299, 815.3333333333334, 753.534340097134, 815.3333333333334, 815.3333333333334, 723.9148385105324, 508.85271079015286, 618.9493639484355, 512.7094663885673, 586.0851098953967, 560.568119268141, 685.8274908735059, 578.2067964555147, 564.1957498429095, 659.6975821496277, 575.7468272021905, 575.2885156787736, 657.5597419505951, 712.469085367024, 722.1320913278174, 609.315901984484, 592.0107633092678, 676.9811507083366, 613.7055184075573, 574.9888473797695, 571.7156824131984, 498.3333333333333, 514.240714311135, 694.1258059175375, 498.3333333333333, 656.0980424212854, 541.1252317974357, 610.6691924437108, 646.8244510289547, 815.3333333333334, 628.4479708997801, 784.1459801095464, 548.298122339153, 498.3333333333333, 677.3368861176307, 593.7892532435661, 671.5583086921139, 663.8070796691757, 561.1099284778024, 618.5121936487758, 498.3333333333333, 652.2779502395682, 546.1977906877131, 608.520201005582, 559.6810851656146, 649.542888319486, 619.3293221870214, 624.241097106441, 680.5208150345469, 568.7174614340777, 569.5242005176104, 573.4055115574315, 498.3333333333333, 498.3333333333333, 643.9479288058376, 588.7543318477235, 663.4187994787123, 613.9430388969391, 661.5258913613712, 498.3333333333333, 589.4144683639349, 631.9559104053136, 523.7390880533729, 815.3333333333334, 815.3333333333334, 559.6770189671832, 611.2194491106674, 597.4657804495866, 745.0437419860434, 617.379214547562, 498.3333333333333, 557.7786876510761, 603.2728044826366, 648.9126075804578, 645.4639043680091, 815.3333333333334, 596.9510797829532, 556.3583150221356, 786.946158422743, 666.4311182214709, 717.9170728748485, 691.1436136546704, 611.7312601842103, 815.3333333333334, 571.9842477011421, 562.4990430976403, 634.4647804984141, 815.3333333333334, 693.7207250464893, 519.2414432581802, 815.3333333333334, 641.836013934133, 721.4779891842036, 559.0918819155461, 667.5255535253526, 586.578807216815, 575.338645118805, 498.3333333333333, 630.8147316647987, 588.5433347834783, 771.4536253773442, 524.107751412779, 674.3895059957622, 658.4427315822405, 617.3062994632503, 784.7489596733105, 599.0192857229958, 548.2871505761226, 594.4324427363158, 789.2436377514922, 624.862885176742, 563.2965318844289, 815.3333333333334, 704.9998586234044, 554.2919534310723, 596.0610386369245, 586.0156739013718, 498.3333333333333, 582.0568935807697, 569.0032441215197, 498.3333333333333, 631.6361604373259, 677.4157442589064, 584.9057647945314, 584.1218739047885, 655.763206517293, 698.4722844928256, 498.3333333333333, 592.0225647272187, 672.1131599910241, 551.6827072218867, 623.7661264345567, 634.6000021560146, 575.5583876950083, 739.419505369802, 590.1967167616262, 498.3333333333333, 582.2225328161107, 644.0457095435635, 654.2244560988789, 646.6842580438448, 634.682207128665, 644.1687405163465, 551.657518059676, 814.6500475993021, 555.2585352277057, 644.3138366210505, 588.4796414662706, 713.1294121455381, 508.44226765192326, 517.7919137402914, 548.8047047789601, 776.5003039960515, 557.4499282382479, 586.5154915660262, 792.0859467984985, 617.4578899345619, 589.355416673428, 575.9858768885562, 602.7270559609901, 594.553687002329, 498.3333333333333, 520.024984073477, 815.3333333333334, 639.5269244688923, 627.9276904783753, 815.3333333333334, 608.7557386688924, 517.4370306926681, 706.8289471385657, 591.3451047649884, 687.0549634981718, 667.2695491788288, 498.3333333333333, 657.008959946271, 582.4991667381943, 815.3333333333334, 498.3333333333333, 572.7808994583309, 629.2717996246431, 574.6438845219582, 758.8153769979583, 525.0155952090842, 640.0286554142897, 630.899948678669, 653.0147075182705, 660.0141058431593, 566.501448753986, 597.0750668931095, 569.4219265089998, 616.3122123537931, 578.9519892638328, 647.3437835241502, 498.3333333333333, 785.6188363627657, 516.0552432185962, 504.0767576308714, 681.8347774726532, 498.3333333333333, 546.4495096756701, 548.0459640161072, 613.5998892310256, 631.8951226284995, 631.3036273511489, 587.522846448452, 500.4072140795788, 602.4344878419706, 686.6945605711784, 557.7634899149195, 551.3377921792478, 569.2233583964799, 563.0624176386244, 635.9734688705472, 688.1394614780129, 683.1457882084591, 797.3538451386465, 598.4326652427123, 621.8488869922415, 648.9852036137418, 815.3333333333334, 732.2201607931082, 532.1748030330385, 666.687374292128, 589.6338600956536, 755.6343821162935, 498.3333333333333, 626.3782177298351, 594.6385253804974, 498.3333333333333, 498.3333333333333, 638.6944443684167, 661.008651052845, 640.148296795581, 579.1810228043364, 623.4731925168333, 645.515814572479, 498.3333333333333, 624.1447100651224, 498.3333333333333, 609.0066986933175, 498.3333333333333, 589.8650483604981, 548.5831825598486, 671.4955215058307, 681.9655164087442, 582.6741051681761, 546.9038233950473, 612.7012242531572, 738.5289720459525, 750.6033747811048, 761.7058368303528, 815.3333333333334, 607.6407950312163, 531.6839242721654, 616.6534973754161, 815.3333333333334, 629.8948408893425, 627.7883873726698, 498.3333333333333, 766.7396198522026, 645.1627723050408, 498.3333333333333, 583.3535218726017, 575.4866692348037, 607.2697240326011, 591.8027382571803, 560.9005886385384, 678.3580663243998, 554.1913632265218, 752.7065679968217, 591.9144517473699, 602.6202300621495, 662.8382708660839, 617.338653008461, 663.3345170670265, 704.5256580901237, 642.3045529362711, 709.5375516640783, 592.3095906892723, 716.7549256317988, 565.328148868317, 721.7121887220815, 658.8799333760325, 663.4984968863486, 508.83136747573997, 591.7781795399947, 631.4794878334817, 579.9571836757026, 815.3333333333334, 618.8527864155869, 498.3333333333333, 605.9789080817792, 610.674566367722, 576.5344911857829, 553.0276417306495, 815.3333333333334, 805.6000179716671, 600.3468177652484, 670.712895617044, 510.2993299582503, 639.3534805375219, 815.3333333333334, 735.55486669518, 815.3333333333334, 633.1757021550328, 629.715547342975, 647.7792973118359, 537.1002030052971, 523.1758104481911, 628.3594329945588, 815.3333333333334, 571.7779529842891, 576.035218702541, 593.2616071128082, 547.3674624691945, 719.0786299336313, 498.3333333333333, 690.6533389992103, 562.8112736067819, 806.488606031902, 688.2446208722257, 498.3333333333333, 635.20988475188, 556.729050765065, 598.4321793786063, 623.4533266233882, 504.52595951604, 633.3678899089483, 815.3333333333334, 677.8506488905032, 576.3229508430871, 587.172541918571, 785.4684174152413, 671.4739200277351, 660.0987104879654, 643.2173972050817, 753.1877127630601, 663.798044162097, 671.8173294658609, 561.3090323217398, 558.7871459975764, 626.5120116202343, 645.2680641115893, 605.4290444866858, 678.9343901141873, 716.2431405288887, 689.0660320579237, 664.3105268020643, 718.8648540961997, 603.8257140450755, 564.128066830818, 788.9319260956273, 613.8126205886546, 632.1002755592086, 590.9833713609346, 616.6182590375473, 766.1441665298371, 734.6471026680533, 613.4968841861672, 543.0403928530789, 815.3333333333334, 590.6848246155901, 524.1988421159, 627.0538000542108, 576.391254068503, 669.7648310839688, 624.5303742912032, 794.810849876107, 815.3333333333334, 549.9119776223017, 692.7719890846137, 650.1945345655695, 754.9307696258917, 758.8404127427075, 628.619136027443, 671.8951372714486, 588.4075105103299, 583.1746387060492, 592.4478195949791, 598.3142300908587, 498.3333333333333, 703.8905938250814, 619.7283233727368, 530.79215891106, 515.6472436333879, 760.8078685104487, 639.1376037659813, 505.1609772573404, 579.3072577692766, 601.4286328038728, 631.9298347164613, 644.6314963605287, 594.7682854245795, 634.5614346898124, 618.8116437492927, 609.8933355791569, 667.7621084050779, 577.6405689517298, 498.3333333333333, 815.3333333333334, 592.2233790256221, 674.3637536559577, 574.5161243793622, 612.2389034249355, 561.9602292665334, 525.8258746675825, 601.6334281245919, 530.8664591039527, 815.3333333333334, 498.3333333333333, 588.6125916562036, 537.2223448987394, 727.8219255045038, 680.0899081240627, 604.9930107867943, 616.9211350596499, 595.1353818827545, 536.436001264155, 815.3333333333334, 547.8700324829737, 615.0526805958197, 630.878207933666, 769.0961412125791, 579.6564757902942, 815.3333333333334, 569.6507773254281, 772.6486863029913, 611.7329980689154, 624.5156082877085, 526.5153513163207, 628.9820326752515, 669.048658175765, 654.1850671977847, 514.7035997423473, 577.3522415447518, 644.7727622056424, 633.351773594821, 785.4889116309561, 587.6676022584477, 815.3333333333334, 562.6377823292681, 606.2493797388911, 498.3333333333333, 708.9375770106566, 623.2818600378554, 498.3333333333333, 523.9954484754093, 669.2148711004345, 599.3640270290114, 615.5157681067936, 595.2147200131604, 669.4127929320981, 622.2864560731897, 790.8315627662274, 605.7773483681856, 583.3505635100705, 632.6672237288724, 793.7884762828559, 546.9052241510216, 589.3560839536572, 671.6084782457368, 636.7108164436438, 774.1027321583999, 697.4016699774876, 656.6354776518266, 519.752539562081, 664.6838956815159, 570.2093048908398, 656.6751928325855, 597.6446556431653, 626.1807340429084, 554.5235503846852, 656.3995277246877, 786.4122823006959, 754.1864083232904, 656.1688635699342, 732.5003366946574, 586.1392150936899, 650.9926659063931, 498.3333333333333, 815.3333333333334, 600.8258642518824, 713.2805334353468, 653.1512901329297, 605.3206109767974, 815.3333333333334, 598.4414471144988, 498.3333333333333, 650.031795380385, 596.7960983294229, 543.500701787726, 627.875221338461, 660.0385215702105, 815.3333333333334, 570.1562262507902, 624.0668416921088, 695.4558137766068, 606.3964601582678, 660.2536446112626, 655.8976149320972, 572.5312719713102, 747.0069746016632, 540.8351341441728, 756.796692243548, 666.5336785323433, 498.3333333333333, 531.4142458381556, 608.5063079612382, 689.0915407218308, 655.9641069732014, 610.282409298849, 612.9018808509275, 622.4020569444815, 617.9414859593996, 631.679334992974, 764.1920035618351, 654.962025178277, 551.7690448668886, 751.935426809733, 629.8039215212575, 679.1929896438926, 607.5050435296739, 645.0047793674553, 498.3333333333333, 579.4110862184168, 742.6605339444613, 568.0946399177191, 675.5330994841994, 659.7251707066492, 592.9470236818283, 653.02188945679, 553.2098263320013, 675.5216244443532, 663.0490079568028, 666.0283805468723, 658.8281423092328, 534.7102794807535, 570.9897607889914, 498.3333333333333, 498.3333333333333, 698.214706854169, 610.4912633687508, 720.8762458675644, 675.7722083027817, 663.9341521675206, 702.2792244715974, 701.4675075619899, 626.3974819549147, 727.3175812296231, 556.5820502039624, 687.2138414522839, 498.3333333333333, 649.8718762363551, 610.3743657713269, 739.9812369603404, 498.3333333333333, 532.3313866965854, 594.1489405333296, 748.3891982360299, 600.319805955213, 712.2599188764814, 498.3333333333333, 558.7822310929744, 608.664149457757, 815.3333333333334, 692.6409597678127, 566.9705615248932, 521.5285318699598, 533.540159116154, 789.783660102102, 593.8190194209857, 544.6242937038594, 801.3679168801432, 616.2464914257533, 595.7935385609934, 638.2507346471891, 815.3333333333334, 640.1600378412397, 640.2833153590351, 626.6818053610054, 658.6571051403906, 649.2203892586696, 618.5987462706295, 583.879553965562, 638.5308114598467, 646.6307237919953, 608.8891400140383, 815.3333333333334, 581.465724066145, 615.7047468490598, 612.7425484026808, 548.7295109186894, 815.3333333333334, 815.3333333333334, 595.7962902915758, 616.1883448684764, 603.2388092409259, 650.7087669034632, 568.5626783166717, 550.5795321975685, 580.9819949363447, 635.2044541331281, 815.3333333333334, 561.4635163810177, 520.5167520036114, 569.91259129362, 684.0834145587835, 567.9200069027482, 555.3563496962371, 498.3333333333333, 683.7939796986392, 632.5941011851219, 562.9428246596528, 611.4434340470511, 711.6185256256828, 585.8300352362799, 574.4294749455796, 609.2095315602112, 599.6787857980086, 635.0429555432158, 498.3333333333333, 685.8106635437608, 660.5416538629246, 614.8535050078162, 554.1319164479507, 773.5427266321357, 742.4149519960371, 815.3333333333334, 613.256478265543, 711.7713741525113, 644.689355343374, 568.7653833511322, 664.846303452164, 598.8390482308153, 638.141658193471, 568.0343241025033, 581.598582512697, 668.8719594341982, 628.2287162077034, 541.2594273328311, 587.3225475666071, 756.6763884121882, 569.1579978261974, 706.5252802363287, 499.16434982195494, 543.5988979994968, 594.6495615218921, 604.174966923658, 631.2751482364376, 567.5983182205063, 643.6265871779391, 598.5315171218908, 554.5981065490039, 658.5257489289991, 662.8303025662276, 723.7569544943467, 703.4084392164004, 815.3333333333334, 564.1204223681252, 498.3333333333333, 498.3333333333333, 795.7136993871322, 564.4566770748246, 498.3333333333333, 650.2944107134485, 608.2261931239982, 815.3333333333334, 596.3009626180396, 703.2674532931655, 601.1137127705808, 784.4593182982975, 576.8986047945752, 543.5495102019626, 676.2236048833089, 714.6865553437968, 815.3333333333334, 635.6296010212455, 660.0886347475878, 782.7073933513824, 583.141081670643, 649.7617951515615, 705.1500051506293, 657.9552924996666, 537.9941328597126, 572.7613780739495, 625.3284307217548, 571.6530645914547, 718.4606407121942, 613.2803647064982, 604.8927080095541, 651.3100248000342, 584.3691330898348, 676.001153606498, 579.1864029888586, 576.2768983238018, 815.3333333333334, 524.1201627409099, 815.3333333333334, 662.8188908722391, 543.4498308192311, 639.5152922544565, 768.2642631818517, 707.9423695885165, 543.2640052945915, 815.3333333333334, 531.2233653499687, 619.7407392774114, 723.4439639841029, 660.2089336206078, 696.1494339410464, 554.9775531476064, 563.9448059680545, 812.1413514336913, 646.1617011228483, 682.7360764133347, 512.3779332063236, 748.931049245304, 498.3333333333333, 618.123787496275, 718.6219378984447, 667.6983264048661, 677.7190072583252, 736.622204604947, 608.7087893372626, 729.1077658097097, 815.3333333333334, 644.3130605528231, 815.3333333333334, 673.7154031369349, 686.5020272111209, 683.3932053373944, 498.3333333333333, 611.5165788201936, 597.829157213238, 815.3333333333334, 665.8362951312687, 599.9865074171211, 697.2667563640027, 552.2029183474102, 725.0819841484413, 637.1507575573567, 660.4412334626976, 603.662174145518, 664.7624678403622, 635.9708401333967, 633.3277727922625, 672.2824606270111, 580.9046336894382, 598.3294556545674, 622.2337926494902, 648.244742472992, 559.6297266619613, 633.3053267109362, 638.7045188589599, 607.9899685056938, 498.3333333333333, 747.3307576935791, 561.4217691410604, 815.3333333333334, 599.8448876069208, 498.3333333333333, 580.6559214174138, 603.2064246863407, 658.418697534169, 613.3775659183899, 634.5377695446002, 676.4502087167809, 637.4186912541338, 601.2040129205458, 674.9316863284589, 678.0976988212733, 750.600914613493, 587.509161802276, 576.7282673984364, 598.8119008976522, 548.4379671975059, 609.2164838431318, 587.4186629007447, 593.656481553098, 622.4519481433218, 656.0858850422383, 498.3333333333333]
thresholds = [513.9351602370535, 616.6392981151461, 743.1867127991046]
display_name = "Ratio of Military to Government Clinical Trials Spending"
units = "ratio"

# Calculate exceedance probabilities (1 - CDF)

sorted_samples = np.sort(samples)
exceedance = 1 - np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

# Create figure

fig, ax = plt.subplots(figsize=(10, 6))

# Plot exceedance curve

ax.plot(sorted_samples, exceedance * 100, color=COLOR_BLACK, linewidth=2.5)
ax.fill_between(sorted_samples, 0, exceedance * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Annotate thresholds

for thresh in thresholds:
    exceed_pct = (np.array(samples) >= thresh).sum() / len(samples) * 100
    ax.axvline(thresh, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
    ax.axhline(exceed_pct, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.3)

    # Add label with formatted threshold value (use format_parameter_value for full units)

    ax.annotate(f'{exceed_pct:.0f}% chance\nâ‰¥ {format_parameter_value(thresh, units)}',
                xy=(thresh, exceed_pct), xytext=(thresh * 1.05, exceed_pct + 5),
                fontsize=10, ha='left', weight='bold',
                bbox=dict(boxstyle='round,pad=0.3', facecolor=COLOR_WHITE, edgecolor=COLOR_BLACK, alpha=0.9))

ax.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=12)
ax.set_ylabel('Probability of Exceeding Value (%)', fontsize=12)
ax.set_title(f'Exceedance Probability: {display_name}', fontsize=14, weight='bold', pad=15)
ax.set_ylim(0, 100)
ax.set_xlim(left=min(sorted_samples) * 0.95)

clean_spines(ax)
add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from

output_path = get_figure_output_path('exceedance-military_to_government_clinical_trials_spending_ratio.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Exceedance: {display_name}',
    description=f'Probability of {display_name} exceeding various thresholds'
)

plt.show()
```

*This exceedance probability chart shows the likelihood that Ratio of Military to Government Clinical Trials Spending will exceed any given threshold. Higher curves indicate more favorable outcomes with greater certainty.*
