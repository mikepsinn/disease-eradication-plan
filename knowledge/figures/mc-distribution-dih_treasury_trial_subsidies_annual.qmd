```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Annual Clinical Trial Patient Subsidies (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata
)

setup_chart_style()

# Simulation results
samples = [25050091362.653625, 21982714492.433712, 26186728134.199406, 26687042170.418877, 21987734655.03201, 21984420245.29436, 24612813761.233574, 23548218790.899586, 24260895262.159157, 22322515005.157722, 26525040360.124535, 26258099418.563194, 24461809381.753265, 26860228169.467564, 25459395695.362236, 22308628930.169933, 25210300410.68746, 22088470594.897064, 26522538153.291225, 24181010655.29321, 23858297275.274353, 22708413480.181232, 26859199689.53916, 23930464740.973114, 23286860678.786438, 23464211941.06534, 25624170748.959747, 25202002190.773945, 25320932510.961582, 25366572586.235775, 26850000000.0, 23337727867.72882, 23093086244.228016, 22409984800.93402, 25838504797.256393, 26860209675.93596, 24027357566.30569, 22351181943.122673, 22386099635.24415, 25927694349.627308, 26167972951.42813, 25651851709.53714, 22743309635.27544, 24869787837.378944, 24585493884.766502, 24836450476.65931, 26504006082.49471, 24848587235.92979, 26000897958.918137, 24465580824.160244, 25011220864.887897, 25877913749.97961, 21985384102.21413, 23540180759.13481, 23189569710.296665, 22803705449.77805, 23644787486.941277, 26856140313.1638, 22294107359.833363, 26760767052.27245, 21986705955.243767, 23504546663.46722, 24698517918.509853, 25762073309.68137, 26084672593.423847, 26298792127.65761, 23472177001.407562, 23208098474.294685, 26468535613.83629, 23842998653.320587, 21984252231.11859, 21983332559.077602, 22175376471.93944, 25534662599.970287, 24648581920.50754, 26030868056.02568, 23289353950.006855, 24688159082.236534, 25863239006.322067, 23564394122.84481, 25432202924.45858, 22751427606.847782, 23438711141.192463, 23395144747.557083, 21983740023.856956, 25508775784.158825, 23191810420.09598, 24331763989.613987, 25492969814.969456, 25406278606.279602, 25965903890.66125, 24064377165.573277, 23298526116.770702, 24109386903.550358, 21986725667.594498, 21985322608.546875, 21984549722.40355, 22004240692.016685, 25288286689.5726, 22206255816.839172, 23403475264.01528, 26858356554.22942, 23454563433.25028, 26153027965.54768, 22144116210.50236, 23809468786.781776, 22107969909.08484, 23494840370.463013, 26422024028.02317, 21986901355.362114, 25375672455.094967, 24883594073.182312, 22905499867.12125, 21985316143.58781, 24476667899.17401, 23053452804.492195, 24871062779.39984, 24354445661.822987, 26854890307.65631, 23729192946.160927, 21982603983.11843, 24739181526.340424, 24839685295.757572, 26857687520.97498, 26408358368.445107, 25180500905.9445, 26856504972.919205, 21983694202.03174, 22801721568.27268, 22159650452.701515, 23376348137.09748, 21984887645.240547, 25887866896.967846, 23769708621.15474, 21985467468.836117, 21982550766.54433, 25072040090.62997, 26416286550.070023, 26850336432.125298, 26850000000.0, 25325159968.41692, 22021139634.405266, 21987865395.59957, 24957968772.059147, 22411840813.20199, 23316956453.87053, 22864601005.05862, 23963223002.654087, 26860878195.7969, 24684494102.746437, 23920684620.49484, 21982685504.18834, 21986669758.61316, 23152801919.319534, 24171726946.662994, 26852908835.793766, 24618779438.603436, 26799317806.175983, 23122878150.20477, 21983669442.628193, 22074761426.75904, 22608464353.141132, 26850000000.0, 22392999354.03763, 26417240187.888237, 22211899825.276695, 26663165656.4595, 25250994210.952908, 23925441398.46176, 24203083039.787407, 22767605826.680435, 25405117711.393337, 23225132822.51632, 21983932000.454876, 21984266545.368134, 24722714380.6478, 26855158176.225307, 24691728232.37371, 24016137763.52441, 25003021533.522446, 26858281409.26303, 24838166407.688873, 23327244402.380184, 26860451461.09107, 25361359193.646736, 26855666186.974113, 24748934429.088696, 21983924691.67849, 21984834532.58219, 26854305484.136196, 26853428482.666485, 23870993828.96203, 23391768435.73849, 26856526317.33334, 21983159981.227173, 22230045880.00951, 25908946358.971237, 23365188676.77565, 24289124122.159836, 23909235524.52463, 25132171771.67041, 26857142302.462063, 24521685626.074196, 25910524939.175385, 21987841829.05621, 24183918104.040306, 22344341240.267517, 21983888299.216934, 22266768959.372704, 23506329192.448406, 26621605305.191586, 21984572964.36047, 24375743929.691208, 23157732693.319183, 23521431886.582363, 26852774347.52759, 25638986901.31829, 26857931654.843285, 23930521457.674786, 22674489213.54712, 23765836572.287434, 24895392522.3318, 24732526401.961388, 21983010186.383453, 24521453378.034004, 24860051297.55196, 26850000000.0, 26851640417.991463, 22322071695.66006, 23615984723.33504, 21985422523.819405, 22913354291.30504, 25077260535.768234, 26859381317.659225, 22599780618.589138, 22769059738.699127, 21987869729.806534, 23911085316.61512, 21982864213.336884, 23053575119.595623, 22269633166.84995, 24074497744.633392, 21987033932.088932, 21985444523.67812, 26850000000.0, 21984326778.249508, 21983092239.803196, 26852108893.59578, 26850000000.0, 21983582561.52987, 23426589360.74295, 25142134819.911404, 26853367300.503624, 22027020019.161125, 23715204213.51436, 26256911757.786087, 25376537566.95166, 23408151651.255737, 23979854390.775257, 21984876501.660637, 23731985630.739395, 23665408531.22872, 24869809048.95496, 22994222530.0954, 25469610327.78274, 26861436417.77041, 24680514845.982952, 25167681967.538204, 24430470744.87841, 24301718217.261272, 22616724071.818268, 25079480843.562695, 24067249957.23194, 26850045543.650246, 26855225696.230713, 25253245776.36984, 22523451143.816265, 21983195348.80689, 26859540885.034344, 24945641400.204605, 25491438803.51011, 21986976740.567657, 26652194000.752777, 25426241121.003025, 21983182297.5831, 23186909366.950665, 24948045612.661316, 24428795943.120148, 23604728722.885136, 24052393101.366142, 23699389326.163662, 24673471260.63352, 26856410826.061153, 21987982695.534115, 23735113283.140408, 24732376347.665955, 25028345397.85446, 23418040102.55513, 21987029557.478603, 25108214879.97566, 26853383690.1743, 21985849397.82355, 26483959767.262043, 23519436176.727722, 24153582603.979862, 21982800783.62338, 23505550404.63325, 26858347504.018642, 25752926345.782814, 26853323317.934322, 26859689369.280727, 25387455599.387573, 26853184330.07515, 25387219227.171616, 26389639118.84518, 23594389749.567135, 24463064015.248314, 22671144937.202717, 26817583076.57623, 21983626347.87574, 26270017713.532597, 23844549612.145374, 26859755890.549595, 26187817299.010212, 26852298598.329666, 26135483641.18483, 21986078142.815056, 24140049411.0761, 21983585426.86696, 23079207684.153454, 26855951614.710396, 25894008772.990925, 22667743832.12487, 21982538241.49522, 24380964014.350662, 21983873790.8647, 22730561067.97925, 25068285177.577328, 26859927427.62009, 25819944638.81795, 21987909867.379807, 25049217603.1093, 24476434104.514114, 25323851062.475502, 26854719240.527412, 21987845622.56985, 22912449816.724236, 25774089229.480362, 21986135092.137543, 26856359514.570343, 25209311093.702316, 26438536298.40864, 22958492689.212467, 26352297119.875526, 26860851928.510235, 24871562506.548805, 24875333828.83409, 24964509195.38523, 22299627027.324684, 23947151842.069077, 23935247316.440327, 25247080027.77949, 26844933926.74898, 21982838377.423794, 24000908434.74433, 26856296053.354507, 22567161433.17171, 22391074202.912285, 24795973377.103287, 26432749916.794014, 24329176594.329235, 26858025881.985867, 26465421634.304245, 26426001097.08663, 25679862002.39577, 26850000000.0, 23810122811.54595, 21987808633.216045, 26854861000.600094, 23218852531.84289, 24563949121.568035, 26858241993.11661, 21986257870.886993, 21984098948.536148, 21986252051.183044, 22453849765.41968, 25388845584.12232, 25603461371.073063, 24979254882.832714, 21985111302.7472, 21987915005.048813, 24433385567.562508, 23186329321.39587, 25438813538.231182, 26060604048.738377, 24638315292.826885, 26211979940.24529, 24862484570.283543, 25618445667.31459, 22654784267.588024, 23870774682.099052, 24782324666.975544, 26370049397.843113, 23367198832.580856, 25595763152.16902, 23666701537.17284, 24018759130.82483, 26393661077.796696, 21987793957.843964, 21984384132.523132, 21985536776.695942, 21987921391.81842, 22714440973.003693, 26184076284.272404, 23621862602.82883, 24784826701.1246, 26860632643.378807, 26858040099.731533, 24134798702.81981, 26857750393.38271, 24525450113.39369, 22357322193.05089, 22904928739.408474, 21985526744.17943, 22244646562.813004, 23450470348.510143, 26325608522.315384, 26853463663.017475, 21984921823.158237, 25270803141.809895, 21982718238.092884, 25477620668.964634, 23986388712.152008, 21987349379.58633, 26654471827.057465, 22880763478.87528, 23043336986.99372, 21982913037.200047, 22768749482.591206, 25359172713.555035, 23847889718.88632, 25109881080.774178, 25193166193.829575, 26858118393.897026, 23486061743.424236, 21985504348.59274, 26860865100.57983, 23512498180.899315, 26860363088.836643, 25247037922.614117, 23986267195.585423, 25160214855.27438, 26850764778.774467, 26850094364.63294, 24469970930.870495, 24692217409.185516, 26860769929.36177, 22338933077.100525, 25120904152.304703, 24239015700.270523, 25073024513.613865, 22366295256.302902, 21986182527.751762, 21987848443.798218, 21983228088.54833, 23216596407.39736, 23602330489.823452, 26850924300.614426, 26860454601.31918, 22081413881.13598, 25157541120.83376, 23336186679.18246, 23623086267.122402, 24754087886.514412, 25846716128.775642, 23494313037.685116, 26860900628.518402, 21983389239.14783, 24316857062.052635, 26850000000.0, 24847311172.80848, 26856849459.270107, 24523969204.65405, 25748111581.43488, 24164506253.5039, 23892660716.02013, 22486640269.69975, 25365260291.925556, 22325864709.673527, 25966421217.740395, 26860674264.33738, 25204730579.173237, 23618652977.385937, 25425089986.908512, 23565974436.697506, 26673715861.508762, 21987351518.68349, 23502856127.955956, 21987790799.40241, 21985614993.963097, 26857634995.069313, 26566758521.112915, 22621404224.836517, 21985660108.574085, 21988000000.0, 23021329989.0031, 26850000000.0, 25376836184.735893, 22984504485.50311, 25453239420.61927, 21986011940.136684, 23592622122.795605, 24543406492.35889, 24094070413.87412, 26292140270.851913, 25149869906.41622, 25973507144.745148, 22691589176.490948, 26573715947.45489, 26854567923.53109, 22063700388.817284, 22245617299.319405, 26857949690.158485, 23842904493.2198, 26857183827.132267, 23253938401.433224, 26856599735.4936, 24621748688.585857, 24934416939.859425, 26855327199.055958, 23441706597.686436, 22127573254.157616, 23239983313.155525, 25420960262.877056, 21986040638.755688, 25893846607.146626, 23032162418.810364, 26860007952.29201, 21987937691.65405, 22470784078.839878, 21986721844.297684, 22382202594.25955, 24908208138.0518, 23871689279.60993, 23696085371.699375, 23919374585.635506, 24798644835.873127, 21982503356.66878, 26073309206.25274, 25958875964.75816, 25251212854.58074, 25686041786.201035, 25029401987.97213, 26850220014.184055, 24091687054.2459, 23569705369.659225, 22544835782.583874, 21982662784.724144, 21984053041.28619, 22243176886.84916, 24131092376.904408, 25123967495.047066, 24425574017.059113, 22517893637.96888, 26579983873.3288, 26157967631.73081, 23918270860.362354, 22771849434.87471, 25665322944.954784, 24760614841.915543, 21985328827.950535, 24137580847.356293, 24943869612.809357, 22219050988.30552, 24765224796.786983, 21985369827.466038, 26857945200.683502, 26858921881.526062, 23698115166.475994, 25197010281.302605, 21987941860.99554, 21983483413.36236, 23600950198.80586, 21982928860.17451, 26092905364.1931, 26850332549.16829, 21983615377.00001, 22357177073.4345, 24877928184.11901, 26854779681.88267, 21983911218.703896, 24911606389.048344, 26852290999.558247, 21986549754.27342, 21984286445.858524, 23297810891.432537, 23073902772.835583, 26349247922.510624, 24893317815.762146, 21987108678.060997, 25581097725.04317, 22943419703.266, 26858630540.71844, 22829357941.211117, 22808843872.946598, 25646686821.692093, 26219270048.77387, 25410245459.392902, 21986718000.182285, 25638780157.55858, 21982676490.289047, 24877501525.437138, 21985178952.93746, 25405749899.154385, 22426000162.8959, 21984296388.704895, 26091408303.53348, 24893280148.30298, 22860320907.90058, 26856644052.654995, 23258299657.54363, 24379326898.44032, 24960955702.4951, 22847373644.860012, 25468590427.287148, 23044364749.728363, 23325592715.050632, 26857648703.8917, 21982718519.84132, 21987942620.162506, 26854781806.557804, 26850000000.0, 23340390599.59018, 21987714492.92619, 23561725396.57871, 23618713615.294384, 23846276256.115486, 21983201781.285736, 25744994877.575108, 25604275861.406963, 21985611018.84287, 26053452626.03237, 26850167339.00609, 24721169640.74025, 23498836348.981308, 23960330532.67617, 25836645969.111755, 21986916009.691917, 24702545321.07791, 23374825522.91175, 26851981276.548256, 23883705042.151512, 26854102233.34383, 21983138176.704014, 25764732638.874096, 25086737944.344517, 22286968174.45855, 24734552483.88047, 26859308852.452656, 23530524350.916504, 21986746081.69173, 24259055444.801487, 22213014879.86539, 23487102945.53555, 24104899357.48819, 21986806342.35046, 21986337186.480103, 25496320631.60992, 23069008630.801487, 21987982206.485027, 26276539946.409367, 24969546605.376453, 22634034982.315388, 21984512746.23591, 26410189859.43209, 25161654556.299038, 26850000000.0, 25339735295.761826, 25257914005.048527, 23900940284.172752, 26360200259.491867, 25861938285.20314, 26858880476.522453, 23072215192.172, 23270450023.88087, 23169418371.499146, 26292128753.11776, 26856100593.09367, 23216214476.128376, 23295103435.459423, 25073446419.152027, 23714062149.168324, 26717580861.1902, 21987898998.129276, 22381142590.60614, 22480071276.90904, 21987917794.60123, 22078011538.06007, 22184865983.02303, 23819743218.91623, 26860380411.87663, 23715717098.722202, 21982653072.031513, 24164093992.65335, 26861055027.116505, 22050939544.179993, 22194989612.449127, 25691196316.725662, 23771333675.396225, 25919673063.85714, 24268516139.558422, 26059851749.286766, 21982681648.711456, 24272291121.828, 23797019786.368114, 21983869479.81505, 21986027005.930046, 26018597170.91885, 23466971834.13423, 21982595808.61855, 24069904459.05059, 26860219862.530987, 21987906975.312374, 21985624564.437923, 22167793917.659702, 26856529364.817375, 24994959518.782684, 26230732982.477444, 21983377603.129906, 21983242244.830246, 25409522846.55424, 24442925563.98934, 25666117335.98427, 23851626033.050594, 24983904810.133244, 24687125234.385986, 26258035254.920273, 26334581347.569004, 21986362082.4197, 21987897750.9716, 26850068227.255547, 26859577886.126385, 21982584675.393147, 21987472697.19044, 24542324822.444496, 26661215450.971184, 26852566289.45767, 25583357218.095524, 23418501545.406757, 22233580252.852783, 24329237725.928604, 23588061961.102463, 21982547328.011875, 26850179107.57948, 26852710042.61774, 26860134005.429398, 22172289153.92741, 26460746581.893272, 25899403683.25577, 25396199623.685925, 26858903072.255375, 25888434395.379066, 26159534174.38462, 25892391168.252415, 25140222133.331703, 21987146084.50939, 24504689259.102592, 22992242586.49237, 21984278642.339897, 26853934744.318718, 26853363678.782913, 26857687150.081207, 24926932285.750298, 26857783593.807014, 24330695778.66546, 24797185776.223183, 21983070326.03077, 25281281204.07538, 24448065063.447643, 21984423233.79431, 24177950225.908497, 24109359650.27993, 26852566675.85074, 26564188976.385227, 24329223548.709133, 24910989281.06385, 24408727112.023476, 23815452291.95949, 21982997188.16968, 23938752503.094265, 22561521357.561977, 21984090434.047523, 25570432678.283367, 25266871539.982758, 21987159458.840015, 24006463837.40738, 26833918832.583702, 26860949361.69647, 26861299502.828884, 24395851998.91936, 22340302824.95073, 21983005618.154465, 25149768945.18619, 25236741750.510784, 26858488276.083767, 26860518499.089333, 23983661384.552715, 21984051338.680492, 23541504258.728897, 24832846906.596424, 23817422340.68917, 22942608148.333042, 24921153909.157703, 23112145941.90643, 22828270059.267033, 25066895956.623516, 23348007308.834984, 24899377485.06759, 24971620679.810028, 21983372809.972134, 23164486320.384533, 26856797367.417656, 21983520793.249596, 21987861002.13653, 21987481235.071266, 24372051402.35263, 24376437543.472504, 24018594860.898785, 26859290668.800396, 21988000000.0, 25278619829.585026, 26855365694.66675, 21983296426.647068, 23399644486.68691, 22546262941.36047, 22230889290.861298, 23524737069.672226, 26856914800.235256, 26852103366.010235, 23502079502.02101, 26851306965.143394, 24387748401.619965, 26853072485.14909, 24076808411.866417, 24620699513.404896, 25202078487.995396, 26850000000.0, 26450913307.984035, 22648939107.065277, 26762683838.90576, 23441561738.16835, 23144867123.39275, 26602263589.553707, 24376846047.79719, 24984979868.780605, 24335376663.320065, 25129691203.303925, 25351790186.47982, 21987714676.264874, 25968973870.413734, 22037634522.710625, 21985293090.16411, 24160589446.131363, 24505567429.113976, 22679991289.426754, 26397636216.78011, 21984672080.64804, 23336499192.79832, 22926667042.633442, 24189050308.69813, 24985697209.062946, 21982499024.139244, 26118598127.564804, 24454434814.375423, 21987608662.444958, 21987745359.598335, 24271724061.408886, 23772680034.626095, 24052556324.017097, 24233900721.560093, 24853447332.621727, 26705870375.513626, 21983186740.557587, 21983585195.34389, 21983069350.30375, 25010716040.321613, 26858954790.420242, 23279878331.33011, 21987965966.652428, 21986799047.61047, 22367034928.66351, 22988723992.669273, 23333141895.347824, 24395045378.03703, 23558763932.458275, 26861053283.79603, 22719524411.459087, 22301908488.929234, 25488221368.72357, 21985860108.351204, 25262915029.079975, 24550923650.688637, 23947357357.535275, 26855049890.85344, 22841592067.95327, 26850144510.46691, 23762115366.33446, 21984260689.34084, 24471282819.610226, 21982956173.096672, 22548813811.64997, 25281386905.53311, 25683609128.749805, 22841682471.035957, 26811767334.916332, 26859903826.295616, 26856814216.035744, 25616784614.049206, 26857639868.44704, 21987561568.263035, 23544317486.457718, 22291500732.433193, 24591712328.537712, 22957336918.37017, 23902773037.951706, 26851577579.02451, 23894297021.14944, 25323604066.95608, 23745942143.67773, 24485403255.20089, 24316076536.644424, 25410813911.261635, 26859819897.571186, 26854347742.221912, 25062322428.88412, 25770601268.362316, 21983447612.15405, 24089809904.436142, 26686310952.902164, 26489603937.148975, 24818952173.169243, 26543519621.118336, 25518413275.46509, 26859441549.81238, 25011817903.387634, 23455884549.286114, 25127835182.692215, 21988000000.0, 25245802846.024002, 21988000000.0, 21986884475.74136, 25419529493.996567, 25484805584.7733, 21983523069.482098, 22638031085.22635, 26857559858.203705, 23158053923.635975, 26850000000.0, 24296869115.596497, 25309096013.955208, 26854711347.887196, 24620624233.085274, 21993073879.286423, 24037455610.84731, 24215501286.912388, 21984813217.978287, 23690294724.008755, 22570299181.036095, 26644021722.53472, 24385406263.4134, 23626775057.83455, 24045942955.26376, 24847415757.246204, 25840652192.496277, 21998838799.56135, 21982725219.899006, 26860468571.742558, 23323970271.876366, 21985136462.030247, 25399403497.544254, 25448905549.1437, 21985830464.0135, 24863153772.476616, 26147997154.22037, 25224449412.88038, 25879699799.77971, 21985058787.632915, 25115827020.460373, 23580183093.25234, 23160913501.048115, 26501702411.625015, 26856321198.376118, 26852603628.892483, 26858183548.823048, 24037439503.425198, 25170096944.62762, 26229442086.533768, 24596492411.581673, 24619979715.620617, 26378515800.65163]  # Truncate for embedding
baseline = 24422000000.0
mean = 24346513838.574512
std = 1740542066.1065981
p5 = 21983956128.469963
p50 = 24269674299.012047
p95 = 26858930002.64126
display_name = "Annual Clinical Trial Patient Subsidies"
units = "USD/year"

# Create figure with two subplots
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
# Handle edge case where all samples are identical (zero variance)
if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Mark key statistics
ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {p50:,.2g}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {p5:,.2g}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {p95:,.2g}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {baseline:,.2g}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---
sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Mark key percentiles
ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"
exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title
fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark
add_watermark(fig)

# Save PNG (same directory as the QMD file)
output_path = Path('mc-distribution-dih_treasury_trial_subsidies_annual.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 2.442e+10 |
| Mean (expected value) | 2.435e+10 |
| Median (50th percentile) | 2.427e+10 |
| Standard Deviation | 1.741e+09 |
| 90% Confidence Interval | [2.198e+10, 2.686e+10] |

*The histogram shows the distribution of Annual Clinical Trial Patient Subsidies across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
