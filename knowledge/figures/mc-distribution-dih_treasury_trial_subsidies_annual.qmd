```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Annual Clinical Trial Patient Subsidies (10,000 simulations)"

import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Simulation results

samples = [22262112004.955658, 19536714492.433712, 23271990919.14102, 23716502195.77268, 19541734655.03201, 19538420245.29436, 21873593229.44563, 20927691571.43629, 21560912976.176083, 19838617574.828228, 23572569849.249054, 23335402062.136616, 21739425833.17022, 23870228169.467564, 22625773457.17777, 19826279230.21723, 22404455984.067413, 19630659091.90028, 23570346731.315895, 21489935032.33958, 21203201093.016766, 20181502722.363926, 23869199689.53916, 21267322746.630554, 20695469480.00322, 20853049883.636086, 22772173016.216763, 22397083118.585724, 22502751110.442684, 22543301634.15198, 23860000000.0, 20740666128.356598, 20523296075.794994, 19916337979.246944, 22962604056.624107, 23870209675.93596, 21353413025.96503, 19864089308.622948, 19895115070.10169, 23041846738.925323, 23255327512.826374, 22796766983.113575, 20212509120.208027, 22101913731.992455, 21849319549.609337, 22072293681.318794, 23553881670.326984, 22083077123.576252, 23106886199.908257, 21742776765.02289, 22227575922.653664, 22997617941.969856, 19539384102.21413, 20920549632.566803, 20609024120.91643, 20266172763.509644, 21013494538.815918, 23866140313.1638, 19813376218.290813, 23782003739.636307, 19540705955.243767, 20888888069.719837, 21949741187.93484, 22894696476.560932, 23181317612.392944, 23371556212.3395, 20860126997.181034, 20625487385.52858, 23522367449.891254, 21189608072.694622, 19538252231.11859, 19537332559.077602, 19707878802.060467, 22692646759.790524, 21905373178.221127, 23133513805.521847, 20697684809.004326, 21940537391.539993, 22984579796.514927, 20942063647.38598, 22601613139.089245, 20219722205.557476, 20830391911.083103, 20791682268.2203, 19537740023.856956, 22669646797.492153, 20611015047.269947, 21623880159.23486, 22655603476.848507, 22578579806.980892, 23075794913.00504, 21386305277.772144, 20705834489.801994, 21426296806.65498, 19540725667.594498, 19539322608.546875, 19538549722.40355, 19555816972.198994, 22473745762.9544, 19735316430.847282, 20799084107.286015, 23868356554.22942, 20844476992.176983, 23242049345.191883, 19680102694.876614, 21159816344.430546, 19647985105.71868, 20880263842.156193, 23481043562.79546, 19540901355.362114, 22551386726.770824, 22114180485.975872, 20356620259.60217, 19539316143.58781, 21752627645.150787, 20488080694.19284, 22103046510.1361, 21644032907.364807, 23864890307.65631, 21088490118.040836, 19536603983.11843, 21985870667.902737, 22075167800.136696, 23867687520.97498, 23468902103.333298, 22377979487.693043, 23866504972.919205, 19537694202.03174, 20264410021.398483, 19693905549.550064, 20774981079.84975, 19538887645.240547, 23006461063.694847, 21124488886.4811, 19539467468.836117, 19536550766.54433, 22281613236.90045, 23475946015.199417, 23860336432.125298, 23860000000.0, 22506507144.74615, 19570832465.44887, 19541865395.59957, 22180261878.8127, 19917987118.711357, 20722210262.880306, 20320280375.283936, 21296428820.96534, 23870878195.7969, 21937281067.270535, 21258632998.61805, 19536685504.18834, 19540669758.61316, 20576355011.564384, 21481686394.874905, 23862908835.793766, 21878893725.3076, 23816254467.773357, 20549766969.92345, 19537669442.628193, 19618477877.994556, 20092694466.013912, 23860000000.0, 19901245742.689423, 23476793288.941273, 19740331373.71848, 23695288867.13182, 22440611902.345448, 21262859450.03354, 21509546487.7978, 20234097083.603203, 22577548370.594177, 20640622819.24857, 19537932000.454876, 19538266545.368134, 21971239667.562634, 23865158176.225307, 21943708571.451385, 21343444123.80089, 22220290888.018837, 23868281409.26303, 22073818276.54061, 20731351336.067146, 23870451461.09107, 22538669614.841393, 23865666186.974113, 21994536084.908672, 19537924691.67849, 19538834532.58219, 23864305484.136196, 23863428482.666485, 21214482139.29029, 20788682343.802074, 23866526317.33334, 19537159981.227173, 19756454915.470734, 23025189631.410385, 20765065658.82109, 21585994456.374428, 21248460344.703087, 22335039606.372684, 23867142302.462063, 21792625928.85423, 23026592159.57613, 19541841829.05621, 21492518319.74939, 19858011068.82668, 19537888299.216934, 19789084915.76227, 20890471880.731888, 23658364129.96403, 19538572964.36047, 21662956487.044083, 20580736130.026447, 20903890910.299774, 23863748316.50048, 22785336866.11239, 23867931654.843285, 21267373140.05837, 20151359858.53598, 21121048515.86772, 22124663331.29205, 21979957614.184387, 19537010186.383453, 21792419576.394848, 22093262875.247066, 23860000000.0, 23861640417.991463, 19838223676.2929, 20987902799.938477, 19539422523.819405, 20363599151.158257, 22286251550.45639, 23869381317.659225, 20084978658.91609, 20235388931.803345, 19541869729.806534, 21250103906.48951, 19536864213.336884, 20488189374.509884, 19791629883.521095, 21395297500.227615, 19541033932.088932, 19539444523.67812, 23860000000.0, 19538326778.249508, 19537092239.803196, 23862108893.59578, 23860000000.0, 19537582561.52987, 20819621461.650772, 22343891663.990177, 23863367300.503624, 19576057458.53158, 21076060917.939888, 23334346863.647354, 22552155365.18341, 20803239175.136257, 21311205983.912804, 19538876501.660637, 21090971460.009865, 21031816673.384705, 22101932578.347523, 20435452942.148746, 22634848982.148994, 23871436417.77041, 21933745508.219494, 22366590012.233257, 21711581400.289566, 21597184366.723076, 20100033518.645714, 22288224271.683315, 21388857778.32129, 23860045543.650246, 23865225696.230713, 22442612388.365154, 20017157145.811893, 19537195348.80689, 23869540885.034344, 22169309103.40171, 22654243200.329193, 19540976740.567657, 23685540985.81369, 22596316175.47407, 19537182297.5831, 20606660339.606487, 22171445227.964615, 21710093335.52842, 20977901650.47569, 21375657330.121735, 21062009147.48189, 21927487300.64918, 23866410826.061153, 19541982695.534115, 21093750425.72298, 21979824291.481136, 22242790917.280823, 20812025269.569206, 19541029557.478603, 22313754166.824986, 23863383690.1743, 19539849397.82355, 23536071251.752274, 20902117684.563972, 21465565019.949776, 19536800783.62338, 20889779912.90533, 23868347504.018642, 22886569606.819008, 23863323317.934322, 23869689369.280727, 22561855865.778954, 23863184330.07515, 22561645852.79559, 23452270700.591587, 20968715293.295242, 21740540576.81433, 20148388354.211163, 23832482384.731464, 19537626347.87574, 23345991083.298367, 21190986119.547077, 23869755890.549595, 23272958608.563084, 23862298598.329666, 23226461738.631245, 19540078142.815056, 21453540679.778374, 19537585426.86696, 20510964603.616436, 23865951614.710396, 23011917965.73116, 20145366355.39679, 19536538241.49522, 21667594547.815254, 19537873790.8647, 20201181595.4835, 22278277033.70503, 23869927427.62009, 22946113802.20153, 19541909867.379807, 22261335677.88871, 21752419918.32422, 22505344200.939568, 23864719240.527412, 19541845622.56985, 20362795498.412277, 22905372346.099155, 19540135092.137543, 23866359514.570343, 22403576988.26267, 23495714131.47527, 20403705950.1925, 23419093612.504, 23870851928.510235, 22103490514.625988, 22106841311.067837, 22186072993.661552, 19818280670.10824, 21282149421.216972, 21271572118.55512, 22437134202.268482, 23856782441.6348, 19536838377.423794, 21329912715.691296, 23866296053.354507, 20055995339.874325, 19899535169.985874, 22036329986.539997, 23490573136.49074, 21621581248.522736, 23868025881.985867, 23519600791.280205, 23484577048.57477, 22821653540.405323, 23860000000.0, 21160397454.25012, 19541808633.216045, 23864861000.600094, 20635042628.480526, 21830177041.721386, 23868241993.11661, 19540257870.886993, 19538098948.536148, 19540252051.183044, 19955313698.407585, 22563090845.257393, 22753773148.470776, 22199174418.4334, 19539111302.7472, 19541915005.048813, 21714171226.035988, 20606144954.669724, 22607486559.14755, 23159933399.166077, 21896251299.390106, 23294426366.109516, 22095424823.516766, 22767086396.567253, 20133851334.735775, 21214287424.595047, 22024203170.923977, 23434865907.195244, 20766851725.750008, 22746933433.01191, 21032965530.018753, 21345773233.94637, 23455844071.906124, 19541793957.843964, 19538384132.523132, 19539536776.695942, 19541921391.81842, 20186858352.38552, 23269634831.98199, 20993125395.759945, 22026426216.91461, 23870632643.378807, 23868040099.731533, 21448875386.45142, 23867750393.38271, 21795970676.924667, 19869545167.078503, 20356112795.448933, 19539526744.17943, 19769428239.06352, 20840840204.306072, 23395381690.88366, 23863463663.017475, 19538921823.158237, 22458211871.523945, 19536718238.092884, 22641966030.95696, 21317011795.65898, 19541349379.58633, 23687564744.408066, 20334641229.0727, 20479092512.53738, 19536913037.200047, 20235113259.145893, 22536726960.68263, 21193953847.17089, 22315234568.586277, 22389232443.470085, 23868118393.897026, 20872463862.110622, 19539504348.59274, 23870865100.57983, 20895953144.229683, 23870363088.836643, 22437096792.383343, 21316903826.94701, 22359955569.716606, 23860764778.774467, 23860094364.63294, 21746677380.642223, 21944143203.661667, 23870769929.36177, 19853205697.594646, 22325028449.583164, 21541472868.269646, 22282487886.964336, 19877518092.6133, 19540182527.751762, 19541848443.798218, 19537228088.54833, 20633038006.948544, 20975770778.964718, 23860924300.614426, 23870454601.31918, 19624388884.029785, 22357579987.468594, 20739296748.15785, 20994212642.200344, 21999114911.521744, 22969899625.146076, 20879795296.8158, 23870900628.518402, 19537389239.14783, 21610635294.774216, 23860000000.0, 22081943348.80858, 23866849459.270107, 21794654889.1132, 22882291797.38563, 21475270759.409615, 21233733431.757694, 19984449308.05319, 22542135680.84362, 19841593923.537907, 23076254544.34536, 23870674264.33738, 22399507257.983696, 20990273589.086933, 22595293411.82274, 20943467784.662422, 23704662304.09968, 19541351518.68349, 20887385996.60719, 19541790799.40241, 19539614993.963097, 23867634995.069313, 23609634870.0511, 20104191999.837215, 19539660108.574085, 19542000000.0, 20459538683.981598, 23860000000.0, 22552420682.431187, 20426818182.147675, 22620303712.161312, 19540011940.136684, 20967144726.04257, 21811924921.205086, 21412687981.592617, 23365646255.770584, 22350764201.094536, 23082550201.38021, 20166553759.381863, 23615816279.126076, 23864567923.53109, 19608649644.66169, 19770290779.32861, 23867949690.158485, 21189524410.233273, 23867183827.132267, 20666217266.340107, 23866599735.4936, 21881531899.449615, 22159336253.95454, 23865327199.055958, 20833053434.923523, 19665403548.681328, 20653817837.920708, 22591624219.95013, 19540040638.755688, 23011773885.475094, 20469163599.64516, 23870007952.29201, 19541937691.65405, 19970360482.11574, 19540721844.297684, 19891652394.927006, 22136049919.556004, 21215100055.777157, 21059073532.58303, 21257469017.64759, 22038703564.85591, 19536503356.66878, 23171221569.41254, 23069550787.402355, 22440806164.313957, 22827144146.630352, 22243729687.986732, 23860220014.184055, 21410570346.880356, 20946782785.509018, 20036158185.4474, 19536662784.724144, 19538053041.28619, 19768122370.04682, 21445582288.010788, 22327750196.399124, 21707230647.538315, 20012219095.69126, 23621385092.439625, 23246438089.557564, 21256488345.081825, 20237867667.64149, 22808735894.86478, 22004914084.965004, 19539328827.950535, 21451347342.62196, 22167734883.648315, 19746685487.068714, 22009010010.723614, 19539369827.466038, 23867945200.683502, 23868921881.526062, 21060877036.817406, 22392647868.3098, 19541941860.99554, 19537483413.36236, 20974544366.49954, 19536928860.17451, 23188632191.142067, 23860332549.16829, 19537615377.00001, 19869416222.483932, 22109146379.48177, 23864779681.88267, 19537911218.703896, 22139069242.169468, 23862290999.558247, 19540549754.27342, 19538286445.858524, 20705198995.7202, 20506251046.957584, 23416384503.84227, 22122819968.1892, 19541108678.060997, 22733903487.580765, 20390313161.36486, 23868630540.71844, 20288965815.38258, 20270738416.35567, 22792178087.06665, 23300903399.34361, 22582104291.81557, 19540718000.182285, 22785153178.516907, 19536676490.289047, 22108767295.925045, 19539178952.93746, 22578110059.228798, 19930568252.437634, 19538296388.704895, 23187302096.133434, 22122786500.899437, 20316477376.86266, 23866644052.654995, 20670092345.57027, 21666139965.506054, 22182915743.186504, 20304973332.022915, 22633942818.21279, 20480005708.037766, 20729883774.929874, 23867648703.8917, 19536718519.84132, 19541942620.162506, 23864781806.557804, 23860000000.0, 20743032024.557854, 19541714492.92619, 20939692436.003384, 20990327466.899364, 21192520264.857323, 19537201781.285736, 22879522676.13204, 22754496806.981674, 19539611018.84287, 23153579562.634987, 23860167339.00609, 21969867171.394268, 20883814345.94803, 21293858830.50289, 22960952532.811142, 19540916009.691917, 21953319523.057354, 20773628204.46173, 23861981276.548256, 21225776207.737087, 23864102233.34383, 19537138176.704014, 22897059229.874527, 22294672132.36813, 19807032757.33497, 21981757780.66101, 23869308852.452656, 20911969734.920826, 19540746081.69173, 21559278288.94225, 19741322147.33906, 20873388990.41434, 21422309586.101448, 19540806342.35046, 19540337186.480103, 22658580617.832462, 20501902469.41959, 19541982206.485027, 23351785875.98063, 22190548692.40327, 20115414871.798138, 19538512746.23591, 23470529319.073265, 22361234727.4359, 23860000000.0, 22519457107.994373, 22446760047.349422, 21241089926.396626, 23426115283.76484, 22983424137.894993, 23868880476.522453, 20504751585.954273, 20680888231.667854, 20591119151.363327, 23365636022.64089, 23866100593.09367, 20632698651.702473, 20702793359.039555, 22282862745.847668, 21075046176.371166, 23743634586.63609, 19541898998.129276, 19890710539.674133, 19978612509.794178, 19541917794.60123, 19621365748.71028, 19716310643.482006, 21168945314.976196, 23870380411.87663, 21076516624.252117, 19536653072.031513, 21474904462.783318, 23871055027.116505, 19597311053.312702, 19725305924.70043, 22831723836.616005, 21125932770.257, 23034720033.62629, 21567684164.47716, 23159265002.455204, 19536681648.711456, 21571038255.011513, 21148755238.24117, 19537869479.81505, 19540027005.930046, 23122611464.201595, 20855502103.30954, 19536595808.61855, 21391216326.300285, 23870219862.530987, 19541906975.312374, 19539624564.437923, 19701141373.14056, 23866529364.817375, 22213127856.79203, 23311087855.10796, 19537377603.129906, 19537242244.830246, 22581462262.01723, 21722647530.71617, 22809441694.622894, 21197273609.921825, 22203305840.62483, 21939618820.573025, 23335345054.799522, 23403353745.936977, 19540362082.4197, 19541897750.9716, 23861344045.77451, 23869577886.126385, 19536584675.393147, 19541472697.19044, 21810963857.560787, 23693556187.00284, 23862566289.45767, 22735911003.268238, 20812435271.08648, 19759595355.434967, 21621635564.18651, 20963092942.483673, 19536547328.011875, 23860179107.57948, 23862710042.61774, 23870134005.429398, 19705135585.996803, 23515447175.321945, 23016711206.93554, 22569624792.633316, 23868903072.255375, 23006965271.75869, 23247829915.344486, 23010480764.76244, 22342192263.368114, 19541146084.50939, 21777524648.621407, 20433693705.884327, 19538278642.339897, 23863934744.318718, 23863363678.782913, 23867687150.081207, 22152686193.20162, 23867783593.807014, 21622931049.69292, 22037407197.364887, 19537070326.03077, 22467521486.243687, 21727213984.90507, 19538423233.79431, 21487215820.45431, 21426272591.90744, 23862566675.85074, 23607351926.916225, 21621622967.67188, 22138520945.989998, 21692262134.32895, 21165132769.148003, 19536997188.16968, 21274686515.92917, 20050983927.944035, 19538090434.047523, 22724427799.408978, 22454718696.65518, 19541159458.840015, 21334848745.984253, 23846996004.76614, 23870949361.69647, 23871299502.828884, 21680822563.686, 19854422773.889, 19537005618.154465, 22350674498.187725, 22427948778.02068, 23868488276.083767, 23870518499.089333, 21314588537.133312, 19538051338.680492, 20921725586.34851, 22069091929.086105, 21166883183.760544, 20389592070.954887, 22147552146.90251, 20540231121.69493, 20287999198.031307, 22277042724.52925, 20749799638.607574, 22128203944.174377, 22192391490.91629, 19537372809.972134, 20586736899.207882, 23866797367.417656, 19537520793.249596, 19541861002.13653, 19541481235.071266, 21659675665.198624, 21663572764.984188, 21345627278.53542, 23869290668.800396, 19542000000.0, 22465156891.67753, 23865365694.66675, 19537296426.647068, 20795680381.22589, 20037426268.319084, 19757204321.754547, 20906827627.46912, 23866914800.235256, 23862103366.010235, 20886695949.60288, 23861306965.143394, 21673622495.36152, 23863072485.14909, 21397350547.88154, 21880599708.89855, 22397150907.726624, 23860000000.0, 23506710663.701828, 20128657706.741177, 23783706724.8386, 20832924724.307858, 20569304742.065002, 23641179765.389668, 21663935722.306606, 22204261021.340446, 21627090033.580288, 22332835648.664326, 22530167697.499287, 19541714676.264874, 23078522508.22911, 19585488932.931614, 19539293090.16411, 21471790648.75444, 21778304903.230278, 20156248641.37073, 23459375845.000347, 19538672080.64804, 20739574423.43894, 20375427927.581543, 21497078317.094692, 22204898372.23572, 19536499024.139244, 23211459460.21601, 21732873518.980755, 19541608662.444958, 19541745359.598335, 21570534419.023735, 21127129029.51964, 21375802354.916843, 21536928181.01713, 22087395291.347137, 23733230296.11122, 19537186740.557587, 19537585195.34389, 19537069350.30375, 22227127390.45152, 23868954790.420242, 20689265502.593185, 19541965966.652428, 19540799047.61047, 19878175321.02007, 20430567334.913834, 20736591390.07566, 21680105878.884354, 20937061121.608288, 23871053283.79603, 20191375157.84683, 19820307842.512638, 22651384566.46045, 19539860108.351204, 22451203390.119648, 21818603915.263077, 21282332023.958332, 23865049890.85344, 20299836220.605778, 23860144510.46691, 21117742171.07374, 19538260689.34084, 21747842995.45355, 19536956173.096672, 20039692809.95629, 22467615400.529797, 22824982782.408115, 20299916546.569244, 23827315345.96621, 23869903826.295616, 23866814216.035744, 22765610584.105648, 23867639868.44704, 19541561568.263035, 20924225190.926964, 19811060122.335228, 21854844631.196487, 20402679014.14531, 21242718349.725727, 23861577579.02451, 21235187308.399483, 22505124749.02544, 21103372028.10552, 21760389018.389526, 21609941794.729607, 22582609352.08321, 23869819897.571186, 23864347742.221912, 22272979189.78937, 22902273372.809883, 19537447612.15405, 21408902483.698387, 23715852538.385353, 23541085891.219837, 22056746532.399227, 23588987983.360615, 22678209533.681915, 23869441549.81238, 22228106386.121265, 20845650830.201687, 22331186594.69132, 19542000000.0, 22435999443.077457, 19542000000.0, 19540884475.74136, 22590353005.260063, 22648349702.658195, 19537523069.482098, 20118965549.082233, 23867559858.203705, 20581021551.340702, 23860000000.0, 21592875918.352024, 22492234553.680363, 23864711347.887196, 21880532822.448383, 19545894738.882225, 21362385233.20917, 21520580176.207733, 19538813217.978287, 21053928451.614223, 20058783342.510185, 23678280238.986595, 21671541498.944103, 20997490195.029392, 21369926316.835785, 22082036271.48306, 22964511965.235718, 19551017139.38758, 19536725219.899006, 23870468571.742558, 20728442197.82998, 19539136462.030247, 22572471383.36562, 22616453140.913315, 19539830464.0135, 22096019405.643814, 23237579620.64434, 22417027194.084076, 22999204802.604877, 19539058787.632915, 22320517472.597183, 20956092429.459076, 20583562358.586334, 23551834943.32245, 23866321198.376118, 23862603628.892483, 23868183548.823048, 21362370921.615116, 22368735691.105083, 23309940934.82039, 21859091730.10915, 21879960169.65119, 23442388015.807285]  # Truncate for embedding
baseline = 21704000000.0
mean = 21636916237.934666
std = 1546272901.166096
p5 = 19537956128.469963
p50 = 21568713194.94365
p95 = 23868930002.64126
display_name = "Annual Clinical Trial Patient Subsidies"
units = "USD/year"

# Create figure with two subplots

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---

# Handle edge case where all samples are identical (zero variance)

if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax1.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key statistics with formatted values in legend (use format_parameter_value for full units)

ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {format_parameter_value(p50, units)}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {format_parameter_value(p5, units)}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {format_parameter_value(p95, units)}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {format_parameter_value(baseline, units)}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---

sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax2.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key percentiles

ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"

exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title

fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark

add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from

output_path = get_figure_output_path('mc-distribution-dih_treasury_trial_subsidies_annual.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Simulation Results Summary: Annual Clinical Trial Patient Subsidies**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | $21.7B |
| Mean (expected value) | $21.6B |
| Median (50th percentile) | $21.6B |
| Standard Deviation | $1.55B |
| 90% Confidence Interval | [$19.5B, $23.9B] |

*The histogram shows the distribution of Annual Clinical Trial Patient Subsidies across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
