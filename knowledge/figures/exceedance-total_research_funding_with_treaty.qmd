```{python}
#| echo: false
#| fig-cap: "Probability of Exceeding Threshold: Total Global Research Funding (Baseline + 1% treaty Funding)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata
)

setup_chart_style()

# Monte Carlo samples
samples = [96446504235.90692, 87586832422.50783, 99661168623.36755, 101077271709.28636, 82237520199.46948, 85996171337.81139, 95210730586.14072, 92204376914.29535, 94216576285.93198, 88747145100.74944, 100618664446.26299, 99863139209.14581, 94784107067.31955, 102494691549.02228, 97603703331.69133, 88708003602.11923, 96899397788.30984, 88087508558.58261, 100611581549.9751, 93990954565.6582, 93079685755.45154, 89835132450.63225, 103228747869.45273, 93283444310.0745, 91466815662.61444, 91967285089.90079, 98069690552.79031, 96875937884.42413, 97212183983.09308, 97341230336.26201, 108180000000.0, 91610348930.45592, 90920106840.45154, 88993714784.34212, 98675942075.88646, 102507961974.17024, 93557036240.58385, 88827952136.25446, 88926382301.61383, 98928254543.37038, 99608096383.10194, 98147980130.26738, 89933539353.59258, 95936890756.62021, 95133540646.93466, 95842675270.84042, 100559124078.7261, 95876974888.54254, 99135359659.03209, 94794761513.60948, 96336632261.49586, 98787425245.00458, 85075743355.68805, 92181690357.63943, 91192308329.9083, 90103863693.45932, 92476947241.71933, 105366618951.97691, 88667071420.14145, 101286000747.43192, 83760898578.11224, 92081118876.34552, 95452893820.83435, 98459738594.76344, 99372389638.22296, 99978299878.72942, 91989763931.79399, 91244585260.98228, 100458722777.21573, 93036493350.22403, 86154976581.18442, 87015919266.35928, 88332426779.50583, 97816550491.79347, 95311793579.84076, 99220154180.07997, 91473850814.2441, 95423623094.1098, 98745911676.7974, 92250030771.4797, 97526808743.9645, 89956432495.33124, 91895318459.7895, 91772372719.48746, 86636191154.099, 97743343461.59853, 91198630199.9719, 94416749203.62672, 97698645620.2561, 97453502917.61398, 99036353853.07954, 93661573913.62225, 91499731662.67462, 93788679782.89017, 83735194141.68863, 85134953401.57147, 85873463809.61928, 87850153777.05534, 97119882116.531, 88419456516.40128, 91795881272.28455, 103824626489.87585, 91940055501.94495, 99565806673.16594, 88244326431.38501, 92941831257.68497, 88142459539.2456, 92053725071.18286, 100327073987.61246, 83505502482.4701, 97366960707.0534, 95975909784.63025, 90390962241.97977, 85141174360.8272, 94826083089.79663, 90808299967.97925, 95940493961.16154, 94480817934.36655, 106221425964.58165, 92715208286.9212, 87688277325.48346, 95567798948.84274, 95851817132.28821, 104293777010.54298, 100288395092.73795, 96815152468.20691, 105115258773.13083, 86679028829.58118, 90098268707.49474, 88288105992.18893, 91719329800.3396, 85551852801.08868, 98815582159.47218, 92829583872.4033, 84995364645.34186, 87737061185.22705, 96508546711.06265, 100310834732.46326, 108180000000.0, 108180000000.0, 97224136790.01349, 87897772236.25314, 81232497592.31647, 96186115836.50871, 88998946970.6453, 91551736778.02512, 90275608365.40671, 93375939338.59676, 102026569914.54181, 95413267117.30908, 93255830116.15462, 87613461333.50198, 83808063018.83696, 91088574917.54099, 93964735342.33984, 107569405435.74585, 95227586368.23126, 101395150896.52858, 91004153562.09308, 86702161457.90645, 88048875472.62665, 89553296786.92139, 108180000000.0, 88945832489.88354, 100313533885.85388, 88435363791.99625, 101009675868.99759, 97014446006.66364, 93269260856.03555, 94053292790.25345, 90002056581.95474, 97450220314.66093, 91292646746.84924, 86456341378.81836, 86141465495.94754, 95521266379.92867, 106039124157.47289, 95433708326.11087, 93525354010.81842, 96313456434.0494, 103877481876.17769, 95847524627.63821, 91580766844.7413, 102334255926.9739, 97326489289.34288, 105692080338.05975, 95595358886.15019, 86463199622.48819, 85602532481.43942, 106617799619.1886, 107208060672.50685, 93115532285.11725, 91762844891.93414, 105100517774.88133, 87175941205.12715, 88486507938.86726, 98875215699.91127, 91687838953.64359, 94296308667.33492, 93223503914.42776, 96678527772.174, 104673742178.80666, 94953264117.58568, 98879681532.26399, 81684792544.89967, 93999165887.12251, 88808669177.06586, 86497335583.3883, 88590013969.2382, 92086149688.89, 100892019616.01495, 85851406724.54164, 94540980299.01291, 91102485938.91165, 92128774232.22173, 101546510807.22977, 98111594558.69926, 104122954373.1646, 93283604450.61935, 89739469753.16193, 92818652889.6536, 96009254848.8141, 95548992924.88022, 87314452471.53088, 94952607971.54141, 95909373776.45145, 108180000000.0, 108180000000.0, 88745895509.09605, 92395647067.33281, 85038714272.63953, 90413115951.75365, 96523303540.87804, 103099694736.04509, 89528811881.5132, 90006156787.46994, 81180000000.0, 93228726725.10458, 87449088032.16579, 90808645014.65381, 88598087068.51189, 93690153558.51065, 83331454532.50406, 85017499857.6465, 108180000000.0, 86084574359.31161, 87238624047.89575, 108135799280.19336, 108180000000.0, 86783254922.86552, 91861109856.4176, 96706692418.08276, 107249056139.73824, 87914342404.96007, 92675719251.53142, 99859778186.68143, 97369406869.37573, 91809078033.37859, 93422900293.77142, 85562489984.76651, 92723091872.1651, 92535154745.71011, 95936950704.13051, 90641218605.65558, 97632588367.14188, 101621918836.45009, 95402023143.14304, 96778913170.12396, 94695575959.77325, 94331881402.60988, 89576586334.84659, 96529579791.77988, 93669686400.48897, 108180000000.0, 105993097502.52971, 97020811693.8632, 89313600855.86609, 87143185628.3782, 102986112591.89091, 96151273783.78047, 97694316095.51997, 83406612429.12712, 100978614959.38762, 97509950474.16284, 87155275304.61766, 91184802537.75276, 96158069010.69215, 94690844751.72774, 92363875949.63739, 93627732325.05328, 92631075812.90787, 95382120567.36867, 105180241581.98096, 81180000000.0, 92731921078.69997, 95548568903.47668, 96385036226.29709, 91836983445.16211, 83337207505.13853, 96610804904.75734, 107238076463.97878, 84625520244.5487, 100502381363.96957, 92123141674.57892, 93913492458.7772, 87507486729.54008, 92083951723.20361, 103830994389.38565, 98433865430.18565, 107278512313.86127, 102880247376.10924, 97400278521.22313, 107373320299.46782, 97399610155.51154, 100235413465.9624, 92334693550.58919, 94787651442.90897, 89730039448.32861, 101446867384.14798, 86742400830.34149, 99896867615.03604, 93040872121.94519, 102832765482.52318, 99664250702.57634, 108001876593.21765, 99516162398.65753, 84402736339.12619, 93875272900.74493, 86780582425.32524, 90880954566.48404, 105496332423.31635, 98832957327.92711, 89720448930.19937, 87748536573.11417, 94555725949.02837, 86510938240.9369, 89897588065.31033, 96497932602.8531, 102710169960.22958, 98623439082.21976, 81180000000.0, 96444034407.16069, 94825422603.88177, 97220435955.0977, 106337600821.11458, 81612358498.95023, 90410564836.59544, 98493727252.0069, 84347120620.2693, 105215632570.8519, 96896600879.54431, 100373810510.95712, 90540434109.75584, 100129726124.31308, 102045550328.43399, 95941906276.9189, 95952564711.42712, 96204601843.76155, 88682629719.67224, 93330561013.63266, 93296948023.36732, 97003379754.3562, 101524310521.39638, 87472882356.47578, 93482350346.49478, 105259378592.57068, 89436839917.25787, 88940405507.60245, 95728286166.09714, 100357432586.2755, 94409440702.20197, 104056908550.64098, 100449908629.6594, 100338330664.20868, 98227203272.17558, 108180000000.0, 92943677680.64874, 81944189126.29675, 106241342577.06058, 91274927149.58588, 95072669266.75919, 103905189984.61952, 84227011394.40971, 86299442640.88962, 84232710926.17926, 89117374972.1639, 97404208843.001, 98011119943.67981, 96246279839.1243, 85337899992.95088, 81180000000.0, 94703810166.64182, 91183166021.91177, 97545501776.8856, 99304288734.32666, 95282784839.20303, 99732626087.25946, 95916250559.97899, 98053498664.37549, 89683905554.72337, 93114913557.81616, 95689715664.31284, 100179969117.15817, 91693511379.25858, 97989348009.69809, 92538804584.81134, 93532756137.33194, 100246796852.65723, 82002531974.55078, 86030345089.57874, 84928445847.6015, 81180000000.0, 89852129676.67194, 99653664527.57784, 92412238079.74686, 95696786235.86795, 102203792423.8946, 104046937483.86565, 93860444334.42003, 104249825357.7972, 94963899550.19016, 88845260739.76407, 90389351361.12689, 84938137891.4866, 88527660280.58562, 91928504262.84338, 100054192889.36942, 107184477154.41695, 85519214533.82088, 97070450834.84875, 87583390663.83554, 97655240286.16583, 93441351043.3198, 82914805643.11255, 100985063491.13976, 90321193490.27855, 90779763749.7135, 87404093636.35304, 90005281827.66693, 97320306963.83188, 93050302160.4044, 96615514976.01707, 96850957839.2106, 103992002801.71152, 92028949628.26973, 84959766901.82452, 102036033031.43298, 92103560430.5462, 102397797631.287, 97003260714.06982, 93441007919.85017, 96757803759.86003, 108180000000.0, 108180000000.0, 94807163756.97507, 95435090579.9701, 102104767118.25699, 88793424441.79468, 96646675550.62009, 94154779044.3855, 96511329410.99585, 88870554897.98586, 84300749745.21375, 81558397618.27911, 87112846003.60547, 91268561609.97804, 92357106759.17807, 108180000000.0, 102331996918.59634, 88067622332.85782, 96750245191.56136, 91606000007.5182, 92415692030.01552, 95609921731.04906, 98699170595.31854, 92052236802.15958, 102010356024.81213, 86963258641.8168, 94374642522.28409, 108180000000.0, 95873368595.4223, 104876962994.67374, 94959715680.87054, 98420246445.92299, 93944342695.35864, 93176706073.31973, 89209818819.88556, 97337519771.93187, 88756587197.87012, 99037817459.54074, 102173786473.21785, 96883651292.43279, 92403178518.63684, 97506695408.39124, 92254491148.66394, 101039543945.57034, 82911967997.92685, 92076347704.52617, 82015078573.10822, 84852820756.92587, 104330474225.9316, 100736756810.39406, 89589782837.2737, 84809150957.53949, 81180000000.0, 90717684146.3656, 108180000000.0, 97370251231.84622, 90613806180.46033, 97586294696.70805, 84467313089.37985, 92329704344.44958, 95014630474.98778, 93745425922.36098, 99959474772.40657, 96728559004.41924, 99057864827.03334, 89787689336.30917, 100756451773.11267, 106440203180.29163, 88017705361.63823, 88530396345.47308, 104110317971.34804, 93036227511.28958, 104644877229.79668, 91373922056.50586, 105049789329.89845, 95235975902.14893, 96119549364.33849, 105923848622.91974, 91903771936.02316, 88197704858.62369, 91334547292.32838, 97495017803.61948, 84439329272.08882, 98832498564.69476, 90748241199.68327, 102652542680.54794, 81180000000.0, 89165116227.2799, 83740180684.94632, 88915396673.85252, 96045475092.49654, 93117495783.46182, 92621749256.08153, 93252131250.38011, 95735835622.00082, 87780485088.53511, 99340237233.02112, 99016470724.5118, 97015064161.28447, 98244682201.39693, 96388022795.71492, 108180000000.0, 93738695360.33934, 92265021597.19485, 89373893100.57475, 87634322521.35289, 86342632813.15448, 88523517937.6447, 93849977317.6399, 96655335221.9849, 94681743038.55634, 89297932146.49295, 100774195019.44066, 99579784341.85783, 93249014900.76285, 90014024081.46838, 98186081343.59332, 95628365967.6, 85128968027.19887, 93868301400.82344, 96146266043.02805, 88455519025.16629, 95641393108.24686, 85089494014.88455, 104113463729.91016, 103425665026.3869, 92627479051.75275, 96861825344.70135, 81180000000.0, 86875648095.84851, 92353210793.09723, 87389503671.89474, 99395684263.09142, 108180000000.0, 86752639951.89842, 88844851664.23618, 95959896848.66, 106296575925.05841, 86475839766.8576, 96055079505.06247, 108007245683.60226, 83940336648.95175, 86122675869.32678, 91497713522.33041, 90865989234.5236, 100121096285.21121, 96003391234.55147, 83233052013.31781, 97947872016.56297, 90497918309.31013, 103631561871.36667, 90176210465.36584, 90118355241.22252, 98133372210.0817, 99753255925.5797, 97464719812.6321, 83745193868.77753, 98111009828.44278, 87621738927.6424, 95958691029.4866, 85273012065.70398, 97452007919.12436, 89038863188.83138, 86113285537.92221, 99391448316.43228, 96003284777.4628, 90263536781.25052, 105019150273.9827, 91386227608.56491, 94551101429.87004, 96194558152.6445, 90227020657.65976, 97629704269.93265, 90782663003.50415, 91576106167.44838, 104320898453.87543, 87583131765.9392, 81180000000.0, 106295133354.42952, 108180000000.0, 91617862638.57198, 82317132441.40776, 92242498407.11566, 92403349676.28726, 93045746907.97174, 87137226060.63968, 98411430608.53537, 98013423476.82655, 84856666805.41736, 99284054393.47816, 108180000000.0, 95516901320.119, 92065002778.83917, 93367772142.49605, 98670683779.11954, 83486294694.0213, 95464274041.20981, 91715033118.63472, 108180000000.0, 93151420667.23686, 106755035602.1122, 87196125454.57826, 98467260834.01381, 96550093882.91286, 88646948318.77249, 95554718205.99225, 103151213363.61844, 92154436340.20578, 83708560407.84846, 94211379802.4423, 88438506513.25555, 92031888144.7929, 93776006856.08646, 83629855209.95801, 84149270245.77368, 97708121367.57065, 90852182770.05222, 81180000000.0, 99915325492.72289, 96218839779.47742, 89625397774.22745, 85908535892.72688, 100293578864.0231, 96761873760.30458, 108180000000.0, 97265347769.67003, 97034009881.81801, 93200082770.6291, 100152093707.1513, 98742232078.40529, 103454964953.7688, 90861228530.52737, 91420510907.716, 91135454622.32103, 99959442176.71236, 105393943106.58284, 91267484011.9367, 91490073948.98804, 96512522025.69498, 92672495323.27512, 101163730762.15279, 81180000000.0, 88912408567.0629, 89191299084.11618, 81180000000.0, 88058034388.49321, 88359171521.68439, 92970837866.45424, 102385346719.4703, 92677167074.08109, 87643238338.78854, 93943178394.71887, 101898652721.74977, 87981745643.6082, 88387703731.95564, 98259261378.78445, 92834171492.63695, 98905561877.10727, 94238101222.38736, 99302160160.70192, 87617002028.63153, 94248763606.01083, 92906685850.45285, 86514979499.49231, 84452624442.82874, 99185435821.57997, 91975073986.74844, 87695773778.85054, 93677182478.81915, 102500652692.46005, 81180000000.0, 84843559861.20755, 88311056701.7518, 105098412848.37015, 96290668920.70569, 99785694477.39354, 86974073718.75662, 87099722193.67912, 97462676509.07451, 94730760276.8627, 98188328165.69452, 93060850839.21515, 96259422766.07124, 95420701790.36548, 99862957629.04819, 100079587287.33421, 84124844107.48477, 81180000000.0, 101538848363.05336, 102959747381.95848, 87705981874.2352, 82750943842.67029, 95011574481.57135, 101004154786.96918, 107812481113.68294, 97954262158.34575, 91838285653.28943, 88496469586.12018, 94409613377.71756, 92316833124.60504, 87740211793.39722, 108180000000.0, 107710570532.33612, 102562233586.5768, 88323725702.8349, 100436675899.35944, 98848219438.40346, 97425003218.32, 103438976829.52892, 98817187589.83885, 99584217168.0449, 98828381166.60974, 96701285403.01479, 83183731698.58224, 94905246464.3648, 90635633605.95439, 86130044584.66548, 106867925012.35931, 107251482153.62433, 104294036204.30873, 96098395195.99431, 104226604850.41759, 94413731872.94354, 95731712364.24995, 87258885785.21674, 97100075387.6517, 94745279264.67993, 85993342308.27899, 93982311216.73938, 93788602818.89383, 107812207379.64275, 100729483019.8034, 94409573332.0004, 96053335382.04402, 94634152200.85358, 92958723754.70096, 87326454782.30646, 93306845041.21393, 89420937672.49411, 86307455847.909, 97917710057.57687, 97059335122.12227, 83166085493.73615, 93498037282.16985, 101493121366.12863, 101975119113.23099, 101721396054.73415, 94597781822.0711, 88797285530.57057, 87318670994.65343, 96728273592.52669, 96974151385.04573, 103731877036.88731, 102286013729.07782, 93433649962.72375, 86344233971.47299, 92185425792.59338, 95832491323.54822, 92964285574.43906, 90495629206.15115, 96082063652.45549, 90973876348.48196, 90173142312.43317, 96494005666.53914, 91639355615.62668, 96020517334.95561, 96224702046.31252, 86978528076.16734, 91121539828.36365, 104913049905.24234, 86840833665.07071, 81317238786.56319, 82739578226.76202, 94530549726.21805, 94542939608.78912, 93532292277.00706, 103164134737.2106, 81180000000.0, 97092550873.41705, 105897567589.41016, 87049462396.95248, 91785070869.23006, 89377916907.25162, 88488885093.05653, 92138102584.75435, 104831671000.16483, 108139697828.85547, 92074155848.13469, 108180000000.0, 94574890542.60425, 107452990553.85674, 93696678725.04721, 95233011483.7921, 96876153583.49333, 108180000000.0, 100408843018.58278, 89667423537.62616, 101291427722.6446, 91903363127.44986, 91066188903.65482, 100837265287.5514, 94544093546.29715, 96262461406.47066, 94426953795.51764, 96671515469.95909, 97299432786.2445, 82316409145.72762, 99045039359.48515, 87944252980.05225, 85163351646.07202, 93933280928.82928, 94907727425.4207, 89754984767.7206, 100258047766.64543, 85757239357.7821, 91606881857.2893, 90450665504.04291, 94013660503.02112, 96264488961.97556, 87784451629.37836, 99468383105.9423, 94763273792.76678, 82569626914.69725, 82195194477.66315, 94247161949.35896, 92837972346.82092, 93628193243.87808, 94140332352.56787, 95890710091.72826, 101130576545.32938, 87151159971.23766, 86780798371.66626, 87259787776.7629, 96335205343.78198, 103402368267.68433, 91447113982.7065, 81180000000.0, 83639389463.36508, 88872639970.45828, 90625708429.92325, 91597408262.64151, 94595503247.41737, 92234139827.02328, 101899915015.90318, 89866464801.31238, 88689060507.74554, 97685217579.97755, 84615110325.95895, 97048149027.53412, 95035868455.5759, 93331141299.82257, 106112876420.80093, 90210714609.6233, 108180000000.0, 92808147784.53046, 86146993362.39005, 94810869910.55255, 87364309826.32748, 89385108980.63873, 97100374238.18745, 98237801649.38652, 90210969576.84233, 101430400534.0616, 102727050822.25568, 104901379998.02344, 98048800828.56165, 104327070268.06767, 82632507023.7197, 92193365841.53793, 88659724145.55801, 95151110135.81564, 90537174046.90198, 93205257430.67737, 108180000000.0, 93181326034.1488, 97219737594.02914, 92762490629.2345, 94850761178.77902, 94372437837.50768, 97466327202.35664, 102787046562.42137, 106589233192.92706, 96481077629.63225, 98483861041.10564, 86908970963.20953, 93733394336.57155, 101075201566.40222, 100518357535.02557, 95793224149.67914, 100670973461.0055, 97770597743.92963, 103056843168.81973, 96338319828.4808, 91943783880.61617, 96666268708.74835, 81180000000.0, 96999768891.18855, 81180000000.0, 83527617639.65378, 97490972034.84021, 97675558187.98401, 86838712922.51453, 89636665681.97858, 104382934465.09335, 91103392217.3252, 108180000000.0, 94318184786.96844, 97178717470.04228, 106342956225.79724, 95232798781.24153, 87818688002.7904, 93585551181.99207, 94088365798.05518, 85622856926.9663, 92605403221.66354, 89445686867.40143, 100955479332.81425, 94568274436.42259, 92426104143.73505, 93609518040.45947, 95873664162.24371, 98682016689.6641, 87834932310.97092, 87576974735.41766, 102321945989.61493, 91571528018.12564, 85313777436.04935, 97434062578.89894, 97574039492.52025, 84643917502.44113, 95918141825.84071, 99551571160.15518, 96939398880.58691, 98792477863.59544, 85388215224.74734, 96632323216.54378, 92294594879.75536, 91111459879.19228, 100552603298.03044, 105242048556.30153, 107786023838.99342, 103946253474.35535, 93585505697.48862, 96785740305.71211, 99782041398.94463, 95164615777.71805, 95230977714.85583, 100203931262.21411, 93927360948.16888, 89527523100.93762, 91557529874.95064, 98806537949.74124, 94351765197.6694, 96697171523.94688, 99070691665.93396, 91817725754.77397, 99703944852.10524, 96971044199.96458, 86400820082.22174, 104948879857.274, 90994740883.27643, 83921067126.34578, 87555733953.1857, 87703381484.08308, 94688828274.06674, 92485532369.00551, 92068259808.27191, 98703034737.4838, 96694804082.34477, 96526429159.48012, 97191487265.91756, 98677071746.76662, 81365202326.41624, 91886200699.5076, 81180000000.0, 94578206716.89436, 94299648327.75597, 101870966806.90628, 102959047847.16628, 95731557275.92375, 90997232788.41464, 97730335951.79236, 90818500756.967, 94321787306.71593, 101420812670.68489, 90625434263.54498, 100069722699.759, 99124286140.35782, 88112872460.05661, 101328368495.52235, 99279428444.58374, 95031536394.13885, 89318241092.56973, 88708544928.79517, 90755414896.03223, 98143936837.85808, 88107704619.45567, 97389027304.53995, 86358990690.70526, 92950994464.03893, 95084882285.64755, 108180000000.0, 85548113081.06732, 105184390356.1265, 95363241930.7203, 97201060799.21104, 95145036875.18114, 97440598967.07446, 93289125349.49954, 105041900898.21051, 91282940218.15948, 102532976816.71375, 90068719214.04886, 93920777179.73038, 87390548302.80081, 97514269585.37871, 104971212755.66342, 93804694413.7377, 92999093947.86664, 87129727348.47069, 92782362264.54031, 84281993823.55829, 88373358195.11115, 95899285671.28415, 103979116782.26175, 108180000000.0, 90439648836.65112, 104893457521.84294, 96018051781.09639, 93305527494.56038, 97353895281.60887, 94755805054.89432, 95090051810.26537, 91597771899.0055, 85424716649.80283, 84568463437.77151, 98947623552.33435, 92466595122.23038, 90378489466.58156, 94389460960.0373, 99990044490.9572, 95575374300.92712, 89993954591.52887, 103257790889.17908, 106039880585.97647, 97797831777.97733, 101326628148.4102, 103379196698.39427, 102516602943.47844, 98662261553.43787, 98547753038.29189, 97978490573.07655, 87235249418.0405, 99295256952.28835, 85675983979.38211, 89114455349.80806, 103858463520.71092, 100326419047.76424, 105306617828.55695, 92499997739.92575, 86900556178.29762, 92707994662.17932, 95032264327.42575, 94873323815.69781, 102544066544.78868, 91907066050.71587, 96780882873.05963, 87903401979.85425, 97480587109.73378, 94352553172.5919, 89397408281.88416, 92738732542.89172, 93084291092.11281, 92510098603.85648, 107597320978.2226, 93661841061.55673, 92684930462.86734, 81423151736.98991, 88489750524.67628, 92557202404.58951, 89803746332.30054, 104470725477.72234, 93213456581.65775, 103740550202.44383, 94754348044.83662, 94586218546.13556, 93727164927.27823, 94357254876.54489, 107168398553.95724, 81180000000.0, 81955206952.64632, 90719783754.32559, 94430667956.91553, 99217361257.53203, 97643693912.68951, 91755887113.83551, 101669877119.97794, 101754469938.98383, 95601092491.88205, 101243619454.24338, 96220775676.8506, 90601471480.2215, 99273928746.091, 95091554400.7714, 94340462343.5701, 105191845505.03291, 81180000000.0, 85308795360.33467, 86689279613.70334, 91893956377.146, 92613553421.26729, 84780874277.27783, 87924845694.68782, 88698302998.63657, 108180000000.0, 107846524170.95009, 91575378049.40839, 91891831366.9892, 86919066096.17276, 82478465875.79381, 93537226753.28574, 87846417172.8092, 93753895785.5763, 84238936490.70844, 89320448284.1897, 95354808791.74828, 96881368347.12027, 97245972507.95514, 85886670761.54294, 100434188723.0557, 89079088780.09427, 98798865997.62097, 94258634604.53464, 85553627066.88179, 92204673980.63342, 96875368126.82878, 98654013400.85794, 93374612048.5831, 105660306948.34058, 101582493494.77458, 92599929632.9914, 99658738836.02534, 108180000000.0, 108180000000.0, 86441899551.25392, 88288372370.37506, 105286904627.53333, 87474447352.32654, 85874410511.91689, 91089314982.2016, 97265619616.24207, 93635114779.47664, 90029070366.06479, 89877980800.38306, 89635171748.01903, 88581531523.33826, 108180000000.0, 96395722552.70624, 100673704299.74074, 91070563128.61197, 93072346546.2692, 89627436918.4263, 81180000000.0, 85543992760.01587, 83030003439.34062, 81180000000.0, 86639099889.29213, 104025579403.47371, 94028294137.94739, 103757067396.40242, 97199711470.60924, 99898410591.60907, 88448022005.80429, 98009412244.51562, 99500994626.65553, 90503664265.51071, 98266433819.94974, 98314543555.2133, 90678526957.37036, 87080011911.67664, 86707101539.26654, 94925131567.06293, 96603840468.25348, 89127527787.98438, 94513246498.37634, 98346038590.03745, 98692034618.63464, 105821029172.3311, 103651278439.21889, 87825184260.36006, 106882278341.23471, 90798691815.88443, 101865953875.09436, 94797566215.53354, 91572756780.65515, 83046614201.58218, 93168935524.14597, 84476497569.27435, 101278616344.28412, 105540696169.10007, 89099886346.22667, 96427146046.4688, 89552246447.3631, 90170458329.88312, 99838752199.45705, 94068433162.41516, 107338342459.17223, 91115088656.58972, 101520618800.01364, 95000381734.66464, 99996312127.37813, 91343731933.96231, 93993450637.25961, 93546556230.25378, 88853678229.14499, 99012197879.11101, 98925744186.40141, 98512951925.28944, 105701746977.58447, 105004621917.26498, 91817046668.13986, 96929927337.16756, 90201777503.71896, 94491114920.51349, 90354948712.28041, 106368709684.23544, 96863554480.79408, 92857609590.41797, 103005215126.73692, 81180000000.0, 81885249246.78476, 99996761572.551, 94745846719.51065, 96064965388.70323, 85851386507.96252, 94172702878.86298, 108180000000.0, 100207249695.45135, 95501227794.65341, 91396674246.24245, 91688050825.75381, 81248169674.44302, 96115420998.57977, 100365610068.92506, 84381895836.18445, 89959684982.26144, 86868862178.67438, 88047423172.57709, 94697818028.54463, 81495237963.05048, 98663507528.8124, 99686282988.41939, 92636903393.81108, 81180000000.0, 87855267977.65279, 103308981061.76302, 81180000000.0, 91997690713.82635, 86732113455.13586, 100061500989.13278, 89872228480.3392, 97149641261.48065, 98309277930.70395, 108130133328.3288, 92958536577.52649, 96951170892.42462, 84911579563.02664, 102980485343.52705, 89329718152.35773, 90606176337.3461, 94179425482.39162, 84456084667.03809, 95913163089.79051, 101279876067.05458, 96363485427.22923, 84304644551.49646, 93490446699.22243, 99599064892.02628, 82648366383.64337, 87373371057.38705, 100597332996.62817, 96202861011.4428, 97206759846.47293, 108180000000.0, 97611182548.73778, 98981546224.60078, 108180000000.0, 92885854586.10727, 89093762526.64093, 97319635631.13026, 97399594937.65123, 90826288075.16373, 87633495899.18512, 108180000000.0, 96602664752.32735, 89508499298.60178, 100892227875.83307, 93589486795.46506, 92625053736.60072, 98286206056.15659, 86057844102.34213, 96785081764.05827, 108180000000.0, 97594159173.73445, 91808709467.24232, 90953443503.0994, 91584616136.90347, 92617852285.60886, 91798222649.52892, 100895087305.45445, 83471755014.89972, 100488741440.7252, 91785859821.0307, 96957586415.6966, 87054293705.51265, 104054330310.12027, 103407702477.91403, 101220503818.68462, 84737338025.64072, 100243837403.05559, 97156058303.63759, 84209527941.10706, 94165450835.53986, 96869486181.9371, 98241368467.5789, 95553780509.72234, 96351499368.10486, 105197068631.0007, 103255785138.65446, 81180000000.0, 92196462557.54527, 93215383746.37881, 83363637651.91995, 94978087767.94022, 103431933738.88377, 87301113031.12363, 96670226936.74454, 88355016261.20517, 89892662057.07788, 105227106617.54121, 90723748139.13138, 97565748415.57458, 82686602490.9195, 108180000000.0, 98579032473.44543, 93095533209.83305, 98382331677.7029, 85355343023.24438, 102919695955.31975, 92153159595.49902, 92950988234.58188, 91053800748.54395, 90477863541.24655, 99250847058.37485, 96103259306.54472, 98936691777.14609, 94271224761.60385, 97931951977.24422, 91528866239.84879, 108180000000.0, 84426676804.11078, 103526513811.30151, 104362244323.0202, 88752691610.93486, 108180000000.0, 101491524739.22124, 101307579680.0191, 94523093856.60419, 92862977221.21848, 92915256840.22575, 97054114592.8794, 104624104441.10677, 95581989535.60059, 88382292145.41162, 100208940175.52673, 100931403025.33794, 98957957247.46957, 99624645320.62451, 92504959061.14613, 88273099066.52095, 88652289947.85683, 84034554197.09479, 95970399637.85042, 93763394248.37198, 91390571479.88094, 81180000000.0, 86325500370.83812, 102445645478.26485, 89939183710.35446, 96841526358.62926, 85468743774.96997, 104920396334.20338, 93354136128.50464, 96343115038.38168, 108180000000.0, 105537884478.1966, 92268450321.5888, 90396944114.58351, 92142842959.67508, 97908181752.24619, 93615993994.40308, 91683643657.9844, 105146027962.49377, 93555263355.21881, 108180000000.0, 94954351601.96567, 107711799897.55838, 96818330198.57413, 101245903493.92287, 89557201102.33066, 88742663153.92749, 97547794828.51797, 101439077166.68686, 94606999549.71222, 86090745128.91809, 85649530135.17094, 85252901370.89249, 83274941273.6593, 95083759960.48703, 102477850626.48445, 94239677837.87473, 81180000000.0, 93040138787.79865, 93227832164.37782, 108180000000.0, 85075848871.27237, 91713629825.5588, 107063105065.81004, 97478162072.84706, 98293734345.6109, 95119008930.68274, 96624572077.12039, 99861789888.90091, 89020687303.96756, 100608654022.86977, 85573737990.10117, 96613437125.55125, 95564077583.76813, 90248666969.50232, 94176442378.48438, 90208580308.98264, 87392149121.32031, 91957519096.14642, 87194611010.83842, 96574083140.77522, 86913706796.24155, 99377903731.68431, 86723154192.17648, 90570419174.74348, 90195346244.60342, 104027073632.93893, 96627020468.6293, 92899703858.6326, 97827757093.3026, 81369399213.65062, 94037156942.48933, 108180000000.0, 95241937739.67186, 94797060695.1236, 98183916663.28076, 100739903106.54243, 81977951728.82574, 83764027262.1973, 95784017790.44167, 89619031568.33255, 103924515985.39378, 92211446625.52441, 82330081805.84235, 86201046479.21254, 81180000000.0, 92750102045.29501, 93056069337.69197, 91492109676.83273, 102124892860.99959, 103043048792.68152, 93176834755.02162, 81217935528.05157, 98685418011.95122, 98236197168.88286, 96479465901.5515, 101385636057.75296, 86824146374.08032, 108180000000.0, 88084129272.65215, 99652108383.66673, 83735117814.55829, 88265168584.56516, 105537314635.30264, 92571666876.47594, 100324203884.3052, 95970447086.61041, 93617792466.62865, 104330380747.43965, 92733198312.23267, 83200109957.4809, 89060013180.69365, 98206057538.76471, 97089528515.33939, 84431758598.62552, 89558905913.71371, 90470971057.5929, 91879409069.12122, 85556442672.06952, 90171186760.29553, 89531815685.56168, 99816855718.60826, 100095266546.21426, 93342130101.35152, 91704683534.69604, 95294450343.0932, 88976086984.61398, 86933489184.73996, 88203299785.20764, 90129900057.05258, 86832368040.70657, 95448075102.64857, 99508366190.40048, 84315106349.04387, 94503265018.39337, 92844865807.01793, 96706360790.08391, 94242933623.59732, 85096703835.54187, 86234843042.8358, 94532699598.17828, 101743734864.39407, 81180000000.0, 96736213702.14798, 102974378939.54054, 93293561027.61372, 98198906936.96426, 89694111295.53366, 93520439294.74615, 84118808111.6453, 81180000000.0, 101093827965.0321, 87925854082.30869, 91289094771.89261, 85493921581.26169, 85354453272.89777, 93153670239.9855, 89525681290.51324, 96964853372.91107, 97496481082.0397, 96560327652.44841, 95981967945.76395, 106028506034.60841, 87417326290.05019, 93956903365.44974, 102536468277.27432, 103554511320.69545, 85284665534.71973, 92230107032.49313, 104285407324.63744, 97895087898.35764, 95679166339.6914, 92859911986.85278, 91758811777.9886, 96330295510.29967, 92628432979.89246, 94040933332.7843, 94870636853.80577, 89853360187.64969, 98068393238.26642, 108180000000.0, 83221503191.26411, 96582665275.91293, 89331734463.6146, 98395783381.68484, 94650253810.49338, 99745340435.50026, 102865569281.08421, 95659356468.05109, 102531578863.39346, 81180000000.0, 106130360842.91957, 96944196435.95866, 102116993455.36356, 86490920375.17593, 88886874818.7963, 95336154812.60362, 94214961140.81265, 96294056543.94545, 102167895517.22624, 83288655189.73041, 101327802078.17665, 94387930675.1352, 92952913804.62872, 84993546792.54611, 97858892371.01451, 81180000000.0, 98912200214.87416, 84870168441.23505, 94697655070.90387, 93521771878.22415, 102819608275.18553, 93121330881.77242, 89750957369.45436, 90956705686.12051, 103619389890.3551, 98098467922.48042, 91746791213.00975, 92734615446.40576, 84431066132.67786, 97039491952.35681, 83319526976.96053, 99671093215.76927, 95216139710.83932, 108180000000.0, 87218150588.12433, 93633319854.5848, 107818169888.1251, 102988015880.25514, 89737754227.09207, 95879575027.03082, 94344970486.83148, 96286229888.3895, 89722040193.16937, 93723616301.09792, 84251443663.40256, 95261176687.99922, 97478464947.38205, 92794870694.64746, 84152792429.5177, 101438915583.10666, 96869419147.96259, 89548288089.2953, 92440683747.85992, 84819909241.2434, 87676499829.96126, 90754452291.32953, 103274268550.73375, 90099857731.94421, 98852503056.92891, 90751185753.28922, 96047449245.66748, 93371866044.93546, 100571282123.71666, 90773866498.42545, 84399894359.73642, 85520594940.66635, 90792858267.66487, 86315012084.70242, 97194220378.4745, 91222313426.50388, 108180000000.0, 83445948121.41447, 95737544670.79865, 87048412780.10202, 91042453033.85818, 95304816281.95172, 81180000000.0, 95969542025.7037, 108180000000.0, 91302730118.69052, 96130629446.26784, 101714453524.79097, 93220071899.21045, 90475874298.32025, 81180000000.0, 98858171615.39716, 93562299412.36215, 87754907975.3341, 95202119873.52731, 90458353279.63214, 90815207370.84872, 98605478989.10637, 85779855358.75656, 101884522129.98863, 85427227172.78415, 89951478093.0076, 108180000000.0, 102495561982.3716, 95001697229.0695, 88201380653.08691, 90809727282.662, 94833972194.04253, 94588245105.25012, 93713116048.70053, 94120912025.53937, 92882039233.40253, 85165242469.9979, 90892425156.73424, 100882428809.4616, 85601491347.15846, 93048216086.76923, 88956097337.15265, 95096650718.67508, 91727059021.72882, 105227106862.23412, 97884322138.45467, 85938591213.71704, 99079097468.94313, 89240322433.64774, 90501414534.89072, 96510700051.788, 91053203941.07965, 100719321898.04044, 89241218057.40051, 90231636894.1449, 89991934712.77199, 90574652688.29472, 102279989741.76825, 98769266429.85536, 107096375017.00972, 108180000000.0, 87643833337.37463, 94814308498.07672, 86755152572.7844, 89221666454.92398, 90160215858.37843, 87481358609.28314, 87513695979.93721, 93352407156.30762, 86509982540.27765, 100340615761.95438, 88343000519.8703, 108180000000.0, 91316135336.1814, 94825312921.21634, 86037120569.35434, 107065048846.98793, 102435381617.76001, 96391529762.35164, 85729658337.83633, 95786640295.16922, 87088165740.97922, 105107742559.7414, 100095811409.9067, 94986754917.87329, 81180000000.0, 87935616737.56502, 99200182928.01642, 103154034509.82237, 102356296561.71762, 84286534400.31754, 96424197081.1646, 101643131366.66801, 83902358193.99503, 94277303432.73904, 96229188146.24805, 92306890556.39734, 82794361067.45946, 92141830725.4372, 92131204637.01593, 93326900444.96304, 90588638009.54825, 91370809328.87155, 94060482121.83249, 97424352497.20772, 92282620702.89244, 91589146018.78389, 94965468220.90335, 82406554600.88391, 97672012416.93236, 94327456279.28482, 94603136243.7251, 101229123399.31746, 82227544832.4159, 82109914256.37012, 96228917211.92438, 94282682533.69064, 95504498789.5369, 91246050498.93451, 99028811055.94174, 101017685099.6276, 97721872095.01237, 92572141834.35078, 81366657997.79562, 99799876201.2871, 103222458053.4298, 98884203252.99663, 88580701637.38275, 99097879811.73813, 100477771859.2256, 105876564311.26956, 88602780782.67291, 92801314194.73112, 99637720207.23488, 94724818674.33147, 87113190708.11343, 97225611422.6938, 98404909740.20229, 94935180588.50677, 95848939346.2232, 92586269814.35133, 105234139217.11852, 88449299153.76328, 90434912458.16272, 94406426409.59581, 100615346307.553, 84839249500.65422, 85947600655.53975, 81753864831.38756, 94555130276.22772, 87107224086.9856, 91753887863.9707, 99007056020.64485, 90086799678.47325, 95930737821.66994, 92316347827.90677, 99085583421.64046, 97658331651.82068, 89765000108.37961, 93188500892.0795, 101857369361.05684, 97074358960.42354, 85431519979.35439, 98964959979.64926, 87313090416.25925, 104713433764.83556, 101708211728.54623, 96342024531.30453, 95414546844.17818, 92917776267.7328, 99132506442.11098, 91844462119.22281, 95960747393.28812, 100562900054.85194, 90599383269.98706, 90249311099.84357, 86645112369.2814, 87436463557.09808, 82929048364.80374, 99509198875.01283, 107905432463.52313, 104814631034.03944, 84088849999.9926, 99472591544.54695, 104789172223.93478, 91280729624.29326, 95028232393.92029, 81919833169.3331, 96179266475.78838, 87442063077.4739, 95709652941.0948, 84465887143.32611, 98145841871.76822, 101711350834.49475, 89186480415.31, 86993784332.42606, 81180000000.0, 92534981510.42435, 90471791811.87527, 84525291528.4808, 97499918737.7663, 91325366425.76459, 87367429195.4592, 90646094034.89552, 102067139545.20639, 98581099877.12448, 93448503894.95316, 98698689466.9375, 86847923583.9339, 94552900863.58673, 95345756143.94125, 91195801393.8482, 97374352313.95778, 89203814901.85411, 97907623579.28604, 98210879619.36617, 81180000000.0, 102979653239.84872, 81180000000.0, 90250233607.43411, 101717687763.14334, 92197467245.95467, 85022558137.66827, 87257261203.53519, 101729505813.07393, 82403246285.32706, 102508106170.13658, 93955766805.26593, 86657037233.30374, 90461993964.0611, 87726921809.0533, 100520272576.67415, 99528333904.53392, 83552296037.29655, 91628862763.03308, 88683628764.35275, 103780032862.772, 85710017409.0203, 106241139345.66528, 94104138926.28268, 86841714769.22636, 89858446404.7092, 89070224569.88478, 86161386889.69102, 94982530314.11618, 86442408188.8984, 81180000000.0, 91785925931.7718, 83074144601.01117, 89382544838.23804, 88396874238.85892, 88633381864.42168, 108180000000.0, 94717954817.86702, 96029392302.22615, 83224859034.3956, 90007328903.32549, 95819017333.38242, 87681925830.5003, 100833228360.54823, 86594712542.16035, 92402399183.4241, 90443083439.98422, 95463787257.68243, 90093539566.82535, 92505188457.31192, 92736726000.32193, 89495164118.36633, 97729853115.67596, 95980480531.73653, 93728401018.74182, 91452877453.82458, 100001989330.75346, 92738699970.89186, 92267578104.21016, 95050627430.36676, 106987805816.45767, 85768084622.32445, 99804463835.45758, 82562722082.82382, 95832784531.92905, 106006958988.8632, 97755524995.05266, 95507615122.50638, 90608143269.10324, 94543830359.99239, 92630506684.60385, 89168833182.04707, 92379106998.52695, 95700908194.60568, 89287300508.84076, 89040859512.92355, 85649618973.4498, 97055497304.6829, 98163648252.78012, 95933385771.88786, 101262564142.75725, 94934523693.65915, 97064642913.69408, 96440303202.60977, 93708585448.12946, 90799693338.07446, 108180000000.0]
thresholds = [85927678602.17607, 94241755133.22368, 103682131594.13431]
display_name = "Total Global Research Funding (Baseline + 1% treaty Funding)"
units = "USD"

# Calculate exceedance probabilities (1 - CDF)
sorted_samples = np.sort(samples)
exceedance = 1 - np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

# Create figure
fig, ax = plt.subplots(figsize=(10, 6))

# Plot exceedance curve
ax.plot(sorted_samples, exceedance * 100, color=COLOR_BLACK, linewidth=2.5)
ax.fill_between(sorted_samples, 0, exceedance * 100, alpha=0.1, color=COLOR_BLACK)

# Annotate thresholds
for thresh in thresholds:
    exceed_pct = (np.array(samples) >= thresh).sum() / len(samples) * 100
    ax.axvline(thresh, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
    ax.axhline(exceed_pct, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.3)
    
    # Add label
    ax.annotate(f'{exceed_pct:.0f}% chance\nâ‰¥ {thresh:,.2g}',
                xy=(thresh, exceed_pct), xytext=(thresh * 1.05, exceed_pct + 5),
                fontsize=10, ha='left', weight='bold',
                bbox=dict(boxstyle='round,pad=0.3', facecolor=COLOR_WHITE, edgecolor=COLOR_BLACK, alpha=0.9))

ax.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=12)
ax.set_ylabel('Probability of Exceeding Value (%)', fontsize=12)
ax.set_title(f'Exceedance Probability: {display_name}', fontsize=14, weight='bold', pad=15)
ax.set_ylim(0, 100)
ax.set_xlim(left=min(sorted_samples) * 0.95)

clean_spines(ax)
add_watermark(fig)

# Save PNG
project_root = Path.cwd()
while project_root.name != 'decentralized-institutes-of-health' and project_root.parent != project_root:
    project_root = project_root.parent

output_path = project_root / 'knowledge' / 'figures' / 'exceedance-total_research_funding_with_treaty.png'
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Exceedance: {display_name}',
    description=f'Probability of {display_name} exceeding various thresholds'
)

plt.show()
```

*This exceedance probability chart shows the likelihood that Total Global Research Funding (Baseline + 1% treaty Funding) will exceed any given threshold. Higher curves indicate more favorable outcomes with greater certainty.*
