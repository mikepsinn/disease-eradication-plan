```{python}
#| echo: false
#| fig-cap: "Probability of Exceeding Threshold: Total Global Research Funding (Baseline + 1% treaty Funding)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Monte Carlo samples
samples = [97146297812.8866, 84866832422.50783, 101628540773.9514, 103602671455.74832, 79517520199.46948, 83276171337.81139, 95422935904.02017, 91229649108.92828, 94036399145.76273, 86406119404.04439, 102963369555.01779, 101910112773.4116, 94827942553.15002, 105214691549.02228, 98759925713.536, 86351500601.64624, 97777842054.51031, 85485623588.55043, 102953495769.72841, 93721710795.19449, 92450647578.0274, 87924240028.80531, 105948747869.45273, 92734864253.50008, 90200727650.44664, 90898905664.1933, 99409667880.22015, 97745128606.30634, 98213997988.28206, 98393939857.09995, 110900000000.0, 90400966324.17813, 89438008524.78177, 86750183001.21289, 100254949482.2093, 105227961974.17024, 93116481643.99043, 86518878481.25171, 86656227953.0384, 100606730650.3902, 101554550769.11952, 99518827394.50304, 88061544504.26672, 96435631810.4851, 95315283998.50632, 96304243224.24556, 102880368200.40334, 96352076012.07791, 100895477249.13089, 94842802104.98303, 96993081683.83821, 100410383325.10211, 82355743355.68805, 91198001623.31952, 89817764223.71062, 88299190556.14339, 91609876722.97293, 108086618951.97691, 86294382835.56694, 103893633873.79333, 81040898578.11224, 91057704813.81934, 95760661126.58447, 99953506925.9678, 101225939448.53198, 102070659031.91052, 90930263974.05927, 89890696148.64333, 102740404416.66608, 92390399156.48367, 83434976581.18442, 84295919266.35928, 85827403478.29556, 99056708893.59113, 95563881002.70494, 101013696685.1183, 90210542224.2694, 95719840001.07523, 100352503774.86877, 91293335526.068, 98652706597.65784, 88093486508.23431, 90798510760.8831, 90626997512.85527, 83916191154.099, 98954633328.26523, 89826583928.23227, 94315587507.41798, 98892309001.46558, 98550490910.60109, 100757443629.64166, 93262292791.63354, 90246647932.36172, 93439580751.84396, 81015194141.68863, 82414953401.57147, 83153463809.61928, 85154390975.23227, 98085291382.71304, 85948850376.32019, 90659792839.57721, 106544626489.87585, 90860919912.67792, 101495592876.72389, 85704461587.64249, 92258355681.19727, 85562307572.90718, 91019490354.25107, 102556878639.88956, 80785502482.4701, 98429817990.29483, 96490045656.69466, 88699758317.17056, 82421174360.8272, 94886485630.02887, 89282021070.97281, 96440656653.79895, 94404945478.94836, 108941425964.58165, 91942236568.1221, 84968277325.48346, 95920907533.2196, 96316992088.49696, 107013777010.54298, 102502957743.85605, 97660366650.72147, 107835258773.13083, 83959028829.58118, 88291384176.23666, 85765555023.70348, 90553000372.8169, 82831852801.08868, 100449640492.20218, 92101781219.13972, 82275364645.34186, 85017061185.22705, 97232815248.35785, 102534240081.16931, 110900000000.0, 110900000000.0, 98230665026.72118, 85220843925.8171, 78512497592.31647, 96783184768.97319, 86757483915.55162, 90319198687.92737, 88538814663.15355, 92863881155.48422, 104746569914.54181, 95705397472.0681, 92696346334.9225, 84893461333.50198, 81088063018.83696, 89673043995.09247, 93685140860.22073, 110289405435.74585, 95446443501.18962, 104045784280.55484, 89555265364.90625, 83982161457.90645, 85431710960.27148, 87530995658.19359, 110900000000.0, 86683368603.36562, 102538002875.32352, 85971048307.57841, 103508443762.27437, 97938269092.73822, 92715080340.31776, 93808658310.14954, 88157144012.72705, 98545913722.65253, 89957746779.52673, 83736341378.81836, 83421465495.94754, 95856013510.78035, 108759124157.47289, 95733904935.3341, 93072290408.05362, 96960762889.0855, 106597481876.17769, 96311005939.12085, 90359697507.87169, 105054255926.9739, 98373385077.39632, 108412080338.05975, 95959342327.95041, 83743199622.48819, 82882532481.43942, 109337799619.1886, 109928060672.50685, 92500649181.83463, 90613705811.29831, 107820517774.88133, 84455941205.12715, 86042417584.25502, 100532782975.51979, 90509069133.18915, 94147605325.18901, 92651255712.64322, 97469849425.15125, 107393742178.80666, 95063861089.78535, 100539009328.25653, 78964792544.89967, 93733163730.03168, 86491970891.47424, 83777335583.3883, 86186854405.34253, 91064722806.05519, 103344431368.2905, 83131406724.54164, 94488854725.48415, 89692451571.83902, 91124183995.04762, 104256771117.50087, 99468094910.7583, 106842954373.1646, 92735087626.78354, 87790763303.2733, 92086533453.85071, 96536546759.21158, 95894680802.65024, 84594452471.53088, 95062945987.93298, 96397257999.5004, 110900000000.0, 110900000000.0, 86404375702.76767, 91496466301.29843, 82318714272.63953, 88730667353.22145, 97253393393.99646, 105819694736.04509, 87496831478.24371, 88162864856.42778, 78460000000.0, 92658540826.36069, 84729088032.16579, 89282502465.5112, 86198119901.80042, 93302156002.56839, 80611454532.50406, 82297499857.6465, 110900000000.0, 83364574359.31161, 84518624047.89575, 110855799280.19336, 110900000000.0, 84063254922.86552, 90750788847.33939, 97509123977.29504, 109969056139.73824, 85243968011.2555, 91887152207.27612, 101905427128.06874, 98433228887.05823, 90678202794.5734, 92929384362.39595, 82842489984.76651, 91953233579.46037, 91691073324.15027, 96435715410.20488, 89048914485.12212, 98800201823.47934, 104341918836.45009, 95689716520.7776, 97609832723.17343, 94704469405.66167, 94197219907.99184, 87563491866.57214, 97262145510.57365, 93273608189.59549, 110900000000.0, 108713097502.52971, 97947145573.91003, 87196540835.90979, 84423185628.3782, 105706112591.89091, 96734596751.80942, 98886272127.32912, 80686612429.12712, 103465145108.77849, 98629199929.45238, 84435275304.61766, 89807292811.19452, 96744072857.65916, 94697870827.64503, 91452146673.73187, 93215090037.49736, 91824877599.72556, 95661960167.212, 107900241581.98096, 78460000000.0, 91965549652.87425, 95894089465.32486, 97060581032.03346, 90717131775.02133, 80617207505.13853, 97375412036.26407, 109958076463.97878, 81905520244.5487, 102801266519.06728, 91116326596.2164, 93613668299.07806, 84787486729.54008, 91061656640.48285, 106550994389.38565, 99917432819.82372, 109998512313.86127, 105600247376.10924, 98476275857.30934, 110093320299.46782, 98475343899.27179, 102429097648.49832, 91411438113.3081, 94832885827.24881, 87777605278.24414, 104117874302.59564, 84022400830.34149, 101957133917.37833, 92396507047.92819, 105552765482.52318, 101632837607.0476, 110721876593.21765, 101426381424.19337, 81682736339.12619, 93560360213.72218, 84060582425.32524, 89383385371.85423, 108216332423.31635, 100473865400.52475, 87764223697.4802, 85028536573.11417, 94509420614.38245, 83790938240.9369, 88011382790.26784, 97218014041.57608, 105430169960.22958, 100181747448.38396, 78460000000.0, 97142853659.36658, 94885564465.78072, 98225504570.45705, 109057600821.11458, 78892358498.95023, 88727108019.71503, 100000896085.81895, 81627120620.2693, 107935632570.8519, 97773941933.9408, 102622032180.29086, 88908301499.9555, 102281761198.02832, 104765550328.43399, 96442626196.14708, 96457489889.08968, 96808963860.99832, 86316093291.8367, 92800585222.1537, 92753700002.2194, 97922838009.46628, 104225825372.53818, 84752882356.47578, 93012307537.02513, 107979378592.57068, 87368500850.23172, 86675795836.86655, 96144720071.73001, 102599200389.30821, 94305394160.26697, 106776908550.64098, 102728117059.89981, 102572571149.32727, 99629287892.08008, 110900000000.0, 92260931253.60709, 79224189126.29675, 108961342577.06058, 89933026183.20953, 95230390065.2257, 106625189984.61952, 81507011394.40971, 83579442640.88962, 81512710926.17926, 86922735642.28487, 98481756231.65027, 99328002169.70267, 96867084483.11745, 82617899992.95088, 78460000000.0, 94715953581.90703, 89805009689.17323, 98678771567.72194, 101130995230.04965, 95523424773.57083, 101728161828.61719, 96406848027.64676, 99387091371.84885, 87713234883.24585, 92499786132.85623, 96090930624.82852, 102351804023.63687, 90516982447.56708, 99297645201.26923, 91696164656.3522, 93082615106.11652, 102444966911.56296, 79282531974.55078, 83310345089.57874, 82208445847.6015, 78460000000.0, 87947955882.85364, 101618079050.48196, 91519610150.43568, 96100791077.96783, 104923792423.8946, 106766937483.86565, 93539677498.10391, 106969825357.7972, 95078693914.88037, 86543030999.48793, 88697510800.72229, 82218137891.4866, 86099843518.08047, 90844805704.88412, 102176461203.68668, 109904477154.41695, 82799214533.82088, 98016363537.70825, 84863390663.83554, 98831786666.24258, 92955120208.25006, 80194805643.11255, 103474134317.63373, 88602415988.30434, 89242208494.2769, 84684093636.35304, 88161644062.12006, 98364764492.55592, 92409660877.55869, 97381980097.89609, 97710295342.80551, 106712002801.71152, 90984928441.40588, 82239766901.82452, 104756033031.43298, 91089010797.24254, 105117797631.287, 97922672016.37758, 92954641606.2343, 97580396615.43777, 110900000000.0, 110900000000.0, 94860099259.25781, 95735832635.20856, 104824767118.25699, 86470698236.85347, 97425432577.83546, 93950207364.39427, 97236695677.49112, 86578326534.88188, 81580749745.21375, 78838397618.27911, 84392846003.60547, 89924145614.46622, 91442703867.76541, 110900000000.0, 105051996918.59634, 85457872303.91977, 97569856525.213, 90394899317.76434, 91524428279.2361, 95979651480.97572, 100287335631.6142, 91017414210.85272, 104730356024.81213, 84243258641.8168, 94256860195.06827, 110900000000.0, 96347046835.42133, 107596962994.67374, 95072858836.279, 99898444286.41545, 93656697636.30147, 92585978915.94409, 87051728436.35117, 98388765882.75122, 86419295059.22633, 100759484193.49109, 104893786473.21785, 97755884504.32819, 91506972401.62688, 98624661159.24896, 91299557669.01477, 103550079519.66113, 80191967997.92685, 91051049018.01382, 79295078573.10822, 82132820756.92587, 107050474225.9316, 103127993321.01218, 87581905087.26671, 82089150957.53949, 78460000000.0, 89155597196.58063, 110900000000.0, 98434406254.89328, 89010669214.01468, 98735651781.28764, 81747313089.37985, 91404478311.97992, 95149446186.52583, 93379250245.17598, 102044414923.21985, 97539616057.63608, 100787434260.6827, 87858043507.40002, 103155448456.40082, 109160203180.29163, 85388212803.19415, 86103661545.38104, 106830317971.34804, 92390028341.15485, 107364877229.79668, 90071133407.43704, 107769789329.89845, 95458143793.51132, 96690356223.38731, 108643848622.91974, 90810303563.65227, 85639401913.38657, 90016202044.67656, 98608378232.88873, 81719329272.08882, 100473225781.4101, 89198229391.3353, 105372542680.54794, 78460000000.0, 86989352194.52126, 81020180684.94632, 86640898667.17795, 96587057277.45451, 92503388021.78955, 91811867647.24496, 92691186930.25925, 96155248332.17299, 85060485088.53511, 101181113601.42311, 100729722498.06985, 97939131063.95233, 99653658597.10374, 97064745795.5689, 110900000000.0, 93369862433.99478, 91314247438.69695, 87280669071.93948, 84914322521.35289, 83622632813.15448, 86094063105.66809, 93525078206.57608, 97437508208.46432, 94685176733.76431, 87174677569.26913, 103180182828.33243, 101515079763.59029, 92686840053.56813, 88173841753.80058, 99571951844.49336, 96005373537.1054, 82408968027.19887, 93550636448.16678, 96727613334.63843, 85999174037.53432, 96023540968.88052, 82369494014.88455, 106833463729.91016, 106145665026.3869, 91819860348.33862, 97725449474.62943, 78460000000.0, 84155648095.84851, 91437269116.16045, 84669503671.89474, 101258415993.60173, 110900000000.0, 84032639951.89842, 86542460173.74188, 96467714895.03242, 109016575925.05841, 83755839766.8576, 96600450973.8512, 110727245683.60226, 81220336648.95175, 83402675869.32678, 90243832479.45378, 89362506493.3036, 102269730471.89474, 96528369710.28093, 80513052013.31781, 99239814391.18704, 88848983728.32152, 106351561871.36667, 88400131723.65121, 88319409807.1318, 99498459556.33612, 101756922419.8823, 98566131488.40543, 81025193868.77753, 99467279618.85951, 84901738927.6424, 96466033324.60751, 82553012065.70398, 98548406318.38023, 86813182293.41406, 83393285537.92221, 101252510390.43277, 96528221251.49823, 88521972091.62973, 107739150273.9827, 90088300728.29851, 94502970759.21268, 96794957745.73044, 88471023786.03072, 98796180360.67618, 89246253420.41014, 90353195568.65594, 107040898453.87543, 84863131765.9392, 78460000000.0, 109015133354.42952, 110900000000.0, 90411448388.89523, 79597132441.40776, 91282828012.86891, 91507211160.23747, 92403306820.55338, 84417226060.63968, 99886152622.96608, 99331214021.07945, 82136666805.41736, 101102785027.45203, 110900000000.0, 95849926013.5788, 91035222809.17198, 92852489164.22882, 100247618142.12567, 80766294694.0213, 95776532021.41537, 90547006303.1349, 110900000000.0, 92550709011.3811, 109475035602.1122, 84476125454.57826, 99963994924.00949, 97290752002.6767, 86266302490.0083, 95902665238.18683, 105871213363.61844, 91159982500.16255, 80988560407.84846, 94029151361.03467, 85975433838.51886, 90989027696.00499, 93421904569.95386, 80909855209.95801, 81429270245.77368, 98905521505.34523, 89343244383.87115, 78460000000.0, 101982866197.01027, 96828818909.20923, 87631598879.39998, 83188535892.72688, 102510184267.61137, 97586072048.93594, 110900000000.0, 98288129647.34454, 97965549458.80907, 92618586348.39038, 102312943464.42159, 100347373551.48676, 106174964953.7688, 89355864592.70465, 90136128829.84619, 89738446823.6792, 102044369481.48108, 108113943106.58284, 89922642256.19571, 90233174713.1867, 97238358758.73856, 91882655051.24672, 103723193507.6939, 78460000000.0, 86636729076.38295, 87025886755.26476, 78460000000.0, 85444492281.99109, 85864724917.09462, 92298816905.85455, 105105346719.4703, 91889171818.78195, 84923238338.78854, 93655073693.41919, 104618652721.74977, 85338030552.28113, 85904540609.44258, 99673986179.88104, 92108180544.0292, 100575092179.41579, 94066420973.19998, 101128027629.01755, 84897002028.63153, 94081292274.17569, 92209331331.72232, 83794979499.49231, 81732624442.82874, 100965292888.7525, 90909771294.99533, 84975773778.85054, 93284063806.3222, 105220652692.46005, 78460000000.0, 82123559861.20755, 85797582146.94322, 107818412848.37015, 96928985540.61221, 101802145751.08838, 84254073718.75662, 84379722193.67912, 98563282354.4446, 94753540609.59442, 99575084579.30826, 92424375070.50284, 96885412461.1554, 95715765928.49509, 101909859630.25568, 102211863303.65448, 81404844107.48477, 78460000000.0, 104246090177.86374, 105679747381.95848, 84985981874.2352, 80030943842.67029, 95145184130.40842, 103500747426.65263, 110532481113.68294, 99248724306.61859, 90718948396.4922, 86056318560.29834, 94305634995.13852, 91386523310.79291, 85020211793.39722, 110900000000.0, 110430570532.33612, 105282233586.5768, 85815261382.14099, 102709669965.0727, 100495144201.60579, 98510751528.84608, 106158976829.52892, 100451878826.04263, 101521259758.44623, 100467485201.50946, 97501584102.65067, 80463731698.58224, 94996892569.17667, 89041122412.03482, 83410044584.66548, 109587925012.35931, 109971482153.62433, 107014036204.30873, 96660856121.48108, 106946604850.41759, 94311379162.66891, 96149498152.83289, 84538885785.21674, 98057672565.96861, 94773790050.10565, 83273342308.27899, 93709655271.28122, 93439473402.61874, 110532207379.64275, 103117853514.49344, 94305579142.37292, 96598018732.78255, 94618801977.79886, 92281918982.81586, 84606454782.30646, 92767504912.8649, 87346311968.67352, 83587455847.909, 99197758846.32077, 98000863555.39801, 80446085493.73615, 93034188196.40112, 104182349644.30426, 104695119113.23099, 104441396054.73415, 94568076174.40472, 86476086041.18787, 84598670994.65343, 97539218062.51135, 97882081109.94678, 106451877036.88731, 105006013729.07782, 92944378436.9178, 83624233971.47299, 91203212516.39723, 96290041098.6514, 92289677143.72531, 88845789979.93271, 96638081275.00742, 89513024550.59695, 88395850924.79042, 97212537987.48178, 90441432317.90079, 96552252743.88774, 96836993935.24988, 84258528076.16734, 89719034040.13016, 107633049905.24234, 84120833665.07071, 78597238786.56319, 80019578226.76202, 94474307097.75813, 94491587393.67229, 93081968100.6407, 105884134737.2106, 78460000000.0, 98047180252.49203, 108617567589.41016, 84329462396.95248, 90644711923.84021, 87286283637.6655, 86045734784.12402, 91137197006.7854, 107551671000.16483, 110859697828.85547, 91047991372.31601, 110900000000.0, 94536149605.18869, 110172990553.85674, 93311257364.896, 95454009528.85556, 97745429386.18106, 110900000000.0, 102670869461.40485, 87690237540.86716, 103901198863.31622, 90809733266.05476, 89641812716.93228, 103268103529.1918, 94493196801.203, 96889649880.87222, 94329820092.91539, 97460071016.35509, 98335657676.04984, 79596409145.72762, 100769552981.33138, 85285708877.84236, 82443351646.07202, 93641268902.59851, 95000352684.25769, 87812411248.2808, 102460651484.44307, 83037239357.7821, 90396129550.88312, 88783056654.56189, 93753380419.05548, 96892477330.2478, 85064451629.37836, 101359769779.43024, 94798886746.71346, 79849626914.69725, 79475194477.66315, 94079058373.21048, 92113482397.88544, 93215732934.88062, 93930057757.9975, 96371230504.47414, 103676977339.35344, 84431159971.23766, 84060798371.66626, 84539787776.7629, 96991091842.48294, 106122368267.68433, 90173242270.07574, 78460000000.0, 80919389463.36508, 86581236046.8927, 89027275007.47763, 90382913315.36314, 94564898238.94412, 91271167935.52316, 104619915015.90318, 87967957337.43495, 86325066971.9115, 98873585602.6088, 81895110325.95895, 97985265417.13739, 95179065809.83151, 92801394635.59198, 108832876420.80093, 88448273083.09824, 110900000000.0, 92071879737.13768, 83426993362.39005, 94865268152.11934, 84644309826.32748, 87296318997.57552, 98058089288.22061, 99644065112.80342, 88448628821.50946, 104094920423.56284, 105447050822.25568, 107621379998.02344, 99380541127.99722, 107047070268.06767, 79912507023.7197, 91214288796.84547, 86284130246.53767, 95339787109.22789, 88903753089.15057, 92625804312.93716, 110900000000.0, 92592423161.64838, 98224530773.33556, 92008191784.9566, 94920903546.89268, 94253785256.65585, 98568372794.1409, 105507046562.42137, 109309233192.92706, 97194510020.57973, 99987139996.62997, 84188970963.20953, 93362468543.94908, 103599785711.57033, 102823537994.31696, 96235280557.37927, 103036289838.5827, 98992635161.7614, 105776843168.81973, 96995435001.1445, 90866121071.46043, 97452754588.7573, 78460000000.0, 97917802920.65399, 78460000000.0, 80807617639.65378, 98602736922.20526, 98860117009.13504, 84118712922.51453, 87647321043.41974, 107102934465.09335, 89693715940.27794, 110900000000.0, 94178116759.41316, 98167332072.79073, 109062956225.79724, 95453712887.61044, 85110479406.83237, 93156254958.37343, 93857576905.10173, 82902856926.9663, 91789065945.60886, 87380845252.66054, 103432894168.29553, 94526922081.11554, 91538952771.78659, 93189684424.7392, 96347459019.87518, 100263418962.26965, 85133148912.70863, 84856974735.41766, 105041945989.61493, 90346808758.58948, 82593777436.04935, 98523383720.6853, 98718563574.82411, 81923917502.44113, 96409485494.16875, 101475746495.91548, 97833621068.54993, 100417427835.34375, 82668215224.74734, 97405418695.17566, 91355501517.68799, 89704971303.81009, 102871277981.05609, 107962048556.30153, 110506023838.99342, 106666253474.35535, 93156191515.58942, 97619352840.9375, 101797052916.07843, 95358622592.44327, 95451173174.55008, 102385209110.65756, 93633011824.4609, 87495033220.00801, 90327280440.8972, 100437030808.47621, 94224952492.91643, 97495847454.23369, 100805317434.01996, 90690266664.56067, 101688176500.30115, 97877748353.85272, 83680820082.22174, 107668879857.274, 89542133415.02498, 81201067126.34578, 84835733953.1857, 84983381484.08308, 94695058461.58928, 91621852578.32434, 91039766377.59445, 100292723170.51703, 97492546145.79492, 97257752012.2716, 98185138370.98546, 100256524516.80515, 78645202326.41624, 90785791256.15091, 78460000000.0, 94540774691.99254, 94152263276.88309, 104590966806.90628, 105679047847.16628, 96149281870.97528, 89545609958.10275, 98936496361.40405, 89296252774.46286, 94183141321.75252, 104081555458.67099, 89026892495.92682, 102198111179.79333, 100880038633.27571, 85521018911.13693, 103952692761.787, 101096335641.08151, 95173024089.55843, 87203015564.39087, 86352255980.6702, 89208237879.55705, 99513189830.09209, 85513807196.71118, 98460587341.14813, 83638990690.70526, 92271137418.93451, 95247422918.7456, 110900000000.0, 82828113081.06732, 107904390356.1265, 95635631768.3931, 98198487764.9111, 95331317101.4831, 98532497924.3938, 92742788493.62706, 107761900898.21051, 89944205213.69467, 105252976816.71375, 88250155308.7164, 93623828902.71933, 84670548302.80081, 98635222372.23116, 107691212755.66342, 93461917911.11209, 92338231125.69986, 84409727348.47069, 92035911101.94315, 81561993823.55829, 85884521932.20895, 96383189608.46608, 106699116782.26175, 110900000000.0, 88767686169.68929, 107613457521.84294, 96548814432.24734, 92765667126.22469, 98411599720.52884, 94788470215.34825, 95254632576.97372, 90383420610.20993, 82704716649.80283, 81848463437.77151, 100633735181.72624, 91595435983.45464, 88682356172.6289, 94277527889.35431, 102087032193.92491, 95931472047.15945, 88145839641.25197, 105977790889.17908, 108759880585.97647, 99030608679.7114, 103950266793.6532, 106099196698.39427, 105236602943.47844, 100235875512.00908, 100076222031.01488, 99282506477.79095, 84515249418.0405, 101118403355.09398, 82955983979.38211, 86918661689.40923, 106578463520.71092, 102555965612.46361, 108026617828.55695, 91642031081.41725, 84180556178.29762, 91932174095.00862, 95174039303.68192, 94952371033.52908, 105264066544.78868, 90814898930.56772, 97612579381.32144, 85228700378.00363, 98588256454.8367, 94226051506.58319, 87313480641.92635, 91975051122.38051, 92457071478.15703, 91656121290.31958, 110317320978.2226, 93262665413.03163, 91900001200.53822, 78703151736.98991, 86046942450.51802, 91721828615.96208, 87880447575.84119, 107190725477.72234, 92637241034.72638, 106460550202.44383, 94786438145.55696, 94551948829.69453, 93353779733.66318, 94232609121.00043, 109888398553.95724, 78460000000.0, 79235206952.64632, 89158526504.17758, 94335000318.58234, 101009802840.72159, 98815686916.4331, 90603999424.82324, 104389877119.97794, 104474469938.98383, 95967338342.41774, 103834555914.5044, 96831518549.88013, 88993460054.87234, 101088668091.06668, 95256728158.63922, 94209188035.1013, 107911845505.03291, 78460000000.0, 82588795360.33467, 83969279613.70334, 90796610622.00638, 91800434971.29791, 82060874277.27783, 85258625596.70396, 86337964162.08759, 110900000000.0, 110566524170.95009, 90352179797.75893, 90793646179.98491, 84199066096.17276, 79758465875.79381, 93088850846.14766, 85149176422.42868, 93391064032.07877, 81518936490.70844, 87206095355.98721, 95623870786.88438, 97752701070.81104, 98261112791.72302, 83166670761.54294, 102706202713.5097, 86869312159.92346, 100426334356.69148, 94095059783.26207, 82833627066.88179, 91230063512.64055, 97744334112.27258, 100224375574.56944, 92862029789.15947, 108380306948.34058, 104302493494.77458, 91781430622.57947, 101625153322.75557, 110900000000.0, 110900000000.0, 83721899551.25392, 85765926747.98067, 108006904627.53333, 84754447352.32654, 83154410511.91689, 89674076476.43633, 98288508709.77484, 93225387206.94255, 88194835166.8001, 87984025315.24438, 87645236551.34695, 86175017682.71106, 110900000000.0, 97075483082.64534, 103040096698.9566, 89647915310.52438, 92440410243.74405, 87634444107.95682, 78460000000.0, 82823992760.01587, 80310003439.34062, 78460000000.0, 83919099889.29213, 106745579403.47371, 93773790982.91928, 106477067396.40242, 98196606253.40077, 101959284995.16153, 85988712287.1081, 99325621098.35007, 101405235256.02463, 88857000462.61429, 99683986625.17932, 99751065282.52553, 89100966206.73563, 84360011911.67664, 83987101539.26654, 95024625650.19012, 97365700321.2354, 86936902566.48138, 94450174078.99323, 99794978182.5833, 100277386368.10703, 108541029172.3311, 106371278439.21889, 85119545167.85254, 109602278341.23471, 89268616177.30875, 104585953875.09436, 94846713766.75528, 90348522960.87726, 80326614201.58218, 92575140002.70076, 81756497569.27435, 103883340301.88365, 108260696169.10007, 86898332525.54636, 97119302976.84474, 87529530104.16884, 88392106133.49362, 101876114496.82202, 93829775585.26137, 110058342459.17223, 89710033884.31982, 104220679349.59448, 95129574102.13333, 102095769898.76932, 90029015468.72623, 93725192250.93953, 93101863853.6451, 86554776795.53201, 100723765275.53403, 100603230674.12851, 100027700298.64561, 108421746977.58447, 107724621917.26498, 90689319315.58353, 97820413611.64322, 88435803742.24045, 94419306851.81485, 88649511817.31303, 109088709684.23544, 97727860657.48834, 92140874580.2656, 105725215126.73692, 78460000000.0, 79165249246.78476, 102096396469.61377, 94774581471.36429, 96614237180.73404, 83131386507.96252, 93975206701.46349, 110900000000.0, 102389835258.8723, 95828067751.52974, 90102874686.54068, 90509364705.33586, 78528169674.44302, 96684599101.48448, 102610600285.02695, 81661895836.18445, 88098024584.73073, 84148862178.67438, 85429684265.89384, 94707596400.13358, 78775237963.05048, 100237612705.0793, 101663553547.91833, 91833006698.44736, 78460000000.0, 85161528005.63092, 106028981061.76302, 78460000000.0, 90941321935.13245, 84012113455.13586, 102186649366.41998, 87975999252.86821, 98126787923.4393, 99743723516.42532, 110850133328.3288, 92281657890.03264, 97850036366.34395, 82191579563.02664, 105700485343.52705, 87219030004.23491, 89000024191.89078, 93984583068.874, 81736084667.03809, 96402542392.41843, 103885096307.03105, 97030528466.9841, 81584644551.49646, 93023600602.60574, 101541959597.60612, 79928366383.64337, 84653371057.38705, 102933632811.74387, 96806536238.56561, 98206434546.71748, 110900000000.0, 98770354436.26297, 100681030526.28111, 110900000000.0, 92180273718.97888, 86889787517.75536, 98363828391.3927, 98475322679.73978, 89307117298.31567, 84913495899.18512, 110900000000.0, 97364060817.19366, 87468488949.17094, 103344721683.02884, 93161744437.5292, 91816477188.20117, 99711554778.22296, 83337844102.34213, 97618434535.9687, 110900000000.0, 98746617710.29393, 90677688631.88309, 89484517899.62093, 90365067511.57935, 91806431618.65804, 90663059146.34688, 103348707735.03358, 80751755014.89972, 102782251852.97661, 90645812541.5292, 97858982385.86879, 84334293705.51265, 106774330310.12027, 106127702477.91403, 103802333491.1313, 82017338025.64072, 102440841226.4498, 98135735917.8842, 81489527941.10706, 93965091890.68661, 97736132077.97096, 99649038292.10191, 95901357534.0239, 97013813898.21725, 107917068631.0007, 105975785138.65446, 78460000000.0, 91218608679.35506, 92639929171.25282, 80643637651.91995, 95098481651.13177, 106151933738.88377, 84581113031.12363, 97458274201.50462, 85858926389.02716, 88004509671.6176, 107947106617.54121, 89164057488.83118, 98707002792.24954, 79966602490.9195, 110900000000.0, 100119833522.03676, 92472752892.54208, 99845580776.5811, 82635343023.24438, 105639695955.31975, 91158201449.92258, 92271128729.48108, 89624529670.76108, 88821003366.84485, 101056488110.17862, 96667639269.37178, 100618493959.6005, 94112619803.962, 99217616710.03105, 90287292736.04514, 110900000000.0, 81706676804.11078, 106246513811.30151, 107082244323.0202, 86413859095.53117, 110900000000.0, 104180124043.67407, 103923714036.77531, 94463908311.53998, 92148361932.72505, 92221287024.07332, 97993583935.44524, 107344104441.10677, 95940697585.10455, 85896988939.47517, 102392191916.16055, 103399331863.23262, 100648142540.90915, 101577622297.61447, 91648951882.29135, 85744613209.32074, 86273756355.56665, 81314554197.09479, 96482361511.71286, 93404312502.23973, 90094360804.09306, 78460000000.0, 83605500370.83812, 105165645478.26485, 88069419884.92894, 97697143657.04396, 82748743774.96997, 107640396334.20338, 92833468989.57307, 97002121934.20862, 110900000000.0, 108257884478.1966, 91319030439.25648, 88708104280.49454, 91143809805.41519, 99184473280.05058, 93198717206.62827, 90503216485.6586, 107866027962.49377, 93114008778.39374, 110900000000.0, 95065377762.64667, 110431799897.55838, 97664797833.1328, 103837739786.4072, 87536443404.91089, 86399865218.90211, 98681968923.24142, 104107015173.52408, 94580932162.87303, 83370745128.91809, 82929530135.17094, 82532901370.89249, 80554941273.6593, 95245857671.73798, 105197850626.48445, 94068619949.82742, 78460000000.0, 92395484129.87117, 92657293035.50208, 110900000000.0, 82355848871.27237, 90545048643.91028, 109783105065.81004, 98584875045.23087, 99722051355.82018, 95295017459.83266, 97394609963.08841, 101908231668.57034, 86787820013.47583, 102949414701.1974, 82853737990.10117, 97379082594.28891, 95915717750.48064, 88501225339.07895, 93980422378.19177, 88445295238.3273, 84672149121.32031, 90885281942.42155, 84474611010.83842, 97324204485.26501, 84193706796.24155, 101233627008.64017, 84003154192.17648, 88950136335.06079, 88426830634.16356, 106747073632.93893, 97398024172.54932, 92199592129.59378, 99072334665.23438, 78649399213.65062, 93786152549.95047, 110900000000.0, 95466458343.64745, 94846008727.60078, 99568933639.10886, 103132379317.70628, 79257951728.82574, 81044027262.1973, 96222441685.42027, 87622716075.67548, 106644515985.39378, 91239511262.06586, 79610081805.84235, 83481046479.21254, 78460000000.0, 91990910692.79816, 92417705427.80281, 90236014703.83893, 104844892860.99959, 105763048792.68152, 92586158410.25029, 78497935528.05157, 100268161225.99261, 99641828001.06146, 97192262486.9548, 104032521072.6363, 84104146374.08032, 110900000000.0, 85480907789.01544, 101615909574.84398, 81015117814.55829, 85733546395.19922, 108257314635.30264, 91742005740.26741, 102552877534.65076, 96482427681.13574, 93201225748.5032, 107050380747.43965, 91967331295.99933, 80480109957.4809, 86842694532.12543, 99599804551.69594, 98042965822.0498, 81711758598.62552, 87538822151.83263, 88811386979.61626, 90776316754.51779, 82836442672.06952, 88393122466.51984, 87501022738.12369, 101845588247.16718, 102233721581.66379, 92816722381.4555, 90532568145.68224, 95539693754.1015, 86725585408.05869, 84213489184.73996, 85647209560.56427, 88335517628.08484, 84112368040.70657, 95753940920.99028, 101415512333.88829, 81595106349.04387, 94436252773.62842, 92123098157.9202, 97508661534.8948, 94073160939.88647, 82376703835.54187, 83514843042.8358, 94477305547.44812, 104463734864.39407, 78460000000.0, 97550290214.80289, 105694378939.54054, 92748975629.59335, 99589834509.08505, 87727474926.30359, 93065435217.7308, 81398808111.6453, 78460000000.0, 103625750579.96255, 85260032824.36328, 89952791425.12207, 82773921581.26169, 82634453272.89777, 92553846880.4711, 87492463309.12022, 97869115667.67517, 98610418588.33557, 97305022772.9609, 96498494028.0899, 108748506034.60841, 84697326290.05019, 93674216993.66171, 105256468277.27432, 106274511320.69545, 82564665534.71973, 91265542252.58968, 107005407324.63744, 99166216159.38744, 96076218773.65979, 92144086212.4579, 90608079452.26482, 96984245062.08669, 91821191017.13199, 93791419740.11493, 94948623605.078, 87949672786.233, 99407859022.96149, 110900000000.0, 80501503191.26411, 97336172064.61238, 87221843449.15567, 99864336132.51149, 94641258859.55357, 101745887235.83969, 105585569281.08421, 96048592337.14807, 105251578863.39346, 78460000000.0, 108850360842.91957, 97840310946.48714, 104836993455.36356, 83770920375.17593, 86601099352.30371, 95597855639.98164, 94034146425.74704, 96933709608.9039, 104887895517.22624, 80568655189.73041, 103951903200.69292, 94275393558.9044, 92273814701.91333, 82273546792.54611, 99115747640.94754, 78460000000.0, 100584347459.80292, 82150168441.23505, 94707369124.50136, 93067293944.58655, 105539608275.18553, 92508737513.38017, 87806791862.5729, 89489069100.4748, 106339389890.3551, 99449792376.6014, 90591310260.35953, 91969308089.59256, 81711066132.67786, 97973193789.95624, 80599526976.96053, 101642376987.39227, 95430479640.88155, 110900000000.0, 84498150588.12433, 93222883616.63016, 110538169888.1251, 105708015880.25514, 87788369645.00702, 96355702049.12689, 94215475690.75803, 96922795271.79785, 87766443976.02402, 93348830090.61293, 81531443663.40256, 95493289506.53564, 98585297365.79622, 92053359321.56422, 81432792429.5177, 104106789934.94885, 97736038602.92133, 87524006948.47578, 91559290728.96822, 82099909241.2434, 84956499829.96126, 89206894887.78438, 105994268550.73375, 88293601256.10751, 100501116520.88036, 89202337529.4798, 96589810305.42763, 92858199533.89525, 102897316971.08539, 89233980875.42418, 81679894359.73642, 82800594940.66635, 89260477448.20816, 83595012084.70242, 98188949441.0553, 89859624592.17807, 110900000000.0, 80725948121.41447, 96157631723.00824, 84328412780.10202, 89608698154.2461, 95554150318.12848, 78460000000.0, 96481165533.084, 110900000000.0, 89971814066.5247, 96705807698.978, 104434453524.79097, 92646468514.3483, 88818227977.44159, 78460000000.0, 100509019752.12581, 93123822847.65228, 85034907975.3341, 95410927124.14275, 88793782651.43002, 89291657984.74303, 100156706609.76906, 83059855358.75656, 104604522129.98863, 82707227172.78415, 88086573808.65823, 110900000000.0, 105215561982.3716, 95131408764.65605, 85644531437.14014, 89284012400.00336, 94897488375.17564, 94554775280.48734, 93334184272.88875, 93902971106.73987, 92174951662.8296, 82445242469.9979, 89399388543.80351, 103331061753.53613, 82881491347.15846, 92406751043.34169, 86697692076.67245, 95263835715.4859, 90563782988.43849, 107947106862.23412, 99151205149.95786, 83218591213.71704, 100817036791.26086, 87094291835.33557, 88853861648.25943, 97235818046.53893, 89623697048.2457, 103103688702.33746, 87095541547.48587, 88477464496.03387, 88143021386.85114, 88956042877.93233, 104999989741.76825, 100385065744.98772, 109816375017.00972, 110900000000.0, 84923833337.37463, 94870063874.92163, 84035152572.7844, 87068260118.41895, 88377815451.7847, 84761358609.28314, 84793695979.93721, 92831057333.59448, 83789982540.27765, 102575756716.48495, 85842158808.35072, 110900000000.0, 89990515632.82996, 94885411493.92924, 83317120569.35434, 109785048846.98793, 105155381617.76001, 97069636250.42487, 83009658337.83633, 96226098941.3057, 84368165740.97922, 107827742559.7414, 102234481169.51819, 95110569364.83604, 78460000000.0, 85273656823.06339, 100985853091.61372, 105874034509.82237, 105076296561.71762, 81566534400.31754, 97115190665.24088, 104363131366.66801, 81182358193.99503, 94121097975.18188, 96843249871.62286, 91372653685.20403, 80074361067.45946, 91142397744.08858, 91127574400.31654, 92795479269.16112, 88975554999.8737, 90066790877.33679, 93818685748.18282, 98509844175.94293, 91338797816.94305, 90371386978.26349, 95080881677.93521, 79686554600.88391, 98855172953.23065, 94191048036.21704, 94575544001.27328, 103814348905.05486, 79507544832.4159, 79389914256.37012, 96842872049.54503, 94128600423.65005, 95832629475.69438, 89892740307.8828, 100746927438.98648, 103519608547.53116, 98924694808.01758, 91742668279.34851, 78646657997.79562, 101821916782.85112, 105942458053.4298, 100545313599.4664, 86173859628.27881, 100843223075.97919, 102766959748.86708, 108596564311.26956, 86204669677.47781, 92062347460.93472, 101595850493.32758, 94745253927.96613, 84393190708.11343, 98232721258.90741, 99877060762.03674, 95038640663.504, 96312978847.35614, 91762375991.32722, 107954139217.11852, 85990494489.65868, 88761077956.65977, 94301190050.2247, 102958743963.57501, 82119249500.65422, 83227600655.53975, 79033864831.38756, 94508589824.73401, 84387224086.9856, 90601210387.9847, 100716596467.97095, 88275382050.99237, 96427051241.15027, 91385846334.72293, 100826079490.96887, 98836097126.54637, 87826385537.09895, 92602431152.15657, 104577369361.05684, 98021813106.45084, 82711519979.35439, 100657905825.76492, 84593090416.25925, 107433433764.83556, 104428211728.54623, 97000601219.39491, 95707182190.17874, 92224801377.33438, 100891499316.99077, 90727564758.75902, 96468901018.62622, 102885632054.42479, 88990546618.42218, 88502124047.2483, 83925112369.2814, 84716463557.09808, 80209048364.80374, 101416673222.15598, 110625432463.52313, 107534631034.03944, 81368849999.9926, 101365636996.72467, 107509172223.93478, 89941121215.38737, 95168416155.96411, 79199833169.3331, 96773633194.07765, 84722063077.4739, 96118734668.38773, 81745887143.32611, 99515846019.9485, 104431350834.49475, 87019162974.9576, 84273784332.42606, 78460000000.0, 91690831670.06369, 88812532095.59027, 81805291528.4808, 98615211960.61038, 90003393876.86667, 84647429195.4592, 89055716577.39682, 104787139545.20639, 100122716004.986, 92965097281.87605, 100286664823.39795, 84127923583.9339, 94505480444.61638, 95611245819.9891, 89822637432.95903, 98440124748.2875, 87043350819.69919, 99183695004.52618, 99606527947.51758, 78460000000.0, 105699653239.84872, 78460000000.0, 88503411154.83641, 104437687763.14334, 91220010207.65344, 82302558137.66827, 84537261203.53519, 104449505813.07393, 79683246285.32706, 105228106170.13658, 93672631744.28546, 83937037233.30374, 88798862137.63853, 85006921809.0533, 102826207643.58807, 101443350326.182, 80832296037.29655, 90426794197.03333, 86317487383.7386, 106500032862.772, 82990017409.0203, 108961139345.66528, 93879576661.26186, 84121714769.22636, 87956769464.71419, 86856943262.18282, 83441386889.69102, 95104677486.68652, 83722408188.8984, 78460000000.0, 90645904768.51733, 80354144601.01117, 87292741157.76918, 85917337705.91023, 86247371446.13577, 110900000000.0, 94735680984.75311, 96564629228.3886, 80504859034.3956, 88164500259.82344, 96271250792.62007, 84961925830.5003, 103262476017.817, 83874712542.16035, 91505885257.69995, 88772478139.39565, 95775853151.7236, 88284785860.1721, 91649271878.67114, 91972252150.15262, 87449882093.00113, 98935823120.52365, 96496419764.38268, 93355503840.39417, 90181282766.79846, 102103684477.92084, 91975005686.95508, 91317813713.9473, 95199649434.47966, 109707805816.45767, 83048084622.32445, 101828312492.96623, 79842722082.82382, 96290449995.49847, 108726958988.8632, 98971618581.3948, 95836975507.46054, 89002768420.96933, 94492829732.79419, 91824083702.30576, 86994538696.8692, 91473393483.59021, 96106539462.23447, 87159842741.4145, 86815967923.0711, 82929618973.4498, 97995512019.26999, 99540673447.64305, 96430743938.03137, 103860964134.92924, 95037724515.9475, 98008264852.709, 97137650527.5518, 93327864958.85219, 89270013459.89185, 110900000000.0]
thresholds = [83207678602.17607, 94071517246.76273, 106402131594.13431]
display_name = "Total Global Research Funding (Baseline + 1% treaty Funding)"
units = "USD"

# Calculate exceedance probabilities (1 - CDF)
sorted_samples = np.sort(samples)
exceedance = 1 - np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

# Create figure
fig, ax = plt.subplots(figsize=(10, 6))

# Plot exceedance curve
ax.plot(sorted_samples, exceedance * 100, color=COLOR_BLACK, linewidth=2.5)
ax.fill_between(sorted_samples, 0, exceedance * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)
ax.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Annotate thresholds
for thresh in thresholds:
    exceed_pct = (np.array(samples) >= thresh).sum() / len(samples) * 100
    ax.axvline(thresh, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
    ax.axhline(exceed_pct, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.3)
    
    # Add label with formatted threshold value (use format_parameter_value for full units)
    ax.annotate(f'{exceed_pct:.0f}% chance\nâ‰¥ {format_parameter_value(thresh, units)}',
                xy=(thresh, exceed_pct), xytext=(thresh * 1.05, exceed_pct + 5),
                fontsize=10, ha='left', weight='bold',
                bbox=dict(boxstyle='round,pad=0.3', facecolor=COLOR_WHITE, edgecolor=COLOR_BLACK, alpha=0.9))

ax.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=12)
ax.set_ylabel('Probability of Exceeding Value (%)', fontsize=12)
ax.set_title(f'Exceedance Probability: {display_name}', fontsize=14, weight='bold', pad=15)
ax.set_ylim(0, 100)
ax.set_xlim(left=min(sorted_samples) * 0.95)

clean_spines(ax)
add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from
output_path = get_figure_output_path('exceedance-total_research_funding_with_treaty.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Exceedance: {display_name}',
    description=f'Probability of {display_name} exceeding various thresholds'
)

plt.show()
```

*This exceedance probability chart shows the likelihood that Total Global Research Funding (Baseline + 1% treaty Funding) will exceed any given threshold. Higher curves indicate more favorable outcomes with greater certainty.*
