```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: 1% treaty ROI at 7% Discount Rate (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)

setup_chart_style()

# Simulation results
samples = [335.04135923811776, 306.44872129970054, 311.270529014863, 321.7744815022095, 379.72187567503954, 341.14037860263437, 322.2229672754772, 310.95290362905104, 320.0401233560483, 402.99534331861236, 394.23185986413836, 313.0730735210093, 360.57410382526444, 383.74307040158743, 338.6216506628077, 408.48245815539804, 330.31591975305116, 339.25899618765476, 323.56587848533843, 376.23709008189405, 366.1830388576922, 403.1194450836545, 298.99332459988426, 395.54419046398635, 353.4041894857654, 390.89232360627, 362.26152439026947, 290.7044306055954, 378.9032668106753, 340.76776467246225, 378.5836488996362, 346.36373314975845, 437.57470316752494, 341.7364693056609, 284.0984840613935, 373.74181251482906, 311.6548383505558, 320.6198315945177, 432.05596695909827, 334.8726360170754, 353.51918209500286, 380.1585238836505, 409.09062163603386, 343.9369420225973, 263.5851629165528, 306.94590049060247, 309.7181376736387, 402.12571707399627, 402.2797016383249, 297.39696874183926, 338.357832101486, 411.22410235295246, 395.0414168495797, 392.7739231296266, 395.248634970958, 395.5229551956723, 349.71580056658644, 255.97508567424677, 400.7668663259542, 365.3823122463956, 355.80719248802745, 461.4206165666084, 232.6911205490021, 227.41541425138175, 277.28652213546184, 316.4067187304733, 368.40167883506234, 359.85247885224265, 338.8758918370769, 339.8168394402844, 468.96324774182784, 353.74882844754234, 364.5777800238634, 299.9988346593397, 351.42709292010727, 390.50426848075807, 438.17230055160405, 378.1248985809475, 349.8174670452733, 345.10488816042624, 371.97108879666143, 342.363454326091, 388.40563273625554, 366.3497580454863, 402.98346479289955, 396.77011419910934, 315.30697833529604, 365.56363718122435, 425.5233025105147, 319.14866340647154, 341.2220496482595, 357.4370728208473, 349.0705879313233, 277.2334357244585, 339.19163971949973, 409.8865280663443, 536.5880846142968, 321.7928232514726, 331.07576620446076, 447.5081889079438, 352.2768734026104, 322.97923575822284, 334.5359064627879, 334.5138066255759, 453.95647676804447, 256.88007620853966, 342.7951532322805, 341.64643258815306, 357.5897995923388, 338.624232149636, 334.04764054450214, 317.35108192037836, 375.32675753144576, 373.6880520917963, 309.9125572079012, 410.18784970945217, 406.99299903518903, 378.8574243782183, 376.1654223374322, 333.6489758708799, 407.5496992249028, 323.1050572139982, 383.66930457943124, 328.1800885119441, 359.07969231767214, 300.9049525617105, 361.26961662169964, 443.7923049525545, 258.99933462721975, 466.1593817285747, 458.53200018318944, 329.7363457830326, 344.6196970637686, 423.16110834725845, 391.8168706196398, 421.6136015877458, 351.4507346719078, 302.5426594130056, 286.46117580440267, 321.2928759021418, 330.6805326023728, 384.3250115089482, 414.77025843344865, 325.0368416647812, 372.50014617024436, 401.2316361977612, 440.629631455262, 362.0386203170312, 377.2774054414379, 278.97354125418553, 422.7882880686093, 434.82831336635286, 477.34546668805734, 341.26063256124706, 348.7913010295394, 368.960477154573, 433.1937759755044, 345.6904318931594, 317.5194545069992, 380.10585368841714, 373.76806393466893, 396.96899590992706, 361.39169630952733, 372.6978020551912, 401.12838147403335, 456.834567244439, 392.35912954990823, 296.8470583862449, 393.3268721098396, 290.57204127242727, 343.447483380576, 396.2597446872505, 324.0954663565316, 333.0812087923939, 453.8421813611789, 338.8370983027735, 284.0704281697878, 327.3222975141527, 416.9450458740798, 299.7374956670663, 388.5109329109752, 412.96968554459016, 359.41905084584425, 304.1974087788251, 305.25609026742586, 388.5023032073547, 312.32004862604435, 330.33090044465644, 400.77218980038737, 388.3577231750261, 374.21049643710927, 307.9860342641255, 352.7786332646903, 242.8394068130118, 329.3473602793915, 395.4733037811445, 348.6854274459764, 268.7105044549702, 364.2158867394816, 321.10994830679687, 292.5401169194488, 322.26125422305734, 342.4716145424723, 414.28444527044144, 391.59465540970615, 318.04304766540554, 424.64299219843224, 383.12188459689355, 409.19347081557805, 341.9216719982673, 356.32252331396523, 319.31916747340097, 380.8127967038709, 354.890802104808, 296.0965247032388, 336.55277019892327, 257.88803727582655, 314.1889254009032, 380.0516517527997, 454.29582083272095, 330.2448768763795, 372.4712625230475, 323.8869741254949, 477.3668620462583, 356.97341104060916, 394.5538122259795, 242.61990688574812, 260.39178927112215, 374.3300526397425, 324.8312048867473, 413.09012131387743, 357.1726515748102, 375.2851043096344, 315.40369882051186, 376.84155491205587, 357.62593565639077, 390.5282873474237, 352.3261790498283, 411.8778224000846, 299.0453754479845, 368.89648977057016, 357.047230612843, 480.3166420969156, 437.0304469477482, 293.4552680747331, 479.2619869632074, 391.92057560683116, 347.88236326520394, 342.2948169070732, 474.61990202293487, 373.0257467272323, 405.93365805620255, 282.8532754372476, 443.90707643149995, 382.7997754195337, 348.762523790342, 325.0459025182041, 432.4940846890904, 378.30284734563605, 405.5564509112405, 359.84616545088016, 365.5765112459437, 313.7670373048616, 371.0597420104907, 350.23251896546515, 281.8593441635073, 344.8857865687709, 357.45037514245325, 404.8729201578344, 357.24100639541695, 384.91446302871645, 362.9263315378127, 410.2199612673491, 327.2387199123055, 373.5916460656687, 341.00256925855604, 429.0360023385963, 428.24395236772153, 371.27690997839255, 332.0947781646283, 363.3558287818742, 394.1939245149002, 284.5400410188844, 344.2369180692849, 400.0882863455016, 333.6250481478008, 350.92639590565574, 423.758042355595, 310.878401810223, 398.1218276516682, 444.1260714861906, 313.0349342262591, 281.13318858599985, 444.9773757611205, 319.19028948144177, 316.11613490500565, 326.7995442584504, 434.11445329856247, 364.1808525509613, 290.4155625485448, 303.9681434135459, 469.4826255949282, 351.05670165380354, 372.5164667770022, 447.63091240757683, 361.93332872803455, 384.0424307859968, 290.05107958282514, 349.4955658451779, 344.3220815915225, 329.3755540875378, 353.4711725850955, 282.8486125869948, 306.25802386746517, 294.3824584685425, 445.84516344706446, 334.89573364187424, 364.26340813977384, 367.65098808971675, 364.9940521797499, 319.40743600734544, 349.78634132706736, 330.5430443630596, 369.73415163997237, 270.79231950293456, 403.297747655928, 416.0036300725821, 330.8203752955497, 450.3569050320953, 419.5045021454703, 357.019974018641, 444.46096793090146, 426.1015276792654, 395.4293605512962, 399.71634120945566, 447.7351836691187, 286.4827478667073, 273.35910764722087, 287.6064667810343, 376.36607342000576, 367.9642647374205, 264.4430490561047, 333.7337768835531, 352.66869511339263, 346.94073051767293, 350.87107728569214, 386.8696046112166, 352.7992074686115, 486.3207065518552, 327.1245016663293, 484.457078438967, 328.04048022614, 364.327828631572, 366.2602799857266, 389.27405817164674, 313.89005272433184, 312.82129096779454, 353.932151161346, 408.24435997564825, 299.77316660906234, 367.85011096755744, 418.37510042392347, 337.56362085753517, 409.93622260608356, 460.8866067088947, 342.96101728889795, 412.2447842373322, 447.0027629409027, 380.2378778891135, 329.75973982924427, 391.48599812727383, 337.27667463140006, 349.61289164663356, 440.8423611607907, 385.408136828712, 337.17605119222975, 399.4022421269376, 337.23168912826, 350.43442243355884, 369.28655756040905, 334.5314770229982, 320.53505673869785, 391.2753928787099, 481.20245785081545, 359.4080338339667, 281.2083576828648, 383.9039026532417, 352.9962137232722, 342.48261544003043, 279.7165915761898, 423.76224614877805, 373.8839038957908, 405.95413379830086, 353.68408893438806, 367.29900162278807, 395.53455652443637, 313.05429159281937, 304.4473345735299, 384.13771101294697, 396.3242411166398, 379.28503635393173, 268.62757086702413, 367.72481256615606, 326.2112765048062, 385.617861195403, 446.9971167915559, 395.50220494719883, 332.28671959405574, 379.4722051025295, 350.24737822789416, 355.2183090630634, 375.6997898910775, 437.3762189755419, 305.33971530113257, 401.40990627587195, 382.2954181441311, 286.9823957152425, 334.98204636167657, 382.97373706047364, 314.013464717834, 428.383147028707, 409.29554636355385, 383.6232044017677, 407.46109298992246, 437.1790021426962, 330.8921067128992, 333.77931829681125, 327.9127016137858, 405.4822384424969, 289.710902690909, 407.22873613403766, 215.43529852876213, 373.34893823546895, 316.85748824719815, 354.3841121821236, 373.56044263384774, 427.2860957188176, 363.22440969685465, 422.7372902528253, 379.9734886861347, 318.03748748852064, 329.97772657356023, 329.7019253503717, 323.5319178187459, 314.738642739709, 425.45863506168087, 302.29136809887547, 305.8459721342905, 318.20397144381604, 388.92584954558663, 320.41020534419414, 382.9535137152213, 391.16966561924613, 335.3556421085353, 355.35114836918353, 361.99835853013843, 356.44794128539235, 307.78297368965366, 442.49436868239354, 371.9289894705221, 385.7919863611559, 381.3577293875195, 367.2201280799602, 381.1129867406869, 395.97640968825766, 390.0146923709401, 415.72516803305814, 283.03707678684486, 342.6883562443797, 427.90031678962447, 425.16624785663316, 296.282419525967, 346.37464403403936, 377.59006742590395, 363.12944212663683, 475.4515550067618, 369.09601665880723, 387.6343996568806, 399.4122618126805, 259.2521456646526, 400.5266712281307, 357.0285234086039, 310.4448948296653, 339.97819489595327, 362.83938690961776, 442.4468733974192, 372.5433549768117, 339.87012175687164, 416.46113822827914, 331.354818526998, 318.9271308199514, 423.47033953265117, 330.99080439345335, 396.8288952754755, 376.87499867257736, 314.04183081654895, 386.15115556378566, 383.4463789134736, 434.93953411834684, 425.81762463143383, 316.3238668626721, 325.19969140321047, 391.1794025139245, 324.9686667034753, 411.20021874754013, 297.3409140874864, 281.1263488213001, 415.49614598950365, 333.9537323412289, 339.65838612208177, 355.16533405999536, 339.01129679371326, 395.4025057970973, 358.86267778688034, 302.7764985113952, 369.34345520415764, 384.4198984376343, 321.9925063593218, 338.18818262668583, 392.12928258302617, 384.749429532058, 317.31048771182617, 287.8537316408657, 389.5653300900872, 260.09383177898525, 442.68327699954585, 368.97391223149833, 388.03115420727386, 323.22749887011605, 320.8109819749043, 455.68319091800254, 414.1806606434839, 313.10305232051724, 307.3873744340641, 411.3324305700241, 336.1903366432906, 415.9780177395816, 266.6493489179888, 402.3897040913177, 391.03331818619966, 397.16450769804095, 289.0367434210486, 357.73242529789167, 350.5867569317915, 326.37669207312973, 349.12177032457373, 294.4719240842997, 312.61363438059874, 342.9457980317273, 320.5836437388415, 343.14699743248565, 462.2371260940372, 294.5966673993544, 341.27928316695693, 319.06780131987915, 365.0078372475015, 353.24748779223773, 434.9081105195112, 381.9043696247535, 451.6849734111121, 380.00835518718753, 348.3239126336096, 313.3020576420443, 429.19709843500095, 322.83829071447576, 366.0033835248861, 445.5959251313847, 444.9328061921, 374.81354338641614, 340.67290787990726, 367.5242102410092, 271.0248200043259, 345.7953808212857, 298.0194277926453, 367.4521453851505, 365.7844093139667, 328.4451218449795, 319.9153880025085, 379.13476413835224, 348.5325154342112, 492.5854672926684, 473.3447373384979, 315.07593322939687, 398.7717348543863, 364.6855447014415, 242.7936460685451, 361.925306153329, 370.7532093700458, 385.5500500540718, 340.7716931129632, 441.6801762018581, 461.8910331036796, 342.09726301801726, 428.0898579974507, 431.29347100519567, 332.7077798931859, 431.31841336236664, 375.835713035137, 357.7634965943261, 409.816348230041, 358.0762253485278, 415.66924296604367, 395.7147854749597, 477.06985014626656, 343.69285631272714, 349.75150722144303, 315.3840794436698, 308.2983864535281, 340.2908626586449, 255.0443807410212, 334.852177631688, 243.16089021782514, 325.83146439390333, 395.06449981666196, 348.7828008241357, 319.28773189326586, 372.26735818819196, 388.03580776597863, 415.4447593119017, 350.1509165417274, 463.09328882581497, 318.000537392729, 340.98982742067375, 409.59314403841915, 384.38082907474177, 273.2553506782023, 416.6798151753441, 318.08070829258253, 420.84176998484577, 392.6968222914125, 352.9524304786192, 276.3397141801501, 359.7356917464619, 419.15610188829424, 336.4068157005492, 367.0457526687471, 386.0667665268873, 314.7033412951949, 307.35803844729367, 370.78138913125053, 420.6178650060158, 268.219009979233, 297.4009200547216, 275.9163628282552, 384.6231393054257, 299.53424568156646, 322.46329258029874, 343.7582249722418, 307.21867304840436, 360.400113779536, 308.158399760453, 285.37365968600017, 334.98783255306483, 370.67274309996935, 298.01726777130233, 397.3284165594941, 353.19210367676243, 388.8156961442483, 305.9023926382738, 292.1472971136105, 410.61627749261055, 334.68338631433863, 347.6034132023897, 312.985987059251, 390.1035176469659, 357.6919269903486, 411.86344122780247, 372.8325999717925, 381.5882002343371, 536.346325360119, 329.6793051918968, 304.32428262233304, 400.79484456095616, 403.9317628264585, 274.0239317778626, 351.46471469685144, 308.7022726273595, 361.3114288533736, 358.95739505373564, 328.6152153951854, 296.9084914999749, 373.2832233547361, 259.0356469817863, 467.12079266656167, 340.04661244613175, 326.2518474909424, 376.8009261832517, 352.3578712897464, 360.76850461616164, 368.1558400628895, 346.645963036571, 310.497775117124, 409.0488408728811, 447.36073949839715, 415.96999778675604, 422.3645401209, 372.1702273044965, 292.7648899973229, 298.1895760084386, 367.32453063196016, 252.59531082247602, 381.2626995653178, 323.10083729525275, 362.5580232769001, 320.82779870630003, 339.72958913929455, 393.00722835537255, 403.4507964902048, 431.821398365171, 307.4525157677625, 356.6087215002702, 337.52395548562924, 429.89639677269514, 293.98545425535855, 406.48479503550334, 354.7538210898953, 402.1729212500968, 350.49817002330576, 350.0051512347096, 367.33533960058395, 317.3336989561479, 360.8343105765488, 313.624733654285, 296.7736860926289, 422.9405429008701, 333.7558525809074, 319.43878521497516, 330.6703768957789, 390.88298091239284, 358.2691726968818, 363.72965040524247, 331.7469319897348, 314.0474899520442, 361.5536244639993, 309.5929383328989, 222.07087669767589, 363.7747700193086, 364.02544468072944, 419.9736681854567, 349.2462506139908, 449.5610194873769, 391.4247695404213, 434.747933201293, 393.77794993750524, 366.47433733972787, 393.0105193841138, 324.515906354034, 293.08714430827695, 321.3746137518316, 410.5315649059105, 351.07462462307655, 357.5846018766669, 385.697889137404, 232.1110066228134, 320.32946495259023, 308.89428766487936, 278.98537477606897, 304.82556453513837, 304.9030605363033, 355.1351533150525, 312.570730738203, 291.33708028257917, 230.25535314646814, 316.194950670464, 294.60310903689356, 408.62973418971677, 372.8306034793104, 371.72056888138303, 384.6193830038584, 292.503063110342, 290.5272674490031, 303.61129113740105, 333.4676882273425, 329.41964246312676, 397.99954878194853, 333.71919031605006, 417.07089136272174, 414.380145549752, 314.20526260337186, 323.4296937675657, 361.5587523983303, 341.64570796766725, 346.6569232158756, 364.74296718975216, 387.30365609906585, 363.33652761684044, 383.884098082517, 312.4920200756191, 383.3754545969024, 361.3379496498989, 373.33151550624, 311.1275413042058, 315.0120036554115, 343.09939282245824, 388.09263996473345, 332.9696758113291, 316.4552554914537, 293.35492726948763, 341.78202872532256, 374.8262444644531, 399.45995596095895, 312.95585943136314, 409.19784180498385, 409.36390057390236, 346.25776040050215, 341.72533547790397, 399.89789807075573, 333.41233104269264, 411.0441630076662, 378.98100784454186, 394.0846317705728, 346.7519153447213, 378.43931281251054, 323.34351200691776, 415.64157953249986, 256.2761018657414, 376.6230462730254, 411.1858997766307, 313.49329178225304, 446.1458216826107, 375.9525919867935, 340.25664090818026, 452.53246965120434, 296.8722627895562, 416.4963219521986, 338.9251877718651, 381.16838611273005, 298.7628429926259, 312.478474396134, 389.3332180140177, 304.41994719592896, 317.9229315324129, 377.46409900746465, 398.8357471759124, 368.92778057445946, 341.31313368994313, 340.88628867404367, 280.47200103292147, 283.10672457636997, 371.81130501257303, 306.1009590474793, 351.4965946774205, 378.1841765149238, 357.9557810776563, 339.76006458858313, 304.38628883138387, 366.32042917157713, 404.6129016251313, 364.7345216096256, 346.8615160186544, 383.8248740339255, 316.8518212394586, 383.4779799607603, 305.23879366315504, 347.84623087070526, 339.0564728908886, 304.03523782116366, 378.85042599369893, 439.04134259192244, 270.07920099838174, 351.2684094804987, 419.6659658580254, 399.17053555512064, 353.4792348857559, 338.73811065858706, 403.83772726654684, 510.5593518371261, 399.3579467573848, 358.0209925387157, 415.9579380526382, 397.0339098601305, 420.6171264440868, 352.32483326792516, 369.7360883825218, 453.61223274956313, 367.2990694852583, 451.61077274940146, 440.6633868168293, 250.87376271528814, 309.70513979301353, 355.0595515984478, 374.6656672668085, 326.3301282130803, 428.5763021711375, 353.53498148350235, 360.1615977851333, 327.9062935340033, 333.7696593878701, 406.5212094358633, 384.27677880651953, 331.61262927063746, 267.5826337517259, 392.91977646352524, 357.5736425594018, 374.9680774338115, 277.2279764485053, 372.526506101153, 381.47267112748546, 319.96540787024816, 467.81360932995267, 366.57247714969327, 346.37869713222324, 373.1715092034471, 255.72044084058135, 261.8326709208111, 252.52597810941916, 386.8652173279541, 419.17293056952667, 446.5240638040762, 351.50431050838625, 396.0461797384041, 392.1874830348559, 332.99318191969843, 347.7537257774184, 319.092100162911, 279.2913859576496, 405.1638819384181, 326.796624313808, 360.17419969884673, 496.88372882704385, 437.9220352679012, 338.4438615846188, 346.74275371005103, 382.69212635997275, 419.3894665635849, 315.54874121017247, 343.12926318873224, 334.104951944084, 237.3949305767232, 371.2337003261368, 388.7929902683907, 340.4411267950754, 370.09190781744786, 301.3510133911298, 383.9661092175715, 338.39546849624463, 356.65334542606337, 327.7719049053101, 363.24503911791936, 340.49793464723456, 344.4893200958391, 356.8703622849038, 330.4627506478598, 330.0964609458848, 411.08366343900326, 318.67401537385143, 308.5173343612142, 458.711741644008, 386.3199337241574, 372.2424528037028, 372.81480561149647, 314.89009804299536, 386.9959333404107, 363.24422185907576, 344.6802290208032, 363.7379634711003, 300.8401359621339, 304.2612969491126, 286.8460459711381, 313.4466650915502, 287.621646742695, 257.8788739526545, 406.2633469071789, 364.90651190602733, 306.6640135062758, 426.78308325173924, 324.0356683626682, 416.9291335272741, 287.0872523478204, 384.26182930616625, 305.93154329830475, 364.7506595173985, 359.2509239174763, 294.68235810224, 354.4365582247138, 381.4912819593715, 263.77958869094545, 376.35311938043895, 422.5273393508745, 322.58875950326717, 311.78686254443244, 436.67192196787147, 361.0158049054268, 326.63711727054493, 243.0013954372875, 330.6884400522282, 303.6246972023676, 363.6874683259379, 480.4942304679361, 382.358757516843, 357.2221872874933, 315.3715577358298, 294.2649814451481, 315.6189325065938, 350.52448025926327, 402.10036105207814, 307.1537893453381, 395.544590932536, 331.1740525927039, 361.2694358212093]  # Truncate for embedding
baseline = 351.4403111529212
mean = 355.82544145704077
std = 50.915743975020376
p5 = 273.709577862329
p50 = 354.8889173972218
p95 = 441.85548659281505
display_name = "1% treaty ROI at 7% Discount Rate"
units = ""

# Create figure with two subplots
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
# Handle edge case where all samples are identical (zero variance)
if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Mark key statistics
ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {p50:,.2g}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {p5:,.2g}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {p95:,.2g}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {baseline:,.2g}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---
sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Mark key percentiles
ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"
exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title
fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark
add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from
output_path = get_figure_output_path('mc-distribution-roi_discount_7pct.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 351.4 |
| Mean (expected value) | 355.8 |
| Median (50th percentile) | 354.9 |
| Standard Deviation | 50.92 |
| 90% Confidence Interval | [273.7, 441.9] |

*The histogram shows the distribution of 1% treaty ROI at 7% Discount Rate across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
