```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Ratio of Type Ii Error Cost to Type I Error Benefit (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata
)

setup_chart_style()

# Simulation results
samples = [2996.741490802077, 3590.3339859989774, 2819.860388040851, 2745.1510589658346, 4012.027201511541, 3706.671854686118, 3069.8808913697985, 3259.4627292020828, 3129.2078120345573, 3503.8089518129495, 2769.257389927705, 2810.1476746739036, 3099.715935847612, 2677.4935488184897, 2929.285131089462, 3503.53968137818, 2969.702163000008, 3553.6336937413266, 2768.986956000835, 3146.6228132718047, 3202.349062614583, 3423.6135903382747, 2644.911911410531, 3193.8969542358823, 3311.0303857039985, 3280.9238650148905, 2903.298137868669, 2970.336547901887, 2950.9153666096554, 2948.0976442970323, 2573.26938686448, 3300.2830026841875, 3347.027226135631, 3486.47092929767, 2872.8876449001978, 2676.6027670518824, 3174.2343516617007, 3497.9096749515866, 3493.1634277740777, 2855.318610221947, 2819.273858408818, 2900.137425687857, 3417.0647880902357, 3023.814308165503, 3073.8261003486045, 3032.3251287600947, 2772.607366319975, 3028.337282684559, 2845.3541067944125, 3094.283105223529, 3000.595302561373, 2866.554118115769, 3784.9336173343145, 3265.268557256133, 3331.530701615232, 3406.746517513952, 3245.263579787846, 2549.139217790429, 3509.7882658908616, 2736.6189339724124, 3885.730075408694, 3270.871076121902, 3056.8956465955207, 2882.8354930826845, 2832.229113155966, 2800.1531489389045, 3275.0147155583036, 3326.976759062676, 2778.599745525665, 3206.7612564481933, 3702.9665868976463, 3635.702847900946, 3535.3833490898032, 2918.601698668581, 3065.3077967560475, 2842.691195201305, 3311.420873514236, 3057.2900239694845, 2869.5148173258076, 3259.9370057128385, 2932.6250909438495, 3418.440167527485, 3286.1697065687254, 3290.6588277974156, 3661.0350241383467, 2922.051994049544, 3331.8864329006215, 3121.225609464035, 2925.1106751958064, 2936.1325122549956, 2852.01751712544, 3164.8012579108286, 3310.834104522625, 3161.0563137118515, 3886.2141963187005, 3778.232122201491, 3721.403393734511, 3572.7076191274286, 2958.8093888245508, 3527.4449564423553, 3289.9443290148442, 2616.426409462929, 3279.449360280456, 2823.527304084758, 3541.005648452416, 3212.3643693399704, 3545.7433990479713, 3269.395784060408, 2784.9102439906455, 3909.6116042242543, 2944.1357049822673, 3023.8658867041463, 3385.390583717117, 3776.1396227285436, 3093.9831464815834, 3358.0305958709373, 3023.9772525558274, 3116.4302206326697, 2512.8879549424505, 3226.5438633561707, 3575.8393179754326, 3049.09698462552, 3032.7401958982377, 2594.071939300009, 2784.8908054237954, 2978.124826724261, 2560.500117250722, 3661.7063758270415, 3406.4132011918696, 3541.604560293382, 3294.988459664292, 3742.1148625111196, 2863.063685520424, 3221.8895503911845, 3792.583267036454, 3576.8290936033277, 2992.4682114097463, 2784.284276628484, 2509.7522935189945, 2838.3653826002674, 2951.4293470519847, 3564.190864198553, 4056.9928767821675, 3011.7872187980097, 3486.80213158169, 3306.369903353178, 3396.616899225211, 3183.6585616073257, 2699.0182337403403, 3056.811317297981, 3192.4930922761114, 3582.584834763709, 3877.290960753184, 3337.303645094185, 3147.1741669810044, 2457.594400840032, 3068.9075548047417, 2729.8711007156976, 3342.142680115598, 3653.1639242167457, 3553.3593240494506, 3446.1277199575657, 2567.401689600254, 3485.660541815272, 2784.3883209970854, 3528.4846608390762, 2748.093164944232, 2962.6892886676164, 3193.1759729754067, 3143.4464236277995, 3413.0335871004654, 2935.9926297586376, 3320.177801112926, 3673.413130163541, 3701.9533063245904, 3052.6188460901462, 2519.7160869721615, 3057.7561511090767, 3174.514838702835, 3004.9484669535877, 2613.493044163955, 3032.5453124367777, 3305.957023763538, 2685.6883513782054, 2947.466544943876, 2534.837206509965, 3048.6244911944796, 3673.9171744394425, 3743.5100092245993, 2497.5105953609313, 2471.8910365410393, 3202.285012442641, 3290.1379528075845, 2560.0037049780403, 3622.3325728062846, 3522.786200524447, 2859.3161860093633, 3295.265645678235, 3125.1307482623606, 3192.738281102371, 2980.7246503266038, 2579.318097797554, 3086.415601615886, 2859.496951718326, 4046.6360090616286, 3142.624964307581, 3498.9160130268574, 3666.0711007629875, 3515.996394291862, 3269.165989364123, 2757.3278874351117, 3722.237378168754, 3111.4709317358083, 3336.0396837580547, 3264.40180819557, 2724.7440213894265, 2900.211372660109, 2600.940366911869, 3193.905090526921, 3428.2041172029776, 3221.3219986742783, 3019.873987486749, 3048.232871676166, 3609.9941276782647, 3086.3846638107657, 3028.089318051932, 2712.528419639454, 2465.5664498872093, 3503.728758634144, 3249.8302551035263, 3784.557531062359, 3384.583760332566, 2993.1202463327354, 2650.2215151897176, 3446.801204438553, 3413.2793203891183, 4064.4076349237944, 3193.004333507981, 3595.1779835928523, 3358.050403048626, 3516.5191519370783, 3166.227346360037, 3915.2436208518143, 3782.849993757712, 2567.7473116421233, 3700.170205020382, 3614.492821811743, 2456.418697479125, 2837.100147281809, 3646.433213855596, 3284.3103019030445, 2981.960688013765, 2470.32891633325, 3565.307324277143, 3231.2717454747253, 2810.0161556630396, 2944.24031198956, 3290.6643504319604, 3184.1506268824055, 3742.9428170494816, 3226.9554093325237, 3241.4478257070045, 3023.81702158576, 3368.047172091368, 2928.8936461521125, 2718.2597534321308, 3056.2914888298856, 2978.2052451514382, 3103.259425184205, 3125.037414009265, 3439.192088684173, 2993.397534281103, 3165.2061278230944, 2551.774816656662, 2521.2690390830235, 2962.9652327247463, 3463.2367664165718, 3622.415584748755, 2654.774651986289, 3011.925719830392, 2924.92792519829, 3916.4450675257826, 2750.987594168624, 2936.9134947050206, 3620.8777147499213, 3331.1083051831893, 3012.230325929267, 3103.033913336372, 3250.09924522705, 3169.494771334924, 3235.752774789104, 3061.081529776487, 2556.244304937049, 4111.260752297754, 3225.4887221429735, 3048.2133856091523, 3001.0601735136534, 3284.9893198113887, 3915.7621935350103, 2984.6915070006867, 2469.976608397821, 3810.514166034766, 2774.6153049774416, 3271.154209636614, 3150.915143791683, 3596.855478823316, 3271.0236044429257, 2616.647964972121, 2883.341158840273, 2470.0932597084925, 2660.993694614867, 2940.5133572230566, 2466.2209233480003, 2940.484801219944, 2791.34183818067, 3255.500867186047, 3093.9456864505582, 3435.9060062950857, 2727.828417293842, 3653.6433604033023, 2807.1189033751566, 3206.9862407861915, 2660.651940840629, 2819.9818195786797, 2454.9590067255654, 2825.994268323196, 3835.6533562784534, 3150.8737275817143, 3656.399044650664, 3352.437770924188, 2541.4695221780385, 2862.2196813964074, 3435.3226118664215, 3577.6097164503562, 3112.178273474369, 3667.0680883632776, 3417.0450973527913, 2993.6787196263776, 2668.6468361608336, 2872.304684559348, 4109.103404394569, 2996.632045637115, 3093.9518575683283, 2951.2702191767726, 2508.202609077185, 4053.9637687222867, 3384.43428138188, 2879.5096874765804, 3843.0422526092666, 2556.1763798955712, 2969.5804252954267, 2781.0142553153814, 3374.1833499753984, 2794.4801898865035, 2698.3221162277077, 3024.0411186381475, 3024.5230548625445, 3012.61444265962, 3510.7911112702423, 3187.8660099444646, 3188.0465673971744, 2962.209526238475, 2723.92041334169, 3596.82408549346, 3178.7966913757537, 2553.182628490628, 3451.727598273046, 3485.31612379596, 3036.1315219899675, 2781.852960431207, 3120.872811504288, 2606.7844688857435, 2778.261484509455, 2781.117239810724, 2897.028855652287, 2641.3352978668363, 3212.45974106159, 4034.7375663467465, 2510.505992684545, 3326.639289007308, 3078.5554271659685, 2611.006253944014, 3850.395287787624, 3687.6348763307774, 3850.8792268881157, 3474.7222622208747, 2940.6812540210253, 2907.295346853353, 3009.0512653408214, 3763.937762503904, 4126.724334509895, 3103.6518693874427, 3331.016193749623, 2933.4194481564564, 2835.5172638544427, 3065.714931225395, 2816.771631399233, 3028.400644157913, 2904.212977836273, 3435.2616449709635, 3202.253333943348, 3039.9629293447874, 2790.6752106135464, 3295.5769388382096, 2907.979416518795, 3239.6967023788056, 3174.8867116001416, 2787.526956603743, 4026.1581366467212, 3709.2554603944604, 3789.7819186674087, 4125.343877110698, 3422.490197830266, 2819.564711754658, 3250.708939849549, 3040.2859087282673, 2691.2723228177742, 2606.4395351236044, 3156.4359538019444, 2595.936671512225, 3086.917005799473, 3499.0152166762805, 3385.2960292200755, 3790.5666136296823, 3523.19642837004, 3280.81026146922, 2797.3177829349356, 2474.0178997584835, 3750.6607920165175, 2958.318528419392, 3590.097617941444, 2924.887647947407, 3178.6068742025464, 3954.278579403576, 2751.2309994473558, 3389.220380255314, 3358.4663553578885, 3601.7474857506363, 3413.226882360644, 2947.201841113406, 3207.470707571253, 2984.8988147641167, 2974.458941331041, 2609.2707503229276, 3275.149468993916, 3792.31696237538, 2699.3643689844125, 3270.1019406348832, 2682.8519135837787, 2962.204367714185, 3178.589576221611, 2977.2814690917817, 2490.163515370149, 2544.653258221824, 3094.8715868449135, 3057.8200338039037, 2696.6613934922016, 3497.9401645808894, 2984.5979363461593, 3134.1799221628594, 2992.5911757115477, 3491.8420086290325, 3841.8086732816623, 4051.447010896304, 3630.1939847641956, 3326.2825078656297, 3249.739983369887, 2484.2997319239, 2685.606424116157, 3552.306729169739, 2976.9506370709983, 3300.0434016196473, 3250.891837588371, 3045.3889662319298, 2869.1684488213764, 3269.315615821349, 2702.261865472686, 3634.36148213685, 3121.004932465574, 2743.1955291004474, 3028.173733620773, 2569.244302496181, 3086.719766406935, 2882.7811357307187, 3148.011177890326, 3196.9187903084166, 3469.7136684397847, 2947.9387928342835, 3504.414843983126, 2852.076393391582, 2692.59468277365, 2970.6727537458773, 3250.229160673788, 2936.775035586626, 3260.174982885479, 2747.782151166713, 3956.849398047786, 3270.6141826628555, 4027.400311881641, 3797.8490043226425, 2594.040396085923, 2762.5614394553313, 3440.000518291039, 3805.9546487109087, 4085.4693566404467, 3362.6183645679243, 2675.886665668879, 2944.2764244891287, 3368.5456879901826, 2928.5472260205124, 3826.4074729630934, 3255.235675122989, 3081.668186088027, 3160.7636155430573, 2803.7379328871107, 2981.251254306549, 2852.882746799927, 3428.9727781757965, 2763.3101956273126, 2504.3191938378145, 3558.2659770571927, 3523.3743507234026, 2603.910801734108, 3206.7475936210903, 2579.6141521381464, 3315.2693038667667, 2562.7907190042624, 3069.298281566083, 3015.9521161355783, 2526.376190635039, 3279.468279523752, 3547.111612894875, 3320.48822070836, 2936.278255766972, 3836.05243174076, 2862.201091201809, 3356.652843101888, 2671.639431667778, 4121.749497175068, 3475.5089344971852, 3886.651631802362, 3492.464970639806, 3019.798455301296, 3202.3855415484513, 3235.2641565817084, 3192.3049973759857, 3036.475923024188, 3570.3145424495538, 2835.4277079067615, 2852.755576973187, 2962.71608717922, 2892.9603627506817, 3001.1928750457937, 2526.3444924340424, 3160.428865764601, 3260.7367434679213, 3458.47901057236, 3584.014100853539, 3680.3583354834614, 3522.927041629454, 3155.9180960174967, 2984.978442994922, 3102.6000344457693, 3462.2621781244793, 2759.861820405874, 2822.5701184384857, 3192.1465254344116, 3411.6125854775682, 2896.9073588868678, 3044.5011450014267, 3777.7532941120876, 3156.824629331127, 3017.150988303595, 3529.8014661015827, 3045.097894404884, 3786.0371297442643, 2604.0194409368955, 2633.5976782449798, 3235.5643534366227, 2973.2724741863776, 4120.813260317115, 3640.5521298937147, 3249.533194240284, 3603.1003237327495, 2833.1555472541468, 2509.995976810945, 3654.382614364638, 3498.9890930557003, 3024.8545529603884, 2508.073886494937, 3674.845906712712, 3020.2307530562503, 2455.1295087077615, 3870.8631323349723, 3700.5435539868436, 3310.7222957755534, 3351.581965680859, 2794.145332019987, 3025.10630577568, 3922.1357170169076, 2911.1147429009484, 3379.5536657111993, 2624.087761437017, 3400.8665443529967, 3407.609663169037, 2901.1168450970117, 2813.201292160646, 2936.610476976915, 3887.0913344695646, 2900.187057210259, 3583.1520457237125, 3024.8000381786087, 3761.37828763571, 2936.0688054516777, 3480.6355440135007, 3702.329311933971, 2832.9870977816413, 3025.101497215779, 3395.9039066069304, 2563.020687842898, 3315.9551687831686, 3111.9564542242774, 3012.1650206922327, 3395.863185379025, 2928.7715866621297, 3358.633095011043, 3305.6998189512406, 2593.711555076556, 3590.0798382028165, 4120.642026707561, 2508.026638977735, 2724.665963892764, 3300.6969223181004, 4002.7908407130385, 3259.535077911784, 3250.23823159711, 3207.236693436348, 3621.9951807626094, 2887.15806479526, 2907.3914772669755, 3798.1620805617467, 2839.2056102163356, 2534.016519309296, 3052.4180074953633, 3270.003237505854, 3183.2453675952183, 2872.67335238759, 3910.668573003601, 3057.42075817904, 3294.7530904925366, 2459.748157071896, 3197.5227910936237, 2490.6679849955326, 3613.8918376353754, 2883.1443392425035, 2988.985970540117, 3510.7433283416663, 3048.4959653443107, 2647.1007651598184, 3265.7787468976244, 3896.524180741397, 3128.954812007231, 3528.6900296792087, 3275.307993059721, 3160.4272159556367, 3892.3358103551686, 3856.0028574738603, 2925.5106272372195, 3352.860012771794, 4111.379445941837, 2806.3463058658294, 3013.2514403499877, 3440.0096906025924, 3713.269516382811, 2785.090886835231, 2977.459593610725, 2661.748047783561, 2951.562306132761, 2961.888420494891, 3198.111495518899, 2793.8659843821683, 2869.3652316651933, 2634.627356685255, 3353.378173726475, 3315.8366629581164, 3330.371589239066, 2803.736663189603, 2546.8739762649598, 3326.222105709968, 3310.299010612559, 2992.643870580908, 3231.1031506124755, 2741.497992828276, 4086.675122546547, 3492.274967562445, 3468.554415359909, 4126.123300209274, 3551.666723060766, 3534.857059815095, 3211.9493001575634, 2682.401202129807, 3231.3474585585213, 3584.6247232685196, 3147.953757018129, 2704.806342044122, 3558.168579549809, 3527.6412610935363, 2893.563509843474, 3222.127720806177, 2858.998571195724, 3130.2556124566536, 2835.432404471196, 3582.827477013605, 3128.951494800002, 3217.2418300266154, 3667.364216865691, 3825.1807369077437, 2842.830613968108, 3274.2204911155095, 3576.3506182311085, 3165.580184230974, 2676.3391720140153, 4106.611125741802, 3797.0950124990545, 3533.977322163555, 2559.9328181776045, 3003.932921907501, 2812.974619039086, 3635.1321984821398, 3629.266017687807, 2936.52341699545, 3098.9700001931815, 2897.0005489473015, 3208.0125567488317, 3007.9423673229107, 3057.154990771219, 2810.1405695550047, 2796.820459802577, 3856.6138782027406, 4086.9328288245765, 2724.459761403168, 2655.1852006738595, 3577.0467192398787, 3960.9652838185093, 3081.524529219885, 2747.8849213956755, 2451.7418562336093, 2911.382075023894, 3285.06024931506, 3523.4354544082507, 3120.881147345104, 3254.5514170964825, 3577.043437991842, 2532.302026858748, 2454.113820248403, 2673.4675564023555, 3534.8109615219664, 2777.753618887554, 2862.8380433125076, 2939.9428114531083, 2634.0654990996527, 2863.1288236249893, 2822.7451951462563, 2862.0342590407486, 2981.7234257385226, 3930.7449075035397, 3090.035488216234, 3367.723870553768, 3701.0965023832337, 2487.2365143807388, 2470.4067603798912, 2594.0808495789965, 3016.705795793518, 2598.522086216188, 3121.079955275325, 3036.28782731292, 3615.9121625460307, 2957.9543803460238, 3099.6610091074717, 3706.4578681550706, 3148.0394544000324, 3161.052495205954, 2451.733160784206, 2763.7362025863167, 3120.8792129200256, 3020.152258141334, 3108.1145836658056, 3211.324674998128, 3608.457062367711, 3188.548972225999, 3450.7449992125553, 3688.229771838331, 2911.44885649776, 2962.9845520006156, 3931.9365902393356, 3179.58600813333, 2724.176537804506, 2702.364858743993, 2712.7126771261273, 3108.1742592974983, 3498.1873519372734, 3610.2886960127657, 2981.238747277165, 2966.1097105978074, 2621.460987806429, 2687.7116782194903, 3178.2185496406555, 3680.476888836548, 3265.46856776252, 3031.8626986261515, 3211.6114679290095, 3379.420107133877, 3015.971642996365, 3348.028971530426, 3400.6845019263646, 2993.504949293053, 3299.870261397011, 3020.3817735944344, 3008.086915949143, 3635.4495674407244, 3337.1162020794995, 2567.2020405310177, 3648.152085610254, 4064.2377853481585, 3959.8985728821513, 3112.7743184630544, 3111.56492732186, 3174.8634067290795, 2647.558411570128, 4104.597685625791, 2959.2739905594735, 2525.5077836495248, 3628.1056623501595, 3289.3543723804696, 3456.537751974165, 3522.9411477681883, 3264.902406146502, 2572.2537236399585, 2456.5424928998837, 3270.496155048432, 2470.6845680240663, 3107.0777333570336, 2461.8922761382905, 3164.691385186025, 3069.160223459552, 2970.3459517436227, 2825.1835483271743, 2778.1503041188803, 3434.256593746663, 2736.821913588019, 3279.4460906641757, 3336.036306046168, 2756.699378116485, 3111.6202801776153, 3008.0779567880645, 3115.6437718317866, 2985.68931337127, 2947.940981266909, 4002.7207923596447, 2852.3668905034388, 3564.9998712519964, 3777.9103110807405, 3151.890996981461, 3086.0432279348734, 3429.1463008870983, 2787.961599060776, 3728.423657592044, 3300.091987762968, 3378.892913393237, 3143.3375562952633, 3008.1684291888605, 3570.5837280030396, 2828.5458036643226, 3098.7261712461654, 3976.7832019823004, 4010.812281036079, 3128.873652250796, 3220.402897651435, 3169.517811527332, 3133.474304558236, 3028.9601089054354, 2741.6842145891296, 3622.9780262882214, 3656.4146222775444, 3615.9753288871784, 3000.5317840464695, 2634.107671380525, 3309.9365522499215, 4115.26034930538, 3893.177600149074, 3491.9749079500175, 3369.235852980851, 3299.5699786193973, 3108.065130486078, 3261.053732027234, 2704.8526934152273, 3423.3552281271755, 3511.2055085796046, 2926.154890420883, 3821.4821935296295, 2962.500430524978, 3082.666389901058, 3187.8954095473423, 2516.636406198933, 3394.8977610309366, 2537.342975509148, 3220.7764541603824, 3702.367917251996, 3095.047426352839, 3601.348764293182, 3456.9831743115865, 2957.9672855578897, 2897.4676947892217, 3394.912862797113, 2727.215475585296, 2665.56566961884, 2570.070949181308, 2904.017145469967, 2593.9235024916343, 3979.8824802002473, 3265.893674513614, 3509.3145611547657, 3072.8845284127156, 3373.9935268586723, 3198.375453740663, 2466.186602462464, 3197.154544918576, 2951.2401892731136, 3227.0816764723936, 3091.020981514838, 3120.898311987414, 2936.6789626622226, 2662.6812464311033, 2497.7861810179415, 2992.9328137597117, 2879.104964093381, 3640.5231748572737, 3160.165183872946, 2745.073142536951, 2775.227131205423, 3031.797629272598, 2765.645784202166, 2921.592666109316, 2650.044546024656, 3000.6704207730263, 3279.6512918962135, 2985.4588169456597, 4087.757867176813, 2962.0529759969804, 4035.6339953328425, 3911.581650926698, 2936.106132660795, 2925.746592829175, 3647.9997827581633, 3440.6983101341957, 2591.1852979222303, 3336.090896717656, 2610.1617596625088, 3124.373952932124, 2954.579548664612, 2508.3778419505156, 3069.1503199173785, 3570.5778860802807, 3169.2496818110176, 3138.950734464503, 3742.5411945618057, 3236.3450022543657, 3452.2740943011954, 2751.5538092901384, 3112.7801055167943, 3244.525417630442, 3170.449747058909, 3028.1871392089306, 2873.1351883659327, 3571.67757790188, 3589.656930798501, 2685.2418895113087, 3305.447153891385, 3762.033074016381, 2940.329235828713, 2933.0120794837208, 3812.0330406439316, 3028.4862574055787, 2825.8824525343025, 2966.252479567509, 2865.207346789693, 3756.6728191755133, 2985.6385270860364, 3255.327043711316, 3336.5467497043933, 2772.3578662771365, 2553.856262585435, 2453.7034413900933, 2611.1227580302525, 3169.247407674427, 2976.839766258965, 2812.8313377652607, 3073.515481602511, 3069.065511012359, 2790.124618876107]  # Truncate for embedding
baseline = 3067.7541293180693
mean = 3156.8602314186064
std = 395.70392726845756
p5 = 2550.886504404756
p50 = 3129.543027450007
p95 = 3879.1448388549543
display_name = "Ratio of Type Ii Error Cost to Type I Error Benefit"
units = "ratio"

# Create figure with two subplots
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
# Handle edge case where all samples are identical (zero variance)
if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Mark key statistics
ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {p50:,.2g}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {p5:,.2g}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {p95:,.2g}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {baseline:,.2g}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---
sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Mark key percentiles
ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"
exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title
fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark
add_watermark(fig)

# Save PNG (same directory as the QMD file)
output_path = Path('mc-distribution-type_ii_error_cost_ratio.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 3,068 |
| Mean (expected value) | 3,157 |
| Median (50th percentile) | 3,130 |
| Standard Deviation | 395.7 |
| 90% Confidence Interval | [2,551, 3,879] |

*The histogram shows the distribution of Ratio of Type Ii Error Cost to Type I Error Benefit across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
