```{python}
#| echo: false
#| fig-cap: "Probability of Exceeding Threshold: Coverage Factor of Treaty Funding vs dFDA OPEX"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata
)

setup_chart_style()

# Monte Carlo samples
samples = [679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5, 679.5]
thresholds = [679.5, 679.5, 679.5]
display_name = "Coverage Factor of Treaty Funding vs dFDA OPEX"
units = "ratio"

# Calculate exceedance probabilities (1 - CDF)
sorted_samples = np.sort(samples)
exceedance = 1 - np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

# Create figure
fig, ax = plt.subplots(figsize=(10, 6))

# Plot exceedance curve
ax.plot(sorted_samples, exceedance * 100, color=COLOR_BLACK, linewidth=2.5)
ax.fill_between(sorted_samples, 0, exceedance * 100, alpha=0.1, color=COLOR_BLACK)

# Annotate thresholds
for thresh in thresholds:
    exceed_pct = (np.array(samples) >= thresh).sum() / len(samples) * 100
    ax.axvline(thresh, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
    ax.axhline(exceed_pct, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.3)
    
    # Add label
    ax.annotate(f'{exceed_pct:.0f}% chance\nâ‰¥ {thresh:,.2g}',
                xy=(thresh, exceed_pct), xytext=(thresh * 1.05, exceed_pct + 5),
                fontsize=10, ha='left', weight='bold',
                bbox=dict(boxstyle='round,pad=0.3', facecolor=COLOR_WHITE, edgecolor=COLOR_BLACK, alpha=0.9))

ax.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=12)
ax.set_ylabel('Probability of Exceeding Value (%)', fontsize=12)
ax.set_title(f'Exceedance Probability: {display_name}', fontsize=14, weight='bold', pad=15)
ax.set_ylim(0, 100)
ax.set_xlim(left=min(sorted_samples) * 0.95)

clean_spines(ax)
add_watermark(fig)

# Save PNG
project_root = Path.cwd()
while project_root.name != 'decentralized-institutes-of-health' and project_root.parent != project_root:
    project_root = project_root.parent

output_path = project_root / 'knowledge' / 'figures' / 'exceedance-dividend_coverage_factor.png'
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Exceedance: {display_name}',
    description=f'Probability of {display_name} exceeding various thresholds'
)

plt.show()
```

*This exceedance probability chart shows the likelihood that Coverage Factor of Treaty Funding vs dFDA OPEX will exceed any given threshold. Higher curves indicate more favorable outcomes with greater certainty.*
