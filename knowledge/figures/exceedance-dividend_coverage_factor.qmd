```{python}
#| echo: false
#| fig-cap: "Probability of Exceeding Threshold: Coverage Factor of Treaty Funding vs dFDA OPEX"

import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Monte Carlo samples

samples = [668.2139199025927, 781.8316499475967, 634.9249198079634, 621.2231245123359, 931.2651339553678, 826.9169316450317, 681.8896310151468, 717.4379891664411, 693.2753055304306, 762.8240016808265, 625.5997874605534, 632.9364605573287, 686.732607080248, 600.7414169851385, 655.8635394768329, 763.368442336203, 663.3291512564525, 772.0971154290279, 625.6678320007873, 695.9087180665639, 706.7372187086564, 747.9754058549453, 588.5790801032542, 704.2888259048583, 726.6918637391888, 720.3886160134779, 651.0095587791002, 663.5805481908418, 659.9941957405504, 658.6273744860572, 498.3333333333333, 724.8736202523523, 733.6959989076852, 759.4109190272375, 644.7937814258431, 600.5182846679457, 701.0260694425428, 761.7023011177479, 760.3401211548196, 642.2393264919477, 635.4493615419849, 650.2006085028052, 746.6589438948771, 673.7911389280151, 682.7611595118066, 674.831741197846, 626.1722136657321, 674.4525584177217, 640.1565966380957, 686.6108793020188, 669.4090755440365, 643.6627786381925, 854.7696173306382, 717.7193498077695, 730.1930409607224, 744.3905761703626, 714.0735569584311, 555.1461910822424, 763.938566694544, 619.2499604327053, 896.1661863770695, 718.9691273256655, 679.1688406595615, 646.9977533998723, 637.7883086246536, 631.8078505657185, 720.1078946836806, 729.5238576320788, 627.1396907551817, 707.2582640232075, 822.2465388080647, 797.5885585594217, 768.6296365996134, 653.6380742959013, 680.7516876063464, 639.30749331122, 726.6025460427236, 679.4966325165394, 644.0835042100871, 716.8724089236898, 656.6709982933079, 746.3533049302882, 721.2887268817404, 722.8313109990149, 808.3284627976783, 654.4019165149846, 730.1120555198152, 690.9544276937563, 654.8691114797737, 657.4424972211461, 641.150666760556, 699.7868198275428, 726.274141057942, 698.2855236133605, 896.8138848035254, 852.9367128799993, 830.5524428383889, 775.4854745012555, 660.9750742861585, 767.4044849915208, 722.5358768489481, 578.9698877342042, 720.728939221238, 635.8678314717677, 769.8735825974976, 708.402714346164, 771.3165985832384, 719.3102468723122, 628.4124939789859, 902.6281692997288, 658.3554759941555, 673.3610517877358, 740.5959818087651, 852.7444723089837, 686.2532608506027, 735.143934761285, 673.7514011726225, 690.2146474216179, 542.5542899701032, 711.1566245225124, 779.079718687473, 677.884904456298, 674.7306389766695, 571.5653426728238, 628.787362215819, 664.2327524634758, 558.9304582431882, 807.1062845999603, 744.4648855593265, 769.2549613298818, 723.4987343732945, 840.1931139581336, 643.3777091580323, 709.7642491047657, 857.2670913599734, 777.7614050427632, 667.5407939648873, 628.5698309829697, 501.1433453458888, 498.3333333333333, 659.8673732056002, 774.8034738476512, 935.923866503931, 671.0528266794473, 759.3388024962403, 725.6150784922419, 742.1162740294292, 703.1826026395844, 608.690997512536, 679.6126757957136, 704.6197154693484, 781.1078979879959, 894.9792888319545, 731.5243000478494, 696.2159529617736, 523.7237743478172, 681.699593077323, 618.2227752639801, 732.6110634577657, 806.4474285835327, 772.6467379299015, 751.769797443174, 498.3333333333333, 760.0714867387619, 628.5436746608518, 767.1809459040137, 621.8646331129946, 662.0988549606441, 704.4587442355694, 695.1792569563862, 745.7448879519808, 657.4770840869236, 728.9096434006929, 813.4894362790004, 822.6423839019853, 678.4043086285438, 545.2043338828213, 679.3836585241927, 701.4024567532981, 669.6616841142059, 578.128668510415, 674.7781073869785, 725.2476642930125, 603.4486719165627, 658.7832406036322, 550.3018900174299, 677.5776250878154, 813.2917454583858, 838.6630548243626, 536.8571669267845, 528.5345242505215, 706.3053323293334, 722.9511122363397, 559.1535594507111, 793.1253278467676, 766.4630587355739, 642.7747356912884, 723.8955182326124, 692.3491208755853, 705.0074354065039, 665.7030488499767, 565.6697395595173, 684.8047125202993, 642.7296225933245, 935.0806695376695, 695.8125503657542, 761.9696924967234, 812.3088156400428, 765.0140208205814, 718.9065142439802, 622.9841772319245, 831.2084268230611, 689.5213151178186, 731.345510736643, 718.3764203563935, 616.8035994189433, 650.57634030785, 574.2452522738685, 704.286907851027, 749.2593131880973, 709.8971000559287, 672.9939109338745, 678.0947311576439, 789.2916137752825, 684.8121711780584, 674.0947525558475, 498.3333333333333, 512.3408868080205, 762.8413717419992, 715.0739910260388, 855.9188308101999, 740.3046744897234, 667.3808765440946, 590.6909982110524, 752.1011366655426, 745.6902552409796, 936.0791074451918, 704.9447661699081, 785.5911997552171, 735.1394580961448, 764.9012159583529, 699.4487307301107, 907.0658755539393, 856.5782522512591, 498.3333333333333, 824.3122437351707, 791.3870123312462, 516.48693309168, 498.3333333333333, 804.1439789224842, 721.7173210326655, 665.3994573207269, 527.9635310676465, 774.5664152136166, 711.6385357477592, 632.9694559574813, 658.3296377380287, 722.3701305838161, 702.6221970793406, 839.8716292588538, 711.0604886772965, 713.3588897423865, 673.7904777642801, 737.3176517233658, 655.5606994314558, 615.6876949200993, 679.738711285789, 664.6221545609286, 687.745638296777, 691.9366455002352, 751.4548868761325, 667.3128834343947, 699.6908204560021, 498.71188599514016, 545.8764044896038, 662.0309059892148, 755.0252184276484, 794.0359345951533, 592.5589463935635, 671.4343997414805, 654.91439793518, 905.14617828538, 622.1598256661312, 656.8482719532649, 793.6996622624829, 730.2892146254413, 671.3599500330013, 687.7998542693275, 715.4656588675889, 700.1875502633588, 712.1840832434361, 679.9619091956001, 557.9485146406571, 940.1435122563264, 710.9528502724771, 678.0994635370932, 668.882060941923, 722.0198826447273, 906.9187493158721, 666.4341021308866, 528.116369506435, 868.89793144328, 626.7186506546244, 718.4464270427299, 696.8171435597558, 783.9940498739041, 718.9338686946502, 578.8684444366812, 647.262443430046, 527.5538177296954, 594.3077948443604, 658.0037097210696, 526.2632657425183, 658.0107628218536, 629.3015255796356, 715.8257660551267, 686.6921078835762, 749.3861017439273, 617.7371901867699, 805.3032246479225, 632.6055235112425, 707.2054087336866, 595.0946355117029, 634.8944885030706, 518.1849857101903, 636.3597320030427, 876.0162276450426, 697.2661724151834, 804.2197368020437, 734.2024281938667, 553.2080161098121, 643.2019147047953, 749.5150853916599, 777.4517751855628, 689.351579025802, 811.9176193110327, 747.1393894607434, 667.6558615028277, 597.1332923170663, 645.3277093667879, 937.5191899587466, 668.2407423179984, 686.260798458329, 659.9066352210258, 540.8753476845233, 935.21629659606, 740.3382091569075, 646.6503455869312, 877.8065989213535, 557.4147914677252, 663.3591136899825, 627.9600872900144, 738.6346560227869, 630.3295150135032, 608.3656813722102, 673.735826711988, 673.6183113275345, 670.8505409533666, 763.7217691645017, 703.7249139490211, 704.1271218672131, 662.2170098828861, 617.0113735825879, 784.9398708357335, 701.9139465254376, 556.756102067783, 753.3481742823271, 760.1464231712366, 676.0991897181141, 628.1185556034577, 691.0389104102538, 575.286337554975, 627.2247575888026, 628.3034746014276, 649.3839148643365, 498.3333333333333, 708.3803583673149, 933.8955160974672, 542.2659156932459, 729.1359833285943, 683.4499048341448, 577.6883964516695, 881.6915205161233, 818.0314337631614, 881.506599329421, 757.7098909666895, 657.9622368390519, 651.6159832223615, 670.3948900830574, 846.6979243111962, 937.7038426026903, 687.6512996624947, 730.3101868647458, 656.4745352528844, 638.4670681741305, 681.0779564066216, 634.220072783881, 674.0188524264119, 651.1771001522253, 750.0069399613817, 706.3127827109699, 676.5275568466493, 629.8404269577749, 723.8240158583206, 651.8416722160874, 713.3141217265925, 701.3144852108417, 629.1909888466458, 933.3725350191692, 825.9086119663363, 859.3545340493471, 937.9334905333677, 747.7477121458941, 634.9990238134714, 714.8696192493426, 676.4489926643107, 605.663378524172, 575.4437526922175, 697.4405335236908, 572.2531122388484, 684.6838366813852, 761.4624366486523, 740.6171722151163, 859.0517415408249, 765.886331554682, 720.8734004919733, 631.0661210164753, 528.8634106104645, 841.180660435056, 661.5014902459155, 781.9252659945925, 655.3233914866713, 702.4022439539756, 917.8022732804902, 622.0985195234938, 741.5147954087192, 735.5143421574821, 786.8250159206855, 745.7019129143914, 658.8486305630423, 707.0916055982946, 666.3832095885356, 663.8484301182185, 576.3121507968601, 719.619021397431, 858.3765870243151, 608.5287718677337, 718.6899000290562, 602.3743077323484, 662.218281095363, 702.406333190102, 664.8491774909903, 504.7672547074327, 499.11831861547654, 686.4692334486938, 679.3681773494077, 607.3523684278903, 762.1812109589953, 666.0467003646554, 693.9947421957436, 667.5106328279988, 761.1121608912815, 879.30347451137, 935.3171876758666, 794.8807482568824, 729.2173250654188, 715.5491597509251, 506.1302754090153, 603.4869189896144, 772.3799402386649, 664.9305018670018, 724.9285866761736, 714.8270864164434, 677.4153614844876, 644.5578218665099, 719.3287880860285, 608.9690987430919, 799.0654044218788, 691.4414245580765, 498.3333333333333, 674.4924073699472, 562.5530726385107, 684.7313832443915, 647.4018506125448, 696.4550872784376, 705.5694329691805, 756.4429014964976, 658.6666020878762, 762.6927748142488, 641.1359504636889, 606.1744360897208, 663.4978715359044, 714.9812034375537, 656.8825109626841, 716.8171963636673, 621.5810225166941, 917.8759460805367, 719.0285183343725, 933.260055335197, 861.7225576136304, 570.9920210945508, 624.4673135063582, 751.2765590405946, 863.094344025399, 940.7692307692307, 736.3213546908762, 498.3333333333333, 658.3207193677206, 737.675430534103, 656.0461830643944, 873.9441075750201, 715.8873660654863, 684.1078065552382, 698.795737282605, 631.992086242732, 665.1639314025731, 640.9344410958489, 748.6116355284839, 624.2788151727623, 539.3988806601835, 773.0907191984252, 765.8480158371048, 574.4442269612047, 707.26147314962, 566.1144754823114, 727.8731559595556, 559.9223201678341, 681.6050433321695, 671.7821816713808, 546.8898516943218, 721.1828877393896, 770.5333840741542, 728.3749508409078, 657.0053713522813, 874.841159147633, 643.2065551238844, 735.9239177146884, 598.0951245416384, 938.5200909803194, 757.0550790672004, 896.6881876813221, 760.4919264021003, 672.5955356019066, 706.2816899075228, 712.2981532055005, 704.6640594677002, 676.0154039671935, 776.5906907214733, 638.1086031833878, 641.3506503102568, 662.0922560509636, 649.2039856020581, 668.8495689642662, 500.1673987019399, 698.8751920820451, 716.686877170885, 754.2038888482846, 780.5415951826993, 816.7774308487373, 765.9443475287258, 697.563658452992, 665.9532390461283, 687.904175237155, 755.2389382681308, 624.1090871336792, 635.7294613283659, 704.7014239855822, 745.5854493013986, 649.8075930918388, 677.2099541153793, 853.1217334889101, 697.3481364008976, 671.4892752779557, 766.8978862966675, 677.064945054524, 854.3434368403875, 574.3946839215537, 585.3778661650679, 712.2280699782966, 663.7318640187121, 938.6702556085688, 801.5313209973651, 715.5972264102974, 787.225706471624, 637.5564400239404, 501.11073262257025, 805.0124564655832, 761.4681040346354, 673.5374924521449, 541.4673623659847, 812.9275745431305, 672.4899732886986, 518.1167542518684, 891.066704598365, 823.1933441397847, 726.2997395165813, 734.3961749588178, 630.4135929048009, 673.0584443622575, 909.5871171927353, 652.272017440304, 739.1915491128793, 582.0579079121073, 743.4309525707289, 744.1981720708701, 650.3514071150433, 634.0168536021079, 657.3243369276237, 896.5618416329567, 650.582381763973, 780.8831202413907, 673.5507824176394, 848.685335648054, 657.4582487249714, 758.7890476092008, 823.4688959867773, 637.5985918568371, 673.059616108087, 742.2757064809906, 560.3873886197392, 727.716465293748, 689.4048031452498, 670.9604313587945, 742.758373278005, 655.5909255372953, 735.4766932190407, 725.3066279998815, 571.141542286655, 781.9323086990227, 938.697603233434, 541.4881968440575, 498.3333333333333, 724.7786721369496, 930.5508138501814, 716.9656659280635, 714.9790950336836, 707.1465748137136, 794.2017759836292, 647.4921214395456, 651.5921131889573, 861.601896334909, 638.6690023551454, 499.72706383630884, 678.4530701783206, 719.1697754290857, 703.2801504013518, 644.8472184897404, 903.1165541623332, 679.0414773693301, 723.552848559757, 515.3508767711753, 705.8734342445794, 534.9050917171214, 792.5649682266923, 646.9208365001892, 667.0907361385744, 764.2191429519067, 678.0308389849586, 589.8465796631464, 718.0576286182787, 897.4856284271618, 693.3357488915831, 767.1367967734833, 719.5823859657734, 698.4349389370456, 899.4744405195875, 884.2195311190887, 654.7700163223752, 734.5750031725069, 940.1258406452649, 632.424554436834, 670.694817755458, 750.7956787827684, 829.5109539765317, 628.7370979799111, 664.8053950914499, 498.3333333333333, 659.4304612396595, 661.8900665246935, 705.2885967319017, 630.1116915770359, 644.12082035809, 584.9037308247628, 734.4578287992491, 727.2802562498645, 730.9221109367205, 631.9924053337327, 554.7370874036187, 729.2310967741382, 726.3966564925776, 667.4977070889681, 711.6779063890788, 620.4043897972775, 937.128778471699, 760.5332274346057, 756.6964070589723, 937.8041322055166, 772.5163704792811, 768.2527521201337, 708.051662228692, 602.5846068221628, 711.6208562466202, 780.2997481791018, 696.4687450656942, 610.8901126816903, 773.6035145922873, 767.8510588385905, 649.0539775581773, 709.7085067424218, 642.4682996441222, 693.0250408518127, 638.4883052679979, 781.0117389208623, 692.9011345097524, 708.8284961158516, 811.8014508164653, 874.4147994608767, 639.6548974966472, 720.2913232484178, 778.8769245128962, 699.6021371895122, 600.6411697559464, 937.4152783291902, 862.0131996384682, 768.9310298743101, 559.1854276254558, 669.9102333554613, 633.697554829772, 798.7617724295886, 795.2465927699599, 657.3458584187762, 687.3427029851056, 649.7844308487231, 706.9643429841993, 670.2513226116926, 679.5293632732497, 632.9382430604593, 630.8182941931416, 885.0160265849763, 937.0840027380674, 616.8752981055205, 592.9937819534134, 778.6008995961217, 922.0688652592775, 684.1424806256144, 621.9170845954058, 520.6001791920145, 652.2056803545395, 722.0035460311427, 766.323377460391, 691.0369141433948, 716.0463282281344, 777.6763770415037, 499.8253752186294, 521.9064800571672, 599.6070119020088, 768.7523257783945, 627.3525092352115, 643.0475730069693, 657.7428948956716, 585.1623829408048, 643.3614623567305, 635.6855908360656, 643.2482056554337, 665.4577204588359, 910.8541362824956, 685.350947201154, 737.390519221397, 822.9772098478022, 533.3071192963715, 527.9297694035166, 571.5612903218886, 672.0142727453767, 572.6169642831006, 690.9893042339902, 676.0611625163532, 790.8263121147595, 661.1859113578703, 687.1765578531102, 827.0004851069499, 696.0099722607378, 698.2864308482974, 520.6036816238172, 624.5369569408932, 691.0373771029117, 672.5091406905437, 688.4501268530939, 708.198233671235, 788.9606960127601, 704.0086511630378, 753.5641822717888, 817.7985611313926, 652.58530322712, 661.6199740063057, 911.3080043433063, 701.727284064613, 617.3034953065082, 609.5741265378704, 613.9567712202721, 688.8679043688268, 762.1276285597494, 789.1752809234906, 665.1670045859911, 662.5292715176173, 580.4503854039807, 604.2662297972881, 702.4940336563363, 816.7309963890776, 717.6730084733666, 674.9444013491534, 708.1309329050472, 739.2215551411001, 672.1935550040698, 733.0015585143517, 743.4716023700621, 667.6984427783351, 724.5072008638739, 672.8699912348774, 670.6307205170109, 798.6367661461732, 731.1007556954069, 562.0022647135464, 802.5143239554744, 935.7665556943009, 922.3657310486728, 689.6414277056202, 689.4987571611568, 701.319997415699, 589.6350689837672, 940.7692307692307, 661.2660405293839, 547.2751930791754, 796.6499442536207, 722.6717042140189, 754.1491339781676, 766.4297221885695, 718.2605068490855, 563.2455021834324, 516.4376223544471, 719.0558053818412, 509.43012357513106, 689.1310931137687, 525.229321503089, 699.3715825420722, 681.6384494290254, 663.5782359458873, 498.3333333333333, 627.6213719781857, 750.2289763042864, 619.1988135077918, 721.1880054347542, 731.8121841090854, 623.5064650771781, 689.4854722727862, 670.2181380094063, 690.8364997731803, 665.7786757654645, 659.0695043811024, 930.5573043908703, 641.0633447770387, 774.1388466039461, 852.0596657679355, 696.5848670962051, 685.3227046326768, 749.0508039881338, 629.0817739669983, 834.0175689403467, 724.9174402703057, 739.8114093745003, 695.6428556711166, 670.1959970377823, 776.4838812651443, 636.8338225949245, 686.9707448842415, 926.8192621531339, 931.6448302391964, 692.9197445438717, 709.6623302446554, 700.1820894849023, 694.1631296565048, 674.3008268070398, 620.7181103263622, 793.8141060900712, 804.2136149339972, 790.801364995699, 669.4246233303659, 585.7552598208338, 726.942103601114, 939.539397274394, 899.2332198418064, 761.0833000350169, 737.5200461533633, 725.0372013507615, 688.8940935147258, 717.0691786561138, 610.8683547921557, 747.5557802573641, 763.6321927111449, 655.0095866283863, 869.2286489684064, 661.7392478775528, 683.8669254964352, 703.7179740930733, 544.1299474083359, 742.9740942569994, 499.5364708105973, 710.0248187405963, 822.4803957405954, 686.4269160841086, 787.9183219314128, 754.0512846663266, 661.1827292472378, 649.2748033850077, 742.9707202669935, 617.891726468967, 596.8519707001697, 562.1803002865228, 651.2257248169016, 571.0451657241671, 925.1683399133514, 717.5745237573631, 764.0409874090105, 682.5626053123748, 738.6773302433747, 705.2264590532375, 511.7898146080415, 705.5139144892898, 659.9140445946616, 710.5804060495853, 685.9717396867565, 691.4669410913457, 657.3074077054843, 595.8537060066161, 537.264815368774, 667.8386621787578, 646.7511551808175, 800.5920886881439, 698.9377829263467, 621.2427526281041, 626.5647091007195, 675.3791235267097, 625.0976870360715, 654.117351202559, 591.394710261942, 669.3906885746854, 720.6823231635452, 665.8352719791691, 940.7692307692307, 662.2555717439154, 940.7692307692307, 902.0662763769698, 657.0479469733435, 655.1106714073155, 802.5742613953015, 750.6436567157846, 570.1738968622119, 731.3338657569278, 498.3333333333333, 692.0954071954258, 660.3495261197495, 540.7981359175719, 681.640846496115, 775.9367484212975, 700.6876314916145, 694.7694703794494, 838.0505936489504, 712.4981582010007, 753.2280518231768, 622.3798684302914, 689.2071956174665, 714.6988975094811, 700.4034092485505, 674.489141239675, 644.7320588600114, 775.7037156102166, 782.0998235963152, 603.6571334990244, 725.36455632259, 847.4359597091751, 657.6473780838588, 656.1748159785858, 868.3139122959436, 673.9979810218584, 636.0088117353338, 662.900907325832, 643.611607026068, 845.1615533500806, 666.2016547435061, 716.3211301577711, 731.2302177524194, 626.2349642266632, 557.0169060312403, 520.9388576847629, 577.0368159311242, 700.6881710953116, 664.5487624495629, 633.7334978144884, 682.4100500876601, 681.661369780916, 629.6074172227059, 696.6543405224231, 752.118584490999, 725.5417314104916, 643.4692499647364, 691.7062870349416, 665.5020558111632, 640.8055718765706, 722.2615569585363, 634.502805687808, 662.5624832913389, 815.0924552552609, 561.4561609361282, 732.7324202689164, 891.702125633545, 782.678128250829, 778.6712000020984, 687.8229639587884, 713.9680655334228, 719.1292164521411, 644.5185847949878, 665.5275722677923, 667.347013868163, 660.2139009131461, 644.7823023021957, 935.6773809559386, 721.4029154558448, 936.4125477097058, 689.0929543374948, 692.310377133359, 611.3676147956978, 593.0053255983294, 676.0628837478289, 732.700288714243, 654.5378107930607, 735.0116103130123, 692.0536426998395, 617.9817387270947, 737.5236247203762, 630.9145423115257, 640.2676380417143, 771.7366666689916, 618.8508712088174, 638.7151849827961, 683.9160468834389, 754.9619476551117, 763.3609077810368, 735.8306717997862, 650.2423411856465, 771.8100818544692, 658.1224598383958, 816.303226014437, 708.291781706096, 683.311613627328, 498.3333333333333, 840.3061814444299, 557.8859091878641, 680.1737503255405, 660.1122565278248, 682.6312275496759, 657.5784781154008, 704.2207882565019, 560.0420040970102, 729.0336127758593, 600.0980091278801, 744.8575745839915, 696.7316189401254, 787.1970073583605, 656.802845715332, 561.1161666915904, 698.0967943812373, 707.7100050243314, 794.4105205933809, 710.3384949144238, 879.9099905857937, 768.0529747603587, 674.2061253539723, 576.516129075765, 498.3333333333333, 739.956064926607, 562.3012123596936, 672.897115775774, 704.0244205053905, 658.493515095261, 687.0561548596908, 683.2530934505627, 725.0326037364854, 844.0495474614224, 870.7128688552644, 642.044009775709, 714.2007992941317, 740.7600850333712, 691.2699647606877, 631.6929601848514, 677.8004172437564, 745.8528639363655, 588.1053260412555, 545.1932988241481, 653.8332273571658, 618.8672552394273, 586.1309795586943, 600.3730585443159, 644.9328259330515, 646.0988466816189, 651.9542753575265, 791.4804547083975, 638.5571886465061, 836.452751630726, 757.7499703583284, 578.4311483249152, 628.4188380656749, 556.0460958792091, 713.7903851707681, 800.8291136690293, 711.2446118101766, 683.9077923644978, 685.714539280287, 599.9118281005234, 721.1416526321054, 664.6009785886592, 774.7229175788549, 657.1572561853021, 691.6971611030184, 753.8840055777458, 710.869831271233, 706.6817051080698, 713.6663635846072, 523.3636792417755, 699.7836581330953, 711.5260707196447, 935.5695084286343, 766.4175862888658, 713.0885383756685, 748.3961923000153, 568.8086252730263, 705.1280239667411, 580.3117062638463, 687.072819043254, 689.0008278312639, 699.0113488614398, 691.6427129793955, 529.0878084274285, 937.7968498771977, 933.7967606788313, 736.2940335622998, 690.7935869020066, 639.3354272928462, 655.444334588855, 723.0386215130751, 614.8523187009444, 613.3828599233384, 677.5137308854778, 619.6496565546242, 670.6736496516775, 737.8365250163174, 638.7700986770107, 683.2360855408087, 691.8372157395515, 557.7734360648027, 939.060332584821, 847.5885052483968, 806.8142275792649, 721.3057831265943, 712.3984218080886, 863.9843028070985, 774.4162215606415, 763.5034855034555, 498.3333333333333, 520.1648625453195, 725.3158404594967, 721.3323943893819, 800.3078681321556, 929.0830390667713, 701.2613635495921, 775.5390382703077, 698.6957738189676, 881.3046761256388, 754.9318555243113, 680.2684200743985, 663.5223394319413, 659.6358074313484, 830.1600282565101, 627.3765263798869, 758.2357826319392, 643.5469204983775, 692.7864615570749, 840.1394782474188, 717.4343062879715, 663.5866559348211, 645.0166845227327, 703.1984538756893, 550.772082068189, 616.3756849302132, 712.5651547295624, 634.9489125390229, 506.4819251631608, 504.01504635884544, 813.9059569310177, 769.2512001477735, 556.3422239660164, 784.8970595526109, 830.5243046648707, 731.5147864252804, 659.4275809559083, 700.1000954953761, 745.3850833216808, 747.4016599825673, 750.6638089680812, 765.1325789044201, 498.3333333333333, 668.7658140578984, 625.0714950301787, 731.7559149841992, 706.8257037271068, 750.7681632152177, 940.7692307692307, 840.430781984222, 914.8177515696292, 937.1089868494585, 808.2453892768783, 575.7811494326045, 695.4716116399371, 580.047739782139, 660.1265808930027, 632.5903918055178, 767.003151487837, 651.6336800620248, 636.5101632161783, 739.1162399613223, 648.9802025700418, 648.4857540787459, 736.8312339041302, 795.7965091800323, 806.3068291571432, 685.1246416846674, 666.5093664620524, 757.5705480157457, 689.840767912004, 648.1624430861078, 644.6302933190445, 548.3996960418493, 581.7414403186767, 775.8435406467931, 533.1044467223483, 735.2686121725687, 611.4541319347971, 686.5788420746724, 725.349007675114, 914.3884189514666, 705.6628307179625, 873.6499836573016, 619.3195679053076, 552.5474111513805, 757.9500268613828, 668.4242041776367, 751.7840054541921, 743.5071657157945, 633.1759422635457, 695.0023043952053, 526.7230589842839, 731.1836065425127, 617.0459373104113, 684.2695043108647, 631.6316636282438, 728.2578434178359, 695.8794824578141, 701.1505310935037, 761.3458371171394, 641.3936415408203, 642.2646489799688, 646.4539984084487, 550.158956993294, 560.6081117101216, 722.2700819068094, 663.0022613015175, 743.0923773485357, 690.0958892006532, 741.0699935683381, 540.4270600129789, 663.7133206232392, 709.423846970927, 592.2441846335338, 936.3156283230454, 934.4237479528668, 631.627268546294, 687.1700658167217, 672.3813495455381, 831.2090284189255, 693.7859316995053, 500.9545927467941, 629.5751611687779, 678.628211039666, 727.583494156508, 723.8928472937554, 935.8947966212421, 671.8274639424535, 628.0394232205728, 876.6864923522003, 746.3099009577886, 801.7227859663608, 772.6674136519571, 687.7199487093351, 935.4351189322973, 644.9201599228958, 634.6770289335959, 712.1128253576225, 939.3422300497223, 775.4121742469026, 587.2716648941476, 940.7692307692307, 720.0089517082052, 805.5955185045956, 630.9947818722187, 747.4786367006232, 660.6585318009494, 648.5398374272164, 516.558610915385, 708.2004988148778, 662.774976493381, 859.8818334542503, 592.6517160875783, 754.8054975961174, 737.7750705847685, 693.7076443720395, 874.3038844130787, 674.0529273459168, 619.3076923724045, 669.1166071135772, 879.1776039660714, 701.8175946053705, 635.5386879267869, 924.7525388545582, 787.6691124862242, 625.8047578784574, 670.869585410755, 660.0517622795785, 514.138464451535, 655.7850999601236, 641.7022004653849, 498.3333333333333, 709.0810892477782, 758.0341464471629, 658.8557319224572, 658.0109234138708, 734.9106232595441, 780.5640233911705, 498.3333333333333, 666.5220739294762, 752.3762212314268, 622.9821922476032, 700.6409444218884, 712.2577333262393, 648.7769082067769, 825.0985457929737, 664.5558411535645, 508.6184907665811, 655.9636607737067, 722.3747586710053, 733.2653069943879, 725.1989724158684, 712.3458258225412, 722.506464873433, 622.9549393900917, 903.486469262337, 626.8501365334081, 722.661789814595, 662.706365330941, 796.5148867529768, 575.3270346767962, 585.6688172908598, 619.867861442707, 865.357167680516, 629.2197226790362, 660.5903119137481, 882.2591264756513, 693.8704030204543, 663.649715910809, 649.2380902683813, 678.0413025856045, 669.2471226035769, 557.6946564687757, 588.138026160651, 940.7692307692307, 717.5361203454792, 705.1048910654442, 906.2432155079417, 684.5226439286896, 585.2763776343568, 789.6596370082538, 665.7925741960486, 768.3112850434969, 747.2052645384698, 557.2419147778282, 736.2424521976723, 656.2618673079033, 923.7510357298826, 513.8456019617214, 645.7799441348466, 706.5462246228022, 647.790249827628, 846.1648387112987, 593.6552372634355, 718.0734829535002, 708.2918571108532, 731.9715865680173, 739.454508334448, 639.0006618527258, 671.9608933683293, 642.1542319940163, 692.6402510179859, 652.4373405654569, 725.9047801539649, 498.3333333333333, 875.2471918417315, 583.7482819817408, 570.4963568832388, 762.7469108244804, 498.3333333333333, 617.3184564465084, 619.0466346979886, 689.7273091874166, 709.3586861113716, 708.7246157800793, 661.6756339145447, 566.4348490248451, 677.7266541758003, 767.9272162216124, 629.5587304349648, 622.6090117981726, 641.9398502154215, 635.2857441222328, 713.7294634871238, 769.466910175826, 764.1446459110497, 887.969397323147, 673.4217563563303, 698.5837022601335, 727.6611683628876, 940.7692307692307, 817.2745237906215, 601.567146271864, 746.583566221456, 663.9496241555671, 842.7111305750171, 561.8902303328251, 703.4430731215452, 669.3384472620991, 498.3333333333333, 552.5892447106521, 716.6444546454902, 740.5173028858834, 718.2016166171909, 652.6843299232079, 700.3266479783256, 723.9484094792356, 558.4651949082069, 701.0471215127155, 498.3333333333333, 684.7923510114706, 521.8906937571923, 664.1986270618561, 619.6281036408524, 751.7169879082594, 762.8863068096983, 656.4504429064116, 617.8102899992734, 688.7619779370851, 824.130879646177, 837.2478139442167, 849.3026845740462, 908.5127558138099, 683.3243198333162, 601.0247596840534, 693.0067165822032, 937.2144266402506, 707.2142601521981, 704.9554993923911, 498.6407525709712, 854.7663458487549, 723.5705238480726, 530.5607726705231, 657.1827864143785, 648.6995349305195, 682.9254649231088, 666.2853675217061, 632.9497065469923, 759.0392868573916, 625.6959604270547, 839.5318803858801, 666.4056599686743, 677.9264156885386, 742.472183667946, 693.7423817431504, 743.0023386520032, 787.1530311012046, 720.5106397420569, 792.6069923695031, 666.8311308730812, 800.458736563087, 637.7334086037517, 805.8502038473559, 738.2423670809352, 743.1775171540112, 575.757535432421, 666.2589226275319, 708.9131387867542, 653.5212910989846, 935.6695733187195, 695.3679365443842, 501.1038245547993, 681.5378684860223, 686.5846162694494, 649.8299099981296, 624.4371935429504, 933.5928826146902, 896.0873907003651, 675.4811215113709, 750.8815944601139, 577.3816041583609, 717.3503520168618, 930.4346094936678, 820.8988935194587, 940.7692307692307, 710.7312985635498, 707.0220232478391, 726.3708285330563, 607.0085419735929, 591.6215042997867, 705.5678864794814, 935.9508679702708, 644.6975037146163, 649.2913194988606, 667.8561470647485, 618.3121909252565, 802.9861258861496, 500.82393592555223, 772.1451624951214, 635.014392969434, 896.8158089761172, 769.5789595799616, 552.5977236469125, 712.9112768076037, 628.4402961698429, 673.4212335760152, 700.3053329721362, 570.9934804399127, 710.9372818092733, 910.4331370522767, 758.4980555981856, 649.6017145858157, 661.2982309600718, 875.0840777712195, 751.6939309029275, 739.5449232493941, 721.4879940605908, 840.0543733722268, 743.4975135425201, 752.0604733653013, 633.3911105658984, 630.6653689350202, 703.5865790495192, 723.6832264880128, 680.946716457834, 759.653981478947, 799.9020544368944, 770.4541474004707, 744.0449580710081, 802.7536227454066, 679.222783414125, 636.4370451176394, 878.8396354586455, 689.9558074480017, 709.5785960294136, 665.4030304953939, 692.9688789539252, 854.1201042943866, 819.9123321407068, 689.6166678042841, 613.5690529519178, 936.7540542799467, 665.0815190169711, 592.7524091474384, 704.1676739046792, 649.6753961059118, 749.869515482733, 701.4608777021713, 885.2130127234387, 938.0378504046006, 621.0661874293394, 774.4018048028773, 728.9550037823701, 841.9471305015866, 846.1920189034132, 705.8463781972108, 752.1435206800551, 662.6286644367927, 656.9899738164171, 666.9799660326844, 673.2943215791622, 545.3592695569118, 786.4618607680432, 696.3077765155684, 600.039383247499, 583.2970588532081, 848.3279044046956, 717.1191307832097, 571.6962207264083, 652.8204586468273, 676.6448065640641, 709.3958954461359, 723.0018350588925, 669.4781263278477, 712.2164033823705, 695.3237699294377, 685.7451595947063, 747.7312333218397, 651.0229794477058, 498.3333333333333, 909.8836010714527, 666.7383030176404, 754.7780184047414, 647.6524008165418, 688.2653223904014, 634.0948127097437, 594.5508681611846, 676.8650842826183, 600.1214848242045, 938.0374091299565, 543.8756982540247, 662.849580205939, 607.1434606924302, 812.4934055130043, 760.8863207040787, 680.477915389811, 693.2940911832362, 669.8732728095373, 606.2748443855417, 908.161376178593, 618.856203504256, 691.287667570034, 708.2685496705438, 857.3236983809879, 653.1970363945716, 938.7102982509022, 642.4013018799029, 861.17850877525, 687.7218158150768, 701.4450364624794, 595.3129389955773, 706.2355158634663, 749.1049185480185, 733.2231866547542, 582.2534045705007, 650.7119903834143, 723.1530521503026, 710.9200088120008, 875.1063017282894, 661.8315830847599, 907.3710068810373, 634.826937772179, 681.8286359126482, 498.3333333333333, 791.9541647733794, 700.1213568404946, 520.5273989175905, 592.5275739813478, 749.2823751139283, 674.4238300311243, 691.7849892910509, 669.9586710135444, 749.4936815026552, 699.0532626582134, 880.8992173120135, 681.3211782412892, 657.1795977201996, 710.1862998767706, 884.1047654916664, 617.8118063955219, 663.6504346423181, 751.837554921031, 714.5194724784308, 862.7560996039862, 779.3984803354818, 735.8431827521985, 587.8367886029118, 744.443779642747, 643.0042662919856, 735.8856408336467, 672.5738351203281, 703.2312502939499, 626.0552460082298, 735.5909333860197, 876.1075860152014, 841.138858499723, 735.3443287680644, 817.5790577510575, 660.1848798617116, 729.8088136817279, 498.3333333333333, 904.1435166820913, 675.9964392007528, 796.6792903641918, 732.1176581696667, 680.8301364798831, 937.8531057816589, 673.4312054742815, 509.6516561717923, 728.7809027012337, 671.6606771099869, 614.077340800514, 705.0486222917423, 739.4806009086882, 937.3659364870526, 642.9469663951245, 700.9635790190531, 777.2799396433795, 681.9867492696463, 739.7104954416834, 735.054327201605, 645.5105430693798, 833.341631483797, 611.1337562224868, 843.9731440782307, 746.4194297702148, 507.5930309449357, 600.7267775702525, 684.2545728152903, 770.4813248900142, 735.1254169880309, 686.1632406145084, 688.9775284485712, 699.1773114565019, 694.3896087138393, 709.1273711534903, 852.0013168944027, 734.0539901801899, 623.0756027230025, 838.6944462881085, 707.1167777110371, 759.9297861631909, 683.1784058945532, 723.4014083572896, 557.2419110919394, 652.9324232175395, 828.6199668980057, 640.7211462611202, 756.0257010747468, 739.1457242635477, 667.5174541064798, 731.979267520431, 624.6342695350061, 756.0134580429615, 742.6973239620677, 745.8797875911998, 738.1870121261576, 604.3684320649985, 643.8467489490226, 530.0947059517442, 498.3333333333333, 780.2836123958627, 686.3876581715284, 804.9411272080519, 756.2808094157318, 743.6429098295151, 784.7080394965619, 783.8245132187603, 703.4637358591202, 811.9450950917529, 628.2813480386119, 768.4805911778258, 498.3333333333333, 728.6098155679736, 686.2620501954997, 825.7089113967251, 530.533526420084, 601.7401570878362, 668.8114191479385, 834.8429893062814, 675.4520636508215, 795.568949818328, 559.0441978806008, 630.6600559305305, 684.4242109701368, 938.9226656826681, 774.2622555659921, 639.507289811643, 589.8003906703104, 603.075690359297, 879.7631041687347, 668.4562490366366, 615.3179926826901, 892.3196981213192, 692.5696794864883, 670.5816778084289, 716.1691660076172, 920.9359362956486, 718.2141909655777, 718.3462169436813, 703.7686949764238, 738.0042032350049, 727.9128013205889, 695.0952214323931, 657.7497567281213, 716.4691786312981, 725.1416791808953, 684.6660114909013, 929.7482698447594, 655.1477849114005, 691.9879310478274, 688.8063698065127, 619.7864783919725, 931.3546256011638, 932.4097118927147, 670.5846395130262, 692.5072409265301, 678.5916529687256, 729.5051179806501, 641.226518185149, 621.7885583049768, 654.6262640643196, 712.9054576093453, 935.6746729979685, 633.5580554508869, 588.6817542528727, 642.6839509246781, 765.1441799577743, 640.532576277482, 626.9559181469978, 547.5834365332183, 764.8356452805697, 710.1079229710606, 635.1565296745516, 687.4107161083363, 794.8711424696149, 659.8517300960557, 647.5589077324531, 685.0103301767778, 674.7624621174637, 712.7324016529175, 557.135995159001, 766.9852172259642, 740.0182726779327, 691.0737597710627, 625.6316627091275, 862.1485242118758, 828.3531567225862, 934.9511273066328, 689.358434262543, 795.0374367553303, 723.0637701055934, 641.4453834575891, 744.6172538747655, 673.8590063470652, 716.0523230276224, 640.6560172532365, 655.2910178644096, 748.9162634230031, 705.4277097241245, 611.602331977925, 661.4598424384175, 843.8425235427228, 641.8692833222967, 789.3291801131886, 565.0590287249445, 614.1857705257053, 669.3503271012283, 679.59833389361, 708.6940857330269, 640.1852042793022, 721.9260696947359, 673.5281184475118, 626.1358821661047, 737.8638040946848, 742.4636706613356, 808.0737125038744, 785.9370955042184, 917.4326076189392, 636.4287867515627, 519.4128278879084, 563.5063348624083, 886.1916566262588, 636.7920379155094, 563.8963658791404, 729.0618514289137, 683.9535154693722, 934.1138117833193, 671.1278056174538, 785.7836476426555, 676.3060687261095, 873.9897851379357, 650.2226778321602, 614.1312358547607, 756.762392916557, 798.2088349951953, 936.1678153849325, 713.3610147333854, 739.5341555948771, 872.0898410690158, 656.9538032840808, 728.4920452297501, 787.83251740122, 737.2540529699647, 607.995961392943, 645.7588767023144, 702.3170086507546, 644.562707626599, 802.3139930029291, 689.3840923469644, 680.3700717020587, 730.1482914781606, 658.2774058992708, 756.5250681716385, 652.6901318247716, 649.5520354903995, 940.7692307692307, 592.6654357906558, 940.7692307692307, 742.4514788602863, 614.0211680852888, 717.523661691422, 856.4209547043517, 790.8712474169505, 613.8159745765877, 929.7779650512281, 600.5158607878003, 696.3211036337848, 807.7333754611325, 739.66271479114, 778.0351372513102, 626.54626106078, 636.2390650596063, 901.4397827296426, 724.6397092110727, 763.7078518730718, 579.6810139660666, 835.4315173896202, 542.2688571623137, 694.5853267566881, 802.4894237018613, 747.6631266294254, 758.3576367940883, 822.0588287176197, 684.4721865671264, 813.8912818537216, 936.4141232199315, 722.6609590424171, 913.6774128875215, 754.0861675178052, 767.722034257241, 764.4084084680936, 501.0179860379501, 687.4893018215952, 672.7723710393217, 909.7974364896966, 745.6746388918983, 675.0935115258807, 779.2516001209442, 623.545004561998, 809.5144584092027, 714.9908038174265, 739.9109608337003, 679.0469243627404, 744.5277060800553, 713.7266468911372, 710.8942853923376, 752.5569159212073, 654.5428561723879, 673.3107041966432, 698.9967501460712, 726.8688825470153, 631.5761509725736, 710.8702282199536, 716.6552458720028, 683.699622329534, 531.6178338635605, 833.6933298054081, 633.5129411451223, 927.0007760744465, 674.9411572348769, 545.6738744843174, 654.2746991444418, 678.5568268795448, 737.7493815242108, 689.4885022048303, 712.1910430835987, 757.0041421729683, 715.2778437173264, 676.4031996372566, 755.3840171709154, 758.7615722964464, 837.2451420790807, 661.6608909564764, 650.03893768563, 673.8297976602537, 619.4709307220115, 685.0178015243578, 661.5633926682224, 668.2812671161768, 699.2308481310664, 735.2556143680517, 498.3333333333333]
thresholds = [581.403481466257, 692.9914699579077, 829.1916190434733]
display_name = "Coverage Factor of Treaty Funding vs dFDA OPEX"
units = "ratio"

# Calculate exceedance probabilities (1 - CDF)

sorted_samples = np.sort(samples)
exceedance = 1 - np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

# Create figure

fig, ax = plt.subplots(figsize=(10, 6))

# Plot exceedance curve

ax.plot(sorted_samples, exceedance * 100, color=COLOR_BLACK, linewidth=2.5)
ax.fill_between(sorted_samples, 0, exceedance * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Annotate thresholds

for thresh in thresholds:
    exceed_pct = (np.array(samples) >= thresh).sum() / len(samples) * 100
    ax.axvline(thresh, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
    ax.axhline(exceed_pct, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.3)

    # Add label with formatted threshold value (use format_parameter_value for full units)

    ax.annotate(f'{exceed_pct:.0f}% chance\nâ‰¥ {format_parameter_value(thresh, units)}',
                xy=(thresh, exceed_pct), xytext=(thresh * 1.05, exceed_pct + 5),
                fontsize=10, ha='left', weight='bold',
                bbox=dict(boxstyle='round,pad=0.3', facecolor=COLOR_WHITE, edgecolor=COLOR_BLACK, alpha=0.9))

ax.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=12)
ax.set_ylabel('Probability of Exceeding Value (%)', fontsize=12)
ax.set_title(f'Exceedance Probability: {display_name}', fontsize=14, weight='bold', pad=15)
ax.set_ylim(0, 100)
ax.set_xlim(left=min(sorted_samples) * 0.95)

clean_spines(ax)
add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from

output_path = get_figure_output_path('exceedance-dividend_coverage_factor.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Exceedance: {display_name}',
    description=f'Probability of {display_name} exceeding various thresholds'
)

plt.show()
```

*This exceedance probability chart shows the likelihood that Coverage Factor of Treaty Funding vs dFDA OPEX will exceed any given threshold. Higher curves indicate more favorable outcomes with greater certainty.*
