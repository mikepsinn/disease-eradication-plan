```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Expected Treaty ROI with 50% Political Success Probability (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata
)

setup_chart_style()

# Simulation results
samples = [573749.5621341823, 616069.69126213, 744440.43175107, 647404.1396099518, 711468.9880384291, 781707.7674305418, 648249.7075891474, 935712.0017909554, 731152.4786850059, 393894.95758218877, 548775.477458089, 532948.4369737285, 683851.6741559572, 467423.4888225644, 728479.2263106103, 332750.9803740478, 782137.3538480514, 883676.960627582, 472656.22359199286, 481779.3004810195, 743182.8486822591, 496419.6519252334, 606907.2911169231, 837895.5505524942, 369557.2272986253, 619706.3007685638, 637552.1442919086, 687941.7933115643, 533811.6162203469, 463092.1689472825, 405366.2303056497, 545522.8683082045, 579829.5027193419, 898591.7102505553, 432445.26415869745, 1009255.6605399626, 595792.4196788777, 762448.561715245, 359305.69507693936, 728854.6501819498, 265870.00136150327, 622802.716458612, 687718.0495816957, 769463.0591618549, 846086.883611919, 857940.7183060908, 668434.1818362274, 248361.51531408483, 752947.7865788345, 720535.7716116451, 668432.2316711555, 416464.9256702989, 346992.0397176528, 560848.5567404885, 499573.05757150805, 624182.2032162079, 637083.6586522511, 1008067.1362544625, 348556.19810215663, 885995.5292389058, 218323.48270864587, 778882.831322982, 1014760.6663892493, 993448.2427509007, 881533.964529726, 715308.718497017, 555889.4858008738, 662896.6280337899, 752246.7939282833, 417737.5614086073, 442504.96147661074, 676549.0604345339, 871016.6624999467, 715629.7504612333, 411505.5074268466, 557661.214349077, 200577.50603834866, 757707.5004962436, 505027.6710166817, 557883.9014790292, 737753.4126551552, 638972.8353537619, 531604.7379185137, 729947.8305692034, 435957.93173161393, 670338.8596933436, 580248.5412600015, 615438.5469507241, 250709.88439002322, 712144.8916327367, 713012.5821399702, 688372.4621792872, 830817.8762936568, 924281.2392948907, 503528.06955379184, 417734.8051282614, 339244.6846513822, 917651.6560756839, 443237.5802666761, 549106.0004433912, 609671.0595635184, 496454.14864954166, 603620.9289868235, 934107.9375495584, 192948.2084771014, 483006.7857632056, 502281.70800983184, 724976.9973614103, 396591.3098192068, 506067.864331488, 490953.71000820806, 652467.3270569334, 538975.9705452858, 400641.6063621619, 796147.5409359044, 840236.7304664013, 730148.4365506113, 916964.6421681885, 495230.93505060935, 723302.1545983251, 477648.5824507853, 772766.6895406654, 651718.9161957697, 740933.580741724, 424016.0145244513, 817803.577648152, 879268.3549113374, 187444.7083084501, 263423.5643775748, 764089.2530111885, 530005.6994894121, 549165.2049905837, 330949.2100406106, 620112.334415706, 651212.5591625205, 774533.1731839238, 954388.5069243048, 338768.2641919356, 528790.883905223, 520374.43842511397, 689336.3670034955, 678465.4199186582, 531217.496154833, 519222.59986847226, 511841.0806637619, 366416.7617048432, 472176.8858381657, 634076.5402999857, 902411.8307192401, 853280.7092660796, 902681.7945573443, 476946.31181816856, 522461.4111242621, 866017.2703763961, 974030.2814775424, 682449.5833844452, 417231.10778712103, 606127.9962193413, 591574.6748801598, 683438.1831643863, 842211.0799667967, 593199.2092690326, 852946.719387108, 882607.04728326, 907492.6920947084, 407279.1840550752, 766537.919969548, 356062.898073955, 487353.28149012773, 873350.555004889, 437099.872814413, 418312.48315726354, 845414.1621508257, 535450.7173253185, 426172.0321207692, 519864.3297260847, 869547.7089029687, 374483.9005737064, 915946.861743541, 900624.7121049587, 599953.0921130012, 501957.8150524987, 424438.8847762011, 982888.9788539896, 453908.6849127245, 395673.5978763808, 669654.3354871457, 899712.9837937448, 829586.8016242613, 419509.1745827839, 563527.3636095409, 282822.7315824111, 402595.0159824024, 692494.9844120054, 626732.4851488465, 246265.5329456474, 669611.4634615362, 446873.3882425407, 403223.0798925671, 622695.6461038552, 577017.9821354884, 964625.1162061973, 627788.7750522466, 458354.2315917634, 759215.1870265917, 611871.492736211, 730714.4640486056, 495021.72484618303, 711606.9526360119, 329735.3856499096, 739382.4616997894, 521387.94161362725, 364924.0947298262, 636112.7003110936, 304133.1992320835, 578744.2931361989, 718661.6892114171, 970732.0448226216, 484900.17166045547, 719198.985231754, 500245.6928042669, 1004556.2263400472, 645958.7790254207, 783939.6152323324, 321412.08024610847, 330143.4416528302, 521266.6723956967, 443945.80486051494, 678571.5070931239, 563840.965124855, 682751.9001768023, 561215.317471402, 642542.2887293772, 567405.425535797, 611175.6493353078, 579331.2759887135, 700191.4909509311, 340719.24100389314, 558975.2626344018, 611541.0898625177, 905114.5693027601, 800047.4094265263, 498009.61314661143, 869129.4545057869, 607563.1451479014, 733113.3239003058, 766307.5085371389, 934753.5874964715, 513340.9648405333, 836563.2039035545, 464680.6720882408, 869489.9829723797, 703313.8817142504, 649813.5377082826, 534904.6382148801, 917604.3670343676, 724064.2421482601, 679203.5006537376, 618432.880478395, 262944.3027392322, 847789.6691976557, 421572.7632979996, 880328.6781262284, 818623.2035787298, 703273.564372681, 424853.4829434992, 397476.63135957427, 673777.2169571652, 660861.0700065836, 305567.0766708179, 615669.2650121646, 339579.28932876437, 506711.3035310093, 622528.8769740284, 334723.2265779419, 439983.0803334643, 522402.105433285, 503190.5908201019, 644505.8183350345, 845384.447539653, 787477.9722201264, 519742.42828918446, 735247.0823427861, 670017.8171752432, 568525.1046880785, 323390.92399001477, 644679.7155787672, 635910.8078201133, 321807.45157060586, 777804.6227824579, 633926.593372021, 531799.444091645, 997698.3595165844, 877086.0773742169, 299434.855102162, 890752.6290357715, 742364.3193995584, 585640.8700188264, 588245.3797576138, 372981.55199323676, 468479.78601502196, 436876.4195920881, 656947.3102065743, 566112.5320573295, 663029.4778758417, 704059.0039854475, 735922.8889333672, 175150.85845352738, 698653.3062505594, 772979.0970979849, 876692.9223003249, 768334.5998180071, 498816.8168935778, 557014.8226456848, 928945.5374447854, 237734.30210069413, 767932.5649683643, 676750.6145617465, 714733.2947814512, 488531.76978672564, 527480.2781440037, 675705.269821002, 863488.6207035321, 220375.51780098237, 646860.9230150928, 809801.5670743644, 196553.21530084297, 679393.1630469972, 217752.69020734995, 153154.71762274337, 470258.42586014484, 460379.2117194241, 510333.8322044697, 758790.4314467936, 981322.7319403637, 825159.3553659242, 425690.62708289415, 755342.3060017861, 770133.4102403147, 990713.2535427146, 526722.2482403122, 618138.5758846769, 592329.8955862528, 641339.1027739784, 506538.62036160985, 604148.8931473882, 328499.68031474634, 470166.6206658672, 179190.15916323624, 808752.3644008556, 324655.68225922243, 464665.08075375203, 808902.1707530417, 660582.5706300911, 638640.5011610226, 432829.83787722664, 913325.7262922971, 762571.9181971565, 406318.4518423526, 376369.35216547764, 862328.4164382457, 385720.97599595063, 116725.62347737508, 467427.09862082696, 475251.1372619993, 470955.15387102653, 569082.9204427641, 570848.6003128113, 460751.82357431704, 853500.755684867, 244191.90753987484, 291515.81187778915, 239824.69500065086, 666228.5446911331, 732937.9825621017, 580368.5610245897, 632122.8876892924, 588668.057493136, 487907.68502757297, 694453.6828701323, 574493.8103832414, 293557.5151811675, 732757.3726402761, 738112.3557198158, 597009.6999921891, 573701.8871005835, 717683.6755672591, 654481.2931808954, 457346.94914702134, 522275.6666918983, 429717.4255198261, 589641.001432201, 535560.5619362096, 905030.5975840201, 604018.5527243908, 319254.28995088156, 706156.089341136, 792685.6487136988, 826173.2565916213, 498250.4210717084, 656369.9423140113, 336121.597734793, 270531.83900027175, 705537.140722923, 585825.1980489938, 958723.9449179701, 506311.5668999628, 639812.9260761118, 639529.2535737854, 466467.0055762675, 581473.6385957741, 527948.5033781172, 779759.3002580749, 643573.2944756869, 477647.1344962135, 543393.7529888886, 445989.03269316483, 460946.80982764723, 621094.530184734, 597693.306304381, 468016.914341076, 734662.6786441653, 631502.158810089, 514398.3535778826, 548307.5929359064, 488491.1158264352, 886257.6886046396, 927182.7986060622, 757086.0805107219, 977522.759966868, 563529.4536593322, 770726.2165609911, 229262.30553129758, 653120.2187963458, 643906.9308558857, 297335.3301818918, 574738.7310243456, 932210.1477099644, 457353.1410322666, 843413.6014217279, 459130.4772184028, 891677.8917854253, 681477.4301207196, 496495.65565942595, 962789.0195345975, 386864.50630549237, 645074.0783131386, 794764.287965333, 339652.6701162543, 277187.47109543683, 671327.2227520918, 607137.576529475, 475725.5425750086, 817249.2943080928, 942925.7500457488, 700847.6434228946, 794929.8962112655, 621442.1580389009, 524675.7372798786, 588271.1684647267, 679578.1787190498, 703851.4722476422, 771146.4171815331, 428623.9837556987, 646934.3203780412, 809422.5332704372, 952977.0294581484, 324987.18580060237, 561616.9346591887, 712137.062300034, 753139.4489221411, 1033470.6101045513, 791072.7244490169, 642103.024868797, 826699.871088141, 354171.7434684772, 857798.783089217, 740230.4172893306, 430920.81664414966, 516755.34605783335, 668039.9995692116, 967515.4843286674, 618863.319109922, 604035.3595255236, 786828.6930460415, 590610.6843952825, 549375.5465723698, 989523.3637969614, 451358.53677297966, 846167.3541395684, 694592.439590458, 530669.3615765322, 562562.945871377, 715425.9949144417, 774184.6526111155, 746493.9874101625, 535200.28906228, 576363.0581575357, 651775.6211901429, 318417.2373386667, 704898.995038666, 361495.7920947279, 479630.8483319977, 837942.9154164304, 597054.0905803991, 593593.6541671955, 403002.90803396347, 522937.90083619446, 840699.6870095033, 636997.3533549506, 422640.0791275953, 715603.6727014295, 833744.4840884029, 412532.447487328, 652678.1350060364, 943105.2557994464, 652336.3746128842, 360025.17225635576, 461165.0298931801, 748912.8720421216, 297326.85787417594, 925752.3613094935, 860580.3642164271, 774808.0172126362, 507341.56729781575, 625755.723093185, 710188.0377949445, 563969.726692949, 919963.3874988586, 559184.6260080464, 681282.8943015645, 557002.6102567755, 502491.64479766384, 844092.9008066752, 625516.3355378014, 477994.7669089035, 675232.8053401515, 1012761.2704646537, 545216.0366581173, 724875.2987816997, 543211.2279281757, 768444.6589053728, 721252.6614017837, 645554.1432913165, 534938.582057245, 611235.3393854486, 1094385.260538506, 351849.92813839647, 787179.1156718786, 456401.36586263403, 639463.589251718, 540077.6697893916, 840550.1834994664, 565156.3332838186, 912023.5013747818, 723178.6787693548, 610604.7570800295, 416715.9249917309, 769010.5174632479, 543203.195319976, 762062.1835335884, 983253.3740268843, 935508.5197773885, 756735.8782761899, 587907.6035344753, 536281.4275751208, 243562.67805858026, 596529.7046454031, 297347.798094279, 701849.0854784122, 460817.6779795584, 645186.3854447327, 601424.8116219798, 668736.9790152409, 637370.9515333456, 885749.591732604, 1015062.6090316082, 443198.17665608454, 682864.5020311151, 744481.4439499127, 340513.5468044667, 503189.3837892506, 588138.9445205409, 746978.8643759552, 745594.2012860555, 766688.3945119428, 1003260.0207587115, 735728.951549455, 738612.31778928, 804762.3166890619, 458621.15706614894, 877665.504952616, 760896.2221842632, 588797.3118404057, 615860.1515405811, 684214.342598861, 819306.621202133, 963692.8575564892, 1044726.430152181, 441232.6889829404, 666919.509449778, 512691.38150221325, 459253.88459991297, 352506.5801803638, 246939.56505602744, 439735.7137745951, 204776.71100045493, 395051.60229001223, 765450.5056822114, 510773.1804501216, 340859.7563501911, 793054.4161219787, 722431.0310682759, 816848.8049775348, 737357.8258788132, 938645.2788317574, 458018.4315700455, 591384.3911726313, 768535.5957380818, 811165.9198763025, 235438.8337142249, 825721.1821511812, 603249.2420697073, 757014.6570963556, 641018.1769719087, 775027.7365406494, 466958.5380812825, 604113.2295410774, 667375.3620328067, 519645.92611826793, 642695.9587660948, 621188.433955362, 368390.01773814246, 438177.4893488346, 740113.2762353445, 732324.8854141374, 304842.6843219109, 545114.2305625656, 330845.0026373037, 720477.6102138386, 310938.44079352025, 554553.2095126368, 396853.9685545279, 430014.41839341173, 600877.2500608104, 600381.5477778988, 328390.0903606898, 633494.5253504105, 581462.9786424211, 445437.20225565217, 814597.9473565518, 529469.9907316117, 777426.9486392899, 489523.53805324377, 331085.6049654912, 679313.0384456491, 520802.2760031511, 499297.9115288343, 424569.0834724568, 768443.8384151896, 418644.0521660021, 687220.6982052823, 732484.864397032, 677172.60393888, 1103968.7723348693, 523480.88409410877, 377625.96198050515, 760307.1786734455, 674069.5336108173, 385883.5087350876, 650988.8465404921, 640889.0732694872, 681829.8520414279, 631386.3200001436, 472207.80039311823, 454247.0128295611, 681037.9603613105, 325847.038874745, 1064374.2345570617, 515220.08732301556, 447416.26774808724, 825655.0117859814, 773955.60287001, 588282.719258384, 627400.7527982983, 610338.5272889162, 423699.11934035766, 974119.8157829718, 832923.7627340603, 777056.3370062454, 835906.464994355, 554687.5009653453, 284774.4041807284, 316137.1773639972, 631027.4965673377, 305155.86586953036, 712290.394923527, 378619.2388486256, 623449.2460826768, 575369.721722188, 464847.1106105944, 685191.9129073237, 850111.9028746682, 942827.6155398341, 466607.0871635101, 599874.7415140329, 595000.883427689, 834437.9115122546, 380275.3048962838, 805552.6485454448, 491471.4419298202, 656931.0010503941, 640438.2376396916, 559826.5347798028, 571192.1611656407, 432083.7059722126, 700205.5168128404, 373160.044335815, 272150.5895033, 766278.5451321544, 702093.9577544528, 497013.3839394986, 586086.2476878549, 588348.9835741322, 499355.05719037657, 720587.8238622807, 534648.9577115567, 487842.1454286057, 593806.0600038439, 440814.79683329305, 145683.5711061247, 740402.6705754997, 764257.8499305323, 708756.0519309914, 471638.7421958413, 1125040.3074221492, 917496.3309979773, 839528.8794305717, 534662.6961409324, 660369.371475007, 933792.214537598, 679635.7714550216, 373895.2890808462, 411592.7675887273, 748593.321605446, 612222.529699772, 584214.7166158782, 650525.2835282801, 272645.1779873793, 626493.500394637, 546334.4155917102, 269059.7337354821, 462961.2791254559, 417094.5980023184, 652660.108334655, 562724.7108736305, 393417.604792155, 926127.2671567941, 850347.2998143112, 593555.9887568165, 613586.318852421, 631305.6596337222, 691754.7313513368, 506964.24433167354, 940838.7808658957, 713842.8427715304, 606950.7801340078, 620934.3684486786, 526854.217310808, 468103.27271878097, 842998.6658325533, 255416.8200813667, 536341.4286429276, 861638.2725386987, 853318.3433657655, 692381.9901599718, 426384.538371111, 421051.3013790802, 618695.9272333088, 333002.5075784618, 633463.9331000076, 802548.5597435277, 563682.6248907025, 653641.2855249132, 782124.161847675, 717193.4022275979, 525117.5588595398, 923595.7454235215, 659087.0869129419, 798529.5628833821, 706198.0895415966, 647345.5226458048, 617359.7516456085, 775302.7751757052, 325499.30477315723, 909255.532716549, 605169.4947910564, 332456.31367779645, 522436.9811401962, 537304.3590071866, 313898.55068258534, 624457.2318100148, 641317.4222164744, 537900.9194783433, 557031.4153461554, 414141.45471085457, 653514.4798325034, 863408.4188692037, 544281.6145317445, 661534.9882544534, 704289.175022991, 591021.9800192998, 581942.0344615106, 607944.8867285659, 386196.06042358454, 497983.0888247165, 463193.53554011806, 755367.2995381372, 784540.3240511165, 703229.124536986, 627038.4852908892, 812562.325582165, 438586.7794038872, 627355.6975464426, 829277.9775812166, 593042.8592843222, 724946.6750881723, 401650.5357935032, 691478.2660792681, 875702.9906176021, 704138.5651576492, 837899.0892134685, 732146.7649054198, 687603.8042361097, 655976.4100170492, 655560.9194840124, 515982.2689061184, 292514.2954643176, 741495.2401551942, 786485.721789083, 770619.6521959127, 133150.5248133637, 469919.4658630458, 591693.7864393037, 593391.5185709241, 833542.0987735323, 382710.15563968796, 454555.5808070658, 842184.2289649905, 875341.6266371834, 576346.3975216256, 828737.9436721951, 296978.4502981307, 769245.1776605996, 783805.5010545497, 929462.6875806847, 273529.9459031835, 446655.5305680478, 594774.2315612913, 443247.7544504013, 427828.6862815487, 382821.9634357923, 523534.71903112694, 357297.95774128876, 479290.1961869366, 652842.6786342624, 191935.9835188841, 773804.4673039393, 568910.8522566361, 365526.4257021989, 626480.3740015795, 260693.55079868148, 796000.4153744697, 849546.0734616471, 585641.0672542786, 659975.8619363898, 480356.3080746181, 679143.8336541638, 630376.2696986072, 694441.6691559484, 530836.2892376764, 797652.0749650626, 581050.5025229863, 694231.6689463501, 684635.1821050817, 921560.3252466173, 661569.7089046844, 560903.6646890724, 757472.3252615804, 572898.1997584387, 894270.5243079059, 381351.1349403841, 773068.2100894374, 612858.3582766948, 284805.7834209364, 663334.8707060057, 659792.2252149561, 887337.2695707239, 868451.3323999133, 791771.8517920278, 853751.6389000565, 384578.8095376574, 396794.49982184015, 373566.55214882025, 692891.5597976213, 762044.1795737201, 578137.0243289612, 492615.2268272585, 563171.9985027567, 380793.9367541256, 952145.1644106864, 562868.0237037559, 820518.3723347955, 956288.2922072046, 925374.9077362966, 452567.8541612808, 600081.9553363697, 684760.1719035674, 861419.8292796871, 584036.2756611631, 537403.0450448878, 553303.2829468625, 171992.69410318177, 687723.4671319386, 769628.9002969696, 581714.6003095016, 811255.6980580634, 542193.4303846163, 793343.6727277382, 613002.6473091798, 514595.56426109705, 502096.6230473211, 775494.2373752367, 648439.135376132, 605882.0473276929, 729636.8910368657, 532968.7949636218, 639870.6527781244, 891943.7359883533, 435631.2203879269, 459726.5400885023, 888835.8801193807, 810095.7373856875, 554853.0586714405, 524460.609780035, 491624.9488321298, 821049.5889777682, 653630.9311004947, 504104.84924799355, 1077182.528079804, 328108.45626378927, 618577.9513343392, 330627.3824526636, 443372.72122851526, 461183.57256998547, 208427.5972483992, 718669.4295262631, 589070.2513175288, 425903.9943442712, 772021.6689967455, 465799.7613960794, 812819.4383463492, 402835.2324023642, 754074.9574845264, 377556.4385951879, 601017.3792266311, 660999.9308893522, 394117.6047331519, 512563.4089353199, 625322.2204543384, 638698.1778781778, 704360.3176178124, 489000.73589287006, 638072.5131127946, 618019.4940823423, 662338.6248035086, 751170.3346455401, 274944.2001390536, 531738.163829297, 325513.2871479828, 715589.4153348012, 945055.9142457609, 696599.8035667638, 737166.921061906, 605169.0948716888, 519176.1268552479, 534701.0282810148, 597738.116048341, 850011.7292324352, 487704.0230025366, 811479.5795145332, 527521.2505482842, 727980.3117823921, 376689.5281608223, 734637.2808492363, 571502.191134794, 359412.57339349936, 487606.2505063866, 687971.8237585146, 706042.6546802056]  # Truncate for embedding
baseline = 595708.7678475
mean = 616601.6558560156
std = 188936.87585831538
p5 = 307573.1549904487
p50 = 614793.0191303227
p95 = 929465.7923095964
display_name = "Expected Treaty ROI with 50% Political Success Probability"
units = ""

# Create figure with two subplots
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
# Handle edge case where all samples are identical (zero variance)
if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Mark key statistics
ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {p50:,.2g}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {p5:,.2g}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {p95:,.2g}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {baseline:,.2g}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---
sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Mark key percentiles
ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"
exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title
fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark
add_watermark(fig)

# Save PNG (same directory as the QMD file)
output_path = Path('mc-distribution-dfda_expected_roi_50pct_political_success.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 5.957e+05 |
| Mean (expected value) | 6.166e+05 |
| Median (50th percentile) | 6.148e+05 |
| Standard Deviation | 1.889e+05 |
| 90% Confidence Interval | [3.076e+05, 9.295e+05] |

*The histogram shows the distribution of Expected Treaty ROI with 50% Political Success Probability across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
