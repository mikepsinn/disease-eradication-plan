```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Total Annual Treaty System Costs (10,000 simulations)"

import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Simulation results

samples = [303139014.1282333, 197115566.0141695, 350175721.21772856, 372482466.60423803, 148392440.49971932, 181403273.7583394, 286336244.2753146, 248275622.38435012, 273315295.46884537, 209178550.29561472, 365149200.79387224, 353296528.1720971, 280694935.07110167, 395820962.9830963, 319508340.2217014, 208763177.99218696, 309471498.308298, 202257503.9939011, 365036768.482467, 270420800.45761454, 258954829.41415912, 220964385.04595175, 408314362.7880572, 261487549.89338058, 239526726.0780423, 245438548.70488632, 326276877.6446809, 309141150.1973084, 313900364.6490916, 315740854.7065259, 550065701.2264302, 241211598.59493405, 233186799.56582746, 211808866.84577808, 335237069.1872703, 396044334.8223704, 264916347.26693618, 210037963.01089817, 211088236.99834988, 339018038.73840445, 349358977.02875805, 327424124.15610534, 222053461.41717678, 296125938.251001, 285309539.8838065, 294842337.63206816, 364204849.16174984, 295309172.82708526, 342144512.5252551, 280834835.33233845, 301616971.6706983, 336903896.2941337, 172734770.88364872, 248003133.7619153, 236328066.00346136, 223947587.92066303, 251566376.9753127, 446325531.6138737, 208329438.73989138, 375855111.2777015, 160899591.92745137, 246797764.84108403, 289574572.4117175, 332021523.5080041, 345748242.8373755, 355084937.8744753, 245706525.26050675, 236934827.29101086, 362616415.06074333, 258420229.67038018, 182929925.05535585, 191367916.84427914, 204807673.74428234, 322587263.67874885, 287684513.1669371, 343430568.16536295, 239609110.17899227, 289181751.821192, 336282513.105772, 248824626.0544994, 318401266.1316773, 222307375.07034534, 244582031.93381187, 243123772.9462343, 187612478.45476156, 321525886.2050622, 236401382.2704829, 275901967.97916573, 320879085.21809846, 317348442.94609296, 340647326.22251034, 266234992.65057856, 239912359.86797628, 267844687.2185018, 160680019.1681202, 173283244.91456836, 180229938.03776687, 199807985.11063352, 312588695.6371831, 205719406.79413536, 243402121.65948862, 418663763.2736638, 245114219.55815655, 348709154.6400336, 203887692.80851024, 257251366.1419822, 202827670.42687744, 246470178.2667514, 360541214.78526807, 158727925.52540103, 316108757.28845537, 296658716.8161142, 227166643.22387013, 173340943.48192525, 281246400.78859305, 231905287.39296633, 296175108.6073272, 276733595.44489926, 462217107.1797921, 254468583.13174373, 198149710.1291983, 291120353.6347304, 294966710.88163686, 426944590.27681065, 359933148.5227364, 308286391.7820417, 441728762.0942264, 188033456.8391899, 223885183.44329888, 204344484.5445038, 242496571.34723687, 177180595.70012093, 337325826.39045185, 255870312.11082482, 171992207.03582874, 198648408.4021032, 304000926.6796658, 360285829.0481714, 525900781.9777262, 699630310.3501813, 314070511.97741425, 200297688.50732073, 141088195.61960298, 299540855.05315447, 211864938.7353393, 240522548.03093863, 225869272.52658918, 262643141.0751098, 387999528.87686586, 289042864.1597477, 261143262.8776041, 197386647.9150726, 161303066.83511233, 235127384.38384992, 270085875.70645696, 488082744.1384323, 286560797.5507658, 377627523.5251956, 234153484.9141562, 188261070.4490767, 201857342.24054077, 217866588.52108532, 547848554.7968311, 211296222.06717947, 360328268.0693176, 205886368.5958554, 371394958.7488205, 311095229.52570426, 261310673.17962226, 271218313.2001177, 222814027.36378804, 317301356.88760626, 237493651.5509895, 185852441.67215613, 182799679.6707838, 290493650.2573394, 458794162.2188477, 289317054.72909343, 264517637.7558664, 301296626.0819484, 419590839.127333, 294908307.4730156, 240863650.85739407, 393127664.94547886, 315530221.0427307, 452328731.30459577, 291491992.42668647, 185919338.6382227, 177658630.39688244, 469723248.29717225, 481064009.4833202, 259399113.4897822, 243011025.84677875, 441460252.83449274, 192966593.09901348, 206423835.86671045, 338220692.78891844, 242124762.9125262, 274343505.59399307, 260740643.36118725, 306371420.23539484, 433737557.81539273, 282922033.4095218, 338287776.4441634, 144301526.2192428, 270525753.6029586, 209832650.97478044, 186252566.88081855, 207514658.74540284, 246857959.51192555, 369507537.19432396, 180019607.58221868, 277516163.01395094, 235288144.1460276, 247368395.63872463, 380095340.0895282, 326890572.3047321, 423915866.1717741, 261489547.44106904, 219909373.98897403, 255736107.40294072, 297114569.4008454, 290866955.5894456, 194358113.69185096, 282913370.1226827, 295750628.05358636, 617807429.3384707, 505777393.48323506, 209165280.3500817, 250581564.05831727, 172392398.69542065, 227416416.67833716, 304206193.19471073, 406097547.35111964, 217598948.8649408, 222859600.57574278, 140499805.00951165, 260805662.57634652, 195717607.94255304, 231909234.43319267, 207599913.19403875, 266596321.0728761, 157260648.3197717, 172196469.55250525, 547979063.3021919, 182251987.31934145, 193595429.7606633, 499213854.32499623, 697688404.324655, 189060556.38133872, 244175652.21347642, 306765479.19126415, 481858947.8512719, 200468296.96074957, 253985914.67427993, 353244430.51190597, 316143749.5535917, 243558476.16585237, 263231258.16221, 177280853.81661275, 254565022.16520712, 252273174.3322766, 296126756.2635959, 229999701.320126, 319924924.1112055, 381329156.5492777, 288892121.78651804, 307777611.30670655, 279534405.12910485, 274803142.62590575, 218121382.00410512, 304293525.7546188, 266337521.73909104, 541913803.8564951, 457932862.78629845, 311185250.80348134, 215256701.38997716, 192638573.57137698, 404153699.03168195, 299061743.3408295, 320816484.7175317, 157892995.5557587, 370896009.42304736, 318158923.4813614, 192759594.72532606, 236241040.79201522, 299155140.7736383, 279472482.68020594, 250197467.93730098, 265807595.31973043, 253441040.45346886, 288625436.99776036, 442913841.4878794, 125453921.45763668, 254673060.17510277, 290861244.0333653, 302286823.8752016, 243889336.45858085, 157308984.01553592, 305425388.2578851, 481645949.0749473, 168605022.79714257, 363306514.4248077, 247300901.19873652, 269432162.7102913, 196309417.45774046, 246831659.1137954, 418775376.7328807, 331638216.6198721, 482430715.8370087, 402347985.9407871, 316585607.9504482, 484271650.40925413, 316576037.0742341, 359101434.2970487, 249845042.39223695, 280741469.59302896, 219805569.31340516, 378469417.44681716, 188657478.3916036, 353819644.1809486, 258474390.17158812, 401539999.1029491, 350223194.5890519, 496565403.8141075, 347947437.3680352, 166587985.97796795, 268945334.14385825, 189034169.83585864, 232737463.23755231, 448711167.7321705, 337586382.9318476, 219700037.30009353, 198765847.96789804, 277708211.8788386, 186385472.9273187, 221655138.47121936, 303853347.00261986, 399459250.30786616, 334454144.5708684, 135089492.11115858, 303104739.0987354, 281237717.51414025, 314017823.7465191, 464408053.47256535, 143782678.39829955, 227387643.88274992, 332525546.4604601, 166087172.61706337, 443560227.0659444, 309432100.55904436, 361276944.3189414, 228855713.32746637, 357446487.7998726, 388314463.3858074, 296194383.07882863, 296339872.4602994, 299795280.3372506, 208494226.2323339, 262075745.34186882, 261656030.06049383, 310938779.3045812, 379732652.51885086, 195958583.15008804, 263977144.98390758, 444360152.9813632, 216595737.5234259, 211238175.3293619, 293289295.1699804, 361018998.51904446, 275807216.63621134, 422749036.0962399, 362477207.2820505, 360718319.0509117, 328588014.8046187, 582477706.5242172, 257274128.76200414, 146192491.54866457, 462592182.9712216, 237287510.3954262, 284501765.1304316, 420077428.1797223, 165009297.20604292, 184326740.0469842, 165060331.53073567, 213136961.45590058, 316641893.6763751, 325420491.73987705, 300369472.39071393, 175172685.94428498, 134402030.49444056, 279642198.73612875, 236222069.42928126, 318670139.91457385, 344710063.2666374, 287297043.22413266, 351277579.6725458, 295844389.8201297, 326039966.4887347, 219298256.40216914, 259391440.2852578, 292766963.8448075, 358232548.30936146, 242191706.14574456, 325102569.39586705, 252317540.9707019, 264610752.0767764, 359280015.26425785, 146627883.39444488, 181731021.03037804, 171375743.887385, 133549045.97897929, 221152218.95189032, 350060154.8207716, 250782309.6301139, 292862664.9670736, 390947311.3950618, 422573079.56266296, 268756623.6131137, 426163826.7370169, 283062482.8249863, 210222376.6457245, 227148488.9573735, 171464929.46034145, 206857033.70017838, 244976727.21407434, 356267103.9675546, 480607134.55077463, 176873226.4629019, 311887875.344169, 197080548.53813374, 320251887.5308861, 263462586.5241962, 153789616.58504972, 370999556.0279223, 226381322.74743804, 231579024.93614173, 195262513.93065408, 222849874.95589545, 315441912.4949741, 258591056.9913931, 305491115.6738264, 308789676.4276204, 421604612.9348515, 246174173.3349206, 171664078.60762483, 388156523.54073274, 247066364.22807392, 394192775.1449581, 310937096.669914, 263458283.23683116, 307481526.06465536, 518202426.19347167, 539188686.0282952, 280997748.76344526, 289335602.5300221, 389298212.1865596, 209670437.6049983, 305926208.07875204, 272520288.0398106, 304039626.1948571, 210492081.70844486, 165670436.42373165, 143397208.59988418, 192335106.049326, 237213488.31851548, 250115686.89141494, 515874140.6043064, 393089836.94161665, 202051451.0591285, 307375557.95324653, 241160423.37523234, 250824115.82964545, 291688506.96371275, 335583875.0440539, 246452389.9100296, 387730644.521475, 190843910.12981278, 275356396.4007216, 633456047.8638619, 295260064.2594917, 437402631.94058096, 283007225.4721877, 331436581.9874961, 269825586.76167625, 260158574.78471377, 214133707.85146716, 315687825.1816712, 209278839.54833442, 340669424.6418556, 390447080.59995186, 309249737.60521704, 250672677.67047006, 318112146.29257786, 248878310.56574178, 371875204.386734, 153766176.1091086, 246740686.6043318, 146721654.8626567, 170680992.01535434, 427597277.20022607, 367027462.99176395, 218265850.30875245, 170280730.5924706, 113111579.99125844, 230870394.82165015, 599448881.7050968, 316155828.7782836, 229688140.28389388, 319257459.8584692, 167170853.800627, 249784825.36958006, 283733118.0586555, 267296125.50836596, 354792143.41143346, 307071672.65228593, 340972216.25457835, 220440706.32371178, 367341390.02583367, 466349276.82000655, 201534897.88096678, 206885858.5955043, 423692439.1358726, 258416941.80418915, 433218788.5374338, 238440823.64123243, 440537129.82232404, 286672610.5641854, 298625983.6069926, 456639209.9301447, 244682529.77193245, 203402056.8841844, 237981615.7002979, 317944373.19749576, 166918092.95791847, 337579501.48907614, 231219003.7234954, 398483872.2230209, 131380283.74257153, 213651297.9836709, 160722597.66828907, 210970830.50393653, 297610300.73614997, 259423465.0826661, 253327316.1741265, 261097171.17500037, 293391610.45842856, 199093073.6739059, 345257807.10321045, 340347221.27967227, 311103970.42320794, 328845204.85396063, 302328189.53019035, 532204646.90473443, 267210838.94171542, 249005086.79718998, 215911050.4690148, 197599201.92527395, 184745823.71838704, 206813398.93878102, 268623476.34763604, 306047201.7409567, 279353386.5375375, 215086883.77143466, 367624373.92170686, 348923838.3376052, 261058342.78355497, 222947063.26121402, 327983507.94973165, 291937535.19991106, 173227744.40671504, 268856601.8981506, 298992927.60351956, 206098056.85611683, 292113515.99315345, 172862034.39510825, 423748052.028219, 411713763.6642562, 253397178.63428056, 308942548.7160394, 130827427.20533744, 189974419.25297284, 250068627.0545049, 195115108.04990435, 346103881.05883986, 525995341.86915, 188758442.30450773, 210218016.82603726, 296439987.2905475, 463633506.83862853, 186042679.06325227, 297741852.4312981, 496671385.3488738, 162456979.97661301, 182618660.675592, 239888703.07913077, 232565876.61027193, 357311598.0098642, 297034372.6753105, 156435611.79542744, 324497541.59934235, 228374355.8979388, 415290024.9361778, 224755647.59661978, 224109279.76049274, 327209840.5602565, 351596152.8378911, 317509377.55110437, 160765412.18885183, 326882003.0512262, 197470968.35783935, 296423521.0572246, 174566973.2860157, 317326997.87896264, 212293061.83946222, 182528242.7160028, 346039191.35352916, 297032916.80485857, 225733814.33203375, 439980257.3446131, 238584468.0068571, 277647971.3438842, 299657028.37956494, 225324414.43771717, 319883311.6492208, 231612157.79344034, 240808864.48195642, 427426895.5092257, 197077914.61511883, 130726844.57633126, 463606288.2513216, 623970103.3932801, 241300033.34396008, 148994241.30896658, 248733986.47319925, 250674748.5705251, 258534695.44664907, 192578936.7082962, 331306107.1437594, 325454141.97072786, 170716275.8807362, 344402030.9146838, 535127333.88796663, 290434911.38913816, 246605003.80830646, 262540955.7867591, 335158597.8581111, 158565494.80275124, 289727401.81158936, 242445816.73164648, 500998552.44828856, 259844466.91177863, 472342526.44600046, 193168921.48685825, 332133024.33880794, 304579100.8290839, 208116441.8067555, 290944082.88905895, 406981464.0189108, 247676070.57206362, 160452745.7307289, 273248379.52076596, 205919365.95053822, 246209267.8917897, 267683880.34125996, 159782542.76103735, 164314325.37186205, 321016125.6242961, 232407657.9993054, 125517831.00258893, 354106156.4227157, 299991345.2192579, 218656087.8784836, 180564740.05592412, 360014598.9204421, 307538596.77373093, 592464166.0843682, 314657658.04191774, 311371954.80997354, 260449215.3473887, 357796278.4571247, 336227476.142842, 412221314.9668125, 232511311.3710099, 238984990.64379364, 235669456.16877943, 354791636.58885705, 446827301.21240157, 237200959.05006444, 239799166.67623508, 304056213.1939255, 253946538.27280495, 373876806.2323549, 136547693.35052598, 210938903.90610453, 213933756.24896646, 134029251.31858425, 201952158.73894602, 205087544.17287824, 257609126.23152664, 393983904.03910106, 254003599.51628873, 197690095.17078647, 269810731.2530532, 385881863.9152278, 201163367.64392686, 205386423.14651206, 329059838.3322482, 255926651.56935647, 338676728.2612457, 273592601.4718342, 344677650.0996758, 197422712.3445925, 273730040.2577105, 256818372.08895278, 186424971.57300302, 167038145.8762781, 342903582.6199536, 245531378.44425455, 198226284.74432817, 266432285.71532136, 395921291.49165714, 135476983.0037906, 170596053.55640087, 204584244.30590606, 441421920.9536718, 300981887.54746294, 352097502.5073673, 190951442.63721702, 192203943.81430998, 317480056.8258819, 279995211.1373107, 328016516.2599295, 258721608.4502299, 300550705.2770582, 289142568.3077464, 353293713.4407973, 356663300.4139293, 164096401.58025134, 136715339.8002427, 379970129.92909217, 403703448.15517795, 198330592.44519827, 152440430.07662213, 283692687.0570222, 371306234.9813248, 492837419.0299827, 324590704.2391584, 243904783.9899584, 206528639.00890976, 275809455.02354133, 249629525.0378091, 198680646.87126246, 534473704.2099092, 490839911.335026, 396958799.97504294, 204716680.6396146, 362268286.383355, 337815372.1806933, 316939808.0409787, 411944302.8138302, 337349895.1919919, 348991942.2772919, 337517745.10608184, 306689799.850055, 156023322.21258926, 282288547.97375876, 229936199.2670408, 182689635.39231545, 474505038.16298395, 481906020.18368644, 426949197.6993351, 298335669.45326924, 425751751.5416419, 275862846.8345378, 293335726.1113967, 193799011.4125551, 312307745.9971641, 280185524.8011624, 181376160.70425153, 270310357.0923947, 267843710.41135898, 492832045.7621574, 366911571.7659458, 275808935.9109882, 297717960.04866076, 278731255.6923791, 257459670.25813124, 194479031.17953926, 261779560.72730577, 216422617.65899456, 184404442.19843432, 324058067.54817784, 311730436.88856596, 155876008.76592264, 264174214.265662, 379223535.9703969, 387146754.9743724, 382961216.445461, 278256478.8359404, 209711513.42131537, 194400607.10527152, 307067674.6652554, 310525833.6402041, 417040533.81780195, 392320401.90208715, 263366015.52740923, 184761373.27648154, 248047985.2943754, 294703831.59654164, 257528280.57672384, 228348459.74286336, 298111679.15522224, 233804911.35687712, 224721336.0044873, 303798759.5810666, 241553130.2124369, 297268650.4167795, 300072099.03970325, 190995744.24951, 235508464.95664388, 438055791.85212475, 189629696.49437332, 141685452.53357917, 152347180.81062132, 277380372.0572495, 277541675.7423518, 264604916.2970462, 407203377.01452607, 121982631.71541569, 312201061.92897797, 456148941.438434, 191702231.826731, 243274094.53720492, 215954771.61905378, 206448841.6260904, 247480205.6819594, 436583860.8643908, 499291105.69208694, 246714468.2926887, 510469283.7258889, 277957956.84762436, 485817489.70821, 266678867.42474118, 286633098.1509237, 309144186.37995607, 758239042.332252, 361829139.5882487, 219117216.09630048, 375943093.7225805, 244677669.02962297, 234868851.44815233, 368631546.2621986, 277556702.2820519, 300592617.49663794, 276034305.0952232, 306273366.1411447, 315143876.92602766, 148988764.71223736, 340778480.4407912, 200776524.7555361, 173546747.29415017, 269684471.64592206, 282321253.5924477, 220080233.35664955, 359456581.08537376, 179123638.86132035, 241170799.761311, 227840223.59579194, 270711088.51888406, 300620586.0857554, 199133727.15677452, 347215471.73044676, 280421525.10230553, 150957930.81050402, 148073316.00654194, 273709391.624645, 255973335.72165346, 265813413.09794253, 272334675.58955777, 295496265.47148776, 373341677.3629159, 192718392.9056315, 189036301.85460055, 193808077.8366352, 301597241.1392724, 411310525.6347246, 239296121.16592294, 127646232.38082935, 159863618.15612146, 210514325.4117548, 229823380.12663814, 241059344.47452322, 278226753.8955724, 248633432.62620306, 385902720.22951883, 221310723.78160137, 208562366.07088304, 320684958.23775613, 168510384.56768993, 311572059.5274941, 284014212.8991924, 262082995.46308303, 460176735.9666328, 225141772.4175137, 536396301.89594203, 255607179.24748215, 182852959.62993652, 281046445.3037217, 194860757.28661835, 216032933.83831033, 312311983.70342433, 328743945.05941087, 225144627.452213, 378201206.10624784, 399745296.21569014, 437844493.6421443, 325971253.5028195, 427536704.9579505, 151470821.1773861, 248143341.24626356, 208251651.872409, 285542997.89252436, 228818777.5258193, 260513583.124619, 506660301.6541786, 260215995.81727332, 314007882.00094765, 255047378.00495622, 281570977.33828443, 275327852.01459527, 317532444.43260825, 400763121.88274044, 469179355.8251681, 303619100.003295, 332379182.0184443, 190304795.2698138, 267143680.64663982, 372449127.2204406, 363559282.4956979, 294170221.00356746, 365980317.66393983, 321920731.7307569, 405363391.83181494, 301640307.50128484, 245158609.6637925, 306200014.70096123, 114098950.29708473, 310887742.6727938, 106057976.57583882, 158915097.295764, 317886262.21999145, 320545366.4629582, 189608712.05543888, 218779656.4578421, 428531574.18166834, 235298620.10864562, 567450533.4349382, 274626102.24779665, 313424325.46689147, 464509232.12199545, 286630263.2126916, 199484867.75906423, 265275568.1990624, 271667758.70990896, 177850600.5943086, 253128088.01013738, 216692093.07529867, 370524683.526474, 277871720.20500815, 250950173.22217244, 265577765.76223361, 295264088.90826494, 335327739.21486723, 199651631.1178204, 197015282.9330202, 392921562.0016526, 240755056.97408745, 174947331.61803555, 317069661.8981108, 319080932.2946656, 168772368.6577677, 295870180.11903316, 348490608.834455, 310035357.24616146, 336979581.4653846, 175643405.69316405, 305725752.12814003, 249361369.0782166, 235391891.61958918, 364101532.4222413, 444043136.68183213, 492318272.68853474, 420799304.9875552, 265274994.92201248, 307873414.2653759, 352041017.0450878, 285722550.463178, 286605992.5375909, 358607880.0116625]  # Truncate for embedding
baseline = 290000000.0
mean = 289153038.49631774
std = 95928880.82018644
p5 = 161332159.76113123
p50 = 273634762.18539697
p95 = 468464072.1202328
display_name = "Total Annual Treaty System Costs"
units = "USD/year"

# Create figure with two subplots

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---

# Handle edge case where all samples are identical (zero variance)

if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax1.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key statistics with formatted values in legend (use format_parameter_value for full units)

ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {format_parameter_value(p50, units)}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {format_parameter_value(p5, units)}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {format_parameter_value(p95, units)}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {format_parameter_value(baseline, units)}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---

sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax2.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key percentiles

ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"

exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title

fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark

add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from

output_path = get_figure_output_path('mc-distribution-treaty_total_annual_costs.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 2.9e+08 |
| Mean (expected value) | 2.892e+08 |
| Median (50th percentile) | 2.736e+08 |
| Standard Deviation | 9.593e+07 |
| 90% Confidence Interval | [1.613e+08, 4.685e+08] |

*The histogram shows the distribution of Total Annual Treaty System Costs across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
