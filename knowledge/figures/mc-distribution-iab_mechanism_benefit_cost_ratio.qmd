```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: IAB Mechanism Benefit-Cost Ratio (10,000 simulations)"

import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Simulation results

samples = [213.73182137809806, 171.70285611808205, 205.9012935162341, 233.29173415604308, 153.4798789352154, 170.59629334136844, 203.08039602028558, 190.8824767945302, 200.92384143674224, 190.4815272759647, 241.04132418422708, 238.67833535842067, 202.38029884390767, 257.22098808724445, 221.4225926840262, 198.08267689594743, 207.21828681345903, 176.67150773869255, 228.6005296988603, 197.5406431375789, 206.0977533203276, 178.6456661273687, 230.74379232265113, 205.1150342859967, 197.47593579881192, 203.27117154392644, 226.55500170507352, 192.83616367276824, 217.30047435874874, 213.36933232995264, 276.80775979751525, 175.84695056077595, 199.30060714216796, 182.1906824475414, 209.47551694455728, 259.4739920839933, 182.35159169130566, 165.05452681807995, 188.1510731346605, 218.91517358764816, 237.0815048806265, 231.91737212651742, 185.91142375330227, 199.0902036073602, 188.4889118653558, 208.0300927713587, 234.60424963116446, 214.58401964038717, 221.44450550553861, 185.43542198444388, 214.7295283975878, 232.12227342469026, 162.61733278014623, 190.24574825156446, 185.65721487738452, 196.01595714449402, 197.44861665992102, 232.11595604645296, 182.25746325072578, 243.83366895388681, 169.49145148694808, 198.87939340907283, 191.5760835101361, 211.4068735002185, 232.9127241186791, 218.87423484721847, 190.15476813402245, 194.80408418889556, 218.33129433880714, 197.55609272517268, 192.80202925668448, 171.99204085550542, 161.08887083100444, 203.89416474884675, 201.9570142023046, 247.02842244981954, 199.3805955768876, 198.6422974456473, 224.31373357009534, 192.71842131813432, 217.4959314211582, 172.58732385558955, 212.24981643392553, 200.4805127390826, 181.05090908619923, 226.1139630776131, 176.84942412090922, 201.0943753165998, 220.94582695002734, 231.17445239373222, 223.6363034148909, 214.2398574639165, 184.90370083112077, 192.99638477146343, 155.38369778458394, 157.88483893823735, 199.2259515983938, 164.85334660750394, 203.3817940077203, 192.1229869528672, 190.28957254634344, 249.38182309933117, 189.34735841594528, 208.97573680769534, 179.72827576933003, 174.46784388033893, 180.29876652093043, 190.35029268357442, 240.1003935493279, 150.67877778576906, 220.82209576099677, 203.8962663636997, 184.7751112624143, 164.60877204393705, 199.5236941221084, 209.45492266870727, 211.99816008851246, 195.5870123512927, 272.55869608758525, 185.83860861630677, 163.52387935138577, 195.01082972619284, 233.10611922606202, 239.56653011410208, 219.05833434476835, 224.7602354899956, 248.3811744321152, 192.34997068179487, 166.65352686606298, 203.11797385686177, 202.7724532592896, 163.46432664323962, 222.9433906615073, 203.57258473730465, 166.4902132312425, 183.8424257848956, 215.18623099958072, 224.95306603480623, 255.862663377782, 271.833987952626, 231.89213757547222, 169.9765006776137, 159.0627779531299, 220.94786013951008, 183.94331146238108, 205.2054943165703, 186.20401388120752, 202.03706993433872, 244.22818045681848, 194.16055957089583, 223.8174466330887, 178.87739747366751, 171.2629582693972, 172.33303733737588, 217.4303356232067, 285.61029542877344, 219.44569413034614, 234.56871053908068, 187.25878104359987, 181.08662517163327, 190.32954741210375, 193.27833704550335, 283.4351341897496, 188.7424381239579, 251.61115194659374, 188.17538400205126, 253.57788793952605, 214.99043810523204, 202.987684284885, 187.34406939963432, 186.52123619721237, 216.76358658482943, 174.36143501704876, 166.37506606080717, 181.75763933326144, 209.66654333461858, 252.87276147252925, 188.1297033524021, 214.34535338096163, 221.12042824803092, 269.5339618579381, 228.8423992777531, 192.45317439109513, 237.695784983275, 208.54601208500284, 273.2496552339544, 193.4485614061176, 177.36988687274956, 162.13416817613512, 284.4314248305255, 291.7427193974722, 198.76690197458035, 206.51450319838744, 215.7982490162467, 162.56107297836638, 192.72160818511722, 213.90014533133746, 171.42305694138324, 209.70545684018253, 193.19264302943074, 209.5553493739371, 250.98816909477662, 206.61707956920944, 230.13178319091227, 156.21242442954923, 192.342136035661, 183.17207238949928, 177.1204485708711, 172.71366808399438, 173.61101888254524, 246.12989955509042, 161.43372842869258, 222.752000704604, 180.99692107606037, 183.03629544392976, 238.1694399976687, 199.9656487924649, 235.77839247249787, 209.85763637417847, 183.5455288248043, 183.43420726608147, 213.20177967049455, 214.3109803730266, 180.45436569918456, 200.70428064939242, 215.69561609847892, 258.9654977093598, 249.73569543525636, 188.7651185267208, 200.73235322575826, 166.16007776928475, 200.18438326041084, 218.30382735787907, 253.872196013673, 185.71431760488082, 185.3165196703459, 144.64802091410886, 188.0318395830811, 174.92247845014973, 189.2941364842811, 180.3224342973139, 197.71024664580528, 172.29777198823777, 179.0321876633123, 266.4783691300803, 181.07808573942074, 174.72157647955777, 271.6449560742642, 269.06049858458437, 175.50397622079018, 199.50834920003015, 235.72109827052108, 249.8849767646973, 180.82228966233043, 185.08427546440083, 213.3954262377193, 229.37050199917215, 195.6727133487727, 218.97792001417034, 164.32039538751147, 183.67941182507022, 196.7775294999943, 213.05764634613402, 193.67638413935043, 229.16090356939694, 217.44956849854367, 221.83495487613953, 232.13746701651138, 228.9202687928272, 206.0728371207245, 180.99884044822494, 211.3400589398824, 195.66726139685912, 268.0515794898862, 244.99978201261368, 200.2675395058652, 190.6645843420542, 175.898319868627, 253.33276313938177, 216.1555563455104, 225.801905427543, 160.87755639900928, 223.44458746975042, 210.44587588505777, 165.5928363420562, 180.44106811355323, 211.0518109128121, 216.1609825709744, 196.17414679300904, 204.68768624198017, 213.0829909165158, 189.67513095556055, 246.26244626876493, 161.48948242388542, 204.17619959276075, 200.70584947732186, 190.3879962736121, 199.5234907816538, 160.96148321717158, 193.6800293305755, 260.81657586448057, 163.27281522014474, 253.57729033978552, 191.10393790243873, 204.51910474286157, 167.34958052927408, 198.52292839816158, 244.89948949867602, 238.1241235233509, 259.9651259170564, 251.36613370264178, 204.2059621651556, 242.6000012239557, 198.10883511376846, 214.57871083257862, 213.44247257624716, 196.79556045985873, 178.38298040009138, 245.5649410128509, 172.70545007478785, 221.18294635257118, 187.33690957299598, 262.2063255287275, 229.17525288320857, 250.36959829352705, 236.56778318796677, 169.5994681762334, 185.16548409558598, 193.61083503684534, 192.24450317936075, 268.46861068416473, 230.43300788741027, 191.59827853374387, 191.50236562939267, 228.42966116686682, 182.52275752084867, 165.60480150460216, 214.34950853343892, 217.2704227769521, 220.3653473247363, 151.65647317168958, 185.43782578360103, 197.57726610997753, 226.0305007041753, 255.04984459570784, 157.26795599045758, 204.17635273929213, 228.2443534986398, 179.10351222544946, 269.5517391476363, 233.54013279961882, 238.56620779718259, 182.07005404750728, 238.60449810319392, 261.3161563083109, 197.19105877863126, 186.65093882250576, 204.22682841978772, 193.23994381056153, 181.3484879683821, 210.866019630157, 218.97735452922208, 234.86331790961785, 177.03207231467118, 206.05667179848496, 254.21441023398458, 175.4282222782925, 186.0078161336841, 213.3373636543777, 210.45999995389082, 201.1750437787493, 252.78460796767268, 222.9401433572972, 255.041791396216, 234.3020026250236, 280.396864422334, 210.64748766334424, 139.08050902704463, 276.31408411338117, 181.9392516263932, 204.66465859919376, 265.72577791256793, 158.6881824287861, 180.53711044977558, 150.9785171605393, 183.81198790835583, 215.20164535130115, 228.5880119337279, 224.8369820995267, 159.69197570136802, 160.5618987102684, 208.8022790458974, 184.77015229322973, 237.52401686222498, 233.66419693135967, 214.49885552535798, 213.05175228953365, 203.6199082050591, 226.6645418238072, 201.6244858489472, 200.85532251105997, 196.62682354795837, 225.37249231372465, 179.91343921583572, 232.6092984179907, 194.00428798524317, 215.62026002752697, 241.66111412961874, 147.80610089449124, 166.94698440207543, 171.74183742256784, 152.07216863130117, 189.61046280066236, 219.4933588471479, 202.79588147338916, 208.6642781485156, 226.3963454654826, 252.15103064667034, 200.74631773674398, 233.81011477633967, 203.0453282771456, 183.86398307664064, 199.8919832356954, 169.35678762576592, 177.05732564679977, 181.60268726244752, 225.44660766589405, 284.5975143502324, 182.55775986983588, 224.21661034882686, 178.39404254792603, 214.5939304950149, 195.3419747296805, 146.16476184876308, 248.30362926829866, 188.64987832196184, 198.78915404939733, 158.09590092989515, 183.3793834887139, 221.98836121606706, 185.39392924581975, 198.96831111607844, 206.22901062415465, 249.60159549741448, 193.22156366051962, 156.0646988017533, 232.73308825819686, 184.26487415903378, 240.2143906878066, 212.43926213670076, 184.45599300805242, 234.20021255571427, 263.524970542169, 266.76591086699864, 201.85729111422526, 206.90591176361474, 236.74214461122523, 174.67775074883264, 233.39139968472696, 203.51643510407845, 213.45913305928087, 178.26928287833564, 159.67748995328688, 148.51060166522015, 178.74616278349149, 202.81539466568915, 217.39082744830176, 280.7815032623069, 238.7203290199862, 183.1158322092767, 225.41831638704676, 180.0495867064425, 190.4084045898887, 213.29277021193076, 240.5427905366648, 212.04286147825565, 234.43275440198767, 180.74924984776038, 212.3022982374295, 264.6828279821983, 221.22645773138387, 261.6819053605321, 203.21455127595658, 206.6012621099926, 207.20362838391466, 204.22216326669246, 176.68018298474072, 215.8861051245599, 199.35375084700362, 213.67981691652557, 236.3485435851071, 225.00349780432185, 199.52930498392232, 223.63062580390914, 198.17859051176055, 220.473863880558, 165.16270183002237, 184.97917673199564, 162.8046224868789, 169.64437999237066, 250.93777529132356, 217.6950974845052, 182.36243619435072, 163.89233683269762, 169.84494517165672, 176.7053363847258, 273.80065803967193, 230.17581181309717, 181.6489453203749, 213.09824528659155, 158.49984203844966, 197.5928179357106, 220.84925221809033, 190.6086764322091, 217.60400649594084, 208.31649713971373, 233.19140993848296, 173.9067590728515, 237.0807314936774, 278.4284025046906, 162.3400387618112, 155.73432118478974, 239.51627656195393, 214.3024645594903, 230.77841712611396, 196.39551582762599, 273.6941254846114, 221.43793901180013, 198.50106526603923, 264.00554167982284, 199.1096943404292, 176.75218009143836, 174.87680896573713, 200.12724815947527, 165.34883363768787, 210.5007356421777, 195.34154076638396, 230.02314580311665, 154.6330454774717, 179.07438041863693, 155.54498810715936, 160.33800811478463, 228.73663641848862, 194.72822168655557, 188.5214950863324, 189.20525872248797, 215.3039079672339, 161.88683176074974, 229.36968282378132, 225.8123673902688, 215.9387791190743, 229.30716023262008, 210.62162575407817, 270.57698461120873, 202.9602061211464, 188.81855167189389, 178.34016467550126, 185.22226185792138, 180.38432319953964, 192.91097279567302, 209.75651512673505, 221.35339983451388, 191.43865713798283, 196.29215092245346, 227.669345894372, 229.68128520617688, 211.99574813496557, 191.09140781735715, 217.10894649456154, 207.4570698501644, 160.64585188663204, 185.7076531169492, 209.88839823012077, 153.41838349940107, 209.2668724266389, 174.55410998189285, 264.6629526839965, 243.29620288111784, 198.31216348405124, 196.72551154311137, 161.1710004719318, 188.18495672385194, 184.29534723807512, 184.87100094039002, 242.07415515868973, 247.27168837506957, 169.26749928810153, 193.21408913295483, 204.2796808037804, 257.21627197148683, 166.16123542690545, 221.42717436396245, 292.24416004560646, 161.54726917748692, 161.28948235385292, 178.0398662513985, 184.63115594116968, 238.46687167087012, 216.36210562515515, 166.58189324230975, 229.04574916036756, 182.14054695338078, 263.52721324010287, 198.05395750154727, 190.92273800760742, 229.978521268446, 242.8816065064274, 202.67022781810576, 146.88720524657208, 200.4641806620585, 167.75367767382093, 187.1263803269961, 152.00651353749612, 228.9337984050002, 172.78186721460557, 155.49222111375244, 219.72324887954395, 199.4591625348074, 204.75563764003763, 273.96000112961053, 211.42077018127318, 203.87218713629952, 204.93372187797388, 195.76614347902824, 214.79680346835892, 175.44871058674065, 191.70819125305297, 253.72509904256873, 193.85030518080112, 148.0858466662705, 258.05529696525696, 263.1728995192456, 176.99500314639977, 147.89152114271093, 206.36508479249912, 198.27323571639204, 195.91448988912958, 163.92527821658686, 210.99553899462794, 225.68144465443376, 163.9110742488023, 211.89536479840015, 276.03499576928783, 202.70841495713293, 211.51695230174923, 193.78902354089755, 219.9179500113283, 167.14195438929994, 199.2052405554069, 175.4399585639952, 274.2260449895052, 189.45541393400765, 262.13634876964517, 178.58928892634742, 210.04384017918673, 204.4123086657499, 183.32209356315903, 208.6964252382074, 228.93966600732446, 168.17065623485385, 167.63683905693742, 181.31495601442236, 185.61818892491428, 182.82568485790225, 213.9592186283134, 158.74080869365264, 177.1446850443679, 227.39215375738212, 201.73778532002768, 165.48059009559597, 213.2447856269869, 215.01729658214649, 174.66225519760118, 176.1762552632315, 208.7665412252701, 217.68647090652544, 292.43610472977934, 226.24538336574594, 215.44934052312638, 197.8507975657875, 217.23046884378573, 247.60535454061267, 223.05543285807724, 200.6058675138072, 192.1764376341674, 186.8292917980282, 241.34712401716743, 253.67001920793896, 186.74581406438256, 200.13682810327245, 222.20219459472608, 192.1378641240364, 265.28039035910564, 168.18684418603212, 192.4834845995599, 175.32458237429583, 155.47144215091552, 166.76889693903533, 181.65229835642262, 178.6264291934723, 222.95774059929894, 199.71410752841678, 159.1672977197396, 194.51255528745102, 254.61638246523205, 174.80136589769285, 194.46189519395932, 229.7945330285464, 195.73231719770828, 214.9476981575402, 198.52117911670277, 233.3928573501078, 185.99322816662053, 198.59641770820076, 220.33467809856347, 178.14074468244138, 157.50234197204355, 238.79835087385962, 191.13655914436308, 171.17271973772222, 209.45631996871225, 237.29248135164806, 154.15864690017764, 159.7645847000122, 175.56852896691814, 237.83977982731182, 206.45890628160444, 204.0091808951482, 182.99053832874552, 172.4032777523551, 237.4025470759587, 204.45372423674118, 233.89154061428385, 192.66774280764307, 210.8397445616935, 183.84903475192334, 232.06959257187444, 235.44712802999027, 166.9713756731519, 145.3806406405874, 263.96210799057627, 255.33468132358317, 171.36513163292028, 145.27999070035648, 220.57919573286298, 225.6335022111481, 263.4206861096892, 198.19993393110434, 202.46143647252646, 187.09115304277725, 206.24441803837314, 186.79514473956982, 165.40082995931823, 253.9201525080873, 263.6377478790414, 225.92751402699108, 156.37625176426903, 214.50366311326448, 206.5988549892898, 212.9950503922894, 245.3139377307212, 220.38243868260054, 207.23624300906744, 220.7639515269553, 210.98786257624482, 147.0729664124352, 210.93036529020924, 200.64860991096086, 151.9535000685971, 251.3511819056687, 269.44440270075796, 241.75650162204752, 215.09960900338632, 252.33433159450476, 200.34944004543038, 198.30175038690592, 191.6126817618323, 236.37092890853597, 197.9238998629326, 158.98799115531884, 195.4401012393567, 202.36874547195652, 262.2211858271863, 234.31375448740263, 202.92257021855505, 221.45429572370736, 207.8054138724092, 191.4755555707123, 164.8857004191608, 193.48775222559638, 183.17795251506587, 149.75787308622105, 212.3989414124161, 214.9034018122537, 148.72366618185066, 206.4704036768529, 236.9442533332193, 229.20061462900236, 231.83712135953175, 194.45938590825256, 190.93876599737231, 161.14520595211792, 212.11276985688494, 218.84805282429724, 255.07486352871854, 244.42505577006062, 196.46377346962598, 173.61185135728232, 189.4168071357159, 229.88730406298617, 204.0135694578227, 180.08803271918904, 213.39296690881892, 183.10991549551323, 195.966424812274, 183.21526217038104, 186.64212769738367, 221.26393266222135, 219.07375238973535, 189.73634619682886, 206.4132505232393, 268.2221074983377, 173.2702131349628, 144.88900576945642, 167.54781933400795, 211.99570009374065, 206.38247506894731, 195.78728344389216, 235.19529778461097, 144.92648208786113, 207.5447034005393, 252.3539758769379, 167.48052991266343, 201.99492945735457, 178.98327037838615, 176.68907092035445, 197.7744836692454, 262.1302493606525, 256.26418732035427, 206.71083132879963, 268.34559012682644, 206.6541873158352, 274.5995675786993, 201.77493063051108, 203.1536362884489, 218.60928767783412, 275.35891073895374, 230.00286931895167, 177.38901748312728, 231.24582099261974, 190.69610805262704, 180.69185899278773, 236.73246834428974, 195.10567883646485, 206.78152456764983, 205.30853065443753, 224.5315295770669, 224.37728864378903, 156.2597107854571, 193.27457043705124, 187.01604615798465, 170.53232805744406, 206.37789747250756, 188.55712695373947, 177.82508442584046, 244.12666679923836, 177.3582221999233, 185.5039317667344, 173.98823754757476, 227.89115628829256, 220.78342480121205, 175.62593267813057, 229.49729969793722, 207.35368254520066, 152.6301762642191, 159.721839610594, 215.78889273272188, 209.37355693110962, 200.17981935199956, 184.44576227955866, 204.01818646053076, 245.66371789619188, 173.7256670349955, 171.64834240210095, 165.00904353854438, 220.80304376988258, 264.622618116069, 186.70736135231957, 150.84537237415645, 151.18958156859887, 172.58278783914432, 181.3266767099708, 211.294247760719, 202.02320040361388, 196.3777534030144, 247.12632501112557, 186.45903416181463, 181.1248544476358, 231.49448129128282, 172.165259682107, 209.96022257291133, 218.61896810565267, 188.30864847244337, 255.25439947745508, 170.55680973587607, 252.9021724727656, 197.3943671180173, 171.37695416207941, 215.77649937233448, 173.41214179702172, 181.1498743609489, 207.64104201236015, 219.30659978888602, 191.42432651973434, 215.71691102848584, 231.43901412797447, 262.79014235613744, 227.777352732162, 252.6152522445065, 172.67661909102486, 210.81433192929816, 179.81802662764537, 223.40822382450247, 186.45644138123743, 207.67796025090632, 272.09297037320755, 196.5653644183683, 211.79557358389746, 170.68381752977584, 208.4347801856506, 196.35087281075465, 199.974704667465, 238.6429324336907, 262.6001805872726, 221.1693595961477, 228.94205087345745, 163.08902606317517, 207.0507378576442, 226.60438637922087, 222.06863772072256, 220.00540469342565, 238.0404182826613, 223.91235936881117, 245.8535457611686, 217.23132806731172, 176.67461715404642, 192.24667626649637, 174.69510939997733, 208.14775699350423, 164.7123691859251, 157.54411801945474, 215.23490779191368, 227.7281772611374, 173.54657559662795, 172.7577562920849, 236.81803994838026, 174.9974487460206, 274.8975036484845, 183.48874481868415, 222.68831409572908, 248.46190290671626, 182.378704298998, 179.4517940681234, 205.2531885175192, 199.7238478763847, 154.1820620012182, 169.85894874854904, 197.37890048750697, 211.13282051886372, 219.81691308563117, 198.3215521807122, 191.1500594683249, 202.63716504283283, 223.03018573877026, 168.6557711211992, 186.33017787946977, 246.53333056379378, 183.3221790685452, 163.5611263728973, 214.44466700392346, 194.72882553448707, 156.50986894418872, 204.00767501100532, 243.81565033037813, 200.27887097547912, 215.38574346688227, 148.9878543955861, 205.66538494662242, 206.1120007006856, 185.82674175736358, 233.27925757694516, 256.61466032001886, 257.29744141577675, 254.3216442901837, 196.02142443384528, 241.38109536545653, 231.36046088251828, 215.91864814039542, 208.93455373880826, 228.98969767948705]  # Truncate for embedding
baseline = 206.73466666666667
mean = 205.74736905930385
std = 30.738384019318858
p5 = 159.12335783637363
p50 = 203.27514883756734
p95 = 260.5785892339973
display_name = "IAB Mechanism Benefit-Cost Ratio"
units = "ratio"

# Create figure with two subplots

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---

# Handle edge case where all samples are identical (zero variance)

if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax1.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key statistics with formatted values in legend (use format_parameter_value for full units)

ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {format_parameter_value(p50, units)}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {format_parameter_value(p5, units)}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {format_parameter_value(p95, units)}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {format_parameter_value(baseline, units)}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---

sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax2.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key percentiles

ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"

exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title

fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark

add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from

output_path = get_figure_output_path('mc-distribution-iab_mechanism_benefit_cost_ratio.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Simulation Results Summary: IAB Mechanism Benefit-Cost Ratio**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 207 |
| Mean (expected value) | 206 |
| Median (50th percentile) | 203 |
| Standard Deviation | 30.7 |
| 90% Confidence Interval | [159, 261] |

*The histogram shows the distribution of IAB Mechanism Benefit-Cost Ratio across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
