```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Drug Cost Increase: Pre-1962 to Current (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Simulation results
samples = [54.11733485054465, 52.74058128324645, 58.91499458180353, 61.08855387737014, 53.29308466629453, 52.89899901022225, 52.32363335877529, 52.30575650186106, 52.126901878615584, 52.62792234149452, 60.38062695415247, 59.222752943221195, 52.077534969910225, 63.30082851781297, 55.82249785329354, 52.63168411234668, 54.78174975314047, 52.6916761150651, 60.36972362659007, 52.1466569777287, 52.22720842294553, 52.52441091223878, 64.4609255849942, 52.20909012063293, 52.37286208842825, 52.327235106101604, 56.516098241582405, 54.747240278148766, 55.24282555259366, 55.433576387428026, 76.80027478199604, 52.35973609351356, 52.42315841206952, 52.6042862746362, 57.42444565778086, 63.3217138556984, 52.18485967527381, 52.620164630599646, 52.61073031461611, 57.80447369441126, 58.83424822422016, 56.6330201211926, 52.51514720038244, 53.37422805489646, 52.21252875494174, 53.23736961031783, 60.288999769544866, 53.28717465859379, 58.11728391826004, 52.07661260191611, 53.956717281082966, 57.59221538099189, 52.992858922940506, 52.30780794852132, 52.398056587818466, 52.499151535982854, 52.28117122004074, 67.89544764245272, 52.635620828921915, 61.41203027025442, 53.12985839445401, 52.31691179164279, 52.672908966503364, 57.0997336126474, 58.47625753060631, 59.398566644255546, 52.325194955583804, 52.393249316396556, 60.13463819117926, 52.23105711613262, 52.882970315426014, 52.796900312682325, 52.667915554463754, 56.13881589157474, 52.46926636779158, 58.24558393696029, 52.372217970345545, 52.63063384429728, 57.52971544812311, 52.30163063425266, 55.70842747568537, 52.51299442995052, 52.3337720038125, 52.3449581830097, 52.83469148543828, 56.02992695080607, 52.397475010487746, 52.10943685774876, 55.963491323627274, 55.59978212754863, 57.96764805910252, 52.17563070193007, 52.36984906947155, 52.164431047044694, 53.13257183762354, 52.9867712227965, 52.911417259603624, 52.714804543446846, 55.106576799098576, 52.65949790933318, 52.342817434345434, 65.40986210510377, 52.329707483047784, 58.7699438052093, 52.676450334607544, 52.23950188568914, 52.6863358495778, 52.31939422913163, 59.932514698805306, 53.15687990161711, 55.471646557070216, 53.43095545905613, 52.472297968626414, 52.98613201451485, 52.0739019920805, 52.433503566769936, 53.37946535934726, 52.103859098275045, 69.291928833531, 52.25977389370323, 52.730635985633384, 52.839017019127674, 53.25064200610878, 66.16152831642954, 59.873190345109755, 54.65787218189066, 67.48732679478651, 52.83041479246565, 52.49967621228798, 52.672207449486486, 52.34979159188874, 52.94410247247514, 57.634624462635806, 52.24953297348128, 53.00113417769354, 52.725859991705036, 54.20813059288687, 59.90760415611593, 74.70837825341131, 80.0, 55.2604808097588, 52.71015642285895, 53.40354544571997, 53.737044298167724, 52.60378585641946, 52.36509219169669, 52.483071177950194, 52.2008859118492, 62.566141010882085, 52.615680702716624, 52.21154194523731, 52.73796888213084, 53.1248831285769, 52.40760862790084, 52.14895750558591, 71.52098557226627, 52.34790964220822, 61.581501867017195, 52.4153951023474, 52.82810677392076, 52.69543377871419, 52.55103184057875, 76.60765333455083, 52.608868036192916, 59.911744244170265, 52.657960772525755, 60.983968326446025, 54.95113213391006, 52.210349306796786, 52.141191325428686, 52.50870674463199, 55.59491934785982, 52.38883353647937, 52.85268424094887, 52.88433216051882, 52.771719692234285, 68.99299485572534, 52.645197956349286, 52.18765989292399, 53.9228658492805, 65.49434620591063, 53.244409842566874, 52.36243868716004, 63.04858481303744, 55.41177130022149, 68.42558569998036, 52.878894182868976, 52.85199700686305, 52.93893863692229, 69.94396996702596, 70.92023036420733, 52.224016419939105, 52.34582605807006, 67.46342817025156, 52.7810544899282, 52.65302166693018, 57.72449069386838, 52.352663210753775, 52.11993831194909, 52.214413590814445, 54.45725176151596, 66.77323489304287, 52.06290990686592, 57.73122321536782, 53.353553957863454, 52.145936706227126, 52.62201482287789, 52.84857770917766, 52.643039865815645, 52.316456024097754, 60.80212753174921, 52.91365254320082, 52.09862679794054, 52.40632666421916, 52.31259602066222, 61.81687034870817, 56.57866594198084, 65.88737550898661, 52.20907590530697, 52.533431820683525, 52.25051084981405, 53.479456078556765, 52.811814157539956, 52.76737662721618, 52.06296655778455, 53.33423966414322, 80.0, 73.02093501078278, 52.628042394848, 52.28849236302914, 52.996669601149264, 52.47023147739057, 54.2297368391684, 64.25625990913251, 52.553350889367145, 52.50832158292644, 53.41285767400505, 52.21394952503096, 52.75411503424637, 52.43347160953746, 52.64226210802262, 52.173110394673984, 53.17537279131003, 52.99885400789935, 76.61900290324566, 52.89007029339374, 52.77486026907761, 72.46739495870075, 80.0, 52.82002368462847, 52.336882087470286, 54.49858074962118, 70.98826879873839, 52.70853993085215, 52.26331426673367, 59.21762537827282, 55.47526648642347, 52.341616083336376, 52.196725405368525, 52.943018218998574, 52.259067378320026, 52.27593581568072, 53.37431518742032, 52.44900085239609, 55.8653758613182, 61.93428785045722, 52.5994476107944, 54.60462471299362, 52.085205472246855, 52.11683447312599, 52.54882694769398, 54.23892744225996, 52.174915176595086, 76.09402816420926, 68.91761670490618, 54.96051127595875, 52.57377794721775, 52.78429420950549, 64.07638063246603, 53.68625316932071, 55.957058183191954, 53.1673793261268, 60.93593830472138, 55.683433364427366, 52.783098240118704, 52.39874716244665, 53.69615717942422, 52.08561570794219, 52.291356135933405, 52.1786165947222, 52.26731961638007, 52.57071968923646, 67.59272621952354, 53.66970025223034, 52.25827622995065, 52.81120088699323, 54.027449744529655, 52.339076646629614, 53.17476050977542, 54.357934574150356, 70.97004331713383, 53.03937651689565, 60.201738254423056, 52.31310593353466, 52.153456562123914, 52.74837301041789, 52.31665514443802, 65.42003786992018, 57.060932661933506, 71.03717472599139, 63.908934166305876, 55.52096105721236, 71.19469044610216, 55.51997159232864, 59.79197338511069, 52.2939879363213, 52.077228111182926, 52.53432192094322, 61.661875260548314, 52.82409433561225, 59.274220342860325, 52.230666814357804, 63.83389861693954, 58.91968537304765, 72.2430951373128, 58.69449807225811, 53.06254504587857, 52.156814690912874, 52.82028987407164, 52.42677875631022, 68.10650526659953, 57.66080166563956, 52.53522729640696, 52.72473716029261, 52.09734516696424, 52.847215781286025, 52.51852966534081, 54.192592402397, 63.640351074972486, 57.345513505068055, 53.50091182762523, 54.113721860071145, 52.07395913697747, 55.25501409800434, 69.48274358775072, 53.361528883980775, 52.470469403593675, 57.150723717956765, 53.068344484339555, 67.6501611704722, 54.77763497359112, 60.004234084625146, 52.45837087167718, 59.63011585656195, 62.59585184064278, 53.38151824390065, 53.397012095653096, 53.764001428297995, 52.63412414179434, 52.204909325544435, 52.20789156010232, 54.93482899984735, 61.78232216510402, 52.75177472193342, 52.191463130469785, 67.72118665808702, 52.56207092589378, 52.60938758261028, 53.071426814641505, 59.97909684310056, 52.1100735042162, 65.7815209269752, 60.121095719339124, 59.94978494314878, 56.751450835279314, 79.57136201375101, 52.239337037717384, 53.32509102050789, 69.3246240853774, 52.39046114406999, 52.12499014323978, 65.53865517173487, 53.080890551824986, 52.86843056793595, 53.080294540629176, 52.59247171778498, 55.526779767544156, 56.42869935854353, 53.82480127169263, 52.96595757913004, 53.51242698182487, 52.084491573222465, 52.39889774296895, 55.73614792106458, 58.373015654932864, 52.42744512066954, 59.02379449889662, 53.34423187587514, 56.49193045253269, 52.53867852342717, 52.22407149897977, 53.015527504894266, 59.70703625675315, 52.35214583279379, 56.396227413203185, 52.27560770809825, 52.187005526615025, 59.80941895211524, 53.31870986367605, 52.895545687879576, 53.00803345843142, 53.526821515775396, 52.522809691764394, 58.90357440017625, 52.28699750542885, 53.025772661314896, 62.843810535526835, 65.76554674404986, 52.15811816664217, 66.09093974737586, 52.061991740542005, 52.618504425152885, 52.47244826251689, 53.00703366496419, 52.6490508190983, 52.33075665537108, 59.51456385413525, 70.88110357527924, 52.94743067977984, 55.033674689203195, 52.740919026821345, 55.899011933339885, 52.19509165864652, 53.21990270615842, 60.94590833062051, 52.478811244022225, 52.43614717684018, 52.75854330947366, 52.508403771828, 55.40262753925768, 52.229826365983335, 54.36483927193807, 54.71050581624053, 65.67757085516274, 52.321640394003765, 53.004803173357494, 62.580953199080135, 52.314878997487504, 63.14843165908866, 54.93465363838818, 52.19512203636273, 54.57361917947298, 74.06032439595454, 75.85965381881627, 52.075539128681086, 52.6471942193523, 62.68858857525119, 52.62347800503413, 54.41052920347769, 52.13230538921207, 54.21220458247578, 52.616079193862056, 53.07318469856022, 53.36747760731326, 52.78729673386963, 52.39104596357168, 52.29196649529775, 73.86607905420236, 63.04503645437991, 52.69361002609038, 54.5625191379961, 52.360133320779106, 52.286686356161034, 52.89997118791341, 57.45938317890959, 52.31952913005525, 62.54076594126073, 52.80212522730881, 52.1131058438411, 80.0, 53.28193708956932, 67.10147678728792, 52.062352918566724, 57.04051375238201, 52.15074749251078, 52.218573572311875, 52.58365671261891, 55.42808731136414, 52.62701528842288, 57.96985882257239, 62.79675738422441, 54.75858556899648, 52.28781372349086, 55.678607998045464, 52.301227710088575, 61.03017047834038, 53.22020725155777, 52.31734407329171, 53.317338586215875, 53.01584106414349, 66.22049278677564, 60.562552109935694, 52.547578000653736, 53.02035476413849, 55.725879821901025, 52.441902823839314, 80.0, 55.476516033506556, 52.451547768849935, 55.796663244212255, 53.05581903998106, 52.2944380166891, 52.05761429904029, 52.16823959557622, 59.369810094620675, 54.53067799672167, 58.000144132165175, 52.528882839812674, 60.59291765465446, 69.65146909418623, 52.698467487192225, 52.64878691737254, 65.86711645016307, 52.231080812612824, 66.72667310926353, 52.381374518163, 67.38121557126348, 52.35999449618064, 53.64002624622321, 68.80427970284846, 52.33300373571689, 52.68097237461911, 52.38498681319846, 55.66129851594802, 53.05873266470407, 57.66011042773117, 52.43906897647604, 63.54946669225605, 53.56396593958228, 52.587917512949346, 53.13204533480268, 52.61178243331597, 53.53216189610365, 52.223841633325954, 52.268156766360065, 52.211870448777205, 53.08237127310919, 52.72161234243125, 58.427503464697196, 57.93761867655981, 54.952042884264095, 56.77759561617468, 54.031815417059555, 75.2562491332183, 52.16883247624553, 52.30027657335414, 52.568047297183334, 52.73592321172452, 52.86409137782184, 52.64945038550844, 52.15903844315295, 54.423229827478124, 52.08640499329084, 52.575268237527325, 60.620280130201444, 58.79119418894018, 52.21214723379085, 52.507582629879245, 56.68996325604794, 52.92667140122444, 52.98738629660103, 52.157427466636534, 53.67895495637041, 52.65601378871786, 52.945533510217196, 52.99144452720764, 65.8721595533787, 64.77380126628813, 52.26764244526175, 54.726485639224, 53.57356285809418, 52.81082917923239, 52.29231781586122, 52.7599800202538, 58.51159200159976, 74.71643155565536, 52.82307383067346, 52.618543656850186, 53.40767182347776, 69.41533313660335, 52.850730625907914, 53.54614179596347, 72.25208130075048, 53.11095444874528, 52.88622663151534, 52.37003375382809, 52.428163229056324, 59.61690850083757, 53.470925926605624, 53.18585646374665, 56.33439177115199, 52.46232857481419, 65.1016992273677, 52.49237180378412, 52.49779281551096, 56.611195321338414, 59.055222537190254, 55.61640009783895, 53.1315160711914, 56.57779264776269, 52.73715707839867, 53.40591869158675, 52.97260350840379, 55.59756744333016, 52.59996972846954, 52.887173666901525, 58.5051659626358, 53.470771062942816, 52.484199841920464, 67.33158328545099, 52.380246095370076, 52.097747077477095, 53.749354483120776, 52.487615474450806, 55.86109391211665, 52.43587852825217, 52.362864608509135, 66.20510423696956, 52.740944433623156, 53.575314549895744, 69.41296331769557, 80.0, 52.35904986748628, 53.28443062291573, 52.30231113337355, 52.28779830193223, 52.230232334306955, 52.784883857544486, 57.02729800456417, 56.4321354930655, 53.01544371966894, 58.34235650574553, 75.50924545896487, 52.76540881221459, 52.3183720976069, 52.20160981985586, 57.41653813997313, 53.15891763905186, 52.68934945960742, 52.350183310168205, 72.61823616282541, 52.22082262332691, 70.17038840392458, 52.77905912832148, 57.111016719904505, 54.26897223212987, 52.63755726867352, 52.820095069774304, 64.33792705942075, 52.310273464175886, 53.1353848279732, 52.127356042329744, 52.65765714058738, 52.321373935450595, 52.16554662675057, 53.14370610353018, 53.089026715810995, 55.977572319214715, 52.42944081364022, 53.66852516204394, 59.302394707583055, 53.784768122818015, 52.54420878764719, 52.9078649485948, 59.881139446070925, 54.5795965637557, 80.0, 55.3213728952125, 54.97995973475987, 52.21649514702184, 59.6643541981598, 57.52417722692115, 64.82041535095006, 52.42860372716562, 52.377103574954084, 52.40328968947905, 59.36976030824734, 67.93988157514505, 52.391144971840816, 52.37073292598078, 54.21395066415997, 52.263603411514936, 61.22244663371586, 53.47673625251525, 52.61206864716673, 52.58542149538217, 53.51870316289262, 52.69454269296269, 52.66532734574559, 52.23691278089481, 63.12886100440714, 52.26318442087696, 52.735049156631, 52.150849708627355, 62.3660783284129, 52.701969504744895, 52.662567542953646, 56.7994072731988, 52.24912262287106, 57.77024665639482, 52.125021053202694, 58.369790078982135, 52.737621622435064, 52.12408963449033, 52.24264063695243, 52.846811228544794, 53.05734819797906, 58.1930367045549, 52.3265281067937, 52.72990179606799, 52.17425410511694, 63.310209922220785, 53.49445471652534, 53.0167979503958, 52.66998453797437, 67.4600159111819, 53.88959125378857, 59.104656044261866, 52.801051752626734, 52.78859603979759, 55.61337274570161, 52.08215569761983, 56.69332201557216, 52.22888637782332, 53.843980808352185, 52.62641553198574, 59.222475919928826, 59.553400974811325, 53.091585635017296, 53.47397827453448, 61.80494500204308, 64.03465982656674, 52.72890219567982, 53.237517210969706, 52.057877889788365, 60.97542969335131, 71.92644007406527, 56.34391663271142, 52.33895817340139, 52.65206018151469, 52.11005846149526, 52.295599317030145, 52.72555169081572, 75.45272599158481, 71.75632142795087, 63.407161328807504, 52.66875786817345, 60.10076699700484, 57.68379993183424, 55.55756987470854, 64.7949774543895, 57.63704295094047, 58.797934204669396, 57.6539067432311, 54.490645326831334, 53.191118688815045, 52.06705730976878, 52.44951966114781, 52.88548359803093, 70.35689426544796, 70.99229610352022, 66.16194469880776, 53.609211970488694, 66.05366061660344, 52.10969968929465, 53.076393649347985, 52.77285957363483, 55.07736009359094, 52.080897707569925, 52.8992849890433, 52.14741525171984, 52.16443782136305, 71.92598288029252, 60.5513392278294, 52.11006195009575, 53.54360297551861, 52.09053391993501, 52.23799392157641, 52.76619306015367, 52.20701329500853, 52.563580100898704, 52.867625238117846, 56.28944382312466, 55.0172872363726, 53.19300270081069, 52.1900754624261, 61.73380066480651, 62.485635990225155, 62.08934217225375, 52.09369155753619, 52.623107381562875, 52.76696060195704, 54.530258993223384, 54.89177973004913, 65.26173410255531, 62.972828151305265, 52.195773499768414, 52.86393058187889, 52.307470114614524, 53.22258610187506, 52.23749752177239, 52.46254174629442, 53.58542822728808, 52.4181904664593, 52.4926591494211, 54.18684421323876, 52.35708740792591, 53.495842072072925, 53.793319598864, 52.800609688201774, 52.40457126548707, 67.15984270404881, 52.81429187702536, 53.39414378597614, 53.23874111248274, 52.09953356870651, 52.09845648485161, 52.1870465306312, 64.35841755688915, 53.73492337964387, 55.066262650946015, 68.76128928906834, 52.79357487555534, 52.34380174954978, 52.56766506288893, 52.65279221126999, 52.31175163735175, 67.02825629636116, 72.47392927820883, 52.317542673525516, 73.41461806076151, 52.09567992588007, 71.32718174708047, 52.172535139213785, 52.355724198326186, 54.74755752492817, 80.0, 60.05801931352961, 52.54023585153484, 61.42045130363768, 52.333040886453844, 52.40967225238056, 60.717589568518456, 52.09835618136107, 53.84841556405452, 52.10854806045662, 54.446964134123355, 55.37175948234262, 53.284509184324584, 57.98076800804678, 52.705623265862386, 52.9838539024554, 52.15171870563024, 52.0668429429289, 52.531967726317355, 59.82666382854922, 52.92320606922856, 52.36005277089057, 52.46673070541226, 52.144665524008964, 53.85137478258328, 52.72122451120672, 58.62192924608886, 52.07933899840088, 53.257075536814476, 53.29769124407719, 52.12422953762361, 52.248782670581534, 52.17857591581915, 52.13356939838701, 53.30712506019472, 61.17108699904821, 52.78350531873978, 52.82026836462104, 52.772770526148, 53.95463278874249, 64.73674894316088, 52.37466633445681, 53.629835705952274, 53.142697387390996, 52.61587932420633, 52.45044176832155, 52.360918171806574, 52.09388944403706, 52.3030663781916, 62.36805109986297, 52.52145962951453, 52.633505631795465, 55.94354003280714, 53.04045687422062, 55.000798317924556, 52.07210040748835, 52.2048578558017, 69.11385945707956, 52.4891414147433, 75.61887401350222, 52.251450798216716, 52.88377493920593, 52.075218385934534, 52.76246183407524, 52.56698193330118, 55.07780087135395, 56.76730309618498, 52.489117551214036, 61.63627857405002, 63.66698545919897, 67.14096554978838, 56.48491942906487, 66.21502233460313, 53.25028471800335, 52.30675208583247, 52.63632777313772, 52.237808013959025, 52.458674239228074, 52.21603517796848, 73.09514442311438, 52.218162746051156, 55.253982537786534, 52.255537935448785, 52.07176730140444, 52.11329802057397, 55.61878165536613, 63.76168790507422, 69.89688259460583, 54.167922358227166, 57.135920150601976, 52.80751693813287, 52.16929947892823, 61.08534967413311, 60.226301177300044, 53.165601889573935, 60.46117924452308, 56.070453760355136, 64.18836857214735, 53.95918258761185, 52.329368887478175, 54.439267293705186, 55.345192242391654, 54.92950985588459, 63.98134090549384, 53.15453468112525, 55.65530213796038, 55.9291902236972, 52.814502882027064, 52.54314327603279, 66.30482751733986, 52.40624315732275, 78.29683627278749, 52.11802933156099, 55.19340680433831, 69.4915456218263, 52.355417802723366, 52.71787819974053, 52.182340667748505, 52.13811870677371, 52.936869145620975, 52.26962430351096, 52.56123150703934, 60.900174742894, 52.09625475000539, 52.285748491297284, 52.18022436798995, 53.28236634449486, 57.433581398885714, 52.71629119321255, 52.741548686106434, 63.02924999112516, 52.3632830213314, 52.968427287809554, 55.57098650275924, 55.77847972604035, 53.03746775366748, 53.34698010553762, 58.74830509739318, 54.84061465080215, 57.599824409444345, 52.96080988473611, 54.389482531701724, 52.29760635486999, 52.40549983960345, 60.27896882302025, 67.69304567699625, 71.8822570858069, 65.6043468533074, 52.18234468488749, 54.614654175938874, 59.099088110276654, 52.25724402110117, 52.3527946115209, 59.74373779835676]  # Truncate for embedding
baseline = 52.0
mean = 56.16608980914259
std = 6.071396370834751
p5 = 52.124696697668185
p50 = 52.97192739140738
p95 = 69.83714970685362
display_name = "Drug Cost Increase: Pre-1962 to Current"
units = "ratio"

# Create figure with two subplots
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
# Handle edge case where all samples are identical (zero variance)
if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)
ax1.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key statistics with formatted values in legend (use format_parameter_value for full units)
ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {format_parameter_value(p50, units)}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {format_parameter_value(p5, units)}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {format_parameter_value(p95, units)}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {format_parameter_value(baseline, units)}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---
sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)
ax2.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key percentiles
ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"
exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title
fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark
add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from
output_path = get_figure_output_path('mc-distribution-drug_cost_increase_pre1962_to_current_multiplier.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 52 |
| Mean (expected value) | 56.17 |
| Median (50th percentile) | 52.97 |
| Standard Deviation | 6.071 |
| 90% Confidence Interval | [52.12, 69.84] |

*The histogram shows the distribution of Drug Cost Increase: Pre-1962 to Current across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
