```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Expected Treaty ROI (Risk-Adjusted) (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Simulation results
samples = [283994.7359054666, 298874.05960930674, 419506.3399317486, 334032.75393330056, 404894.8198226398, 477209.1097922148, 338413.22681957966, 190879.1905214223, 350076.15133808256, 506810.6536750946, 203426.98323043855, 364318.5003972627, 486706.3929767538, 253017.83058233012, 310403.677556007, 256629.05989192572, 199622.7429687794, 177362.31638253175, 355275.69391712, 346215.00955045014, 343878.6248713041, 199157.02078182893, 433356.9478995119, 155319.64874366208, 381772.1901398273, 318267.87424522196, 138874.81882165966, 416571.98882367957, 290832.55090909183, 634438.5019391928, 243490.0076206455, 568939.527221798, 201752.18069841675, 105455.20343163854, 543062.0934658312, 87397.8284995588, 160680.6023637959, 416521.57214073185, 269073.62162911275, 304456.742761577, 518948.91789299774, 448959.9375798013, 232992.62194638126, 89411.2858038016, 200999.84202256575, 215662.7953013111, 459980.7337154465, 588203.034721619, 131650.1388455277, 271657.16278598725, 529384.7882112126, 245038.65816898295, 385077.3112275748, 392109.12295995135, 380740.88216717035, 247267.31837685613, 166130.116583666, 288847.0711049306, 392563.5135845177, 94160.50544825623, 556193.5354293173, 62348.04282262379, 73161.67280342527, 158341.2076609023, 236081.54985018668, 298405.045356061, 289443.2144608751, 308977.483999321, 209090.71576829758, 604006.5773689966, 230218.44244703912, 274266.7018884289, 139002.48437263287, 277002.2489390181, 535066.0876953376, 528524.6892951436, 453543.25789388764, 315735.22184044425, 290119.9581175279, 461243.6574794912, 239878.66009862008, 391287.3612608466, 337571.1285963976, 325360.0294491038, 458676.9920896972, 133858.969110222, 350921.6260439127, 587051.7423466488, 271740.97603024286, 350109.9795837291, 310071.60716192157, 249211.16009741902, 105915.54451440624, 149585.11886791376, 361508.75597945007, 571463.4264389765, 152622.41656205372, 172727.64599857703, 368719.01650894026, 334808.234105752, 387951.8533938277, 358491.35277316463, 206715.88855770204, 298358.1661429184, 368417.6424490142, 568281.3514854291, 263469.5202643537, 277976.3322801683, 567022.0330804244, 152279.7129273283, 487590.0041995747, 222967.00908132616, 369683.15357941797, 320160.7354928516, 170363.25232043816, 228938.87863989244, 319557.6322401964, 157307.87459580702, 190834.78483529945, 368256.61837848, 284501.63444127905, 281896.647173815, 315301.02904942475, 250467.7407921454, 299874.39130736387, 281903.32009187696, 175976.626385126, 533126.7161051129, 614059.0867420067, 103726.30215733695, 347288.6146640629, 483376.3586819017, 367532.3081370704, 477118.3412785344, 253348.64778202432, 125409.92171459935, 91533.05814637344, 355517.9463045139, 255634.64429360707, 252428.01771170294, 350022.0125237599, 158999.58122673468, 266964.4044899202, 443637.7994972311, 509762.35533471266, 313582.5123650048, 502947.60224171146, 211464.8594337735, 140540.1439188949, 87388.6549648438, 342466.06950494344, 201092.9137975938, 241180.62442837332, 169137.5733964327, 141208.05550820782, 157172.9182331532, 461080.53061024647, 221710.22340285324, 394296.5096968161, 98207.10212729764, 251067.01185141216, 225140.01237504696, 60525.55892958231, 204863.34769169262, 134326.05264316392, 390253.8924071981, 470139.69727787416, 634219.7753122564, 184107.28290758288, 126215.35918332948, 468884.57193927135, 246566.64494077815, 283727.8286154911, 485878.5317132194, 420988.54440880445, 271122.16795264115, 383755.1401760408, 131492.9243042591, 122777.98578657334, 192672.108751481, 387468.7920981575, 412722.19531900727, 252138.62329038072, 77854.2349216522, 450731.5832972188, 314226.761796638, 278298.98743663373, 73567.1309761935, 148555.04509248232, 590764.6801871212, 382685.0202509078, 627077.0322472545, 286417.9718362386, 371179.18648837577, 404355.60023878893, 496698.58953301364, 400453.47898160794, 304977.89276096824, 553258.724309477, 399919.21345904056, 173417.63620145572, 68313.60482625249, 535323.838056068, 254680.75821239557, 282531.36091135326, 251189.86287928777, 230225.8719857763, 351662.40411568456, 262857.5712410837, 219095.5964403429, 468019.29406318493, 200351.81237910298, 388595.16903455043, 525423.0079421501, 623664.6366546453, 195370.71424546142, 311176.4796665225, 174407.32428676533, 303714.65497154556, 196737.8443159876, 612755.3724178968, 304391.5807804029, 436617.34495284705, 105290.04408014762, 213045.2735806409, 307546.18324375997, 281215.5968894174, 312515.1219091694, 250604.5024320188, 168200.20594836512, 289189.38674066105, 514309.15907642513, 328709.76336050266, 291495.2215393536, 214486.24128055203, 441456.7528875429, 389266.1351027916, 340203.3862780689, 295741.69174678857, 82659.26389221803, 224080.25000769304, 196940.45405785827, 152563.5573577811, 185596.4401931151, 222819.06430746903, 114501.65531063374, 102876.92277436433, 288706.31218819245, 107887.75769942749, 263901.66334557906, 227908.17639530252, 321580.65923167067, 236290.6141552657, 312795.54726063285, 166543.39649122648, 162969.56331974358, 230504.14222219802, 584952.6148818639, 62996.749893514156, 475717.3812611489, 171906.3198848597, 508017.865351975, 475561.69448630844, 289237.4966272371, 139520.6101930711, 124322.87618383172, 326789.5535062375, 283592.44406504306, 107629.28650142276, 286764.3271676596, 120390.86823809484, 205542.3958020031, 347600.04634229623, 96748.7214975335, 174046.43341949038, 254330.69774072, 403601.31332350516, 294790.75943661033, 153147.5458779466, 278454.2292084098, 340009.1169361245, 151912.97781779486, 286053.6645756833, 501151.2106125759, 171086.13993626783, 470445.9379108273, 550555.5647626463, 185871.41135140136, 184294.40106291798, 491297.83481915446, 214739.15500541625, 140909.6274684833, 153465.42995411143, 636853.0087585661, 114293.93628034221, 103928.4576702147, 291038.92611039104, 527817.4180203434, 321792.4269391684, 376351.3941508933, 619167.9764533726, 169045.14065324585, 340218.49859920214, 166448.95910740262, 282215.5286718046, 257760.2791095292, 368222.737835498, 362789.77069691336, 189565.1224582603, 149082.07824815207, 165179.51506200442, 634472.7222244251, 217029.8753631781, 154504.67833507023, 487792.78260298545, 213859.08602852406, 226215.73247362833, 237097.92438079533, 342394.21401758835, 437472.21919316764, 201221.50306416536, 482297.0536937314, 388909.30099943385, 239197.0077181514, 422531.82170372014, 488854.86005857954, 295981.6289706131, 629213.2026402258, 476997.0198774052, 368464.476971401, 519454.06225184596, 531061.9007562089, 81401.29614665783, 83034.9931538288, 148934.2634465605, 462486.6603034625, 232145.75080516702, 124647.49687861865, 207772.47623859154, 348958.69171889994, 402551.2565566014, 206961.4436911102, 386622.97070999024, 401964.18559632305, 592525.5313005871, 311320.4086489387, 615783.9254258298, 269200.1389546788, 188367.56959014043, 462434.2043362428, 586606.4617858824, 140471.78515776727, 186867.12657391367, 347944.69525482587, 491663.6935563766, 141715.46082257575, 318744.6348556255, 602423.1306480683, 348501.1231925543, 291754.07153951935, 624802.4613953547, 426265.42909764126, 477275.2404655067, 547364.174801321, 404558.5031806913, 273475.08758111106, 401916.36401387665, 345002.6945421169, 233953.992239237, 634362.3137071748, 407460.9936052772, 485430.2221290924, 422341.5133449669, 123846.43890744432, 392327.77609414415, 198286.43658148634, 179947.69137258403, 281177.9806364673, 279224.4208407517, 591506.8898815843, 236660.4401097907, 204648.0277357869, 206458.5914204324, 421902.62088432256, 101447.44588060971, 412051.7911733468, 331115.7298079269, 424236.6216825769, 295619.57758572587, 383312.3231757658, 419201.42082891305, 203536.7847989511, 115411.55862686918, 414336.01491197356, 415016.4679899538, 333853.2471314678, 80957.98308022277, 353199.09676273726, 178303.9274797877, 419602.56159623223, 617980.3929452319, 474653.6785523494, 264126.5730378448, 265095.0257481638, 120088.18176425471, 223523.3726057183, 325326.81057219143, 544202.7535912482, 206372.70607782286, 421475.7234489649, 371319.0386934188, 122142.35582985631, 303070.16657777946, 397400.7442095481, 290403.7673599468, 632799.0142723696, 448143.72362105595, 343982.2148521921, 333799.7029553075, 514693.3472137271, 139520.74995367328, 238037.3767534999, 312372.58333614015, 286627.10540720477, 194358.82471093323, 364160.00760767784, 63452.098575698714, 341412.20477719075, 57594.498741536634, 362220.27647131385, 197313.6730831809, 565412.2756399867, 222868.54310679555, 386825.9302659609, 449146.8472032839, 211090.1501623961, 169711.33473210936, 258587.76341503282, 245684.88369887805, 231164.2890184981, 372921.7531860643, 171131.75117492257, 225537.62198330287, 249558.74397289025, 505675.80854132306, 205765.2293794011, 401512.6364036516, 623567.4061933955, 445074.3901937813, 281213.5551882664, 309887.4537988624, 399386.8597390048, 77173.54519906735, 71964.36302154532, 182767.04907855642, 213741.98482951426, 333410.35655835253, 251452.36696860427, 349838.0078389447, 334197.7441093146, 444812.6939097004, 102350.45501542109, 329733.5442099888, 431684.1463267575, 567494.5365494217, 117465.45104836187, 266307.41271533817, 359857.97112683416, 266602.0679134655, 600338.9260999373, 494074.51625169674, 313577.7971334811, 446977.5350953118, 78791.36307107763, 472173.87287777674, 458663.89920851024, 145863.25682018715, 297002.88927985413, 63040.22306921228, 74396.28872525175, 594410.1366221939, 135469.6194287681, 172247.08515099788, 634821.2884669962, 186994.8627410284, 118691.57711416476, 100703.44274816732, 392989.60648338177, 231428.33910587916, 264574.60955754464, 233388.0584231084, 232866.6529092696, 162699.87135946107, 389683.95278982056, 415019.97396250296, 285249.22514517047, 265862.84983821126, 294653.6694504086, 332766.96607351664, 568026.0219953948, 251857.29887405268, 131804.46269639474, 535877.3896321006, 339917.77569353976, 536007.5641086911, 416545.6581483096, 54453.97249614695, 259396.35935756218, 312984.89358679997, 289390.6307992763, 235899.44983414846, 477136.87336942204, 67098.54654660319, 344812.51979422226, 332496.7546955073, 364089.43252037495, 389635.7931388284, 423942.2344956436, 309084.33427625697, 62633.798353749014, 108198.08421876555, 321073.1614462548, 313437.40561583947, 247386.4952184517, 397650.970577162, 176650.1408443936, 172191.8159707431, 384166.468230192, 290400.2704469243, 453553.2774990965, 167171.3737046284, 332100.99812794325, 301775.62238284, 308370.45016152016, 129758.2441807962, 268473.63084374566, 246580.18968158666, 175970.25598132584, 295154.65787774144, 154504.68214162483, 178075.32579265244, 246910.3858573147, 234988.50482084812, 314215.9301063167, 625463.5008806362, 99503.34227254851, 512698.0374613605, 152902.85480185444, 290052.633826162, 220680.82771546024, 502354.3077009119, 321071.86357568635, 580679.7188928294, 329149.4030953774, 302150.8873155187, 149984.32436945746, 539006.71318111, 175106.25995168873, 343038.13990649086, 603820.3937287824, 535518.082582316, 382839.8006945467, 309712.6269906832, 255001.5250584073, 63409.670130493854, 317170.9957391282, 76557.7417517301, 365402.50758038886, 166199.39716909383, 376818.0698672677, 277306.1783096089, 394346.42342585005, 368283.61043603864, 603316.6255724919, 516900.4081820896, 199163.19104966408, 405663.7768886946, 446297.16164613847, 144412.65542773696, 272405.49159548956, 116221.18626393907, 377646.91831677995, 373618.0762449095, 543479.0704140271, 634759.120943478, 403063.2182269093, 419942.49375690566, 383783.0782850726, 236205.2662258587, 556952.0493505371, 502505.85062300885, 255540.81291088896, 298194.13762789924, 321618.70392261783, 366334.99115734536, 564067.6016979808, 618131.2859919856, 138341.53968445925, 285374.99815938453, 196123.7514912963, 171221.68595865663, 68068.27105597424, 71462.45620789332, 163410.23228314752, 61417.29152165514, 186561.8543163339, 443436.17122497404, 181047.4264944759, 114053.14763659515, 397233.4094008536, 427097.41005897056, 462070.2551698712, 374800.0704667776, 634501.3890172443, 142789.49894342702, 214386.97613403774, 438885.999345614, 431689.75807830173, 61498.37814370061, 533382.268965154, 270726.53885138413, 472539.6048249305, 349154.6560449662, 454340.5859243532, 193385.82613633896, 331163.238354714, 423424.412665564, 204091.9796315679, 296205.77646992414, 403395.8300690724, 163853.39968371103, 182950.32054280658, 432231.2130873649, 316140.99422541575, 87086.43719125821, 290333.8981373382, 135567.62637097744, 354698.3813944973, 79369.70483408464, 300281.24556144385, 179519.87875403848, 156246.56338434908, 289280.23193338123, 293885.8906581013, 116971.27666637157, 402512.17867548275, 324606.71764660836, 208704.04763014795, 484055.36439980037, 257918.29843337252, 461148.660772265, 190908.80105797964, 104483.41842437064, 276880.3475209017, 300067.25030519674, 195897.4159537746, 181303.04546771647, 378921.12895904714, 219489.58063167825, 309956.5338884417, 324487.9412699575, 315592.3566045033, 603189.7484338422, 222481.65883678012, 153439.65174355244, 276332.3900538002, 297736.08469338017, 143390.06475400456, 328330.57720633125, 354356.69507523195, 323335.7035705434, 338033.0263868998, 112800.54916604033, 176459.65193952344, 398013.0900245988, 112660.89383563567, 517279.66934898077, 235392.6246472528, 151837.4837900955, 419719.4635257706, 467719.2656411571, 260099.92320037223, 212937.84562835126, 257406.19784399623, 181511.27616877278, 578177.5574072113, 516156.0680054432, 440907.49070759956, 418959.46448948886, 273513.0788093156, 82381.93573070204, 127199.37336093682, 358478.36572983797, 137702.71936133984, 300206.5086356838, 150984.68913250478, 311308.251230532, 231847.15910787816, 180992.7742358196, 309810.1908241199, 543406.9953871461, 508185.94165823545, 137328.98446344005, 261857.5601627082, 338297.36068782903, 417080.14427248325, 165030.9097410415, 552538.032876405, 174221.7279626289, 325224.40082937595, 387479.8041085404, 199573.26272426048, 301590.17533414596, 225204.03172768504, 392705.9520452458, 180278.59808965365, 81844.05219597211, 447508.1280808791, 181984.58022083258, 191147.59537193697, 328283.80354051985, 328860.8076107781, 219619.79800200282, 268483.88498031656, 239532.67683885002, 149296.46567955305, 302367.28495443956, 242402.17483440315, 59094.47336840509, 441173.91753866686, 388762.4668292329, 400518.441429486, 203339.1020136102, 626907.3330948476, 586548.8256934694, 511011.5345896823, 297712.72732899344, 398120.5512058591, 406126.329361183, 344595.35987461166, 128842.05653697198, 211384.21075722383, 459890.57407932694, 256927.0522233506, 232975.31545030937, 301037.9157610729, 87130.65410926494, 400619.86283419596, 325921.40219307446, 101286.41303744474, 209193.99066705588, 129689.14610238573, 362384.80387637776, 223857.71241992246, 161480.24106941413, 598669.0475173285, 407787.69718605146, 292742.4719480156, 310372.01226986235, 290764.21908797853, 319984.1817954156, 215318.04352094262, 609716.5145713107, 390473.1712854603, 255947.2538165205, 278654.31814358244, 266223.36756347894, 172674.5038191607, 457967.5683643844, 70514.70645159745, 180989.5545661475, 495699.0043970027, 507509.36581375665, 272149.0963763704, 178267.98447858152, 171402.94091402864, 275686.65154645644, 137314.3593077571, 344523.17168621556, 356174.76369658456, 281037.8004049842, 340079.216058555, 399393.1489190174, 298518.12482235546, 293514.40660519595, 633272.9201067169, 359579.99744299875, 413009.3153124081, 322899.8075116776, 314125.63067188923, 308646.00902712566, 372686.7947945934, 122566.13647260387, 482512.5318530469, 261925.0821285614, 99075.92158711625, 164335.809406228, 170260.71340282334, 110872.99885423965, 300655.6313553322, 351956.0056037569, 216256.5430275737, 228805.53438912256, 146422.60808736496, 380503.57580587, 500309.0945543634, 221172.5478442522, 202717.4482894569, 426626.87075004465, 315336.98834963975, 197337.59626198595, 299386.1659611712, 125574.77888642438, 222567.26127478294, 226394.52108913334, 341704.01362477685, 482028.8066872549, 363235.95217961725, 281226.12928824156, 284741.2617198045, 193990.59706754, 391340.4410032892, 526934.8885941128, 275485.3553836094, 354240.2767780302, 192210.43394835803, 389987.2664996596, 439110.3676282982, 377496.22470948816, 541962.9492118092, 440636.15031784336, 380675.6867406564, 306846.3005580971, 319822.9427907892, 219380.1879560058, 80583.1323727127, 426543.6284761809, 405569.2616033721, 418035.0991024552, 62345.33587802467, 161916.00614494254, 289819.57334798086, 272101.59665511816, 392481.89506193664, 252366.584454832, 163347.01887643675, 404176.7082188689, 445255.78207156755, 199217.3612526294, 473298.75224252546, 75552.13043612042, 312578.38173443545, 436109.9411678178, 532458.2630482817, 63351.91208400694, 152454.68486941725, 316925.45082061936, 247297.05271426152, 205406.29268774853, 360324.613990849, 217235.71017987188, 520006.15895571816, 498548.73681466724, 355781.16660218756, 423384.12877005653, 351569.01453543425, 401186.35891526623, 261649.69714777518, 615998.5220097094, 600380.9739544742, 63352.139549315594, 167608.33024543463, 360393.61715966056, 424029.5456250774, 161573.4972097216, 426779.90208971367, 222529.91257512092, 332127.2796532244, 330640.98473487224, 193492.0210767361, 360442.1316119004, 221533.00400099505, 150219.65705919577, 67697.3218013662, 413745.9335694956, 357714.5367379597, 334793.1273336065, 169189.52957302093, 257276.0002735974, 321719.0461356792, 220886.7759880872, 522370.3478338395, 421290.7818075749, 308269.760195627, 348385.5215284867, 79044.83930883267, 72878.62929535621, 166226.73475549964, 376051.5548611994, 400790.30943247984, 634244.6644047144, 303323.507992542, 427971.9268230276, 509355.3321861963, 219519.9094486134, 235469.2337262934, 219234.9799430059, 148166.21934447667, 631309.5256182298, 276366.00086244807, 382302.2206898801, 634282.1626028572, 611485.6891709915, 132046.91829450623, 285952.1311758461, 369695.7033474817, 569241.033850547, 329854.205065568, 157192.59774444834, 251392.2168473602, 62391.13667528641, 361382.45033143286, 420175.1506934718, 294103.04068482766, 497604.1308439532, 165150.36862015308, 380042.8134353207, 230900.3181176349, 224660.00570578984, 217045.1054214719, 384895.3667369539, 338359.71084223385, 321825.3192444972, 432697.34030985576, 280057.6973737846, 280201.9171098256, 533914.6644245007, 165197.32507177332, 195403.66361266823, 555115.8856183471, 456131.72638783394, 250848.62444807455, 219603.9976465807, 227314.36376466893, 476692.5993590752, 270883.7296542151, 184940.54778200685, 530745.2429221817, 159677.30143072584, 337485.09756824066, 88330.5042562863, 166756.00415360316, 183771.8194226184, 58967.40973944514, 369689.63989357895, 294941.4365459567, 190530.9219136976, 394748.5206989643, 200775.20900742072, 423731.6283049006, 187179.21135214297, 409986.63443307654, 111944.06658217488, 315244.9302961008, 368048.4567160964, 117371.04196677847, 171760.1279230922, 204803.4217131318, 331483.97650741803, 340135.1896645166, 156367.08490973478, 316751.62450005853, 388607.5389639358, 341321.4222104387, 290841.0913542183, 253833.5746893043, 291755.0442437523, 140961.7014277336, 237446.0542335136, 634491.582033794, 316455.59784145147, 341750.56547214766, 320073.327230581, 159828.9610715101, 316663.66842491296, 291911.65170045703, 494001.0281230676, 240328.8850372169, 486047.8245441991, 201681.40832181266, 368479.9012372336, 149212.36631463017, 380663.69637935277, 204673.94138145854, 103667.6088733624, 192199.10310923238, 376434.14252388984, 311213.84792470274, 111034.1297411309, 365571.00433225336]  # Truncate for embedding
baseline = 297854.38392375
mean = 307004.7260129325
std = 143082.2390173505
p5 = 96394.72045251739
p50 = 291524.2287489907
p95 = 577321.932814153
display_name = "Expected Treaty ROI (Risk-Adjusted)"
units = ""

# Create figure with two subplots
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
# Handle edge case where all samples are identical (zero variance)
if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)
ax1.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key statistics with formatted values in legend (use format_parameter_value for full units)
ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {format_parameter_value(p50, units)}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {format_parameter_value(p5, units)}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {format_parameter_value(p95, units)}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {format_parameter_value(baseline, units)}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---
sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)
ax2.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key percentiles
ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"
exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title
fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark
add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from
output_path = get_figure_output_path('mc-distribution-dfda_expected_roi.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 2.979e+05 |
| Mean (expected value) | 3.07e+05 |
| Median (50th percentile) | 2.915e+05 |
| Standard Deviation | 1.431e+05 |
| 90% Confidence Interval | [9.639e+04, 5.773e+05] |

*The histogram shows the distribution of Expected Treaty ROI (Risk-Adjusted) across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
