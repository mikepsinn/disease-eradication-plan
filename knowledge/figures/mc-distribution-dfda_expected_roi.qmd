```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Expected Treaty ROI (Risk-Adjusted) (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Simulation results
samples = [15794.206206352097, 1192.7906200928035, 1269.3623399454077, 7739.184890367455, 3486.545134556746, 128906.71493235324, 2022.221819105057, 17110.454694378986, 2303.8697503803373, 1210.8791789230477, 25762.595617030798, 1269.210797311154, 13670.12307898147, 1264.95197323737, 4774.620407642472, 4842.314136719354, 1268.2614141696, 1200.99189106271, 4088.265349636552, 1259.0067203533804, 1253.9320696674547, 1928.7954743578553, 1263.1178785136976, 53632.829795719364, 22500.915241733837, 1246.0657775336385, 1269.503464936304, 16081.66842410482, 7053.221043977123, 1268.8770038783855, 1152.850760331743, 4774.447675490207, 92020.7013675159, 2315.256522960478, 2792.5606319809235, 26089.963361705126, 1256.73573090646, 63422.8864651581, 1213.3928378033409, 93331.97014814414, 76540.91580581998, 16375.801955035906, 1226.2207066909607, 1266.2514900343533, 1263.8106148151155, 1266.0026034613418, 18745.53131179048, 1266.0943315624634, 1269.6218941234326, 1262.5562578183255, 1267.201871160706, 1269.6815262794094, 1141.5049610396238, 7705.775197824829, 88524.2409560023, 1228.1816659022884, 1249.910059963449, 7732.9389519111, 21879.49230777773, 9122.249434503661, 23103.711043307136, 1246.9608564524758, 1264.8686520490471, 5772.5811584037165, 3573.354065321099, 1269.1119604852167, 1704.7768578230725, 1239.8731125245165, 51968.61943767715, 8520.926086487852, 5472.33539490206, 8343.439720688293, 1826.061712917731, 1269.3386534547137, 61180.81118134316, 3597.795249448375, 4368.946174932616, 1264.7765859315064, 1269.6824525723212, 1248.2500840349387, 23924.953260608374, 5443.6678741221895, 2121.738058090915, 3067.9092829189017, 1175.453450352578, 14906.097590743417, 20208.767772645682, 1260.9900925842537, 1269.242931719705, 19001.873575433274, 11995.29078013764, 5896.734690814949, 1242.1620344946953, 1858.31704276071, 1113.1482789265349, 7569.676688343761, 1159.7558810898813, 1197.1809633612309, 1268.5916766174773, 1206.0945513274858, 49938.3512319041, 1261.4575770307874, 40682.49098231259, 1269.4240699833026, 1203.4350661719295, 14330.535945169586, 147652.64012267662, 3936.7801885988697, 5810.105930487068, 1119.9676025699114, 1268.9072209203864, 1538.2767222898171, 1952.687177621842, 1143.0756064057607, 11709.58367985197, 24640.184963231306, 1266.2608181422966, 59396.0905208247, 1253.489744921201, 1251.5661260990948, 1194.5024966156236, 26331.653396087484, 1266.0271778454894, 16437.167923362485, 1268.8021081979268, 4190.643134275448, 20876.326951417792, 1176.2866093304694, 1228.1181734840134, 1204.1066737904714, 3962.052029490183, 7828.967567215681, 1269.680136822235, 26758.360316853315, 3237.115034887488, 1195.316545457996, 6522.1406359081675, 1268.777259061748, 1181.8600967155473, 5899.839308442049, 14491.658596057621, 1197.9565499545067, 11090.818678550335, 16025.472276776625, 1214.3900780154709, 1916.8270834923132, 1230.1005389186435, 1255.7105610174128, 15451.168198150646, 7293.706289817164, 1255.0048461775552, 17840.001547254404, 5504.182673245363, 1238.416714787986, 22890.983872209865, 6446.839580722004, 1264.1345374398284, 1267.2092443082386, 1392.9159565745663, 1176.734428429554, 83228.98802901861, 11592.361458652464, 1155.449436052796, 16576.021769542425, 25671.178414772745, 5051.522379394828, 2706.1888082286737, 1268.4395506245128, 1573.388672990292, 1259.311997581178, 1227.0165508946318, 1269.000838302202, 4348.208672323741, 17968.38416641815, 1165.460805879741, 1265.079897126097, 1254.1581459413098, 1264.808416453051, 1256.5597246494467, 1267.151356891588, 18113.185089973493, 1389.6273791880205, 20033.66795478181, 1265.3194868923083, 1268.859416369939, 9893.439373899593, 41564.4483919924, 2926.630945257478, 1153.7738116295975, 8507.23182386677, 1239.131641096771, 42658.855911280516, 1244.4043177439935, 17850.62548923048, 1185.5887133034612, 1207.0937428035631, 1269.675177445108, 40176.09707080468, 14483.536211456276, 14028.024030929468, 1267.8833052113478, 1258.853410160608, 13110.179687168626, 7828.366329396265, 53900.564929577165, 1259.047227212519, 1211.750146359108, 30244.612551564973, 3399.879828255055, 2442.1753767413666, 1268.0239707422318, 28157.070309901144, 1261.5245999590775, 31825.974711874613, 1247.3292733092906, 20620.87239637819, 12488.790835774465, 1260.5731024955273, 26676.613634106467, 1223.9147933364268, 1252.2579520070462, 1266.436124926229, 3525.4958549841017, 1529.8614703689893, 2363.1432382595617, 1266.1797978136326, 42045.92074108688, 1206.5818891411807, 33277.060568673834, 65393.995093731224, 18610.020769065006, 1231.5952476590305, 1267.5886112121075, 1263.4578167206903, 69446.28054523948, 8344.954970497516, 1191.5582454290077, 1254.8427200615643, 60734.019861378605, 4570.743598391847, 1566.065710326819, 1593.9280347980048, 7536.788654588481, 1140.0954958870573, 1155.2959189359285, 41628.23700410542, 84074.26106621468, 1214.9625870954967, 976.8059390009612, 1448.6603940008715, 9296.02695800641, 54803.73323339599, 10702.437137670307, 1198.225129001435, 4250.279805896284, 32908.67762440503, 21416.870617154385, 1244.7861652632482, 1255.9808671407682, 1152.8710632518425, 1445.247646565658, 6520.395363306092, 1856.6531866135454, 1233.994471102862, 1269.1839460893461, 2677.7330146442187, 1264.708018500792, 1268.0610980047725, 1262.1625866497936, 1260.6136168001415, 1221.9195756110978, 2179.5594993967457, 1257.3501872540721, 1162.4494715258725, 1265.1947696866173, 1268.4490340871096, 1218.5805570691248, 16553.439828340714, 1263.75097582876, 1984.8728640687862, 1269.2391852976593, 3810.3281721270346, 1267.8941815942721, 34421.508427559886, 1185.2149492765525, 13065.507633701633, 1485.6477919092217, 1262.1435044323664, 1249.0931182887896, 84446.67344236253, 23398.911544603754, 1317.4636686971112, 27951.650064196736, 2923.2243306772393, 5000.480792240546, 1265.162769531074, 1267.3055823234397, 90494.36637709802, 4196.93075117426, 1267.7577044005125, 1238.3359529067452, 4418.8646623267805, 55663.04540267886, 73404.32536265677, 1258.6201281729748, 1191.4335774848353, 19510.00857302874, 5375.010446023869, 2418.972663116347, 37323.22160177674, 1264.019049360674, 9278.823006697821, 1234.762270807496, 1268.9446862896245, 2526.4542331131197, 1248.8789902626625, 3616.072085172852, 1223.8007766954397, 20567.184112404982, 38840.754517313, 1269.1827772857125, 1253.6895615554517, 1264.1376415369386, 1269.360237965489, 54889.52955579395, 1269.453675445701, 1124.5529897503345, 10628.707407320795, 67217.15272654613, 3051.065982344282, 2612.014483112325, 1334.3063276172688, 1315.324870617696, 1195.5071695350919, 4542.631649762019, 1172.9883631995842, 4283.590365379611, 1267.5381378355064, 99805.59378432843, 1679.7746255751988, 3022.667840723248, 8507.541828007728, 1262.6755030153315, 2942.3445396541724, 2238.6562015915715, 1177.2275775240917, 2480.9109583104455, 26765.316385059887, 7118.76425115831, 11082.89044059392, 1477.9178778277665, 3063.1980865105206, 1232.9466407086315, 1268.9685267918542, 1265.9489827403547, 20186.89925913551, 2357.075288868842, 1266.9066185549138, 3067.6740006798955, 2104.979855015629, 1255.2487750291311, 15816.536117442813, 2657.8415756154445, 12549.108217605732, 35247.687458131564, 2151.076102595957, 2537.435721815412, 31818.335146214617, 24922.110313152934, 1268.7246274143497, 4254.61132869372, 1260.771847888969, 1268.6160941299886, 1268.7463706399606, 1269.5785671734743, 1468.9024949938812, 1253.072495307267, 3743.943498604131, 1843.5674444852793, 1240.1513132864704, 7771.665401617555, 1261.2221070741334, 2109.6297557880957, 1168.7266573987738, 1120.0346087927296, 44307.78730069385, 1268.9498847022412, 18599.574584066242, 27428.465396771673, 1147.7174341789014, 27501.30970477399, 50367.401250402516, 13752.559403465291, 2393.9886868489107, 15419.766643414358, 14811.404087040128, 101775.680630469, 1266.1977912203083, 1269.494561879782, 27081.09319254752, 1254.1502486514917, 9892.699262950691, 10165.866746312873, 1243.8249112515043, 109933.2672348532, 20277.185173794835, 27350.376365976903, 97446.01686505464, 3855.3879296500213, 1163.1207230974321, 6066.252806688392, 51225.50155223855, 1225.2627644675833, 1269.3674256187755, 18476.880995749507, 3935.262605703785, 2646.2076054879562, 1260.8017099873089, 12430.26867392387, 1260.186735563359, 1263.1997945941296, 8773.028869953801, 12872.381847153905, 2147.2921616698236, 1821.0351766590995, 1826.8864218665199, 3505.8542614003677, 1239.757469510251, 2031.1900891051675, 1268.521672106812, 2261.4565504838365, 5759.105554657169, 8021.050229352862, 13821.853435773553, 1267.8843406608942, 5706.9632047846735, 1235.4036332033045, 1945.765309988104, 25984.076286128882, 4564.203760598966, 1253.7486845629683, 1815.7058255902436, 1268.1825821305094, 1260.9655507759287, 1246.5532904417926, 1222.934135903919, 44741.74617428737, 3616.506464701491, 17468.136886776094, 1268.4227895419076, 1256.0842542710432, 2149.2124825875626, 17525.311185952738, 6304.2460604678445, 2169.1126332211866, 54153.295960861484, 60005.55079524519, 142065.14796669464, 1267.8248017263863, 1463.2657444308823, 1267.5648730605933, 3460.865719562908, 1121.8543825241652, 93745.10725451956, 1184.4440468684077, 77723.96097511303, 1249.0435679567959, 1194.0472817890682, 1265.3245737473521, 1840.2017457065617, 42167.80358374073, 1243.0819289253543, 3402.8697393045254, 1317.944945724023, 1269.681884874398, 1246.7357711412167, 3961.4421662427453, 17168.521001307432, 22042.705002691226, 1050.2647076752294, 1266.0847466737328, 36807.660850535816, 2288.3697711021473, 1269.6425769339924, 131863.63219419782, 3339.934995617252, 4033.4126763125787, 1268.8725946941552, 1211.0134027777904, 1269.6478527033091, 27608.374103091755, 1268.2360364807892, 1249.379367291763, 79783.188696265, 1248.2835037488524, 66968.9952750853, 1137.7271413231676, 1461.7762015381738, 1164.9064165108996, 3126.2227355230084, 16871.4445226288, 14840.401990331704, 1222.0832817806415, 12228.771410246734, 1531.8051394801698, 1640.8837723950876, 33290.02722732771, 1393.8474750854575, 1233.7113756214894, 1269.1402935399333, 23210.6841009511, 24099.41264479604, 1263.3860648108976, 6680.817364672469, 1269.1287273637417, 40864.07080179436, 14986.844388286887, 30656.583659363067, 1268.218195260995, 1252.6759670749802, 38922.37305973173, 1207.7421076379767, 1260.6112545215788, 1253.6603919209385, 1258.9462099185387, 1241.0476721671782, 1257.618663604471, 1264.162928034168, 45078.64819077148, 9162.207030617907, 4719.41590501946, 12883.763545159543, 20398.284317686343, 3026.8391430383763, 1666.6575262066942, 1269.6790080106682, 1235.0861707496022, 6148.270560073502, 1278.252196455101, 1799.2027774590624, 2490.751777466319, 1213.2408421971008, 1266.526427402167, 1254.1661706213345, 1250.9270017612723, 4377.914856743695, 1334.1152302975104, 4327.620289582951, 11292.989558166137, 36665.45676544351, 1268.4404738860567, 1269.5856240977225, 2197.399363441131, 1174.0920720593235, 1674.0782862935732, 1274.7769265404736, 1219.359047621943, 1193.5952312867264, 8737.508806573029, 6753.511811010247, 4004.8173426658777, 68478.93008786025, 1262.1067143708353, 126162.47426454395, 1268.193402609877, 68937.23800370866, 1254.9641813567746, 11323.44609013824, 14996.46613152148, 85526.90424813016, 14083.923429756132, 5329.0373728400855, 4684.300993124159, 17096.847787421742, 1265.4382376986855, 7393.685306316847, 6874.729845050914, 35220.85966374723, 1250.9665731125058, 56018.50967755524, 1284.654660677996, 5915.935787542046, 52252.900892125464, 1189.386102180954, 9254.6220293711, 1181.745015219126, 8889.687127525192, 1212.258380909508, 1266.3108014075265, 4790.106347754212, 1172.289788252743, 6232.703339008777, 91490.31009278684, 1112.035399138109, 1165.0676167488043, 1242.1443759762024, 9304.768003588464, 1268.9771074486355, 5298.176585841639, 6576.713839421479, 10356.969089514125, 35715.58561347466, 28648.821248970988, 1228.9970817586461, 1228.3458304331027, 35127.61555320448, 1269.296721755132, 1269.0164945044025, 1112.852101702728, 10040.889406378856, 2828.2275880490065, 1266.307707065735, 24443.628353639986, 1269.0027780344888, 2785.9817051953855, 1164.870737465858, 1269.5203247084764, 32500.73393483681, 24525.362871827805, 2004.3918872750585, 90602.41022247687, 1261.5672843880131, 1266.8834106895076, 1229.5635722809768, 2789.2804948020503, 3412.8196470038138, 1242.8251217053844, 4260.530302008684, 9363.177911296174, 1285.8264055837415, 1253.2169763616398, 26243.267555810275, 17081.830025908333, 1155.7104422578238, 1248.1935723741965, 1249.3806108308406, 4168.004972707661, 1639.9592125770769, 1269.6403174061472, 1269.4715718876826, 1727.0276370750146, 20189.083414298766, 1170.546417235046, 17262.12006846404, 17146.29482251046, 4310.255043982729, 1269.680701541743, 17672.886223250905, 18473.46985173994, 1244.005633968813, 1212.6652000671713, 1254.3744289262213, 4136.309371118905, 1185.9526924007446, 5973.638123785046, 9098.838920084127, 1209.44236007572, 1265.1813192746995, 1522.329930649155, 1247.526134828595, 2216.645456731731, 1260.0630800349268, 10775.330474688926, 1246.5763657339892, 1933.4699807588431, 1116.2718594721916, 1117.7815048071031, 18743.29275000265, 13836.688466204858, 1349.5897519464643, 1545.3601762779676, 6927.307971963076, 1222.523273895225, 1160.5143651543046, 4089.389808681426, 1268.0316207246767, 7157.5530909940635, 1268.7843319792457, 52174.949371664625, 7730.96784629035, 5671.727221603234, 10623.456070073207, 36579.21063622156, 1236.2155079754757, 6817.360137288202, 10463.686375807858, 57594.024783256325, 1256.4483528087371, 1240.0832198294, 1242.0774666555874, 33083.142860597334, 61656.78392928508, 1267.6020295531503, 6941.159716347738, 1213.199455609806, 6809.318812779534, 26347.781943035105, 32242.520061339146, 7823.067250704037, 5678.855026448888, 20923.312533392465, 2697.6890891299795, 1193.7456560241164, 13278.84393535628, 16582.462842720648, 15460.645060036497, 1205.6177142277586, 5024.188183688343, 32031.880664507455, 1269.6716043601034, 12519.2202676745, 9127.076618842008, 2329.6765927964634, 5396.504784051984, 1252.833939287363, 2515.0163048704962, 1125.8604006249168, 43238.66400279511, 1246.1277010162464, 73750.04617036477, 74322.4907185413, 1264.9380792933212, 15268.389931528525, 1623.1023434868914, 66648.55334758153, 1257.4555974801394, 1267.10114541915, 10895.429035948831, 1181.8894673681018, 9389.34499484635, 1269.0143011024672, 1262.30362464038, 1269.5619600385808, 12242.880523215754, 1267.0314170080676, 17674.002378683494, 35678.376270738, 32023.71912286284, 1117.117460171587, 1219.6092471402765, 1266.950319179278, 1263.8182062480369, 144391.4231934505, 31254.655076032195, 91790.11895876641, 1267.8550598877578, 1223.2866888392705, 4221.660286316818, 4268.30541994787, 19001.996811645622, 62025.57549648721, 1248.7472675473282, 19814.099130641087, 1171.3362658271856, 1225.932241744134, 1264.793562352989, 1718.5994046486646, 1268.6319572614182, 1269.6777621351962, 72149.7502860601, 1262.5488549733218, 1269.6800397072964, 1269.4126487721876, 1269.6793041537069, 1267.9244849739016, 94807.18068321072, 9783.40262862754, 1233.9369062035685, 6563.343066859745, 1248.2135031178475, 158581.25498210156, 1260.0506996951146, 1266.6558467584825, 1260.2578963764438, 5887.928140540131, 1265.6970230002673, 1823.624297983332, 23380.521781269483, 1262.361378672252, 1162.3335466796348, 36454.66472985555, 45145.93140483944, 7913.496582388266, 1636.3937261997485, 1260.958617605956, 2805.3837020741344, 1261.9126810153953, 1253.1689390602742, 1437.38950652607, 3004.9511800622026, 1567.631841680026, 47154.61343276737, 3832.075421480199, 1268.5056104105327, 11641.667764182024, 1256.4068360590416, 39502.17662751816, 3363.574183337538, 2925.2580951484583, 6201.922544082384, 32589.44404387811, 1188.1397157237955, 70644.97676665851, 1268.3786100808957, 1261.7255001343638, 1265.427552373076, 11105.94496662309, 10621.455793171146, 67173.20748436672, 1939.9856760966493, 22391.933942582255, 1232.4746101382977, 5425.14108279322, 22867.294380703035, 2375.197915239217, 13020.044436746888, 1243.3666636457297, 30491.195888901315, 13020.770184670351, 1241.1491089856981, 7724.425009644075, 7435.343845901842, 68178.13294315846, 2689.3624601696283, 1142.9207359947873, 1261.4804737739614, 1261.5328730319816, 24611.501430514614, 1263.2889765080572, 1396.7394451771802, 25290.976788159045, 3055.936986288351, 59654.37318003035, 2500.5513554392537, 2319.490785773618, 1207.1289759858696, 1247.4009567026774, 1258.3406221434086, 17019.735796310553, 2312.0458986668946, 1200.7042629607893, 41407.3260869373, 1232.6658473689233, 1257.4947982715792, 1264.152905343061, 43463.520342641816, 888.3511823844524, 1268.6649583160595, 4233.654887190109, 1267.3890261790962, 1721.702040973893, 1238.204145808548, 1268.1037404801023, 17119.85201756306, 41243.7867439156, 1261.0347370435934, 1564.2758735436812, 44915.78334046731, 1267.8897819823328, 6649.1372951729745, 1198.7082399736673, 5042.453427458544, 1258.7196550301203, 1262.9899247010621, 1310.7493514734765, 3647.1870173333964, 1157.2164311284316, 1243.0894808465825, 14492.479660303605, 12847.894946430333, 24761.939074137015, 3325.0720245983143, 29817.90188733525, 17607.560066462396, 3774.1353700205286, 1159.4178972669633, 1260.2285269666106, 1252.3853572431808, 2396.3656401197536, 1259.7296025698845, 1266.1307022776095, 2917.7994897725257, 65399.83489800637, 14575.016008991197, 20900.826885111226, 69194.76698242633, 1262.6492807267696, 1241.6993276241355, 8017.353152207884, 1115.9888750683383, 1212.6467110508306, 56807.949245960015, 4217.51332421723, 1321.3933621709443, 19232.195579065537, 15218.92986864145, 59398.923351514, 1210.0490319420276, 17859.035796200016, 8271.576602639807, 13681.448356917484, 1263.4631270427594, 1255.4497677348086, 1253.888820435351, 1229.3823270437856, 1169.018057068204, 1252.188435715846, 1388.9759373416855, 1884.2918435818633, 28242.30459150732, 8718.33434191015, 7040.814698478583, 1269.5828749766672, 4001.534485643602, 28558.53999215848, 2391.264525218738, 1258.1116007859098, 1936.6320459648944, 44693.002132990856, 24828.23178171097, 5319.049019890483, 1209.6268397729893, 1263.871922867186, 6402.7660130482745, 1254.7014717038485, 121292.69556334407, 5493.64043700065, 1268.7260581320268, 1251.8843647067197, 1262.7731821497516, 1260.7946806199548, 1269.0182173630878, 10415.715222063884, 1252.1145858913446, 2066.247115100417, 1269.657015920074, 2275.5516480219662, 1257.6898889109882, 1267.7442273599306, 6362.539065113588, 1265.8680941712316, 16037.220178708376, 38090.13522000507, 8710.850811366285, 1267.2055279254478, 1245.8783246770201, 24806.08787426945, 72977.36079711183, 1268.4175336523647, 15466.882349562065, 28962.11252520232, 26709.31578516885, 14426.002109657864, 1179.348194788903, 1222.6619283976547, 5961.148418575467, 1238.5569156818144, 60652.56749312644, 1260.5519894024485, 1268.6719880086132, 7751.079612487114, 7408.29279850322, 1196.665404580153, 2805.2825806606634, 2726.317570033195, 37507.3365907409, 20052.980951836285, 1220.2759261999038, 50393.56198684451, 3298.3250420852605, 31834.676347460663, 3655.9384433068526, 1266.0855332138146, 1473.2668424582557, 2269.091527038338, 1192.6228902328487, 1265.347171128513, 1242.7856580454975, 2231.025045990779, 1268.9831640675882, 221807.91626039954, 1130.7972622520133, 1266.202729289836, 11784.8513829708, 3333.1995539355157, 1269.6813222694125, 6301.615504752273, 1267.7981109294228, 1248.5825501839022, 1238.6330852348297, 11200.29937977671, 1256.9694775579767, 1223.9724994096784, 1261.1011147251481, 1256.8926920203153, 28880.11505816246, 19610.11232572602, 1263.9187989214108, 1264.1460260506576, 1268.8927312609633]  # Truncate for embedding
baseline = 11914.175356950002
mean = 12897.207801569215
std = 24434.295996445107
p5 = 1171.3737302310353
p50 = 1991.405838895611
p95 = 61355.13751128711
display_name = "Expected Treaty ROI (Risk-Adjusted)"
units = ""

# Create figure with two subplots
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
# Handle edge case where all samples are identical (zero variance)
if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)
ax1.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key statistics with formatted values in legend (use format_parameter_value for full units)
ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {format_parameter_value(p50, units)}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {format_parameter_value(p5, units)}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {format_parameter_value(p95, units)}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {format_parameter_value(baseline, units)}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---
sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)
ax2.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key percentiles
ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"
exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title
fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark
add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from
output_path = get_figure_output_path('mc-distribution-dfda_expected_roi.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 1.191e+04 |
| Mean (expected value) | 1.29e+04 |
| Median (50th percentile) | 1,991 |
| Standard Deviation | 2.443e+04 |
| 90% Confidence Interval | [1,171, 6.136e+04] |

*The histogram shows the distribution of Expected Treaty ROI (Risk-Adjusted) across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
