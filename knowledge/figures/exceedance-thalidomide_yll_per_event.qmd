```{python}
#| echo: false
#| fig-cap: "Probability of Exceeding Threshold: Thalidomide YLL Per Event"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Monte Carlo samples
samples = [30720.0, 21200.0, 34720.0, 36640.0, 16480.0, 19760.0, 29280.0, 25920.0, 28160.0, 22320.0, 36000.0, 34960.0, 28720.0, 38560.0, 32160.0, 22320.0, 31280.0, 21680.0, 36000.0, 27840.0, 26880.0, 23440.0, 39520.0, 27040.0, 25120.0, 25600.0, 32720.0, 31280.0, 31680.0, 31760.0, 46800.0, 25280.0, 24560.0, 22560.0, 33440.0, 38560.0, 27360.0, 22400.0, 22480.0, 33840.0, 34720.0, 32800.0, 23520.0, 30160.0, 29200.0, 30000.0, 35920.0, 30080.0, 34080.0, 28800.0, 30640.0, 33600.0, 18880.0, 25840.0, 24800.0, 23680.0, 26160.0, 42640.0, 22240.0, 36880.0, 17760.0, 25760.0, 29520.0, 33200.0, 34400.0, 35200.0, 25680.0, 24880.0, 35760.0, 26800.0, 19840.0, 20640.0, 21920.0, 32400.0, 29360.0, 34160.0, 25120.0, 29520.0, 33520.0, 25920.0, 32080.0, 23520.0, 25520.0, 25440.0, 20320.0, 32320.0, 24800.0, 28320.0, 32240.0, 32000.0, 33920.0, 27520.0, 25120.0, 27600.0, 17760.0, 18960.0, 19600.0, 21440.0, 31520.0, 22000.0, 25440.0, 40400.0, 25600.0, 34640.0, 21840.0, 26720.0, 21760.0, 25760.0, 35600.0, 17520.0, 31840.0, 30160.0, 24000.0, 18960.0, 28800.0, 24400.0, 30160.0, 28400.0, 43920.0, 26480.0, 21360.0, 29680.0, 30000.0, 41120.0, 35600.0, 31120.0, 42240.0, 20320.0, 23680.0, 21840.0, 25360.0, 19360.0, 33680.0, 26560.0, 18800.0, 21360.0, 30800.0, 35600.0, 46800.0, 46800.0, 31680.0, 21520.0, 15840.0, 30400.0, 22560.0, 25200.0, 23840.0, 27200.0, 37920.0, 29520.0, 27040.0, 21280.0, 17840.0, 24720.0, 27840.0, 46000.0, 29280.0, 37040.0, 24640.0, 20400.0, 21680.0, 23120.0, 46800.0, 22560.0, 35600.0, 22000.0, 36560.0, 31440.0, 27040.0, 27920.0, 23600.0, 32000.0, 24960.0, 20160.0, 19840.0, 29600.0, 43680.0, 29520.0, 27360.0, 30560.0, 40480.0, 30000.0, 25200.0, 38320.0, 31760.0, 43120.0, 29680.0, 20160.0, 19360.0, 44480.0, 45440.0, 26880.0, 25440.0, 42240.0, 20800.0, 22080.0, 33760.0, 25360.0, 28240.0, 27040.0, 31040.0, 41600.0, 28960.0, 33760.0, 16080.0, 27920.0, 22400.0, 20240.0, 22160.0, 25760.0, 36320.0, 19600.0, 28480.0, 24720.0, 25840.0, 37200.0, 32800.0, 40880.0, 27040.0, 23360.0, 26560.0, 30240.0, 29680.0, 20960.0, 28960.0, 30080.0, 46800.0, 46640.0, 22320.0, 26080.0, 18880.0, 24000.0, 30800.0, 39360.0, 23120.0, 23600.0, 15760.0, 27040.0, 21120.0, 24400.0, 22160.0, 27520.0, 17440.0, 18880.0, 46800.0, 19840.0, 20880.0, 46480.0, 46800.0, 20480.0, 25520.0, 31040.0, 45520.0, 21520.0, 26400.0, 34960.0, 31840.0, 25440.0, 27200.0, 19360.0, 26480.0, 26240.0, 30160.0, 24240.0, 32160.0, 37360.0, 29520.0, 31120.0, 28640.0, 28240.0, 23200.0, 30800.0, 27520.0, 46800.0, 43600.0, 31440.0, 22880.0, 20800.0, 39200.0, 30400.0, 32240.0, 17440.0, 36480.0, 32000.0, 20800.0, 24800.0, 30400.0, 28640.0, 26080.0, 27440.0, 26320.0, 29440.0, 42400.0, 15360.0, 26480.0, 29680.0, 30640.0, 25520.0, 17440.0, 30960.0, 45520.0, 18560.0, 35840.0, 25760.0, 27760.0, 21120.0, 25760.0, 40400.0, 33200.0, 45520.0, 39040.0, 31920.0, 45680.0, 31920.0, 35440.0, 26000.0, 28800.0, 23280.0, 37120.0, 20400.0, 35040.0, 26800.0, 39040.0, 34720.0, 46400.0, 34560.0, 18320.0, 27760.0, 20400.0, 24480.0, 42880.0, 33680.0, 23280.0, 21360.0, 28480.0, 20240.0, 23520.0, 30800.0, 38800.0, 33440.0, 15440.0, 30720.0, 28800.0, 31680.0, 44080.0, 16000.0, 24000.0, 33280.0, 18240.0, 42400.0, 31280.0, 35680.0, 24160.0, 35360.0, 37920.0, 30160.0, 30160.0, 30400.0, 22240.0, 27120.0, 27120.0, 31440.0, 37200.0, 21120.0, 27280.0, 42480.0, 23040.0, 22560.0, 29920.0, 35680.0, 28320.0, 40720.0, 35760.0, 35680.0, 32880.0, 46800.0, 26720.0, 16240.0, 44000.0, 24880.0, 29120.0, 40560.0, 18160.0, 20000.0, 18160.0, 22720.0, 31920.0, 32640.0, 30480.0, 19120.0, 15360.0, 28640.0, 24800.0, 32080.0, 34320.0, 29360.0, 34800.0, 30080.0, 32720.0, 23280.0, 26880.0, 29840.0, 35440.0, 25360.0, 32640.0, 26240.0, 27360.0, 35520.0, 16320.0, 19760.0, 18800.0, 15360.0, 23440.0, 34720.0, 26080.0, 29840.0, 38160.0, 40720.0, 27680.0, 41040.0, 28960.0, 22400.0, 24000.0, 18800.0, 22080.0, 25600.0, 35280.0, 45360.0, 19280.0, 31520.0, 21200.0, 32240.0, 27280.0, 17040.0, 36480.0, 23920.0, 24400.0, 21040.0, 23600.0, 31760.0, 26800.0, 30960.0, 31200.0, 40640.0, 25680.0, 18800.0, 37920.0, 25760.0, 38400.0, 31440.0, 27280.0, 31120.0, 46800.0, 46800.0, 28800.0, 29520.0, 38000.0, 22400.0, 30960.0, 28080.0, 30800.0, 22480.0, 18240.0, 16000.0, 20720.0, 24880.0, 26080.0, 46800.0, 38320.0, 21680.0, 31120.0, 25280.0, 26080.0, 29760.0, 33520.0, 25760.0, 37840.0, 20640.0, 28320.0, 46800.0, 30080.0, 41920.0, 28960.0, 33200.0, 27840.0, 26960.0, 22800.0, 31760.0, 22320.0, 33920.0, 38080.0, 31280.0, 26080.0, 32000.0, 25920.0, 36560.0, 17040.0, 25760.0, 16320.0, 18720.0, 41120.0, 36160.0, 23200.0, 18640.0, 15360.0, 24320.0, 46800.0, 31840.0, 24240.0, 32160.0, 18400.0, 26000.0, 29040.0, 27600.0, 35120.0, 31040.0, 33920.0, 23360.0, 36160.0, 44240.0, 21600.0, 22080.0, 40800.0, 26800.0, 41600.0, 25040.0, 42160.0, 29280.0, 30320.0, 43440.0, 25600.0, 21760.0, 24960.0, 32000.0, 18320.0, 33680.0, 24400.0, 38720.0, 15360.0, 22720.0, 17760.0, 22480.0, 30240.0, 26880.0, 26320.0, 27040.0, 29920.0, 21440.0, 34320.0, 33920.0, 31440.0, 32960.0, 30640.0, 46800.0, 27600.0, 25920.0, 22960.0, 21280.0, 20080.0, 22080.0, 27680.0, 30960.0, 28640.0, 22880.0, 36240.0, 34640.0, 27040.0, 23600.0, 32880.0, 29760.0, 18960.0, 27680.0, 30320.0, 22000.0, 29760.0, 18880.0, 40800.0, 39840.0, 26320.0, 31200.0, 15360.0, 20560.0, 26080.0, 21040.0, 34400.0, 46800.0, 20400.0, 22400.0, 30160.0, 44080.0, 20160.0, 30240.0, 46400.0, 17920.0, 19840.0, 25120.0, 24480.0, 35360.0, 30160.0, 17360.0, 32560.0, 24080.0, 40160.0, 23760.0, 23680.0, 32800.0, 34880.0, 32000.0, 17760.0, 32800.0, 21280.0, 30160.0, 19120.0, 32000.0, 22640.0, 19840.0, 34400.0, 30160.0, 23840.0, 42160.0, 25040.0, 28480.0, 30400.0, 23840.0, 32160.0, 24400.0, 25200.0, 41120.0, 21200.0, 15360.0, 44080.0, 46800.0, 25280.0, 16560.0, 25920.0, 26080.0, 26800.0, 20800.0, 33120.0, 32640.0, 18720.0, 34240.0, 46800.0, 29600.0, 25760.0, 27200.0, 33440.0, 17520.0, 29520.0, 25360.0, 46480.0, 26960.0, 44720.0, 20880.0, 33200.0, 30880.0, 22240.0, 29680.0, 39440.0, 25840.0, 17680.0, 28160.0, 22000.0, 25680.0, 27600.0, 17680.0, 18080.0, 32240.0, 24480.0, 15360.0, 35040.0, 30400.0, 23200.0, 19680.0, 35600.0, 31120.0, 46800.0, 31680.0, 31440.0, 26960.0, 35360.0, 33520.0, 39840.0, 24480.0, 25040.0, 24800.0, 35120.0, 42720.0, 24880.0, 25120.0, 30800.0, 26400.0, 36720.0, 15520.0, 22480.0, 22800.0, 15360.0, 21680.0, 21920.0, 26720.0, 38400.0, 26400.0, 21280.0, 27840.0, 37760.0, 21600.0, 22000.0, 32960.0, 26560.0, 33760.0, 28160.0, 34320.0, 21280.0, 28160.0, 26640.0, 20240.0, 18400.0, 34160.0, 25680.0, 21360.0, 27520.0, 38560.0, 15440.0, 18720.0, 21920.0, 42240.0, 30560.0, 34880.0, 20640.0, 20720.0, 32000.0, 28720.0, 32880.0, 26800.0, 30480.0, 29520.0, 34960.0, 35280.0, 18080.0, 15520.0, 37200.0, 39200.0, 21360.0, 16960.0, 29040.0, 36560.0, 46320.0, 32560.0, 25520.0, 22080.0, 28320.0, 26000.0, 21360.0, 46800.0, 46160.0, 38640.0, 21920.0, 35760.0, 33680.0, 31920.0, 39840.0, 33680.0, 34640.0, 33680.0, 31040.0, 17280.0, 28880.0, 24240.0, 19840.0, 44880.0, 45520.0, 41120.0, 30320.0, 40960.0, 28320.0, 29920.0, 20880.0, 31520.0, 28720.0, 19760.0, 27840.0, 27600.0, 46320.0, 36160.0, 28320.0, 30240.0, 28560.0, 26720.0, 20960.0, 27120.0, 23040.0, 20000.0, 32560.0, 31440.0, 17280.0, 27280.0, 37200.0, 37840.0, 37520.0, 28560.0, 22400.0, 20960.0, 31040.0, 31360.0, 40240.0, 38240.0, 27280.0, 20080.0, 25840.0, 30000.0, 26720.0, 24080.0, 30320.0, 24560.0, 23760.0, 30800.0, 25280.0, 30240.0, 30480.0, 20640.0, 24720.0, 42000.0, 20480.0, 15840.0, 16960.0, 28480.0, 28480.0, 27360.0, 39440.0, 15360.0, 31520.0, 43440.0, 20720.0, 25440.0, 22960.0, 22080.0, 25840.0, 41840.0, 46480.0, 25760.0, 46800.0, 28560.0, 45840.0, 27520.0, 29280.0, 31280.0, 46800.0, 35760.0, 23280.0, 36880.0, 25600.0, 24720.0, 36320.0, 28480.0, 30480.0, 28400.0, 30960.0, 31760.0, 16560.0, 33920.0, 21520.0, 18960.0, 27760.0, 28960.0, 23360.0, 35520.0, 19520.0, 25280.0, 24080.0, 27920.0, 30480.0, 21440.0, 34480.0, 28720.0, 16800.0, 16480.0, 28160.0, 26560.0, 27440.0, 28080.0, 30080.0, 36720.0, 20800.0, 20400.0, 20880.0, 30640.0, 39840.0, 25120.0, 15360.0, 17680.0, 22480.0, 24240.0, 25280.0, 28560.0, 25920.0, 37760.0, 23440.0, 22240.0, 32240.0, 18480.0, 31440.0, 29040.0, 27120.0, 43760.0, 23840.0, 46800.0, 26560.0, 19840.0, 28800.0, 21040.0, 22960.0, 31520.0, 32880.0, 23840.0, 37120.0, 38880.0, 41920.0, 32720.0, 41120.0, 16800.0, 25840.0, 22240.0, 29200.0, 24160.0, 26960.0, 46720.0, 26960.0, 31680.0, 26480.0, 28880.0, 28320.0, 32000.0, 38960.0, 44480.0, 30800.0, 33280.0, 20560.0, 27600.0, 36640.0, 35840.0, 30000.0, 36080.0, 32320.0, 39360.0, 30640.0, 25600.0, 30960.0, 15360.0, 31440.0, 15360.0, 17520.0, 32000.0, 32240.0, 20480.0, 23200.0, 41200.0, 24720.0, 46800.0, 28240.0, 31600.0, 44080.0, 29280.0, 21440.0, 27440.0, 28000.0, 19360.0, 26320.0, 23040.0, 36480.0, 28480.0, 26160.0, 27440.0, 30080.0, 33440.0, 21440.0, 21200.0, 38320.0, 25200.0, 19120.0, 31920.0, 32080.0, 18560.0, 30080.0, 34560.0, 31360.0, 33600.0, 19200.0, 30960.0, 26000.0, 24720.0, 35920.0, 42480.0, 46240.0, 40560.0, 27440.0, 31120.0, 34880.0, 29200.0, 29280.0, 35440.0, 27760.0, 23120.0, 25200.0, 33680.0, 28320.0, 31040.0, 34000.0, 25440.0, 34800.0, 31360.0, 20080.0, 42080.0, 24640.0, 17920.0, 21200.0, 21360.0, 28640.0, 26160.0, 25760.0, 33520.0, 31040.0, 30800.0, 31600.0, 33440.0, 15920.0, 25520.0, 15680.0, 28560.0, 28240.0, 37680.0, 39200.0, 29920.0, 24640.0, 32320.0, 24400.0, 28240.0, 37040.0, 24240.0, 35280.0, 34000.0, 21680.0, 36960.0, 34240.0, 29040.0, 22880.0, 22320.0, 24400.0, 32800.0, 21680.0, 31840.0, 20080.0, 26720.0, 29120.0, 46800.0, 19360.0, 42400.0, 29440.0, 31600.0, 29200.0, 31920.0, 27120.0, 42160.0, 24880.0, 38640.0, 23680.0, 27760.0, 21040.0, 32000.0, 42080.0, 27680.0, 26800.0, 20800.0, 26560.0, 18240.0, 21920.0, 30080.0, 40640.0, 46800.0, 24080.0, 41920.0, 30240.0, 27120.0, 31840.0, 28720.0, 29120.0, 25280.0, 19200.0, 18480.0, 33840.0, 26160.0, 24000.0, 28320.0, 35200.0, 29680.0, 23600.0, 39600.0, 43680.0, 32400.0, 36960.0, 39760.0, 38560.0, 33440.0, 33280.0, 32640.0, 20880.0, 34240.0, 19440.0, 22720.0, 40480.0, 35600.0, 42560.0, 26160.0, 20560.0, 26480.0, 29040.0, 28880.0, 38640.0, 25600.0, 31120.0, 21520.0, 32000.0, 28320.0, 22960.0, 26480.0, 26880.0, 26240.0, 46000.0, 27520.0, 26400.0, 15920.0, 22080.0, 26240.0, 23360.0, 41360.0, 27040.0, 40240.0, 28720.0, 28560.0, 27520.0, 28320.0, 45360.0, 15360.0, 16240.0, 24320.0, 28400.0, 34160.0, 32160.0, 25440.0, 37440.0, 37520.0, 29680.0, 36800.0, 30480.0, 24240.0, 34240.0, 29120.0, 28240.0, 42400.0, 15360.0, 19120.0, 20400.0, 25520.0, 26320.0, 18640.0, 21520.0, 22240.0, 46800.0, 46320.0, 25200.0, 25520.0, 20560.0, 16720.0, 27360.0, 21440.0, 27600.0, 18160.0, 22880.0, 29440.0, 31280.0, 31680.0, 19600.0, 35760.0, 22640.0, 33680.0, 28160.0, 19360.0, 25920.0, 31280.0, 33440.0, 27200.0, 43120.0, 37280.0, 26320.0, 34720.0, 46800.0, 46800.0, 20160.0, 21840.0, 42560.0, 21120.0, 19600.0, 24720.0, 31680.0, 27440.0, 23600.0, 23440.0, 23200.0, 22160.0, 46800.0, 30640.0, 36080.0, 24720.0, 26880.0, 23200.0, 15360.0, 19360.0, 17120.0, 15520.0, 20320.0, 40720.0, 27920.0, 40320.0, 31600.0, 35040.0, 22000.0, 32640.0, 34560.0, 24080.0, 32960.0, 33040.0, 24320.0, 20720.0, 20400.0, 28960.0, 30880.0, 22720.0, 28480.0, 33040.0, 33520.0, 43360.0, 40160.0, 21440.0, 44960.0, 24400.0, 37680.0, 28800.0, 25200.0, 17120.0, 26960.0, 18400.0, 36880.0, 42880.0, 22720.0, 30720.0, 23120.0, 23760.0, 34960.0, 28000.0, 45600.0, 24720.0, 37200.0, 29040.0, 35200.0, 24960.0, 27840.0, 27360.0, 22400.0, 33920.0, 33840.0, 33280.0, 43120.0, 42160.0, 25440.0, 31360.0, 23760.0, 28400.0, 23920.0, 44160.0, 31200.0, 26640.0, 39280.0, 15760.0, 16240.0, 35200.0, 28720.0, 30240.0, 19600.0, 28080.0, 46800.0, 35440.0, 29600.0, 25040.0, 25360.0, 15840.0, 30320.0, 35680.0, 18320.0, 23520.0, 20560.0, 21680.0, 28640.0, 16000.0, 33440.0, 34800.0, 26320.0, 15360.0, 21440.0, 39680.0, 15360.0, 25680.0, 20400.0, 35280.0, 23440.0, 31600.0, 33040.0, 46480.0, 26720.0, 31360.0, 18720.0, 39200.0, 22880.0, 24240.0, 28080.0, 18400.0, 30080.0, 36880.0, 30640.0, 18240.0, 27280.0, 34640.0, 16880.0, 21040.0, 35920.0, 30400.0, 31680.0, 46560.0, 32160.0, 33840.0, 46800.0, 26640.0, 22640.0, 31760.0, 31920.0, 24480.0, 21280.0, 46800.0, 30880.0, 23120.0, 36320.0, 27440.0, 26320.0, 32960.0, 19760.0, 31120.0, 46800.0, 32160.0, 25440.0, 24560.0, 25200.0, 26320.0, 25440.0, 36320.0, 17520.0, 35840.0, 25440.0, 31360.0, 20720.0, 40720.0, 39840.0, 36800.0, 18640.0, 35520.0, 31600.0, 18160.0, 28080.0, 31280.0, 32960.0, 29680.0, 30640.0, 42400.0, 39600.0, 15360.0, 25840.0, 27040.0, 17440.0, 29040.0, 39840.0, 20960.0, 30960.0, 21920.0, 23520.0, 42480.0, 24320.0, 32080.0, 16880.0, 46560.0, 33360.0, 26880.0, 33120.0, 19200.0, 39120.0, 25840.0, 26720.0, 24640.0, 24080.0, 34240.0, 30320.0, 33840.0, 28160.0, 32560.0, 25200.0, 46800.0, 18320.0, 40000.0, 41200.0, 22320.0, 46800.0, 37200.0, 36960.0, 28480.0, 26640.0, 26720.0, 31440.0, 41520.0, 29680.0, 22000.0, 35440.0, 36400.0, 33840.0, 34720.0, 26240.0, 21840.0, 22240.0, 18000.0, 30160.0, 27600.0, 25040.0, 15360.0, 20080.0, 38480.0, 23520.0, 31200.0, 19280.0, 42000.0, 27120.0, 30640.0, 46800.0, 42880.0, 25920.0, 24000.0, 25840.0, 32560.0, 27440.0, 25360.0, 42320.0, 27360.0, 46800.0, 28960.0, 46160.0, 31200.0, 36800.0, 23120.0, 22320.0, 32080.0, 37120.0, 28560.0, 19840.0, 19440.0, 19040.0, 17360.0, 29120.0, 38560.0, 28160.0, 15520.0, 26800.0, 27040.0, 46800.0, 18880.0, 25360.0, 45200.0, 32000.0, 32960.0, 29200.0, 30960.0, 34960.0, 22640.0, 36000.0, 19360.0, 30960.0, 29680.0, 23840.0, 28080.0, 23840.0, 21040.0, 25600.0, 20800.0, 30880.0, 20560.0, 34400.0, 20400.0, 24160.0, 23760.0, 40720.0, 30960.0, 26640.0, 32400.0, 15920.0, 27920.0, 46800.0, 29280.0, 28800.0, 32880.0, 36160.0, 16320.0, 17760.0, 29920.0, 23200.0, 40560.0, 25920.0, 16560.0, 19920.0, 15360.0, 26480.0, 26800.0, 25120.0, 38000.0, 39360.0, 26960.0, 15840.0, 33440.0, 32880.0, 30800.0, 37040.0, 20480.0, 46800.0, 21680.0, 34720.0, 17760.0, 21840.0, 42880.0, 26320.0, 35600.0, 30160.0, 27440.0, 41120.0, 26480.0, 17280.0, 22640.0, 32880.0, 31520.0, 18320.0, 23120.0, 24080.0, 25520.0, 19360.0, 23760.0, 23120.0, 34960.0, 35280.0, 27120.0, 25360.0, 29360.0, 22560.0, 20560.0, 21760.0, 23760.0, 20480.0, 29520.0, 34560.0, 18240.0, 28480.0, 26640.0, 31040.0, 28160.0, 18880.0, 19920.0, 28480.0, 37520.0, 15600.0, 31040.0, 39200.0, 27120.0, 32880.0, 23280.0, 27360.0, 18080.0, 15360.0, 36640.0, 21520.0, 24960.0, 19280.0, 19200.0, 26960.0, 23120.0, 31360.0, 32000.0, 30880.0, 30160.0, 43680.0, 21040.0, 27840.0, 38640.0, 40080.0, 19120.0, 25920.0, 41120.0, 32480.0, 29840.0, 26640.0, 25440.0, 30640.0, 26320.0, 27920.0, 28880.0, 23440.0, 32720.0, 46800.0, 17280.0, 30880.0, 22880.0, 33120.0, 28640.0, 34880.0, 39040.0, 29760.0, 38640.0, 15360.0, 43760.0, 31360.0, 38000.0, 20160.0, 22480.0, 29440.0, 28160.0, 30560.0, 38080.0, 17360.0, 36960.0, 28320.0, 26720.0, 18800.0, 32480.0, 15360.0, 33760.0, 18720.0, 28640.0, 27360.0, 39040.0, 26880.0, 23360.0, 24560.0, 40160.0, 32720.0, 25440.0, 26480.0, 18320.0, 31440.0, 17440.0, 34800.0, 29280.0, 46800.0, 20880.0, 27440.0, 46320.0, 39200.0, 23360.0, 30080.0, 28240.0, 30560.0, 23280.0, 27520.0, 18160.0, 29360.0, 32000.0, 26560.0, 18080.0, 37120.0, 31200.0, 23120.0, 26160.0, 18720.0, 21280.0, 24400.0, 39680.0, 23680.0, 33680.0, 24400.0, 30240.0, 27200.0, 35920.0, 24400.0, 18320.0, 19280.0, 24400.0, 20000.0, 31600.0, 24880.0, 46800.0, 17520.0, 29920.0, 20720.0, 24640.0, 29360.0, 15360.0, 30160.0, 46720.0, 24960.0, 30320.0, 37440.0, 27040.0, 24080.0, 15440.0, 33760.0, 27360.0, 21360.0, 29280.0, 24080.0, 24400.0, 33360.0, 19520.0, 37680.0, 19200.0, 23520.0, 46800.0, 38560.0, 29040.0, 21760.0, 24400.0, 28800.0, 28560.0, 27520.0, 28000.0, 26640.0, 18960.0, 24480.0, 36320.0, 19360.0, 26800.0, 22560.0, 29120.0, 25360.0, 42480.0, 32480.0, 19680.0, 34000.0, 22800.0, 24080.0, 30800.0, 24640.0, 36160.0, 22800.0, 23840.0, 23600.0, 24160.0, 38240.0, 33600.0, 45280.0, 46800.0, 21280.0, 28800.0, 20400.0, 22800.0, 23760.0, 21120.0, 21120.0, 27120.0, 20240.0, 35680.0, 21920.0, 46800.0, 24960.0, 28800.0, 19760.0, 45200.0, 38480.0, 30640.0, 19440.0, 29920.0, 20720.0, 42240.0, 35280.0, 29040.0, 15360.0, 21520.0, 34160.0, 39440.0, 38320.0, 18240.0, 30720.0, 37360.0, 17920.0, 28160.0, 30480.0, 26000.0, 16960.0, 25840.0, 25840.0, 27120.0, 24160.0, 25040.0, 28000.0, 31920.0, 26000.0, 25200.0, 28960.0, 16640.0, 32240.0, 28240.0, 28560.0, 36800.0, 16480.0, 16400.0, 30480.0, 28240.0, 29600.0, 24880.0, 33920.0, 36560.0, 32240.0, 26320.0, 15920.0, 34880.0, 39520.0, 33760.0, 22160.0, 34000.0, 35840.0, 43440.0, 22160.0, 26560.0, 34720.0, 28720.0, 20800.0, 31680.0, 33120.0, 28960.0, 30000.0, 26320.0, 42480.0, 22000.0, 24000.0, 28320.0, 36000.0, 18720.0, 19680.0, 16080.0, 28480.0, 20720.0, 25440.0, 33920.0, 23680.0, 30080.0, 26000.0, 34000.0, 32240.0, 23360.0, 26960.0, 37680.0, 31520.0, 19200.0, 33840.0, 20960.0, 41680.0, 37440.0, 30640.0, 29520.0, 26720.0, 34080.0, 25520.0, 30160.0, 35920.0, 24240.0, 23840.0, 20320.0, 21040.0, 17040.0, 34560.0, 46320.0, 41840.0, 18080.0, 34480.0, 41840.0, 24880.0, 29040.0, 16240.0, 30400.0, 21120.0, 29840.0, 18400.0, 32800.0, 37440.0, 22800.0, 20640.0, 15760.0, 26240.0, 24080.0, 18400.0, 32000.0, 24960.0, 21040.0, 24240.0, 37920.0, 33360.0, 27280.0, 33520.0, 20480.0, 28480.0, 29440.0, 24800.0, 31840.0, 22800.0, 32560.0, 32880.0, 15360.0, 39200.0, 15360.0, 23840.0, 37440.0, 25840.0, 18880.0, 20880.0, 37520.0, 16640.0, 38560.0, 27840.0, 20320.0, 24080.0, 21360.0, 35840.0, 34560.0, 17600.0, 25280.0, 22240.0, 40400.0, 19440.0, 44000.0, 28000.0, 20480.0, 23440.0, 22640.0, 19920.0, 29040.0, 20160.0, 15680.0, 25440.0, 17200.0, 22960.0, 22000.0, 22240.0, 46800.0, 28720.0, 30240.0, 17280.0, 23600.0, 30000.0, 21280.0, 36320.0, 20320.0, 26080.0, 24080.0, 29520.0, 23680.0, 26240.0, 26480.0, 23120.0, 32320.0, 30160.0, 27600.0, 25120.0, 35200.0, 26480.0, 25920.0, 29120.0, 45040.0, 19520.0, 34960.0, 16800.0, 30000.0, 43600.0, 32320.0, 29600.0, 24240.0, 28480.0, 26320.0, 22720.0, 26080.0, 29840.0, 22880.0, 22640.0, 19440.0, 31440.0, 32800.0, 30080.0, 36880.0, 28960.0, 31520.0, 30720.0, 27520.0, 24400.0, 46800.0]
thresholds = [19680.0, 28160.0, 40240.0]
display_name = "Thalidomide YLL Per Event"
units = "years"

# Calculate exceedance probabilities (1 - CDF)
sorted_samples = np.sort(samples)
exceedance = 1 - np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

# Create figure
fig, ax = plt.subplots(figsize=(10, 6))

# Plot exceedance curve
ax.plot(sorted_samples, exceedance * 100, color=COLOR_BLACK, linewidth=2.5)
ax.fill_between(sorted_samples, 0, exceedance * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)
ax.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Annotate thresholds
for thresh in thresholds:
    exceed_pct = (np.array(samples) >= thresh).sum() / len(samples) * 100
    ax.axvline(thresh, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
    ax.axhline(exceed_pct, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.3)
    
    # Add label with formatted threshold value (use format_parameter_value for full units)
    ax.annotate(f'{exceed_pct:.0f}% chance\nâ‰¥ {format_parameter_value(thresh, units)}',
                xy=(thresh, exceed_pct), xytext=(thresh * 1.05, exceed_pct + 5),
                fontsize=10, ha='left', weight='bold',
                bbox=dict(boxstyle='round,pad=0.3', facecolor=COLOR_WHITE, edgecolor=COLOR_BLACK, alpha=0.9))

ax.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=12)
ax.set_ylabel('Probability of Exceeding Value (%)', fontsize=12)
ax.set_title(f'Exceedance Probability: {display_name}', fontsize=14, weight='bold', pad=15)
ax.set_ylim(0, 100)
ax.set_xlim(left=min(sorted_samples) * 0.95)

clean_spines(ax)
add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from
output_path = get_figure_output_path('exceedance-thalidomide_yll_per_event.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Exceedance: {display_name}',
    description=f'Probability of {display_name} exceeding various thresholds'
)

plt.show()
```

*This exceedance probability chart shows the likelihood that Thalidomide YLL Per Event will exceed any given threshold. Higher curves indicate more favorable outcomes with greater certainty.*
