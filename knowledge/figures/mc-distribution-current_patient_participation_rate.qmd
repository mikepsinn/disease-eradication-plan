```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Current Patient Participation Rate in Clinical Trials (10,000 simulations)"

import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Simulation results

samples = [0.0007953472708392148, 0.0007719317022499898, 0.0008032646290731851, 0.000806665454221151, 0.0007564603739842167, 0.000767446993523892, 0.0007922271670762155, 0.0007844473818864228, 0.0007896847900038177, 0.0007751452063783124, 0.0008055697114920181, 0.000803752826818293, 0.0007911397325997461, 0.0008100188062284322, 0.0007982297838926471, 0.0007750375781809334, 0.0007964798521288113, 0.000773324198833358, 0.0008055527465553456, 0.000789103702525718, 0.0007867410094358292, 0.0007781156818549857, 0.0008117360956202258, 0.0007872715111159974, 0.0007824958917258508, 0.0007838219635468006, 0.0007993800797167246, 0.0007964213258182181, 0.0007972587046773305, 0.0007975792440861636, 0.0008214285714285715, 0.0007828770283884361, 0.0007810380471231328, 0.0007758219772763912, 0.0008008678061026058, 0.0008100499676285373, 0.0007879818228927416, 0.0007753672340964101, 0.0007756373765263713, 0.0008014840698582369, 0.0008031361679169311, 0.0007995727583032165, 0.0007783823636016462, 0.000794065903884901, 0.0007920308108853288, 0.0007938281968965652, 0.0008054270607100589, 0.0007939147648078406, 0.0008019886517126998, 0.0007911669552799845, 0.0007950716344891847, 0.0008011403088459119, 0.0007648084698019661, 0.0007843876148033725, 0.0007817651115809601, 0.0007788431693798762, 0.0007851641893476243, 0.0008166647911777494, 0.0007749249688416154, 0.0008071624076227662, 0.0007609818327394361, 0.0007841224655972524, 0.0007928420551985474, 0.0008003383832911713, 0.0008025647500099858, 0.0008040307155193833, 0.0007838813365924549, 0.0007819044692713357, 0.0008051863075297966, 0.0007866283898977215, 0.0007678989590533068, 0.0007703328079720111, 0.0007740021166655927, 0.0007987559358329044, 0.000792483988581342, 0.0008021949138771561, 0.0007825145882842746, 0.0007927678231773452, 0.0008010388743573825, 0.0007845676062779318, 0.0007980393970713274, 0.0007784443569191724, 0.0007836317707471028, 0.0007833064679756905, 0.0007692627293210409, 0.0007985751101895094, 0.0007817819688892815, 0.0007901990558350405, 0.0007984646317977263, 0.0007978577443106151, 0.0008017475801187033, 0.000788252624136128, 0.0007825833552450803, 0.0007885814395000724, 0.0007609063345931233, 0.0007649791859356136, 0.0007670971096828047, 0.0007726651799507675, 0.0007970291519065822, 0.0007742424983264956, 0.0007833687067789819, 0.0008131206225632298, 0.0007837500208526559, 0.0008030337531506087, 0.0007737585053944846, 0.0007863813666311204, 0.0007734764847577546, 0.000784050188224085, 0.0008048702347145962, 0.0007602304990499484, 0.0007976431008764102, 0.0007941642748869786, 0.0007796177011420399, 0.0007649971144715772, 0.0007912469641701855, 0.000780738701803164, 0.00079407498976437, 0.0007903634024920686, 0.0008186060277057549, 0.0007857888567430468, 0.0007722145709027388, 0.0007931332200409721, 0.0007938512731058215, 0.0008142047882596181, 0.0008047772868605263, 0.0007962696104678036, 0.0008160908057326849, 0.0007693837133039069, 0.0007788280478629961, 0.000773879597056909, 0.0007831659719781277, 0.0007661773587497252, 0.0008012090814527248, 0.0007860880936242754, 0.0007645765010441758, 0.0007723504676904251, 0.0007955027661489208, 0.0008048312154274999, 0.0008214285714285715, 0.0008214285714285715, 0.000797288413754841, 0.0007727975546653653, 0.000751729676046107, 0.0007946934770156393, 0.0007758363154124707, 0.0007827214705749143, 0.0007793068316614294, 0.0007875119075942742, 0.0008089168144511704, 0.0007927415539440672, 0.0007871996902950795, 0.0007720059901430073, 0.000761120292740008, 0.0007814883197127116, 0.0007890360756259925, 0.0008216341603991301, 0.0007922700217392611, 0.0008074218426799507, 0.0007812627988932508, 0.0007694490171472635, 0.0007732170704664926, 0.0007773500941251239, 0.0008214285714285715, 0.0007756907178995579, 0.0008048377013568465, 0.0007742864063643163, 0.0008065042831944158, 0.0007967666446297197, 0.0007872346247810667, 0.0007892644074380799, 0.0007785678516520052, 0.0007978496065150066, 0.0007820325111989368, 0.0007687540451925665, 0.0007678605430610151, 0.0007930153545428127, 0.0008181934083356091, 0.0007927934026378525, 0.0007878996853430939, 0.0007950134494686806, 0.0008132430255813954, 0.0007938404381131734, 0.0007827985307786279, 0.0008096417338604204, 0.0007975426519914791, 0.0008174058490591747, 0.0007932029989185387, 0.0007687734650451216, 0.000766322556209179, 0.0008195006137210878, 0.000820826344533829, 0.0007868344315917862, 0.0007832812380464956, 0.0008160570995061642, 0.0007707821625198856, 0.0007744275165655384, 0.000801354665250402, 0.0007830825187460319, 0.0007898897747432359, 0.0007871155843585806, 0.0007959282283804231, 0.0008150790820545321, 0.0007915715424738112, 0.0008013655639094883, 0.0007547956655042193, 0.0007891248776140039, 0.000775314272361817, 0.0007688700985652834, 0.0007747128154706127, 0.00078413573658726, 0.0008062234761340929, 0.0007670341562885573, 0.0007905176173902606, 0.0007815254588715737, 0.0007842481453927867, 0.0008077811114984238, 0.0007994832303990848, 0.0008138106305211494, 0.0007872719275517113, 0.0007778561228630326, 0.0007860595128925307, 0.0007942483066863801, 0.0007930855925382596, 0.0007711703575891084, 0.0007915698691478113, 0.0007939965044937946, 0.0008214285714285715, 0.0008214285714285715, 0.00077514177117662, 0.0007849506307051361, 0.0007647016370958947, 0.0007796773528528106, 0.0007955397347631807, 0.0008114351235438219, 0.0007772834549431512, 0.0007785789466057445, 0.0007505034396540945, 0.0007871291751859554, 0.0007715470212302981, 0.000780739626243624, 0.000774735051956503, 0.0007883266007821814, 0.0007597169512323883, 0.000764640407248681, 0.0008214285714285715, 0.0007676987092875909, 0.0007709579256742283, 0.0008228946877929438, 0.0008214285714285715, 0.0007696777889646834, 0.0007835413065657563, 0.0007959986458564621, 0.0008209181364708168, 0.0007728435991010989, 0.0007856854481480666, 0.0008037447113285766, 0.000797649170729283, 0.0007834036373969984, 0.000787633859601612, 0.0007662078424860158, 0.0007858094953872017, 0.000785316960713483, 0.0007940660550522338, 0.0007802906005098159, 0.0007983012596881725, 0.000807959887190617, 0.0007927130286652063, 0.0007961791109283756, 0.000790913401082515, 0.0007899811676262573, 0.0007774134609983103, 0.0007955554560797837, 0.000788273625333622, 0.0008214285714285715, 0.0008180891143750555, 0.0007967825022460503, 0.0007766968454705878, 0.0007706902585323917, 0.0008111699011868321, 0.0007946058479567086, 0.0007984539277263073, 0.0007599388653792093, 0.0008064301849467424, 0.0007979976351720376, 0.0007707241837197525, 0.0007817450956467711, 0.0007946229409208912, 0.0007909012991276677, 0.0007848671180359795, 0.0007881649951225682, 0.0007855684831847684, 0.0007926625280299662, 0.0008162393336651218, 0.00075, 0.0007858326072947235, 0.000793084518557898, 0.0007951931078993745, 0.0007834774821112986, 0.0007597339458875092, 0.0007957588157705251, 0.0008208935557528519, 0.0007635058895053751, 0.0008052910285084987, 0.0007842332946034604, 0.0007889038455900348, 0.0007717101960594605, 0.0007841299385809074, 0.0008131353729019733, 0.0008002749429736457, 0.0008209840683838788, 0.0008109224185760445, 0.0007977257607527403, 0.0008211961490212529, 0.0007977241028712715, 0.0008046499062219083, 0.000784790381961487, 0.0007911487890412036, 0.0007778305190784173, 0.0008075446616146152, 0.0007695625663970592, 0.0008038342508369911, 0.000786639809702094, 0.0008108113315963501, 0.0008032720869750753, 0.0008225972623962753, 0.0008029134678326283, 0.0007628583803020494, 0.0007888051699976335, 0.0007696702534914338, 0.0007809332697974795, 0.0008169604301644479, 0.0008012515093548415, 0.0007778044772112909, 0.0007723824221492166, 0.0007905553986604266, 0.0007689085934312526, 0.0007782849738827792, 0.0007954761720226259, 0.0008105242591751707, 0.0008007393558918865, 0.00075, 0.0007953410785240948, 0.0007912452773016017, 0.0007972792156368311, 0.0008188685883435676, 0.0007545765315030928, 0.0007796704844797166, 0.0008004216952347132, 0.0007626964289728841, 0.0008163201843866979, 0.0007964728753828919, 0.0008049824943222464, 0.0007800198569989466, 0.0008043955924624309, 0.0008089616003434636, 0.0007940785509735054, 0.0007941054247871307, 0.0007947399559701015, 0.0007749677784900209, 0.0007873940012271115, 0.0007873066239283514, 0.0007967390747069635, 0.0008077284525525627, 0.0007716135210986526, 0.0007877881474204967, 0.0008164200825825069, 0.0007770329571759736, 0.0007756758359357654, 0.0007935392486592783, 0.0008049431614590067, 0.0007901803005695637, 0.000813658052411648, 0.0008051651596976764, 0.0008048972780098229, 0.0007997675654312541, 0.0008214285714285715, 0.0007863861875783063, 0.0007555785529409413, 0.0008186510616007436, 0.0007819853126663829, 0.0007918758429437874, 0.0008133071659484968, 0.0007623462538367467, 0.0007683092891593908, 0.000762362883682663, 0.0007761605987374419, 0.0007977355096682699, 0.000799235822716742, 0.0007948447103348319, 0.0007655632949433945, 0.00075, 0.0007909344617757258, 0.0007817407312544069, 0.0007980856949651541, 0.0008023993832015448, 0.0007924103019910636, 0.0008034374755036164, 0.0007940138501688212, 0.0007993402090822929, 0.0007777052195732313, 0.0007868328194199005, 0.0007934417341460906, 0.0008045165272591681, 0.0007830975534731932, 0.0007991821755672625, 0.0007853265365340838, 0.0007879188784202521, 0.0008046772807244468, 0.0007557542386636766, 0.0007675443337459493, 0.0007643831845156456, 0.00075, 0.0007781617675514835, 0.000803246469901691, 0.0007849942287363218, 0.0007934596132813834, 0.0008093346409252112, 0.0008136350084954429, 0.0007887668735730024, 0.0008141034390697509, 0.0007915986635504695, 0.0007754147621249454, 0.0007796133630010227, 0.0007644111939501962, 0.0007745409919012046, 0.0007837194944354954, 0.0008042136615281401, 0.0008207735226067517, 0.0007660837978289336, 0.000796906119984603, 0.0007719220987501994, 0.0007983572956623474, 0.0007876817555097715, 0.0007584825087879358, 0.0008064455704322833, 0.0007794297329785515, 0.0007806622347113388, 0.0007714212157419212, 0.0007785765790552093, 0.0007975273036505945, 0.000786664401157758, 0.0007957706024602923, 0.0007963589902233207, 0.0008135080082284774, 0.0007839847987390898, 0.0007644736872679864, 0.0008089391445855754, 0.0007841816589026254, 0.0008097911513164596, 0.0007967387781172157, 0.0007876808648979943, 0.000796126377921126, 0.0008214285714285715, 0.0008214285714285715, 0.000791198639452391, 0.000792796908257382, 0.0008091012703532929, 0.000775272392668066, 0.0007958485643147034, 0.0007895257837544663, 0.0007955097378024079, 0.0007754841990920349, 0.0007625613041803357, 0.0007544131359881444, 0.000770605098090567, 0.0007819683547046484, 0.0007848493206202429, 0.0008214285714285715, 0.0008096364200154351, 0.000773269061572666, 0.0007961074929680659, 0.0007828654900608089, 0.0007850033039719223, 0.0007932398616460894, 0.0008009246118743488, 0.0007840462608072765, 0.0008088785493752993, 0.000770184727259453, 0.0007900909787147329, 0.0008214285714285715, 0.0007939056645681724, 0.0008155453153523323, 0.0007915879947959821, 0.0008002415423494649, 0.000788983462789417, 0.0007869937692491354, 0.000776413394772306, 0.0007975700338191632, 0.0007751711615027118, 0.0008017511457790625, 0.0008092639520561461, 0.0007964405704481887, 0.0007849704230038689, 0.0007979895707072956, 0.0007845793486528441, 0.0008065755128669448, 0.0007584740767521179, 0.0007841098787813993, 0.0007557920006902694, 0.0007641645061821049, 0.0008142893746826639, 0.0008058523777971537, 0.0007774493582172416, 0.0007640381280135931, 0.00075, 0.0007804957903935547, 0.0008214285714285715, 0.0007976512658731777, 0.0007802169941418602, 0.0007981866952928982, 0.000763046271595129, 0.0007847772599914422, 0.0007917279851054278, 0.0007884695994171234, 0.0008039853130611229, 0.0007960533014989446, 0.0008017999797680631, 0.0007779869944927283, 0.0008058994852119366, 0.0008191002241399099, 0.0007731305979554448, 0.0007745485343410793, 0.000813781446009133, 0.0007866276965726314, 0.0008150127820174224, 0.0007822488683745199, 0.0008159410675996235, 0.0007922913484577928, 0.0007945260297603008, 0.0008179321103495095, 0.0007836541200889737, 0.000773629478262416, 0.0007821440783927446, 0.0007979606368994038, 0.0007629648707457327, 0.0008012503892180498, 0.0007805777341128774, 0.0008103891919907017, 0.00075, 0.0007762911883007827, 0.000760920982985291, 0.0007756072430719097, 0.0007943395480836257, 0.0007868395476556283, 0.0007855440399082298, 0.0007871900682587825, 0.0007935583302862607, 0.0007724713613253091, 0.0008024866907610491, 0.0008016991349129809, 0.0007967681845693685, 0.0007998105226842203, 0.0007952006007457136, 0.0008214285714285715, 0.0007884521913175562, 0.0007846070685827305, 0.0007768613464400776, 0.000772064169682927, 0.0007684318109557384, 0.0007745295723102973, 0.000788739837327954, 0.0007958702254295675, 0.0007908780159953122, 0.0007766540746402693, 0.0008059419159731086, 0.0008030676086310587, 0.0007871819612227927, 0.0007786002335302083, 0.0007996664691525448, 0.0007932865404862768, 0.0007649619349251559, 0.0007887871661514192, 0.0007945932504585795, 0.0007743420270229644, 0.0007933195037672324, 0.0007648481282663878, 0.0008137887116735296, 0.0008121945687943301, 0.0007855590570245016, 0.0007963861113127594, 0.00075, 0.0007699381419376898, 0.0007848390767716086, 0.0007713804060520329, 0.0008026212874647497, 0.0008214285714285715, 0.0007695914500350163, 0.0007754136389568775, 0.000794123909898118, 0.0008187759045726457, 0.0007688092523693142, 0.0007943637359970017, 0.000822609193878543, 0.0007615081263085805, 0.0007678071071817372, 0.0007825779937031918, 0.0007808932070389098, 0.0008043748139034211, 0.0007942335322911306, 0.0007594260528465573, 0.0007990799409297332, 0.0007799055432600509, 0.0008126729602155922, 0.0007790386057374432, 0.0007788823306663658, 0.0007995368193434064, 0.0008034873516793282, 0.000797885549512812, 0.0007609357086188589, 0.0007994817913578709, 0.0007720290773136501, 0.0007941208700033953, 0.0007653767118115974, 0.0007978540381446984, 0.0007759456694824882, 0.0007677803969981704, 0.0008026110076281128, 0.0007942332640449005, 0.0007792742740358334, 0.0008158709578207468, 0.0007822816074364404, 0.0007905435504239053, 0.0007947147045495103, 0.0007791757586919137, 0.0007982941240415438, 0.0007806700049220336, 0.0007827861608580541, 0.0008142673057328939, 0.000771921376333067, 0.00075, 0.0008187726448219913, 0.0008214285714285715, 0.0007828969619189058, 0.0007566990730559544, 0.00078454777517082, 0.0007849708727773389, 0.0007866525224100218, 0.0007706735332509904, 0.0008002199188048647, 0.000799241497985193, 0.0007641756328656401, 0.0008023502254105437, 0.0008214285714285715, 0.0007930042947690025, 0.0007840799468576651, 0.0007874906914560217, 0.0008008549448386849, 0.0007601738852771152, 0.0007928709092883806, 0.0007831545873074662, 0.0008221747823981496, 0.0007869279230611578, 0.0008198095320494706, 0.0007708387749665971, 0.0008003568242462072, 0.0007956068338596087, 0.0007748695862916055, 0.0007931000932764187, 0.0008115553209555683, 0.0007843157933125967, 0.0007608280786488017, 0.0007896714237012578, 0.0007742950800024084, 0.0007839925553458156, 0.0007885486774116366, 0.0007605966564021417, 0.0007621192943250207, 0.0007984880573056605, 0.0007808562400858628, 0.00075, 0.0008038787976520918, 0.0007947757474608497, 0.0007775462086152382, 0.0007671971712725663, 0.0008047897460241192, 0.0007961365460831147, 0.0008214285714285715, 0.0007973908145653038, 0.0007968153767627202, 0.000787054627393336, 0.0008044494392333649, 0.0008010298813870036, 0.0008122627073436288, 0.0007808804609118228, 0.0007823727926864739, 0.0007816134522889452, 0.0008039852344387532, 0.0008167270994135056, 0.0007819654838253621, 0.0007825576966527348, 0.0007955127256596347, 0.0007856770036051327, 0.0008068714335619526, 0.00075, 0.0007755990460032333, 0.0007763627744850366, 0.00075, 0.0007732424726656731, 0.000774076015787653, 0.000786457089672676, 0.0008097618809405677, 0.0007856892403722962, 0.0007720890301226591, 0.0007889804585257226, 0.0008086147512682861, 0.00077303079502488, 0.0007741548260770198, 0.0007998463470184026, 0.00078610008755318, 0.0008014287132590138, 0.0007897401474393377, 0.0008023942125013286, 0.0007720158658551126, 0.0007897675636174432, 0.0007862895829952927, 0.0007689200286691818, 0.0007630035483377609, 0.0008021104846332265, 0.0007838425380721813, 0.0007722354592774782, 0.0007882930290234164, 0.0008100328046210117, 0.00075, 0.0007641377118738019, 0.0007739430502648238, 0.0008160522860516562, 0.0007949562244785852, 0.0008035657550386795, 0.0007702151473749961, 0.0007705682503629939, 0.0007978804846913821, 0.0007910033782420916, 0.000799671994038114, 0.000786691906519534, 0.0007948777338007593, 0.0007927604132397429, 0.0008037523883843847, 0.0008042748434481292, 0.0007620479340475582, 0.00075, 0.0008077629376152481, 0.0008111082921375438, 0.0007722639002124503, 0.0007579950442358611, 0.0007917201970107152, 0.0008064911139990624, 0.0008221759806029143, 0.0007990956951129278, 0.0007834809274719864, 0.0007744549907245937, 0.0007901807437123246, 0.0007847434041325526, 0.000772359241370983, 0.0008214285714285715, 0.0008219489756650634, 0.0008101773627195662, 0.0007739780690384149, 0.0008051334066019507, 0.0008012887708102499, 0.0007977870817097764, 0.000812225528641598, 0.0008012130020421901, 0.0008030783443659365, 0.0008012403357440993, 0.0007959851289231661, 0.0007592801015032411, 0.0007914490527592761, 0.000780275605985559, 0.0007678280646815956, 0.0008200633342009874, 0.0008209235673471287, 0.0008142053858069185, 0.0007944727902115524, 0.0008140498760941179, 0.0007901913128761117, 0.0007935479087498626, 0.0007710147090693702, 0.0007969798621388869, 0.0007910404970986985, 0.0007674389333592233, 0.0007890814111413847, 0.0007885812405472244, 0.0008221753711631674, 0.0008058349774814201, 0.000790180640941783, 0.000794359343764319, 0.000790756233688114, 0.0007864254684195721, 0.0007712039626425492, 0.0007873323549295667, 0.0007769896159900402, 0.000768332026294449, 0.0007990055649632126, 0.00079687844417959, 0.0007592278574952351, 0.0007878288409266294, 0.0008076544512940844, 0.0008087953672685645, 0.000808195509174375, 0.0007906631186278586, 0.0007752830004541531, 0.0007711821695533755, 0.0007960525881970069, 0.0007966662401420591, 0.0008129056729097271, 0.0008095282270277954, 0.0007876617657061946, 0.0007684363517743702, 0.0007843974568208567, 0.0007938024873894807, 0.0007864399869050733, 0.0007798993867653416, 0.0007944316792191303, 0.0007811818603933112, 0.000779030321043761, 0.0007954663321001197, 0.0007829539717927866, 0.0007942766817182702, 0.0007947904824195484, 0.0007702276751216091, 0.0007815763180286131, 0.0008156280069853051, 0.000769840076018336, 0.0007529699387568774, 0.0007579611915667216, 0.0007904908882969296, 0.0007905226379016111, 0.0007879176757194938, 0.0008115854576430132, 0.00075, 0.0007969611342499306, 0.0008178724966123713, 0.0007704270775410542, 0.00078334008847695, 0.0007768723205303118, 0.0007744340730584838, 0.0007842727382928736, 0.0008154414881632033, 0.0008229033402152895, 0.0007841040962083292, 0.0008214285714285715, 0.0007906044924798899, 0.0008213742158332174, 0.0007883434872886319, 0.0007922838129562061, 0.0007964218640009892, 0.0008214285714285715, 0.0008050666045310041, 0.0007776604369414648, 0.0008071753138583894, 0.0007836530393313685, 0.0007814285410465575, 0.0008060926759560349, 0.0007905255946835295, 0.0007948853681162618, 0.0007902252404571669, 0.0007959106926974584, 0.0007974754732670779, 0.0007566969056325702, 0.0008017687390506476, 0.0007729266884011087, 0.0007650610162139066, 0.0007889549182811835, 0.0007914553831822588, 0.0007778982403978045, 0.0008047043333842869, 0.0007667651838032009, 0.0007828678297862364, 0.0007797784225492836, 0.0007891622508936811, 0.0007948904620243036, 0.0007724824009354953, 0.0008027976403101849, 0.0007910864927776201, 0.0007574543420749711, 0.0007563333601390856, 0.0007897634454964857, 0.0007861100240553727, 0.0007881661888546817, 0.0007894885954239375, 0.0007939494212559964, 0.0008067924694796357, 0.000770712636164826, 0.0007696708623915621, 0.0007710172365471322, 0.000795068052522968, 0.0008121403763269805, 0.0007824435241988632, 0.00075, 0.0007606247040363739, 0.0007754899219942461, 0.000780248956474623, 0.0007828426931174253, 0.0007906572837381544, 0.0007845257667133557, 0.0008086177340190209, 0.0007782006277236644, 0.0007749854707389669, 0.0007984314313982052, 0.0007634756774029286, 0.0007968505896643116, 0.0007917821017982723, 0.0007873955093820023, 0.0008183604278925934, 0.0007791317528721693, 0.0008214285714285715, 0.0007860320421771974, 0.0007678762612440585, 0.0007912081067297106, 0.0007713099179715493, 0.0007768919340223449, 0.0007969806059204425, 0.0007997936136173144, 0.0007791324410314383, 0.0008075055625610473, 0.0008105638093925629, 0.0008156012691687404, 0.0007993286398776372, 0.0008142815299443083, 0.000757642012283247, 0.0007844183755669608, 0.0007749047494059354, 0.0007920755195670103, 0.0007800110936752865, 0.0007870680966603792, 0.0008214285714285715, 0.0007870057980428255, 0.000797277479875751, 0.0007859126093540934, 0.00079130998231975, 0.0007900853183924652, 0.0007978895337356302, 0.0008107043176955635, 0.0008194362582214334, 0.0007954339345866219, 0.0008003975146819154, 0.0007700319645307311, 0.0007884384796440115, 0.0008066605200210066, 0.0008053293373176324, 0.0007937033289840151, 0.0008056949623372583, 0.0007986424469862831, 0.000811335098554184, 0.0007950758706840794, 0.0007837598729167118, 0.0007958975712029856, 0.00075, 0.0007967300780390512, 0.00075, 0.0007602956634262086, 0.0007979506117504797, 0.0007984075458042747, 0.0007698341008270445, 0.000777576841299873, 0.0008144102399958223, 0.0007815278782028166, 0.0008214285714285715, 0.0007899459829892224, 0.0007971755015172069, 0.0008188806845455733, 0.0007922832722600362, 0.0007725776635703665, 0.0007880557229122192, 0.0007893547724793246, 0.00076638075815807, 0.0007855011932378583, 0.0007770570655798724, 0.0008063749772437182, 0.0007905875452755468, 0.0007850306594717942, 0.0007881178168257276, 0.0007939064104253409, 0.0008008826630752414, 0.0007726228486173123, 0.0007719041953167422, 0.0008096127757923968, 0.0007827740092939322, 0.0007654939503237945, 0.0007978095460594256, 0.0007981563570989005, 0.0007635592723362097, 0.0007940186203709656, 0.0008029992678896013, 0.0007965796088776495, 0.0008011526513049771, 0.0007657078627861869, 0.0007958126590478907, 0.0007846848973616972, 0.0007815494138317003, 0.000805411432292633, 0.000816380513032667, 0.0008221170688155741, 0.0008134021888503704, 0.0007880556050532206, 0.0007961961629875394, 0.0008035569269862026, 0.0007921098809286992, 0.0007922786430013918, 0.0008045741811882799]  # Truncate for embedding
baseline = 0.0007916666666666666
mean = 0.0007897547471308697
std = 1.6870849087203924e-05
p5 = 0.0007611302629343297
p50 = 0.0007897485590348249
p95 = 0.0008193515131913133
display_name = "Current Patient Participation Rate in Clinical Trials"
units = "rate"

# Create figure with two subplots

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---

# Handle edge case where all samples are identical (zero variance)

if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax1.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key statistics with formatted values in legend (use format_parameter_value for full units)

ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {format_parameter_value(p50, units)}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {format_parameter_value(p5, units)}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {format_parameter_value(p95, units)}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {format_parameter_value(baseline, units)}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---

sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax2.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key percentiles

ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"

exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title

fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark

add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from

output_path = get_figure_output_path('mc-distribution-current_patient_participation_rate.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Simulation Results Summary: Current Patient Participation Rate in Clinical Trials**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 0.0792% |
| Mean (expected value) | 0.079% |
| Median (50th percentile) | 0.079% |
| Standard Deviation | 0.00169% |
| 90% Confidence Interval | [0.0761%, 0.0819%] |

*The histogram shows the distribution of Current Patient Participation Rate in Clinical Trials across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
