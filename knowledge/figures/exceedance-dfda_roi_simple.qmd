```{python}
#| echo: false
#| fig-cap: "Probability of Exceeding Threshold: dFDA Simple ROI Without NPV Adjustment"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)

setup_chart_style()

# Monte Carlo samples
samples = [988.8571466148601, 899.2582862379325, 920.533924336592, 952.3387783763206, 1114.196011299486, 999.786768413351, 950.335164160152, 915.3624020881175, 943.3121164124798, 1183.2285141889536, 1166.2566684332148, 925.9674009434297, 1063.0406499378905, 1136.4564683488027, 1000.1156536003308, 1199.292561671094, 975.1939350556871, 995.7872727474852, 957.3807635153561, 1108.6164728500871, 1078.3849242042577, 1184.487990381062, 886.0500251310096, 1164.9252206763542, 1039.682143247993, 1150.2454515282752, 1070.1645648263411, 858.3563394178997, 1118.7038518804961, 1006.2887173774599, 1129.4064018304202, 1019.087276430977, 1286.5934205757123, 1003.6925909974073, 839.7792948936614, 1106.871934848502, 918.2351571762523, 941.6248020325893, 1268.6402425666406, 989.8333363660406, 1045.3097159963233, 1123.0374906893874, 1202.0996441832242, 1014.7671409869655, 777.5385589447977, 905.6818720094989, 916.4227306564858, 1186.2367983694558, 1189.0218542614919, 876.9636078246263, 998.5683502658516, 1215.1880265793616, 1156.8024606557267, 1155.9412338632792, 1162.4524687442683, 1162.400429160743, 1029.529910675563, 759.5890721370625, 1176.6248451542858, 1081.395103897728, 1040.5397337004192, 1357.704842807102, 686.6596948475674, 672.3408448796109, 820.0027606088912, 935.8789658400461, 1084.1378204302212, 1058.4767060997397, 1002.5455262375556, 1000.7821355990588, 1374.1862692983261, 1037.4763208079767, 1070.2137695482706, 886.2707848352952, 1036.442010477507, 1154.303717624383, 1288.8282106523377, 1115.182042158322, 1033.8523256355775, 1015.8174650187519, 1098.4635882636878, 1006.2029352237369, 1142.879946478779, 1077.949570806262, 1181.406053528649, 1171.7830922692776, 927.5449429848521, 1077.486591101431, 1256.5938493512278, 942.574681398754, 1008.646369962827, 1053.0482138409038, 1026.9679277152932, 817.0506664930846, 991.8752715712856, 1200.289426063923, 1571.8733436954647, 944.4126622213658, 977.5657648650403, 1313.5083602905054, 1036.5960362660808, 957.362750535258, 984.536658382125, 989.1427359275488, 1332.2555933945573, 756.7256122457434, 1006.195394255964, 1005.5172531351673, 1057.7743453133467, 989.144200145538, 986.4792019198331, 936.4268863635383, 1103.3132862204961, 1094.381212128202, 913.8454973809744, 1206.039839462238, 1200.6299273072377, 1116.678574929483, 1116.280760372255, 982.4298877070071, 1195.6910409836703, 953.146251858416, 1131.8202201916533, 973.0104981017273, 1062.1537426968628, 888.4072308201447, 1071.488671055503, 1300.9826912020553, 761.5141016108247, 1368.0838073052544, 1348.8879230539994, 966.0792301142528, 1018.5475103105231, 1245.8232211406496, 1147.2986397830375, 1236.9611592786896, 1037.2790033544711, 895.0868326523306, 853.8087751465417, 958.6455271754128, 976.4615825184267, 1127.779061167414, 1219.6117572083483, 959.2058024681545, 1093.9606207046143, 1180.3176044387994, 1295.0022290207999, 1066.3957459589303, 1117.0334286704058, 823.0175452648288, 1245.0712385186348, 1275.587154612287, 1395.9396212537533, 1003.736802127402, 1027.8007090628714, 1095.8649619825865, 1277.2914726041522, 1023.2316031330682, 933.9242936124481, 1114.44738586381, 1096.9458527905576, 1166.2045728037638, 1078.1640689430142, 1094.4999235404198, 1186.4333607904075, 1340.8770038326224, 1160.980404580751, 876.5461727091167, 1158.3899268076789, 856.4584675898194, 1009.417322078172, 1170.0708651931404, 953.4304524059614, 976.522093080656, 1329.8965358111113, 999.4774815438426, 843.1504344981375, 965.4932729624675, 1228.0909919471258, 884.6927991754874, 1151.4395491103214, 1218.1764151584696, 1057.4406909503964, 901.0085488941733, 901.5187732965043, 1152.5361514973174, 921.380099163329, 968.4719099967565, 1174.032803744918, 1152.668623855714, 1111.0562203084698, 907.1786093114705, 1038.0482905298984, 720.5589475180404, 966.0925043368769, 1160.9488511036784, 1030.5884618603511, 790.8773688115251, 1073.4357351605397, 945.8589153751436, 863.6663231865934, 955.6757305583991, 1009.8287944799187, 1224.2906044937813, 1151.0650622047385, 937.3020761299878, 1246.787958105009, 1123.1140459520936, 1201.2786298708854, 1006.3480814211737, 1054.370223200084, 935.7985332323458, 1122.4796209876295, 1043.7965203899794, 871.6334960888738, 996.2960489507764, 762.1397550030457, 931.4850357422926, 1119.3371141986565, 1334.644908657963, 972.4823744159313, 1098.9222515528636, 955.43927779506, 1399.9767861731482, 1052.5467325790949, 1163.9424772889936, 724.1528803135313, 774.5409682229944, 1099.1349553721618, 956.2921519385867, 1209.575163235113, 1050.0115523500522, 1107.5664448560594, 934.5600175000025, 1107.1066808254309, 1051.0505056090801, 1148.4715636619803, 1037.715492748655, 1208.1710352181801, 879.5284001151169, 1083.0824963180696, 1051.9201017270361, 1401.7037456704222, 1279.5967534858637, 875.6727549085894, 1404.2693566818984, 1149.5040024685363, 1034.034289859089, 1021.2439113098318, 1391.3905014486932, 1097.6394730048291, 1198.0711057999422, 840.0724184461249, 1302.479478558159, 1126.978086059034, 1031.4090756285102, 959.9244498102811, 1272.4234798938853, 1114.2913786898814, 1188.0005286137643, 1059.4944895683766, 1076.2180543495383, 925.8402403967982, 1090.966828429429, 1034.3919045262178, 834.5852683181398, 1017.226042642601, 1055.143625806992, 1193.4524261342751, 1052.921959707213, 1130.8396772016067, 1071.1294558345637, 1208.41093252035, 976.6994748987638, 1108.5166518930348, 1006.7861134225432, 1260.1199451726402, 1255.8612081330748, 1099.8696698739286, 979.9915175438156, 1073.153168456381, 1150.7619887548744, 842.2064533493616, 1016.6263675519481, 1173.368373932024, 981.364376048804, 1035.5101051636134, 1249.0701224612415, 915.2394140772969, 1172.7705564118098, 1307.3268068604402, 923.3641901488583, 834.0629794811219, 1310.9536285651143, 939.9098603344853, 932.5397034542104, 964.5201098427161, 1277.2106155560546, 1063.0402429585968, 857.3658057415605, 902.7036638579511, 1374.1324670653441, 1038.5718471966625, 1096.332364934445, 1318.729714237716, 1061.8335060403442, 1130.1935884710324, 859.8632966852537, 1032.711270200801, 1022.4326413488794, 975.7970338286635, 1043.8018511111113, 840.1302809896423, 904.5144308974076, 870.9336551913206, 1312.128046553895, 987.4093792567834, 1070.3360063338373, 1088.202370295564, 1070.211668068982, 944.7005895445725, 1030.1165430841345, 979.2265560769935, 1093.2450840943814, 804.9845756116924, 1192.2937452794877, 1217.5116435465454, 974.8406193105475, 1320.3099149054585, 1233.4706185696964, 1059.1113475101688, 1313.3590729185228, 1251.8604490139112, 1160.2115272099982, 1178.1608567977412, 1312.371053504191, 842.0992607424567, 807.0147074439011, 852.0999671219514, 1112.157869310165, 1082.904258455829, 780.6994398238638, 984.010341499992, 1041.3212727003563, 1029.6961955976249, 1031.5306467790335, 1137.2291517569563, 1042.5006116961333, 1423.0780928451602, 970.3642465757332, 1429.7968450241776, 970.4742091963532, 1071.1189532268731, 1083.2747882983808, 1152.533266276414, 926.2056694183523, 923.0615229536476, 1044.4008065039366, 1198.5727213433145, 883.1370600812364, 1083.4423035106088, 1234.9831045728615, 999.2729456017728, 1202.5009897750438, 1357.375671929371, 1017.3161336245023, 1210.9452255090073, 1312.5066070597738, 1121.6206345402265, 975.5460383634631, 1153.8156226149915, 999.8246550017185, 1034.2734276073143, 1303.8165709705836, 1138.58542667246, 1005.9869185187071, 1176.0185979208609, 990.8559981093467, 1040.00262579944, 1086.2221606553387, 986.5132445099273, 950.1670359307076, 1145.045438218678, 1410.1743526844748, 1051.8734406121011, 826.1677091126625, 1133.586420899187, 1042.7828346536435, 1010.6731974599876, 819.5492752769998, 1247.0718928635627, 1102.1877198079212, 1193.9036371633717, 1044.5213698502967, 1085.8234219488904, 1166.3787502430068, 925.8418250794484, 898.3585691405174, 1134.7181278805535, 1164.4171174269768, 1116.9592008757606, 792.6685990121052, 1087.6339027462775, 959.9051185494226, 1139.0429147866957, 1315.69201720089, 1164.9891488394624, 982.9515031845185, 1114.56808221029, 1026.476074617237, 1040.1734148068595, 1105.8634627611998, 1285.0748995684512, 903.0095846706404, 1181.514405436221, 1127.6624883914494, 850.0137881611407, 993.0238771965436, 1128.3544936451651, 931.0293692841984, 1262.9093863297055, 1201.7935229372354, 1127.6782402698866, 1193.0158035924687, 1283.3116172663647, 973.8164240592864, 987.2526544587515, 973.7067741630856, 1187.7449522548372, 855.5272477302457, 1194.660331960798, 636.6694875683917, 1099.7258219386345, 924.2138413090998, 1048.6954188161874, 1098.0735036039373, 1256.2464061409928, 1065.5384397753571, 1242.2277591168954, 1121.9341665879997, 936.7130561779487, 974.0279374643706, 973.3544084131305, 959.0865838069162, 926.387133475393, 1245.6874470021357, 895.2201584735845, 900.2854976261511, 942.4821834594223, 1148.123459462832, 943.932608542459, 1130.3394398692167, 1163.9450817820373, 1001.2660367479172, 1047.6720968319637, 1067.6712454295482, 1055.4634735851585, 903.9425328949221, 1305.8383344997196, 1096.04828451126, 1138.5387141252197, 1119.849247557498, 1074.771199867993, 1120.406138779766, 1161.2837843992725, 1147.1310213214053, 1223.5701069637414, 842.3192776389263, 1014.8878658130265, 1255.6867453531895, 1254.8200597284874, 871.8778020764433, 1019.6624174092638, 1113.7352663461581, 1073.1269445659416, 1398.9329920110001, 1092.821940800581, 1136.716856232168, 1177.1302335151613, 773.7269302479052, 1181.5210884806809, 1058.7867602848216, 915.490447413212, 1004.6078674496601, 1069.1426872112756, 1302.8506264184036, 1094.2483144674916, 1003.6383596833463, 1222.7399215707474, 979.5087676438085, 944.5038285705034, 1249.9203718110496, 974.4116646099642, 1171.7898766092933, 1109.244098188645, 929.4569613167951, 1126.1050131058234, 1128.4353571890592, 1277.2704293072788, 1246.6369016580463, 937.9131029214458, 962.2788026210835, 1149.239642400576, 951.5937470630951, 1211.8734184131745, 874.4672710879202, 838.925178900857, 1226.7641561214907, 981.9517874135876, 1003.1640806047282, 1039.6545642707822, 997.9509499264198, 1165.793832517784, 1057.3011416159316, 895.5963459803668, 1090.1835968522798, 1136.2262038039325, 946.2826260606088, 1000.6835838021801, 1163.7450306291328, 1129.1198749277598, 931.7210734659467, 853.4862947689829, 1147.1479983860534, 771.4972522594562, 1301.9993833634642, 1094.279213523083, 1144.2376964432294, 953.8327771835235, 952.0130123297279, 1340.6778322463313, 1215.5703544999124, 921.1525182830763, 907.8984074439506, 1203.885360842662, 993.6683128328517, 1223.0003681428384, 790.0573486578401, 1184.6794168846166, 1148.4723441346066, 1161.257740937525, 849.019275910764, 1055.5006209950616, 1032.5228275710192, 960.9797103555204, 1028.3021384839963, 868.8589909244781, 917.4560145029728, 1013.9171531878392, 947.6890235419646, 1013.1075639275506, 1365.3710167738539, 869.5762842595846, 1019.4621160560857, 940.1620989684387, 1074.354802279321, 1037.7418869816256, 1275.8401461587741, 1119.4210253200722, 1325.8559353644114, 1119.6178339294356, 1028.1516028063943, 923.745173546035, 1260.5789988573058, 955.3190151883462, 1082.1707121252853, 1312.177822470298, 1307.4053662010995, 1107.2869148191094, 1004.9541303892429, 1076.3364216709952, 798.8160325698971, 1020.3767617451224, 875.0911789614917, 1083.8806134335086, 1071.214121026183, 973.7004108267172, 948.0838582431259, 1116.162497476131, 1028.8962465730056, 1450.1036008451, 1387.7482854604407, 927.5771219010644, 1169.7082829288195, 1078.1621074398906, 723.8284034975992, 1061.2300220361444, 1088.7174907774802, 1137.4395220907656, 1011.3829336844706, 1294.6032509567012, 1362.5407365357323, 1016.6961892871874, 1252.41092545214, 1263.8540710812001, 978.8739971916591, 1268.1661274126523, 1111.5640211335026, 1055.5647946033698, 1195.8644819939773, 1057.7352898107627, 1221.8857995089577, 1172.613994826006, 1401.921426669898, 1010.2182751049393, 1033.2822186365495, 932.7357797278692, 910.5695899804788, 995.1331968375207, 753.7466252026383, 982.5387062329468, 717.7355827394443, 954.451202286422, 1166.5458341053009, 1024.3996125006067, 935.8878250166898, 1100.5535887043814, 1144.79717016969, 1221.031455463995, 1038.4891779320965, 1361.993467386079, 937.5058416954066, 1006.2402946992588, 1203.8170658130682, 1135.1475348533525, 803.7489626229759, 1225.743490289764, 943.1117744545152, 1234.5623419404824, 1156.2628326327622, 1047.4978434496627, 824.6581359686123, 1058.3975584705606, 1229.38839211522, 990.2349484973834, 1080.4458714965565, 1136.861834927843, 923.1550197710442, 908.3091613545412, 1095.272979142246, 1231.4297185551002, 793.179713899892, 888.4424249225054, 814.0618730978185, 1131.886862299511, 882.4552046498628, 953.0455315466843, 1004.0342742235149, 906.2728623221958, 1060.4191272980463, 916.1744080102976, 840.6664207848982, 994.4722614310136, 1087.204884645979, 880.7647154870593, 1172.5826249248998, 1037.0525427191008, 1146.777153465988, 906.462907604534, 860.0358670174224, 1200.3765142659438, 986.4238357834281, 1020.5087844263317, 921.2358065564623, 1149.2801313803038, 1045.40088299212, 1205.1707512935955, 1101.125378124976, 1122.0537602168065, 1579.9184594889543, 975.0596118367763, 898.1634393239389, 1177.4930913875764, 1183.5498358112573, 810.7990371723662, 1037.4807621820273, 921.1179757889086, 1066.8450532724696, 1059.75230992545, 967.9283158663554, 878.3561936485323, 1103.133666431946, 767.866586992272, 1373.3451696015081, 1000.3922397039187, 959.6662603731381, 1114.312053676006, 1045.2372501651828, 1061.1848693255404, 1083.0552046202338, 1023.114261408367, 914.3050105033709, 1210.4282655001448, 1316.1080514839591, 1221.4325088802457, 1240.4352407680794, 1095.4172101063161, 859.4375981595799, 875.530635687464, 1081.6669148214423, 748.3581598167113, 1122.4579502260617, 948.1070868548329, 1068.3136010388885, 949.98037038353, 997.0921348059917, 1153.6351967800986, 1191.8635634468392, 1271.3032081049944, 908.8533187999797, 1050.9974904912388, 997.8811094616955, 1261.133714669648, 866.6156354686516, 1196.8262416680209, 1040.0411281753916, 1177.1115671085036, 1036.1298264926616, 1030.040172555154, 1077.8124676687673, 935.0209171441036, 1068.6753340461612, 923.0878562831713, 869.1408207654134, 1241.3581127504754, 989.9529168997735, 942.7633867014887, 977.9143308794061, 1146.2437649907188, 1050.7846519172626, 1074.1065611202846, 978.0997422863821, 927.9331381210422, 1064.751224823779, 913.7185032945775, 655.3523918788675, 1075.7643172630187, 1076.6398381741496, 1228.8596947512897, 1027.658930490453, 1330.4924593979938, 1159.4844955707551, 1275.4361052791944, 1150.4036385015706, 1080.5739072393058, 1162.9025362683722, 964.2669028312446, 865.9463173672846, 945.7786068292269, 1205.124176958049, 1034.8156620684663, 1052.5616745381585, 1131.676723846304, 693.6309302186093, 951.7211419948513, 915.0209135595986, 819.1880036585607, 901.8985890252752, 901.2948014833578, 1048.726521858562, 926.347344861879, 861.2224538284504, 681.174004640193, 934.6257227875209, 869.7619217874402, 1192.2816795115166, 1099.224980839397, 1092.9038308094255, 1127.1955717918906, 868.5263735025007, 862.8380778001912, 900.2422577137262, 984.0067004876903, 976.646342859866, 1172.9993817225711, 984.5248617491352, 1223.2236681955835, 1223.2718868563165, 926.4424561530095, 947.9316509837295, 1065.3985578765798, 1006.6514041719781, 1029.9881699102084, 1079.162843319728, 1141.4999034043374, 1072.0252315550988, 1131.5911708612969, 920.3426941416354, 1124.5342264478666, 1064.286312859629, 1096.7220509996619, 912.1248924034958, 930.6296952393936, 1012.9943661119943, 1132.3678371225124, 980.929839451198, 936.8329307034523, 868.7552790744686, 1011.8603607777345, 1104.8891499043818, 1172.898360217511, 918.1548143794781, 1207.7128663614062, 1208.3834259032133, 1026.24011568764, 1012.0127010014029, 1177.8507065490091, 977.4114525538351, 1209.6673668846847, 1117.9886397360326, 1160.390051271446, 1019.4632064122088, 1116.5642492027694, 951.016932243351, 1221.5339985962332, 756.642685197739, 1108.0516640423302, 1213.0486484930811, 925.1974797761296, 1308.1619876399868, 1105.6977803843777, 1009.1153544364691, 1326.7414026212018, 873.1582159928004, 1216.8872866162271, 999.1155635163834, 1123.528212021297, 880.2785450409955, 925.9345161623734, 1147.4810160713355, 898.9248847166822, 943.438583064964, 1106.9884706010323, 1173.4577508088025, 1083.7648194417175, 1002.0952396824538, 1003.3381761606163, 831.948616951628, 841.6874670133428, 1094.2235295777255, 910.5845619579505, 1036.1667208936572, 1123.0741724369016, 1054.5987165146205, 1002.0170278366492, 898.7075034569173, 1092.8546498241851, 1196.796555576551, 1071.6727241142698, 1026.6343130180262, 1129.4189234872167, 932.0015943160536, 1134.6124822845827, 899.9187462872283, 1026.495886710794, 999.4365895756976, 897.5602381342087, 1118.6069893194178, 1287.668464127661, 798.5619278605926, 1030.896589101893, 1228.9293932127764, 1176.0876136874608, 1042.22442924672, 995.4207516536818, 1194.40199780064, 1495.5445791974414, 1174.8535685931072, 1052.5300171554773, 1225.569734592309, 1171.5090158893354, 1234.081820546266, 1041.6967849480895, 1090.0121874111162, 1328.0295253287102, 1077.9697338703713, 1330.7288750349032, 1297.317191638928, 739.3834678584151, 912.8379221919656, 1047.5215416762207, 1108.7472063094995, 957.2338981287761, 1256.504351066392, 1037.0327525113992, 1062.8506852609826, 971.7278871096546, 981.9618216485237, 1197.404802606863, 1123.0747689859377, 973.9056329812679, 787.0004501056197, 1155.9222220251368, 1054.077528280772, 1103.6217802364845, 821.0165176995724, 1094.696080664219, 1120.0438288189714, 945.1159966283097, 1369.2401292929544, 1082.2224377960645, 1021.3909888980988, 1099.1254437845082, 759.1340005996913, 769.8929796350678, 754.492610229921, 1139.0347999646326, 1228.3864170251293, 1316.2212188504373, 1031.159613682437, 1163.3603175410335, 1157.8117511386668, 983.8816406026141, 1022.2073385745625, 944.5972358352296, 827.5012852536732, 1201.4155839530436, 965.4828062523184, 1067.7905301287255, 1453.4865724367617, 1288.707976412536, 993.7990269269336, 1022.5373344534632, 1125.0568458903776, 1235.0296255893256, 938.444628650867, 1010.6226502526335, 986.5605179978252, 699.3197859128135, 1094.4835495099533, 1145.8585675036736, 1005.4009631375847, 1096.2418260664738, 894.6382685272876, 1133.1339776386808, 999.9734042647941, 1045.9052686474743, 965.7789612107584, 1074.9468312068389, 1007.373925965132, 1016.3049409200834, 1055.8564745696315, 976.1403044622696, 978.0258791499695, 1212.9845864998747, 937.9049626291527, 910.7744388114005, 1351.7820019224234, 1140.434982074052, 1097.153335418479, 1089.0303821073892, 930.0317551198725, 1142.8950968537463, 1065.1604580162439, 1012.7821434707064, 1078.3784952311278, 884.9768076896466, 907.8812039413333, 845.6315551752245, 925.5986325841449, 853.814614890727, 760.7747247955716, 1192.0314247684262, 1074.9805367704748, 903.8542544076333, 1250.1838514888068, 954.083793716532, 1224.7013779223223, 849.7257691894596, 1132.6564581973976, 900.7283834407167, 1074.5384055401303, 1059.8642401103755, 871.0305073675561, 1040.1042777518508, 1119.214092680081, 781.4216856045833, 1107.2081914089815, 1237.4414507692622, 952.7127311352372, 920.922198937511, 1278.1863120763146, 1065.0953902931324, 965.8672500494697, 717.696454475153, 977.3998252210747, 889.5463294991534, 1073.4411873629542, 1413.9856640051737, 1124.5140146808064, 1056.8247877024621, 935.5500587582183, 874.4441200881447, 935.6303198715541, 1032.6517961410852, 1186.8241790655843, 908.4362960119417, 1166.322083216556, 976.7192744272755, 1068.5728995608135, 872.5462057280411, 1175.73546360795, 1039.2753687595448, 836.5905542220191, 954.7569000421095, 1065.0384487137476, 1048.1857496066666, 850.8305796272261, 1053.6605238259622, 987.9984968950156, 1041.8407102427677, 860.5204774963331, 1137.7274253456817, 1133.9496115024072, 992.7399072072135, 1068.0546160198942, 998.2414491809726, 1021.058276911528, 893.217422540704, 755.58521167715, 952.134804610489, 1118.8728015558447, 1023.6361732009577, 1052.485624340244, 1118.0787122243923, 1107.8046437903597, 1059.8513033503973, 975.6458794925953, 1044.480529587251, 1122.2993332625879, 842.19581183811, 949.5310592612287, 1045.4462111414675, 1282.597555119064, 1086.3755238836525, 1038.0357517862717, 945.3390268012527, 705.0609960990358, 1106.0782745796807, 830.4153891009043, 1109.9349695023311, 828.3920227440077, 1112.8895791681637, 1104.098218840585, 863.0042856961084, 1019.0002937364347, 1104.0571231077645, 672.1717638167055, 796.4024180367339, 993.490385556421, 1223.9520319457372, 1065.6806749657787, 1171.4221194496854, 908.2833990095835, 1121.3808155457184, 1053.5331211509445, 840.5371626893217, 1092.603119599383, 1155.1862445137783, 1004.3899691723464, 864.6089258886913, 612.170464920363, 970.5151701794518, 918.3249722026779, 1075.9126579060398, 1008.9489994002857, 978.0665940870815, 917.6391550559583, 799.7565426206978, 847.9748706900355, 1090.745547470615, 1250.403378072843, 939.072610121835, 1253.5481669037624, 1037.6414220477413, 1131.4964051870372, 1065.6181678429805, 934.4096763947236, 899.0657793281964, 808.1419464174016, 999.5628963399491, 893.5053102779194, 1132.115534848587, 988.5030150927718, 1084.5411213348032, 1111.2173693508835, 1361.050092789529, 1080.0360486160253, 999.6356759317199, 1096.1393490155444, 1028.154020288532, 1025.9236031290636, 942.0325834818249, 1080.8771747848305, 1123.2020990018184, 1006.8039939147654, 1136.556865392302, 1062.3681376790105, 867.3693914997468, 943.2502174186446, 809.4875230615519, 935.1681894030162, 1190.3959679737682, 1069.1003679190314, 1079.7240238141965, 1223.838715718541, 906.3217786911806, 1080.8695824511933, 1090.4917464866705, 1111.5504502524689, 843.2545390061279, 971.2073804843621, 1066.8232756984364, 1018.90841643294, 1103.9782564692316, 915.6074406473954, 908.5251272551649, 1030.3269264728563, 1060.0875279098152, 1060.1894554096261, 959.5871511637591, 1220.0339226940835, 975.3617172726548, 955.8496895365523, 1087.278751515706, 884.6916793570811, 895.3770144477685, 1112.1546552903276, 1149.0767010860889, 1140.109368804297, 1148.5622608844053, 979.2479873183987, 1070.2374416448397, 998.029089492434, 1119.8780229598565, 1004.317747420582, 875.2401901367242, 1073.5538726576337, 1299.4970122718398, 1122.9633695344419, 794.9745107418162, 1325.276474969792, 1208.8334512005574, 1216.6393340490729, 935.7472505180942, 1173.2772789646083, 1024.3446112902673, 1116.1994671298448, 891.7959452294772, 942.5482136531496, 1194.6893721950066, 1106.4459292721476, 1044.941276972987, 1070.822812646978, 649.4748826714864, 964.3614855877843, 982.3361543223898, 916.1515908093411, 1098.6020777916492, 1066.4359293474365, 966.3927605577336, 1247.4852518373837, 1019.8040916664871, 1002.8916780018026, 1067.0623090728627, 1002.4956705824126, 725.3068572411738, 744.5011718947753, 920.0515731109768, 989.7709925172675, 1090.6529148409588, 1233.117093781071, 1060.1200574051097, 1072.2584981569964, 997.2161828753262, 1155.651707235507, 982.0628153974427, 1004.7194733576811, 1122.96631646664, 1054.4590354891086, 1151.867973634006, 929.6706600751551, 1133.2531253953427, 1131.2482639348639, 1256.8864481269777, 1217.5522479448757, 947.884924353789, 1061.5228128781837, 977.4447081474643, 1315.4529250062715, 976.2941159226949, 871.9395364430621, 1228.9563758824067, 1051.584837822295, 683.7363854258606, 975.3956745297542, 1185.805720605889, 1364.23745400284, 815.6892156699839, 1106.595972074543, 1046.523566991853, 894.0778512093168, 910.4663448172402, 1170.9792926782152, 1082.783488499254, 1312.5594535384482, 922.8265508584035, 1222.5480098617759, 1087.3850069775597, 921.871920055146, 1166.0357009279874, 1028.337261207965, 746.6848156077343, 926.766402220095, 1065.8755792766678, 1194.7092740616563, 1427.6789378160015, 1158.2361143662195, 968.3705320989944, 1055.8030321620322, 1117.0305370633112, 817.330214001514, 999.4360291601156, 1039.2303617295404, 1211.1899578463378, 870.3289201655532, 1150.136067353904, 869.0587303223556, 1132.4243557023915, 1117.5003817086226, 1240.6246667791193, 831.4096962879208, 1151.3837954930902, 856.4634429055697, 1127.8327637554712, 996.4667926206478, 1086.1900591278234, 1167.1972650915536, 873.0264734162183, 1165.6098006265988, 795.6313899947072, 1251.0159611152196, 843.0752615932271, 1375.578259632642, 1036.9212212270554, 1203.366739691011, 1050.86158324877, 1066.065302486372, 999.0356458826799, 1194.2869592430718, 976.8777115114492, 1069.0852212764594, 1222.9767821488397, 1124.1668751852937, 1227.7675985378992, 1184.563571809743, 991.5125082888563, 943.2667683610609, 886.6486971609621, 1133.8429350714644, 957.110310873676, 1127.8490565057186, 900.4282096741534, 1156.5671282226767, 1083.1045340569838, 966.6080411053684, 1016.5115586873958, 1209.1107914372935, 1045.7775736589824, 883.7129649463087, 1133.8928095730114, 725.5550293770534, 805.6416539760672, 1163.6225044915468, 1130.3461673999172, 1150.6096338790433, 1323.1207576105571, 909.3675579772724, 1121.7925349259738, 1030.9318498142163, 965.1170954120017, 1353.1508756154014, 1137.6487921927767, 1053.4211839500097, 1006.0393262492355, 928.2102354334243, 1319.760012289577, 879.5183291052693, 763.0132494295651, 1177.0750091408206, 858.6994230314948, 998.1996755345348, 1069.7501151706504, 985.3903172707267, 1174.0997712487772, 1039.697040797513, 1056.6483191507612, 1217.8617048139238, 1189.0405327452727, 1219.0551949177488, 1075.862036290951, 813.3369082749563, 867.09029098497, 945.0457421371002, 1064.6990265017953, 985.2618872805493, 1229.1986019219084, 993.8676924909242, 906.8189354458134, 1435.0767511372137, 1068.223001076795, 1010.7415676947018, 1204.2836113390952, 1017.5899701532891, 1206.7239654471869, 955.9247904939627, 967.0575252331104, 1058.5866910556274, 1277.7556101719313, 806.2300993092049, 1369.175359390307, 1088.9922964177151, 1055.0023941977677, 792.2922152838903, 980.4045273245865, 1033.8247341617741, 1092.5969367776813, 1103.8369102396457, 892.909853722103, 1027.0485192688977, 951.6175956814799, 1278.9011710630825, 786.0268788745917, 1170.7124599848637, 947.942169314218, 1030.370255072373, 896.1113857577374, 835.391067066896, 928.2270670573429, 1147.9955159708195, 1245.2471778784918, 975.9073130922073, 912.365292434988, 938.3029724202975, 1043.2670279565448, 692.0467286518608, 963.2443863449472, 1239.6158522590595, 997.0275724360708, 1085.368540281661, 1079.3668763116943, 1031.145689769375, 962.0007312449044, 882.9760288841521, 840.9420980372994, 1025.9565451231117, 1121.3081432922472, 1100.7708478320474, 1214.06861984304, 920.8251085807857, 950.1204107411029, 894.2992611125837, 1315.4079346892015, 1103.2366676648792, 983.9813543793051, 1011.30087470668, 969.8625508830461, 822.2547620385916, 920.4880216902525, 1103.8478149135196, 1231.7934602066307, 888.420899925671, 940.753343661028, 986.9015688466892, 1007.645109128809, 991.1810475694164, 1043.0771588275481, 999.0657704471212, 760.4542652718419, 792.7438617075, 1078.3312517890338, 1160.5751607131087, 1062.4302954439731, 1101.853963828091, 1087.6561101008083, 1155.0973817252534, 986.7362569553723, 1046.5588227311482, 1286.8031390740907, 1108.757120907302, 1233.6919754330763, 1059.2051225230848, 968.1622266533315, 954.6844571264827, 1384.491746294545, 890.5995872239056, 1021.6708539473198, 997.7904011184249, 1074.2966448158506, 1076.8144968274228, 1085.3410557856544, 1113.5326105064496, 1127.6424812103073, 1211.5633283342022, 1105.0724369841535, 965.4909934080034, 833.2882166101481, 1119.7193324712648, 1185.5935027201556, 1242.7189127739332, 1146.3581015737798, 812.2337329132656, 1371.0005240853814, 933.5834690347858, 887.0434084184826, 1174.3243099951471, 806.3917248315478, 1048.2557425702132, 945.9164162024578, 1199.7268574752402, 1148.3757337765846, 841.2289178312245, 1130.3047275097763, 910.7666038512904, 1296.7540604782864, 812.7177315686679, 1002.7814645916487, 890.5728249515913, 1248.4572418992855, 813.8991751486476, 1196.4411430118423, 904.7851132891869, 1175.226763101591, 1236.2238365628593, 1025.0210837259376, 1090.297224258554, 888.157097982451, 1137.382053413498, 882.8928351682936, 876.1642109681075, 1004.1080317639859, 1107.2496644142254, 1056.9755581683617, 782.8064845327546, 993.9923918015321, 1213.2654234683978, 832.009759474326, 963.5183200102636, 1260.4786239800085, 1421.4132779471174, 1233.3080588127075, 1229.3712547845873, 1073.9837388310018, 1313.4087429239073, 855.9480023827034, 1246.8480809052194, 817.378279059958, 1310.4065782316466, 948.1064552493947, 907.6633552600514, 772.2188571676533, 985.3435947014084, 1205.1094330196593, 964.9105201310168, 821.2818318680721, 1102.3190510212214, 1438.1262686769942, 1024.3626703679365, 1221.849428578272, 920.8470772405433, 1024.352787686796, 961.77728472609, 999.6827374154882, 847.0672349367138, 1135.96179039466, 1097.5562596647756, 995.5334389356234, 1091.6543942935114, 1120.4060252403854, 904.1097394144521, 1158.8831101866947, 981.1953020540193, 1251.6906633687581, 1041.4400232692237, 930.63436481731, 1106.016612224058, 917.5936355562009, 1161.2953617567193, 951.4118762512189, 989.5815855581781, 985.15462359318, 999.53705461495, 1130.4867678812889, 941.6364135886264, 1010.4549654617745, 1228.329738658526, 1071.6613187499486, 1201.714763608486, 1339.3455860745464, 1061.9441726177515, 1165.1035013412934, 1042.6277877982627, 1154.5274649126404, 977.935564890791, 1045.4352225184693, 967.3328922181563, 1224.072350214036, 947.1267916316008, 897.9536614236092, 951.8601156560255, 1105.7700671750808, 1165.6474608913577, 1009.447410435263, 1420.2362427756902, 1132.0238281918873, 801.6270560357951, 977.3935645962645, 962.5909726760773, 1458.5657329606431, 1078.1904278559077, 885.5917733954952, 956.7519996048613, 1175.3854175772574, 1183.3717526897847, 1005.6872728351876, 886.612550294358, 971.7446184825068, 792.5028177829663, 923.9639037548573, 1012.9593450858415, 1058.6451140370557, 962.7988480273629, 957.4494070882397, 1060.8689576980685, 797.669574539843, 1301.6072059363928, 828.4307650906296, 972.0603956392574, 1390.7584929086886, 1078.777883740056, 974.3063666179212, 1044.9825010867721, 986.3576329328919, 1181.8449263964267, 884.5779447030294, 918.8275692822214, 1124.8762094223791, 1286.1735862564758, 796.4722300809885, 1135.9738948607173, 1110.716245883598, 998.6232366656242, 1269.1774406532136, 906.1326299339895, 1243.8889661675573, 1259.8021635517978, 1157.619808282306, 1301.972334276677, 873.8483308773051, 918.4909444930153, 1147.8971134432384, 1190.8784665692517, 1346.9107477488649, 839.6766965897174, 812.4986180340975, 954.1613265836477, 1256.1747491337153, 1132.4434767176028, 1146.5148518094388, 1298.2024849509753, 913.2116550059402, 1222.754300572678, 1047.7928701070775, 965.628883189467, 1299.5405423996008, 1144.2449856592825, 982.2038907553202, 987.5174160883762, 1243.1570866757304, 1175.0243281126354, 1178.6439957409268, 1251.1873166615817, 1083.560953539656, 1093.5604793938858, 1034.0689892983162, 1125.4580491283416, 1103.3238895957543, 1046.6439629252018, 1096.087243496834, 1075.5435794376378, 1052.5089528199485, 1215.5672216017538, 1186.4479120094468, 876.7813039916902, 1186.2593568007796, 1263.4420304705652, 746.0109949971453, 1079.1566370563323, 1097.1235484125189, 1174.4263595776092, 1036.7845412752617, 877.3336875869057, 1110.6195232310574, 934.0840841692315, 1213.0405242863703, 1103.6341800124083, 990.1983248631541, 888.8510914665874, 1132.691164636014, 1082.7642152221854, 1059.7240966897955, 1134.0025325415868, 1008.7985798824068, 1043.0090183965046, 1169.723093381106, 1041.8280004825906, 1202.8467849946069, 1368.8889249160045, 1051.2575480953699, 900.7027352445464, 1053.7367134035028, 1148.6110494134723, 859.6630457789619, 1030.5343859358666, 991.2479555884864, 1227.1366937694318, 1047.00091257995, 1129.2124614107306, 974.1535443754761, 989.2338201268132, 1073.616233947633, 955.2532021717025, 922.5293726184349, 1021.9343361503808, 1078.812680108117, 1113.9605593403414, 1107.5629439187594, 1138.9510853428042, 1239.2732669305358, 1112.9672432557106, 1167.4806668480774, 1082.9851336060601, 966.8843155670769, 892.2437262981074, 1104.1881236539718, 915.023496633862, 1128.663033990058, 973.8477467783815, 1296.9364348895288, 938.5292468352379, 1084.1166503199097, 906.3599510801058, 1154.0210138456325, 1330.5092615302121, 970.8260794201244, 920.0849220850637, 985.677183524753, 844.9988688652064, 1037.7234915603226, 1143.3760722143045, 877.9129557194658, 1135.633033009125, 1090.242251481132, 1095.1366957899872, 1170.345209045577, 876.5844241212926, 943.7074945329982, 950.3659161204333, 1161.3765428225397, 1178.721692309099, 1078.2830856136238, 1253.6757176604885, 1347.812965985715, 865.8811733801041, 969.5006492727043, 1005.6889708302621, 875.0692333511897, 943.2836168267517, 1046.0960083177313, 966.1375154070943, 1274.1895200263948, 1142.1457337837, 910.1315759585904, 857.0397726687878, 950.1995941183634, 1424.3799006992022, 1056.008659156997, 1038.9525454579223, 766.1579625325155, 930.9869098703421, 1284.7849620011305, 1048.180101752444, 1322.2022694464124, 1009.6548723871214, 1141.459635383112, 1076.391656410197, 1027.3565802332505, 885.9238524943097, 1297.7669342693416, 1185.7604874636172, 1337.6247595047555, 1022.3652005026586, 1120.411981758931, 1053.7700399187436, 1248.2765365801026, 876.4617458288448, 1162.5877567442246, 966.7533634249784, 914.9617611674659, 858.8982883236722, 1205.4929851530371, 928.4822605547282, 1114.6591851666294, 1177.1279781667681, 1171.206377238623, 1258.405000982499, 1238.1308613957476, 865.7524728331447, 1036.1009472925875, 1278.8516077522781, 948.8596227084648, 1106.605464734725, 1137.144481431512, 912.5238129917864, 915.2692482644699, 825.1090920207401, 1354.3704919262404, 1069.8370697164594, 1092.7884256047334, 953.4010880660487, 1148.38649249795, 1049.2153589907616, 643.3455864140248, 1121.5407347361265, 1146.3241651678438, 1178.3019466997075, 1330.2765690940128, 943.3176608995146, 1099.9822760101629, 958.7686693015324, 1016.1024127572821, 967.315282157565, 1129.587922666443, 1281.9099181545457, 1168.3558969985968, 1172.637731830854, 1054.4884137375861, 1047.8137699675513, 1027.6760239908233, 1204.0668670235905, 1113.4090166841768, 1246.279011230683, 1232.4176200169322, 1157.4575775796518, 865.1975728380396, 957.6162978200352, 915.6764196956452, 774.3479806336245, 1091.171317221893, 1152.8928275119229, 1173.275416322765, 873.0356663508509, 1094.6108374390133, 1329.9625183274636, 943.787458274669, 1091.145482468438, 1205.0224473099597, 951.1642356270137, 1087.6123688160746, 999.8304830994891, 1238.4722573454683, 1049.2528178566627, 1000.7033131240844, 844.4119372735454, 864.2601037305187, 940.6471015410299, 1245.3176962465725, 1151.9328269130183, 1015.201131156704, 1029.1758369765662, 1042.4853331365691, 968.0733334145372, 1091.6113964885274, 1046.5171110538324, 1337.3389956876147, 916.5123261434348, 937.2504380446795, 1449.6837161785345, 979.9733705251455, 1204.3362813491146, 1096.335529449868, 1065.2928290651173, 1084.3449466920129, 1238.942011741262, 984.916577025819, 1030.967845850536, 841.9123316029197, 1013.5697623541002, 1047.9450567036552, 1109.9530547541149, 1080.2491707299089, 1003.3348682902206, 1200.313000095726, 1009.6260098889134, 785.5250696814018, 1064.991180667313, 1012.2301187538998, 953.9724776940491, 1030.8731890136391, 924.1038748759967, 1330.6710210587466, 1151.8047985308328, 1087.116681015973, 1219.9457768849861, 866.6304556150131, 1063.687718661022, 1013.5959976235639, 979.206593483472, 1066.5371459010307, 854.9764062316169, 1042.7730335058652, 1058.2888312600182, 830.673855675518, 1117.987109682555, 1225.35789319258, 959.3346855680337, 1003.8900355036288, 912.9868447197056, 1096.9634321639176, 889.4134192785664, 1030.9648087335452, 1193.9187521909992, 1132.0902000061722, 1019.5962411339376, 1030.6067842985815, 1076.44722882639, 1182.5867341062467, 1049.1428345669108, 937.2467300663191, 1219.4967754543986, 954.576287457873, 1001.5995693213479, 907.2148552731214, 1353.9642794603672, 1154.2459022676935, 1122.4439174184313, 1000.7087773665487, 1067.5220518554772, 897.2807057642452, 1023.6589340253722, 1105.0941074109555, 849.2421824834835, 1244.1467120888158, 894.2583810927314, 1072.0391370907532, 1098.8029050034563, 1119.726926273679, 837.2478307228749, 1090.391029357686, 1266.2498107153015, 912.5253036821966, 961.9339571558487, 925.1618226538728, 986.2858162232452, 1015.5932841701167, 876.3400290094592, 1027.8630415681514, 971.4471475196797, 1077.02688850342, 1068.397974301651, 1070.807881192117, 1325.2277248496807, 1124.1316707442174, 1255.2419839921267, 1354.9924851569933, 1228.7967922887237, 969.6268810358519, 834.2460507215226, 932.7246898843696, 1485.4945000208172, 908.5088507563345, 1020.8922044003538, 1066.65717143079, 1152.6076918857766, 954.0946192784417, 981.7777647394981, 1192.424245062357, 916.5273291412233, 1155.8733952542345, 846.081164062577, 1117.2938712273651, 1186.4598914258615, 1041.3048067763914, 1271.3768153175338, 1049.5480073789183, 1114.7765136756755, 1315.3292906253403, 1031.008197616081, 1077.8840718093443, 979.9884546494993, 1092.0090620732594, 806.8598046929031, 921.682856573499, 941.2364297750175, 812.9980078067399, 1144.1909653710686, 1067.2476017621193, 841.0964687854589, 1013.8397479820308, 1022.1593363979931, 973.2422447701783, 1109.3080462522566, 1121.1067551239973, 1124.1897625014763, 988.3402552326579, 1135.7647323760166, 999.3567634480559, 855.0933022576306, 796.7850892328312, 1314.284518694952, 1102.1476074802158, 1199.311511752344, 1091.0935973620592, 870.0719800954059, 1065.5398941578542, 978.5393011572982, 1247.2242943058636, 1153.8326780250225, 859.7547078766695, 867.8219538714064, 1095.1196904068645, 1018.5385836733913, 906.4536808018298, 1250.2167226718386, 984.9195991152656, 934.2071963782078, 989.8745232675054, 933.2473111363028, 829.0815141746502, 1286.4807961949844, 1066.996669544899, 920.8761657664393, 1096.1769273621462, 1284.668384602087, 958.073111079006, 1147.0378909125618, 1189.0985643223237, 1124.3894952345233, 1082.526795867785, 1065.0805610371729, 830.7276541424452, 880.6462402054041, 783.5613460252554, 1345.6364954037213, 1117.6988069049637, 1063.495560197743, 989.5678796263448, 1202.902988996429, 1246.236350404692, 1110.064163935222, 990.6659682936812, 986.5624073454167, 1118.2341979432574, 925.3043702629866, 943.2277842983003, 1014.5503363531473, 1084.346117662933, 841.0440046045707, 1172.4774556085752, 886.8503305456763, 1034.9527374221316, 892.775675416194, 828.9031427804566, 941.9522464684048, 971.8434692873581, 823.6388093971731, 1210.9345613847013, 1178.618315561426, 969.5128729727656, 1151.6357724006077, 810.2486728305615, 1318.8981982576972, 882.7953673295649, 1048.6272986390948, 1398.6970529817443, 994.2323040487594, 1230.6900280512402, 1071.2148189500988, 1030.4631915908974, 1185.2142489861826, 1041.2759646859206, 1005.4289321400182, 1311.3161673338466, 803.0899089997466, 1055.600145417874, 881.4253480508065, 1132.4596758848618, 935.4788780622488, 1213.0479677951432, 1043.3588558919378]
thresholds = [860.0358670174224, 1046.4728470949628, 1242.1383107615545]
display_name = "dFDA Simple ROI Without NPV Adjustment"
units = "ratio"

# Calculate exceedance probabilities (1 - CDF)
sorted_samples = np.sort(samples)
exceedance = 1 - np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

# Create figure
fig, ax = plt.subplots(figsize=(10, 6))

# Plot exceedance curve
ax.plot(sorted_samples, exceedance * 100, color=COLOR_BLACK, linewidth=2.5)
ax.fill_between(sorted_samples, 0, exceedance * 100, alpha=0.1, color=COLOR_BLACK)

# Annotate thresholds
for thresh in thresholds:
    exceed_pct = (np.array(samples) >= thresh).sum() / len(samples) * 100
    ax.axvline(thresh, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
    ax.axhline(exceed_pct, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.3)
    
    # Add label
    ax.annotate(f'{exceed_pct:.0f}% chance\nâ‰¥ {thresh:,.2g}',
                xy=(thresh, exceed_pct), xytext=(thresh * 1.05, exceed_pct + 5),
                fontsize=10, ha='left', weight='bold',
                bbox=dict(boxstyle='round,pad=0.3', facecolor=COLOR_WHITE, edgecolor=COLOR_BLACK, alpha=0.9))

ax.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=12)
ax.set_ylabel('Probability of Exceeding Value (%)', fontsize=12)
ax.set_title(f'Exceedance Probability: {display_name}', fontsize=14, weight='bold', pad=15)
ax.set_ylim(0, 100)
ax.set_xlim(left=min(sorted_samples) * 0.95)

clean_spines(ax)
add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from
output_path = get_figure_output_path('exceedance-dfda_roi_simple.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Exceedance: {display_name}',
    description=f'Probability of {display_name} exceeding various thresholds'
)

plt.show()
```

*This exceedance probability chart shows the likelihood that dFDA Simple ROI Without NPV Adjustment will exceed any given threshold. Higher curves indicate more favorable outcomes with greater certainty.*
