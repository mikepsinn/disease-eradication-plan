```{python}
#| echo: false
#| fig-cap: "Probability of Exceeding Threshold: Total Annual dFDA Operational Costs"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Monte Carlo samples

samples = [41722856.628074706, 31285507.56628932, 45906801.32605226, 47817601.39689085, 26265344.96799091, 29579754.705639377, 40171024.85793774, 36526184.27005749, 38945311.68851162, 32561867.80773035, 47194237.754782565, 46176789.276020125, 39642555.49416374, 49771830.53243636, 43204448.297961205, 32518369.404369786, 42299428.89296098, 31832932.073979594, 47184644.486750856, 38669951.28944808, 37568365.043926135, 33783340.17452105, 50800310.46083842, 37813208.10991143, 35660110.26254281, 36246575.7979218, 43808845.72711352, 42269458.92002762, 42700093.70850211, 42865982.51836799, 60000000.0, 35827786.62117818, 35025271.66917748, 32836594.249675762, 44601868.43416445, 49790324.0640426, 38143296.760232955, 32651767.37486656, 32761451.03797893, 44934146.69053539, 45835995.98768841, 43910828.27495152, 33895000.3312855, 41079111.09947378, 40075131.64799251, 40960681.405324176, 47113627.01479725, 41003775.25205742, 45207872.17078343, 39655708.07595197, 41583615.22021395, 44748522.108170375, 28615897.785869114, 36499379.97727997, 35340594.125424445, 34088726.63760942, 36849046.18696779, 53859686.83620213, 32472914.049572434, 48102761.45281801, 27294044.75623481, 36380680.259203784, 40472656.6652497, 44318188.402553454, 45522235.8542725, 46331110.205374524, 36273036.63118308, 35401324.60025171, 46977861.66902229, 37516572.31309351, 29747768.881408025, 30667440.92239594, 32102556.971327376, 43479961.64760114, 40296760.07021099, 45320198.50881644, 35668319.01591137, 40436134.03234435, 44693881.94218025, 36580156.284658656, 43105143.86543728, 33921004.76498562, 36161929.791771285, 36017566.47396159, 30259976.143042546, 43385095.84119867, 35347935.3383447, 39190483.7981487, 43327228.11905874, 43010587.40879582, 45076908.244650565, 38269824.63689615, 35698525.947681576, 38423968.50805978, 27274332.405500963, 28677391.45312333, 29450277.596449733, 31572786.34254714, 42581649.9912324, 32198657.087848436, 36045146.54811716, 51643445.77057971, 36214536.40939613, 45779617.65447545, 32005430.12935115, 37403194.37929859, 31893321.210572675, 36348384.29836722, 46800159.026215285, 27098644.63788716, 42899099.82231567, 41128211.67565012, 34416600.55046376, 28683856.412190445, 39694387.034996495, 34896188.20200673, 41083643.973818526, 39269128.30064187, 55109692.34368712, 37132506.919880286, 31396016.88156909, 40616199.59875042, 40972164.83030446, 52312479.02501919, 46748017.56118786, 42191858.31860284, 53495027.08079408, 30305797.9682608, 34082353.595064156, 32053675.661560804, 35955378.132085785, 29112354.759454537, 44785602.48914751, 37268990.90803869, 28532531.16388326, 31449233.455670293, 41801592.93570149, 46778263.76541876, 59663567.87470268, 60000000.0, 42715444.619998485, 31624886.202280965, 26134604.40042883, 41393267.15888077, 32842437.213696573, 35759265.0414853, 34284662.913534045, 37924632.54463663, 49121804.2030993, 40423216.53667468, 37779976.39625498, 31314495.811660457, 27330241.38684032, 35220250.47680059, 38638019.429810286, 57091164.20623424, 40191981.05909769, 48252239.44764672, 35122472.32708703, 30330557.37180816, 31790512.1213018, 33464631.00384644, 60000000.0, 32783148.09623463, 46781902.63442811, 32216238.747246567, 47725447.48960513, 42446566.51421804, 37796137.392225474, 38745928.11906345, 33972861.01464186, 43006355.799091734, 35457206.89343391, 30067999.545123797, 29733454.631866273, 40558037.11871354, 54841823.77469196, 40448715.927194566, 38104993.98726196, 41554276.01004922, 51718590.73697078, 40966772.64549927, 35793194.43715233, 49548538.9089301, 42847015.60135257, 54333813.02588834, 40650668.53149181, 30075308.32151002, 29165467.417808868, 55694515.863802746, 56571517.33351599, 37611378.08362277, 36006391.68925495, 53473682.66665869, 30840018.772828408, 32272800.839474678, 44864189.076433495, 35918484.81536045, 39042869.90885282, 37741093.8692775, 42017716.00911037, 52857697.537936, 39851648.90551292, 44870077.21789742, 26158170.943790037, 38679954.57794173, 32630302.700018864, 30111700.78306638, 32387433.12119666, 36386613.00026498, 47565271.85640542, 29427035.63953014, 39343054.13290363, 35236376.31544458, 36436899.96094251, 48459931.71639898, 43863415.5348405, 52068345.15671384, 37813400.872982524, 33674981.55311845, 37255935.48996528, 41170197.025928035, 40592688.03162374, 30989813.616547503, 39850836.71840258, 41044503.19208902, 60000000.0, 58359582.00853848, 32560478.644401908, 36752587.23402322, 28577476.180593587, 34441970.01598394, 41820332.03834899, 50618682.34077407, 33437018.46832039, 33977523.36292761, 26130270.193464555, 37747374.51535671, 31135786.663116273, 34896586.17603719, 32396383.109734464, 38304455.01858479, 26966067.911068127, 28555476.32188212, 60000000.0, 29673221.750492815, 30907760.19680485, 57891106.40422057, 60000000.0, 30417438.47012978, 36121731.086653315, 42053583.37965185, 56632699.49637676, 31643026.50475227, 37085446.65588371, 46172289.462495804, 42902248.96258073, 36060633.819593325, 37981270.98681893, 29123498.339364994, 37141905.82635664, 36918189.36741754, 41079186.51197911, 34703761.42448138, 43241782.92097487, 48563582.22959169, 40409193.88815869, 42145630.20631535, 39533356.42116545, 39086437.58248929, 33490906.73472989, 41828303.35170343, 38279652.963934734, 59954456.34975576, 54774303.76928747, 42454715.672299296, 33194838.223069772, 30804651.193111505, 50459114.965654634, 41349271.02144086, 43321625.11812308, 27023259.432343427, 47683133.69900998, 43083388.75755319, 30817702.416900966, 35331879.146915264, 41357849.608994626, 39527525.20542328, 36714928.79989638, 38228839.83352199, 37032281.972247735, 40384379.22549005, 53589173.93884791, 26017304.465885714, 37152433.61645023, 40592157.9973975, 41644927.308276236, 36093394.3181759, 26970442.521395914, 41931538.38039707, 56616309.82569964, 28150602.176449884, 47036872.32589332, 36430252.74601418, 38575652.29090224, 31199216.376621854, 36384020.91804785, 51652495.981356904, 44284304.89144537, 56676682.06567688, 50310630.719272874, 42942003.09001912, 56815669.92484897, 42941142.212608546, 46676645.43714632, 36680356.87988471, 39646930.657539584, 33664309.721260406, 48323150.02666806, 30373652.124259006, 46221958.57545754, 37521821.23931628, 50244109.4504069, 45910915.0139209, 57701401.670334056, 45713481.79742578, 27921857.184945974, 38529170.60341854, 30414573.133040074, 34980040.67971936, 54048385.28960295, 44808492.346956596, 33653458.42785819, 31461758.50477911, 39361184.46801801, 30126209.135301158, 33854184.48251485, 41788117.273354925, 50072572.37990957, 44532890.729832396, 26090132.620193414, 41719723.87600858, 39693571.19493547, 42710691.347904354, 55280759.47258701, 26154377.430149507, 34439048.08338189, 44362720.95049172, 27864907.8624567, 53640485.42965734, 42295855.25451744, 46863203.99172558, 34587961.96723745, 46534446.46818875, 49148071.48976338, 41085420.75655608, 41098831.062211536, 41416620.12786268, 32490187.623314627, 37869945.59986776, 37829464.52654232, 42432401.81957799, 48429439.278629616, 31161622.576207258, 38053036.73298986, 53703946.645491436, 33333406.50476301, 32777093.425395824, 40817137.96630737, 46841105.935432985, 39181517.92927353, 51974118.01413191, 46965952.91213409, 46815339.5200908, 44014155.51827397, 60000000.0, 37405404.11655341, 26191366.783955306, 55138999.39990717, 35436598.41840421, 39999597.05181412, 51758006.88338993, 27742129.113005012, 29901051.463850863, 27747948.816954058, 32974837.689190697, 42947065.66200926, 43732632.34750705, 41469296.761120625, 28888697.252799626, 26084994.951187186, 39543506.17618459, 35329979.13945297, 43129273.52152299, 45431797.41231685, 40260648.104131185, 46002226.976659685, 41053150.61745814, 43787769.411436245, 33612128.082202174, 37610635.437006764, 40768797.48856646, 46602017.98771878, 35925128.896798514, 43704320.2450045, 36922527.21394428, 38113941.08129476, 46691975.21845968, 26206042.15603757, 29615867.476869196, 28463223.30405651, 26078608.18157854, 33802612.55984975, 45896786.34130497, 36772260.791124694, 40777656.765302494, 49367356.62119398, 51959900.26846699, 38511144.49569274, 52249606.61729047, 39864814.82750664, 32671040.700596984, 34414756.22738089, 28473255.820572227, 32318350.93237675, 36200949.326512575, 46432960.570152774, 56536336.982523665, 29078176.841761157, 42518290.76364376, 31281761.90711448, 43271073.10445137, 38003536.28522769, 26650620.413668077, 47691916.787102245, 34336769.34792877, 34863283.11334691, 31086962.799954556, 33976528.4166058, 42839062.296606496, 37533126.55253263, 41937528.916934766, 42237559.40584457, 51881606.102973215, 36319188.39830358, 28495651.407261793, 49134899.4201689, 36407149.12737534, 49636911.16335825, 42432249.46286449, 38003122.16028903, 42118714.74558184, 59235221.225533515, 59905635.367062375, 39671021.18396411, 40450440.5291047, 49230070.63822781, 32613338.452390816, 41977172.18913956, 38869787.73738357, 41805126.23187801, 32699216.90352684, 27817472.248238813, 26151556.201784022, 30771911.451672547, 35429196.64198932, 36706907.90515373, 59075699.385572486, 49545398.68081972, 31811092.819771774, 42109079.4527156, 35822700.03906809, 36776357.176125966, 40668888.41958677, 44632403.89045134, 36346630.13871523, 49099371.48159635, 30610760.8521692, 39138843.45312483, 60000000.0, 40999243.19063752, 53150540.72989368, 39859635.213575594, 44266475.00833874, 38613193.34464342, 37684842.34178236, 33078385.11930496, 42861207.81185877, 32572365.547066536, 45078842.81492528, 49325735.66262114, 42279311.532617904, 36761517.30509886, 43079188.86344848, 36585431.61825308, 47766155.172945894, 26648481.316508777, 36375054.18293414, 26209200.597592015, 28385006.036904864, 52365004.930688605, 47354338.44339562, 33505800.157186657, 28339891.425913684, 26000000.0, 34791756.190433994, 60000000.0, 42903336.00645891, 34672244.695794985, 43181955.50235967, 27988059.86331378, 36674447.9817076, 39927648.025359176, 38371476.65938184, 46305864.880044356, 42081441.478936695, 45105345.539273426, 33729577.49082449, 47381067.50443306, 55432076.46891046, 31756308.583048295, 32321380.59775682, 52050309.841514535, 37516253.658923775, 52816172.86773344, 35551814.404828854, 53400264.506400846, 40202413.64031163, 41309233.28452293, 54672800.94404144, 36171867.17976575, 31954095.12898322, 35505963.957836464, 43064123.46528379, 27959361.244310495, 44807887.89716909, 34826953.676464915, 49992047.70798698, 26062308.34595199, 33028291.677337572, 27278155.7023175, 32749199.73332755, 41215828.41038322, 37613734.88502319, 37021180.34771257, 37775526.2557126, 40826603.281826325, 31496643.331219967, 45479525.30905088, 45050631.444095045, 42447357.82033463, 44036969.935102925, 41648711.896444745, 59779985.81594485, 38363312.04400216, 36597887.692658365, 33262591.644381158, 31337215.27585562, 29946958.7138113, 32313764.371888842, 38498423.13817433, 41988192.784422494, 39516308.628067985, 33177242.5296752, 47405154.673792936, 45798247.828401126, 37771777.16239419, 33986470.22427167, 43960505.85525054, 40691970.63930099, 28671172.04946691, 38520695.252708726, 41342949.639990725, 32238522.82571544, 40708277.7833286, 28630172.53396392, 52054799.31649839, 51078118.473937385, 37028000.45130139, 42251435.63265398, 26058139.00445991, 30516586.63764233, 36702291.95103722, 31071139.825490028, 45553193.266183235, 59667450.831711225, 30384622.99998676, 32670585.120626587, 41108057.61616849, 55220318.117327645, 30088781.296103343, 41227932.86151537, 57709000.44175164, 27450245.72658113, 29713554.141475786, 35696169.97849892, 34962760.06641761, 46522845.50455826, 41162812.394369006, 26891321.939003557, 43650412.11848371, 34539173.8442516, 51369459.28155829, 34171191.24572431, 34105236.371760726, 43891789.93689018, 46029796.098476425, 43025048.8030954, 27281999.81771439, 43862653.81648393, 31323509.710952386, 41106540.17168553, 28821047.062539857, 43008660.17590188, 32887031.228519943, 29703611.295104414, 45547563.06695421, 41162678.32890791, 34270871.44071943, 53355947.34500561, 35566150.21660408, 39355497.96804396, 41403931.28224641, 34229170.67385935, 43238054.382024765, 34866625.487027876, 35787746.036165826, 52351296.10830032, 31281480.158680867, 26057379.83749525, 55218193.44219402, 60000000.0, 35836575.70074779, 26285507.07381151, 36571248.599209845, 36761720.26080278, 37527665.20798397, 30798218.7142631, 44254935.41253245, 43735628.42064162, 28388981.15713092, 45404944.544104405, 59832660.99391022, 40552583.37356841, 36361678.31821147, 37914786.88331471, 44594957.59376321, 27083990.308080845, 40486861.107090436, 35950343.138414025, 58018723.4517428, 37654467.578297794, 55897766.65616838, 30861823.29598482, 44328042.12202446, 41854363.44294235, 32450579.65369035, 40599845.094664305, 50691147.54734273, 36467193.04458092, 27253918.308269743, 38938957.931641296, 32219712.871577457, 36322650.55533934, 38408584.992460385, 27193657.649538677, 27662813.519899134, 43339492.38720639, 34946821.63557148, 26017793.514974155, 46246687.44927518, 41434611.38216861, 33546012.339876257, 29487253.764091965, 46755003.79735431, 42123903.46919363, 60000000.0, 42768394.14523902, 42471614.243424036, 37712935.812390625, 46564522.051378466, 44689040.57018181, 51119523.47754479, 34957263.787564576, 35606106.03628634, 35274609.72321076, 46305821.174093, 53899406.90633001, 35427943.704738684, 35687252.319371805, 41806640.58719249, 37081606.00610795, 47935609.796795174, 26101001.870724946, 32745867.781906277, 33057627.124690577, 26082205.398770493, 31800566.088012427, 32132072.846190207, 37437916.544059426, 49619588.123372376, 37087171.50857988, 31346927.968488473, 38611776.17692484, 48944972.883494124, 31716873.625637926, 32163577.289119102, 44056004.2612689, 37274470.85679831, 44904208.22052844, 38971636.172938414, 45428972.19729146, 31318351.288543772, 38984679.52037198, 37361146.77441117, 30130520.184953447, 27972994.069955006, 45274189.53643567, 36255743.28797006, 31404191.381452344, 38288735.702142164, 49780137.469013356, 26093024.68762455, 28375435.56207564, 32078983.01259014, 53470635.18262339, 41525439.1331948, 46073163.847914465, 30622396.87009579, 30757755.169754643, 43022414.278836645, 39576735.4692077, 43963436.26808809, 37545775.10832245, 41485915.44248758, 40432489.9306543, 46176546.16647282, 46467067.11924488, 27637917.58029981, 26102249.02840117, 48449406.073799334, 50422113.87361393, 31415324.606853098, 26527302.809559748, 39923861.50887771, 47717924.74392282, 57433710.54233136, 43658715.35003206, 36094923.475734115, 32283823.907560337, 39181729.75026122, 36659206.46663054, 31452671.98812521, 59820892.420520656, 57289957.38225916, 49865994.57060123, 32092957.448063783, 46948077.248656586, 44828603.62632907, 42973855.787540615, 51096927.744626895, 44787717.20433985, 45804156.97657399, 44802463.15733548, 42046696.34059299, 26853915.490607034, 39792235.228074305, 34697338.98002362, 29721357.660102792, 56065255.68128382, 56636321.21708655, 52312849.9187919, 41282547.18780099, 52216406.19298436, 39186782.08737664, 40821433.50146279, 30929673.969232485, 42556256.40983643, 39594643.43549647, 29576766.20568943, 38659423.17915794, 38423875.07248283, 57433324.14926221, 47344468.83579446, 39181680.626141116, 41225734.60082692, 39457687.227272235, 37423413.34392315, 31002811.83031759, 37841381.391606495, 33315508.9995037, 29909565.952476777, 43611231.58613167, 42504049.96540766, 26840541.15998467, 38071985.40077193, 48386617.77436516, 49050638.30353114, 48700497.17111539, 39412918.18089565, 32617634.604842853, 30994381.845534973, 42081077.80001297, 42395001.90016007, 51511723.91623146, 49481500.910667285, 37994242.22192225, 29948661.319507025, 36503792.69457516, 40947890.99644089, 37430071.66845562, 34536548.07036634, 41261951.13903465, 35087439.99704799, 34167691.85450757, 41783132.22486352, 35861723.21171426, 41184382.97132923, 41442020.23359649, 30627190.02786697, 35258470.2053105, 53202632.58234392, 30479206.7504045, 26138997.863469988, 26518764.92873439, 39330232.03344755, 39345462.92233906, 38113380.371485315, 50709331.19960535, 26000000.0, 42546611.58246005, 54634305.33324814, 30703573.35293171, 36032462.4622338, 33267116.012017027, 32275431.09944963, 36447910.15571118, 53085199.76474211, 57896633.9897652, 36372469.74216807, 58693034.85660547, 39384754.706030495, 56927514.850909084, 38312363.99748469, 40198727.152225524, 42269734.42356096, 60000000.0, 46910490.555833705, 33593495.851617105, 48110187.69869907, 36171386.57606937, 35194308.5569593, 47490827.92265056, 39346881.618083715, 41489758.18080786, 39203004.33791464, 42008788.45246846, 42812214.344982795, 26285323.735125773, 45088389.24786628, 31675785.30048297, 28706909.835891534, 38599730.26094427, 39795303.839312784, 33692543.0774386, 46707129.237762734, 29327919.351959728, 35823731.43610733, 34484992.83363219, 38697615.73280841, 41492322.382081576, 31500975.86075672, 45649878.574335046, 39616844.17657793, 26391337.555043813, 26254640.40166464, 38982720.05747597, 37279011.3319725, 38229397.88519071, 38852143.32656236, 41021038.849565744, 47890339.10802838, 30813259.442412343, 30414804.65610802, 30930649.696252145, 41581808.509251304, 51045209.5797579, 35637127.30221002, 26034033.347572777, 27200952.389529176, 32701540.127459507, 34685927.12968082, 35812652.10164013, 39410114.33703982, 36561365.19161819, 48946716.203973755, 33818871.051226184, 32497328.82012345, 43309851.644546665, 28139891.648795664, 42489721.56296526, 39953968.1414203, 37870644.65720849, 54950109.14655999, 34210558.17416271, 59855489.53308915, 37243391.0120377, 29739310.659161914, 39675597.799882494, 31043826.9033287, 33275203.593134698, 42556639.49672154, 44027988.325408325, 34210849.16446379, 48300565.63477896, 50096173.704384655, 53185783.96425678, 43781655.44282198, 52360131.55296134, 26438431.7369646, 36513173.31907813, 32464758.448490433, 40096947.53331377, 34584219.65356873, 37719156.0821057, 58422420.975491986, 37690393.60017221, 42709794.419693455, 37188896.472158104, 39724876.10139335, 39136140.58892984, 43027121.34419825, 50180102.42881329, 55652257.77808825, 41766722.968610264, 44349791.609579906, 30552387.845950782, 38356882.20363764, 47814777.74912607, 47058476.21327118, 40898593.76088303, 47265118.70115477, 43420400.583498016, 50558450.187619396, 41585752.00969179, 36218922.473724715, 42002109.31583674, 26000000.0, 42427780.494885035, 26000000.0, 27115524.25863914, 43058904.63198244, 43297354.26262863, 30476930.5179006, 33558740.070695184, 52440141.79629417, 35237427.0214884, 60000000.0, 39069659.603751, 42657128.51839054, 55288652.112804875, 40198462.646743804, 31538384.35134267, 38177787.895919934, 38788709.42951509, 29186782.02171408, 37001727.54202115, 33343365.697106294, 47651629.39842583, 39376616.81024557, 36788707.411854886, 38206790.58799872, 40999614.622120194, 44609852.84873268, 31556142.002596494, 31274780.100992776, 49531428.25744197, 35782394.541098595, 28863537.96975318, 42985530.06347064, 43166124.929775156, 28169535.986500934, 41055529.01861084, 45760647.963902116, 42350556.28633171, 44755174.793766, 28941212.367084857, 41958910.308312096, 36632880.88703041, 35246781.107922204, 47104803.09807283, 53678801.62388295, 57396371.10751578, 51816451.176953845, 38177732.86551174, 42154337.07522935, 46068278.88665593, 40113721.67102294, 40196198.10420031, 46634262.947473705, 38592526.18182269, 33435565.39835954, 35766034.45745136, 44773690.21179155, 39110801.50971714, 42041456.80088745, 45122307.0414491, 36070784.411529094, 45963912.82554151, 42391027.05357673, 30008865.671980623, 53254380.44912905, 35111579.370688245, 27430684.863088585, 31251671.8138841, 31412488.351866722, 39525040.03508588, 36859239.901237436, 36365518.144767195, 44637484.64628753, 42038441.72543549, 41824301.7092536, 42673520.00026164, 44603353.20518706, 26141489.040816978, 36151213.14025182, 26120965.657524236, 39388833.979870655, 39046959.05478224, 48906744.93772745, 50421132.33946349, 40821239.05702457, 35114462.98845708, 43368251.52273181, 34907954.72818348, 39074072.22009967, 48287418.41053656, 34685611.92474446, 46453816.66533655, 45193214.171216145, 31860798.52497992, 48160753.50762146, 45398806.66416097, 39948598.69120167, 33200050.08155913, 32518970.776265495, 34835219.522487246, 43905558.25721458, 31855119.74420076, 42927512.371398866, 29964355.426383436, 37414161.28119324, 40014745.963340856, 60000000.0, 29108437.543509323, 53595187.667540446, 40360848.71627832, 42685810.916332126, 40089405.702305764, 42993954.17919654, 37820046.76412167, 53388852.58831538, 35445917.091726825, 49825194.460240826, 34048705.36334694, 38584515.17369587, 31072272.59676932, 43088961.887839474, 53286648.60307637, 38443413.167599134, 37471756.778288685, 30790125.968787182, 37212609.23721634, 27798297.85057439, 32147735.310577698, 41031819.34554186, 51863249.77227234, 60000000.0, 34472367.40409471, 53174347.38318424, 41181277.19897208, 37839794.83629338, 42882281.74097502, 39607628.820400044, 40021159.11193733, 35813077.33940431, 28979341.406634606, 28091924.301242758, 44959708.664638035, 36836756.395716935, 34402321.643584915, 39157012.90260422, 46346863.9802483, 40625672.46300406, 33963649.232409954, 50841233.15336634, 54842933.80804051, 43455694.37726539, 48158370.62458986, 51012488.748695895, 49802368.001816265, 44583889.674048066, 44433555.54675645, 43690204.94434828, 30904111.219034106, 45419810.34507038, 29242536.356433086, 32971570.197207026, 51691545.461525925, 46799275.870253004, 53772520.33884477, 36876419.02768721, 30543345.118830122, 37123907.85728199, 39949500.91414464, 39752762.49274494, 49840657.57574936, 36175739.93213883, 42148142.13446873, 31631048.781586006, 43045510.15583171, 39111767.19425925, 33289036.740883764, 37160556.5708831, 37573889.62260403, 36888417.375077926, 57130445.20651052, 38270148.26685382, 37096421.092448026, 26144503.192587554, 32276388.70556683, 36944397.21522174, 33747768.23211814, 52566010.203604236, 37729013.099504106, 51524033.85501511, 39605831.21103969, 39398690.37458827, 38349327.01743393, 39117529.523168035, 56512358.674205184, 26082407.936434187, 26194136.700815495, 34794174.04199884, 39207561.96236792, 45316496.390428856, 43256141.68520982, 35998232.37176419, 48629563.70266686, 48746063.76144412, 40657841.44999403, 48044788.12397535, 41437057.93043007, 34658068.1595904, 45391510.036284044, 40023023.2807786, 39096950.95343634, 53605994.95549693, 26047314.694544017, 28858343.22733256, 30316768.301655844, 36160328.74684812, 37011426.11056139, 28310699.535314564, 31654527.913445275, 32507593.789286885, 60000000.0, 57481775.784874275, 35786894.89520398, 36157831.00254959, 30563238.191181816, 26327033.18378209, 38119345.34301706, 31568700.015699547, 38381752.47565017, 27754306.385312974, 33202529.325496603, 40350339.932190455, 42276395.31730949, 42743495.67765435, 29464198.669466816, 46944717.808298, 32932003.410804704, 44763586.68107889, 38996756.833276674, 29114213.333987143, 36526535.32501766, 42268731.19672683, 44573051.9280827, 37923032.386659086, 54287428.45447674, 48509376.23112974, 36995214.84402778, 45903558.39839151, 59034683.20289585, 59323625.784600064, 30052612.08829449, 32053969.33130411, 53743898.47107203, 31163322.250107713, 29451275.372212, 35221108.27060696, 42768743.54064744, 38237778.56868285, 34003584.68107015, 33831935.18121313, 33557052.44130002, 32378030.739255045, 60000000.0, 41658469.892312914, 47268820.66152986, 35199376.806497835, 37559561.79505976, 33548315.4768649, 26000000.0, 29104121.986406732, 26737565.988451727, 26101553.120554343, 30263086.34050346, 51929452.76076603, 38715450.6299416, 51547481.2663354, 42684078.47578951, 46224025.5026545, 32230232.996240586, 43730411.31195377, 45693285.52809171, 34545765.356799275, 44065370.086760335, 44128219.544260494, 34746680.204786785, 30736500.748417377, 30335846.2504513, 39816833.93557276, 41922681.44902774, 32986201.54116343, 39308966.419444665, 44169389.78481127, 44623021.98267256, 54522276.755088285, 51397404.28947411, 31545485.172292702, 56086570.24684796, 34885107.20678531, 48899824.92290756, 39659170.77919551, 35783830.82568133, 26750120.072658394, 37675506.37675671, 27997482.352835126, 48092657.65384881, 54113003.51167213, 32955267.88587061, 41698305.890444376, 33463446.248243738, 34164630.78624891, 46144144.695257366, 38764392.94153232, 56766073.72697564, 35250988.94053429, 48424369.63416773, 39909994.8126025, 46355272.316785015, 35516656.31690805, 38672991.936231405, 38130624.50611758, 32680415.854902554, 45044985.67684081, 44930834.249647625, 44387920.01287303, 54347929.1210821, 53334939.99719477, 36069987.252780944, 42338447.261660054, 34200359.21940488, 39281775.70033219, 34375380.63357503, 55326615.21294274, 42253643.71225838, 37302474.54020549, 50485932.62000772, 26123669.47650784, 26176560.74515112, 46355875.30039764, 39595343.431491405, 41240394.027545534, 29427014.341418188, 38891684.86957336, 59686048.26248765, 46638729.37571208, 40533003.94738311, 35578322.829200886, 35918732.968265854, 26135416.168895524, 41304024.60784428, 46852138.78009627, 27900509.718556758, 33924700.14129063, 30509298.760315277, 31788918.05107323, 39536119.931691416, 26148259.248507332, 44585526.95841395, 45940327.48985717, 37039219.58067562, 26039497.871510852, 31578379.655645374, 50913404.79603984, 26000000.0, 36282370.0446062, 30362631.66583202, 46442774.51920626, 33825409.22391009, 42619818.418453656, 44121338.327088796, 57883073.41738957, 37423189.275999084, 42365608.94691495, 28445768.997981027, 50451216.436841585, 33212942.846491173, 34663475.18936166, 38899899.41066598, 27976542.75140277, 41049268.06204386, 48094381.20472416, 41617623.51091677, 27821454.834220212, 38062815.906466454, 45823952.59143495, 26450319.37981733, 31053648.813006856, 47165349.006260335, 41414420.67329917, 42693128.49483534, 58155539.93202255, 43214113.72299921, 45004496.29241714, 60000000.0, 37336236.340693764, 32948416.78066191, 42838198.7023287, 42941122.61160211, 34916938.755543694, 31336314.853115078, 60000000.0, 41921186.34591951, 33414120.410958916, 47565555.124918215, 38182549.64265316, 37025113.54765649, 44091194.30765765, 29644943.776373208, 42153497.173817106, 58786694.82687354, 43192116.013166726, 36060201.23483354, 35063808.62597979, 35797694.64950199, 37016542.21473333, 36047894.050858684, 47569444.52289298, 27072901.290896673, 47018431.83004652, 36033388.07657075, 42373813.560925975, 30708779.46765329, 51970441.50167052, 51052743.6620393, 48013183.9763038, 28265785.404611643, 46687989.528229356, 42628051.16331067, 27724281.071152, 38882824.42615072, 42261218.86836335, 44032644.19175633, 40598672.852714784, 41602441.89290981, 53613567.30459196, 50838406.41147859, 26000000.0, 36516832.22468854, 37731330.13539784, 26990546.887890767, 39882382.45342191, 51086975.55991164, 30975370.72132805, 42007148.094933, 32127486.09624361, 33848593.97392211, 53657126.65731741, 34798739.56360922, 43155416.74370553, 26478996.02155622, 58188685.25068621, 44474594.34044313, 37587377.52351152, 44216857.39558437, 28906897.191866726, 50365933.159841426, 36465685.582375415, 37414153.824941866, 35179956.974770196, 34516173.12211238, 45360893.630004205, 41288682.47637623, 44945280.657627665, 39012163.96627878, 43629729.57390222, 35732546.754540995, 60000000.0, 27946390.720237847, 51220707.491410226, 52410501.20521543, 32568034.20907285, 60000000.0, 48384426.21072192, 48132293.57315336, 39321068.04193011, 37308889.32450659, 37371398.69862558, 42497362.60682295, 52786300.22759867, 40633945.67680751, 32157600.71060828, 46641004.75637376, 47618855.93699931, 44973349.58057418, 45858068.194561265, 36882312.09137988, 32037133.5229566, 32456507.469394524, 27545994.348157246, 41121275.950000174, 38393277.95236824, 35571211.50555031, 26000000.0, 29928743.999692366, 49703512.210235305, 33901410.799426585, 42225518.741834246, 29025367.18995264, 53213240.568872854, 37898351.52227319, 41591824.00129745, 60000000.0, 54108906.90725676, 36601943.889516905, 34423449.75136835, 36453505.867969714, 43598858.16647758, 38214629.25833644, 35913571.308730006, 53539594.36078119, 38141152.85928029, 60000000.0, 39852995.02888849, 57291690.3053858, 42195913.2293548, 48047911.509418264, 33469035.16520063, 32556885.401234817, 43132233.972397715, 48312464.99127153, 39424261.9119158, 29679751.850217503, 29214767.23214197, 28800097.355476405, 26923122.260501117, 40013353.71455902, 49748366.46616327, 38973564.70822738, 26098616.607604742, 37520942.14893504, 37746298.729578316, 59963009.131999, 28616007.30865465, 35948698.79444268, 56355466.78187576, 43042382.66299928, 44101029.01225826, 40057092.514817774, 41949049.53403087, 46174982.74722647, 32866721.316620518, 47180679.66777171, 29135284.283376202, 41934886.13234663, 40611546.51828975, 34253887.120639615, 38896254.15691828, 34208122.38014905, 31074008.52637404, 36235083.01781875, 30860186.997438278, 41884849.17901317, 30557477.7096236, 45529562.80042852, 30353035.692267705, 34622392.72636481, 34193020.917630956, 51931582.58457476, 41952164.17318564, 37352796.58701107, 43494493.53690068, 26141707.176864807, 38726254.39315508, 59668273.38938065, 40209828.20052593, 39658546.64851858, 43957682.67408668, 47358607.906384714, 26199856.977803312, 27296444.8042088, 40887040.38564856, 33538822.489649754, 51785508.55215539, 36534539.312424295, 26288789.937974103, 29796604.908470616, 26000000.0, 37174117.28019003, 37540041.49430427, 35689628.50471413, 49257955.91407141, 50539068.953195214, 37684996.95741454, 26133850.4370904, 44614323.84694574, 44025894.03819801, 41764677.480312385, 48239199.31167735, 30461298.410363857, 59701619.381955124, 31829220.34626951, 45894709.65358113, 27274273.886770196, 32028393.583014816, 54108076.67225369, 36961596.37393805, 46796288.891057245, 41121335.67199063, 38216806.329731934, 52364871.096188396, 37153956.69860639, 26866333.18202204, 32910672.831910007, 43986563.41470677, 42542737.88978133, 27951599.876320433, 33470958.329937648, 34508270.04516831, 36143231.62695154, 29117162.8591258, 34165461.54296128, 33440405.31744072, 46114844.43231701, 46488132.184835896, 37883883.90823471, 35938216.693512104, 40275168.009722725, 32816912.74086426, 30578743.81535257, 31960253.388781454, 34118392.03486622, 30470120.9772771, 40466642.88877874, 45703100.35631462, 27832153.914217703, 39296701.99533527, 37287246.96454278, 42053160.960174784, 38977547.385768, 28637658.65833016, 29832457.741106853, 39332874.64706105, 48731271.33148143, 26111442.90034766, 42091195.9093853, 50442646.10076485, 37825386.74955586, 43977235.00593069, 33623667.99847661, 38099054.09198266, 27631767.324281164, 26075706.84855601, 47840187.11099269, 31655632.244161204, 35453075.318960436, 29051705.402722917, 28905968.685095735, 37657169.40897753, 33433488.858443342, 42383108.069486514, 43066011.10202337, 41867367.1513907, 41135837.916122325, 54826243.302498296, 31101317.45754695, 38628483.747245066, 49830062.550522804, 51260330.47172385, 28833190.412573457, 36556597.216232486, 52300503.16234114, 43581857.59068209, 40755581.31304067, 37305226.03173777, 36001661.976633824, 41575592.177236505, 37029135.964846194, 38730858.3022605, 39749440.983852424, 33804008.00738499, 43807156.86701184, 60000000.0, 26882559.4517767, 41895758.29418095, 33215208.146267843, 44234457.73490125, 39477515.668947406, 46019217.02472086, 50290061.963031255, 40730769.70474329, 49823245.386321574, 26075719.115175813, 54975797.03595213, 42356690.49048138, 49247009.8679806, 30104859.724438105, 32717403.18642052, 40327099.83197335, 38943336.7863488, 41529725.38862335, 49317566.5737931, 26933539.172216304, 48159977.96216855, 39155136.35432679, 37416458.6435635, 28530647.229502067, 43534881.03206183, 26057027.440283004, 44912965.089729324, 28402938.24190585, 39535919.07124931, 38100664.595396236, 50225684.74733276, 37618338.40815212, 33687983.97697465, 35067580.898067296, 51352211.53761349, 43846317.38122678, 35987567.182307556, 37155646.64909019, 27950890.025237817, 42478634.3778927, 26956999.743773915, 45920048.500028454, 40177749.19848308, 60000000.0, 30885625.820276253, 38235605.156870194, 57441740.93847027, 50461786.61204588, 33673040.03924905, 41007043.035267234, 39102474.934658825, 41519822.91881702, 33655258.75052395, 38345023.507344425, 27767081.09088522, 40233760.07376722, 43042773.26402569, 37227539.63502856, 27666404.429340858, 48312243.37712584, 42261133.25771388, 33458981.524037726, 36806004.58639307, 28351002.109666206, 31383176.407364193, 34834110.30674291, 50864458.60433834, 34084163.52990411, 44834249.12590003, 34830346.393434696, 41218316.28314894, 37919721.96601515, 47130081.626982905, 34856485.05613573, 27918945.561527867, 29079621.934988815, 34878380.3412358, 29917596.063777555, 42677028.69608667, 35375444.47487751, 60000000.0, 27053227.224102803, 40828746.20588515, 30702442.37027728, 35166813.46650605, 40288072.701945126, 26080843.41695886, 41120196.51343265, 58667522.488971114, 35468937.03172559, 41323214.53168108, 48690935.1858224, 37736967.03165583, 34513892.11259764, 26094398.19380278, 44841720.458496705, 38149661.74521212, 31468713.84744908, 40160321.70705173, 34493804.7101286, 34904155.60380404, 44509308.06497244, 29351707.722135548, 48925459.76320564, 28981964.85471666, 33915376.13569878, 58905458.06812621, 49773043.44736542, 39911624.4458897, 31958140.955029853, 34897834.47082071, 39704132.44045921, 39401183.71692811, 38332291.08701649, 38828431.10388718, 37331674.825025246, 28708875.813899215, 34993288.955167785, 47552227.7145658, 29164375.78459593, 37530625.48236895, 32794601.808341306, 40029346.30377029, 35964436.43341645, 53657127.01223364, 43567882.37184149, 29518960.41265774, 45133424.25338414, 33112590.439849034, 34543184.48342258, 41804327.09748983, 35179265.656519845, 47330683.3233878, 33113595.0342603, 34234440.84361285, 33961352.88219199, 34627255.38344897, 49473133.29691634, 44724617.09581809, 56405015.3006468, 60000000.0, 31347576.203600522, 39679844.2579786, 30387315.510688104, 33091668.26913058, 34152950.640286244, 31170828.85463055, 31205964.58454135, 37896267.87901072, 30125189.680757817, 46818421.47050786, 32114224.577429406, 60000000.0, 35484534.71834479, 39693435.714466296, 29623030.177335463, 56358360.99135563, 49689221.58145993, 41653156.167046726, 29298922.448070392, 40890331.27954805, 30745292.41693704, 53484143.31702977, 46488864.300042264, 39893116.00806901, 26051133.808997698, 31666324.826302536, 45293729.44619396, 50695117.31929939, 49579182.974837445, 27802939.091326885, 41694566.584190525, 48592760.74414902, 27411700.146817148, 39019603.86495675, 41447690.33387608, 36647435.23533311, 26559936.512399916, 36452310.95121338, 36439768.381703414, 37865535.95580265, 34643321.64810735, 35548188.60380076, 38754695.46580735, 42973017.30575732, 36618710.05277674, 35802990.925588496, 39866756.928088866, 26308196.30789321, 43292767.20386686, 39081016.50845568, 39419507.35033907, 48024967.53876087, 26262821.193604685, 26233102.988972757, 41447347.88110331, 39026188.16490709, 40537089.670664236, 35403027.57633747, 45066939.004385725, 47736361.583779864, 43357292.9640606, 36962161.20067518, 26141564.697512235, 46092130.516408145, 50791450.191874355, 44876039.46694777, 32377110.928639874, 45158270.37610412, 47003604.29922931, 54603550.81099346, 32401587.253054876, 37235232.013150156, 45875510.87764588, 39569408.2391172, 30772283.321299486, 42717338.68472296, 44246400.87519644, 39829268.07535338, 40968549.753617756, 36978964.49754875, 53667327.65393634, 32231645.122584175, 34466940.12864967, 39177820.395898335, 47189743.44773248, 28370981.696407653, 29528468.385123335, 26161795.291336052, 39360451.97957564, 30765846.825811137, 35995888.05315617, 45038192.1709414, 34069291.62668285, 41071371.24947156, 36658631.86621287, 45142003.337957904, 43275071.230403125, 33703882.07801878, 37699015.637587175, 48887975.79188956, 42523298.22826092, 28986451.046943024, 44982594.73746762, 30988338.7264265, 52914825.67311479, 48682339.179573365, 41590443.09226169, 40424812.681046635, 37374412.51849186, 45204095.12971841, 36102176.84832591, 41109127.98883517, 47118737.06631974, 34655668.439800255, 34254622.7544722, 30269515.789851565, 31122083.611930385, 26661358.88006239, 45704209.100299194, 57565001.083208814, 53060627.98264851, 27601252.863426276, 45655478.90225847, 53023927.461182564, 35443346.18585327, 39944503.7478826, 26185246.04973279, 41384616.2918793, 31128161.13364003, 40793781.10455186, 27986597.11582287, 43908041.23191439, 48686662.15680197, 33052227.21658892, 30643609.70164811, 26127794.18179695, 36917983.48341508, 34509211.090035796, 28047569.009652384, 43070445.86909651, 35495277.70470993, 31047207.95313814, 34709368.41841113, 49177958.2408704, 44477307.49677603, 38012169.80094308, 44631771.30180172, 30486817.1480473, 39357710.57417137, 40339060.78112518, 35344650.313247696, 42908616.004742354, 33071654.820787385, 43598133.3832695, 43992854.71652372, 26000000.0, 50450048.53389396, 26000000.0, 34255676.325736396, 48695389.5958304, 36518019.34995621, 28560721.063211173, 30927916.62345589, 48711668.05429774, 26307356.077912994, 49790525.034218095, 38627100.05291662, 30282269.797302682, 34497978.15046374, 31438168.82925593, 47061066.19644092, 45729691.902716324, 27134369.337386984, 35849445.04667409, 32491296.977669306, 51580091.946482636, 29278282.529281918, 55138700.30535468, 38807957.34750903, 30480152.48246725, 33809776.30121116, 32922090.424042344, 29754561.52956433, 39887883.99058319, 30053153.95969081, 26120921.709181853, 36033465.63961413, 26770936.497924738, 33272320.061405618, 32173706.582420327, 32435527.012846816, 59678496.24810714, 39560944.57735135, 41195563.49103189, 26885105.43003383, 33978856.23969991, 40930971.76535127, 31389091.785250966, 47485341.780690625, 30215643.149928372, 36760593.1907725, 34476303.29826243, 40486253.46450311, 34076967.29907686, 36882584.58055631, 37158163.587223284, 33399092.40468184, 43367626.33212764, 41133965.43382063, 38350826.11764703, 35643849.85389449, 46362889.2605841, 37160517.725169994, 36600912.02963433, 39972264.29787418, 56243410.38881292, 29339325.535576966, 46098266.91893696, 26386169.927041832, 40948259.21832419, 54794633.56800184, 43400873.70560734, 40540982.41330867, 34665735.80723064, 39346558.04418685, 37031604.47442765, 33032455.33511038, 36732979.66076342, 40782821.96539355, 33165306.20597612, 32889262.347088978, 29214860.463997375, 42499133.769169375, 43931253.25159152, 41074702.04233752, 48070697.93810083, 39828455.20448595, 42510849.67925224, 41714991.42156221, 38326798.055825144, 34886262.16593217, 60000000.0]
thresholds = [29507446.137738973, 38976105.75877675, 51441149.85506209]
display_name = "Total Annual dFDA Operational Costs"
units = "USD/year"

# Calculate exceedance probabilities (1 - CDF)

sorted_samples = np.sort(samples)
exceedance = 1 - np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

# Create figure

fig, ax = plt.subplots(figsize=(10, 6))

# Plot exceedance curve

ax.plot(sorted_samples, exceedance * 100, color=COLOR_BLACK, linewidth=2.5)
ax.fill_between(sorted_samples, 0, exceedance * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Annotate thresholds

for thresh in thresholds:
    exceed_pct = (np.array(samples) >= thresh).sum() / len(samples) * 100
    ax.axvline(thresh, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
    ax.axhline(exceed_pct, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.3)

    # Add label with formatted threshold value (use format_parameter_value for full units)
    ax.annotate(f'{exceed_pct:.0f}% chance\nâ‰¥ {format_parameter_value(thresh, units)}',
                xy=(thresh, exceed_pct), xytext=(thresh * 1.05, exceed_pct + 5),
                fontsize=10, ha='left', weight='bold',
                bbox=dict(boxstyle='round,pad=0.3', facecolor=COLOR_WHITE, edgecolor=COLOR_BLACK, alpha=0.9))

ax.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=12)
ax.set_ylabel('Probability of Exceeding Value (%)', fontsize=12)
ax.set_title(f'Exceedance Probability: {display_name}', fontsize=14, weight='bold', pad=15)
ax.set_ylim(0, 100)
ax.set_xlim(left=min(sorted_samples) * 0.95)

clean_spines(ax)
add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from

output_path = get_figure_output_path('exceedance-dfda_annual_opex.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Exceedance: {display_name}',
    description=f'Probability of {display_name} exceeding various thresholds'
)

plt.show()
```

*This exceedance probability chart shows the likelihood that Total Annual dFDA Operational Costs will exceed any given threshold. Higher curves indicate more favorable outcomes with greater certainty.*
