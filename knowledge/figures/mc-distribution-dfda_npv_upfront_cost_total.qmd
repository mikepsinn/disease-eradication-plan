```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Decentralized Framework for Drug Assessment Total NPV Upfront Costs (10,000 simulations)"

import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Simulation results

samples = [281634264.35156935, 208379683.31365275, 311224804.23967063, 324775769.22426033, 175000000.0, 196497461.69956112, 270689232.775918, 245051969.21426088, 262056556.29868725, 217288878.9922177, 320352573.4003252, 313138140.0590948, 266965881.5059028, 338657249.47967935, 292099464.97747844, 216985006.61698318, 285705099.39427626, 212198943.07225168, 320284520.8191321, 260118726.70848286, 252372139.06430393, 225828787.77641273, 345971670.95490104, 254093123.753511, 238975356.61550245, 243089495.91996497, 296372850.14870125, 285493443.0206053, 288535293.47311366, 289707407.58137035, 415000000.0, 240151343.98755208, 234525059.08382964, 219208465.9202806, 301983539.86113054, 338788720.26999784, 256414024.30518696, 217916956.2487311, 218683352.6463757, 304335639.1597449, 310723099.9762759, 297094154.0284831, 226610114.4273026, 277091879.7370333, 270013462.9720411, 276256534.77941597, 319780755.4721802, 276560486.1813772, 306273790.5164244, 267058523.84341738, 280651507.0098661, 303021570.48351693, 189796090.87054938, 244863812.13895562, 236735090.9499836, 227965944.19928378, 247318801.09930664, 367763989.08601457, 216667481.6663786, 326799951.5658201, 180443577.54400104, 244030649.45817274, 272815296.46009195, 299976015.14130396, 308500272.4254742, 314231976.25153404, 243275188.2378911, 237160833.62370634, 318817783.57092375, 252008151.10865656, 197666572.97858313, 204070980.92484203, 214081082.7648229, 294047179.26962364, 271575402.89611936, 307069270.4832411, 239032922.8140184, 272557830.48987746, 302634805.3085491, 245430851.9518024, 291397565.99050426, 226792092.43741268, 242495519.59482986, 241482629.89985982, 201232454.3291027, 293376477.9753399, 236786553.8932197, 263782414.248111, 292967382.4622918, 290729287.66082984, 305346422.72524726, 257303880.86446112, 239244762.20686537, 258388122.1529616, 180263319.25371605, 190223350.02256295, 195596700.65410197, 210383613.51971596, 287698523.9330728, 214752079.92483872, 241676125.64167866, 351972355.0480871, 242864662.931564, 310323643.31081164, 213403003.10001984, 251211428.6703105, 212620436.14798892, 243803981.1410442, 317557523.4765067, 178656933.32049623, 289941425.40288913, 277438240.09033746, 230261367.52648982, 190268270.96502697, 267330972.68170512, 233620578.69935012, 277123854.3730725, 264336116.76653832, 376682213.6545652, 249309676.38789472, 209150455.59839222, 273827293.4713981, 276337528.8926073, 356736712.8904036, 317187774.8328352, 284945434.2591938, 365163838.5049579, 201551582.57705423, 227921336.10966137, 213739812.7581039, 241046352.83996704, 193246600.68137702, 303284051.31249875, 250268491.87415192, 189216920.96819606, 209521667.76741463, 282190039.83759177, 317402256.48359096, 411574847.215839, 415000000.0, 288643750.0232737, 210747122.26820606, 175000000.0, 279308260.0927806, 219249299.65232998, 239670744.46375334, 229337570.09345782, 254876471.42059112, 334037448.83789754, 272466771.00805366, 253859513.20736986, 208581857.24073482, 180774585.76176703, 235891528.70843136, 259894045.2888124, 390984378.8084095, 270836922.2280599, 327861200.02347267, 235206230.6010034, 201724029.1643258, 211902888.27793413, 223599262.6346486, 415000000.0, 218834970.08675283, 317428060.7802882, 214874849.0309943, 324121726.76680374, 286744315.4135238, 253973119.86009255, 260653351.56787413, 227154997.94449496, 290699382.132412, 237552615.75864112, 199895648.67855188, 197566957.56310135, 273417222.4214924, 374770414.10238963, 272646525.3653425, 256144669.2175539, 280444449.82580817, 352507359.9884263, 276299496.98495513, 239908715.07895553, 337070020.3535503, 289573384.39326704, 371145713.5110681, 274070325.9818593, 199946535.80105355, 193615898.1101055, 380857416.3238418, 387121779.3256983, 252674441.10100678, 241404231.82410264, 365011667.10260105, 205273697.39579487, 215269829.68847838, 303840371.1664932, 240787545.7662307, 262743251.44432408, 253586189.68704176, 283715806.3118507, 360621144.9527276, 268438814.419487, 303882055.3162519, 175000000.0, 260189114.19815102, 217766988.10166186, 200199925.00553402, 216070411.98860747, 244072289.1505113, 322985035.6564001, 195435026.27915806, 264856638.8435118, 236004557.5895989, 244425245.88752598, 329335971.14434445, 296758803.92195815, 354997890.6815862, 254094478.85400444, 225070666.98152712, 250176769.76569098, 277734422.3794107, 273661523.68237865, 206317868.4220225, 268433092.45013294, 276847762.31070596, 415000000.0, 400653855.2968365, 217279174.27055508, 246641470.40252706, 189529156.8363552, 230439015.8256594, 282322319.73839885, 344679521.2523863, 223406141.50445786, 227187627.58998722, 175000000.0, 253630338.5040661, 207335605.37977862, 233623367.06532758, 216132923.01023158, 257547453.75148022, 177516624.21522334, 189376319.79265282, 415000000.0, 197147808.66225737, 205745874.13263193, 397081234.16008246, 415000000.0, 202329194.1163044, 242213458.30468088, 283969050.68387043, 387558942.53630114, 210873695.91561976, 248979106.61539102, 313106247.3172551, 289963678.65304315, 241784783.64391693, 255274693.47531295, 193324080.6753007, 249375700.08367735, 247804366.98200673, 277092411.69134367, 232272515.67916262, 292363368.8372911, 330072062.57080185, 272367922.31050456, 284618994.88305277, 266196769.11336946, 263049939.52414435, 223783040.42853385, 282378590.21928257, 257373007.5036653, 415000000.0, 374288576.4162481, 286801876.2797314, 221712629.53130138, 205027192.95981738, 343544469.95858943, 278997824.40003645, 292927773.2617885, 177967754.58175126, 323821430.7740599, 291243806.33773273, 205118155.78626984, 236673998.29550436, 279058353.6468736, 266155701.0755958, 246377054.5276816, 257015625.92150664, 248605677.9730739, 272193001.8140659, 365835071.3175112, 175000000.0, 249449654.57602072, 273657786.68803173, 281084227.4071805, 242014636.24454433, 177550311.5690488, 283107378.5758159, 387441832.0579096, 186564492.09756285, 319236327.3241468, 244378588.9050619, 259455234.94524994, 207777906.18188322, 244054096.25934392, 352036787.6318212, 299736265.7543382, 387873221.42621714, 342488384.93406165, 290244605.0323416, 388885712.45317775, 290238521.4466571, 316681683.5559273, 246134320.3152565, 266996698.5363787, 224996008.06935397, 328364689.8188202, 202024193.79469752, 313458287.5651405, 252045038.46230724, 342015296.842185, 311253953.49419403, 395634970.24799836, 309855077.1364152, 184976638.3114968, 259128212.47669002, 202309234.61118865, 234208112.24787372, 369109748.1719577, 303446086.1081952, 224920094.6857288, 209609040.11375383, 264984303.2195776, 200300945.718625, 226324498.54965633, 282094916.2230071, 340795469.4544097, 301495356.02241427, 175000000.0, 281612152.10122836, 267325225.91264212, 288610167.2550556, 377903325.3015257, 175000000.0, 230418554.87213078, 300291125.1804272, 184581406.3722082, 366200923.2111548, 285679861.03323185, 318004613.8404239, 231461423.05396876, 315673460.5642308, 334224085.8020888, 277136387.736217, 277230984.27906656, 279473043.5756388, 216788142.70106417, 254491993.62907362, 254207405.35318285, 286644265.40416044, 329119436.0215706, 207515756.78975958, 255779310.1784045, 366653422.02132046, 222681542.8922648, 218792660.067971, 275244182.6311098, 317847900.26311445, 263719292.2850166, 354326852.5876981, 318733321.1267667, 317665175.41486603, 297825038.14247584, 415000000.0, 251226955.8432052, 175000000.0, 376891402.7395071, 237408129.91396365, 269481209.34435457, 352788001.0338745, 183729432.43975168, 198733421.97152865, 183769812.28170362, 220174666.47646582, 290280380.9473544, 295833851.4397819, 279844755.0005726, 191691805.80830216, 175000000.0, 266268252.3191023, 236660679.18401733, 291568112.0537599, 307859677.8923155, 271320877.45365715, 311901009.71770376, 276908758.77124935, 296223789.73547214, 224630965.64842045, 252669221.54848427, 274903290.21417916, 316152542.51873314, 240834153.26128027, 295633631.4073684, 247834831.26611775, 256207586.51276743, 316790382.5901756, 175000000.0, 196748725.22544625, 188735476.29836246, 175000000.0, 225963635.90997776, 311153839.32121825, 246779611.29360092, 274965763.7437403, 335782328.16094816, 354225605.1821652, 259001393.96886754, 356288878.77706933, 268531570.81155276, 218051617.55241725, 230248452.9688063, 188805163.71631092, 215587933.36729002, 242769319.53102177, 314953978.4553008, 386870414.5453422, 193008973.58524504, 287250948.8640622, 208353560.386921, 292570416.19482327, 255431246.41385406, 175087477.9516738, 323883762.4360367, 229702389.74588355, 233390037.03447813, 206995178.48462155, 227180664.39946535, 289517185.82377034, 252124488.40804136, 283149671.0620602, 285268166.4198237, 353668076.52819383, 243599077.73640704, 188960730.74428, 334130493.79050076, 244216426.735492, 337698164.8162019, 286643189.26478684, 255428334.56209478, 284428938.3516944, 407375382.1624924, 415000000.0, 267166385.79167855, 272658682.87143487, 334806740.07233834, 217648466.22639948, 283429554.1456291, 261525005.26297024, 282214981.2981997, 218248488.638054, 184252226.72724417, 175000000.0, 204799014.7225027, 237356236.97903252, 246320737.87323415, 406117936.52748924, 337047700.6321478, 212046521.7676639, 284360902.441493, 240115666.18573993, 246808375.07439828, 274198793.6380636, 302199661.73998183, 243791669.85970944, 333878060.77481544, 203676033.22635013, 263418861.45330286, 415000000.0, 276528519.83102745, 362708175.4333225, 268495079.3085413, 299610109.93162274, 259719367.37187466, 253190791.98091024, 220898484.2852072, 289673668.53412545, 217362216.96606416, 305360120.8047595, 335486547.87136185, 285563024.2641604, 246704173.88163874, 291214122.90259826, 245467885.96403524, 324410634.5061967, 175071005.585524, 243991162.3927123, 175000000.0, 188192203.2218178, 357110866.2476439, 321488375.3726689, 223887210.74313247, 187878880.2490259, 175000000.0, 232888932.13754675, 415000000.0, 289971360.2124559, 232051752.21608284, 291940476.6791125, 185436132.75316805, 246092834.07961297, 268974259.84956026, 258018876.5273699, 314053025.7660885, 284165751.0633935, 305547780.60057867, 225452629.46623302, 321678014.3617603, 378983580.62070805, 211664189.17959383, 215609092.01453263, 354869448.5445961, 252005911.74152422, 360325244.5898339, 238215953.2300991, 364488263.0674589, 270910447.3358474, 278715330.8476016, 373564273.9075588, 242565249.04261804, 213044648.98224187, 237894465.09695077, 291107646.719426, 185236937.8412307, 303441807.231228, 233135514.0753971, 340222903.2225479, 175000000.0, 220548308.88499698, 180298280.82305118, 218597743.30668294, 278056339.3663205, 252691005.46614867, 248527702.99325082, 253828230.49090183, 275310933.06970346, 209852397.76628697, 308197738.2150175, 305160367.38016087, 286749904.7153724, 297986425.0713676, 281110938.6311541, 414608521.6005245, 257961445.70620182, 245555331.25193235, 222186361.68817803, 208740316.10039803, 199052982.59854224, 215555901.7995422, 258911897.28044513, 283507361.9085281, 266076705.7599158, 221589607.04381227, 321848913.18244994, 310455641.23950845, 253801875.97591016, 227250243.1117507, 297445539.1296965, 274361548.7810356, 190180135.70065543, 259068585.8031626, 278953221.9953557, 215030458.23349774, 274476534.4425311, 189895268.5785992, 354901421.08149624, 347948425.4318769, 248575605.54662225, 285366160.4504146, 175000000.0, 203019894.55401322, 246288328.36787948, 206884856.85426852, 308719562.1281768, 411627074.995857, 202100611.3076243, 218048434.41008514, 277296069.29544395, 377471865.6912252, 200040342.33963755, 278141735.4240478, 395692896.63902736, 181704678.24548033, 197428469.90588003, 239228239.66768098, 234087026.44033864, 315591212.5733367, 277682327.19001275, 176941031.73054913, 295252413.73523766, 231119731.10378867, 350021933.07095075, 228543186.50987017, 228081505.65630415, 296959494.17593294, 312096380.65210813, 290831489.77744436, 180333432.91818967, 296753416.41153204, 208644724.8738013, 277285365.05210036, 191221624.94956216, 290715667.5528712, 219560956.37782687, 197359279.05024636, 308679679.64038587, 277681381.42320174, 229241013.92894349, 364172336.2034669, 238316474.7454651, 264944261.58770674, 279383507.9278973, 228949070.54577142, 292337012.8352684, 233413454.16375074, 239870500.99198258, 357013213.9111794, 208351595.42608815, 175000000.0, 377456699.07149017, 415000000.0, 240212991.9795803, 175000000.0, 245368318.52834353, 246705598.96486664, 252086107.78810543, 204982361.25699735, 299528462.30746233, 295855039.643477, 188219811.63430122, 307669483.300233, 414894862.8359154, 273378772.3590449, 243897283.83985138, 254807249.5811596, 301934627.5943344, 178522957.34882706, 272915433.1231937, 241011031.64388326, 398054297.6537158, 252977294.85353905, 382308880.1349591, 205425676.2325463, 300045738.4510038, 282562554.66793054, 216511473.3094842, 273711984.5900095, 345195035.4610822, 244637878.3539252, 180076648.15291578, 262011835.78364378, 214899108.46102116, 243623375.57597804, 258279907.07725805, 179525636.4810365, 183179139.98666382, 293054082.7752244, 233975347.56932586, 175000000.0, 313633564.33679676, 279599996.2627237, 224168479.92074212, 195853923.4090119, 317237315.08034605, 284465576.7889351, 415000000.0, 289017858.7586999, 286921239.298185, 253388260.78538018, 315886692.9338017, 302600537.0454955, 348243081.18952996, 234048514.36460614, 238596650.54884136, 236272551.0127622, 314052715.9616032, 368047249.10286397, 237347452.83646214, 239165700.05477607, 282225671.12572277, 248952129.152349, 325613382.3122042, 175000000.0, 218574460.61928838, 220753373.97144377, 175000000.0, 211973054.8079552, 214287161.6018786, 251455415.4960559, 337575030.2040617, 248991222.35040352, 208808059.5998995, 259709396.2295611, 332781113.2967099, 211388994.66089612, 214507133.39190447, 298121074.61234945, 250306992.18434703, 304123684.6220431, 262241842.72321957, 307839667.12973785, 208608747.25256616, 262333651.0024768, 250915979.79289702, 200330963.67698175, 185331561.14089787, 306743431.4877681, 243153829.32705504, 209207475.0810583, 257436890.76508746, 338716303.37345266, 175000000.0, 188125734.06049657, 213916495.94394585, 364989940.7750003, 280240943.61848795, 312403719.4738547, 203757110.6607123, 204700356.3146927, 290812870.8629424, 266502286.54624438, 297466267.3627559, 252213379.38849282, 279962028.3493822, 272532141.9521081, 313136417.0000343, 315195769.0371332, 183006425.69825798, 175000000.0, 329261225.06563276, 343281290.3643839, 209285133.53638142, 175000000.0, 268947581.2712927, 324068337.9433878, 393594585.61177194, 295311129.7689279, 242025365.2572615, 215346808.6584266, 263720783.55096406, 245985825.0435988, 209545654.16497454, 414830867.631521, 392499084.05903935, 339326683.344561, 214014060.94669315, 318606540.22460365, 303588454.4208874, 290469702.84603775, 348082279.08775204, 303299021.0089312, 310497509.0057289, 303403405.8098067, 283920423.52128994, 176652978.0113194, 268020249.60748202, 232227528.0604894, 197482774.17653483, 383505116.45139277, 387584821.2983403, 356739354.794497, 278527048.4571023, 356052403.97797066, 263756353.20466417, 275274475.1353487, 205898628.7021134, 287519138.2092684, 266628415.88156387, 196476669.06028765, 260044647.1571611, 258387464.87659335, 393591640.82596004, 321418352.9612629, 263720437.70641616, 278126226.7719734, 265663866.1577166, 251353502.799441, 206408484.86634454, 254291181.46782967, 222556388.30222535, 198792689.7938825, 294975355.99821186, 287150354.37819755, 176549987.096335, 255912553.223603, 328815358.067116, 333531813.82435226, 331044483.44574964, 265348598.40569282, 217678481.3429086, 206349715.43440557, 284163183.1660969, 286380103.7311606, 351034617.88161767, 336593548.3307856, 255365897.04444465, 199064834.84882465, 244894787.52733427, 276166323.4326819, 251400290.04985836, 231101341.83696136, 278381737.4984827, 234960718.7813925, 228518690.00382912, 282059727.4854147, 240389384.07796708, 277834498.79388714, 279652276.409003, 203790508.80218145, 236159421.1196801, 363079470.6692817, 202759482.08441615, 175000000.0, 175000000.0, 264766353.76251212, 264873600.1442883, 256203643.50007367, 345324397.75577474, 175000000.0, 287451006.21774966, 373289591.31090647, 204322768.53879112, 241587136.11419368, 222217997.53156695, 215288197.8586368, 244502527.52407175, 362242464.84222525, 397123378.93222696, 243973023.3741427, 403197711.1772223, 265150276.18350738, 389737662.13651156, 257603082.85541764, 270884466.1943017, 285495388.6760917, 415000000.0, 318339967.6623716, 224500627.59613326, 326852672.5386898, 242561876.68631947, 235709701.7049868, 322456794.4415625, 264883589.7984885, 279989145.7441609, 263870562.98178464, 283652773.97407806, 289327479.5914177, 175000000.0, 305427716.4220796, 211102277.64039442, 190428458.27188122, 259624642.19852012, 268041867.10902008, 225193527.55875593, 316897836.7611035, 194745620.59013796, 240122900.49188703, 230740293.30598772, 260313387.6036865, 280007240.82956904, 209882622.4278788, 309404480.28158927, 266784783.33882633, 175000000.0, 175000000.0, 262319858.83956102, 250338892.24146324, 257019550.73313245, 261400826.8969062, 276682254.2181198, 325292045.1981641, 205087189.5010124, 202310847.36291373, 205905430.31999207, 280638756.23866254, 347714238.4161751, 238814185.06748468, 175000000.0, 179592336.13778827, 218264721.649584, 232147591.76129323, 240045189.55695045, 265328853.9698675, 245298936.11630493, 332793498.19986415, 226077398.45840532, 216838026.87045103, 292844543.9223195, 186490131.58896863, 287049142.4602931, 269159705.8060023, 254496908.2222786, 375543211.29236424, 228818770.8986464, 415000000.0, 250088638.5743856, 197607710.45387003, 267198622.7358215, 206694430.12898204, 222274548.96893007, 287521844.3850166, 297922889.6468666, 228820807.99779958, 328204329.55461794, 340963292.3397983, 362959377.1529913, 296180549.76896894, 357076151.4995909, 175000000.0, 244960636.01785398, 216610513.3170183, 270167196.0322526, 231435212.71201605, 253431983.8417883, 401133184.5608282, 253229811.25272834, 288603830.3043531, 249705801.66770858, 267545740.8415925, 263399833.5848047, 290846137.0335872, 341560113.2559668, 380555667.1044776, 281943898.12803286, 300199636.49978304, 203269321.66217124, 257916217.8431744, 324755728.24115974, 319389562.0915676, 275818638.5625432, 320855404.8468451, 293626075.5518215, 344251054.8272674, 280666587.3227639, 242895441.18010056, 283605616.7937096, 175000000.0, 286611623.7262649, 175000000.0, 178811256.62689862, 291070762.4557882, 292756198.1196218, 202743624.8158836, 224257508.59489283, 357646108.24183774, 236011922.25088, 415000000.0, 262931831.7970752, 288231746.2572976, 377959668.1549266, 270882602.05143434, 210143599.46793786, 256656584.54896665, 260954409.15447402, 193764108.7057674, 248391073.79020977, 222751187.2676789, 323597855.4166696, 265092971.64558533, 246895096.11680278, 256860554.12325853, 276531139.67288244, 302040050.8551776, 210267488.7547388, 208304868.32140422, 336948404.08643043, 239832966.82180533, 191516938.79427952, 290552204.75179434, 291828581.7263103, 186695947.77117744, 276925535.42382294, 310189242.0804005, 286066189.55551505, 303068662.1886661, 192056827.75169963, 283300623.19495213, 245801000.34551445, 236077487.78557068, 319718164.7918897, 366474127.42608654, 393310018.4977776, 353204137.1987396, 256656197.5382678, 284680477.23727196, 312369100.11753064, 270285403.04217994, 270866642.36189336, 316381169.10288674]  # Truncate for embedding
baseline = 269750000.0
mean = 268927278.98458594
std = 58051427.61895985
p5 = 180798442.14940408
p50 = 262270007.48005697
p95 = 380158645.2341758
display_name = "Decentralized Framework for Drug Assessment Total NPV Upfront Costs"
units = "USD"

# Create figure with two subplots

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---

# Handle edge case where all samples are identical (zero variance)

if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax1.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key statistics with formatted values in legend (use format_parameter_value for full units)

ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {format_parameter_value(p50, units)}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {format_parameter_value(p5, units)}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {format_parameter_value(p95, units)}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {format_parameter_value(baseline, units)}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---

sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax2.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key percentiles

ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"

exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title

fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark

add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from

output_path = get_figure_output_path('mc-distribution-dfda_npv_upfront_cost_total.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Simulation Results Summary: Decentralized Framework for Drug Assessment Total NPV Upfront Costs**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | $270M |
| Mean (expected value) | $269M |
| Median (50th percentile) | $262M |
| Standard Deviation | $58.1M |
| 90% Confidence Interval | [$181M, $380M] |

*The histogram shows the distribution of Decentralized Framework for Drug Assessment Total NPV Upfront Costs across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
