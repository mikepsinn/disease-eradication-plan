```{python}
#| echo: false
#| fig-cap: "Probability of Exceeding Threshold: Cost per Life Saved by Medical Research"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Monte Carlo samples

samples = [15865.343680995364, 17642.407072130325, 15316.718899219184, 15088.530821075003, 18352.506733156493, 18011.431726618703, 16088.4570321523, 16662.55217000535, 16273.238825116783, 17383.92586897033, 15161.574209865097, 15283.691310777078, 16167.161740925532, 14867.77632053383, 15662.731865343916, 17392.504198849285, 15785.336260051252, 17529.799764277155, 15162.708668921809, 16315.853993033848, 16490.606770302704, 17149.293956543468, 14756.327315468125, 16451.161050272647, 16810.66152409412, 16709.835882960582, 15582.803578365454, 15789.457970100922, 15730.616673997956, 15708.167253349713, 13500.0, 16781.60279036713, 16922.407762368224, 17330.108998715983, 15480.202381864137, 14865.744410645926, 16398.53458369965, 17366.246634047962, 17344.767263125967, 15437.955302732438, 15325.424758548188, 15569.466458083007, 17128.4283403796, 15956.48921725289, 16102.632223771065, 15973.471393963659, 15171.116772297792, 15967.284160281873, 15403.474371698927, 16165.18544467163, 15884.893668431716, 15461.503098516621, 18233.17107983613, 16667.063345154296, 16866.558457606836, 17092.45075512961, 16608.569791365975, 14442.353753622041, 17401.485350347044, 15055.552011901409, 18561.013859533316, 16687.09549488559, 16044.17082797569, 15516.614580293452, 15364.226885504379, 15264.932318538698, 16705.339701855824, 16855.880713343056, 15187.239315245744, 16498.996244052247, 17973.79621942633, 17772.851064624527, 17475.311762044756, 15626.107171233756, 16069.940901839824, 15389.407730319805, 16809.234552317997, 16049.508956801954, 15468.460203437375, 16653.482460305924, 15676.011523776178, 17123.582542810276, 16724.249180598705, 16748.93840683317, 17860.843165796312, 15638.681799710712, 16865.26637077777, 16235.64305703913, 15646.370857029991, 15688.695426838158, 15419.935831381375, 16378.527931806886, 16803.98740755238, 16354.277255359553, 18567.55775543203, 18218.71874421977, 18040.636187945714, 17582.977620561873, 15746.718989341478, 17456.043092016374, 16744.211110212782, 14667.25243981087, 16715.28601214649, 15332.369987891398, 17494.867130044295, 16517.417146064432, 17517.540763948906, 16692.56143595856, 15208.439145799233, 18626.268537831093, 15703.699859874068, 15949.468200289113, 17032.196782690706, 18217.201817973862, 16159.378797702038, 16945.470775571437, 15955.84056631562, 16223.651850819444, 14321.042481494613, 16561.70905741818, 17619.45741528281, 16023.254706501542, 15971.82177700213, 14597.982132453311, 15214.680616265341, 15800.14893290221, 14478.475174331561, 17850.866756197134, 17093.62983566944, 17485.143255477265, 16759.615953253007, 18117.696847947154, 15456.788460559432, 16539.321195458768, 18252.832438778016, 17608.445461900756, 15854.328508011737, 15211.058900532205, 13664.857684482768, 13500.0, 15728.534229659743, 17572.27940460173, 18017.49919743882, 15911.7654040028, 17328.97114026555, 16793.4550944042, 17056.347830905583, 16433.32605915548, 14939.86219355903, 16051.398559447856, 16456.494241738794, 17636.376250798938, 18549.020344785185, 16887.792282843533, 16320.822827577882, 14134.403774912198, 16085.36542810195, 15038.372084524972, 16905.11822985522, 17845.484730721993, 17538.430173806017, 17209.376047325804, 13500.0, 17340.53004765097, 15210.623395198358, 17452.526424087497, 15099.246325525717, 15765.158844453763, 16453.89983843405, 16304.054097393328, 17113.934632317538, 15689.263956102823, 16846.07763040593, 17902.867815670284, 17976.991226668593, 16031.717482040414, 14346.71818810139, 16047.669244921712, 16404.60905158597, 15889.02448770347, 14659.410713050269, 15972.5962959033, 16787.582361715384, 14892.391930045442, 15710.72795451688, 14395.888924344385, 16018.247261386316, 17901.26113066138, 18105.503584468137, 14265.57775952511, 14183.887076693229, 16483.651533153323, 16750.855212324503, 14480.599934448977, 17736.066468788285, 17441.2308183328, 15446.814183593167, 16765.96243983739, 16258.239912637717, 16462.742504579383, 15824.239129754891, 14542.426207466278, 16135.849917603775, 15446.067823567255, 18168.264181633225, 16314.298568209051, 17370.461685198152, 17893.268985179482, 17418.421781960253, 16686.092131980942, 15117.939175374024, 18045.89728590466, 16212.41020627617, 16884.94119850171, 16677.59648204008, 15014.622572402246, 15575.661716990982, 14623.117346849882, 16451.13013350661, 17169.633566138666, 16541.457830510502, 15943.473747850709, 16026.673685021105, 17704.366960346957, 16135.971105408393, 15961.44483113094, 13500.0, 13964.165394249609, 17384.19958234215, 16624.62930739178, 18242.222702792136, 17027.567530569813, 15851.711120752412, 14775.782299603217, 17214.618535741534, 17113.068190498634, 18000.0, 16461.73263079969, 17673.678460481264, 16945.399490219017, 17416.645628698374, 16373.06801660185, 18671.04030283164, 18247.413124804312, 13500.0, 17990.458721165927, 17721.70487355751, 14057.630368192556, 13500.0, 17826.646863101796, 16731.11037915383, 15819.266151969414, 14178.253132251804, 17568.560155983614, 16569.454756731888, 15284.239594123086, 15703.275300328134, 16741.558733197937, 16424.28792440572, 18115.136039267265, 16560.163699511082, 16597.093647728027, 15956.478424974122, 16980.070001181855, 15657.75008403153, 15002.82249046104, 16053.450767204431, 15806.530603394667, 16183.604818549466, 16251.558325589813, 17204.392888179016, 15850.598215361768, 16376.977681748866, 13500.0, 14353.21733538049, 15764.044139240337, 17260.855377745254, 17743.581875574215, 14792.953656862124, 15918.000605400619, 15647.116094673698, 18651.676637695145, 15104.176042239937, 15678.926384563672, 17740.807183722984, 16868.092813001047, 15916.784118400758, 16184.484633996617, 16630.914835591353, 16384.998491877508, 16578.22147573837, 16057.084783132308, 14469.117085465883, 18000.0, 16558.43337060184, 16026.750792341145, 15876.274153181643, 16735.953274796113, 18669.556481752476, 15836.211488470637, 14179.761550016468, 18343.928913958858, 15180.22375794708, 16678.718559442394, 16330.543931854925, 17660.40502759743, 16686.530484980995, 14666.307177271809, 15520.98518613306, 14174.208176724269, 14808.999555547838, 15697.91942815517, 14161.20694941101, 15698.035337541522, 15223.239589074945, 16636.693012638527, 16166.50423230681, 17171.641609357128, 15030.247710913178, 17836.131503487406, 15278.191690211192, 16498.145288619173, 14816.209295708766, 15316.21366916, 14075.6970305768, 15340.532255126232, 18399.30719248317, 16337.803062031193, 17827.266954226216, 16930.475736740114, 14423.79398121593, 15453.880776581462, 17173.684319059703, 17605.85741725728, 16209.65762638452, 17890.086512888014, 17136.04449834815, 15856.21172139982, 14834.861642575665, 15489.026753693108, 18000.0, 15865.782543049618, 16159.501194641747, 15729.178929819614, 14304.735000303664, 18144.119499650078, 17028.10046634574, 15510.877349984456, 18413.191575194378, 14464.02629656885, 15785.82752435276, 15200.90526027105, 17001.01878777417, 15240.345929293175, 14936.923841550335, 15955.586336892702, 15953.668022687807, 15908.4594877654, 17398.070369209167, 16442.07042324209, 16448.55448780575, 15767.097102348078, 15018.100591279363, 17668.267495455195, 16412.862436014933, 14457.739347620722, 17234.343449773503, 17341.712075152693, 15994.145530626394, 15203.544394519244, 16237.012217237741, 14632.862054448777, 15188.65657309947, 15206.623798321762, 15555.996868817525, 13500.0, 16517.057388585137, 18254.729708765582, 14318.243761720829, 16849.690370776396, 16113.830849240228, 14655.303717489056, 18443.258659776104, 17939.714960157053, 18441.829349084772, 17303.26192728267, 15697.237863123135, 15592.798564597688, 15901.011833585626, 18169.380664864002, 18000.0, 16182.073846494268, 16868.427396654813, 15672.780875190067, 15375.47960020062, 16075.250709273858, 15305.015031414121, 15960.206040777037, 15585.565232766074, 17181.472889341505, 16483.77152673955, 16001.1303951026, 15232.208215717868, 16764.818845157377, 15596.51765502064, 16596.37465315922, 16403.189372839628, 15221.399718319388, 18274.17732485026, 18003.317607251192, 18269.238446725518, 18000.0, 17145.68580909803, 15317.949168201769, 16621.349138599573, 15999.849438389925, 14912.477819956364, 14634.334523702653, 16340.6214756856, 14604.4398214548, 16133.885882148785, 17362.465149602944, 17032.533505656258, 18266.86022670153, 17432.15412675513, 16717.599276072033, 15252.598576389382, 14187.130446275803, 18125.559399293215, 15755.357938162972, 17643.18689396005, 15653.845860522497, 16420.739994228526, 18578.26854770418, 15103.15228448453, 17046.79454450253, 16951.36862846341, 17683.920818597297, 17113.253075672284, 15711.802184942564, 16496.313028492837, 15835.378149599634, 15793.84946547826, 14642.453044631891, 16697.508460781915, 18261.5554851956, 14938.397045982374, 16682.620738314316, 14882.63158707212, 15767.117955260723, 16420.80595809229, 15810.250650126107, 13778.233601008815, 13500.0, 16162.885645441707, 16047.417136739266, 14927.765004143148, 17373.79568124653, 15829.867529722966, 16284.885665103637, 15853.834870807697, 17356.94241546677, 18424.7863460663, 18126.13253942637, 17750.54947506993, 16850.9886347786, 16632.2547404588, 13812.593956346009, 14892.739195463442, 17534.241018458015, 15811.583160808132, 16782.481553687216, 16620.66645277755, 16015.602741941111, 15476.30194961822, 16692.858510655446, 14942.373308959679, 17784.99450848788, 16243.534866291351, 13500.0, 15967.934433599463, 14512.910735931031, 16134.658448111344, 15523.286895619094, 16324.689856573854, 16471.79758787076, 17283.25412812556, 15708.811734034765, 17381.857969587254, 15419.692187740415, 14917.106249592536, 15788.102516632474, 16623.14009879964, 15679.489341081297, 16652.596956497484, 15094.509397062824, 18577.32266597562, 16688.04720174362, 18278.359524369407, 18287.819595574354, 14592.595321533723, 15142.68807920067, 17201.57075797697, 18298.56902074943, 18000.0, 16964.215458704584, 13500.0, 15703.128757630486, 16985.76202031946, 15665.73607287695, 18383.215736439022, 16637.681346100646, 16124.524974720645, 16362.520479491428, 15267.995213025513, 15815.407676667402, 15416.355829336859, 17159.3743177629, 15139.543564986192, 14290.367994270671, 17545.400490710595, 17431.55103488293, 14624.980631016613, 16499.04790951125, 14546.629657707143, 16829.529595546534, 14487.917365120726, 16083.827168163149, 15923.682753928651, 14363.008261901707, 16722.55466436482, 17505.235863990474, 16837.541833606683, 15681.509338133917, 18390.18488329879, 15453.957533183006, 16957.88915998892, 14843.647956029467, 18000.0, 17292.922579664428, 18566.287856651263, 17347.161525138716, 15936.968263835079, 16483.27075309854, 16580.05429088682, 16457.208912605987, 15992.779190393265, 17598.656651792844, 15369.537267454396, 15423.246609297043, 15765.050590543575, 15553.028676358117, 15875.742671758204, 13570.492775072533, 16363.80403021504, 16650.50680919778, 17247.87329199135, 17631.65497834884, 17929.554584460107, 17433.06728568028, 16342.611575068397, 15828.336881692303, 16186.177496531305, 17264.2328165891, 15136.711943020284, 15330.073641555195, 16457.811088623483, 17111.40598118745, 15562.985124837758, 16012.25482067492, 18220.178498112997, 16339.127971989034, 15918.897231409182, 17448.07297616288, 16009.891153325869, 18229.81239892797, 14624.516726480608, 14726.75442426733, 16578.928240949852, 15791.938612974787, 18000.0, 17805.23948362909, 16633.02602653969, 17687.24494229413, 15360.382102457444, 13663.460826745126, 17833.75331586053, 17362.554500331677, 15952.348684802806, 14310.488814108556, 17898.30078075947, 15935.244243359579, 14074.9716977932, 18515.478720739255, 17981.436628397227, 16804.396435340557, 16933.561917805193, 15241.744681236336, 15944.527477871527, 18684.350671105938, 15603.608222451152, 17009.873760262635, 14695.977666189507, 17077.22123418045, 17089.39768935764, 15571.953025729084, 15301.639920513795, 15686.75307648943, 18565.01137383565, 15575.761323278908, 17634.502531933646, 15952.56564161243, 18185.122196535056, 15688.95434672793, 17320.296072261768, 17983.65921207635, 15361.081082565794, 15944.546610383408, 17058.87972878737, 14492.34106153594, 16827.02736981737, 16210.520773178325, 15910.255440500494, 17066.543872430866, 15658.24733920493, 16950.76919753268, 16788.524891936933, 14594.000517284707, 17643.24555734491, 18000.0, 14310.691233599568, 13500.0, 16780.08478420025, 18379.04414713592, 16654.978080213583, 16623.106259011405, 16497.19805764426, 17744.95001673914, 15524.777254254734, 15592.405192897775, 18286.873574079316, 15378.826676480376, 13527.367162995446, 16032.511870788258, 16690.310676005272, 16434.89908519158, 15481.085644626995, 18631.19744787522, 16042.096503958333, 16760.48155812603, 14037.595749044582, 16476.69489857822, 14246.488645172807, 17731.439041923095, 15515.3444199392, 15846.961902146593, 17405.904562689153, 16025.632638913243, 14768.008739461988, 16672.486448727326, 18574.34380770574, 16274.217464846144, 17451.831845344084, 16696.92153847266, 16356.691448736352, 18594.43045386856, 18462.77969126232, 15644.74008766406, 16936.410257157342, 18000.0, 15275.183938953896, 15905.91434036182, 17193.959632970225, 18032.2779534871, 15213.843789989449, 15809.533250464681, 13500.0, 15721.359197963582, 15761.733559092268, 16467.27292154814, 15236.721887254991, 15469.077199439029, 14722.365768605488, 16934.543949834875, 16820.06065164453, 16878.188615987212, 15268.000517651013, 14438.439591840723, 16851.208435627213, 16805.94499683623, 15853.62331762953, 16570.087490303904, 15074.850403391803, 18000.0, 17347.8128987865, 17287.258147383865, 18000.0, 17536.38324508709, 17469.38520766131, 16511.767563282858, 14884.542959583358, 16569.170622643007, 17629.638046379023, 16324.910704562815, 14959.699577103609, 17553.44975057148, 17463.06762576407, 15550.55389804125, 16538.42466005341, 15441.744150607125, 16269.18652610713, 15375.831621070254, 17635.574722139583, 16267.180073940339, 16524.268307101676, 17889.141271292556, 18386.873072928964, 15395.163634528819, 16708.27764698349, 17617.76422002834, 16375.545522390687, 14866.863497486456, 18000.0, 18290.09797934984, 17480.050616143308, 14480.90339574396, 15893.088492822795, 15296.336308598573, 17782.49902189287, 17753.56534428499, 15687.106859905189, 16177.065375762377, 15562.603114540605, 16494.263967985946, 15898.66491163481, 16050.041940741501, 15283.720930774442, 15248.476700755706, 18468.92293622128, 18000.0, 15015.822804666903, 14796.946086436697, 17615.459155383334, 18523.64794755676, 16125.088516966807, 15100.12231436195, 14101.338117898602, 15602.515308914975, 16735.691800574867, 17439.03265334797, 16236.979865499616, 16640.23168253727, 17607.734818403635, 13536.97699933476, 14115.179468191844, 14857.441188087343, 17477.240886857835, 15190.784878988119, 15451.327739439199, 15693.63299547541, 14724.76016010469, 15456.519743940047, 15329.345551180597, 15454.646462424667, 15820.22058082059, 18667.91056619408, 16144.724111067719, 16981.229337354685, 17979.692978283583, 14230.829834706283, 14177.91988939968, 14597.944069250028, 15927.474249894023, 14607.854184169168, 16236.208285767738, 15993.525406150457, 17717.06829137215, 15750.17924653467, 16174.368603969766, 18012.103818642092, 16317.491621178235, 16354.291914544132, 14101.375254456345, 15143.84979676866, 16236.987368278964, 15935.557286878236, 16195.035703821659, 16514.126476471472, 17701.626230802758, 16446.64471016761, 17237.75919788463, 17937.82887830969, 15608.76922474964, 15757.302090561992, 18662.028497912044, 16409.85065406014, 15022.989972615154, 14947.83393518346, 14987.288418107342, 16201.812902793119, 17372.951129599554, 17703.40354923117, 15815.458025236168, 15772.21908536845, 14681.036162678507, 14899.811979271984, 16422.22063652377, 17929.178169326686, 16666.320369330737, 15975.309510969251, 16513.043358662315, 17010.350822449214, 15930.402792865058, 16911.341995691615, 17077.866471963138, 15856.908589788765, 16775.74425950289, 15941.450252135195, 15904.866683110242, 17781.471450004105, 16881.037863355097, 14507.683858014108, 17813.29903035384, 18045.746262187728, 18519.85940892067, 16214.357934165695, 16212.044399032104, 16403.278329912086, 14766.060522995234, 18000.0, 15751.494243669136, 14366.728075310033, 17765.125969230743, 16746.384577205656, 17247.007684119268, 17440.706211215525, 16675.738535124015, 14519.476994705703, 14057.105234634259, 16688.484453547953, 13893.13776149021, 16206.081757727648, 14150.302679219734, 16371.822019265146, 16084.370669540278, 15789.420062346446, 13500.0, 15195.263650647159, 17184.988384603526, 15054.696759830571, 16722.63660181828, 16892.38264374571, 15126.656445376962, 16211.828965319837, 15898.122416897764, 16233.731791030561, 15825.477835045342, 15715.430489331466, 18378.80304857587, 15418.490101505078, 17561.851153216867, 18211.79643348911, 16326.788361382809, 16144.26532831547, 17166.33104380705, 15219.581758908143, 18068.397828772613, 16782.30335456285, 17019.72772838974, 16311.55376218924, 15897.76045680122, 17597.763117269544, 15348.397290542931, 16171.027709437289, 18463.20897156575, 18338.398159221048, 16267.48143825917, 16537.681962613482, 16384.910324232893, 16287.611165459524, 15964.808034697806, 15080.093038346613, 17741.751579061587, 17827.21684704819, 17716.861949249254, 15885.147928751163, 14730.246040090075, 16814.659181431147, 18000.0, 18591.994534861642, 17356.487339505886, 16983.290056015434, 16784.217950722857, 16202.237704912508, 16656.638112769197, 14959.503526075983, 17142.644119312507, 17396.65928638642, 15648.682479732941, 18346.508052276582, 15759.259107306381, 16120.609817514309, 16441.958535360398, 14336.318106856477, 17069.9687945345, 13508.767246509069, 16543.511816467148, 17975.68387822062, 16162.198543408218, 17692.988383952084, 17245.46076121811, 15750.12702408613, 15554.196945751655, 17069.915229114984, 15032.833471415983, 14832.290105952268, 14509.373671993842, 15586.366695449879, 14593.094799522903, 18484.169007906563, 16664.741350065215, 17403.098579599042, 16099.403243040082, 17001.697403381804, 16466.27172706601, 13950.719651147296, 16470.903147764304, 15729.300593879545, 16552.445611481453, 16154.807135710882, 16243.948319416542, 15686.474781274857, 14823.15894008564, 14269.558629446723, 15859.20327576374, 15512.542250165516, 17797.53304808016, 16364.81512334473, 15088.858728235859, 15177.658378971802, 15982.401441343201, 15153.201949388214, 15633.997679150765, 14782.255240944647, 15884.592975434687, 16714.539519313737, 15826.404807202402, 18000.0, 15767.729664313374, 18000.0, 18620.59726327412, 15682.209315895365, 15650.345817201101, 17813.79025248604, 17191.55321865215, 14584.902541387759, 16884.75549363227, 13500.0, 16254.13020130539, 15736.450642490518, 14303.984286108447, 16084.409668395112, 17590.05507386987, 16393.07178398674, 16297.42377029414, 18100.618905336203, 16583.267662930986, 17232.443825606868, 15107.850322017639, 16207.316034631278, 16618.608848993215, 16388.48351206792, 15967.88113581266, 15479.182141790983, 17586.400501500513, 17644.64080359005, 14894.284496386637, 16789.45085044456, 18175.22904971341, 15692.063076997652, 15667.851744296791, 18339.372879042767, 15959.865384923556, 15334.70950411542, 15778.314077527639, 15460.656837785094, 18157.195857979917, 15832.405135779883, 16644.640134690006, 16883.102560769592, 15172.162696268748, 14460.229181289096, 14104.928520741752, 14649.22198081974, 16393.080494443035, 15805.327906939556, 15296.933366385128, 16096.922137363066, 16084.743568425412, 15228.330637576459, 16327.911682336198, 17214.894579162323, 16792.282785261694, 15458.302478447302, 16247.826312393552, 15820.946837780224, 15414.22200521795, 16739.821175421035, 15309.710210515732, 15772.763812850879, 17915.886988012186, 14502.498459584416, 16907.052532771777, 18520.356398356445, 17649.456121915686, 17616.04627748683, 16184.859651459985, 16606.876012815388, 16689.660780328864, 15475.653317850925, 15821.364816346126, 15851.156863415337, 15734.223994604496, 15480.01264037304, 18061.734108805416, 16726.077294556195, 18000.0, 16205.463185161552, 16257.612360497631, 14964.00104661346, 14797.052049143651, 15993.553475161076, 16906.540397641886, 15640.918498322777, 16943.363620509295, 16253.45364951748, 15034.339505859614, 16983.34698804467, 15250.077562152159, 15405.313541202851, 17524.13889845911, 15048.87811456392, 15379.592114999625, 16121.408243209942, 17259.85545060507, 17392.385494520615, 16956.40475535767, 15570.154618411269, 17525.29194828927, 15699.870898930225, 17925.709874454515, 16515.63196115583, 16111.582567082394, 13500.0, 18118.59734963517, 14468.520096101869, 16060.533578500888, 15732.555146616332, 16100.51924001233, 15690.930593740206, 16450.064348974913, 14489.05600901168, 16848.056415562976, 14861.915974433672, 17099.860149673976, 16329.161165342835, 17687.0068899017, 15678.179475131861, 14499.268533498962, 16351.227633506798, 16506.26841114499, 17746.67184324118, 16548.555945771073, 18429.480905392564, 17466.243350602792, 15963.262510359633, 14644.358897867207, 13500.0, 17022.026992265863, 14510.521111078653, 15941.893180236053, 16446.898921214957, 15705.967959456817, 16172.41417617624, 16110.631130861075, 16784.14445125074, 18148.36803101225, 18358.075383018822, 15434.72306732132, 16610.612709663827, 17034.80436896792, 16240.756531886158, 15263.022151481586, 16021.877961689097, 17115.647013333284, 14751.957108798957, 14346.611433640412, 15629.320245355933, 15049.152125994062, 14733.720773385348, 14864.421684606434, 15482.500608961473, 15501.767871050595, 15598.373085578434, 17722.477374752132, 15376.973392075428, 18087.864842212482, 17303.89469056598, 14662.231207316436, 15208.544782244971, 14450.95739254175, 16604.02300232906, 17799.47837837324, 16563.123377428954, 16121.274074279158, 16150.62995510888, 14860.219451374198, 16721.89445888647, 15806.183590873972, 17571.015581286556, 15684.006388802898, 16247.678456851989, 17242.816074839073, 16557.09875726528, 16489.71282909709, 16602.031470326834, 14130.597395312037, 16378.476876008575, 16567.647253640305, 18081.050578996637, 17440.515230643214, 16592.75148751541, 17155.961128145213, 14572.049592927846, 16464.685638612624, 14679.745965634536, 16172.68468143802, 16203.968945761017, 16366.003475286636, 16246.796293569072, 14189.342660817, 18000.0, 18258.40231754877, 16963.780599072816, 16233.03627610815, 15389.870582529064, 15655.835683747306, 16752.255293311264, 14995.32886592796, 14982.131848094778, 16017.205955982748, 15062.234825125195, 15905.568354860352, 16988.324669032518, 15380.50224308815, 16110.354607499461, 16249.947517892293, 14467.447476417674, 18000.0, 18176.437464265542, 17848.48135562971, 16724.522249560203, 16581.665284308576, 18305.537111533362, 17566.203578469518, 17394.631701312635, 13500.0, 14096.72135769406, 16788.67215041556, 16724.94828984645, 17795.199896909726, 18432.821958597935, 16402.33207457901, 17583.817736853474, 16360.905563071346, 18440.268411257308, 17259.379868212698, 16062.074712856025, 15788.503663840305, 15724.731591715912, 18037.487720729627, 15191.184983911458, 17311.563818030543, 15459.587043951671, 16265.323049838993, 18117.269651437316, 16662.493117513222, 15789.558102416027, 15483.88661534431, 16433.58167566982, 14400.410011284997, 15008.989240912502, 16584.344002604666, 15317.117229180209, 13821.178261291636, 13754.667089798653, 17906.252191254378, 17485.084128105584, 14453.786655292623, 17667.911739377574, 18040.41045728814, 16887.640577746242, 15721.31189302862, 16383.586457064079, 17108.228017028265, 17140.201498532744, 17191.872224151914, 17420.288441857392, 13500.0, 15874.372632674054, 15152.765158707092, 16891.485463155648, 16492.031612378043, 17193.524088965685, 18000.0, 18119.589616353966, 18616.66781311354, 18000.0, 17860.165350412957, 14637.489702679986, 16308.783702634104, 14677.289629431698, 15732.79033559196, 15277.94020690055, 17449.729194200783, 15593.090201078616, 15343.02804974723, 17008.676405049144, 15549.336725153673, 15541.178072295757, 16972.330165661206, 17758.096998014775, 17844.335855185167, 16141.047769138397, 15837.44386944031, 17301.061942287517, 16217.590192335812, 15535.842315595077, 15477.499952465021, 14377.573885732443, 14693.038221901628, 17588.59336609038, 14228.841716867644, 16947.4560595892, 14964.780192089513, 16164.66529166253, 16789.202314282065, 18622.204733860726, 16473.302243381484, 18380.929732315115, 15056.715919110215, 14417.458811789253, 17307.052990223347, 15868.784168271424, 17209.600861592276, 17078.43096382485, 15287.67058398418, 16301.191149884906, 14166.000358700752, 16882.3592039921, 15018.67913550433, 16127.15290699065, 15262.002994535722, 16835.672101071297, 16315.381140202728, 16400.5433573633, 17360.626825900243, 15423.958301417697, 15438.374336131083, 15507.634405703704, 14394.514087129606, 14494.439760548305, 16739.957607094828, 15779.976158609468, 17071.846611701476, 16221.726540942276, 17039.728342511517, 14300.375456462389, 15791.634624748855, 16533.846006644522, 14790.062539366798, 18000.0, 18235.083082261583, 15261.929917920794, 16174.263225218954, 15933.470143792745, 18045.902109612678, 16281.50562078486, 13648.127382095798, 15227.7938235228, 16035.365008000166, 16824.903806217757, 16765.91972195181, 18022.723224814345, 15924.422525371267, 15202.226546134607, 18404.50718514604, 17122.89434258705, 17806.809769650445, 17538.754798997506, 16183.187921674527, 18105.079321016827, 15482.29126194006, 15312.603135839112, 16577.076499813604, 18000.0, 17581.827922470962, 14744.261549381252, 18000.0, 16703.754860280067, 17838.52162996022, 15251.412105439158, 17141.421504669863, 15741.523304264176, 15542.07056165128, 14058.393650596288, 16514.162930486968, 15776.248865151896, 18273.378762159206, 14793.805572530322, 17257.38282219645, 16987.347086798825, 16280.23829842633, 18386.01135929425, 15960.76219338159, 15056.517350859851, 15880.110479925792, 18423.811829203274, 16411.307834920593, 15326.90739344813, 18489.45546121446, 17690.922203308033, 15164.991431456678, 15908.77073973549, 15731.561887226588, 14008.020533401706, 15661.441582069981, 15429.065895905167, 13500.0, 16528.332175074593, 17308.380918822524, 15711.918844697748, 15698.03797667762, 16941.755414587573, 17631.842003178237, 13500.0, 15837.651938072406, 17218.970459146716, 15117.906040913418, 16392.31813908102, 16579.404855422028, 15545.982479079536, 17996.79439183687, 15805.443909233793, 13873.329324341918, 15664.378737021103, 16741.63279713361, 16915.545124309832, 16786.80400948738, 16580.820244295603, 16743.740453706207, 15117.451118027888, 18634.930460441563, 15182.414778759787, 16746.225934012367, 15775.123624032642, 17764.01393586142, 14633.242761531275, 14729.446404835668, 15065.882632635674, 18316.277431366914, 15221.877998423914, 15740.403459390789, 18447.644687759177, 16282.87300456421, 15790.591912541237, 15553.59130000574, 16025.803132613708, 15882.245075157394, 14466.696100497356, 14752.25882598953, 18000.0, 16664.12560609707, 16464.31288812362, 18662.743019416783, 16131.266608949983, 14725.815220631033, 17707.414163612088, 15825.70547529002, 17470.30569898753, 17137.088660338977, 14462.376701331237, 16962.959586351273, 15669.283441436102, 18502.200830306494, 14000.876082335806, 15496.499330005674, 16487.531089147833, 15529.698890622558, 18165.154378358184, 14803.015713473787, 16672.74059908332, 16515.633174634833, 16894.924122998964, 17014.05433009826, 15384.323305092632, 15926.602264510047, 15436.547134941837, 16262.955176394702, 15606.331807979645, 16798.085078124477, 13500.0, 18393.33786555404, 14711.661475971865, 14587.935439184786, 17382.71106794243, 13500.0, 15023.240366564125, 15052.151986001874, 16215.750516339116, 16532.7978434611, 16522.596899291875, 15758.215357351184, 14549.656410766553, 16020.67593011034, 17464.265453534677, 15227.520375743763, 15111.676169032247, 15432.999248453883, 15322.708890300797, 16603.044737473556, 17488.47504866872, 17404.731242908205, 18491.671787421303, 15950.459257826193, 16359.094961441237, 16826.144285162543, 18000.0, 17933.583370388147, 14875.29156220068, 17127.233306296992, 15795.508248254911, 18137.73318445632, 14506.620318953792, 16437.526189959386, 15883.738629472698, 13500.0, 14417.860133885866, 16649.82638477313, 17030.946523193812, 16674.794566571312, 15610.400422066898, 16387.244244579204, 16766.808351229396, 14474.042417394541, 16398.87436491394, 13500.0, 16135.649067754488, 14115.012312221916, 15799.58962194854, 15061.874497580764, 17208.540428125543, 17384.907650468773, 15672.384680393296, 15031.470868151977, 16200.094671856517, 17988.996835591108, 18094.21297043959, 18190.0073042071, 18685.630708125587, 16111.789144811775, 14870.355845015569, 16268.889802202246, 18000.0, 16498.2877952507, 16461.90559147442, 13500.0, 18233.145301629185, 16760.764286209484, 14203.849270417506, 15684.426100367498, 15544.705783426243, 16105.304032644191, 15833.77598575671, 15283.911419879516, 17324.24503906382, 15163.177624205477, 18112.429081725953, 15835.74576511598, 16023.931126746631, 17061.999710673546, 16280.800635161917, 17070.41719946036, 17686.642106694144, 16711.790124324387, 17731.78614633202, 15842.712004730844, 17796.438432029252, 15363.316584141916, 17840.603785679126, 16994.77999467926, 17073.19820627029, 14637.268913016178, 15833.34293910308, 16525.63013438143, 15624.184277425622, 18063.133071216875, 16307.106550256374, 13662.923380729895, 16082.7342422662, 16164.759041383904, 15563.353189485899, 15142.185638588382, 18265.983909608578, 18560.217712148165, 15984.065218256754, 17195.319563384575, 14652.440706896023, 16661.14694359709, 18383.36060194745, 17962.911696304032, 18000.0, 16554.87160705887, 16495.192693236404, 16805.532317553763, 14924.655157533527, 14784.340331117952, 16471.77267315086, 18012.64517601719, 15478.610952063027, 15554.469404153093, 15859.489405730945, 15039.867908022143, 17817.165102678307, 13635.193664889444, 17530.554289360298, 15318.204320607056, 18567.577194837115, 17490.236337784736, 14417.941472594639, 16589.904204867464, 15208.902082457369, 15950.450723068636, 16386.90011895418, 14592.609037529133, 16558.18309538473, 18673.36998582697, 17315.703531802163, 15559.589475072244, 15752.022506949523, 18392.071338805432, 17208.175585831854, 17015.491664184836, 16727.43931599433, 18116.59177513159, 17078.277757026313, 17213.975191423164, 15291.245494294584, 15245.933004666109, 16439.840058550617, 16762.56699436989, 16073.114953601911, 17333.943825602775, 17791.86769849925, 17503.990798022576, 17086.966331534997, 17815.260086284856, 16045.049342483058, 15341.814973108234, 18421.194773873875, 16219.455412489964, 16536.33515616852, 15819.324686079533, 16268.277092474804, 18228.05192291125, 17954.936472853646, 16213.956439180763, 14983.805115086687, 18000.0, 15814.05747360112, 14794.730155191151, 16449.20817589564, 15560.804773870796, 17179.296903620358, 16405.55181689751, 18470.44172784697, 18000.0, 15085.908924712408, 17565.977368985245, 16846.80167877062, 18131.6578400432, 18165.369902254846, 16476.259063296777, 17215.289093423795, 15773.84926881315, 15681.256186963106, 15845.14858524455, 15948.378739305692, 14348.21691159199, 17680.907175995515, 16322.307746315977, 14861.381797797427, 14707.47766786093, 18182.292815503028, 16657.43917017172, 14599.2113622906, 15612.642659811194, 16003.042024773335, 16533.396387945988, 16751.666744255763, 15886.022875769893, 16578.74078691376, 16306.392045170935, 16151.127281684827, 17145.424665395767, 15583.02480432095, 13500.0, 18680.501063754706, 15841.192241349781, 17256.94850996389, 15527.423298057116, 16192.037427131898, 15302.934719840734, 14811.227447459738, 16006.63315933178, 14862.129866875399, 18000.0, 14333.855093287955, 15777.472347981418, 14925.875603481478, 17894.77033447201, 17353.381252695646, 16065.484882217968, 16273.54298661529, 15892.484181634734, 14918.015318067233, 18682.08769697728, 15048.967293696101, 16241.043397269155, 16515.258089268867, 18253.27766328473, 15618.84474728088, 18000.0, 15440.63556999245, 18283.553431997934, 16183.218221670058, 16405.29618184392, 14818.208532837743, 16482.527072854664, 17167.188175107458, 16914.873918115027, 14697.792997968985, 15577.89813419921, 16754.086022739186, 16557.905416627604, 18392.243909133023, 15760.774051917842, 18674.11754798692, 15315.092146032275, 16087.464769094979, 13500.0, 17726.392727334307, 16383.929744956935, 14100.566392062343, 14792.665541238968, 17169.99882191309, 15966.815350620227, 16249.101399104577, 15893.880442355117, 17173.345353282024, 16366.680516525506, 18437.13339768458, 16079.208511467854, 15684.373679163966, 16546.10862361571, 18461.89423762372, 15031.496241117202, 15790.603695319787, 17210.448167409475, 16615.728660674275, 18295.919501072614, 17622.118305625256, 16956.603923382274, 14749.47897332349, 17093.294947659117, 15450.611351677628, 16957.2798273698, 15936.613862639237, 16434.11054443615, 15169.167079817367, 16952.58805567631, 18400.016107459196, 18125.22670140171, 16948.66167602559, 17936.050770066715, 15733.747520045807, 16860.427920312835, 13500.0, 18641.56050977717, 15992.469914842068, 17765.36758301872, 16897.252919992818, 16071.217671165776, 18000.0, 15950.613521019464, 13898.544167570119, 16844.022584818485, 15921.697677166065, 14988.37134825976, 16463.406190414946, 17014.46913122844, 18000.0, 15449.663464915595, 16397.52596879716, 17604.420850578554, 16090.036891376345, 17018.123651137463, 16944.04386263755, 15492.048016717436, 18062.988057077648, 14961.894646961462, 18147.76122503683, 17124.630976410008, 13848.300279920359, 14867.643024075802, 16126.910245854617, 17504.417848897883, 16945.175902149593, 16157.917004421814, 16203.591034051553, 16368.684231858584, 16291.276633252306, 16529.076741200664, 18211.335743034902, 16928.111119857975, 15119.465267724645, 18105.753886903352, 16496.71831328381, 17338.29480996853, 16109.416807493573, 16758.059090213177, 14462.376666156995, 15614.486778883393, 18025.122342400988, 15412.824014464308, 17276.663786210986, 17009.145185968864, 15853.946512939367, 16895.046582521652, 15145.472999732028, 17276.470372561776, 17065.574563851133, 17116.07398210611, 16993.899577814584, 14900.739112784582, 15464.545385528705, 14199.261898572462, 13500.0, 17629.50346488097, 16161.561106554082, 17833.169833356853, 17280.693749134083, 17080.585540212283, 17666.3408631329, 17658.995069710403, 16437.859361186598, 17890.310065911624, 15206.255344573143, 17472.968102964078, 13500.0, 16841.29141755617, 16159.521520522976, 18001.70985021972, 14203.581162071123, 14876.865375645386, 15875.118633909487, 18075.000260104705, 15983.591237774363, 17756.222004061634, 14479.558468391657, 15245.844627157589, 16129.667053612144, 18000.0, 17563.787677696364, 15392.718132077058, 14767.583331729364, 14889.004712168822, 18428.344159435437, 15869.308431123083, 14999.506912458855, 18525.09498944824, 16261.812222571018, 15904.065070037537, 16642.20234115695, 18538.120355819818, 16674.996126282538, 16677.11236773737, 16442.77627596728, 16990.991881557307, 16830.162676302887, 16302.694497292281, 15693.745774348747, 16647.01497208013, 16785.888143336906, 16133.596243493388, 18408.851533627967, 15650.95649691963, 16252.389149223747, 16200.814760805593, 15064.5221666432, 18349.1816108053, 18309.97141879004, 15904.113480177075, 16260.800960112228, 16034.769475018475, 16855.581656325972, 15421.191605485392, 15097.975767493137, 15642.374289094843, 16589.810729971774, 18062.219332598543, 15294.0189583323, 14757.274156945963, 15445.312207199358, 17420.47109241032, 15409.70132317355, 15184.177380025865, 14369.702461900844, 17415.613160633333, 16544.84825147686, 15320.563932112533, 16178.169271965991, 17750.47027731467, 15728.277359635002, 15525.879848369603, 16139.190642848542, 15972.341021385428, 16587.030799928198, 14461.365854776428, 17449.447025242815, 17023.0157297442, 16237.576985838288, 15162.105647996434, 18291.15864433705, 18022.978628426692, 18191.288277129184, 16209.768800271499, 17751.841255494957, 16752.657642511112, 15424.814837445763, 17096.047387003222, 15957.597011670516, 16640.32785797353, 15411.745517314926, 15653.31321389886, 17164.199952920782, 16469.514291283125, 14966.114673952861, 15754.674532445897, 18146.72373978946, 15431.8313357923, 17704.678047254652, 14536.650669227929, 14989.345127429142, 15883.932912106244, 16051.165026589195, 16522.105665472714, 15403.948206385954, 16734.45173706397, 15952.195654767647, 15170.51118654045, 16988.758601735197, 17061.864532266678, 17858.764463668496, 17676.550878645183, 18583.016121601246, 15341.677958960847, 14088.740658515911, 14521.949144294365, 18477.984092134022, 15347.704161181657, 14525.644491216703, 16848.50714439882, 16122.017251719388, 18246.61105644437, 15912.990698054655, 17675.276700613926, 15997.519013633917, 18383.5707107715, 15569.83037675379, 14988.855379150367, 17288.300305360073, 17777.95302709698, 18000.0, 16597.127775725297, 17015.3204924204, 18368.795887343185, 15680.661499917605, 16839.41127274295, 17692.27702972003, 16979.058105993616, 14933.583229232769, 15496.15125196827, 16419.365030446435, 15476.382715794432, 17811.65703580161, 16210.184904039144, 16063.729437632703, 16865.844504465942, 15702.41704191248, 17284.551959618624, 15610.495990532536, 15558.77004869533, 18000.0, 14793.931555204219, 18000.0, 17061.670937355506, 14987.86683348323, 16663.925847327504, 18246.17523448675, 17717.439949123684, 14986.023644677518, 18407.748761775685, 14865.722335476581, 16322.523260328946, 17855.986756183593, 17017.364132238832, 17610.73292057273, 15177.350937128329, 15338.53015576753, 18614.273328402985, 16777.86297873819, 17397.85113552994, 14673.875908576552, 18079.70533529925, 14318.272313855523, 16294.443973114176, 17813.0949515865, 17144.3453457259, 17313.487213292283, 17972.28080895553, 16130.44667487455, 17906.13296948983, 18000.0, 16746.21264055674, 18631.381533670392, 17246.012238985888, 17461.038208973063, 17408.885327054595, 13654.409613767855, 16179.444729316576, 15939.856128572388, 18681.619678131865, 17112.820521321773, 15977.74219731875, 17620.892294699923, 15127.299607722172, 17870.515235352315, 16623.29418411066, 17021.31008764962, 16042.185219616209, 17094.626594230045, 16602.999508719993, 16557.491886279553, 17221.828860011956, 15641.001538215665, 15948.64621056111, 16365.767656851827, 16813.489493415527, 15261.07998014698, 16557.10513871769, 16649.999468766688, 16117.890326612767, 14214.244321515753, 18065.80316710683, 15293.269492623534, 18460.907360941277, 15975.256582548116, 14351.259329103163, 15636.587795164434, 16034.20214761701, 16986.938432952385, 16211.878100161639, 16578.333305117136, 17292.118190228688, 16627.90087959252, 15999.10278235181, 17266.52536063855, 17319.8624683337, 18094.191643385482, 15757.97345728887, 15566.800432278618, 15957.120244523272, 15059.246729044016, 16139.31202646288, 15756.373682513875, 15866.44559074685, 16369.548959153222, 16947.2490952531, 13500.0]
thresholds = [14689.898057346001, 16268.642912739975, 18000.0]
display_name = "Cost per Life Saved by Medical Research"
units = "USD/life"

# Calculate exceedance probabilities (1 - CDF)

sorted_samples = np.sort(samples)
exceedance = 1 - np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

# Create figure

fig, ax = plt.subplots(figsize=(10, 6))

# Plot exceedance curve

ax.plot(sorted_samples, exceedance * 100, color=COLOR_BLACK, linewidth=2.5)
ax.fill_between(sorted_samples, 0, exceedance * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Annotate thresholds

for thresh in thresholds:
    exceed_pct = (np.array(samples) >= thresh).sum() / len(samples) * 100
    ax.axvline(thresh, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
    ax.axhline(exceed_pct, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.3)

    # Add label with formatted threshold value (use format_parameter_value for full units)
    ax.annotate(f'{exceed_pct:.0f}% chance\nâ‰¥ {format_parameter_value(thresh, units)}',
                xy=(thresh, exceed_pct), xytext=(thresh * 1.05, exceed_pct + 5),
                fontsize=10, ha='left', weight='bold',
                bbox=dict(boxstyle='round,pad=0.3', facecolor=COLOR_WHITE, edgecolor=COLOR_BLACK, alpha=0.9))

ax.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=12)
ax.set_ylabel('Probability of Exceeding Value (%)', fontsize=12)
ax.set_title(f'Exceedance Probability: {display_name}', fontsize=14, weight='bold', pad=15)
ax.set_ylim(0, 100)
ax.set_xlim(left=min(sorted_samples) * 0.95)

clean_spines(ax)
add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from

output_path = get_figure_output_path('exceedance-global_cost_per_life_saved_med_research_annual.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Exceedance: {display_name}',
    description=f'Probability of {display_name} exceeding various thresholds'
)

plt.show()
```

*This exceedance probability chart shows the likelihood that Cost per Life Saved by Medical Research will exceed any given threshold. Higher curves indicate more favorable outcomes with greater certainty.*
