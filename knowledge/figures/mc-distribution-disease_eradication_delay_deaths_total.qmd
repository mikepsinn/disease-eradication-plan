```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Total Deaths from Disease Eradication Delay (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata
)

setup_chart_style()

# Simulation results
samples = [437877195, 344229588, 470942611, 485352120, 285993321, 327038128, 425035385, 393492781, 414651869, 356699662, 480696034, 473003596, 420585213, 499679477, 449836643, 356279983, 442565362, 349617798, 480624045, 412288844, 402720365, 368337464, 507061870, 404863254, 385689592, 390987178, 454634526, 442322754, 445797496, 447129622, 580624267, 387210115, 379889280, 359341821, 460861102, 499813164, 407737499, 357565865, 358620581, 463447342, 470400718, 455439593, 369387435, 432590223, 424230844, 431611435, 480090806, 431967817, 465567933, 420696456, 436738375, 462004195, 317040677, 393253142, 382778932, 371203697, 396370084, 528417220, 355841030, 487467961, 302697857, 392190508, 427557588, 458642569, 467992421, 474177870, 391224848, 383333505, 479069844, 402265868, 328759382, 338071992, 352249514, 452029437, 426088325, 466435571, 385764141, 427252872, 461578605, 393974954, 449043929, 369631634, 390226111, 388925369, 333968526, 451275487, 382846004, 416746348, 450815024, 448287949, 464554448, 408834800, 386038373, 410168299, 302416759, 317684877, 325707389, 347064803, 444844192, 353184029, 389174139, 513035843, 390699246, 469968825, 351303159, 401269470, 350208495, 391900985, 477730406, 299903725, 447395138, 432995461, 374262180, 317752552, 421023453, 378701362, 432627648, 417416321, 536895707, 398882368, 345322222, 428753386, 431706427, 517727492, 477336717, 441694028, 525917546, 334431758, 371144056, 351773473, 388363968, 322216536, 462292808, 400087428, 316165927, 345847497, 438520010, 477565125, 568741099, 639126023, 445920916, 347577190, 274923961, 435177344, 359397858, 386589321, 373033760, 405835363, 494958236, 427145054, 404572955, 344516444, 303213567, 381678117, 412014084, 550196242, 425211033, 488573568, 380781873, 334681873, 349202430, 365327924, 579539280, 358828945, 477592597, 353354802, 484666471, 443754739, 404714153, 412941977, 370118231, 448254091, 383843246, 332022824, 328612980, 428269205, 535090406, 427357866, 407404839, 436498085, 513564933, 431661825, 386896815, 498062575, 446977492, 531649385, 429040105, 332097046, 322766918, 540815550, 546639174, 403097497, 388824537, 525770861, 339799355, 353903787, 462903938, 388030610, 415486364, 404233075, 440280226, 521519644, 422350746, 462949698, 279910226, 412374886, 357359190, 332466443, 355014469, 392243675, 483472523, 325468116, 418045269, 381825769, 392694091, 490105789, 455065469, 516020417, 404864937, 367316350, 399972286, 433341714, 428557718, 341293615, 422343900, 432304398, 611938284, 558990925, 356686265, 395512228, 316637728, 374498029, 438672876, 505765835, 365066295, 370161957, 273999407, 404287991, 342745255, 378705029, 355101078, 409134702, 297998077, 316406848, 579603260, 327996441, 340475682, 555759571, 638880700, 335558490, 389864261, 440571748, 547043039, 347755465, 398466169, 472969315, 447420378, 389313777, 406328762, 322332065, 398965449, 396984084, 432590846, 376925096, 450134349, 490868740, 427027985, 441319108, 419660653, 415858578, 365576755, 438737889, 408919933, 576637111, 534634366, 443820529, 362765525, 339445865, 504624517, 434815838, 450770418, 298821128, 484351336, 448870097, 339576340, 382699298, 434886347, 419611233, 395176904, 408479631, 397995557, 426820751, 526564059, 265232905, 399058492, 428553306, 437240151, 389609025, 298061086, 439579095, 546934881, 312137497, 479513859, 392634576, 411476999, 343374661, 392220447, 513099593, 458376927, 547333176, 503560191, 447738903, 548266741, 447732007, 476797333, 394868861, 420622220, 367215667, 489097218, 335116895, 473347585, 402311948, 503082654, 470974076, 554445480, 469461712, 309708147, 411076333, 335529605, 379473363, 529706004, 462470888, 367113270, 345971041, 418199396, 332613628, 369003897, 438410051, 501849189, 460322556, 269422401, 437851601, 421016558, 445882704, 538045353, 279112196, 374470871, 458991485, 309101366, 526916079, 442536439, 478206013, 375853019, 475720976, 495149865, 432642317, 432753016, 435369124, 356007885, 405358494, 405005201, 443640362, 489881123, 343001722, 406953229, 527351122, 364083302, 358770809, 430422501, 478039357, 416669910, 515360034, 478980192, 477844967, 456253963, 596032794, 401288910, 282766475, 537092844, 383655324, 423596191, 513842242, 307790512, 330324275, 307852730, 360665891, 447779451, 454032041, 435801444, 319891804, 269136163, 419746661, 382681934, 449236663, 467296117, 425786142, 471672012, 432375832, 454467985, 366723060, 403090988, 430021468, 476232735, 388090661, 453808044, 397022578, 407482565, 476913234, 283408547, 327408621, 315437454, 268778439, 368518851, 470865998, 395687316, 430094989, 496746838, 515260317, 410920862, 517288403, 422461706, 357751365, 374245030, 315542973, 354345434, 390577090, 474951393, 546406807, 321862025, 444333493, 344192510, 450367785, 406522587, 293431315, 484416765, 373519276, 378398081, 342260214, 370152626, 446913687, 402411182, 439627865, 442064398, 514710850, 391639105, 315778436, 495053779, 392427666, 498703107, 443639132, 406518983, 441100688, 565014297, 575308409, 420825941, 427372256, 495747618, 357195785, 439950489, 414004881, 438548837, 358022423, 308595352, 278517564, 339118405, 383587812, 395105453, 563892964, 498039800, 349403997, 441022473, 387164059, 395723765, 429191594, 461099324, 391885255, 494794524, 337503299, 416305928, 618713294, 431930349, 523545047, 422418056, 458237087, 411800360, 403740952, 361655265, 447091329, 356800891, 464569434, 496444110, 442402524, 395591710, 448836532, 394022057, 484969461, 293400189, 392140085, 283546607, 314613980, 518094037, 481895943, 365717739, 314138356, 259179659, 377738172, 603782678, 447429091, 376633547, 449657200, 310412536, 394816192, 422990907, 409714597, 473985957, 440798056, 464774687, 367831103, 482095995, 539060162, 348867253, 354374795, 515894083, 402263070, 521231803, 384705012, 525265992, 425298452, 434486629, 533948049, 390315521, 350802220, 384287558, 448716110, 310107316, 462466186, 378063017, 501269140, 267855791, 361176887, 302471293, 358502887, 433717763, 403118153, 397897229, 404534067, 430500987, 346314970, 467663703, 464350855, 443761128, 456433596, 437271108, 571874815, 409643991, 394133258, 363410307, 344741147, 330791948, 354300982, 410811114, 440040139, 419516157, 362597932, 482276206, 470111584, 404501304, 370245853, 455831289, 429383445, 317619764, 411003241, 434763875, 353571164, 429518939, 317190296, 515925534, 509037919, 397957638, 442176799, 267617513, 336556908, 395064329, 342102915, 468230548, 568787275, 335227577, 357746981, 432829165, 537639450, 332233835, 433817468, 554498179, 304659406, 328409369, 386016990, 379314367, 475633063, 433280831, 296920136, 453381260, 375400625, 511102116, 371974769, 371358167, 455289399, 471882546, 448403642, 302526117, 455059456, 344605607, 432816642, 319186373, 448272529, 359825320, 328307607, 468187249, 433279725, 372905173, 524961001, 384835462, 418151060, 435264929, 372516160, 450104625, 378428896, 386847450, 517998397, 344189721, 267574025, 537625176, 614625295, 387289685, 286868546, 393895407, 395593517, 402363247, 339381546, 458146561, 454055740, 314655865, 467089187, 573316712, 428223780, 392020183, 405749543, 460807171, 299693479, 427676048, 388318486, 556641761, 403475009, 542170998, 340017156, 458719794, 438950373, 355625204, 428617289, 506283313, 392965224, 302125471, 414597472, 353388540, 391670167, 410035378, 301264519, 306941742, 450912648, 379167674, 265262027, 473535809, 435516821, 366098188, 326087804, 477389483, 441142802, 600618308, 446346394, 443956929, 403986792, 475948820, 461540878, 509331785, 379263786, 385198858, 382175664, 473985625, 528688768, 383576383, 385936044, 438561191, 398432187, 486228788, 270023544, 358470874, 361457090, 268980180, 349300909, 352536732, 401574834, 498577611, 398481430, 344837176, 411788157, 493666317, 348480518, 352843111, 456583417, 400135751, 463214863, 414877183, 467274350, 344554584, 414988784, 400899429, 332657354, 310252331, 466080366, 391069533, 345402946, 408998594, 499739531, 269582935, 314513123, 352019993, 525749914, 436261796, 472213550, 337620103, 338976746, 448382568, 420028139, 455854386, 402522183, 435937757, 427222458, 473001744, 475210158, 306675009, 270092141, 490028248, 504359501, 345512866, 291633405, 422959032, 484610459, 552585650, 453447020, 389622802, 354010703, 416671716, 394680310, 345881417, 572994875, 551584215, 500359814, 352156065, 478845590, 462627299, 447993972, 509171436, 462309263, 470156857, 462423988, 440515785, 296379717, 421849712, 376865698, 328489221, 543285321, 547066936, 517730081, 434267083, 517056387, 416714790, 430458121, 340694263, 444639572, 420179767, 327007455, 412198271, 410167492, 552582960, 481822055, 416671297, 433799363, 419018966, 401447309, 341423056, 405109230, 363913300, 330411050, 453070846, 444218635, 296186338, 407117978, 489565450, 494438694, 491874801, 418638924, 357237172, 341339111, 440795102, 443338242, 512107088, 497576142, 406441689, 330809284, 393292601, 431505611, 401505859, 375376265, 434097573, 380460360, 371942073, 438369368, 387517282, 433458651, 435577631, 337668209, 382027993, 523904504, 336180740, 275858753, 291508662, 417936238, 418065749, 407477694, 506413081, 263617531, 444561833, 533687522, 338434167, 389059745, 363453333, 353929301, 392792653, 523093812, 555797812, 392116920, 561279100, 418399697, 549050922, 409203169, 425267563, 442324985, 646517303, 478562448, 366547046, 487522946, 390311197, 381440492, 482916664, 418077810, 435969271, 416853071, 440207638, 446698239, 286860595, 464643377, 348077237, 317993796, 411684420, 421875602, 367481987, 477027780, 324446365, 387173398, 374897729, 412526761, 435990299, 346357667, 468973539, 420367677, 289642757, 285527910, 414972020, 400175785, 408484469, 413853605, 432110513, 485892657, 339531927, 335531939, 340703993, 436723581, 508804233, 385480807, 266221193, 301368827, 358044766, 376760139, 387073067, 418615113, 393807133, 493679069, 368671819, 356076848, 450676674, 312024027, 444103044, 423212415, 405364592, 535820949, 372342429, 573940503, 399861624, 328672879, 420864634, 341831270, 363530235, 444642660, 456362885, 372345146, 488930498, 502019074, 523788268, 454419663, 518060040, 290333252, 393376474, 355762231, 424413994, 375818333, 404041208, 559422880, 403789540, 445875493, 399380608, 421281060, 416282866, 448420220, 502622748, 540533295, 438235428, 458890207, 336916909, 409588379, 485331125, 479676317, 431097528, 481227616, 451556205, 505335317, 436755871, 390738672, 440153325, 259695941, 443603041, 248774967, 300145777, 448674388, 450577147, 336157824, 366218543, 518617918, 381835388, 588991848, 415715271, 445451897, 538098334, 425265347, 346726169, 408036863, 413309365, 322987612, 397724886, 364177874, 484116579, 418330550, 395833638, 408288449, 431933420, 460923403, 346900996, 344123389, 497938463, 386798959, 319629575, 448087424, 449530869, 312338018, 432395477, 469823422, 442978967, 462055988, 320438684, 439801897, 394445523, 381921014, 480024512, 527178790, 552325711, 514253148, 408036386, 441389744, 472176277, 424554770, 425246372, 476476763]  # Truncate for embedding
baseline = 415852543.0
mean = 417883292.6584
std = 71230170.46335284
p5 = 303250711.05
p50 = 414911422.5
p95 = 540161676.55
display_name = "Total Deaths from Disease Eradication Delay"
units = "deaths"

# Create figure with two subplots
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
# Handle edge case where all samples are identical (zero variance)
if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Mark key statistics
ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {p50:,.2g}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {p5:,.2g}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {p95:,.2g}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {baseline:,.2g}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---
sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Mark key percentiles
ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"
exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title
fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark
add_watermark(fig)

# Save PNG
project_root = Path.cwd()
while project_root.name != 'decentralized-institutes-of-health' and project_root.parent != project_root:
    project_root = project_root.parent

output_path = project_root / 'knowledge' / 'figures' / 'mc-distribution-disease_eradication_delay_deaths_total.png'
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 4.159e+08 |
| Mean (expected value) | 4.179e+08 |
| Median (50th percentile) | 4.149e+08 |
| Standard Deviation | 7.123e+07 |
| 90% Confidence Interval | [3.033e+08, 5.402e+08] |

*The histogram shows the distribution of Total Deaths from Disease Eradication Delay across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
