```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: dFDA Simple ROI Without NPV Adjustment (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Simulation results
samples = [988.8571466148601, 899.2582862379325, 920.533924336592, 952.3387783763206, 1114.196011299486, 999.786768413351, 950.335164160152, 915.3624020881175, 943.3121164124798, 1183.2285141889536, 1166.2566684332148, 925.9674009434297, 1063.0406499378905, 1136.4564683488027, 1000.1156536003308, 1199.292561671094, 975.1939350556871, 995.7872727474852, 957.3807635153561, 1108.6164728500871, 1078.3849242042577, 1184.487990381062, 886.0500251310096, 1164.9252206763542, 1039.682143247993, 1150.2454515282752, 1070.1645648263411, 858.3563394178997, 1118.7038518804961, 1006.2887173774599, 1129.4064018304202, 1019.087276430977, 1286.5934205757123, 1003.6925909974073, 839.7792948936614, 1106.871934848502, 918.2351571762523, 941.6248020325893, 1268.6402425666406, 989.8333363660406, 1045.3097159963233, 1123.0374906893874, 1202.0996441832242, 1014.7671409869655, 777.5385589447977, 905.6818720094989, 916.4227306564858, 1186.2367983694558, 1189.0218542614919, 876.9636078246263, 998.5683502658516, 1215.1880265793616, 1156.8024606557267, 1155.9412338632792, 1162.4524687442683, 1162.400429160743, 1029.529910675563, 759.5890721370625, 1176.6248451542858, 1081.395103897728, 1040.5397337004192, 1357.704842807102, 686.6596948475674, 672.3408448796109, 820.0027606088912, 935.8789658400461, 1084.1378204302212, 1058.4767060997397, 1002.5455262375556, 1000.7821355990588, 1374.1862692983261, 1037.4763208079767, 1070.2137695482706, 886.2707848352952, 1036.442010477507, 1154.303717624383, 1288.8282106523377, 1115.182042158322, 1033.8523256355775, 1015.8174650187519, 1098.4635882636878, 1006.2029352237369, 1142.879946478779, 1077.949570806262, 1181.406053528649, 1171.7830922692776, 927.5449429848521, 1077.486591101431, 1256.5938493512278, 942.574681398754, 1008.646369962827, 1053.0482138409038, 1026.9679277152932, 817.0506664930846, 991.8752715712856, 1200.289426063923, 1571.8733436954647, 944.4126622213658, 977.5657648650403, 1313.5083602905054, 1036.5960362660808, 957.362750535258, 984.536658382125, 989.1427359275488, 1332.2555933945573, 756.7256122457434, 1006.195394255964, 1005.5172531351673, 1057.7743453133467, 989.144200145538, 986.4792019198331, 936.4268863635383, 1103.3132862204961, 1094.381212128202, 913.8454973809744, 1206.039839462238, 1200.6299273072377, 1116.678574929483, 1116.280760372255, 982.4298877070071, 1195.6910409836703, 953.146251858416, 1131.8202201916533, 973.0104981017273, 1062.1537426968628, 888.4072308201447, 1071.488671055503, 1300.9826912020553, 761.5141016108247, 1368.0838073052544, 1348.8879230539994, 966.0792301142528, 1018.5475103105231, 1245.8232211406496, 1147.2986397830375, 1236.9611592786896, 1037.2790033544711, 895.0868326523306, 853.8087751465417, 958.6455271754128, 976.4615825184267, 1127.779061167414, 1219.6117572083483, 959.2058024681545, 1093.9606207046143, 1180.3176044387994, 1295.0022290207999, 1066.3957459589303, 1117.0334286704058, 823.0175452648288, 1245.0712385186348, 1275.587154612287, 1395.9396212537533, 1003.736802127402, 1027.8007090628714, 1095.8649619825865, 1277.2914726041522, 1023.2316031330682, 933.9242936124481, 1114.44738586381, 1096.9458527905576, 1166.2045728037638, 1078.1640689430142, 1094.4999235404198, 1186.4333607904075, 1340.8770038326224, 1160.980404580751, 876.5461727091167, 1158.3899268076789, 856.4584675898194, 1009.417322078172, 1170.0708651931404, 953.4304524059614, 976.522093080656, 1329.8965358111113, 999.4774815438426, 843.1504344981375, 965.4932729624675, 1228.0909919471258, 884.6927991754874, 1151.4395491103214, 1218.1764151584696, 1057.4406909503964, 901.0085488941733, 901.5187732965043, 1152.5361514973174, 921.380099163329, 968.4719099967565, 1174.032803744918, 1152.668623855714, 1111.0562203084698, 907.1786093114705, 1038.0482905298984, 720.5589475180404, 966.0925043368769, 1160.9488511036784, 1030.5884618603511, 790.8773688115251, 1073.4357351605397, 945.8589153751436, 863.6663231865934, 955.6757305583991, 1009.8287944799187, 1224.2906044937813, 1151.0650622047385, 937.3020761299878, 1246.787958105009, 1123.1140459520936, 1201.2786298708854, 1006.3480814211737, 1054.370223200084, 935.7985332323458, 1122.4796209876295, 1043.7965203899794, 871.6334960888738, 996.2960489507764, 762.1397550030457, 931.4850357422926, 1119.3371141986565, 1334.644908657963, 972.4823744159313, 1098.9222515528636, 955.43927779506, 1399.9767861731482, 1052.5467325790949, 1163.9424772889936, 724.1528803135313, 774.5409682229944, 1099.1349553721618, 956.2921519385867, 1209.575163235113, 1050.0115523500522, 1107.5664448560594, 934.5600175000025, 1107.1066808254309, 1051.0505056090801, 1148.4715636619803, 1037.715492748655, 1208.1710352181801, 879.5284001151169, 1083.0824963180696, 1051.9201017270361, 1401.7037456704222, 1279.5967534858637, 875.6727549085894, 1404.2693566818984, 1149.5040024685363, 1034.034289859089, 1021.2439113098318, 1391.3905014486932, 1097.6394730048291, 1198.0711057999422, 840.0724184461249, 1302.479478558159, 1126.978086059034, 1031.4090756285102, 959.9244498102811, 1272.4234798938853, 1114.2913786898814, 1188.0005286137643, 1059.4944895683766, 1076.2180543495383, 925.8402403967982, 1090.966828429429, 1034.3919045262178, 834.5852683181398, 1017.226042642601, 1055.143625806992, 1193.4524261342751, 1052.921959707213, 1130.8396772016067, 1071.1294558345637, 1208.41093252035, 976.6994748987638, 1108.5166518930348, 1006.7861134225432, 1260.1199451726402, 1255.8612081330748, 1099.8696698739286, 979.9915175438156, 1073.153168456381, 1150.7619887548744, 842.2064533493616, 1016.6263675519481, 1173.368373932024, 981.364376048804, 1035.5101051636134, 1249.0701224612415, 915.2394140772969, 1172.7705564118098, 1307.3268068604402, 923.3641901488583, 834.0629794811219, 1310.9536285651143, 939.9098603344853, 932.5397034542104, 964.5201098427161, 1277.2106155560546, 1063.0402429585968, 857.3658057415605, 902.7036638579511, 1374.1324670653441, 1038.5718471966625, 1096.332364934445, 1318.729714237716, 1061.8335060403442, 1130.1935884710324, 859.8632966852537, 1032.711270200801, 1022.4326413488794, 975.7970338286635, 1043.8018511111113, 840.1302809896423, 904.5144308974076, 870.9336551913206, 1312.128046553895, 987.4093792567834, 1070.3360063338373, 1088.202370295564, 1070.211668068982, 944.7005895445725, 1030.1165430841345, 979.2265560769935, 1093.2450840943814, 804.9845756116924, 1192.2937452794877, 1217.5116435465454, 974.8406193105475, 1320.3099149054585, 1233.4706185696964, 1059.1113475101688, 1313.3590729185228, 1251.8604490139112, 1160.2115272099982, 1178.1608567977412, 1312.371053504191, 842.0992607424567, 807.0147074439011, 852.0999671219514, 1112.157869310165, 1082.904258455829, 780.6994398238638, 984.010341499992, 1041.3212727003563, 1029.6961955976249, 1031.5306467790335, 1137.2291517569563, 1042.5006116961333, 1423.0780928451602, 970.3642465757332, 1429.7968450241776, 970.4742091963532, 1071.1189532268731, 1083.2747882983808, 1152.533266276414, 926.2056694183523, 923.0615229536476, 1044.4008065039366, 1198.5727213433145, 883.1370600812364, 1083.4423035106088, 1234.9831045728615, 999.2729456017728, 1202.5009897750438, 1357.375671929371, 1017.3161336245023, 1210.9452255090073, 1312.5066070597738, 1121.6206345402265, 975.5460383634631, 1153.8156226149915, 999.8246550017185, 1034.2734276073143, 1303.8165709705836, 1138.58542667246, 1005.9869185187071, 1176.0185979208609, 990.8559981093467, 1040.00262579944, 1086.2221606553387, 986.5132445099273, 950.1670359307076, 1145.045438218678, 1410.1743526844748, 1051.8734406121011, 826.1677091126625, 1133.586420899187, 1042.7828346536435, 1010.6731974599876, 819.5492752769998, 1247.0718928635627, 1102.1877198079212, 1193.9036371633717, 1044.5213698502967, 1085.8234219488904, 1166.3787502430068, 925.8418250794484, 898.3585691405174, 1134.7181278805535, 1164.4171174269768, 1116.9592008757606, 792.6685990121052, 1087.6339027462775, 959.9051185494226, 1139.0429147866957, 1315.69201720089, 1164.9891488394624, 982.9515031845185, 1114.56808221029, 1026.476074617237, 1040.1734148068595, 1105.8634627611998, 1285.0748995684512, 903.0095846706404, 1181.514405436221, 1127.6624883914494, 850.0137881611407, 993.0238771965436, 1128.3544936451651, 931.0293692841984, 1262.9093863297055, 1201.7935229372354, 1127.6782402698866, 1193.0158035924687, 1283.3116172663647, 973.8164240592864, 987.2526544587515, 973.7067741630856, 1187.7449522548372, 855.5272477302457, 1194.660331960798, 636.6694875683917, 1099.7258219386345, 924.2138413090998, 1048.6954188161874, 1098.0735036039373, 1256.2464061409928, 1065.5384397753571, 1242.2277591168954, 1121.9341665879997, 936.7130561779487, 974.0279374643706, 973.3544084131305, 959.0865838069162, 926.387133475393, 1245.6874470021357, 895.2201584735845, 900.2854976261511, 942.4821834594223, 1148.123459462832, 943.932608542459, 1130.3394398692167, 1163.9450817820373, 1001.2660367479172, 1047.6720968319637, 1067.6712454295482, 1055.4634735851585, 903.9425328949221, 1305.8383344997196, 1096.04828451126, 1138.5387141252197, 1119.849247557498, 1074.771199867993, 1120.406138779766, 1161.2837843992725, 1147.1310213214053, 1223.5701069637414, 842.3192776389263, 1014.8878658130265, 1255.6867453531895, 1254.8200597284874, 871.8778020764433, 1019.6624174092638, 1113.7352663461581, 1073.1269445659416, 1398.9329920110001, 1092.821940800581, 1136.716856232168, 1177.1302335151613, 773.7269302479052, 1181.5210884806809, 1058.7867602848216, 915.490447413212, 1004.6078674496601, 1069.1426872112756, 1302.8506264184036, 1094.2483144674916, 1003.6383596833463, 1222.7399215707474, 979.5087676438085, 944.5038285705034, 1249.9203718110496, 974.4116646099642, 1171.7898766092933, 1109.244098188645, 929.4569613167951, 1126.1050131058234, 1128.4353571890592, 1277.2704293072788, 1246.6369016580463, 937.9131029214458, 962.2788026210835, 1149.239642400576, 951.5937470630951, 1211.8734184131745, 874.4672710879202, 838.925178900857, 1226.7641561214907, 981.9517874135876, 1003.1640806047282, 1039.6545642707822, 997.9509499264198, 1165.793832517784, 1057.3011416159316, 895.5963459803668, 1090.1835968522798, 1136.2262038039325, 946.2826260606088, 1000.6835838021801, 1163.7450306291328, 1129.1198749277598, 931.7210734659467, 853.4862947689829, 1147.1479983860534, 771.4972522594562, 1301.9993833634642, 1094.279213523083, 1144.2376964432294, 953.8327771835235, 952.0130123297279, 1340.6778322463313, 1215.5703544999124, 921.1525182830763, 907.8984074439506, 1203.885360842662, 993.6683128328517, 1223.0003681428384, 790.0573486578401, 1184.6794168846166, 1148.4723441346066, 1161.257740937525, 849.019275910764, 1055.5006209950616, 1032.5228275710192, 960.9797103555204, 1028.3021384839963, 868.8589909244781, 917.4560145029728, 1013.9171531878392, 947.6890235419646, 1013.1075639275506, 1365.3710167738539, 869.5762842595846, 1019.4621160560857, 940.1620989684387, 1074.354802279321, 1037.7418869816256, 1275.8401461587741, 1119.4210253200722, 1325.8559353644114, 1119.6178339294356, 1028.1516028063943, 923.745173546035, 1260.5789988573058, 955.3190151883462, 1082.1707121252853, 1312.177822470298, 1307.4053662010995, 1107.2869148191094, 1004.9541303892429, 1076.3364216709952, 798.8160325698971, 1020.3767617451224, 875.0911789614917, 1083.8806134335086, 1071.214121026183, 973.7004108267172, 948.0838582431259, 1116.162497476131, 1028.8962465730056, 1450.1036008451, 1387.7482854604407, 927.5771219010644, 1169.7082829288195, 1078.1621074398906, 723.8284034975992, 1061.2300220361444, 1088.7174907774802, 1137.4395220907656, 1011.3829336844706, 1294.6032509567012, 1362.5407365357323, 1016.6961892871874, 1252.41092545214, 1263.8540710812001, 978.8739971916591, 1268.1661274126523, 1111.5640211335026, 1055.5647946033698, 1195.8644819939773, 1057.7352898107627, 1221.8857995089577, 1172.613994826006, 1401.921426669898, 1010.2182751049393, 1033.2822186365495, 932.7357797278692, 910.5695899804788, 995.1331968375207, 753.7466252026383, 982.5387062329468, 717.7355827394443, 954.451202286422, 1166.5458341053009, 1024.3996125006067, 935.8878250166898, 1100.5535887043814, 1144.79717016969, 1221.031455463995, 1038.4891779320965, 1361.993467386079, 937.5058416954066, 1006.2402946992588, 1203.8170658130682, 1135.1475348533525, 803.7489626229759, 1225.743490289764, 943.1117744545152, 1234.5623419404824, 1156.2628326327622, 1047.4978434496627, 824.6581359686123, 1058.3975584705606, 1229.38839211522, 990.2349484973834, 1080.4458714965565, 1136.861834927843, 923.1550197710442, 908.3091613545412, 1095.272979142246, 1231.4297185551002, 793.179713899892, 888.4424249225054, 814.0618730978185, 1131.886862299511, 882.4552046498628, 953.0455315466843, 1004.0342742235149, 906.2728623221958, 1060.4191272980463, 916.1744080102976, 840.6664207848982, 994.4722614310136, 1087.204884645979, 880.7647154870593, 1172.5826249248998, 1037.0525427191008, 1146.777153465988, 906.462907604534, 860.0358670174224, 1200.3765142659438, 986.4238357834281, 1020.5087844263317, 921.2358065564623, 1149.2801313803038, 1045.40088299212, 1205.1707512935955, 1101.125378124976, 1122.0537602168065, 1579.9184594889543, 975.0596118367763, 898.1634393239389, 1177.4930913875764, 1183.5498358112573, 810.7990371723662, 1037.4807621820273, 921.1179757889086, 1066.8450532724696, 1059.75230992545, 967.9283158663554, 878.3561936485323, 1103.133666431946, 767.866586992272, 1373.3451696015081, 1000.3922397039187, 959.6662603731381, 1114.312053676006, 1045.2372501651828, 1061.1848693255404, 1083.0552046202338, 1023.114261408367, 914.3050105033709, 1210.4282655001448, 1316.1080514839591, 1221.4325088802457, 1240.4352407680794, 1095.4172101063161, 859.4375981595799, 875.530635687464, 1081.6669148214423, 748.3581598167113, 1122.4579502260617, 948.1070868548329, 1068.3136010388885, 949.98037038353, 997.0921348059917, 1153.6351967800986, 1191.8635634468392, 1271.3032081049944, 908.8533187999797, 1050.9974904912388, 997.8811094616955, 1261.133714669648, 866.6156354686516, 1196.8262416680209, 1040.0411281753916, 1177.1115671085036, 1036.1298264926616, 1030.040172555154, 1077.8124676687673, 935.0209171441036, 1068.6753340461612, 923.0878562831713, 869.1408207654134, 1241.3581127504754, 989.9529168997735, 942.7633867014887, 977.9143308794061, 1146.2437649907188, 1050.7846519172626, 1074.1065611202846, 978.0997422863821, 927.9331381210422, 1064.751224823779, 913.7185032945775, 655.3523918788675, 1075.7643172630187, 1076.6398381741496, 1228.8596947512897, 1027.658930490453, 1330.4924593979938, 1159.4844955707551, 1275.4361052791944, 1150.4036385015706, 1080.5739072393058, 1162.9025362683722, 964.2669028312446, 865.9463173672846, 945.7786068292269, 1205.124176958049, 1034.8156620684663, 1052.5616745381585, 1131.676723846304, 693.6309302186093, 951.7211419948513, 915.0209135595986, 819.1880036585607, 901.8985890252752, 901.2948014833578, 1048.726521858562, 926.347344861879, 861.2224538284504, 681.174004640193, 934.6257227875209, 869.7619217874402, 1192.2816795115166, 1099.224980839397, 1092.9038308094255, 1127.1955717918906, 868.5263735025007, 862.8380778001912, 900.2422577137262, 984.0067004876903, 976.646342859866, 1172.9993817225711, 984.5248617491352, 1223.2236681955835, 1223.2718868563165, 926.4424561530095, 947.9316509837295, 1065.3985578765798, 1006.6514041719781, 1029.9881699102084, 1079.162843319728, 1141.4999034043374, 1072.0252315550988, 1131.5911708612969, 920.3426941416354, 1124.5342264478666, 1064.286312859629, 1096.7220509996619, 912.1248924034958, 930.6296952393936, 1012.9943661119943, 1132.3678371225124, 980.929839451198, 936.8329307034523, 868.7552790744686, 1011.8603607777345, 1104.8891499043818, 1172.898360217511, 918.1548143794781, 1207.7128663614062, 1208.3834259032133, 1026.24011568764, 1012.0127010014029, 1177.8507065490091, 977.4114525538351, 1209.6673668846847, 1117.9886397360326, 1160.390051271446, 1019.4632064122088, 1116.5642492027694, 951.016932243351, 1221.5339985962332, 756.642685197739, 1108.0516640423302, 1213.0486484930811, 925.1974797761296, 1308.1619876399868, 1105.6977803843777, 1009.1153544364691, 1326.7414026212018, 873.1582159928004, 1216.8872866162271, 999.1155635163834, 1123.528212021297, 880.2785450409955, 925.9345161623734, 1147.4810160713355, 898.9248847166822, 943.438583064964, 1106.9884706010323, 1173.4577508088025, 1083.7648194417175, 1002.0952396824538, 1003.3381761606163, 831.948616951628, 841.6874670133428, 1094.2235295777255, 910.5845619579505, 1036.1667208936572, 1123.0741724369016, 1054.5987165146205, 1002.0170278366492, 898.7075034569173, 1092.8546498241851, 1196.796555576551, 1071.6727241142698, 1026.6343130180262, 1129.4189234872167, 932.0015943160536, 1134.6124822845827, 899.9187462872283, 1026.495886710794, 999.4365895756976, 897.5602381342087, 1118.6069893194178, 1287.668464127661, 798.5619278605926, 1030.896589101893, 1228.9293932127764, 1176.0876136874608, 1042.22442924672, 995.4207516536818, 1194.40199780064, 1495.5445791974414, 1174.8535685931072, 1052.5300171554773, 1225.569734592309, 1171.5090158893354, 1234.081820546266, 1041.6967849480895, 1090.0121874111162, 1328.0295253287102, 1077.9697338703713, 1330.7288750349032, 1297.317191638928, 739.3834678584151, 912.8379221919656, 1047.5215416762207, 1108.7472063094995, 957.2338981287761, 1256.504351066392, 1037.0327525113992, 1062.8506852609826, 971.7278871096546, 981.9618216485237, 1197.404802606863, 1123.0747689859377, 973.9056329812679, 787.0004501056197, 1155.9222220251368, 1054.077528280772, 1103.6217802364845, 821.0165176995724, 1094.696080664219, 1120.0438288189714, 945.1159966283097, 1369.2401292929544, 1082.2224377960645, 1021.3909888980988, 1099.1254437845082, 759.1340005996913, 769.8929796350678, 754.492610229921, 1139.0347999646326, 1228.3864170251293, 1316.2212188504373, 1031.159613682437, 1163.3603175410335, 1157.8117511386668, 983.8816406026141, 1022.2073385745625, 944.5972358352296, 827.5012852536732, 1201.4155839530436, 965.4828062523184, 1067.7905301287255, 1453.4865724367617, 1288.707976412536, 993.7990269269336, 1022.5373344534632, 1125.0568458903776, 1235.0296255893256, 938.444628650867, 1010.6226502526335, 986.5605179978252, 699.3197859128135, 1094.4835495099533, 1145.8585675036736, 1005.4009631375847, 1096.2418260664738, 894.6382685272876, 1133.1339776386808, 999.9734042647941, 1045.9052686474743, 965.7789612107584, 1074.9468312068389, 1007.373925965132, 1016.3049409200834, 1055.8564745696315, 976.1403044622696, 978.0258791499695, 1212.9845864998747, 937.9049626291527, 910.7744388114005, 1351.7820019224234, 1140.434982074052, 1097.153335418479, 1089.0303821073892, 930.0317551198725, 1142.8950968537463, 1065.1604580162439, 1012.7821434707064, 1078.3784952311278, 884.9768076896466, 907.8812039413333, 845.6315551752245, 925.5986325841449, 853.814614890727, 760.7747247955716, 1192.0314247684262, 1074.9805367704748, 903.8542544076333, 1250.1838514888068, 954.083793716532, 1224.7013779223223, 849.7257691894596, 1132.6564581973976, 900.7283834407167, 1074.5384055401303, 1059.8642401103755, 871.0305073675561, 1040.1042777518508, 1119.214092680081, 781.4216856045833, 1107.2081914089815, 1237.4414507692622, 952.7127311352372, 920.922198937511, 1278.1863120763146, 1065.0953902931324, 965.8672500494697, 717.696454475153, 977.3998252210747, 889.5463294991534, 1073.4411873629542, 1413.9856640051737, 1124.5140146808064, 1056.8247877024621, 935.5500587582183, 874.4441200881447, 935.6303198715541, 1032.6517961410852, 1186.8241790655843, 908.4362960119417, 1166.322083216556, 976.7192744272755, 1068.5728995608135]  # Truncate for embedding
baseline = 1037.5
mean = 1048.6973173043389
std = 148.03624054759902
p5 = 808.8401688609204
p50 = 1046.4219870903469
p95 = 1298.0528550864883
display_name = "dFDA Simple ROI Without NPV Adjustment"
units = "ratio"

# Create figure with two subplots
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
# Handle edge case where all samples are identical (zero variance)
if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)
ax1.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key statistics with formatted values in legend (use format_parameter_value for full units)
ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {format_parameter_value(p50, units)}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {format_parameter_value(p5, units)}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {format_parameter_value(p95, units)}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {format_parameter_value(baseline, units)}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---
sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)
ax2.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key percentiles
ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"
exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title
fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark
add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from
output_path = get_figure_output_path('mc-distribution-dfda_roi_simple.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 1,038 |
| Mean (expected value) | 1,049 |
| Median (50th percentile) | 1,046 |
| Standard Deviation | 148 |
| 90% Confidence Interval | [808.8, 1,298] |

*The histogram shows the distribution of dFDA Simple ROI Without NPV Adjustment across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
