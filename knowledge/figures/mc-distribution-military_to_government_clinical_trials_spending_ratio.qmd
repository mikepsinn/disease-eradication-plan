```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Ratio of Military to Government Clinical Trials Spending (10,000 simulations)"

import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Simulation results

samples = [593.5939246298082, 699.6367294745922, 562.7284650342084, 550.057001105255, 815.3333333333334, 741.0930437527662, 606.3061183942327, 639.4353031808993, 616.9036393621042, 681.9070804577981, 554.1024461850081, 560.8883320570147, 610.8122994762684, 531.4274946401772, 582.1296564161381, 682.4177231223683, 589.0578051748084, 690.6082350152822, 554.1653568959163, 619.3565576810387, 629.4499252894213, 667.9907798177236, 520.4238886215786, 627.1667611873405, 648.0793108487719, 642.1905897242208, 577.6281260406025, 589.2912006510059, 585.9622492102923, 584.6938667424905, 498.3333333333333, 646.3802562130124, 654.6272278755251, 678.7064960983465, 571.8671552830439, 531.2255589590592, 624.1250877664868, 680.8550989282264, 679.5777401931797, 569.5007453902484, 563.2138543560638, 576.8781451111953, 666.7579580434164, 598.77597056978, 607.1168685425909, 599.7431821497985, 554.6316988608756, 599.3907296451092, 567.5718262639584, 610.6990088717084, 594.7041378980638, 570.8193289090452, 766.7426342671235, 639.6980011879131, 651.3518594099698, 664.6340867855051, 636.2946179989599, 498.3333333333333, 682.9524842034983, 548.2338124493425, 805.6961149933248, 640.8649720885905, 603.7755497258754, 573.9094154584378, 565.3789752353923, 559.8440896887039, 641.9284173609691, 650.7262847409779, 555.5262838655277, 629.935882468169, 736.7949346814912, 714.1163600793981, 687.3537087899563, 580.0654888723244, 605.2476447677183, 566.7855565848871, 647.9958407763858, 604.0803857280125, 571.2090982210913, 638.9072606468696, 582.8787152463663, 666.47176058952, 643.0312752529519, 644.4721966933353, 723.9912381952577, 580.7739130267169, 651.2761493022241, 614.7423934798474, 581.2072411445909, 583.5944761961598, 568.4924286319782, 622.9700784131079, 647.6889429261686, 621.5710344387703, 806.4862580809065, 765.0538181605863, 744.4393367874952, 693.7895575220878, 586.8725999810085, 686.2040611001522, 644.1962154072588, 511.73506791572305, 642.5084357429272, 563.6011832475708, 688.5211327405616, 631.0033549508619, 689.8755574950638, 641.183515855657, 556.7033381787761, 813.5975010284545, 584.441572775844, 598.376247516726, 661.082281655693, 764.8766972276698, 610.3661859878687, 655.9814271838087, 598.7390375266781, 614.0536061612714, 498.3333333333333, 633.5725468613199, 697.1088795160332, 602.5816317706312, 599.6492056831389, 505.0427100342373, 557.0500381357649, 589.8967327794755, 498.3333333333333, 722.8672724381354, 664.703655036313, 687.9405486718989, 645.0957040198249, 753.3154756383942, 570.5552445751705, 632.2734740507477, 769.0439769744994, 695.8980187364127, 592.9687017491946, 556.8488508301818, 498.3333333333333, 498.3333333333333, 585.8445525855819, 693.1491448420936, 815.3333333333334, 596.2312956410436, 678.6388810809246, 647.0730729045279, 662.5051399544957, 626.1353801548775, 538.6233891543133, 604.1883048214878, 627.4752871094304, 698.9718812716078, 804.2492446317583, 652.5964897497842, 619.6427785284814, 498.3333333333333, 606.1293431587499, 547.28486138969, 653.6126580535888, 722.2613850985013, 691.1242033982915, 671.5449975010204, 498.3333333333333, 679.3258534205554, 556.8246600580198, 685.9943131157988, 550.6498373068229, 587.9156961640837, 627.3251940290077, 618.6770264462424, 665.9020704911585, 583.6265656869494, 650.1521341425565, 728.7381193791834, 737.1591941642469, 603.064600360528, 498.3333333333333, 603.9753223137782, 624.4759188287481, 594.9388111778283, 510.9746281399932, 599.6933283612383, 646.7297555131075, 533.8777541216346, 584.8384978868223, 498.3333333333333, 602.2959201991061, 728.5562714386054, 751.9065208675295, 498.3333333333333, 498.3333333333333, 629.0471426941457, 644.5841119746685, 498.3333333333333, 710.0139345968862, 685.3207464198376, 569.9966857138977, 645.4663997452051, 616.0410956256783, 627.836815852878, 591.2619694726213, 499.7160317526574, 609.0182011373204, 569.9548971024556, 815.3333333333334, 619.2669694759203, 681.1058601819323, 727.6521356356633, 683.961311851218, 640.8065040319725, 551.6845418982681, 745.0431881929334, 613.408113587956, 652.4293250615265, 640.3115176308548, 545.9739558503023, 577.2264792992853, 507.46455833449227, 627.1649727986417, 669.1932702122924, 632.3974146897029, 598.0350412325226, 602.7767361793672, 706.4907596567674, 609.0251414618311, 599.0581601385464, 498.3333333333333, 498.3333333333333, 681.9233717941903, 637.2284067766878, 767.8015692010422, 660.8096685442458, 592.8201714879564, 522.3341068344724, 671.8554272123114, 665.8509169382157, 815.3333333333334, 627.7783790580048, 703.0906359622311, 655.9772400260654, 683.855490499277, 622.6549973102015, 815.3333333333334, 768.4092106578001, 498.3333333333333, 738.695876859901, 708.4163548329385, 498.3333333333333, 498.3333333333333, 720.1432532791918, 643.4316006335185, 590.980053352277, 498.3333333333333, 692.9265517855201, 634.0222086199524, 560.9188629018405, 584.4175979049573, 644.0413863293242, 625.6129341901466, 753.0194291978656, 633.4828470798108, 635.6276178357454, 598.7753560700628, 658.0147910802317, 581.8487363732661, 544.9591266742332, 604.3055180726421, 590.2582892545862, 611.7551718438206, 615.6569895257059, 671.2499691111589, 592.7570207002992, 622.8806109682193, 498.3333333333333, 498.3333333333333, 587.8526221627928, 674.5954216030436, 710.8508650373299, 524.0238288996638, 596.585841560966, 581.2492459638681, 815.3333333333334, 550.9226474234376, 583.0431762428096, 710.5417963867142, 651.4417691939785, 596.516664054824, 611.8056358429067, 637.5940091402609, 623.3435522301982, 634.5312749304481, 604.5130963977973, 498.3333333333333, 815.3333333333334, 633.3824158572974, 602.781136565902, 594.2145619054098, 643.7142166926102, 815.3333333333334, 591.9408656962482, 498.3333333333333, 779.7644525185851, 555.136954071005, 640.3768863259357, 620.2028757694717, 701.6232625829886, 640.8320475550885, 511.643364100363, 574.154717548172, 498.3333333333333, 525.6059619636127, 584.1151806866251, 498.3333333333333, 584.1217248995789, 557.5255898913082, 637.9301641195302, 610.774607191723, 669.3120269670418, 546.8362984533688, 721.2092092994062, 560.5821201759652, 629.8865853610547, 526.3178404748627, 562.7003006534319, 498.3333333333333, 564.0565012259158, 786.3280313512137, 620.6212348775754, 720.2129129900393, 655.1008495401014, 498.3333333333333, 570.3923951996809, 669.4328412880476, 695.6136361642536, 613.2500963811417, 727.2923088928007, 667.2078602985603, 593.0755773043933, 528.1624083037798, 572.3618621461536, 815.3333333333334, 593.6188391593801, 610.3732008445697, 585.8809892083221, 498.3333333333333, 815.3333333333334, 660.8410507711394, 573.5874652509779, 787.9791720758552, 498.3333333333333, 589.0856217955455, 556.2849454482401, 659.2469740057327, 558.4764630993712, 538.3288589424673, 598.7245623625122, 598.6153423725465, 596.0433438387987, 682.7491305308736, 626.6409863196654, 627.0159899822041, 588.0253752105297, 546.1658656054651, 702.4922186306109, 624.9527009757078, 498.3333333333333, 673.0238602045755, 679.3961173773337, 600.921385695964, 556.4314970027237, 614.8210562067268, 508.4054847971687, 555.6049461799029, 556.6025134350206, 576.1210523620388, 498.3333333333333, 630.982501472508, 815.3333333333334, 498.3333333333333, 650.3637063543827, 607.7576351120729, 510.5766472823775, 791.5623773377199, 732.9165361051008, 791.3918053822873, 677.1117736343879, 584.0767002128767, 578.1903878248986, 595.6199951595356, 759.3064085441498, 815.3333333333334, 611.6673625246076, 651.461375607421, 582.696455492618, 566.0073953798044, 605.5511151446116, 562.0761486601849, 598.9876149379725, 577.7834625572003, 669.8935578364153, 629.054090860526, 601.319626029966, 558.0240511723409, 645.3995974777608, 578.3996505700102, 635.5858373921213, 624.3939192240666, 557.4233517250065, 815.3333333333334, 740.1650284380894, 770.9676656871246, 815.3333333333334, 667.7775409085224, 562.797049195036, 637.0376417433145, 601.2465858618285, 535.8824722638391, 508.54776011395376, 620.7836919700305, 505.6642183097403, 608.905726224534, 680.6301581598583, 661.1021125088688, 770.6886164243542, 684.7796589882389, 642.6433591634161, 559.1578783644293, 498.3333333333333, 754.2249043464789, 587.3612049369618, 699.7227279415573, 581.6286115669407, 625.4078880707632, 815.3333333333334, 550.8659889633446, 661.9421836795009, 656.3278867242219, 704.2242673414377, 665.8618321963227, 584.8991752030682, 629.7804442867748, 591.8936023628909, 589.5399076435024, 509.3326588772072, 641.4718647788661, 770.0664158174259, 538.4765149483978, 640.6042326891205, 532.9053373266319, 588.0265552398173, 625.4117001222412, 590.4690850577023, 498.3333333333333, 498.3333333333333, 610.567182574151, 603.9609252477791, 537.4114706769573, 681.304228123062, 591.5810965112975, 617.5736989355079, 592.940688086598, 680.3016850734019, 789.3597304427122, 815.3333333333334, 711.627354705567, 650.439742069134, 637.6719549355993, 498.3333333333333, 533.9123728720689, 690.8737386526609, 590.5445977866685, 646.4316149148452, 636.9979411788466, 602.1450495582902, 571.6485379760148, 641.2008303023094, 538.875176412106, 715.4739899695259, 615.1958508191445, 498.3333333333333, 599.4277687997387, 498.3333333333333, 608.949968108891, 574.2839163269773, 619.8655630303625, 628.3608751283954, 675.9241376394145, 584.7302665532692, 681.7840040058309, 568.4787992233107, 536.3451055580636, 589.2144434210605, 637.1417963422887, 583.0749409510148, 638.8557141911573, 550.3877394832213, 815.3333333333334, 640.9204317199705, 815.3333333333334, 773.1501190102493, 504.52464083122874, 553.0554855191284, 671.0829042421366, 774.4144997527433, 815.3333333333334, 657.0827682239471, 498.3333333333333, 584.4093227189708, 658.3495111663403, 582.2990844525825, 784.4171977993124, 637.9876680986249, 608.3697501204118, 622.0464733516143, 560.0145441526679, 590.7613495156489, 568.2921747703484, 668.5866448891875, 552.8812336079953, 498.3333333333333, 691.5410191653456, 684.7437121272106, 507.64438644540786, 629.9388755669987, 500.1177925490021, 649.1833348136454, 498.3333333333333, 606.0413933391084, 596.9090023746064, 498.3333333333333, 642.9324196231372, 689.1404034152226, 649.6523471802554, 583.1889237349086, 785.2444068742184, 570.396693869161, 656.7109970740229, 529.0327366858302, 815.3333333333334, 676.497955136686, 806.3328852922742, 679.7200842827797, 597.6648219446885, 629.0250939958213, 634.637720543986, 627.5166348564624, 600.8434946625626, 694.822784791616, 565.6755096578114, 568.6776443654506, 587.9095706701451, 575.9542630916065, 594.1843790294514, 498.3333333333333, 622.1205149978791, 638.7340493215918, 673.8257195775991, 698.4516824576377, 731.7628353207695, 684.8340883994606, 620.8984126638645, 591.4943038368083, 611.9027381685448, 674.7957175396109, 552.7243365078889, 563.4731081314486, 627.5514748620295, 665.7527860997628, 576.5138028688998, 601.954068114115, 765.2242882727402, 620.6976026350379, 596.6368314039688, 685.7287232429911, 601.819245661685, 766.349945584451, 507.599610567628, 517.5288060435967, 634.5723214783751, 589.431684441866, 815.3333333333334, 717.741038981959, 637.7168241516307, 704.592435099361, 565.164313687542, 498.3333333333333, 720.941835640263, 680.6354728759276, 598.5402292830707, 498.3333333333333, 728.2212890020858, 597.5667231113289, 498.3333333333333, 800.2116959719393, 737.6662016570574, 647.7128645839459, 655.2820513240947, 558.5542385707587, 598.0950150989188, 815.3333333333334, 578.7986883599486, 659.7680493277954, 514.5268426717552, 663.7357359301353, 664.4539609715024, 577.0179460745923, 561.8880844049597, 583.4848486762197, 806.1787361381589, 577.2320803409352, 698.7654016656907, 598.5525809369954, 761.1371303678885, 583.6090903339395, 678.1234576102405, 737.9197757504327, 565.2033370088664, 598.0961040597165, 662.6543670402922, 498.3333333333333, 649.0368856968246, 613.2996455091544, 596.1454469298824, 663.1061524968889, 581.8767742553923, 656.2926713056501, 646.7848512336855, 504.65975079360885, 699.7291975920043, 815.3333333333334, 498.3333333333333, 498.3333333333333, 646.2915406918379, 815.3333333333334, 638.9943260619448, 637.1398283108681, 629.831712416432, 711.0032918589607, 574.367577920441, 578.1682554169438, 773.038908363627, 566.1943624346036, 498.3333333333333, 603.1099427105373, 641.0523396736735, 626.2263235211137, 571.9166656836389, 814.1963267210748, 603.6571087695816, 645.1462593756238, 498.3333333333333, 628.644367112665, 498.3333333333333, 709.4989292934139, 573.8381338774989, 592.5506974602315, 683.2156680044633, 602.7173264813221, 521.5703099644998, 640.0138519614435, 807.3061642840303, 616.9599323786747, 685.9528882778797, 641.437652327046, 621.7102634175618, 809.7362062383258, 793.8943471256952, 581.1153275350584, 655.4493036503156, 815.3333333333334, 560.4146765281356, 595.898657918226, 670.6324104598609, 743.4806509457696, 557.0035500046826, 590.4284317330277, 498.3333333333333, 585.4390923163111, 587.7218886357335, 628.098993263633, 558.2749709401492, 571.2436695800754, 517.1000530003894, 655.3397138561843, 648.6292001700775, 652.0334661020524, 560.0148393780235, 498.3333333333333, 650.4526154940048, 647.803433673531, 592.9286826884619, 634.0589455626146, 549.3004473209182, 815.3333333333334, 679.7588116231333, 676.1617539292732, 815.3333333333334, 691.0018160341504, 687.0000364389249, 630.675901878465, 533.0956767732391, 634.0057118371207, 698.2295286452897, 619.8782871905667, 540.6145199838097, 692.022460891584, 686.6230975215901, 575.815212436236, 632.2214708319374, 569.7128357085289, 616.6705628926387, 566.0270582090219, 698.8835498341895, 616.5551687075803, 631.4005299349751, 727.1854569521464, 784.8512389808442, 567.1072439676456, 642.0997248366691, 696.9226101514337, 622.7979626224322, 531.3367701944978, 815.3333333333334, 773.4179990893131, 687.6365487295416, 498.3333333333333, 595.169719525555, 561.5926056701578, 715.1948612240104, 711.9636203515131, 583.5048159198209, 611.3801303500018, 576.4923309573884, 629.6617513980325, 595.4866098002508, 604.110824871482, 560.8899814151686, 558.9286139129734, 794.6291241685049, 815.3333333333334, 546.040179539861, 524.4171988915508, 696.6690799258245, 815.3333333333334, 608.4020122236335, 550.6983110908047, 498.3333333333333, 578.7371760513761, 643.6989568041738, 685.1896941746215, 614.8191974540878, 638.1360619020368, 695.819923556381, 498.3333333333333, 498.3333333333333, 530.4008771010213, 687.4688443996824, 555.723081052563, 570.2494214418334, 583.873187400405, 517.3339466847667, 570.5401940171577, 563.4325021046824, 570.4352770919949, 591.0341559871014, 815.3333333333334, 609.5264901015014, 658.0829613206238, 737.4673080562898, 498.3333333333333, 498.3333333333333, 505.03904816297467, 597.1246692995524, 505.993025147991, 614.7748673011625, 600.8860337989452, 707.9010747772011, 587.0682898803511, 611.2254914905476, 741.1699446022835, 619.4508853468938, 621.5718798167181, 498.3333333333333, 553.119866337406, 614.8196285222821, 597.5845352551455, 612.4109291993517, 630.8126187986855, 706.1866740470269, 626.9055306971319, 673.2262671484049, 732.702285365883, 579.0891944864295, 587.4711821577374, 815.3333333333334, 624.7787017479299, 546.4356902507328, 539.422968577247, 543.3915120963502, 612.7998309097552, 681.2539766593903, 706.3838590524057, 590.7642031659996, 588.3152433874297, 513.0734796708433, 534.6177686867754, 625.4934562911021, 731.720116104927, 639.6547331530168, 599.8479031255793, 630.7498426477158, 659.796126277497, 597.2912681293526, 653.9778140436896, 663.7737884674202, 593.1151274325681, 646.0378940709946, 597.9198781446363, 595.8391044331659, 715.0799440524618, 652.2004885171337, 498.3333333333333, 718.6448321688214, 815.3333333333334, 815.3333333333334, 613.5199350845102, 613.3871129112829, 624.3990572116077, 521.3789986817147, 815.3333333333334, 587.1426634963208, 498.3333333333333, 713.2535581470064, 644.3230981909372, 673.7744087310984, 685.2894691282938, 640.2032844984718, 498.3333333333333, 498.3333333333333, 640.9459126185961, 498.3333333333333, 613.0448374100082, 498.3333333333333, 622.5831008404466, 606.0724674652662, 589.2890539472648, 498.3333333333333, 555.9717100909761, 670.1015449847872, 548.186558460344, 642.937199616609, 652.8656623245981, 552.167295001157, 613.3747451633699, 595.455779011916, 614.6325907419017, 591.3321983108011, 585.1041338522551, 815.3333333333334, 568.4115562320859, 692.5250867852005, 764.2457615676625, 619.9864720135408, 609.5002087656403, 668.9979728932443, 557.3223374102525, 747.6292652438854, 646.4212000803749, 660.3480760464255, 619.1088869539838, 595.4352085802745, 694.7246891519754, 564.4953572252451, 611.0339357056474, 815.3333333333334, 815.3333333333334, 616.5725001684195, 632.1783920343283, 623.338462775068, 617.7305367244682, 599.2496982497839, 549.5903333024413, 710.6469814662428, 720.2072838965751, 707.8781488151085, 594.7185816035366, 517.8700846617769, 648.313171535628, 815.3333333333334, 809.4412644353937, 680.2746211433204, 658.2041397849296, 646.5331015042099, 612.8242104905548, 639.0909672649833, 540.5948187985032, 667.5977972711507, 682.6651100707147, 581.3375375796122, 780.0693568128563, 587.581894181331, 608.1456282706041, 626.6345159935615, 498.3333333333333, 663.308078526664, 498.3333333333333, 632.5165688777894, 737.0101307786458, 610.5277992286943, 705.228848073506, 673.6827147272132, 587.0653363491078, 576.019908756441, 663.3049202635613, 546.9790498640815, 527.9078582837675, 498.3333333333333, 577.8285456002232, 504.57266312496785, 815.3333333333334, 639.5627804994415, 683.0485551922981, 606.932154488352, 659.2869025167378, 628.0410504446143, 498.3333333333333, 628.3091031343232, 585.8878654022458, 633.0349180725138, 610.10419296694, 615.2196106629044, 583.4691420880072, 527.0046216745641, 498.3333333333333, 593.2453665920696, 573.6808863852312, 716.8775245540717, 622.1788420386271, 550.0751393673879, 554.9946110758082, 600.2520021298959, 553.6382430713531, 580.5099865496686, 522.9706566908702, 594.6870566568832, 642.4648978670772, 591.3847551882022, 815.3333333333334, 588.0611711278846, 815.3333333333334, 812.9088326507515, 583.2284232943977, 581.4312990670292, 718.6999411020597, 670.4899990110642, 503.7853884012032, 652.4184373259139, 498.3333333333333, 615.8048299321085, 586.2920192645901, 498.3333333333333, 606.0746972051325, 694.2133362475006, 623.8096410284217, 618.2953114379077, 751.3425607133923, 634.824360362926, 672.9113031783439, 551.1260117273822, 613.1156836753343, 636.878289436739, 623.5447354924108, 599.4247329623383, 571.8099685768497, 693.9944993405362, 699.8830826405074, 534.0664407336116, 646.8389798109351, 759.9862393048918, 583.7845652074927, 582.4184118809296, 779.2260271181713, 598.9682161589243, 563.7316763019737, 588.6602404899252, 570.7719236429689, 757.891267571806, 591.724996515483, 638.3925997216072, 652.3215298558988, 554.6897187088487, 498.3333333333333, 498.3333333333333, 509.9876724723426, 623.8101439662452, 590.1901441581106, 561.6258667464319, 606.79023569611, 606.0937878855276, 557.808523222123]  # Truncate for embedding
baseline = 604.0
mean = 624.1182161596913
std = 81.0276201914369
p5 = 498.3333333333333
p50 = 616.6351559373353
p95 = 804.1451696193816
display_name = "Ratio of Military to Government Clinical Trials Spending"
units = "ratio"

# Create figure with two subplots

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---

# Handle edge case where all samples are identical (zero variance)

if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax1.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key statistics with formatted values in legend (use format_parameter_value for full units)

ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {format_parameter_value(p50, units)}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {format_parameter_value(p5, units)}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {format_parameter_value(p95, units)}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {format_parameter_value(baseline, units)}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---

sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax2.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key percentiles

ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"

exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title

fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark

add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from

output_path = get_figure_output_path('mc-distribution-military_to_government_clinical_trials_spending_ratio.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Simulation Results Summary: Ratio of Military to Government Clinical Trials Spending**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 604 |
| Mean (expected value) | 624 |
| Median (50th percentile) | 617 |
| Standard Deviation | 81 |
| 90% Confidence Interval | [498, 804] |

*The histogram shows the distribution of Ratio of Military to Government Clinical Trials Spending across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
