```{python}
#| echo: false
#| fig-cap: "Probability of Exceeding Threshold: dFDA Total NPV Upfront Costs"

import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Monte Carlo samples

samples = [281634264.35156935, 208379683.31365275, 311224804.23967063, 324775769.22426033, 175000000.0, 196497461.69956112, 270689232.775918, 245051969.21426088, 262056556.29868725, 217288878.9922177, 320352573.4003252, 313138140.0590948, 266965881.5059028, 338657249.47967935, 292099464.97747844, 216985006.61698318, 285705099.39427626, 212198943.07225168, 320284520.8191321, 260118726.70848286, 252372139.06430393, 225828787.77641273, 345971670.95490104, 254093123.753511, 238975356.61550245, 243089495.91996497, 296372850.14870125, 285493443.0206053, 288535293.47311366, 289707407.58137035, 415000000.0, 240151343.98755208, 234525059.08382964, 219208465.9202806, 301983539.86113054, 338788720.26999784, 256414024.30518696, 217916956.2487311, 218683352.6463757, 304335639.1597449, 310723099.9762759, 297094154.0284831, 226610114.4273026, 277091879.7370333, 270013462.9720411, 276256534.77941597, 319780755.4721802, 276560486.1813772, 306273790.5164244, 267058523.84341738, 280651507.0098661, 303021570.48351693, 189796090.87054938, 244863812.13895562, 236735090.9499836, 227965944.19928378, 247318801.09930664, 367763989.08601457, 216667481.6663786, 326799951.5658201, 180443577.54400104, 244030649.45817274, 272815296.46009195, 299976015.14130396, 308500272.4254742, 314231976.25153404, 243275188.2378911, 237160833.62370634, 318817783.57092375, 252008151.10865656, 197666572.97858313, 204070980.92484203, 214081082.7648229, 294047179.26962364, 271575402.89611936, 307069270.4832411, 239032922.8140184, 272557830.48987746, 302634805.3085491, 245430851.9518024, 291397565.99050426, 226792092.43741268, 242495519.59482986, 241482629.89985982, 201232454.3291027, 293376477.9753399, 236786553.8932197, 263782414.248111, 292967382.4622918, 290729287.66082984, 305346422.72524726, 257303880.86446112, 239244762.20686537, 258388122.1529616, 180263319.25371605, 190223350.02256295, 195596700.65410197, 210383613.51971596, 287698523.9330728, 214752079.92483872, 241676125.64167866, 351972355.0480871, 242864662.931564, 310323643.31081164, 213403003.10001984, 251211428.6703105, 212620436.14798892, 243803981.1410442, 317557523.4765067, 178656933.32049623, 289941425.40288913, 277438240.09033746, 230261367.52648982, 190268270.96502697, 267330972.68170512, 233620578.69935012, 277123854.3730725, 264336116.76653832, 376682213.6545652, 249309676.38789472, 209150455.59839222, 273827293.4713981, 276337528.8926073, 356736712.8904036, 317187774.8328352, 284945434.2591938, 365163838.5049579, 201551582.57705423, 227921336.10966137, 213739812.7581039, 241046352.83996704, 193246600.68137702, 303284051.31249875, 250268491.87415192, 189216920.96819606, 209521667.76741463, 282190039.83759177, 317402256.48359096, 411574847.215839, 415000000.0, 288643750.0232737, 210747122.26820606, 175000000.0, 279308260.0927806, 219249299.65232998, 239670744.46375334, 229337570.09345782, 254876471.42059112, 334037448.83789754, 272466771.00805366, 253859513.20736986, 208581857.24073482, 180774585.76176703, 235891528.70843136, 259894045.2888124, 390984378.8084095, 270836922.2280599, 327861200.02347267, 235206230.6010034, 201724029.1643258, 211902888.27793413, 223599262.6346486, 415000000.0, 218834970.08675283, 317428060.7802882, 214874849.0309943, 324121726.76680374, 286744315.4135238, 253973119.86009255, 260653351.56787413, 227154997.94449496, 290699382.132412, 237552615.75864112, 199895648.67855188, 197566957.56310135, 273417222.4214924, 374770414.10238963, 272646525.3653425, 256144669.2175539, 280444449.82580817, 352507359.9884263, 276299496.98495513, 239908715.07895553, 337070020.3535503, 289573384.39326704, 371145713.5110681, 274070325.9818593, 199946535.80105355, 193615898.1101055, 380857416.3238418, 387121779.3256983, 252674441.10100678, 241404231.82410264, 365011667.10260105, 205273697.39579487, 215269829.68847838, 303840371.1664932, 240787545.7662307, 262743251.44432408, 253586189.68704176, 283715806.3118507, 360621144.9527276, 268438814.419487, 303882055.3162519, 175000000.0, 260189114.19815102, 217766988.10166186, 200199925.00553402, 216070411.98860747, 244072289.1505113, 322985035.6564001, 195435026.27915806, 264856638.8435118, 236004557.5895989, 244425245.88752598, 329335971.14434445, 296758803.92195815, 354997890.6815862, 254094478.85400444, 225070666.98152712, 250176769.76569098, 277734422.3794107, 273661523.68237865, 206317868.4220225, 268433092.45013294, 276847762.31070596, 415000000.0, 400653855.2968365, 217279174.27055508, 246641470.40252706, 189529156.8363552, 230439015.8256594, 282322319.73839885, 344679521.2523863, 223406141.50445786, 227187627.58998722, 175000000.0, 253630338.5040661, 207335605.37977862, 233623367.06532758, 216132923.01023158, 257547453.75148022, 177516624.21522334, 189376319.79265282, 415000000.0, 197147808.66225737, 205745874.13263193, 397081234.16008246, 415000000.0, 202329194.1163044, 242213458.30468088, 283969050.68387043, 387558942.53630114, 210873695.91561976, 248979106.61539102, 313106247.3172551, 289963678.65304315, 241784783.64391693, 255274693.47531295, 193324080.6753007, 249375700.08367735, 247804366.98200673, 277092411.69134367, 232272515.67916262, 292363368.8372911, 330072062.57080185, 272367922.31050456, 284618994.88305277, 266196769.11336946, 263049939.52414435, 223783040.42853385, 282378590.21928257, 257373007.5036653, 415000000.0, 374288576.4162481, 286801876.2797314, 221712629.53130138, 205027192.95981738, 343544469.95858943, 278997824.40003645, 292927773.2617885, 177967754.58175126, 323821430.7740599, 291243806.33773273, 205118155.78626984, 236673998.29550436, 279058353.6468736, 266155701.0755958, 246377054.5276816, 257015625.92150664, 248605677.9730739, 272193001.8140659, 365835071.3175112, 175000000.0, 249449654.57602072, 273657786.68803173, 281084227.4071805, 242014636.24454433, 177550311.5690488, 283107378.5758159, 387441832.0579096, 186564492.09756285, 319236327.3241468, 244378588.9050619, 259455234.94524994, 207777906.18188322, 244054096.25934392, 352036787.6318212, 299736265.7543382, 387873221.42621714, 342488384.93406165, 290244605.0323416, 388885712.45317775, 290238521.4466571, 316681683.5559273, 246134320.3152565, 266996698.5363787, 224996008.06935397, 328364689.8188202, 202024193.79469752, 313458287.5651405, 252045038.46230724, 342015296.842185, 311253953.49419403, 395634970.24799836, 309855077.1364152, 184976638.3114968, 259128212.47669002, 202309234.61118865, 234208112.24787372, 369109748.1719577, 303446086.1081952, 224920094.6857288, 209609040.11375383, 264984303.2195776, 200300945.718625, 226324498.54965633, 282094916.2230071, 340795469.4544097, 301495356.02241427, 175000000.0, 281612152.10122836, 267325225.91264212, 288610167.2550556, 377903325.3015257, 175000000.0, 230418554.87213078, 300291125.1804272, 184581406.3722082, 366200923.2111548, 285679861.03323185, 318004613.8404239, 231461423.05396876, 315673460.5642308, 334224085.8020888, 277136387.736217, 277230984.27906656, 279473043.5756388, 216788142.70106417, 254491993.62907362, 254207405.35318285, 286644265.40416044, 329119436.0215706, 207515756.78975958, 255779310.1784045, 366653422.02132046, 222681542.8922648, 218792660.067971, 275244182.6311098, 317847900.26311445, 263719292.2850166, 354326852.5876981, 318733321.1267667, 317665175.41486603, 297825038.14247584, 415000000.0, 251226955.8432052, 175000000.0, 376891402.7395071, 237408129.91396365, 269481209.34435457, 352788001.0338745, 183729432.43975168, 198733421.97152865, 183769812.28170362, 220174666.47646582, 290280380.9473544, 295833851.4397819, 279844755.0005726, 191691805.80830216, 175000000.0, 266268252.3191023, 236660679.18401733, 291568112.0537599, 307859677.8923155, 271320877.45365715, 311901009.71770376, 276908758.77124935, 296223789.73547214, 224630965.64842045, 252669221.54848427, 274903290.21417916, 316152542.51873314, 240834153.26128027, 295633631.4073684, 247834831.26611775, 256207586.51276743, 316790382.5901756, 175000000.0, 196748725.22544625, 188735476.29836246, 175000000.0, 225963635.90997776, 311153839.32121825, 246779611.29360092, 274965763.7437403, 335782328.16094816, 354225605.1821652, 259001393.96886754, 356288878.77706933, 268531570.81155276, 218051617.55241725, 230248452.9688063, 188805163.71631092, 215587933.36729002, 242769319.53102177, 314953978.4553008, 386870414.5453422, 193008973.58524504, 287250948.8640622, 208353560.386921, 292570416.19482327, 255431246.41385406, 175087477.9516738, 323883762.4360367, 229702389.74588355, 233390037.03447813, 206995178.48462155, 227180664.39946535, 289517185.82377034, 252124488.40804136, 283149671.0620602, 285268166.4198237, 353668076.52819383, 243599077.73640704, 188960730.74428, 334130493.79050076, 244216426.735492, 337698164.8162019, 286643189.26478684, 255428334.56209478, 284428938.3516944, 407375382.1624924, 415000000.0, 267166385.79167855, 272658682.87143487, 334806740.07233834, 217648466.22639948, 283429554.1456291, 261525005.26297024, 282214981.2981997, 218248488.638054, 184252226.72724417, 175000000.0, 204799014.7225027, 237356236.97903252, 246320737.87323415, 406117936.52748924, 337047700.6321478, 212046521.7676639, 284360902.441493, 240115666.18573993, 246808375.07439828, 274198793.6380636, 302199661.73998183, 243791669.85970944, 333878060.77481544, 203676033.22635013, 263418861.45330286, 415000000.0, 276528519.83102745, 362708175.4333225, 268495079.3085413, 299610109.93162274, 259719367.37187466, 253190791.98091024, 220898484.2852072, 289673668.53412545, 217362216.96606416, 305360120.8047595, 335486547.87136185, 285563024.2641604, 246704173.88163874, 291214122.90259826, 245467885.96403524, 324410634.5061967, 175071005.585524, 243991162.3927123, 175000000.0, 188192203.2218178, 357110866.2476439, 321488375.3726689, 223887210.74313247, 187878880.2490259, 175000000.0, 232888932.13754675, 415000000.0, 289971360.2124559, 232051752.21608284, 291940476.6791125, 185436132.75316805, 246092834.07961297, 268974259.84956026, 258018876.5273699, 314053025.7660885, 284165751.0633935, 305547780.60057867, 225452629.46623302, 321678014.3617603, 378983580.62070805, 211664189.17959383, 215609092.01453263, 354869448.5445961, 252005911.74152422, 360325244.5898339, 238215953.2300991, 364488263.0674589, 270910447.3358474, 278715330.8476016, 373564273.9075588, 242565249.04261804, 213044648.98224187, 237894465.09695077, 291107646.719426, 185236937.8412307, 303441807.231228, 233135514.0753971, 340222903.2225479, 175000000.0, 220548308.88499698, 180298280.82305118, 218597743.30668294, 278056339.3663205, 252691005.46614867, 248527702.99325082, 253828230.49090183, 275310933.06970346, 209852397.76628697, 308197738.2150175, 305160367.38016087, 286749904.7153724, 297986425.0713676, 281110938.6311541, 414608521.6005245, 257961445.70620182, 245555331.25193235, 222186361.68817803, 208740316.10039803, 199052982.59854224, 215555901.7995422, 258911897.28044513, 283507361.9085281, 266076705.7599158, 221589607.04381227, 321848913.18244994, 310455641.23950845, 253801875.97591016, 227250243.1117507, 297445539.1296965, 274361548.7810356, 190180135.70065543, 259068585.8031626, 278953221.9953557, 215030458.23349774, 274476534.4425311, 189895268.5785992, 354901421.08149624, 347948425.4318769, 248575605.54662225, 285366160.4504146, 175000000.0, 203019894.55401322, 246288328.36787948, 206884856.85426852, 308719562.1281768, 411627074.995857, 202100611.3076243, 218048434.41008514, 277296069.29544395, 377471865.6912252, 200040342.33963755, 278141735.4240478, 395692896.63902736, 181704678.24548033, 197428469.90588003, 239228239.66768098, 234087026.44033864, 315591212.5733367, 277682327.19001275, 176941031.73054913, 295252413.73523766, 231119731.10378867, 350021933.07095075, 228543186.50987017, 228081505.65630415, 296959494.17593294, 312096380.65210813, 290831489.77744436, 180333432.91818967, 296753416.41153204, 208644724.8738013, 277285365.05210036, 191221624.94956216, 290715667.5528712, 219560956.37782687, 197359279.05024636, 308679679.64038587, 277681381.42320174, 229241013.92894349, 364172336.2034669, 238316474.7454651, 264944261.58770674, 279383507.9278973, 228949070.54577142, 292337012.8352684, 233413454.16375074, 239870500.99198258, 357013213.9111794, 208351595.42608815, 175000000.0, 377456699.07149017, 415000000.0, 240212991.9795803, 175000000.0, 245368318.52834353, 246705598.96486664, 252086107.78810543, 204982361.25699735, 299528462.30746233, 295855039.643477, 188219811.63430122, 307669483.300233, 414894862.8359154, 273378772.3590449, 243897283.83985138, 254807249.5811596, 301934627.5943344, 178522957.34882706, 272915433.1231937, 241011031.64388326, 398054297.6537158, 252977294.85353905, 382308880.1349591, 205425676.2325463, 300045738.4510038, 282562554.66793054, 216511473.3094842, 273711984.5900095, 345195035.4610822, 244637878.3539252, 180076648.15291578, 262011835.78364378, 214899108.46102116, 243623375.57597804, 258279907.07725805, 179525636.4810365, 183179139.98666382, 293054082.7752244, 233975347.56932586, 175000000.0, 313633564.33679676, 279599996.2627237, 224168479.92074212, 195853923.4090119, 317237315.08034605, 284465576.7889351, 415000000.0, 289017858.7586999, 286921239.298185, 253388260.78538018, 315886692.9338017, 302600537.0454955, 348243081.18952996, 234048514.36460614, 238596650.54884136, 236272551.0127622, 314052715.9616032, 368047249.10286397, 237347452.83646214, 239165700.05477607, 282225671.12572277, 248952129.152349, 325613382.3122042, 175000000.0, 218574460.61928838, 220753373.97144377, 175000000.0, 211973054.8079552, 214287161.6018786, 251455415.4960559, 337575030.2040617, 248991222.35040352, 208808059.5998995, 259709396.2295611, 332781113.2967099, 211388994.66089612, 214507133.39190447, 298121074.61234945, 250306992.18434703, 304123684.6220431, 262241842.72321957, 307839667.12973785, 208608747.25256616, 262333651.0024768, 250915979.79289702, 200330963.67698175, 185331561.14089787, 306743431.4877681, 243153829.32705504, 209207475.0810583, 257436890.76508746, 338716303.37345266, 175000000.0, 188125734.06049657, 213916495.94394585, 364989940.7750003, 280240943.61848795, 312403719.4738547, 203757110.6607123, 204700356.3146927, 290812870.8629424, 266502286.54624438, 297466267.3627559, 252213379.38849282, 279962028.3493822, 272532141.9521081, 313136417.0000343, 315195769.0371332, 183006425.69825798, 175000000.0, 329261225.06563276, 343281290.3643839, 209285133.53638142, 175000000.0, 268947581.2712927, 324068337.9433878, 393594585.61177194, 295311129.7689279, 242025365.2572615, 215346808.6584266, 263720783.55096406, 245985825.0435988, 209545654.16497454, 414830867.631521, 392499084.05903935, 339326683.344561, 214014060.94669315, 318606540.22460365, 303588454.4208874, 290469702.84603775, 348082279.08775204, 303299021.0089312, 310497509.0057289, 303403405.8098067, 283920423.52128994, 176652978.0113194, 268020249.60748202, 232227528.0604894, 197482774.17653483, 383505116.45139277, 387584821.2983403, 356739354.794497, 278527048.4571023, 356052403.97797066, 263756353.20466417, 275274475.1353487, 205898628.7021134, 287519138.2092684, 266628415.88156387, 196476669.06028765, 260044647.1571611, 258387464.87659335, 393591640.82596004, 321418352.9612629, 263720437.70641616, 278126226.7719734, 265663866.1577166, 251353502.799441, 206408484.86634454, 254291181.46782967, 222556388.30222535, 198792689.7938825, 294975355.99821186, 287150354.37819755, 176549987.096335, 255912553.223603, 328815358.067116, 333531813.82435226, 331044483.44574964, 265348598.40569282, 217678481.3429086, 206349715.43440557, 284163183.1660969, 286380103.7311606, 351034617.88161767, 336593548.3307856, 255365897.04444465, 199064834.84882465, 244894787.52733427, 276166323.4326819, 251400290.04985836, 231101341.83696136, 278381737.4984827, 234960718.7813925, 228518690.00382912, 282059727.4854147, 240389384.07796708, 277834498.79388714, 279652276.409003, 203790508.80218145, 236159421.1196801, 363079470.6692817, 202759482.08441615, 175000000.0, 175000000.0, 264766353.76251212, 264873600.1442883, 256203643.50007367, 345324397.75577474, 175000000.0, 287451006.21774966, 373289591.31090647, 204322768.53879112, 241587136.11419368, 222217997.53156695, 215288197.8586368, 244502527.52407175, 362242464.84222525, 397123378.93222696, 243973023.3741427, 403197711.1772223, 265150276.18350738, 389737662.13651156, 257603082.85541764, 270884466.1943017, 285495388.6760917, 415000000.0, 318339967.6623716, 224500627.59613326, 326852672.5386898, 242561876.68631947, 235709701.7049868, 322456794.4415625, 264883589.7984885, 279989145.7441609, 263870562.98178464, 283652773.97407806, 289327479.5914177, 175000000.0, 305427716.4220796, 211102277.64039442, 190428458.27188122, 259624642.19852012, 268041867.10902008, 225193527.55875593, 316897836.7611035, 194745620.59013796, 240122900.49188703, 230740293.30598772, 260313387.6036865, 280007240.82956904, 209882622.4278788, 309404480.28158927, 266784783.33882633, 175000000.0, 175000000.0, 262319858.83956102, 250338892.24146324, 257019550.73313245, 261400826.8969062, 276682254.2181198, 325292045.1981641, 205087189.5010124, 202310847.36291373, 205905430.31999207, 280638756.23866254, 347714238.4161751, 238814185.06748468, 175000000.0, 179592336.13778827, 218264721.649584, 232147591.76129323, 240045189.55695045, 265328853.9698675, 245298936.11630493, 332793498.19986415, 226077398.45840532, 216838026.87045103, 292844543.9223195, 186490131.58896863, 287049142.4602931, 269159705.8060023, 254496908.2222786, 375543211.29236424, 228818770.8986464, 415000000.0, 250088638.5743856, 197607710.45387003, 267198622.7358215, 206694430.12898204, 222274548.96893007, 287521844.3850166, 297922889.6468666, 228820807.99779958, 328204329.55461794, 340963292.3397983, 362959377.1529913, 296180549.76896894, 357076151.4995909, 175000000.0, 244960636.01785398, 216610513.3170183, 270167196.0322526, 231435212.71201605, 253431983.8417883, 401133184.5608282, 253229811.25272834, 288603830.3043531, 249705801.66770858, 267545740.8415925, 263399833.5848047, 290846137.0335872, 341560113.2559668, 380555667.1044776, 281943898.12803286, 300199636.49978304, 203269321.66217124, 257916217.8431744, 324755728.24115974, 319389562.0915676, 275818638.5625432, 320855404.8468451, 293626075.5518215, 344251054.8272674, 280666587.3227639, 242895441.18010056, 283605616.7937096, 175000000.0, 286611623.7262649, 175000000.0, 178811256.62689862, 291070762.4557882, 292756198.1196218, 202743624.8158836, 224257508.59489283, 357646108.24183774, 236011922.25088, 415000000.0, 262931831.7970752, 288231746.2572976, 377959668.1549266, 270882602.05143434, 210143599.46793786, 256656584.54896665, 260954409.15447402, 193764108.7057674, 248391073.79020977, 222751187.2676789, 323597855.4166696, 265092971.64558533, 246895096.11680278, 256860554.12325853, 276531139.67288244, 302040050.8551776, 210267488.7547388, 208304868.32140422, 336948404.08643043, 239832966.82180533, 191516938.79427952, 290552204.75179434, 291828581.7263103, 186695947.77117744, 276925535.42382294, 310189242.0804005, 286066189.55551505, 303068662.1886661, 192056827.75169963, 283300623.19495213, 245801000.34551445, 236077487.78557068, 319718164.7918897, 366474127.42608654, 393310018.4977776, 353204137.1987396, 256656197.5382678, 284680477.23727196, 312369100.11753064, 270285403.04217994, 270866642.36189336, 316381169.10288674, 259573955.43857026, 223395978.96871743, 239718222.36663657, 303199726.9343243, 263221451.87467626, 283883429.03862137, 305667883.50446784, 241856000.79765207, 311629501.07099134, 286352029.30687326, 199483950.39339456, 363448328.33370656, 235129890.03162336, 181569020.35856944, 208143711.2764193, 209265349.47491714, 266138198.6144759, 247390385.24269786, 243924233.52863002, 302235622.5673229, 283862140.773781, 282350342.0784646, 288347549.89897543, 301994048.538722, 175000000.0, 242420323.04455298, 175000000.0, 265179001.34830177, 262772035.7710395, 332509538.6407019, 343274309.0602012, 275273103.8926745, 235150099.05145, 293257394.8738145, 233703020.2722641, 262962893.9823379, 328110979.1969905, 232145383.8688958, 315101832.1229016, 306169990.439847, 212393436.03693563, 327211661.8823017, 307626010.31240773, 269121873.39003277, 221749069.41837528, 216989207.580742, 233193423.37097973, 297056878.4883374, 212353800.5911736, 290142203.74172056, 199174086.67908674, 251288490.23445117, 269587952.6552417, 415000000.0, 193219365.04368472, 365877948.5993902, 272027137.4959861, 288434384.77880174, 270114049.5641968, 290611738.39903444, 254141198.8199431, 364406909.1321594, 237473462.61920157, 339036619.7421098, 227685821.23623094, 259517591.71325883, 206892754.73209935, 291283195.5251319, 363678342.2161436, 258524907.84002993, 251693214.18134043, 204925958.75197148, 249872386.53473222, 184119172.7731707, 214396519.6506836, 276758295.04534847, 353537366.89475447, 415000000.0, 230651879.10711744, 362877860.3921508, 277812588.637947, 254280027.8472136, 289822582.3574964, 266719875.97645319, 269633141.9286196, 240048172.17464957, 192321872.7929143, 186157121.26148248, 304516614.07263523, 247232498.6001837, 230161382.67542344, 263546773.79890916, 314343648.2529347, 273894083.61302865, 227090529.44258922, 346262831.0818665, 374778335.7413439, 293875603.9822279, 327194744.3876462, 347481395.6616018, 338874341.8515897, 301856293.76171577, 300792373.6226861, 295533811.54529476, 205720438.61114898, 307774774.8404314, 194151817.0674491, 220151827.59479108, 352314803.8613871, 317551260.65037817, 367142398.20863944, 247511025.47327423, 203206319.78417766, 249249271.89532432, 269128230.315555, 267742181.43207628, 339146551.832862, 242592423.893164, 284636732.4640582, 210790121.21378765, 290976097.4206971, 263228250.0003687, 222371276.931545, 249506716.4314197, 252410965.82116944, 247595285.12493846, 391283658.3492908, 257306157.07446796, 249056193.80931464, 175000000.0, 215294885.22552106, 247988424.47374007, 225579900.7703972, 358542807.6038894, 253501270.66628933, 351122249.1671075, 266707214.78229076, 265248407.97277522, 257863074.63432232, 263268815.1886287, 386699092.2531073, 175000000.0, 175000000.0, 232905870.4712115, 263902650.45103973, 307043051.30741477, 292464867.80182946, 241346989.77030897, 330540673.8481119, 331368138.6539739, 274120901.6430844, 326388394.11326724, 279617260.1515379, 231952453.36941367, 307574330.5274583, 269646277.5659101, 263123948.9301153, 365955003.95600826, 175000000.0, 191480834.0842441, 201627989.03065422, 242484285.33126152, 248459192.52091628, 187676152.69513476, 210953948.39003426, 216909732.673957, 415000000.0, 393960909.4987548, 239864531.26704365, 242466759.1200536, 203344918.50301233, 175000000.0, 256245590.38082305, 210355103.66294914, 258091158.49116492, 183813924.4968464, 221766403.69756097, 271953063.36165994, 285542429.26300263, 288841939.16610044, 195693540.24200538, 318582714.0320834, 219875274.08263683, 303128206.98669153, 262418660.78016922, 193259523.0421564, 245054433.53957415, 285488303.71030617, 301779589.7613404, 254865221.14760742, 370814822.0437379, 329687101.7532941, 248345331.7119363, 311201825.1948926, 405804882.03752625, 408241895.15645045, 199788515.72644773, 213741862.97857383, 366938302.1939481, 207527608.6796829, 195603641.44716087, 235897541.083815, 289020327.4342483, 257078492.87954065, 227370022.31297514, 226168811.35628116, 224245703.78459778, 216004742.02058393, 415000000.0, 281179809.99471277, 320881667.4933078, 235745224.6425051, 252310270.29217702, 224184589.93239406, 175000000.0, 193189359.99946105, 175757012.9774734, 175000000.0, 201254114.79365698, 354008786.10406405, 260438885.93214887, 351289167.5565264, 288422145.0869293, 313472937.67595756, 214972570.01513058, 295818144.33336544, 309711993.9748467, 231165894.16524535, 298187329.6827397, 298631949.73290175, 232573159.96450937, 204552232.9572278, 201760866.41408992, 268193542.50062972, 283044850.1305698, 220254097.4591154, 264616617.490865, 298923217.0200261, 302133258.44104785, 372490263.11212647, 350220845.706854, 210193139.20314535, 383657358.94652605, 233542941.3289259, 332460379.1616166, 267082914.16439003, 239843040.57244146, 175853687.3187923, 253125170.90052396, 185501535.44738168, 326728222.42806214, 369570634.9387176, 220037880.29203537, 281460976.9858639, 223590976.3566398, 228497261.9410158, 312906772.1664438, 260783289.21576113, 388512001.96768385, 236106981.95554286, 329083435.62276393, 268849881.87478113, 314403252.1037633, 237969434.8237103, 260140121.94245255, 256324908.46944258, 218117122.27618334, 305120392.57047117, 304312187.88422513, 300469438.1507903, 371246415.0595967, 364022583.27494174, 241850407.85445485, 285980667.26118666, 228747372.82016718, 264425166.00489712, 229972739.02201933, 378230678.14178556, 285381754.04845244, 250503740.48448738, 343735222.09784365, 175000000.0, 175000000.0, 314407526.46720237, 266633346.1390336, 278229649.15399915, 195434878.12895098, 261679116.79713002, 412201173.23854196, 316412837.9419792, 273240734.9932083, 238401829.4176991, 240789286.52489766, 175000000.0, 278678580.9041218, 317926141.9104669, 184828481.45898378, 226817953.01222274, 202969121.42048317, 211891763.36459437, 266216232.0295325, 175000000.0, 301867881.6854243, 311462370.9582788, 248654406.4588813, 175000000.0, 210422637.70889083, 346776346.5565258, 175000000.0, 243340688.02008826, 201947432.0982088, 315023551.4692898, 226123147.4587888, 287968162.1295141, 298583268.2309923, 397019987.47371286, 251351928.30693763, 286172503.23181695, 188614238.49218136, 343488289.03483903, 221839213.1352908, 231990326.44121754, 261736931.4809271, 185356192.30661523, 276881372.2727577, 326740458.25995797, 280891523.03119576, 184279862.97032362, 255848074.9257871, 310637767.3897978, 175000000.0, 206762908.0348787, 320147644.5154191, 279457523.5971762, 288486083.69214916, 399097631.5834068, 292167785.1990406, 304833713.7583145, 415000000.0, 250740952.32214233, 219989994.23608744, 289511083.6359474, 290238382.9317528, 233765967.190888, 208734035.9316158, 415000000.0, 283034295.0074782, 223245998.3663271, 322987045.744066, 256690072.42968422, 248555328.67554212, 298370016.5508928, 196951040.27984393, 284674546.36664695, 403912365.12116385, 292012294.9162919, 241781748.62221375, 234795112.38420346, 239940278.92754722, 248495126.21774712, 241695401.8556697, 323014645.15711427, 178421578.44962418, 319105532.5000529, 241593630.0328539, 286230451.29038, 204359048.21198693, 354300671.3029217, 347767852.0919719, 326164042.05496323, 187364257.18746692, 316762121.07801837, 288026323.0746671, 183605596.6111787, 261616756.75964773, 285435250.5337263, 297955824.92957085, 273703719.6674467, 280784376.6492188, 366008994.74628687, 346242718.8466032, 175000000.0, 244986320.36357406, 253517557.6552276, 177705128.32963723, 268655339.99808973, 348011455.45354, 206217182.3429484, 283641192.4134469, 214255136.54344052, 226285379.13705233, 366319578.4509629, 232937854.50804394, 291752894.19425684, 175000000.0, 399350410.44248253, 301082792.1998295, 252505759.8273447, 299259050.026147, 191818306.68711913, 342881705.6094161, 244627297.0383774, 251288437.84099585, 235609113.8257026, 230958650.5225016, 307357487.5455511, 278570335.2304365, 304414465.45115364, 262527110.06991753, 295106159.76491904, 239483357.03825963, 415000000.0, 185146913.31635955, 348963189.9895408, 357434958.06591976, 217331957.80142385, 415000000.0, 328799795.9384963, 327009610.18756443, 264701827.49810866, 250548810.34446767, 250988014.003394, 287103116.5319067, 360112381.05163264, 273952415.9255297, 214465402.74582666, 316428971.38691777, 323365279.5611703, 304613191.40188545, 310879493.30493176, 247552409.988057, 213624327.0641468, 216552879.35044217, 182368771.19572726, 277389313.7622134, 258172231.7468088, 238351964.48537382, 175000000.0, 198926187.36585692, 338171590.4494299, 226654974.08784127, 285183136.2150211, 192641830.0981535, 363155083.008301, 254691699.23401737, 280709440.3526337, 415000000.0, 369541415.4331083, 245583807.2084439, 230309328.14122498, 244541804.74968958, 294887861.80083364, 256915682.8735313, 240753078.29306832, 365481581.15977174, 256398947.53862947, 415000000.0, 268448298.05348027, 392512289.30061096, 284974068.67047447, 326410566.77659416, 223630065.80923456, 217254071.88599783, 291589036.50051916, 328288820.4495833, 265428480.60952032, 197193248.5997419, 193958710.24386886, 191076030.35066918, 177185914.77599156, 269578142.42593175, 338490445.8949469, 262255417.0349466, 175000000.0, 252038860.55186236, 253622776.414966, 415000000.0, 189796851.80190802, 240999496.38196802, 385578187.9966624, 290953994.13722783, 298439590.8048441, 269886346.6814696, 283231005.96367776, 313125336.14533716, 219419013.1295935, 320256395.40826386, 193406028.33267224, 283131013.28197783, 273794486.32085544, 229122106.40421376, 261711275.79284194, 228801718.97079265, 206904857.95813113, 243008845.6094832, 205414270.97480726, 282777766.7538742, 203304783.7660451, 308552172.9843622, 201880593.44914263, 231702574.09648892, 228696001.37882915, 354023952.58130777, 283252995.2958808, 250857308.56905732, 294149924.9979443, 175000000.0, 260514909.63665208, 411647173.0138807, 270962702.98610854, 267078517.95457593, 297425569.4514492, 321518666.3327553, 175000000.0, 180465524.90031853, 275737157.09293145, 224118188.56522095, 352983816.61065704, 245110619.9631375, 175000000.0, 198006447.00606233, 175000000.0, 249601978.39780927, 252173084.78666952, 239182364.1973153, 335004890.924885, 344113189.134073, 253191878.7563834, 175000000.0, 302071695.25214946, 297908074.84735703, 281929459.6032189, 327768613.75008655, 202634725.8242864, 412686550.24802774, 212173037.73679397, 311139124.2523182, 180262784.1390649, 213563311.90788412, 369535493.6964145, 248109216.96926478, 317530078.77426946, 277389735.0544947, 256930994.12801838, 357109912.8966908, 249460353.8325289, 176748602.2084796, 219726189.02913228, 297629858.87172407, 287423642.2562108, 185183068.29328743, 223643516.68220326, 230903304.07187793, 242364319.00315085, 193280030.67427728, 228503077.388798, 223429828.650324, 312699112.69574225, 315345108.58034563, 254589985.03517056, 240925963.75689232, 271423215.9599813, 219070923.35276604, 203452951.72196823, 213087636.64614052, 228173591.65564972, 202696186.76707467, 272772901.7404965, 309781528.11407197, 184354107.62872526, 264530262.26783103, 250396753.81073397, 283966068.1067488, 262283449.85137, 189947281.31916204, 198255979.72149503, 264784961.2699494, 331263068.0843416, 175000000.0, 284234626.37353766, 343427330.054521, 254178738.64282757, 297563873.2910903, 224711692.35542366, 256102899.32886377, 182963759.64923096, 175000000.0, 324936074.1859552, 210961654.0566291, 237523649.0434792, 192824935.15917283, 191811852.90577084, 252996285.10184717, 223381456.01746064, 286296097.6775901, 291120987.6945545, 282654352.72440195, 277492037.8716796, 374659226.3305509, 207095264.71645048, 259826951.06980994, 339071228.36085117, 349245195.198088, 191306019.91084257, 245265464.77856845, 356651408.32415414, 294767649.9767527, 274810093.89794564, 250523072.2467811, 241371050.24947914, 280594884.96328914, 248583581.12065378, 260547306.59832922, 267718783.37153795, 225973399.92786208, 296360905.72473824, 415000000.0, 176873554.92843506, 282854780.50507796, 221855051.8251936, 299383576.02247155, 265803504.58504087, 312021410.5841082, 342342100.7262822, 274635133.58506906, 339022763.2670126, 175000000.0, 375726546.1519732, 286109513.92244124, 334927108.5386366, 200152291.8794778, 218375562.55402187, 271789251.7640068, 262042656.04270834, 280271192.00615627, 335428495.2278425, 177266131.7553744, 327206155.82318336, 263533562.84537247, 251304633.32044515, 189203833.61806333, 294435486.57374936, 175000000.0, 304185679.7883835, 188316749.12553647, 266214817.40305308, 256114224.51001412, 341884267.868173, 252723360.64494136, 225161631.79321387, 234821547.79439333, 349899165.73557466, 296637872.36949533, 241272168.47665393, 249472225.3170182, 185178141.4417904, 286970826.57205474, 177446793.4156879, 311318673.0042062, 270736622.4211283, 415000000.0, 205591586.47071826, 257063207.0155872, 393655787.2492393, 343563473.01510084, 225057084.29900956, 276583535.1872908, 263162835.6042157, 280201309.8161838, 224932689.29606912, 257832803.92142504, 183902563.56397834, 271131370.5273069, 290956754.67241895, 249977276.5369578, 183204052.28752893, 328287246.8797571, 285434645.94084805, 223559749.81976384, 247016555.6728154, 187956042.45205322, 209060890.87794453, 233185652.33597106, 346428081.5792456, 227934004.70679972, 303628419.53669286, 233159282.87941107, 278073891.05108607, 254841946.548134, 319897474.2182477, 233342409.2016848, 184956430.6162612, 193019020.570374, 233495811.03424793, 198848586.61292806, 288372338.6046791, 236979400.8138087, 415000000.0, 178241715.81357905, 275326045.29233813, 204314887.13334784, 235516994.64388868, 271514171.4696157, 175000000.0, 277381699.1794957, 403003054.53210294, 237634857.22688767, 278813976.8117312, 330976567.10350174, 253557180.8947582, 230942676.21115333, 175000000.0, 303681310.2400225, 256458785.62483528, 209657559.89090195, 270613803.22344446, 230802002.50612134, 233676401.77145, 301328458.75106, 194911072.0834274, 332642489.32863486, 192340109.62441486, 226752703.01238352, 404818651.19315773, 338665872.05007076, 268861363.5702745, 213072890.78635153, 233632113.1288283, 267399619.59444278, 265265965.66996586, 257743245.42396107, 261233947.97074994, 250708902.39964738, 190442119.1760863, 234300945.03176138, 322892474.2889767, 193608307.5891372, 252106911.64107406, 218915009.48926297, 269690832.1600532, 241109898.63054556, 366319580.981601, 294668832.0144795, 196074500.0203802, 305746604.49563533, 221137607.51142117, 231147819.20817477, 282209340.2184437, 235604268.5331137, 321320549.16236305, 221144630.60722044, 228985965.71456906, 227074458.58889538, 231736632.6754802, 336534077.39649117, 302852358.7883974, 385932171.0450643, 415000000.0, 208812580.90256378, 267228534.23853666, 202119366.1406862, 220991343.15218395, 228415499.4278504, 207579952.84326935, 207824964.2605436, 254677050.1329491, 200293847.2551378, 317687031.1296591, 214162544.63690493, 415000000.0, 237744216.32129067, 267324271.59007126, 196798563.04018247, 385598864.3854702, 338070005.0734503, 281142305.95097816, 194543950.772862, 275760366.3936134, 204613502.1025223, 365086244.2456725, 315350298.91712236, 268730962.21015596, 175000000.0, 211036264.0648741, 306881812.9584842, 345223277.0889083, 337287831.38932455, 184151378.66005546, 281434584.0706763, 330279290.03516096, 181437362.14109832, 262579479.4161141, 279692287.4135314, 245903181.7634119, 175000000.0, 244533417.41116047, 244445379.52040008, 254460992.52957046, 231849163.96563274, 238190529.68427902, 260715047.3966212, 290463777.3449644, 245701513.08036876, 239977426.46600735, 268545253.38149077, 175000000.0, 292723771.79743135, 263011777.92062736, 265394999.01822954, 326247690.7143088, 175000000.0, 175000000.0, 279689870.89268714, 262625826.558279, 273269539.61940026, 237172772.5445994, 305275834.0693615, 324199184.5455555, 293179922.92817354, 248113183.87915483, 175000000.0, 312538136.244777, 345908632.4178785, 303924264.32464993, 215998317.74139062, 305922542.75917274, 319000365.22757155, 373070150.1691073, 216169271.58415377, 250031318.214331, 311003086.14653134, 266450680.09880316, 204801606.39410472, 288657131.99200916, 299468077.3259296, 268281140.16487333, 276312031.17878747, 248231198.50406778, 366392314.2912405, 214982430.90665886, 230613873.0385328, 263693260.89727777, 320320691.68289095, 188094801.2617144, 196140646.99806392, 175000000.0, 264979145.37049493, 204756748.70360085, 241330543.19920486, 305072291.4755805, 227829910.00142497, 277037283.6128076, 245981790.87215638, 305807353.5407327, 292598678.7144146, 225272856.7369424, 253290415.213299, 332376204.1064108, 287286321.03738797, 192371295.4376036, 304678647.5465424, 206307586.3960095, 361028248.9974074, 330915512.3203529, 280699694.5761843, 272478022.6660269, 251009190.48985866, 306247043.41081274, 242076257.28021467, 277303619.84797376, 319817002.8117301, 231935644.81929743, 229127256.53839588, 201298891.94919068, 207240057.86012998, 175170170.7692373, 309789383.16047525, 394595240.25208366, 362067338.02359986, 182752078.34185636, 309444154.7703077, 361805773.82344574, 237455438.06805414, 269093021.11700135, 175000000.0, 279247218.7141478, 207282434.488182, 275079470.2099145, 185425979.7223812, 297074440.8777494, 330946217.04127514, 220715626.13965258, 203904920.78219533, 175000000.0, 247802921.08191392, 230909894.3244264, 185849209.17592022, 291152330.7453456, 237819539.12476048, 206718002.5499982, 232311791.55591905, 334436445.00558746, 301101992.7333607, 255491951.8665552, 302195184.38407534, 202812499.9340882, 264959841.6807691, 271873559.9602732, 236763525.34636632, 290008671.2576039, 220851435.2093352, 294882736.78775537, 297674361.4453944, 175000000.0, 343479981.96490175, 175000000.0, 229134632.54407948, 331008205.57494205, 244994653.62583286, 189412755.51146013, 205886378.5832199, 331123828.05630094, 175000000.0, 338790148.98067534, 259817215.28557992, 201387716.95715266, 230831229.16382733, 209444484.2786025, 319407932.8398982, 309969921.6365707, 178983552.8312554, 240303260.7426201, 216795891.96284294, 351521322.8192359, 194400407.93921047, 376889267.82824194, 261089863.70575893, 202766070.49795318, 226013761.15505302, 219805989.09131995, 197713844.94509813, 268694100.4367677, 199792288.3882527, 175000000.0, 241594174.1994331, 176013986.9237937, 222254386.15400547, 214577860.55306792, 216406331.4194502, 411965785.7388091, 266391070.13442606, 277913374.07629824, 176893160.60198554, 227196955.82012755, 276046993.087555, 209102151.55710658, 322417867.04873025, 200923714.7301137, 246697685.08156195, 230679441.50325987, 272911149.41239566, 227883635.02240935, 247554323.57191426, 249489906.2269431, 223140898.85767934, 293252975.0437136, 277478828.783575, 257873619.27654845, 238861327.54717204, 314457246.416057, 249506443.54813597, 245576563.1695822, 269288619.607123, 384777683.1740105, 194824951.5008443, 312581625.4050085, 175000000.0, 276168920.5025343, 374433651.8908286, 293488023.3484756, 273296983.8299599, 232006160.81672662, 264881311.3725441, 248600919.37330794, 220577413.84853703, 246503795.8879937, 275002187.7733713, 221506154.31155342, 219576549.59156254, 193959358.56616613, 287115627.5549158, 297238624.3373548, 277060778.6393004, 326572327.56174016, 268275413.5108119, 287198386.1853377, 281578748.623533, 257704608.403779, 233551033.3328587, 415000000.0]
thresholds = [195994396.41352686, 262273302.6780731, 350532235.3922744]
display_name = "dFDA Total NPV Upfront Costs"
units = "USD"

# Calculate exceedance probabilities (1 - CDF)

sorted_samples = np.sort(samples)
exceedance = 1 - np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

# Create figure

fig, ax = plt.subplots(figsize=(10, 6))

# Plot exceedance curve

ax.plot(sorted_samples, exceedance * 100, color=COLOR_BLACK, linewidth=2.5)
ax.fill_between(sorted_samples, 0, exceedance * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Annotate thresholds

for thresh in thresholds:
    exceed_pct = (np.array(samples) >= thresh).sum() / len(samples) * 100
    ax.axvline(thresh, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
    ax.axhline(exceed_pct, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.3)

    # Add label with formatted threshold value (use format_parameter_value for full units)

    ax.annotate(f'{exceed_pct:.0f}% chance\nâ‰¥ {format_parameter_value(thresh, units)}',
                xy=(thresh, exceed_pct), xytext=(thresh * 1.05, exceed_pct + 5),
                fontsize=10, ha='left', weight='bold',
                bbox=dict(boxstyle='round,pad=0.3', facecolor=COLOR_WHITE, edgecolor=COLOR_BLACK, alpha=0.9))

ax.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=12)
ax.set_ylabel('Probability of Exceeding Value (%)', fontsize=12)
ax.set_title(f'Exceedance Probability: {display_name}', fontsize=14, weight='bold', pad=15)
ax.set_ylim(0, 100)
ax.set_xlim(left=min(sorted_samples) * 0.95)

clean_spines(ax)
add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from

output_path = get_figure_output_path('exceedance-dfda_npv_upfront_cost_total.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Exceedance: {display_name}',
    description=f'Probability of {display_name} exceeding various thresholds'
)

plt.show()
```

*This exceedance probability chart shows the likelihood that dFDA Total NPV Upfront Costs will exceed any given threshold. Higher curves indicate more favorable outcomes with greater certainty.*
