```{python}
#| echo: false
#| fig-cap: "Probability of Exceeding Threshold: Patients Fundable Annually"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Monte Carlo samples

samples = [42851516.387360334, 47722053.16389715, 41393909.846379384, 40787332.42470143, 55833527.585805744, 49995579.71958241, 43443989.78121405, 44967710.169426, 43934545.039249845, 46880790.069005884, 40981519.62517702, 41306126.53471476, 43652947.80571598, 39716178.17334738, 42313334.22257088, 46903529.76231766, 42639016.04223802, 47267445.56239581, 40984535.45093042, 44047662.530435845, 44511461.505492374, 46258730.6112473, 39049536.96768246, 44406780.359068744, 45360632.85736211, 45093158.03753959, 42100987.06225927, 42649963.8838368, 42493667.476646446, 42434033.29513117, 34085714.28571428, 45283547.94897359, 45657039.56128788, 46738125.41504625, 41828370.98804597, 39703968.33549283, 44267112.00899126, 46833924.69441194, 46776984.32455037, 41716107.61884606, 41417048.3020734, 42065551.846206956, 46203402.921516046, 43093572.48213091, 43481625.94416179, 43138669.03112358, 41006887.25607445, 43122238.809639364, 41624476.51939333, 43647701.07305445, 42903437.91311921, 41778682.08131523, 51389885.875792995, 44979679.03344208, 45508904.4544041, 46108000.75850685, 44824481.13480664, 37204927.27477696, 46927337.01937402, 40699651.20790967, 53490240.01483906, 45032826.697550096, 43326402.25014685, 41925124.16853156, 41520173.35876472, 41256265.65057248, 45081229.58837364, 45480581.57273962, 41049746.13019944, 44533724.84115112, 49761030.01899612, 48519023.09985221, 47123026.65239056, 42216035.439439885, 43394827.072580814, 41587093.99584507, 45356847.554192744, 43340576.262649566, 41797169.08264775, 44943646.58627182, 42348612.3786, 46190553.507585146, 45131396.32700723, 45196894.93536544, 49060750.73571046, 42249442.28933198, 45505477.19385268, 43834745.91288265, 42269869.43070629, 42382307.295503594, 41668222.43946472, 44214012.78881166, 45342928.48751002, 44149647.79098987, 53532622.226033695, 51298362.60954036, 50178006.32136906, 47408383.04774051, 42536440.24530865, 47071953.366951026, 45184353.93771287, 38521206.87702786, 45107617.23899258, 41435507.15381063, 47174858.668854184, 44582607.98101755, 47234954.23612051, 45047328.256639786, 41106100.609802276, 53913699.75374701, 42422165.99074928, 43074927.72333308, 45948215.33320427, 51288761.50147343, 43632285.32927423, 45718209.115926415, 43091849.95531118, 43802913.87718963, 36505400.46638597, 44700139.823373586, 47582592.933738545, 43270863.98534081, 43134288.480243415, 38113089.727035284, 41122691.69432797, 42678360.30731704, 37414634.53751982, 48999163.29736187, 46111127.40518474, 47149085.433295555, 45225221.02125926, 50661132.73493877, 41766153.85212585, 44640732.80138867, 51514541.54596034, 47515755.720488176, 42822261.32745088, 41113064.4624181, 34086194.90303614, 34085714.28571428, 42488135.7887873, 47380030.22972448, 55833901.13028449, 42974802.61812929, 46735108.935542256, 45314989.21767727, 46012262.06270685, 44359448.10898669, 40150687.868638225, 43345593.58744773, 44420933.899355024, 47685383.274374336, 53412611.005856514, 45565226.40213823, 44060851.38080476, 35443499.89308382, 43435781.25646093, 40653973.1043084, 45611181.76010057, 48965956.16417048, 47290319.369478196, 46418037.74008696, 34085714.28571428, 46765751.5791635, 41111906.80045613, 47062632.00743279, 40815821.020775035, 42585421.129036486, 44414048.729648486, 44016341.5603673, 46164970.29296664, 42383817.58595292, 45454578.41698319, 49320651.503804214, 49780918.058635674, 43293335.2482295, 36652844.734077774, 43335691.39738219, 44283233.85622416, 42914408.51406195, 38474885.55136084, 43136345.21308904, 45299410.34918056, 39864259.24720666, 42440835.57898504, 36936127.002917886, 43257567.56757592, 49310701.02536114, 50584517.41765026, 36188010.80501042, 35723331.73706859, 44493004.057815805, 45201979.98849441, 37426990.36253927, 48293542.37482228, 47032691.357459545, 41739648.89698289, 45242057.21443666, 43894730.53784678, 44437515.78941807, 42742345.167149805, 37787507.15583965, 43569818.63692634, 41737665.55700079, 55833833.79730345, 44043533.92639174, 46845098.341389105, 49261220.77977816, 46972231.46192477, 45030164.68845558, 40865517.43941402, 50210908.99763315, 43773071.19542543, 45557664.08997685, 45007624.85703668, 40590825.94571691, 42082012.02524528, 38260900.359976545, 44406698.31004127, 46312662.19329056, 44646402.51363652, 43059008.93704732, 43279942.45092746, 48099697.76213516, 43570140.38259825, 43106732.32842271, 34085714.28571428, 34764268.502529465, 46881515.640168816, 44867092.137751825, 51447253.64159816, 45935938.697009504, 42815309.7792183, 39165459.51025303, 46431937.606194526, 46162672.74805866, 55833913.513732955, 44434835.75479587, 47912446.105571575, 45718020.04990848, 46967523.345328584, 44199521.512825616, 54205308.08210962, 51480165.69024456, 34085714.28571428, 49864797.8047702, 48205666.85202848, 35011773.56205086, 34085714.28571428, 48849824.41886714, 45149598.757008635, 42729136.83665531, 35691406.51156441, 47370173.252563104, 44720692.93616518, 41307583.83748119, 42421038.1756732, 45177317.44131534, 44335461.41316112, 50645036.79564209, 44696039.21235408, 44794030.75345171, 43093543.82267656, 45809972.70183509, 42300099.68083532, 40532329.581392415, 43351042.65188782, 42695310.565403275, 43696600.8823415, 43876994.069339454, 46404825.375221655, 42812353.99404614, 44209898.247658744, 34085779.34807178, 36690218.52915464, 42582460.22609609, 46554525.591599256, 48339562.809734635, 39267932.779755145, 42991361.417225875, 42271849.25586789, 54079081.45742207, 40828927.18722556, 42356355.786066525, 48322569.220546804, 45512974.32531554, 42988130.80822726, 43698936.59010179, 44883769.41064793, 44231186.308870636, 44743955.07130765, 43360691.73054317, 37360242.54447304, 55834236.27295461, 44691447.77091354, 43280147.194701076, 42880546.07353883, 45162446.63335569, 54195629.68235973, 42774143.64179488, 35699952.54423813, 52094286.08051479, 41031096.6528048, 45010601.85719723, 44086654.0094212, 47831580.8463882, 45031327.677516095, 38515621.54980003, 41936737.26602447, 35668495.14615627, 39363823.369390465, 42406810.59178876, 35594912.86090309, 42407118.499856666, 41145442.935027696, 44899100.42316552, 43651202.23289748, 46317986.55761712, 40632371.58592754, 48908276.30144735, 41291508.827512324, 44531466.65222759, 39406950.97979376, 41392567.03617037, 35113106.455288365, 41457200.39420134, 52448471.80538165, 44105921.63722889, 48853644.73178288, 45678438.27935694, 37097429.39018595, 41758427.210308634, 46323402.82758694, 47500055.0834476, 43765763.98147039, 49241525.39244779, 46223598.24120875, 42827262.96026977, 39518647.65135351, 41851819.22626935, 55834028.192513734, 42852681.94683097, 43632610.275282525, 42489848.33561389, 36411924.17839991, 55833844.63591386, 45937352.03003328, 41909879.721828505, 52537481.01059717, 37330671.718877696, 42640320.91244262, 41086073.836251326, 45865530.903800026, 41190913.765801184, 40132925.38792835, 43091174.83525517, 43086080.640362285, 42966023.054996185, 46918284.60937982, 44382654.893771656, 44399862.874160275, 42590569.5591815, 40600073.719398856, 47879471.95892798, 44305138.42468536, 37294170.61254579, 46484235.20595616, 46768885.10828682, 43193568.31616153, 41093089.276253514, 43838380.47499916, 38318290.29234554, 41053513.6091973, 41101275.024157226, 42029764.03243296, 34085714.28571428, 44581653.31138247, 55833738.95204584, 36489348.48698721, 45464161.42348446, 43511358.62097106, 38450637.682922214, 52730519.4979297, 49549156.97578135, 52721334.087516114, 46666952.34367231, 42405000.0439993, 42127542.19246943, 42946244.08743754, 50986595.63639374, 55834042.87156804, 43692536.4971865, 45513861.80596363, 42340030.03713752, 41550078.86694957, 43408925.41493985, 41362802.84276325, 43103442.67520211, 42108324.385733955, 46344054.1957109, 44493322.49194112, 43212115.9911632, 41169282.81996062, 45239023.45412665, 42137423.14900306, 44792122.9849445, 44279465.9909674, 41140552.26063156, 55833697.022411324, 49944959.82858866, 51618685.691950865, 55834061.1194812, 46249163.27398511, 41397179.67517074, 44858388.87617346, 43208714.539239086, 39985316.309606016, 38326966.30193895, 44113402.39544686, 38151034.776085936, 43564604.24462187, 46823900.33850719, 45949108.30960409, 51603581.71537656, 47008631.9733439, 45113754.30238198, 41223482.20609932, 35741717.71504324, 50710570.403330415, 42559387.61050576, 47726795.94126072, 42289727.70515462, 44326045.333347075, 54913541.164604105, 40826205.42774015, 45986927.703266025, 45733851.593143135, 47974896.88380765, 46163163.00851766, 42443689.173444934, 44526604.357051134, 42771930.31762909, 42661628.247718886, 38374821.32594679, 45060453.00652683, 51569900.32942326, 40141830.437566735, 45020954.753418975, 39805507.14990689, 42590624.9489339, 44326220.399467476, 42705191.25928148, 34309178.580268525, 34085849.092332765, 43641595.477870956, 43335021.99029406, 40077587.62936322, 46853936.366498485, 42757294.208072156, 43965460.96370575, 42820950.27268211, 46809260.01422935, 52611876.06683483, 55833852.696566336, 48382250.4096636, 45467605.13479226, 44887324.53796503, 34393282.80288591, 39866350.483072564, 47279216.572922766, 42708730.485338874, 45285879.109267905, 44856577.50354821, 43250545.461659655, 41818006.61868653, 45048116.415680274, 40165871.1243437, 48593587.00789654, 43855695.36156755, 34085714.28571428, 43123965.61902001, 37615160.614560805, 43566655.360903986, 41942853.09017927, 44071115.6348912, 44461546.30038128, 46613909.07983085, 42435745.305180065, 46875308.38488326, 41667574.96965602, 40013240.4666085, 42646363.615353175, 44863140.82966982, 42357851.29200728, 44941297.16968445, 40803227.31762715, 54918414.474986695, 45035351.6555953, 55833687.998292595, 51736777.96219599, 38081453.05602086, 40931312.377875485, 46397342.73470486, 51805163.95376958, 55834285.71428572, 45767923.984626725, 34085714.28571428, 42420648.894292295, 45825068.62552943, 42321315.12261084, 52345418.03786171, 44901722.71886989, 43539751.43478051, 44171526.788398065, 41264406.82712612, 42718888.58793787, 41658708.75600935, 46285459.40274789, 40922952.81455495, 36329680.552842796, 47308793.142053895, 47007033.36200679, 38271870.20720673, 44533861.946217574, 37812087.31477985, 45410683.236883305, 37469559.651704386, 43431697.00687772, 43006451.35851187, 36746561.642808795, 45126900.83307884, 47202340.78594819, 45431936.544595554, 42363217.44785036, 52390036.46186495, 41758631.177419685, 45751145.42791678, 39571323.63517384, 55834107.69044014, 46639541.55371641, 53524396.14409921, 46783331.42435634, 43041732.92136137, 44491993.55879095, 44748818.34013017, 44422830.52812382, 43189940.10372327, 47456385.998998106, 41534286.42538771, 41677020.6316788, 42585133.58296244, 42021877.65316585, 42879134.548632294, 34086028.59169151, 44174933.54197611, 44935751.585604884, 46520106.803647734, 47656686.85963424, 49486089.661984675, 47011052.47504299, 44118684.58914987, 42753228.81497603, 43703430.74355659, 46563479.94735122, 40915425.03147761, 41429404.00297828, 44424428.611190766, 46158265.058720954, 42048331.45022853, 43241655.54813093, 51307602.793988496, 44109438.27519268, 42993742.57218406, 47050827.54210853, 43235379.15313658, 51368608.086658515, 38269138.86619185, 38873690.333449855, 44745830.43317331, 42656552.79151308, 55834119.6028444, 48718037.2001183, 44889370.96430247, 47995174.74639768, 41509955.258159555, 34086189.3559547, 48893616.39101333, 46824137.19931747, 43082577.05451283, 36444890.56676666, 49292369.97297488, 43037154.57412595, 35109035.06829725, 53195791.41279453, 49808596.77021611, 45344013.5160865, 45686623.71297648, 41194631.779377185, 43061807.21716414, 54371275.26978751, 42156261.37940306, 45889014.71909752, 38691150.661721125, 46067615.2192941, 46099904.71922478, 42072158.422448106, 41353832.24693393, 42377147.458964586, 53516128.11743762, 42082276.668006025, 47673993.46138333, 43083153.197563976, 51085952.09674652, 42382995.1128973, 46712111.068192214, 49822438.586520724, 41511812.90897069, 43061858.0253304, 46018976.353339665, 37495307.55027219, 45404045.77595862, 43768055.36125914, 42970792.59386508, 46039300.62097252, 42301420.68703285, 45732261.76807501, 45301910.65010809, 38089704.35366841, 47727152.7350587, 55834121.771892875, 36446050.62612875, 34085714.28571428, 45279521.0160649, 55833469.979789115, 44947614.75555948, 44863051.04268071, 44528952.97309807, 48347943.20095231, 41946813.08085917, 42126497.07150827, 51730761.92803428, 41558974.055966236, 34085953.341437265, 43295444.58116926, 45041356.83050739, 44363622.80270605, 41830718.018172875, 53945760.19024678, 43320894.39585699, 45227517.33749316, 34943966.986918904, 44474542.74020894, 36079129.73732131, 48265218.47898316, 41921749.224070534, 42802696.215139635, 46939051.384595305, 43277178.149651706, 39119117.97530481, 44994067.29957663, 53576592.407404594, 43937142.8046352, 47060790.93673328, 45058895.87108472, 44156055.51751252, 53706860.79216812, 52856059.2504429, 42265537.06322349, 45694178.29507307, 55834234.875671506, 41283514.33360761, 42959263.84931096, 46377162.35149184, 50125758.812262975, 41120467.24994921, 42703285.80138374, 34085714.28571428, 42469076.321795985, 42576322.801640205, 44449538.709721915, 41181280.6896897, 41798808.60767026, 38847631.81581928, 45689228.33592507, 45385565.59317115, 45539753.20726514, 41264420.92679645, 37182242.22278282, 45468188.16718111, 45348121.38234582, 42820388.40674225, 44722371.87770481, 40750960.59621178, 55833997.137512214, 46785058.18861367, 46624524.35422279, 55834050.8417178, 47284894.2652182, 47107317.92832758, 44567615.928464465, 39817008.831295, 44719938.99355921, 47644430.636109866, 44071701.83012925, 40270719.440111294, 47330126.30188393, 47090572.63902426, 42015302.233303204, 44638353.77675163, 41726176.004317656, 43923788.316866726, 41551014.39942096, 47680510.821690425, 43918462.22115898, 44600788.467022374, 49235676.408367634, 52368830.705609694, 41602390.57103869, 45089024.01705114, 47572312.68082126, 44206097.1255634, 39710692.72205654, 55834019.92946392, 51751268.47530471, 47135587.2193427, 37428755.2231113, 42925201.61251747, 41339735.86837273, 48578258.90187641, 48400733.8534189, 42378087.28247433, 43679240.082356654, 42047316.474051364, 44521166.72231016, 42940011.25364829, 43341991.45747502, 41306205.26283922, 41212526.01752911, 52895600.61520177, 55833993.57420457, 40594017.272266634, 39291779.54030367, 47558319.43038928, 55196071.931918636, 43541247.62388009, 40818149.93507544, 35257200.754268415, 42153357.7366877, 45161752.96180237, 47026864.75420895, 43838294.59439796, 44908489.38397614, 47511444.2434489, 34085970.15368497, 35335119.96356441, 39654095.44997958, 47128139.901505016, 41059171.24456554, 41751642.95299072, 42395423.84302416, 38861847.796066605, 41765439.78781096, 41427468.905269004, 41760461.884248026, 42731671.82586714, 54454760.42710125, 43593378.90572398, 45813047.410168834, 49797739.147134945, 35989949.77807308, 35689518.65625551, 38112866.131430134, 43016520.27822927, 38171105.82478172, 43836246.365483135, 43191921.623639, 48177315.494332634, 42545631.647997946, 43672080.6966364, 49999773.833752386, 44052009.320033774, 44149686.699301645, 35257409.6856194, 40934400.747655496, 43838314.51120146, 43037985.900243424, 43726947.04958269, 44573875.686909266, 48082958.26197105, 44394794.553041145, 46493291.41532888, 49537446.362890415, 42169973.02594128, 42564551.764598005, 54484679.35618494, 44297145.150406905, 40613074.116981834, 40198899.30507828, 40437982.48976828, 43744938.62302086, 46851697.564315304, 48093813.18775017, 42719022.31587652, 42604174.5850588, 38602702.37957349, 39908956.04590535, 44329974.910179645, 49483754.0374739, 44977707.80521754, 43143550.131990656, 44571001.4605679, 45890279.90391474, 43024297.4550739, 45627689.44455579, 46069326.271510534, 42829113.772250846, 45268006.527338795, 43053635.34126437, 42956481.55564754, 48571947.99181978, 45547310.709500484, 37584685.210526355, 48767629.94190673, 55833888.57753295, 55215753.26099829, 43778241.770713486, 43772100.09637748, 44279702.085608944, 39107508.56849091, 55834285.71428572, 42549124.63402491, 36767980.290940545, 48471621.9479022, 45190119.91553579, 46517811.83956062, 47031300.80009363, 45002695.50145964, 37653464.63667811, 35008830.59434908, 45036511.72027303, 34590431.738939896, 43756271.16225556, 35533270.87806446, 44196214.470992066, 43433140.06383036, 42649863.19578059, 34085714.28571428, 41071077.024564624, 46353375.45635561, 40697377.28392069, 45127118.2105728, 45577401.97456725, 40888692.5508133, 43771528.189849675, 42938570.52149249, 43829672.27021538, 42745635.180236, 42453327.400746614, 55833470.50361393, 41664380.48732209, 47352392.539777525, 51254557.18619154, 44076685.6745533, 43592160.8810705, 46303905.46530756, 41135719.81799381, 50351760.99850864, 45285406.38750752, 45915147.62212691, 44036248.29737844, 42937609.24422407, 47450968.70236184, 41478103.43948988, 43663211.26044101, 55511371.34718587, 55833558.170280956, 43919262.188872054, 44636382.97078937, 44230952.30398081, 43972695.59483275, 43115663.41206614, 40764899.1571992, 48328352.79517432, 48853336.02085991, 48176053.98632434, 42904113.17761274, 38894429.39279392, 45371237.33793074, 55834188.47614979, 53691053.743197516, 46808053.64015141, 45818512.689844444, 45290485.37036885, 43746066.34898477, 44952019.13480405, 40269532.21067288, 46241097.919394165, 46914544.10942804, 42276010.56441654, 52110752.14441525, 42569750.07619764, 43529356.77052611, 44382357.95464303, 36593082.105490334, 46048382.988087066, 34085920.72923844, 44651852.89635573, 49772779.64362983, 43639771.32954339, 48030222.12926763, 46513710.51638282, 42545492.931005344, 42024981.706144504, 46048240.94111586, 40639246.77054995, 39503238.02581823, 37594536.20854759, 42110453.75316749, 38084385.873474486, 55401706.53186545, 44973518.42013252, 46931613.34433815, 43473052.82646295, 45867330.63415466, 44446881.72366483, 34731362.06097446, 44459172.63448856, 42490171.51731428, 44675559.12800613, 43620148.19739111, 43856792.90064484, 42376408.16909533, 39448547.42931012, 36210739.8425773, 42835208.214218065, 41914303.555320665, 48670643.34533929, 44177617.144628756, 40788204.21585215, 41024277.053022645, 43162382.570931636, 40959262.81099939, 42236998.11340132, 39204070.6232318, 42902639.33244159, 45105636.798082165, 42748097.22363375, 55834285.71428572, 42592249.777056165, 55834285.71428572, 53876823.60478291, 42365076.94708074, 42280429.43032275, 48770653.47701519, 46370781.86830418, 38036298.61310204, 45557171.51920858, 34085714.28571428, 43883821.206670016, 42509164.4207475, 36407624.18777376, 43433243.610113434, 47427139.78779329, 44252613.444387294, 43998742.1917889, 50553842.9464, 44757344.80981692, 46479198.69612558, 40838695.58529604, 43759547.788499415, 44851118.047070675, 44240435.8462006, 43123824.08609845, 41825659.9745603, 47417454.4216705, 47735639.13088721, 39875657.035745874, 45304366.987524316, 51023496.63522618, 42391253.39684378, 42326935.54144578, 52065205.893080845, 43102538.05015762, 41441725.02045325, 42620364.000668995, 41776433.31464348, 50909761.73544322, 42764034.05834274, 44920186.03299091, 45552787.21130551, 41009667.68530155, 37308623.86436643, 35277403.62757066, 38414746.37112752, 44252636.562487155, 42692116.11251244, 41341322.78305979, 43466465.33302118, 43434130.15149688, 41158975.701910295, 44079667.28766399, 46432669.50173498, 45311879.38822697, 41770177.06753737, 43867087.26511065, 42733600.78214199, 41653038.198975146, 45172707.858231984, 41375281.93551964, 42605621.48633325, 49401322.439464666, 37554465.13269498, 45616312.246495284, 53227296.96596593, 47764934.05859581, 47561883.42963792, 43699932.174456246, 44819986.951946035, 45039632.60798307, 41816283.045653395, 42734710.942615636, 42813837.71786331, 42503249.72383946, 41827866.801368125, 55833881.45988338, 45136246.24057786, 55833940.09812136, 43754629.04005086, 43893064.68875172, 40296772.78636625, 39292412.563930914, 43191996.15875173, 45614953.87598946, 42255384.43839959, 45712620.423464306, 43882025.27759478, 40643251.09938165, 45818663.680402845, 41216781.20890424, 41629364.1150786, 47252442.02868505, 40681906.735614195, 41561008.27948617, 43531476.579073146, 46551874.55121545, 46903215.09891269, 45747208.48358761, 42067380.225643374, 47255498.074950986, 42411994.57975316, 49462236.42535345, 44577870.72481717, 43505389.40081716, 34085714.28571428, 50666793.50216298, 37356774.14772764, 43369848.96756582, 42498816.71242514, 43476015.86255376, 42388244.98015328, 44403869.85623106, 37476186.13664107, 45459827.26636132, 39680968.72504289, 46127648.6713098, 44082983.765724376, 47993722.41859994, 42354371.603576355, 37535648.17302643, 44141553.488872156, 44553022.96505897, 48358491.19254609, 44665237.75562388, 52642014.135941714, 47098990.184002236, 43111559.23266856, 38386060.252641976, 34085714.28571428, 45921245.266824104, 37601226.17191331, 43054811.58246486, 44395469.19941828, 42428191.04037529, 43666892.06915671, 43502863.319307625, 45290290.39341077, 50854136.013739236, 52184637.17297231, 41707518.32002931, 44829901.69406475, 45955130.54254979, 43848320.071324565, 41251188.407368794, 43267208.282556444, 46169511.008886606, 39023523.19211052, 36652231.01076391, 42224571.62444681, 40682635.27691959, 38915074.24127625, 39696021.129707105, 41834477.894526854, 41885674.60094453, 42142352.6769991, 48210391.36943134, 41554048.77282976, 50473799.362934195, 46668629.86034011, 38491542.754397325, 41106381.413917616, 37254817.68178057, 44812416.90260995, 48682604.53741559, 44703892.71806328, 43531120.3626763, 43609058.29678594, 39670779.092735745, 45125149.32784943, 42694388.87438106, 47376680.77371903, 42369850.88466493, 43866694.774661586, 46506698.69908797, 44687906.357081555, 44509089.21971714, 44807132.645455286, 35422026.298607066, 44213877.28100595, 44715896.76793831, 55833872.84802117, 47030794.57449148, 44782509.31003478, 46276409.1251271, 37960921.45346759, 44442672.52970089, 38595070.124949284, 43667610.209042616, 43750662.283108674, 44180771.21608208, 43864353.02346779, 35754261.289155014, 55834050.263038754, 55833731.03799766, 45766770.657677576, 43827825.95470846, 41588324.05089693, 42295013.8841743, 45205694.22639939, 40486801.45223964, 40406690.61355549, 43254802.54754993, 40717419.22060564, 42958345.006030045, 45831865.04595203, 41563427.026140094, 43502129.14387025, 43872718.11048175, 37350542.87442136, 55834150.52944416, 51031123.09426748, 48984443.82399218, 45132120.76879104, 44753093.008652605, 51849520.43629061, 47363927.68635412, 46909169.373653196, 34085714.28571428, 35231232.053827256, 45302301.290381305, 45133251.03731296, 48656299.71444044, 55670955.10322155, 44277190.69524324, 47410609.54077161, 44167240.528181486, 52711303.79134345, 46550613.670107536, 43373940.97230583, 42647429.1174839, 42478034.636136815, 50158321.64940037, 41060234.83407901, 46688961.3584231, 41773590.55030313, 43913532.76774699, 50658447.398658946, 44967553.49334232, 42650229.848608375, 41838160.81618001, 44360126.496705286, 36962234.34482605, 40569817.383382924, 44760200.79813035, 41394968.53479051, 34414295.91143427, 34251522.99108693, 49341615.15998651, 47148928.71464866, 37271231.954984196, 47877304.439148255, 50176594.87855111, 45564824.0150925, 42468950.66225896, 44227438.637840636, 46149838.00951182, 46234621.03674394, 46371627.6959591, 46977179.47721138, 34085714.28571428, 42875495.95165544, 40958101.63975234, 45575022.27876776, 44515242.65758535, 46376007.530441694, 55834285.71428572, 50673031.53117944, 54716275.54991137, 55833995.562512696, 49056565.0188961, 38345560.742545694, 44028895.61127741, 38580541.79332055, 42499441.4526116, 41290840.395241484, 47055217.57900472, 42128317.02009359, 41463833.53645011, 45885839.289938316, 42012068.22945434, 41990390.71675397, 45789445.553403005, 48428514.46855025, 48958869.20658654, 43583618.546699226, 42777416.80589699, 46661119.96080705, 43786822.3218621, 41976213.50106628, 41821190.00089662, 36830469.70464144, 38673741.382803254, 47423265.96743976, 35978635.78005274, 45723474.56331814, 40301492.947747335, 43646320.152479425, 45303707.68323009, 54687923.06970769, 44465539.35038851, 52330786.9803531, 40702745.77253786, 37060775.5177738, 46677002.79929268, 42860653.847738594, 46418633.811524495, 46070823.199263856, 41316703.168658264, 44008742.24485632, 35622029.5324923, 45550815.49796382, 40601612.017812245, 43546728.51309887, 41248479.47254618, 45426976.90028283, 44046407.42589108, 44272443.37726878, 46819027.100802556, 41678911.90532573, 41717221.149802126, 41901262.81310804, 36928189.926356845, 37507526.336935, 45173069.799438365, 42624778.769864045, 46053362.65467137, 43797802.875231504, 45968188.65403992, 36386957.207737006, 42655745.360705055, 44626203.93127874, 39250669.14265695, 55833932.37292426, 55833781.25501385, 41248285.23363544, 43671800.93678303, 43032443.22497898, 50210939.17036432, 43956488.861043915, 34086162.788196445, 41157548.774485566, 43303020.47154493, 45398412.74679896, 45241943.89129872, 55833898.81094601, 43008415.94298821, 41089586.1282508, 52481797.843832396, 46188728.62758974, 48727697.43972058, 47291179.74289476, 43695494.11605366, 55833862.11643283, 41833921.613172844, 41382970.86403103, 44740916.93836537, 55834172.86322426, 47405336.09126926, 38977738.438740976, 55834285.71428572, 45077024.9593858, 48923012.25516698, 41220328.50267366, 46237856.02207925, 42522638.98586763, 41992762.06947831, 35016051.41357095, 44573972.42340201, 42614878.43290242, 51644986.495577976, 39273020.5963347, 46545319.02220575, 45829272.39506835, 43953124.82823232, 52363313.87061045, 43104919.55949874, 40702217.825063474, 42890734.68033859, 52605621.07289299, 44301012.51461467, 41420988.82561119, 55374101.112655856, 48017612.341543, 40990603.89189338, 42966849.652367935, 42496178.28279903, 34871592.9273627, 42309906.47959823, 41692484.93855917, 34085714.28571428, 44611572.41861843, 46680523.24908112, 42443999.06912475, 42407125.51060244, 45708355.05692933, 47657823.43550635, 34085714.28571428, 42777969.428949036, 46443476.173351, 40865429.34997008, 44250613.22235825, 44747095.10202001, 42003156.03785592, 49904285.34336468, 42692424.223613806, 34541948.321309574, 42317709.26322977, 45177513.92599452, 45638837.595119596, 45297345.56991153, 44750850.7498289, 45183105.333789565, 40864219.91674676, 53970048.847920075, 41036921.069481395, 45189699.05246405, 42611889.58803269, 48464800.62514895, 38320533.371563286, 38889679.2807409, 40727117.80450171, 51917930.76016131, 41141823.60778589, 42519664.33786877, 52758711.66354972, 43960118.49492709, 42652975.78400338, 42023372.52611918, 43277630.863721006, 42896403.766377255, 37346178.17551317, 39025318.8642706, 55834285.71428572, 44971884.75284905, 44441683.315612435, 54151200.3404387, 43557650.216227226, 38868112.81290403, 48118312.88796088, 42746239.79431743, 47109757.758625954, 46226366.96990894, 37321092.50182831, 45764593.180733725, 42330738.92910946, 55307634.709635384, 34854109.144593336, 41871675.23743017, 44503299.44224482, 41959890.168282524, 50959938.626421586, 39328048.711685576, 44994741.59428927, 44577873.94496953, 45584143.01961465, 45900101.704679735, 41573581.806949064, 43014204.586966336, 41712365.57735542, 43907247.25250086, 42163497.358141296, 45327271.30926712, 34085714.28571428, 52410229.642419785, 38784113.42349295, 38054097.33188718, 46877569.8194177, 34085714.28571428, 40613739.88817058, 40690611.28342003, 43781938.60927507, 44623422.53149133, 44596353.17388066, 42566977.62458754, 37829792.06858038, 43264016.49457724, 47093747.593221255, 41156821.91133883, 40848866.88543732, 41702937.45164937, 41409830.08982875, 44809821.21256425, 47157916.42073938, 46935941.17649915, 53042167.38412044, 43077559.55024414, 44162434.87601539, 45401703.28062767, 55834285.71428572, 49511091.76038441, 39761355.6196467, 46200234.1028506, 42666034.16576216, 50787168.59309374, 37578485.897502616, 44370594.9242472, 42900370.35810467, 34085714.28571428, 37063096.8839677, 44933946.27869704, 45944899.689742945, 45000191.03553337, 42174306.738321975, 44237146.730506055, 45244301.26934577, 37388864.589560516, 44268013.803320624, 34085714.28571428, 43569285.39364039, 35334178.40041242, 42676874.72319171, 40716461.199480586, 46415822.182050586, 46883392.616479695, 42338977.52797686, 40635623.797341906, 43740377.21380905, 49855688.948347755, 50513630.99229313, 51116807.37709225, 54300526.678671554, 43505937.86826147, 39731681.63958689, 43923000.668789014, 55834003.9525497, 44531844.82366593, 44435294.76348608, 34085767.12981143, 51389722.548107654, 45228267.37096413, 35836576.07327251, 42370965.84992492, 41999763.862273574, 43488719.71356502, 42767675.009551935, 41306711.57104354, 46722579.92794149, 40985782.111925974, 50628025.31412869, 42772906.694207124, 43272660.09748622, 46027250.1441603, 43954617.51875973, 46049572.0862573, 47991496.96913407, 45098342.65423197, 48267342.74253706, 42791408.74351285, 48663913.62804834, 41517754.09811205, 48935851.46359028, 45848985.17098755, 46056946.857263915, 38344259.399018064, 42766524.84666636, 44604402.241989866, 42210926.86338006, 55833880.83663753, 44024443.86227086, 34086188.18087231, 43428795.16329728, 43646569.04261829, 42049309.37324378, 40929976.662353605, 55833714.69434914, 53485084.95224804, 43166800.66261408, 46380768.12854299, 38433739.346568875, 44963981.86691708, 55833460.60017722, 49693309.845759064, 55834285.71428572, 44681996.57189394, 44523631.30167473, 45347026.66953043, 40058807.50738969, 39216512.66724405, 44461480.18171333, 55833903.284465455, 41824142.18991572, 42025705.61836896, 42835968.14370101, 40657950.253049545, 48791428.91416594, 34086140.543740064, 47269445.344794884, 41397857.822671466, 53532748.15500086, 47162584.74031671, 37063567.381001934, 44774954.32552139, 41107331.19348928, 43077536.88557596, 44236233.39247439, 38081533.591458976, 44690783.66282308, 54427014.39124122, 46699936.00849633, 42039309.41442171, 42550527.84165114, 52402117.69257528, 46414854.83968032, 45903913.54099536, 45139859.62211134, 50654186.46304388, 46070416.923341714, 46430231.856078476, 41326204.98481743, 41205764.69238068, 44376735.723412685, 45233049.66815018, 43403254.67203073, 46748291.56749245, 48635818.24384606, 47199040.78181367, 46093457.28731196, 48779701.11126089, 43328734.92363452, 41460609.51200169, 52588825.38433937, 43791773.83373287, 44632809.10947768, 42729292.30494917, 43921374.24128823, 51357457.131625794, 49643722.814747676, 43777175.93497597, 40416843.118074305, 55833967.305999, 42715302.38789642, 39278542.807260305, 44401597.68125592, 42042538.39445734, 46338284.59629034, 44285735.976767994, 52905378.93003824, 55834069.40900412, 40780361.69945487, 47363328.16928216, 45456499.001298815, 50748934.16829593, 50961297.841958836, 44473386.12764189, 46433715.50787286, 42608504.66365657, 42362544.94833501, 42797880.16234684, 43072034.57483444, 36661461.38103204, 47956517.11666416, 44064792.80620466, 39677760.20511227, 38759302.65492735, 51068085.89310884, 44954144.48782039, 38120311.011409394, 42180263.82777414, 43217192.12126756, 44625010.82613719, 45204132.88092326, 42906436.85997011, 44745333.03455905, 44022547.31298422, 43610378.64078679, 46248470.825649075, 42101574.829199225, 34085714.28571428, 54390806.0640088, 42787372.32818479, 46544167.55465056, 41953843.79106422, 43718987.41115342, 41357273.65620498, 39377147.50762575, 43226727.96460723, 39682253.50535886, 55834069.373956636, 36578936.62549455, 42618128.22056623, 40066177.10589686, 49270513.70196408, 46799819.607015066, 43382995.59135065, 43935352.42579725, 42923596.69933875, 40018726.30724895, 54277396.09464433, 40682143.84502857, 43849081.57750824, 44576878.598284125, 51517366.26335989, 42196741.19802887, 55834122.778742045, 41723230.09645956, 51709651.21124219, 43695574.55566341, 44285057.51582591, 39418914.74375712, 44490020.00822492, 46306178.17565669, 45637057.328027196, 38701904.38536378, 42087953.92700405, 45210550.91049684, 44690046.83888904, 52403222.94367967, 42573774.127651304, 54225382.82858324, 41389586.22703296, 43441355.22494847, 34085714.28571428, 48234341.096510254, 44228349.75628417, 35252859.157079585, 39266212.17605572, 46313630.6767966, 43120993.878485456, 43870472.04795713, 42927304.84857248, 46322504.05656744, 44182568.187033065, 52691161.96582124, 43419433.91579662, 42370826.59284581, 44658743.66965048, 52850361.32339576, 40635691.26060237, 42653007.080588266, 46420880.35254552, 44843475.99698949, 51788303.5266921, 47598751.03918231, 45747736.71829058, 39008776.276820876, 46110239.360716686, 41749739.271462455, 45749529.35419302, 43040791.76648102, 44361530.07541847, 41001704.28551038, 45737085.78361014, 52453014.45482078, 50708477.94562382, 45726672.13984006, 49526407.55579648, 42501984.05104916, 45492643.15485286, 34085714.28571428, 54013201.844570614, 43189118.845154524, 48473104.10098603, 45590319.925692886, 43398217.09721747, 55834054.73309441, 43077969.20730748, 34603664.29339143, 45449127.26862038, 43001179.65199499, 40444555.790319055, 44439277.09779015, 45901201.76555525, 55834016.00516056, 41747220.416946225, 44264435.09826963, 47491341.24316721, 43448184.456276275, 45910893.60133701, 45714424.594136216, 41859847.30249031, 50317876.240334734, 40284013.48110746, 50850313.65561, 46193333.6047637, 34480684.86370592, 39715377.125376046, 43546084.256331585, 47200172.665881835, 45717427.04009482, 43628404.477542505, 43749659.03978956, 44187886.344810106, 43982425.25762203, 44613548.206441164, 51251642.60218245, 45672166.61915988, 40869574.61972751, 50586089.526760906, 44527679.868122175, 46759826.000779614, 43499639.26285354, 45221090.89753745, 37321092.29758538, 42185163.1977545, 50081052.84145011, 41649323.0824399, 46596436.95351656, 45887082.51437472, 42821246.78393492, 45584467.83195059, 40938715.94566178, 46595924.17869504, 46036730.15673498, 46170643.19931819, 45846650.23135422, 39914542.845733926, 41786766.32228817, 35810534.67167194, 34085714.28571428, 47643612.891218476, 43638079.033050895, 48890019.98916849, 46607121.09248708, 46076536.72696169, 47867734.18926202, 47822995.44763316, 44371479.131828405, 49242908.75431065, 41100295.5930495, 47116814.642240785, 34085714.28571428, 45441882.64017991, 43632664.237525344, 49934933.2105086, 35835053.79936868, 39770820.10242266, 42877477.20823579, 50393133.21682005, 43165542.027764134, 48417019.0338635, 37420933.786813356, 41205529.77825238, 43553403.47195209, 55834139.617688574, 47357524.87958282, 41595891.552506946, 39116582.81148968, 39843864.56516278, 52634715.5936389, 42862046.214049794, 40512182.029078, 53257914.02132533, 43904213.27709969, 42954352.68605051, 44913718.00762214, 55120989.71426867, 45000725.79875205, 45006340.44493537, 44384528.15459228, 45838938.75836104, 45412362.55807128, 44012732.6851718, 42395723.43673088, 44926487.00240578, 45294915.99709449, 43563835.27084205, 55797259.573458605, 42282051.775608934, 43879199.523250096, 43742288.84419438, 40723500.68036553, 55833534.7965897, 55833619.705745794, 42954481.25047708, 43901528.87325105, 43301439.16449766, 45479788.31403878, 41671559.58789285, 40812443.095107384, 42259251.9708613, 44774706.298622295, 55833881.24372139, 41333576.59103306, 39055174.32975748, 41735657.617637865, 46977663.63430578, 41641024.60296128, 41041606.600620694, 36785111.73794412, 46964786.53864745, 44655399.20434762, 41404129.218737714, 43682170.69719478, 48381765.08071893, 42487453.452662945, 41949742.7480584, 43578688.024934135, 43135667.332527, 44767330.00084114, 37315223.17604067, 47054469.6514357, 45923867.39204886, 43839879.703521825, 40982932.391429074, 51758015.06658716, 50067663.89564269, 55833823.44202475, 43766059.11286892, 48390166.90332471, 45206761.606786124, 41681188.08943807, 46117538.17371565, 43096514.28534233, 44908744.56046477, 41646457.005318314, 42288312.6698385, 46298254.80126723, 44455486.880715564, 40309578.11643895, 42557572.3111687, 50843778.754839964, 41699833.839808874, 48101597.98513344, 37753748.42839592, 40450467.05704153, 42900886.33467615, 43344973.5052582, 44595049.620713174, 41625735.73694251, 45158463.16299673, 43082170.673110105, 41005277.39694195, 45833015.8801226, 46026891.669053234, 49047914.741596684, 47929955.57634822, 54889091.29008475, 41460245.3657038, 35186366.53734437, 37667891.40711424, 52953953.14058639, 41476261.30618453, 37689462.10483353, 45461022.85054712, 43533093.48629379, 55833756.43985791, 42978056.63723815, 47922188.10114002, 43202526.31578254, 52347690.174486116, 42066518.74524395, 40447494.01049537, 46627287.26789643, 48550342.76641118, 55833920.58805201, 44794121.308082685, 45903459.59069087, 52253164.88803635, 42360965.15325012, 45436895.39924774, 48025880.5665705, 45807289.02237018, 40112736.49839385, 41870750.334432594, 44322396.217294574, 41818221.23403818, 48757524.00749319, 43767163.73598441, 43378334.57212612, 45507010.69423801, 42418758.265555605, 46617349.83742426, 42174560.641243905, 42037132.242006466, 55834285.71428572, 39273773.02182631, 55834285.71428572, 46026378.281065404, 40441493.35200696, 44971354.76059813, 51472315.270281605, 48179587.73390459, 40430306.16212654, 55803081.05041956, 39703835.6961958, 44065364.845242664, 49030765.28546225, 45908879.350578725, 47529635.21042421, 41023459.772418305, 41451879.34317823, 53835720.147589825, 45273627.04648766, 46917703.4649041, 38560355.89814384, 50422627.67085178, 36489512.22727847, 43990832.646907136, 48766373.84144254, 46245608.90056212, 46694060.41091548, 49751598.54283817, 43555473.33087042, 49340876.58729557, 55833940.22368805, 45189663.786373794, 54640982.98123565, 46515172.63831308, 47085193.47034074, 46946952.704252206, 34086173.57678842, 43685556.76602555, 43049401.97629565, 54385129.69205811, 46162016.00293584, 43150010.08769524, 47591305.78068147, 40890402.40521224, 49120500.23037841, 44863549.66362665, 45919344.03857542, 43321129.95864348, 46113770.573009, 44809701.20426621, 44688949.530644104, 46451054.82414972, 42255605.04686989, 43072744.86596704, 44180145.31754302, 45368134.542667754, 41246026.08285393, 44687923.290362485, 44934405.50652092, 43522136.54557635, 35895624.94833355, 50335507.44777472, 41331584.58451693, 55523434.37702249, 43143409.581274234, 36678956.66500438, 42243879.213907026, 43299932.75003859, 45828188.60118051, 43771658.626908556, 44744251.80440501, 46637409.01138948, 44875772.55458959, 43206731.866492026, 46569557.98055146, 46710961.5648449, 50513497.14559912, 42566335.079135224, 42058468.442077145, 43095248.20697461, 40709474.60342921, 43579010.28908204, 42562085.68271882, 42854442.91239356, 44190181.455173835, 45722925.64506176, 34085714.28571428]
thresholds = [38655148.09045208, 43922345.30508355, 50109736.8413483]
display_name = "Patients Fundable Annually"
units = "patients/year"

# Calculate exceedance probabilities (1 - CDF)

sorted_samples = np.sort(samples)
exceedance = 1 - np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

# Create figure

fig, ax = plt.subplots(figsize=(10, 6))

# Plot exceedance curve

ax.plot(sorted_samples, exceedance * 100, color=COLOR_BLACK, linewidth=2.5)
ax.fill_between(sorted_samples, 0, exceedance * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Annotate thresholds

for thresh in thresholds:
    exceed_pct = (np.array(samples) >= thresh).sum() / len(samples) * 100
    ax.axvline(thresh, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
    ax.axhline(exceed_pct, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.3)

    # Add label with formatted threshold value (use format_parameter_value for full units)
    ax.annotate(f'{exceed_pct:.0f}% chance\nâ‰¥ {format_parameter_value(thresh, units)}',
                xy=(thresh, exceed_pct), xytext=(thresh * 1.05, exceed_pct + 5),
                fontsize=10, ha='left', weight='bold',
                bbox=dict(boxstyle='round,pad=0.3', facecolor=COLOR_WHITE, edgecolor=COLOR_BLACK, alpha=0.9))

ax.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=12)
ax.set_ylabel('Probability of Exceeding Value (%)', fontsize=12)
ax.set_title(f'Exceedance Probability: {display_name}', fontsize=14, weight='bold', pad=15)
ax.set_ylim(0, 100)
ax.set_xlim(left=min(sorted_samples) * 0.95)

clean_spines(ax)
add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from

output_path = get_figure_output_path('exceedance-dih_patients_fundable_annually.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Exceedance: {display_name}',
    description=f'Probability of {display_name} exceeding various thresholds'
)

plt.show()
```

*This exceedance probability chart shows the likelihood that Patients Fundable Annually will exceed any given threshold. Higher curves indicate more favorable outcomes with greater certainty.*
