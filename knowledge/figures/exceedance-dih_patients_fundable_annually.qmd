```{python}
#| echo: false
#| fig-cap: "Probability of Exceeding Threshold: Patients Fundable Annually"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Monte Carlo samples
samples = [48217994.78381357, 53696862.392137624, 46578355.38544919, 45896028.48901208, 62822099.01437717, 56254488.39586347, 48884461.65719688, 50598484.49987117, 49436282.99810962, 52750507.22772421, 46114465.62800982, 46479609.57587985, 49119516.604056016, 44691051.97410156, 47612600.789158545, 52776087.1736326, 47978955.811530136, 53185457.32535618, 46117858.069011636, 49563528.01375923, 50085252.50957154, 52050751.435098104, 43941117.62610481, 49967497.286944345, 51040482.00847142, 50739600.35529773, 47373734.61965303, 47991270.896562956, 47815455.14317519, 47748373.47147895, 38357142.85714286, 50953769.39092229, 51373909.354085535, 52590023.39018038, 47067073.13207661, 44677316.57728906, 49810385.22387075, 52697788.23944861, 52633735.87113844, 46940789.94850765, 46604383.40844195, 47333874.090042986, 51988513.28145322, 48490280.87708007, 48926798.215508185, 48541009.48861975, 46143001.16096677, 48522527.31237087, 46837715.70132314, 49113614.60093964, 48276400.68543832, 47011178.906274535, 57823029.32569046, 50611948.22944916, 51207272.41099984, 51881195.35170925, 50437366.74483811, 41866038.41767195, 52802868.02686357, 45797397.77218057, 60185859.27117336, 50671733.84086188, 48752188.60931356, 47175909.20905912, 46720386.91651306, 46423522.013266005, 50726182.08328229, 51175412.055906825, 46191212.24514097, 50110296.41379711, 55990629.16566944, 54593420.92992332, 53022999.93872221, 47503150.80762473, 48829159.00689657, 46795664.754611656, 51036223.93005766, 48768132.812493265, 47031974.62570465, 50571415.46835823, 47652284.68224252, 51974058.96898068, 50782614.48093869, 50856293.66168229, 55202842.715285175, 47540729.68104436, 51203417.09204762, 49324019.752368845, 47563707.87389824, 47690187.61727435, 46886924.72943019, 49750654.25907366, 51020566.405929044, 49678250.5093388, 60233539.898811065, 57720069.10657369, 56459711.21788634, 53343998.50872109, 47863569.6524775, 52965547.4199033, 50842186.33124031, 43346776.17421116, 50755865.46267336, 46625147.43281188, 53081305.96539457, 50165284.79637579, 53148907.70174749, 50688046.59301213, 46254604.27710355, 60662257.92921104, 47735024.10559156, 48469307.59558679, 51701452.73563881, 57709268.22293172, 49096273.567884386, 51442718.91015397, 48488343.22578744, 49288212.156087086, 41079112.97825435, 50297495.77385792, 53539975.415181816, 48689714.18528988, 48536081.854790375, 42887667.83325897, 46273267.26053587, 48023213.667419896, 42101946.62590982, 55133559.31083227, 51884712.517261356, 53052313.556477904, 50888157.59238139, 57003209.77225901, 46997086.11109909, 50230669.10759185, 57963262.26070787, 53464786.32886675, 48185086.12272429, 46262437.77727105, 38357623.47446471, 38357142.85714286, 47809232.62284352, 53312104.296692476, 62822472.55885592, 48356678.00447497, 52586630.14532526, 50989137.59160598, 51773498.887526415, 49914253.52328748, 45179851.67830344, 48773776.75056263, 49983418.521002464, 53655610.28468856, 60098525.46704013, 51270628.87011533, 49578364.05564536, 39884537.04448756, 48875227.96727708, 45746015.46940691, 51322323.97911112, 55096202.61599342, 53211188.164980374, 52229956.18455293, 38357142.85714286, 52621100.12826624, 46261135.546195515, 52955061.7906393, 45928074.70648306, 47918667.596042745, 49975673.434080556, 49528295.284959614, 51945280.39911466, 47691886.52173485, 51146161.15853964, 55495220.725126944, 56013002.42951293, 48714991.87675768, 41244978.79602877, 48762637.87691212, 49828520.58630427, 48288741.38430047, 43294667.328943, 48538395.45108967, 50971612.96285807, 44857635.067661285, 47756025.26638821, 41563654.21600704, 48674757.18327957, 55484026.832037255, 56917020.48467024, 40722069.10303667, 40199334.083982825, 50064489.82928766, 50862013.82277533, 42115846.19753017, 54339764.28027425, 52921381.45279899, 46967271.13330535, 50907096.577936195, 49391495.97658114, 50002071.39237904, 48095189.42417009, 42521406.37863456, 49026005.350973725, 46965040.107677735, 62822405.225874886, 49558883.777226835, 52710357.504888535, 55428363.522229336, 52853369.92190918, 50668739.35639979, 45983977.162928104, 56496725.4506686, 49254642.3713666, 51262122.03792316, 50643384.38209243, 45674982.62401826, 47352389.89163429, 43053946.26486189, 49967404.99047908, 52111419.11634297, 50237046.93838949, 48451400.73133869, 48699926.45718999, 54121697.01400541, 49026367.279728524, 48505084.24244901, 38357142.85714286, 39120430.149496086, 52751323.42477001, 50485299.67980979, 57887565.900261104, 51687642.75191403, 48177266.41118772, 44071523.994170725, 52245592.16199062, 51942695.889902785, 62822484.94230438, 49999056.637, 53911046.59204194, 51442506.230004855, 52848073.74691294, 49734353.11956168, 60990321.81421907, 57924590.71603004, 38357142.85714286, 56107363.855321, 54240907.90391029, 39398862.87663478, 38357142.85714286, 54965559.06271311, 50803090.33624896, 48080331.53942447, 40163420.21045783, 53301016.13951876, 50320615.87221358, 46481248.86828569, 47733755.44210679, 50834270.99791077, 49887271.036561, 56985102.458660744, 50292883.01630728, 50403113.24519825, 48490248.63837802, 51545943.67864461, 47597713.4438542, 45609178.0511454, 48779906.34831663, 48042280.795938484, 49168621.56767791, 49371544.36373959, 52215093.57876001, 48173941.48468038, 49746025.839146174, 38357207.91950035, 41287022.04564094, 47915336.915482506, 52383491.574142806, 54391535.39441945, 44186800.70339762, 48375304.80623548, 47565934.950389445, 60848314.899588875, 45942817.55642837, 47660995.131252825, 54372418.29873651, 51211850.6011924, 48371670.73141492, 49171248.9850961, 50504059.87458952, 49769972.63806071, 50346783.338762045, 48790760.50009032, 42040758.85763374, 62822807.701526046, 50287718.12605859, 48700156.771343976, 48250649.92825747, 50817542.87199755, 60979433.46368704, 48130959.13111187, 40173033.96023292, 58615453.21740849, 46170233.8226317, 50646733.19862881, 49607389.24691611, 53820076.50880683, 50670047.59861052, 43340492.999929234, 47188972.596076235, 40137646.36479043, 44294672.282152176, 47717751.03144894, 40054870.424905404, 47718097.39293049, 46298859.6841085, 50521305.667584464, 49117553.02463567, 52117408.49871349, 45721716.39585605, 55031315.08329748, 46463166.393190615, 50107756.18937232, 44343188.449915215, 46576844.8830318, 39512858.13338786, 46649549.76374383, 59013899.0825052, 49629063.26447719, 54969856.76121908, 51397980.74397664, 41745109.720195785, 46988394.54148379, 52123501.2659261, 53447123.76562272, 49246422.54764662, 55406206.994917944, 52011231.00831104, 48190712.398399025, 44468841.02063968, 47093449.66956512, 62822599.62108516, 48219305.907560326, 49096639.096748985, 47811159.04343009, 40973957.87324969, 62822416.06448529, 51689232.60970729, 47158760.97649015, 59114031.16984497, 42007493.434032924, 47980423.64307399, 46232076.556620225, 51608441.06027742, 46350008.93527336, 45159869.85012354, 48487583.79073626, 48481853.387552395, 48346801.97581743, 52792684.94411346, 49940358.69495949, 49959715.84921336, 47924458.9971142, 45685385.23938996, 53873952.035441816, 49853160.89630715, 41966431.85837236, 52304421.80571976, 52624625.042830735, 48602765.10125899, 46239968.08576664, 49328108.241783656, 43118506.637870155, 46195450.20678535, 46249176.07132098, 47293616.93425157, 38357142.85714286, 50164210.893523514, 62822310.380617276, 41061055.48219444, 51156941.06290866, 48960244.22216753, 43267389.86371094, 59331192.40328073, 55752280.33399536, 59320859.1519974, 52509960.64363727, 47715714.371557176, 47403606.08085048, 48324552.84596818, 57369343.09067967, 62822614.300139464, 49164049.57609066, 51212848.926524915, 47642630.52860406, 46754027.08992307, 48845018.09338863, 46543363.693394415, 48501383.74790233, 47381988.26268054, 52146732.01037701, 50064848.03405412, 48623629.183270246, 46325676.70476027, 50903683.909564205, 47414721.019025624, 50400967.204935834, 49824282.13878157, 46293358.2603856, 62822268.45098276, 56197542.995759286, 58080420.51429816, 62822632.54805263, 52039989.13053266, 46582033.55553374, 50475509.417537875, 48619802.92613327, 44993817.657344036, 43128266.65018524, 49637478.31660752, 42930353.81958168, 49020139.72896232, 52686511.8149674, 51702457.244496346, 58063429.10719792, 52894316.97281704, 50762769.02499317, 46386644.54477702, 40220017.155438304, 57058825.25225109, 47889382.83660841, 53702197.820410684, 47586046.15838635, 49876678.94684235, 61787095.24111717, 45939755.906577624, 51745000.270484254, 51460315.11546615, 53981301.14810238, 51943247.384093225, 47759235.235338464, 50102286.62006751, 48128469.39026671, 48004391.98877587, 43182100.80525085, 50702810.578057975, 58025538.812128894, 45169887.54829998, 50658379.13378117, 44791542.17313963, 47924521.30431571, 49876875.877631135, 48053395.46266037, 38608472.62662942, 38357277.66376134, 49106746.471114196, 48761884.867650084, 45097617.87415222, 52720299.42331919, 48112005.413051486, 49471060.08422612, 48183611.33324363, 52670042.87604521, 59197722.881556705, 62822424.12513777, 54439557.20700828, 51160814.88677947, 50508059.02262546, 38703087.16272711, 44859987.5936871, 53198698.58327999, 48057376.69308331, 50956391.706899814, 50473471.812140435, 48666858.08968083, 47055414.42424035, 50688933.19033054, 45196932.01855688, 54677302.30713165, 49347585.61781118, 38357142.85714286, 48524469.781283885, 42327526.62790793, 49022447.010816544, 47195852.18876782, 49589910.240903474, 50029103.17579013, 52450292.16893432, 47750299.28785643, 52744340.86586347, 46886196.40178953, 45025230.81385647, 47987221.00118151, 50480854.86996542, 47662677.404661216, 50568772.61885026, 45913908.31645412, 61792577.7935977, 50674574.15711515, 62822259.42686403, 58213269.89587172, 42852078.40960218, 46057988.52377188, 52206676.3473279, 58290201.581180364, 62822857.14285714, 51498643.11391476, 38357142.85714286, 47733317.544899784, 51562925.07134014, 47621578.38898281, 58897967.38700577, 50524255.477335565, 48992183.03292438, 49702862.04342441, 46432679.867536545, 48068803.41392143, 46876222.95089244, 52080818.6735272, 46048585.023347154, 40881438.84157729, 53231969.38892626, 52892518.68975567, 43066286.71155912, 50110450.642540485, 42549057.620537795, 51096783.56461455, 42163734.129855245, 48870633.634615295, 48392279.30780416, 41350404.63207837, 50777557.51437735, 53112220.70389794, 51120691.36400577, 47668713.717291154, 58948161.47065111, 46988623.98065807, 51479768.932066165, 44528098.59334091, 62822679.119011566, 52479126.1894442, 60224285.432307445, 52640875.73948254, 48431967.13613162, 50063353.124589205, 50352254.0072697, 49985552.02758491, 48598683.76390448, 53397997.86445642, 46736262.45323825, 46896821.66456428, 47918344.139265165, 47284745.66947431, 48249062.12080479, 38357457.163120076, 49706694.277318306, 50562534.41314173, 52344773.821872376, 53623328.007262126, 55681332.09772976, 52897039.80301961, 49643420.219159536, 48107432.303188175, 49176304.41943154, 52393564.34459093, 46040117.17564982, 46618282.11000691, 49987349.70186824, 51937737.678404704, 47314503.1334062, 48656857.91909572, 57730463.9648683, 49633019.10568008, 48377983.34002594, 52941782.90755095, 48649797.668320544, 57799092.61555805, 43063214.1101151, 43743300.057505965, 50348892.924602896, 47998682.67360066, 62822691.03141583, 54817303.74690338, 50510361.03918161, 54004112.91011274, 46708892.758098565, 38357617.927383274, 55014823.272443, 52686778.26031578, 48477912.2428546, 41011043.04113283, 55463405.12633735, 48426817.005166784, 39508277.993301906, 59854606.41196002, 56044139.894100085, 51021786.95190069, 51407188.527946256, 46354191.256692044, 48454548.48519876, 61177037.49653424, 47435911.859927215, 51634857.99053471, 43537953.25817473, 51835765.65257368, 51872088.115453616, 47341305.72564381, 46533272.837163806, 47684383.38987956, 60214983.77740013, 47352687.58420485, 53642797.21695078, 48478560.33975208, 57481115.32902023, 47690961.33337436, 52560759.791500986, 56059711.394659735, 46710982.3961994, 48454605.63873437, 51781051.79239926, 42192698.99449756, 51089317.09965899, 49249000.101539195, 48352167.17468794, 51803914.56000991, 47599199.42465778, 51458526.72296699, 50974425.54482486, 42861360.64165871, 53702599.19866992, 62822693.2004643, 41012348.036909185, 38357142.85714286, 50949239.50491438, 62822041.40836054, 50575879.24647828, 50480753.868959635, 50104928.56542848, 54400962.99331618, 47200306.71898129, 47402430.44015379, 58206502.08242888, 46764033.13036587, 38357381.91286584, 48717364.643694766, 50681329.356939234, 49918949.61082085, 47069713.26755132, 60698326.41385157, 48745992.87999857, 50890740.71188528, 39322583.33398534, 50043722.79702631, 40599584.63898786, 54307901.052645, 47172112.78830342, 48163077.56783048, 52816045.551312886, 48696816.9232832, 44019392.35983701, 50628133.535957046, 60283007.018221036, 49439205.20430837, 52952990.76393399, 50701058.96183588, 49685458.516753785, 60429560.93033661, 59472420.04773947, 47558834.45687007, 51415686.66804143, 62822806.30424294, 46454173.53843605, 48339198.624018416, 52183975.41061267, 56400934.80171568, 46270765.02689624, 48051252.037303545, 38357142.85714286, 47787792.88901166, 47908433.007996626, 50015595.90592598, 46339172.87493628, 47033818.90012811, 43713985.696285084, 51410118.46507023, 51068528.78418567, 51241974.116986565, 46432695.7279871, 41840519.08759635, 51161470.73873625, 51026407.88057032, 48182979.297119364, 50322504.505597316, 45855114.59619866, 62822568.56608365, 52642818.18090961, 52462233.31180207, 62822622.27028923, 53205085.44274282, 53005329.1387501, 50148420.31569102, 44804480.93485384, 50319767.76575144, 53609540.26395906, 49590569.64770355, 45314880.70525658, 53255967.15090281, 52986492.30370796, 47277349.08264995, 50227992.954776295, 46952115.7043823, 49424182.844540864, 46755079.45379945, 53650128.97726634, 49418191.56096094, 50185735.9301312, 55399627.12056204, 58924305.775682375, 46812871.60366443, 50734950.00961073, 53528410.55770705, 49741749.98228594, 44684881.14272237, 62822591.358035356, 58229571.18133404, 53037129.36605851, 42117831.56121, 48300882.41320766, 46517416.08411559, 54660058.80807028, 54460350.32957686, 47685440.58409035, 49149092.55490112, 47313361.40247026, 50096169.8545323, 48317541.60429152, 48769724.75087091, 46479698.13566246, 46374320.13930244, 59516902.64425619, 62822565.002776, 45678572.47638, 44213626.98083976, 53512668.73245792, 62104946.91987611, 48993866.08214118, 45930694.452952586, 39674958.214908175, 47432645.595983855, 50816762.5630307, 52914827.08754804, 49328011.63539206, 50531867.27145411, 53459936.096604936, 38357398.72511354, 39762614.095721565, 44621212.32366242, 53028751.85114104, 46201814.36758639, 46980763.04458435, 47704942.23721621, 43729977.87135705, 46996282.87213243, 46616105.354002975, 46990683.31200112, 48083183.11682912, 61270959.611563444, 49052508.08230436, 51549402.415567406, 56031925.49402925, 40499262.72203582, 40161296.491878994, 42887416.30113891, 48403605.72042463, 42952932.59003324, 49325707.59931025, 48600912.75445128, 54209013.785459116, 47873908.93813603, 49141039.02457458, 56259206.61059106, 49568417.68569876, 49678294.27703016, 39675193.25400176, 46061462.56734558, 49328034.03964275, 48427752.15449686, 49202757.70990638, 50155461.88478047, 54102865.7623928, 49954014.52497283, 52314609.14935023, 55739106.35687216, 47451335.8850295, 47895191.924771026, 61304618.87850126, 49844169.31260366, 45700009.09879734, 45234086.93423264, 45503042.63155398, 49222996.277664855, 52717780.988643214, 54115077.10896868, 48068953.84278722, 47939763.11157297, 43438453.96885942, 44907916.52436372, 49881099.303381614, 55678704.612510905, 50609730.80228578, 48546500.1857536, 50152228.68278805, 51636281.196258955, 48412354.177986905, 51340893.4488921, 51837690.415355526, 48192794.35421965, 50936286.8878102, 48445356.03391402, 48336068.85431689, 54652959.289682224, 51250475.538021, 42293243.59184021, 54873093.58287791, 62822460.00610438, 62127088.73509799, 49260458.70828906, 49253549.99017639, 49824547.72013185, 44006332.42724215, 62822857.14285714, 47877838.151382275, 41374499.31421618, 54540096.55643922, 50848672.46223528, 52342192.213064484, 52919817.21021284, 50637839.36819675, 42370616.401201844, 39395552.161661014, 50675879.10972019, 38924871.21664806, 49235744.155206494, 39985525.71622634, 49730633.05041692, 48872256.915348746, 47991157.63387203, 38357142.85714286, 46215206.94172756, 52157217.50617933, 45794839.884430416, 50777802.04161464, 51284325.15142538, 46010046.36246536, 49252906.65731228, 48315920.94159868, 49318312.45301346, 48098890.318599544, 47770077.144215934, 62822041.93218535, 46882602.98363732, 53281014.53790701, 57670789.661896296, 49596175.938443996, 49051137.93743465, 52101568.66512032, 46287922.34053475, 56655178.492491536, 50955859.94345486, 51664254.880305424, 49550688.22652778, 48314839.61208628, 53391903.6315202, 46673063.220623426, 49131061.87371923, 62459663.919238046, 62822129.59885239, 49419091.438403845, 50225776.00510518, 49769709.40750219, 49479198.265786886, 48515130.719946235, 45870793.78492475, 54378924.58459167, 54969509.47383612, 54207594.64053803, 48277160.28244236, 43766630.32934806, 51052410.96338297, 62822759.90472122, 60411777.759440884, 52668685.82273356, 51555550.30434454, 50961573.277744725, 49224264.847041376, 50580833.715541415, 45313545.136220865, 52030916.40759634, 52788477.244743936, 47570615.945827976, 58633976.92895518, 47901039.436372966, 48980490.17192984, 49940024.66991894, 41177749.474543266, 51814131.31476861, 38357349.30066702, 50243178.04661655, 56003847.03207636, 49104694.50288133, 54043539.77646423, 52337578.62804231, 47873752.897248134, 47288237.370122604, 51813971.52612864, 45729450.139782466, 44451506.04385183, 42304325.38468457, 47384383.55560362, 42855377.65939579, 62336289.200889476, 50605018.17891902, 52807678.47754466, 48917154.39722946, 51610465.5758454, 50012607.07762296, 39083411.80363691, 50026433.052598156, 47811522.586121924, 50269845.0691779, 49082620.61685291, 49348820.230692685, 47683551.77313528, 44389982.14979744, 40747637.86714596, 48199649.91774731, 47163737.2754295, 54763987.572588354, 49709713.04369359, 45897009.14832948, 46162562.59222748, 48567684.59185178, 46089429.39210469, 47526731.41025631, 44114959.33920112, 48275502.3715267, 50753637.67126911, 48101659.84034758, 62822857.14285714, 47926349.05203396, 62822857.14285714, 60620771.69479378, 47670805.44164146, 47575586.663872354, 54876494.938112, 52176797.99788745, 42801282.27832933, 51261567.94590397, 38357142.85714286, 49379224.15626399, 47832887.44522117, 40969120.647318445, 48872373.39355599, 53365098.05106177, 49794075.88249202, 49508497.88639573, 56882512.88491581, 50361845.39362539, 52298756.22830759, 45953805.821717925, 49239430.00445092, 50467330.49273554, 49780377.381818764, 48524310.5724539, 47064023.55775609, 53354202.93844375, 53712146.04286566, 44870456.956767134, 50977188.6723748, 57410855.30956113, 47700250.96084706, 47627900.71756794, 58582739.085040666, 48500366.14519656, 46632141.79750911, 47957974.373031, 47008649.30625938, 57282907.881239735, 48119586.986503534, 50545024.784862675, 51256636.04544094, 46146128.80953633, 41982690.90751197, 39697685.60881781, 43227014.19262813, 49794101.88789212, 48038687.396647856, 46519201.174772136, 48909744.188927226, 48873370.65534185, 46314082.428777196, 49599529.933629386, 52246415.472252734, 50985639.352457, 47001611.75865304, 49360400.278721444, 48085352.97544154, 46869844.239217535, 50829085.69206122, 46557401.19310763, 47941390.71180991, 55585972.32778526, 42259247.78453568, 51328095.25555057, 59890049.02191033, 53745101.625107765, 53516678.08349095, 49172368.9093152, 50432311.258150525, 50679389.78516247, 47053475.60546118, 48086601.78097954, 48175610.507409856, 47826234.08284159, 47066505.98080262, 62822452.88845481, 50788070.13309014, 62822511.526692785, 49233896.94579508, 49389622.07608557, 45344189.31412346, 44214339.09717721, 48600996.59820222, 51326567.226599775, 47547413.91751884, 51436432.19639575, 49377203.92990275, 45733954.52129359, 51555720.153505534, 46379106.72204718, 46843213.6726631, 53168579.78951757, 45777437.40101266, 46766321.39239365, 48982874.72478357, 52380509.41422944, 52775733.20785868, 51475340.26742693, 47335930.80581971, 53172017.54828096, 47723582.427100815, 55654498.14998677, 50159955.88182094, 48953529.50264391, 38357142.85714286, 57009577.91806204, 42036857.11707327, 48801061.38449351, 47821247.448487625, 48920487.48821587, 47696866.835186325, 49964223.27954861, 42171188.533774815, 51152065.5784049, 44651443.27977229, 51903297.29380333, 49603260.61603331, 54002479.10101506, 47658763.152544156, 42238079.81432236, 49669145.28488374, 50132004.769089945, 54412829.05448367, 50258234.60825117, 59231627.10612664, 52995961.22965075, 48510513.97376277, 43194743.95327917, 38357142.85714286, 51671114.11816905, 42311851.19974117, 48446679.17439351, 49954773.43065873, 47741801.600165404, 49135202.38306859, 48950687.93739137, 50961353.9486823, 57220331.06839768, 58717094.85038775, 46931127.99245711, 50443464.30839205, 51709231.6524222, 49339289.213252276, 46417810.719352685, 48685601.923189424, 51950388.25237356, 43911853.588843025, 41244288.394598715, 47512753.035956606, 45778256.92126097, 43789854.6200656, 44668376.407516696, 47073942.69049245, 47131533.02796465, 47420266.1704786, 54246222.792941175, 46758492.76663035, 56792466.93795586, 52511847.68568024, 43313405.730353795, 46254920.148098454, 41922162.15268416, 50423795.7428565, 54777443.43082747, 50301717.38704181, 48982474.0202815, 49070145.68742547, 44639980.50382416, 50775587.25183693, 48041243.99746543, 53308336.478793494, 47676175.576490074, 49359958.76935537, 52329691.023649506, 50283734.40683716, 50082583.93841891, 50417851.50528702, 39860380.13487317, 49750501.82724488, 50315220.68535542, 62822444.276592605, 52919247.75535803, 50390152.8252266, 52070638.00889286, 42716487.3511, 50007872.17964579, 43429868.11696522, 49136010.21231603, 49229434.77442722, 49713261.03725891, 49357324.55218499, 40234127.88960278, 62822621.69161019, 62822302.466569096, 51497345.73753876, 49316235.54774708, 46797048.42191886, 47591992.50467123, 50866191.95797199, 45557961.345017605, 45467840.9518342, 48671646.841109276, 45817384.624938436, 48338165.02792152, 51570570.35958999, 46769042.19771233, 48949862.07037475, 49366734.37169667, 42029847.30436227, 62822721.95801558, 57419434.78580549, 55117000.492691405, 50783429.40316206, 50357062.562106535, 58340100.96891713, 53293990.4746476, 52782431.18878296, 38357142.85714286, 39645744.50599777, 50974864.9750474, 50784700.83857651, 54747851.567044, 62639199.65493996, 49821722.673203744, 53346503.10081691, 49698040.45856723, 59309575.43517227, 52379091.0468984, 48805664.43983668, 47988419.57072078, 47797869.9741401, 56437566.727021724, 46203010.77816143, 52534718.63156349, 47005451.52823453, 49412646.45730897, 57000188.87204841, 50598308.25554443, 47991570.07689152, 47078085.54841979, 49915016.637494996, 41593023.405061215, 45651349.822565116, 50365058.08174399, 46579546.2845065, 38726726.000033915, 38543608.0995384, 55518804.00613924, 53052137.263093404, 41940627.233042225, 53871513.665021986, 56458123.39956331, 51270176.22560134, 47787651.536321655, 49765756.90764063, 51928258.08756565, 52023630.5580011, 52177749.470361345, 52858935.959766254, 38357142.85714286, 48244969.10670603, 46088123.21433744, 51281648.23551075, 50089505.906699456, 52182676.351102285, 62822857.14285714, 57016595.46125479, 61565168.26843614, 62822566.99108413, 55198133.9511878, 43149184.32800863, 49542417.24401063, 43413524.57138247, 47821950.21023634, 46462414.486379944, 52946721.27489511, 47404477.67268047, 46657011.26505126, 51631285.95199635, 47273711.202438414, 47249326.509549804, 51522852.70678908, 54491602.39253774, 55088230.07270259, 49041528.74325412, 48134641.07276642, 52503399.78390546, 49270110.89878648, 47233378.78385203, 47058995.358236946, 41444796.1260069, 43518368.807927944, 53360740.37280508, 40486535.177987754, 51448642.00600261, 45349499.24113031, 49112061.21562963, 50976447.022692464, 61533271.27672844, 50033594.934962206, 58881507.98657314, 45800878.78081714, 41703876.30906007, 52521266.42253384, 48228273.402593255, 52230626.70607381, 51839374.30951911, 46491507.03221132, 49519746.87142364, 40085375.47425447, 51254418.06849671, 45687115.63717435, 49000031.483575985, 46414763.49035522, 51115112.270814545, 49562116.15581757, 49816382.44570335, 52681029.897098824, 46898949.12581402, 46942042.54055217, 47149067.9551085, 41554725.48264012, 42206444.408039086, 50829492.838609576, 47962940.48923526, 51819732.94182534, 49282462.83220878, 51723920.71831719, 40945871.56189231, 47997774.40511652, 50214325.655211985, 44167380.0738161, 62822503.801495686, 62822352.68358528, 46414544.99471895, 49140724.325168535, 48421517.261947714, 56496759.393819675, 49460967.43442623, 38357591.35962501, 46312477.30599799, 48725886.685036436, 51082980.51787401, 50906969.101059, 62822470.23951744, 48394489.24637757, 46236027.46411501, 59051389.65117509, 51972006.160562165, 54828171.12695789, 53212156.00260659, 49167376.575879544, 62822433.54500426, 47073316.938761875, 46566050.32636603, 50343365.75717257, 62822744.291795686, 53340570.97361074, 43860348.31436365, 62822857.14285714, 50721452.310516044, 55047892.440019205, 46383097.00448625, 52027269.59513562, 47848044.80143594, 47251994.00680992, 39403675.27983165, 50155570.70314948, 47951803.72961452, 58110007.93233906, 44192524.21359209, 52373135.0884081, 51567653.88853115, 49457183.25967506, 58918099.53950893, 48503045.07871783, 45800284.90414989, 48262110.97019932, 59190686.24242953, 49848519.68612162, 46608816.03109525, 62305232.652130455, 54029354.28299938, 46124684.33485475, 48347731.80559239, 47818279.51486228, 39241165.574074924, 47608744.97040591, 46914217.19830127, 38357142.85714286, 50197866.74154567, 52525226.58406547, 47759583.832705736, 47718105.27922042, 51431634.090533145, 53624606.60800237, 38357142.85714286, 48135262.71158001, 52258571.91166624, 45983878.07295441, 49791825.84575522, 50350315.54471429, 47263686.01811447, 56151785.79049101, 48039033.98689194, 38870329.454314426, 47617522.20952251, 50834492.02292449, 51353433.98748522, 50969290.298081554, 50354540.25552491, 50840781.780483335, 45982517.606812134, 60725651.52813955, 46176785.591781855, 50848199.03463608, 47948441.61717521, 54532422.84518997, 43121029.97310105, 43761286.72117962, 45828294.35259831, 58417060.034115165, 46294788.37385794, 47844698.660033606, 59362907.56054174, 49465050.38183852, 47994658.94408792, 47286427.22867443, 48697326.17665404, 48268488.05747347, 42024937.277134456, 43913873.61918549, 62822857.14285714, 50603180.47281556, 50006759.41844125, 60929449.76253386, 49012317.20645959, 43737025.66166201, 54142638.26796619, 48099570.4413965, 53008073.712540455, 52014345.552943304, 41996717.38380829, 51494896.295831315, 47632179.09391072, 62230456.86212935, 39221497.058599606, 47115785.37182349, 50076071.04983999, 47215016.926071055, 57339354.97007538, 44254427.78053346, 50628892.0475641, 50159959.50415334, 51291908.14208804, 51647329.73487586, 46780465.13127472, 48401000.82577312, 46936580.5896832, 49405575.930426106, 47444051.50354993, 51002953.68518097, 38357142.85714286, 58970878.05560927, 43642531.09601466, 42821304.80493712, 52746884.75990884, 38357142.85714286, 45700758.01008897, 45787228.95743809, 49264617.251150906, 50211196.872772455, 50180746.691926025, 47897920.742404886, 42568974.43430973, 48682011.51408026, 52990063.82082063, 46311659.67185009, 45965247.30354217, 46925975.05171702, 46596263.7740629, 50420875.86255828, 53062247.56698608, 52812546.86888587, 59681784.93773677, 48472268.10827737, 49692634.61333573, 51086682.03193566, 62822857.14285714, 55709458.470133625, 44741874.121524416, 51984948.67562147, 48009348.14920205, 57144995.28119981, 42286269.729741074, 49926792.5080172, 48272950.0292806, 38357142.85714286, 41706487.70691235, 50560503.630529605, 51697722.96942728, 50635022.10375366, 47456210.81311997, 49776677.47715123, 50909620.90896289, 42072956.96114534, 49811399.64649517, 38357142.85714286, 49025405.510493994, 39761554.876129195, 48021542.55289633, 45816306.96768013, 52227463.900500454, 52753434.84071939, 47641446.57606613, 45725374.7368986, 49217865.187162995, 56097116.748632, 56837275.9853266, 57515826.347538695, 61097444.222521625, 48954146.468499735, 44708492.52227877, 49423296.825345784, 62822575.38112113, 50108181.59236293, 49999572.97320746, 38357195.70124, 57822845.588203944, 50891584.42237615, 40326726.86771342, 47677429.78515103, 47259870.21318251, 48934777.92923059, 48123682.64715666, 46480267.6722146, 52572536.235669725, 46119260.41260177, 56965965.19549487, 48129567.70414164, 48691734.61321088, 51790358.97909413, 49458862.37581429, 51815468.93132025, 53999975.56181198, 50745432.51319468, 54310290.762475565, 48150380.43015352, 54756416.91236521, 46717665.533479296, 55062336.03456292, 51589828.77615128, 51823764.81145808, 43147720.391253605, 48122388.8432504, 50189801.04686609, 47497404.2460813, 62822452.26520896, 49537409.504397, 38357616.75230088, 48867369.3790151, 49112341.18993934, 47315603.18382013, 46056486.00489858, 62822286.122920565, 60180059.74799499, 48572654.45542743, 52188031.55334022, 43248380.20239898, 50594290.546676196, 62822032.02874865, 55914446.63222854, 62822857.14285714, 50277086.51828344, 50098942.246345855, 51025176.440806076, 45076491.25705637, 44128955.944190614, 50029028.799278274, 62822474.71303688, 47062316.22687704, 47289051.68766799, 48200504.75317621, 45750489.27691153, 54899866.468500234, 38357569.11516864, 53187706.88873113, 46582796.391152725, 60233681.57080276, 53067498.97708404, 41707016.98788105, 50381654.25733447, 46255988.536354266, 48472242.61304522, 49775650.06919844, 42852169.00730597, 50286971.074089184, 61239744.88430551, 52547064.03958497, 47304354.38562564, 47879416.60088095, 58961752.410533704, 52226375.73584324, 51651617.66767244, 50792134.81439208, 56995395.483095296, 51838917.2896972, 52243673.36143455, 46502195.44669682, 46366714.455162205, 49933700.25587282, 50896964.01475219, 48838639.130434245, 52601459.31908641, 54724810.740068614, 53108508.51651177, 51864835.39812826, 54886673.16233127, 48754812.61005015, 46653384.61844842, 59171791.7080325, 49275680.81336777, 50221755.78660662, 48080506.42374741, 49421467.26971066, 57786548.21195073, 55858663.17403349, 49259259.75856827, 45479261.97383919, 62822538.73457043, 48064769.342908, 44198736.39327682, 49961667.32340531, 47307986.61501402, 52140241.782130405, 49831335.205726884, 59527902.89284043, 62822640.837575555, 45888187.26861953, 53293316.07526567, 51148321.61987304, 57101983.01739778, 57340884.03575345, 50042421.73010278, 52247592.12594474, 47944633.96013349, 47667957.23211383, 48157660.04935277, 48466053.12519455, 41254672.00027267, 53960624.665841214, 49582797.73655097, 44647833.87128919, 43614620.38610118, 57461016.52888459, 50583224.516899616, 42895791.36045668, 47462911.85387526, 48629339.2681903, 50212983.53731791, 50864435.60507336, 48279774.1651264, 50348333.40321371, 49535276.09012003, 49071630.93048874, 52039210.19491366, 47374395.789691254, 38357142.85714286, 61199009.946787015, 48145839.916442625, 52371839.80059613, 47208215.452671915, 49193803.9808231, 46537144.01433591, 44309661.19771393, 48640066.03751548, 44652888.586981796, 62822640.80252807, 41161836.67118756, 47955459.373227306, 45084781.6549932, 55438817.69017478, 52659423.33775021, 48815849.8907844, 49437191.22099209, 48299077.0653081, 45031402.08609973, 61071421.95365449, 45777704.12022886, 49340145.82541166, 50158839.84391882, 57966439.96158247, 47481447.00183355, 62822694.20731347, 46948801.90260185, 58182753.315801054, 49167467.06169874, 49830572.00934305, 44356647.02087045, 50061133.08861227, 52104125.239021175, 51351431.367554806, 43550050.58693343, 47359073.84559198, 50871655.22757545, 50286142.22442199, 58962995.77735224, 47905566.03842826, 61012906.21702138, 46573491.82588481, 48881498.07036412, 38357142.85714286, 54273165.25766622, 49766781.81876261, 39670074.09838376, 44184865.12010623, 52112508.56433024, 48521126.90299196, 49364207.793890804, 48303248.31864758, 52122490.23754918, 49715282.43769939, 59286916.61742924, 48856839.00304479, 47677273.13683084, 50250929.443147905, 59466010.087259695, 45725450.62483604, 47994694.1492115, 52233153.84294656, 50458733.98324044, 58271234.230307385, 53558152.612808, 51475934.47809953, 43895264.13748994, 51883713.55583582, 46978621.62530301, 51477951.01238473, 48430908.44165629, 49916595.51463532, 46137170.9423644, 51463953.25285089, 59019009.39614415, 57056471.31757282, 51452238.95628316, 55726688.13487074, 47824810.344695, 51188980.106071405, 38357142.85714286, 60774199.31557758, 48597759.938934386, 54541763.91851078, 51298856.533878624, 48832972.412155375, 62822626.161665834, 48472728.92693397, 38939757.27289099, 51140029.17306677, 48386349.225608595, 45510437.241759904, 50004052.677950725, 51648567.192808464, 62822587.433731996, 46975788.20831566, 49807373.984284654, 53437321.05807548, 48889180.206614904, 51659469.534248464, 51438461.705908954, 47102480.32101624, 56617059.45110484, 45329835.783973776, 57216031.061566494, 51977186.30170763, 38801410.70305518, 44690150.83913316, 48999306.76510916, 53109781.77726421, 51441839.15393896, 49091908.03244022, 49228306.23450411, 49721264.7974019, 49490143.08981971, 50200089.295103, 57667510.86516991, 51390925.76147928, 45988541.00027452, 56918789.04694665, 50103496.45659336, 52614434.43075779, 48947061.2267473, 50883511.628175035, 41996717.15404713, 47468423.08194481, 56350642.32499238, 46865665.168866865, 52430637.74078443, 51632684.45448617, 48183944.87512619, 51292273.52296305, 46066316.64480478, 52430060.919427015, 51801023.04484312, 51951661.85387992, 51587202.20414662, 44914201.369200274, 47020272.733910255, 40297431.91984228, 38357142.85714286, 53608620.334867045, 49102790.85361708, 55010777.464744985, 52442656.34892902, 51845801.45740828, 53860747.5283898, 53810418.28952131, 49927787.14777079, 55407763.221974, 46248074.32866632, 53016012.02615561, 38357142.85714286, 51131879.705743134, 49096699.79839436, 56186263.44236729, 40325014.4047511, 44752521.14561796, 48247197.798463695, 56701720.638220206, 48571238.63068198, 54478670.495614894, 42109032.90838, 46366450.204797804, 49007540.08302688, 62822711.04626001, 53286787.929306574, 46805560.971616305, 44016540.44248119, 44834692.165691175, 59223416.51311948, 48229839.658664525, 45586513.133770734, 59924492.10470578, 49402163.0353095, 48333674.113750614, 50537748.92909091, 62020478.206573695, 50635623.656915486, 50641939.551651515, 49942465.914802, 51578527.57355912, 51098672.6292896, 49524235.68804741, 47705279.24597447, 50552112.72021052, 50966557.27802067, 49019274.71742926, 62781306.72186844, 47577411.61653053, 49374025.26129585, 49220015.56394618, 45824225.52768854, 62822106.225161135, 62822191.13431723, 48333818.73437322, 49399143.37051871, 48724107.888946734, 51174519.72076152, 46890678.630272895, 45924274.94934544, 47551764.44823421, 50381375.25300161, 62822452.67229282, 46510487.628322385, 43947459.342153236, 46962781.41064023, 52859480.58959892, 46856330.35301811, 46182056.25161692, 41393771.155382395, 52844995.10460212, 50247167.27077746, 46589850.969046794, 49152389.17793775, 54439011.23168699, 47808465.072239615, 47203602.25482605, 49035982.444331266, 48537632.91065231, 50373077.68921711, 41990114.74099571, 52945879.92864008, 51674063.745731816, 49329794.71179124, 46116054.820004106, 58237160.84434377, 56335580.28258128, 62822394.870596185, 49246754.53847859, 54448462.94039719, 50867392.65101062, 46901509.5662581, 51891923.99233049, 48493590.07887508, 50532154.318453945, 46862441.16831384, 47584454.40565616, 52095212.22817237, 50022286.96929334, 45358594.61998203, 47887340.830587015, 57208679.547951, 46922483.851725355, 54123834.68701636, 42483429.78564559, 45517087.0995146, 48273530.44518733, 48773079.226355195, 50179280.331756435, 46839132.17322298, 50813061.87863847, 48477455.108944364, 46141190.26302413, 51571864.93210363, 51789955.73046726, 55188402.7350667, 53930744.025837705, 61759588.73968285, 46652974.996888235, 39595272.667478845, 42386845.6706559, 59582547.1144353, 46670991.038168184, 42411111.439502046, 51153410.48860918, 48984693.5686401, 62822327.86842933, 48360338.41287964, 53922005.93595826, 48612841.85942331, 58900523.45697985, 47334961.73982779, 45513742.58173163, 52465341.31884404, 54628654.285855606, 62822492.01662344, 50403215.109698005, 51651107.01919555, 58794185.99684051, 47666180.1430119, 51126269.568997376, 54038655.696664065, 51542924.80980775, 45137158.44416439, 47114744.96352727, 49872574.07894298, 47055655.84149838, 54861724.813714705, 49247997.11974869, 48810606.756554596, 51205142.12374345, 47731190.8029586, 52454162.6838209, 47456496.42471312, 47301905.31828558, 62822857.14285714, 44193370.65035421, 62822857.14285714, 51789378.22035069, 45506992.163068935, 50602584.28655369, 57915759.28900677, 54211569.96206062, 45494407.17518255, 62787856.56277924, 44677167.365368165, 49583441.219129585, 55169110.282782294, 51657203.70450603, 53480400.17763599, 46161643.24975554, 46643564.21018293, 60574529.6747571, 50942609.3944804, 52792031.21298477, 43390816.58970173, 56734900.7594553, 41061239.68001496, 49499600.49869178, 54871680.520443805, 52035990.813392885, 52540454.56688491, 55980019.12538302, 49009868.44820791, 55517973.14117346, 62822511.65225948, 50848159.36391761, 61480462.930924654, 52339223.37134076, 52980441.25806266, 52824933.76966437, 38357602.148216985, 49156198.13723531, 48440593.9693844, 61192623.939161636, 51941957.117047355, 48553766.919625595, 53549777.00613847, 46011969.74212305, 55270058.51032639, 50481314.765561454, 51668975.42732646, 48746257.86218058, 51887685.817368306, 50420740.86575307, 50284907.86770685, 52267097.14636214, 47547662.076759614, 48466852.12374328, 49712556.968238406, 51048920.6363467, 46412003.71921903, 50283753.45500253, 50561020.214094214, 48972368.208393626, 40393153.16408149, 56636893.87689505, 46508246.85751494, 62473235.02640365, 48546342.08178413, 41274353.13213981, 47534471.85909802, 48722413.3387713, 51566434.72959637, 49253053.38486745, 50347117.13244235, 52476727.28828432, 50495064.24440768, 48617572.63864311, 52400401.53492235, 52559466.712590426, 56837125.41295359, 47897197.951570176, 47325906.078325, 48492165.881361246, 45808447.896912314, 49036344.956326336, 47892417.86209408, 48221286.796427, 49723846.55155566, 51448024.52846887, 38357142.85714286]
thresholds = [43497452.41041886, 49422559.611813776, 56382910.70796157]
display_name = "Patients Fundable Annually"
units = "patients/year"

# Calculate exceedance probabilities (1 - CDF)
sorted_samples = np.sort(samples)
exceedance = 1 - np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

# Create figure
fig, ax = plt.subplots(figsize=(10, 6))

# Plot exceedance curve
ax.plot(sorted_samples, exceedance * 100, color=COLOR_BLACK, linewidth=2.5)
ax.fill_between(sorted_samples, 0, exceedance * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)
ax.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Annotate thresholds
for thresh in thresholds:
    exceed_pct = (np.array(samples) >= thresh).sum() / len(samples) * 100
    ax.axvline(thresh, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
    ax.axhline(exceed_pct, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.3)
    
    # Add label with formatted threshold value (use format_parameter_value for full units)
    ax.annotate(f'{exceed_pct:.0f}% chance\nâ‰¥ {format_parameter_value(thresh, units)}',
                xy=(thresh, exceed_pct), xytext=(thresh * 1.05, exceed_pct + 5),
                fontsize=10, ha='left', weight='bold',
                bbox=dict(boxstyle='round,pad=0.3', facecolor=COLOR_WHITE, edgecolor=COLOR_BLACK, alpha=0.9))

ax.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=12)
ax.set_ylabel('Probability of Exceeding Value (%)', fontsize=12)
ax.set_title(f'Exceedance Probability: {display_name}', fontsize=14, weight='bold', pad=15)
ax.set_ylim(0, 100)
ax.set_xlim(left=min(sorted_samples) * 0.95)

clean_spines(ax)
add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from
output_path = get_figure_output_path('exceedance-dih_patients_fundable_annually.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Exceedance: {display_name}',
    description=f'Probability of {display_name} exceeding various thresholds'
)

plt.show()
```

*This exceedance probability chart shows the likelihood that Patients Fundable Annually will exceed any given threshold. Higher curves indicate more favorable outcomes with greater certainty.*
