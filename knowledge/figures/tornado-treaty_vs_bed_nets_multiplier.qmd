```{python}
#| echo: false
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Display name for chart title

display_name = "Cost-Effectiveness vs Bed Nets Multiplier"

# Baseline and units

baseline = 706.9077378456999

# Tornado data from sensitivity analysis

drivers = ['TREATY_CAMPAIGN_BUDGET_LOBBYING', 'REGULATORY_DELAY_MEAN_AGE_OF_DEATH', 'TREATY_CAMPAIGN_BUDGET_REFERENDUM', 'BED_NETS_COST_PER_DALY', 'EFFICACY_LAG_YEARS', 'GLOBAL_LIFE_EXPECTANCY_2024', 'GLOBAL_DISEASE_DEATHS_DAILY', 'REGULATORY_DELAY_SUFFERING_PERIOD_YEARS', 'TREATY_CAMPAIGN_BUDGET_RESERVE', 'CHRONIC_DISEASE_DISABILITY_WEIGHT']
impacts_low = [340.36298488867044, 111.03262898100002, 96.39650970623188, -87.3706192843, -86.2082611274999, -74.0217526539999, -35.34538663729984, -25.907613428899822, 21.86312591275373, -15.544568057339916]
impacts_high = [-278.4788058180029, -111.0326289809999, -117.81795630761656, 87.3706192843, 86.20826112750001, 74.02175265400012, 35.34538663730007, 38.861420143350074, -33.66227323074759, 15.54456805734003]

# Convert deltas to absolute values (baseline + delta)

values_low = [baseline + delta for delta in impacts_low]
values_high = [baseline + delta for delta in impacts_high]

# Create tornado chart (horizontal bars showing swing range)

fig, ax = plt.subplots(figsize=(10, max(6, len(drivers) * 0.8)))

y_pos = np.arange(len(drivers))

# Plot low impact (left side)

for i, (low, high) in enumerate(zip(values_low, values_high)):
    left = min(low, high)
    width_low = baseline - left if left < baseline else 0
    width_high = max(low, high) - baseline if max(low, high) > baseline else 0

    # White bar for range below baseline
    if width_low > 0:
        ax.barh(i, width_low, left=left,
                color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=2)

    # Black bar for range above baseline
    if width_high > 0:
        ax.barh(i, width_high, left=baseline,
                color=COLOR_BLACK, edgecolor=COLOR_BLACK, linewidth=2)

# Format axis

ax.set_yticks(y_pos)
# Simplified labels (just parameter names)

ax.set_yticklabels([d.replace('_', ' ').title() for d in drivers], fontsize=11)
ax.set_title(f'Sensitivity Analysis: {display_name}', fontsize=16, weight='bold', pad=20)

# X-axis label with units

units_label = "ratio"
if units_label:
    ax.set_xlabel(f'{display_name} ({units_label})', fontsize=12)
else:
    ax.set_xlabel(f'{display_name}', fontsize=12)

# Add vertical line at baseline

ax.axvline(baseline, color=COLOR_BLACK, linewidth=1, linestyle='--', alpha=0.5)

# Clean spines

clean_spines(ax)

# Add watermark

add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from

output_path = get_figure_output_path('tornado-treaty_vs_bed_nets_multiplier.png')
plt.savefig(output_path, dpi=200, bbox_inches=None, facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Sensitivity: {display_name}',
    description=f'Tornado diagram showing which input parameters have the largest impact on {display_name}'
)

plt.show()
```