```{python}
#| echo: false
#| fig-cap: "Probability of Exceeding Threshold: Drug Cost Increase: Pre-1962 to Current"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Monte Carlo samples
samples = [54.11733485054465, 52.74058128324645, 58.91499458180353, 61.08855387737014, 53.29308466629453, 52.89899901022225, 52.32363335877529, 52.30575650186106, 52.126901878615584, 52.62792234149452, 60.38062695415247, 59.222752943221195, 52.077534969910225, 63.30082851781297, 55.82249785329354, 52.63168411234668, 54.78174975314047, 52.6916761150651, 60.36972362659007, 52.1466569777287, 52.22720842294553, 52.52441091223878, 64.4609255849942, 52.20909012063293, 52.37286208842825, 52.327235106101604, 56.516098241582405, 54.747240278148766, 55.24282555259366, 55.433576387428026, 76.80027478199604, 52.35973609351356, 52.42315841206952, 52.6042862746362, 57.42444565778086, 63.3217138556984, 52.18485967527381, 52.620164630599646, 52.61073031461611, 57.80447369441126, 58.83424822422016, 56.6330201211926, 52.51514720038244, 53.37422805489646, 52.21252875494174, 53.23736961031783, 60.288999769544866, 53.28717465859379, 58.11728391826004, 52.07661260191611, 53.956717281082966, 57.59221538099189, 52.992858922940506, 52.30780794852132, 52.398056587818466, 52.499151535982854, 52.28117122004074, 67.89544764245272, 52.635620828921915, 61.41203027025442, 53.12985839445401, 52.31691179164279, 52.672908966503364, 57.0997336126474, 58.47625753060631, 59.398566644255546, 52.325194955583804, 52.393249316396556, 60.13463819117926, 52.23105711613262, 52.882970315426014, 52.796900312682325, 52.667915554463754, 56.13881589157474, 52.46926636779158, 58.24558393696029, 52.372217970345545, 52.63063384429728, 57.52971544812311, 52.30163063425266, 55.70842747568537, 52.51299442995052, 52.3337720038125, 52.3449581830097, 52.83469148543828, 56.02992695080607, 52.397475010487746, 52.10943685774876, 55.963491323627274, 55.59978212754863, 57.96764805910252, 52.17563070193007, 52.36984906947155, 52.164431047044694, 53.13257183762354, 52.9867712227965, 52.911417259603624, 52.714804543446846, 55.106576799098576, 52.65949790933318, 52.342817434345434, 65.40986210510377, 52.329707483047784, 58.7699438052093, 52.676450334607544, 52.23950188568914, 52.6863358495778, 52.31939422913163, 59.932514698805306, 53.15687990161711, 55.471646557070216, 53.43095545905613, 52.472297968626414, 52.98613201451485, 52.0739019920805, 52.433503566769936, 53.37946535934726, 52.103859098275045, 69.291928833531, 52.25977389370323, 52.730635985633384, 52.839017019127674, 53.25064200610878, 66.16152831642954, 59.873190345109755, 54.65787218189066, 67.48732679478651, 52.83041479246565, 52.49967621228798, 52.672207449486486, 52.34979159188874, 52.94410247247514, 57.634624462635806, 52.24953297348128, 53.00113417769354, 52.725859991705036, 54.20813059288687, 59.90760415611593, 74.70837825341131, 80.0, 55.2604808097588, 52.71015642285895, 53.40354544571997, 53.737044298167724, 52.60378585641946, 52.36509219169669, 52.483071177950194, 52.2008859118492, 62.566141010882085, 52.615680702716624, 52.21154194523731, 52.73796888213084, 53.1248831285769, 52.40760862790084, 52.14895750558591, 71.52098557226627, 52.34790964220822, 61.581501867017195, 52.4153951023474, 52.82810677392076, 52.69543377871419, 52.55103184057875, 76.60765333455083, 52.608868036192916, 59.911744244170265, 52.657960772525755, 60.983968326446025, 54.95113213391006, 52.210349306796786, 52.141191325428686, 52.50870674463199, 55.59491934785982, 52.38883353647937, 52.85268424094887, 52.88433216051882, 52.771719692234285, 68.99299485572534, 52.645197956349286, 52.18765989292399, 53.9228658492805, 65.49434620591063, 53.244409842566874, 52.36243868716004, 63.04858481303744, 55.41177130022149, 68.42558569998036, 52.878894182868976, 52.85199700686305, 52.93893863692229, 69.94396996702596, 70.92023036420733, 52.224016419939105, 52.34582605807006, 67.46342817025156, 52.7810544899282, 52.65302166693018, 57.72449069386838, 52.352663210753775, 52.11993831194909, 52.214413590814445, 54.45725176151596, 66.77323489304287, 52.06290990686592, 57.73122321536782, 53.353553957863454, 52.145936706227126, 52.62201482287789, 52.84857770917766, 52.643039865815645, 52.316456024097754, 60.80212753174921, 52.91365254320082, 52.09862679794054, 52.40632666421916, 52.31259602066222, 61.81687034870817, 56.57866594198084, 65.88737550898661, 52.20907590530697, 52.533431820683525, 52.25051084981405, 53.479456078556765, 52.811814157539956, 52.76737662721618, 52.06296655778455, 53.33423966414322, 80.0, 73.02093501078278, 52.628042394848, 52.28849236302914, 52.996669601149264, 52.47023147739057, 54.2297368391684, 64.25625990913251, 52.553350889367145, 52.50832158292644, 53.41285767400505, 52.21394952503096, 52.75411503424637, 52.43347160953746, 52.64226210802262, 52.173110394673984, 53.17537279131003, 52.99885400789935, 76.61900290324566, 52.89007029339374, 52.77486026907761, 72.46739495870075, 80.0, 52.82002368462847, 52.336882087470286, 54.49858074962118, 70.98826879873839, 52.70853993085215, 52.26331426673367, 59.21762537827282, 55.47526648642347, 52.341616083336376, 52.196725405368525, 52.943018218998574, 52.259067378320026, 52.27593581568072, 53.37431518742032, 52.44900085239609, 55.8653758613182, 61.93428785045722, 52.5994476107944, 54.60462471299362, 52.085205472246855, 52.11683447312599, 52.54882694769398, 54.23892744225996, 52.174915176595086, 76.09402816420926, 68.91761670490618, 54.96051127595875, 52.57377794721775, 52.78429420950549, 64.07638063246603, 53.68625316932071, 55.957058183191954, 53.1673793261268, 60.93593830472138, 55.683433364427366, 52.783098240118704, 52.39874716244665, 53.69615717942422, 52.08561570794219, 52.291356135933405, 52.1786165947222, 52.26731961638007, 52.57071968923646, 67.59272621952354, 53.66970025223034, 52.25827622995065, 52.81120088699323, 54.027449744529655, 52.339076646629614, 53.17476050977542, 54.357934574150356, 70.97004331713383, 53.03937651689565, 60.201738254423056, 52.31310593353466, 52.153456562123914, 52.74837301041789, 52.31665514443802, 65.42003786992018, 57.060932661933506, 71.03717472599139, 63.908934166305876, 55.52096105721236, 71.19469044610216, 55.51997159232864, 59.79197338511069, 52.2939879363213, 52.077228111182926, 52.53432192094322, 61.661875260548314, 52.82409433561225, 59.274220342860325, 52.230666814357804, 63.83389861693954, 58.91968537304765, 72.2430951373128, 58.69449807225811, 53.06254504587857, 52.156814690912874, 52.82028987407164, 52.42677875631022, 68.10650526659953, 57.66080166563956, 52.53522729640696, 52.72473716029261, 52.09734516696424, 52.847215781286025, 52.51852966534081, 54.192592402397, 63.640351074972486, 57.345513505068055, 53.50091182762523, 54.113721860071145, 52.07395913697747, 55.25501409800434, 69.48274358775072, 53.361528883980775, 52.470469403593675, 57.150723717956765, 53.068344484339555, 67.6501611704722, 54.77763497359112, 60.004234084625146, 52.45837087167718, 59.63011585656195, 62.59585184064278, 53.38151824390065, 53.397012095653096, 53.764001428297995, 52.63412414179434, 52.204909325544435, 52.20789156010232, 54.93482899984735, 61.78232216510402, 52.75177472193342, 52.191463130469785, 67.72118665808702, 52.56207092589378, 52.60938758261028, 53.071426814641505, 59.97909684310056, 52.1100735042162, 65.7815209269752, 60.121095719339124, 59.94978494314878, 56.751450835279314, 79.57136201375101, 52.239337037717384, 53.32509102050789, 69.3246240853774, 52.39046114406999, 52.12499014323978, 65.53865517173487, 53.080890551824986, 52.86843056793595, 53.080294540629176, 52.59247171778498, 55.526779767544156, 56.42869935854353, 53.82480127169263, 52.96595757913004, 53.51242698182487, 52.084491573222465, 52.39889774296895, 55.73614792106458, 58.373015654932864, 52.42744512066954, 59.02379449889662, 53.34423187587514, 56.49193045253269, 52.53867852342717, 52.22407149897977, 53.015527504894266, 59.70703625675315, 52.35214583279379, 56.396227413203185, 52.27560770809825, 52.187005526615025, 59.80941895211524, 53.31870986367605, 52.895545687879576, 53.00803345843142, 53.526821515775396, 52.522809691764394, 58.90357440017625, 52.28699750542885, 53.025772661314896, 62.843810535526835, 65.76554674404986, 52.15811816664217, 66.09093974737586, 52.061991740542005, 52.618504425152885, 52.47244826251689, 53.00703366496419, 52.6490508190983, 52.33075665537108, 59.51456385413525, 70.88110357527924, 52.94743067977984, 55.033674689203195, 52.740919026821345, 55.899011933339885, 52.19509165864652, 53.21990270615842, 60.94590833062051, 52.478811244022225, 52.43614717684018, 52.75854330947366, 52.508403771828, 55.40262753925768, 52.229826365983335, 54.36483927193807, 54.71050581624053, 65.67757085516274, 52.321640394003765, 53.004803173357494, 62.580953199080135, 52.314878997487504, 63.14843165908866, 54.93465363838818, 52.19512203636273, 54.57361917947298, 74.06032439595454, 75.85965381881627, 52.075539128681086, 52.6471942193523, 62.68858857525119, 52.62347800503413, 54.41052920347769, 52.13230538921207, 54.21220458247578, 52.616079193862056, 53.07318469856022, 53.36747760731326, 52.78729673386963, 52.39104596357168, 52.29196649529775, 73.86607905420236, 63.04503645437991, 52.69361002609038, 54.5625191379961, 52.360133320779106, 52.286686356161034, 52.89997118791341, 57.45938317890959, 52.31952913005525, 62.54076594126073, 52.80212522730881, 52.1131058438411, 80.0, 53.28193708956932, 67.10147678728792, 52.062352918566724, 57.04051375238201, 52.15074749251078, 52.218573572311875, 52.58365671261891, 55.42808731136414, 52.62701528842288, 57.96985882257239, 62.79675738422441, 54.75858556899648, 52.28781372349086, 55.678607998045464, 52.301227710088575, 61.03017047834038, 53.22020725155777, 52.31734407329171, 53.317338586215875, 53.01584106414349, 66.22049278677564, 60.562552109935694, 52.547578000653736, 53.02035476413849, 55.725879821901025, 52.441902823839314, 80.0, 55.476516033506556, 52.451547768849935, 55.796663244212255, 53.05581903998106, 52.2944380166891, 52.05761429904029, 52.16823959557622, 59.369810094620675, 54.53067799672167, 58.000144132165175, 52.528882839812674, 60.59291765465446, 69.65146909418623, 52.698467487192225, 52.64878691737254, 65.86711645016307, 52.231080812612824, 66.72667310926353, 52.381374518163, 67.38121557126348, 52.35999449618064, 53.64002624622321, 68.80427970284846, 52.33300373571689, 52.68097237461911, 52.38498681319846, 55.66129851594802, 53.05873266470407, 57.66011042773117, 52.43906897647604, 63.54946669225605, 53.56396593958228, 52.587917512949346, 53.13204533480268, 52.61178243331597, 53.53216189610365, 52.223841633325954, 52.268156766360065, 52.211870448777205, 53.08237127310919, 52.72161234243125, 58.427503464697196, 57.93761867655981, 54.952042884264095, 56.77759561617468, 54.031815417059555, 75.2562491332183, 52.16883247624553, 52.30027657335414, 52.568047297183334, 52.73592321172452, 52.86409137782184, 52.64945038550844, 52.15903844315295, 54.423229827478124, 52.08640499329084, 52.575268237527325, 60.620280130201444, 58.79119418894018, 52.21214723379085, 52.507582629879245, 56.68996325604794, 52.92667140122444, 52.98738629660103, 52.157427466636534, 53.67895495637041, 52.65601378871786, 52.945533510217196, 52.99144452720764, 65.8721595533787, 64.77380126628813, 52.26764244526175, 54.726485639224, 53.57356285809418, 52.81082917923239, 52.29231781586122, 52.7599800202538, 58.51159200159976, 74.71643155565536, 52.82307383067346, 52.618543656850186, 53.40767182347776, 69.41533313660335, 52.850730625907914, 53.54614179596347, 72.25208130075048, 53.11095444874528, 52.88622663151534, 52.37003375382809, 52.428163229056324, 59.61690850083757, 53.470925926605624, 53.18585646374665, 56.33439177115199, 52.46232857481419, 65.1016992273677, 52.49237180378412, 52.49779281551096, 56.611195321338414, 59.055222537190254, 55.61640009783895, 53.1315160711914, 56.57779264776269, 52.73715707839867, 53.40591869158675, 52.97260350840379, 55.59756744333016, 52.59996972846954, 52.887173666901525, 58.5051659626358, 53.470771062942816, 52.484199841920464, 67.33158328545099, 52.380246095370076, 52.097747077477095, 53.749354483120776, 52.487615474450806, 55.86109391211665, 52.43587852825217, 52.362864608509135, 66.20510423696956, 52.740944433623156, 53.575314549895744, 69.41296331769557, 80.0, 52.35904986748628, 53.28443062291573, 52.30231113337355, 52.28779830193223, 52.230232334306955, 52.784883857544486, 57.02729800456417, 56.4321354930655, 53.01544371966894, 58.34235650574553, 75.50924545896487, 52.76540881221459, 52.3183720976069, 52.20160981985586, 57.41653813997313, 53.15891763905186, 52.68934945960742, 52.350183310168205, 72.61823616282541, 52.22082262332691, 70.17038840392458, 52.77905912832148, 57.111016719904505, 54.26897223212987, 52.63755726867352, 52.820095069774304, 64.33792705942075, 52.310273464175886, 53.1353848279732, 52.127356042329744, 52.65765714058738, 52.321373935450595, 52.16554662675057, 53.14370610353018, 53.089026715810995, 55.977572319214715, 52.42944081364022, 53.66852516204394, 59.302394707583055, 53.784768122818015, 52.54420878764719, 52.9078649485948, 59.881139446070925, 54.5795965637557, 80.0, 55.3213728952125, 54.97995973475987, 52.21649514702184, 59.6643541981598, 57.52417722692115, 64.82041535095006, 52.42860372716562, 52.377103574954084, 52.40328968947905, 59.36976030824734, 67.93988157514505, 52.391144971840816, 52.37073292598078, 54.21395066415997, 52.263603411514936, 61.22244663371586, 53.47673625251525, 52.61206864716673, 52.58542149538217, 53.51870316289262, 52.69454269296269, 52.66532734574559, 52.23691278089481, 63.12886100440714, 52.26318442087696, 52.735049156631, 52.150849708627355, 62.3660783284129, 52.701969504744895, 52.662567542953646, 56.7994072731988, 52.24912262287106, 57.77024665639482, 52.125021053202694, 58.369790078982135, 52.737621622435064, 52.12408963449033, 52.24264063695243, 52.846811228544794, 53.05734819797906, 58.1930367045549, 52.3265281067937, 52.72990179606799, 52.17425410511694, 63.310209922220785, 53.49445471652534, 53.0167979503958, 52.66998453797437, 67.4600159111819, 53.88959125378857, 59.104656044261866, 52.801051752626734, 52.78859603979759, 55.61337274570161, 52.08215569761983, 56.69332201557216, 52.22888637782332, 53.843980808352185, 52.62641553198574, 59.222475919928826, 59.553400974811325, 53.091585635017296, 53.47397827453448, 61.80494500204308, 64.03465982656674, 52.72890219567982, 53.237517210969706, 52.057877889788365, 60.97542969335131, 71.92644007406527, 56.34391663271142, 52.33895817340139, 52.65206018151469, 52.11005846149526, 52.295599317030145, 52.72555169081572, 75.45272599158481, 71.75632142795087, 63.407161328807504, 52.66875786817345, 60.10076699700484, 57.68379993183424, 55.55756987470854, 64.7949774543895, 57.63704295094047, 58.797934204669396, 57.6539067432311, 54.490645326831334, 53.191118688815045, 52.06705730976878, 52.44951966114781, 52.88548359803093, 70.35689426544796, 70.99229610352022, 66.16194469880776, 53.609211970488694, 66.05366061660344, 52.10969968929465, 53.076393649347985, 52.77285957363483, 55.07736009359094, 52.080897707569925, 52.8992849890433, 52.14741525171984, 52.16443782136305, 71.92598288029252, 60.5513392278294, 52.11006195009575, 53.54360297551861, 52.09053391993501, 52.23799392157641, 52.76619306015367, 52.20701329500853, 52.563580100898704, 52.867625238117846, 56.28944382312466, 55.0172872363726, 53.19300270081069, 52.1900754624261, 61.73380066480651, 62.485635990225155, 62.08934217225375, 52.09369155753619, 52.623107381562875, 52.76696060195704, 54.530258993223384, 54.89177973004913, 65.26173410255531, 62.972828151305265, 52.195773499768414, 52.86393058187889, 52.307470114614524, 53.22258610187506, 52.23749752177239, 52.46254174629442, 53.58542822728808, 52.4181904664593, 52.4926591494211, 54.18684421323876, 52.35708740792591, 53.495842072072925, 53.793319598864, 52.800609688201774, 52.40457126548707, 67.15984270404881, 52.81429187702536, 53.39414378597614, 53.23874111248274, 52.09953356870651, 52.09845648485161, 52.1870465306312, 64.35841755688915, 53.73492337964387, 55.066262650946015, 68.76128928906834, 52.79357487555534, 52.34380174954978, 52.56766506288893, 52.65279221126999, 52.31175163735175, 67.02825629636116, 72.47392927820883, 52.317542673525516, 73.41461806076151, 52.09567992588007, 71.32718174708047, 52.172535139213785, 52.355724198326186, 54.74755752492817, 80.0, 60.05801931352961, 52.54023585153484, 61.42045130363768, 52.333040886453844, 52.40967225238056, 60.717589568518456, 52.09835618136107, 53.84841556405452, 52.10854806045662, 54.446964134123355, 55.37175948234262, 53.284509184324584, 57.98076800804678, 52.705623265862386, 52.9838539024554, 52.15171870563024, 52.0668429429289, 52.531967726317355, 59.82666382854922, 52.92320606922856, 52.36005277089057, 52.46673070541226, 52.144665524008964, 53.85137478258328, 52.72122451120672, 58.62192924608886, 52.07933899840088, 53.257075536814476, 53.29769124407719, 52.12422953762361, 52.248782670581534, 52.17857591581915, 52.13356939838701, 53.30712506019472, 61.17108699904821, 52.78350531873978, 52.82026836462104, 52.772770526148, 53.95463278874249, 64.73674894316088, 52.37466633445681, 53.629835705952274, 53.142697387390996, 52.61587932420633, 52.45044176832155, 52.360918171806574, 52.09388944403706, 52.3030663781916, 62.36805109986297, 52.52145962951453, 52.633505631795465, 55.94354003280714, 53.04045687422062, 55.000798317924556, 52.07210040748835, 52.2048578558017, 69.11385945707956, 52.4891414147433, 75.61887401350222, 52.251450798216716, 52.88377493920593, 52.075218385934534, 52.76246183407524, 52.56698193330118, 55.07780087135395, 56.76730309618498, 52.489117551214036, 61.63627857405002, 63.66698545919897, 67.14096554978838, 56.48491942906487, 66.21502233460313, 53.25028471800335, 52.30675208583247, 52.63632777313772, 52.237808013959025, 52.458674239228074, 52.21603517796848, 73.09514442311438, 52.218162746051156, 55.253982537786534, 52.255537935448785, 52.07176730140444, 52.11329802057397, 55.61878165536613, 63.76168790507422, 69.89688259460583, 54.167922358227166, 57.135920150601976, 52.80751693813287, 52.16929947892823, 61.08534967413311, 60.226301177300044, 53.165601889573935, 60.46117924452308, 56.070453760355136, 64.18836857214735, 53.95918258761185, 52.329368887478175, 54.439267293705186, 55.345192242391654, 54.92950985588459, 63.98134090549384, 53.15453468112525, 55.65530213796038, 55.9291902236972, 52.814502882027064, 52.54314327603279, 66.30482751733986, 52.40624315732275, 78.29683627278749, 52.11802933156099, 55.19340680433831, 69.4915456218263, 52.355417802723366, 52.71787819974053, 52.182340667748505, 52.13811870677371, 52.936869145620975, 52.26962430351096, 52.56123150703934, 60.900174742894, 52.09625475000539, 52.285748491297284, 52.18022436798995, 53.28236634449486, 57.433581398885714, 52.71629119321255, 52.741548686106434, 63.02924999112516, 52.3632830213314, 52.968427287809554, 55.57098650275924, 55.77847972604035, 53.03746775366748, 53.34698010553762, 58.74830509739318, 54.84061465080215, 57.599824409444345, 52.96080988473611, 54.389482531701724, 52.29760635486999, 52.40549983960345, 60.27896882302025, 67.69304567699625, 71.8822570858069, 65.6043468533074, 52.18234468488749, 54.614654175938874, 59.099088110276654, 52.25724402110117, 52.3527946115209, 59.74373779835676, 52.15223854813739, 52.55347298222898, 52.364562565118504, 57.62100076550654, 52.11510034302957, 54.484608092004, 58.01952534490671, 52.34082899657889, 58.98011370280771, 54.88720420887028, 52.85825104157552, 67.21781641429317, 52.41626397621193, 53.11298132009326, 52.74363378775086, 52.72915681411513, 52.085790563305636, 52.28039871471844, 52.3180769403121, 57.4651961132969, 54.481133945238554, 54.23431373565553, 55.21226105299077, 57.426144542637374, 53.388829696095364, 52.3346007684618, 53.432975610341124, 52.095391831843266, 52.119646837701936, 62.322816817526075, 64.03355304192462, 53.076168818769084, 52.416033937358506, 56.010589743830835, 52.43255888036066, 52.11771503048468, 61.621377122231735, 52.45046724226641, 59.5383130887318, 58.100538644604654, 52.68921052579288, 61.47778656701262, 58.335348304609745, 52.06587606049708, 52.57333668288229, 52.63163206892812, 52.438403910735296, 56.626978893077286, 52.68971279170556, 55.504305576884526, 52.862448869715415, 52.23868384857461, 52.14254809315425, 80.0, 52.94448371623645, 67.59945796184809, 52.54347650723159, 55.226398076611055, 52.22906906557246, 55.58066762542756, 52.208585850613574, 67.36843545161837, 52.38972505343311, 63.36109158946196, 52.50244811151532, 52.152816739098675, 52.75987713992963, 55.68983639114636, 67.25396336293873, 52.163021639540965, 52.23439188818522, 52.78562588333931, 52.253758677511726, 53.07514369232634, 52.66395494852861, 53.319582865695146, 65.65694231030913, 80.0, 52.46775755768577, 67.12815162086432, 53.49225469348498, 52.20713020615771, 55.45231367904136, 52.07998589403364, 52.149980849191934, 52.360884951470894, 52.95707856221339, 53.04530063616996, 57.833695177002966, 52.28210287279708, 52.473461779793055, 52.11181434050273, 59.41651057442044, 52.84997658897691, 52.50946790491768, 64.50702677932705, 68.99423398423812, 56.11096409810341, 61.475084838826746, 64.6999055261638, 63.33531496200811, 57.40387370818161, 57.23181735481919, 56.38003724680381, 52.775193561545684, 58.359329737604206, 52.931463381307935, 52.59275035743889, 65.4639413962167, 59.93150994684847, 67.79792267781433, 52.279097349905555, 52.808353160606, 52.26042045104344, 52.06692193772069, 52.06981635808266, 63.37855240852023, 52.3327043904922, 54.607518234147456, 52.7096071618572, 55.63991164853807, 52.115031632950426, 52.56581390399684, 52.257665964049735, 52.22679822635974, 52.278188824329106, 71.56749490634627, 52.17560713780428, 52.26248822711696, 53.38241620380159, 52.65270867763007, 52.27395411964132, 52.52736890591954, 66.44607162870359, 52.21530644780523, 65.2755791823633, 52.08011210045582, 52.09469586586856, 52.16984832219404, 52.114621670961775, 70.85443376357051, 53.5182469066254, 53.32388538413366, 52.441708058641346, 52.10822460248765, 58.24135595118355, 55.881865423647916, 52.346459921290176, 62.00901748185011, 62.14093417419229, 52.88719204196102, 61.34628575480863, 53.787592008155414, 52.45269419789093, 58.327016904266806, 52.15214137034659, 52.116086031451985, 67.61155536609049, 53.59866381308768, 52.96893750328626, 52.829391914822494, 52.333895802932446, 52.2688925325104, 53.02327946493924, 52.7075155432929, 52.63261681959198, 80.0, 71.98330973879493, 52.36293115150981, 52.33408895000226, 52.8065139033286, 53.26693583478061, 52.18661035242853, 52.71516945158848, 52.167493598375664, 53.07964359683756, 52.57312680237153, 52.53130902884237, 54.75522757746411, 55.29274070830194, 52.91007930317236, 60.09694644121697, 52.59612679353982, 57.609445337684306, 52.12322749450248, 52.943921605399176, 52.30572964472539, 54.746402291807726, 57.39147229026872, 52.201003550832525, 68.37374599555257, 61.87288587921251, 52.27011581017013, 58.911296673229124, 73.81770529991111, 74.19412654064728, 52.854131681510744, 52.67218164386209, 67.76589537898816, 52.751620831359936, 52.91132134090955, 52.407540419770136, 55.321774671139686, 52.17796508574656, 52.506169660812574, 52.52037531735908, 52.543284532552086, 52.643857182373495, 78.87658657810185, 54.0430714358928, 60.465385922875235, 52.40926895713085, 52.22786219101687, 52.54401594701843, 53.72193946008871, 52.94490379162874, 53.207553842372675, 53.47551681007839, 52.83440098383862, 65.73133603830392, 52.14338246084199, 65.30194956447352, 55.224405450997466, 59.276575325115154, 52.6567379132087, 56.42615208063077, 58.67145620893217, 52.46179352354965, 56.81013927177893, 56.882149448322686, 52.44553646084189, 52.79054802578355, 52.82761401502202, 52.065339387809566, 54.34772585333055, 52.591502878433495, 52.1010381510113, 56.929313923426314, 57.44864905484403, 68.63615936407174, 65.13313902417258, 52.71724348358307, 70.38062408833089, 52.43439352366779, 62.314985196285285, 52.07636982244125, 52.363170717246135, 53.20577555523864, 52.21926463424, 53.05486311352317, 61.400572761432926, 68.17875984236062, 52.59414099612035, 54.089019723163176, 52.551131301025634, 52.492910528626545, 59.18555289523871, 52.139864712646826, 71.13655870025863, 52.405165534557774, 61.776577964484446, 52.05884341846085, 59.42608757576167, 52.384143981038854, 52.14643801969818, 52.18578578102732, 52.617697224317844, 57.9311663674494, 57.800686892701236, 57.17957414395166, 68.44136088584803, 67.30805471852788, 52.34089080054122, 54.82667383410084, 52.48997794655758, 52.10296320394074, 52.47565901956314, 69.53388073722041, 54.72902840008394, 52.24702664406318, 64.10661675380332, 53.427111566074984, 53.33154515997587, 59.42677435941249, 52.080848546851506, 53.56053317308276, 52.91365459239476, 52.13073756994611, 74.80494476235168, 59.74882129420658, 52.74275137068269, 52.379288324372496, 52.35264388513751, 53.40180546248397, 53.63401200332339, 59.991647231121114, 53.06471749545789, 52.51268865122554, 52.81150394089167, 52.695575089037355, 52.08501107711646, 53.37444876309968, 57.40574718911108, 58.95322262690667, 52.266796601177326, 53.61695983154109, 52.714305142949044, 64.58832045621622, 53.799600426074214, 52.324475718854075, 52.8251198464068, 59.525739343798094, 52.52091691097723, 55.15048778426336, 56.87426584229036, 72.45789880125444, 52.23801062820011, 54.857943744099245, 53.00977376372638, 64.06747490568577, 52.57224542677791, 52.45225688319182, 52.13014965608654, 53.056987932897194, 53.339745563691835, 61.4025272544529, 53.995952341362226, 53.07277798869243, 52.190746880623635, 58.8205124680792, 53.24857331851859, 52.76156909062143, 60.347792349672325, 53.7614625993784, 55.234814533615925, 72.77990778527015, 55.83359880620925, 57.8848899429672, 80.0, 52.24450190812923, 52.59472563482289, 55.401634669484174, 55.51994906353323, 52.43183781680503, 52.73600425623682, 79.30177830157722, 54.34600253489555, 52.55527553224157, 60.802449179178666, 52.18199309048383, 52.26786014163246, 56.83972901540317, 52.89276847985871, 54.61368670219272, 73.52514825754392, 55.80833352609758, 52.341649631599715, 52.42007777683646, 52.36208694102656, 52.26850659700728, 52.3426042700159, 60.80686551302524, 53.16046065513516, 60.18077094259252, 52.343729907247024, 54.86738884531131, 52.79309607453846, 65.77739027432872, 64.74523186433689, 61.31044116198363, 53.02778561077988, 59.804883230517675, 55.15995856049921, 53.08271924409376, 52.13137185865025, 54.73775161212426, 56.77263854031245, 52.81873876647169, 53.978437913221406, 67.62003148727747, 64.50384247437977, 54.63936650375135, 52.30647207228386, 52.21513517845293, 53.17194847932542, 52.060767108590554, 64.78377302483405, 52.76869235913264, 54.445073847803236, 52.66572938635684, 52.51899329518595, 67.66878692802179, 52.44134033132129, 55.766179502094886, 53.24444945883952, 72.81906783221159, 57.27879281376569, 52.22579702667422, 56.9836861690561, 52.964172441615254, 63.97130591864421, 52.31038899220139, 52.23868440466075, 52.41081458350121, 52.46419645564223, 58.29205689184428, 53.616296559701176, 57.8172018674004, 52.1221280660599, 56.31066533056042, 52.367183619764965, 78.10030352568884, 53.060050536948516, 64.9343101124277, 66.27156021059362, 52.62738949841178, 78.09348390873456, 61.73131724302673, 61.44551746702622, 52.10018183255773, 52.246546754608985, 52.24187501049324, 55.009591602660926, 66.69317407891054, 52.85954798410732, 52.66309087336894, 59.75141101198609, 60.862967443131, 57.84928814888855, 58.85942094360951, 52.27865108268538, 52.673661460924095, 52.63704317663265, 53.10105515217657, 53.42294288758091, 52.16665713114409, 52.379847818525214, 55.625671683635964, 52.86581220233563, 63.2236664017581, 52.51461634874584, 54.69663931872072, 52.9525813917697, 67.17172750050499, 52.20281868375586, 53.966188025467396, 79.54296122083556, 68.17417942354669, 52.29996691924137, 52.47173990199904, 52.31132260003801, 56.275248028468866, 52.179652679941164, 52.35304589328455, 67.53722359319113, 52.18501633156417, 79.14695008259976, 52.0628160160193, 71.75837248058482, 54.662542467906704, 61.34982806368396, 52.55066214318285, 52.62835295293329, 55.739548796833546, 61.64976523854446, 52.09289110498966, 52.88944760149093, 52.934154420168646, 52.974664955531566, 53.18139113750385, 52.14093447631478, 63.27432846075182, 52.124883316663016, 53.482020158703364, 52.23073217807746, 52.21402900711809, 76.13508294627876, 52.99284806816232, 52.35031125135449, 70.67989749249736, 55.63631802239799, 56.850997213047144, 52.1916245991305, 54.378117617654574, 59.220694399788435, 52.60170706589337, 60.365217293625676, 52.9418719431799, 54.36179321043214, 52.833633556875476, 52.485590463705634, 52.13041053026671, 52.4893411777566, 52.759719487401576, 52.328121700393666, 52.77920881632544, 54.30411655907464, 52.80704637054153, 58.48462068941848, 52.8260131231077, 52.45558140339953, 52.49058000752112, 65.73372917854475, 54.381707390820516, 52.243264404032765, 56.15549340686136, 53.38836495362561, 52.142605530492474, 74.71953054313002, 52.36858312148983, 52.07641358026709, 56.68672737743381, 60.567402569590705, 53.32139736789446, 53.12952821408937, 53.152245809757545, 52.54481088094948, 65.56956829304409, 52.30511738132837, 53.28302431004786, 52.87832932417295, 53.78217603314023, 52.25664748266001, 52.22931243458797, 52.37054660756532, 62.72012115391167, 64.1665207422081, 52.218562128963015, 53.4051626929626, 57.43869701566411, 56.76490310160264, 54.165563601471995, 61.566720028704175, 52.815952418097645, 74.8797643967231, 52.69200469692939, 58.90120629646691, 53.13257989700417, 52.674430000717436, 68.17325113161435, 52.27265442229505, 59.92811169320219, 53.42301188273246, 52.17949392435679, 66.22034255601163, 52.25816179219539, 53.18937064093126, 52.59794882645907, 56.71982879056456, 55.061805454450166, 53.059521181844204, 52.55050072364064, 52.46483856661372, 52.33521818247278, 52.94363459766408, 52.49284230336172, 52.55306633434162, 59.1521611896561, 59.57738606580538, 52.20388327500222, 52.35112697630282, 52.4442611467718, 52.6059725844138, 52.805081177486805, 52.680429494138274, 52.496710628223376, 52.815134221018766, 52.665948301230955, 58.68265406833784, 53.07168568235103, 52.10190627476759, 52.248166168296606, 54.498094031506845, 52.124598895578075, 52.990703072808685, 52.87492728626684, 52.09934665909113, 62.12418632666783, 53.45374697693972, 54.5419161578834, 64.05781151601231, 52.208192156970064, 56.70913739682191, 52.537714447687186, 52.18809441085541, 53.09221816321801, 53.53339001841251, 61.11418275604373, 52.707417205450135, 52.38915975782067, 52.95001129143871, 52.964263485161794, 52.22062249261211, 52.553647471347055, 54.878088364949065, 55.66346736712473, 54.28396343536072, 53.439765570932074, 68.9756020804229, 52.75724059130942, 52.14964489401286, 63.3665886656288, 64.97890319357079, 52.97140933260317, 52.30343080251025, 66.14808347290179, 56.255742804442356, 53.000243400079725, 52.24682079450115, 52.34619347108068, 53.94746061537002, 52.26755682309862, 52.14227451972452, 52.070048656029186, 52.52269379046218, 56.51416171035781, 80.0, 53.187088201982895, 54.31669198450581, 52.57205373602236, 57.003844891797456, 52.08913660008476, 59.04316294979217, 63.88573401389726, 52.971547949340106, 63.35889066573611, 53.53336220829784, 69.14252723674933, 54.84767662631646, 62.70774365510282, 52.84922013445195, 52.61451500918634, 52.50439941011811, 52.12704303532485, 53.89453729558133, 62.78752154351434, 53.17993006252492, 61.47690725031471, 52.111947698063695, 52.23851251720562, 53.00132147963108, 56.201840626798855, 53.57612811346991, 57.780258193023265, 53.01404906667201, 52.08502520586666, 52.187976591474346, 63.813113573697656, 52.22350025740306, 52.532347738141844, 52.419776415295026, 65.08229346689949, 56.55906283224951, 52.34728868503961, 52.25803482250483, 53.05959331084339, 54.98803889387693, 53.17664244816912, 58.93010000413118, 52.331423196555036, 80.0, 52.77688263331504, 52.178123482252836, 71.93594183766733, 64.07939292187467, 52.53359373331383, 53.290951096346156, 52.11569286751197, 53.883110440171286, 52.535077065427046, 52.17016100011644, 53.07833608810735, 52.39630323379839, 55.63676684176254, 52.252639010511686, 53.08865782719768, 61.64951406592583, 54.73765302775099, 52.55150614899233, 52.28443552199121, 53.01924243739417, 52.731789657380574, 52.438493147941735, 64.53318928509628, 52.49952719439862, 57.69025562614077, 52.43879597994962, 53.53503527640855, 52.20124694009232, 60.3077046220052, 52.436693665774065, 53.06284124682646, 52.947289874230705, 52.43493393011923, 52.86686594516361, 55.2162968075068, 52.39529685151979, 80.0, 53.16320049074244, 53.08484902988071, 52.79367890225256, 52.41186119028112, 52.45920593568639, 53.52177361783786, 53.421695842547294, 73.3845067737908, 52.3879075665446, 53.65616936929718, 62.07851504468324, 52.21471856011546, 52.46438176760487, 53.49139434670219, 57.69879903328781, 52.1843946365447, 52.724113840345645, 52.31123393578637, 52.46601425354654, 52.432863859639646, 57.318524203084095, 52.920910058661775, 62.34399637315234, 52.95682202206602, 52.513460246115024, 73.6652737234647, 63.30219832993042, 52.058729929747216, 52.68061570291971, 52.43337137423169, 52.07321947887217, 52.0945198387317, 52.171086311070056, 52.135269052433884, 52.24484288059619, 52.98365971663707, 52.42571783401628, 60.78731584399746, 52.93904466965891, 52.23001227492504, 52.60788548072354, 52.15946949419741, 52.349087010131655, 67.6687873252558, 56.239707979359906, 52.90482264248674, 58.03222805732935, 52.580751239428615, 52.462003007263924, 54.21128316167646, 52.41086962227171, 60.53567701172844, 52.58066595515702, 52.4871835610226, 52.50965768412067, 52.455187683856444, 62.963371422393024, 57.56487284501556, 70.73502465315744, 78.66660180580226, 52.73499083151963, 52.074920816721544, 52.822823434510596, 52.58252803510099, 52.493869938089475, 52.75094128058677, 52.747762852548384, 52.202971980899456, 52.847311456786, 59.95329107416615, 52.666892135685586, 80.0, 52.386676797719986, 52.073968626724486, 52.89486127779405, 70.68311772000133, 63.207524251198244, 54.03694199955896, 52.92600747096613, 53.156050236179134, 52.789740433675604, 67.47514075265262, 59.578219643071364, 52.06001915850165, 53.589776664562265, 52.70646524633554, 58.21535417390253, 64.34240052633038, 63.08321023002773, 53.07466937849515, 54.08470689229922, 61.967336494004925, 53.11494995830442, 52.121597331644175, 53.79986404409436, 52.29649655578743, 53.232844407799874, 52.311414211440734, 52.31237601241748, 52.20523401920369, 52.453887247656795, 52.38165999434656, 52.1405613481925, 55.55660623531268, 52.298687359687214, 52.361673032943074, 52.06185632937038, 53.27472677698994, 55.92392312399638, 52.117220480151865, 52.093226573408955, 61.32380609741489, 53.294169994108515, 53.30698481921637, 53.79946878717127, 52.12112772195498, 52.74747950333791, 52.39311463921574, 57.956255359525954, 60.99635599761457, 55.998008886486275, 52.272611750633445, 53.38866849773362, 59.12627380149472, 64.45094352114404, 57.73804036482061, 52.64393715184869, 58.060616309301814, 60.163910953282986, 68.726941207883, 52.64180997054762, 52.25206232619744, 58.8793128044959, 52.08267059137141, 52.787262611108694, 55.26265914297564, 57.01752354359352, 52.06447144196993, 53.24646379407984, 52.27134260752942, 67.6802040894759, 52.65661454867048, 52.46819909181691, 52.110336102869475, 60.375518936075515, 53.01724337865726, 52.90391101207044, 53.34596013231133, 52.09739693433514, 52.78785328574253, 52.34664206977277, 57.9234022289265, 52.50075189605756, 53.365285237799455, 52.295643107712245, 58.042030408816004, 55.903603066115615, 52.53102283022776, 52.21752479105464, 62.30157481566575, 55.03943682345415, 52.95638338609315, 57.85985599602121, 52.767510958267394, 66.83728573597084, 62.06878148780303, 53.96459484013973, 52.617528411264416, 52.241649977048226, 58.11296909471178, 52.33839628258578, 53.40890844036934, 60.29480872629127, 52.45288830780959, 52.48553021720963, 52.83380055472103, 52.75535714328334, 53.21837439099948, 58.683919030143116, 72.0817667876102, 67.00071858329329, 53.095358658332565, 58.62831948683074, 66.95958528435487, 52.38992811116378, 52.06112907465208, 53.32775715257975, 53.727057850565444, 52.754806176547525, 53.044418698432786, 53.05596746863423, 56.629825235116726, 62.07367657093057, 52.58588077211721, 52.79909588692812, 53.418194262259455, 52.27595138942488, 52.46476210020834, 53.04978746410246, 55.66856276813192, 52.38582943309047, 52.76215448629182, 52.44854799946687, 62.62965432675111, 57.281898273476905, 52.194458435780916, 57.45865942355192, 52.813586520362726, 52.097590687554074, 52.51824917358571, 52.397735237219386, 55.482585290325744, 52.58422877379576, 56.274416483341945, 56.727039170147016, 55.195199391503174, 64.06615806091673, 56.669259050346646, 52.48544393485576, 62.083558847392034, 52.30638122879183, 52.99833308580361, 52.773019961279516, 62.1019907489374, 53.27508547481793, 63.32194081266429, 52.14974465384211, 52.832609892218706, 52.46567499866034, 52.72685229545504, 60.22924581441663, 58.71299125727421, 53.15191884811934, 52.358045388015114, 52.634028049453704, 65.33862312636631, 52.92800329340386, 69.32429042299243, 52.13673746438566, 52.81420421330571, 52.522214748708464, 52.596973393446305, 52.88232431201912, 52.06038371635857, 52.854080696341065, 53.4330710476321, 52.3437238872177, 53.20282954672391, 52.56722547490051, 52.66168082160587, 52.638863162351704, 74.76865551924374, 52.08326546951612, 53.508756069148845, 53.18673025583359, 52.5082114828183, 53.20302954857303, 52.7312581191587, 60.711358922975066, 52.83883576400396, 52.28788394332167, 52.4674374004902, 52.688646176375656, 52.50011973342119, 52.27863044957985, 52.25784573077164, 52.55653943682851, 56.00987201050756, 53.437602428776266, 52.169739411580686, 52.374138462003486, 59.434763011157244, 52.257668882135576, 52.30004568900153, 52.09330884500183, 70.55520318962056, 52.92210491856464, 59.13326770041763, 53.25782175557745, 53.2230117105387, 68.94031371080672, 56.04803906587984, 52.75198426016053, 52.452074068321515, 52.09837905808611, 52.26737069742738, 52.58756310340154, 52.28998305173798, 53.031745745793685, 52.576279677439864, 52.599778944939374, 52.93414538075597, 55.01162982295507, 56.65643326089492, 53.36913374393709, 61.375669886526204, 52.064528174378744, 55.02511201855783, 54.10826387838406, 52.17148561014904, 52.434300750506125, 77.86877955333968]
thresholds = [52.1916245991305, 52.97193346601783, 65.18590831646932]
display_name = "Drug Cost Increase: Pre-1962 to Current"
units = "ratio"

# Calculate exceedance probabilities (1 - CDF)
sorted_samples = np.sort(samples)
exceedance = 1 - np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

# Create figure
fig, ax = plt.subplots(figsize=(10, 6))

# Plot exceedance curve
ax.plot(sorted_samples, exceedance * 100, color=COLOR_BLACK, linewidth=2.5)
ax.fill_between(sorted_samples, 0, exceedance * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)
ax.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Annotate thresholds
for thresh in thresholds:
    exceed_pct = (np.array(samples) >= thresh).sum() / len(samples) * 100
    ax.axvline(thresh, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
    ax.axhline(exceed_pct, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.3)
    
    # Add label with formatted threshold value (use format_parameter_value for full units)
    ax.annotate(f'{exceed_pct:.0f}% chance\nâ‰¥ {format_parameter_value(thresh, units)}',
                xy=(thresh, exceed_pct), xytext=(thresh * 1.05, exceed_pct + 5),
                fontsize=10, ha='left', weight='bold',
                bbox=dict(boxstyle='round,pad=0.3', facecolor=COLOR_WHITE, edgecolor=COLOR_BLACK, alpha=0.9))

ax.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=12)
ax.set_ylabel('Probability of Exceeding Value (%)', fontsize=12)
ax.set_title(f'Exceedance Probability: {display_name}', fontsize=14, weight='bold', pad=15)
ax.set_ylim(0, 100)
ax.set_xlim(left=min(sorted_samples) * 0.95)

clean_spines(ax)
add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from
output_path = get_figure_output_path('exceedance-drug_cost_increase_pre1962_to_current_multiplier.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Exceedance: {display_name}',
    description=f'Probability of {display_name} exceeding various thresholds'
)

plt.show()
```

*This exceedance probability chart shows the likelihood that Drug Cost Increase: Pre-1962 to Current will exceed any given threshold. Higher curves indicate more favorable outcomes with greater certainty.*
