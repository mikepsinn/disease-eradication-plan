```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Annual QALYs Gained from Peace Dividend (10,000 simulations)"

import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Simulation results

samples = [93750.79994896903, 58436.61692426154, 107909.17494213254, 114368.36144234015, 40017.6631489184, 52686.61773443069, 88496.16523058791, 76154.41296585224, 84345.41410196533, 62746.00141278338, 112261.75594443885, 108822.1441401917, 86706.56698847777, 120968.43813539963, 98766.34466226274, 62599.05761094361, 95702.82107215839, 60284.26935929866, 112229.33169033923, 83412.94320620416, 79682.79248869214, 66874.24745985436, 124439.26939246079, 80511.82807243578, 73222.99736859032, 75207.93048776229, 100811.86583348892, 95601.3611616961, 97059.1643839326, 97620.7010790859, 158473.16026331554, 73790.4692418035, 71074.82927474353, 63674.18356184512, 103495.22281356815, 121030.8655942637, 81629.54825785142, 63049.71122263888, 63420.28730928862, 104619.35210777019, 107669.72941703066, 101156.98121655648, 67251.79746369901, 91571.13946805889, 88171.43740968204, 91170.12709313778, 111989.29572216827, 91316.04694908981, 105545.29524652414, 86751.10700799632, 93279.35977466375, 103991.3817949931, 49443.333067864456, 76063.67645575698, 72141.74858035952, 67906.89255457507, 77247.39816053613, 134751.68600883835, 62445.50850099851, 115331.83475327383, 44920.0054268934, 75661.86838204227, 89517.58255037786, 102535.40855298736, 106608.59501259826, 109343.93906190066, 75297.49785820434, 72347.25125673682, 111530.39401740141, 79507.42703439345, 53252.43683288808, 56351.798025874145, 61194.65296742698, 99698.8330770356, 88921.94563562288, 105925.2404126796, 73250.77768450433, 89393.90697532291, 103806.52591411426, 76337.118236763, 98430.22762370083, 67339.72839886179, 74921.41674581716, 74432.78658603554, 54978.1721175834, 99377.76277944379, 72166.5898583026, 85175.66490583793, 99181.90733099062, 98110.17335212677, 105102.28896339763, 82057.99827355104, 73353.00563385362, 82579.96894330264, 44834.395430634606, 49650.108606837355, 52250.66982049611, 59406.10870844593, 96658.21720716932, 61519.18634648437, 74526.13580994598, 127283.13466148956, 75099.48120198282, 107479.06765069668, 60866.68031819412, 79123.54511638255, 60488.15272987731, 75552.54630068416, 110929.69898458132, 44071.650413548334, 97732.8011540789, 91737.39621849798, 69015.77804938122, 49671.84855710567, 86882.0897085021, 70638.10742222876, 91586.4880266115, 85441.98760898637, 138959.55674605205, 78207.06756461441, 58809.52411207636, 90003.6543064955, 91209.01113245814, 129538.77345442245, 110753.43454222869, 95338.65038222609, 133523.50813826075, 55132.61064868831, 67885.34062197107, 61029.58965907096, 74222.30318379731, 51113.27164566013, 104116.82835685235, 78669.16097067083, 49163.0419102446, 58989.11525817318, 94017.37860700315, 110855.68243854216, 155079.70378157584, 175608.60812070264, 97111.12840595348, 59581.9619706684, 37641.89256540157, 92634.86726017729, 63693.92656396253, 73558.56558894082, 68569.53460833956, 80889.11951566733, 118773.80197001564, 89350.16473338378, 80399.30413105355, 58534.43196664232, 45079.2280127167, 71734.53911759058, 83304.8111788494, 145692.70771557672, 88567.12999131558, 115836.82576906847, 71403.70023849997, 55216.063732062976, 60141.05967722332, 65796.75975712111, 158180.74336273628, 63493.59650994592, 110867.98361930027, 61578.56315389049, 114056.97265784856, 96200.92956627425, 80454.02585818512, 83670.22717366037, 67515.07826916986, 98095.85004395434, 72536.35283788484, 54331.227943830876, 53204.22584213542, 89806.70254448966, 138058.1211281768, 89436.51273644812, 81499.8481458535, 93180.0224460313, 127536.52923698869, 91190.75265540469, 73673.39514725292, 120214.63859170262, 97556.49881345493, 136348.12554463372, 90120.3736812577, 54355.85498407333, 51292.00335132113, 140927.06390071893, 143876.10212653756, 79828.43184146324, 74394.96395829563, 133451.61125665403, 56933.78235511887, 61769.59084423424, 104382.68927778212, 74097.4356872435, 84675.78454704193, 80267.64698475829, 94749.09073971021, 131376.30805959323, 87414.64107110655, 104402.60876101731, 38716.49117396783, 83446.81775337852, 62977.194632314255, 54478.483406752355, 62156.767745814264, 75681.95086752286, 113515.70651210134, 52172.42290480784, 85692.33116955377, 71789.10328923995, 75852.17491999609, 116538.42560952075, 100996.53478526723, 128715.78157675795, 80512.48077761472, 66507.88555476972, 78624.95874273017, 91879.55966918758, 89924.03876482815, 57439.027041168556, 87411.89068854436, 91453.95493159346, 166812.7488928777, 150234.41641170264, 62741.308541357364, 76920.84616756726, 49314.14905030753, 69101.58700599836, 94080.82332995681, 123826.46727618697, 65703.41814604744, 67530.84407983074, 37441.83148468015, 80288.91334897776, 57931.46067859721, 70639.45382885715, 62186.99840029212, 82175.26498131288, 43495.998278347804, 49240.1831460102, 158197.99341590793, 53001.36930080845, 57162.2577729277, 148557.35560809402, 175413.44048544462, 55508.92179268562, 74785.35292349875, 94870.5214954071, 144081.77049481022, 59643.19323502343, 78047.73875856826, 108806.92873893534, 97743.46075777902, 74578.5553527001, 81080.90361662408, 51150.77020451384, 78238.88900416874, 77481.4799745686, 91571.39481896596, 69987.1279929601, 98892.7094594899, 116888.53825124654, 89302.68008591192, 95182.14680443467, 86336.77391514568, 84823.32212847563, 65885.58401072632, 94107.81163389391, 82091.27928644793, 157381.98525366143, 137830.8769333993, 96228.51665686487, 64884.82517848639, 56814.50296039224, 123288.0459639356, 92485.89975552239, 99162.94360813279, 43744.33300743514, 113913.98958801286, 98356.59169711037, 56858.51848333644, 72112.25883561771, 92514.94626075837, 86317.02700053372, 76793.35944996137, 81919.21449568622, 77867.74453607075, 89218.65050601952, 133840.62257966568, 31937.60796277672, 78274.53252547649, 89922.24394579863, 93486.95006635707, 74689.4401967166, 43514.99392634206, 94457.32882819678, 144026.67624215764, 47879.442830839944, 111729.8598173828, 75829.67360316025, 83093.61570308183, 58145.46196133849, 75673.17659643413, 127313.65325013058, 102420.75993196495, 144229.6158726739, 122786.97964789046, 97878.02480720684, 144705.8586060764, 97875.11083030856, 110512.15446787531, 76676.32269900663, 86721.38308174755, 66471.80529863006, 116076.37485509677, 55361.323276863804, 108974.87539688569, 79525.19935006023, 122562.48768571377, 107923.08617913972, 147878.12256437418, 107255.40237866109, 47111.080159291356, 82936.21414530581, 55499.26284557982, 70921.79854067699, 135387.11379194102, 104194.26620474114, 66435.11855326465, 59031.3852145826, 85753.72803099036, 54527.372493271, 67113.78623772149, 93971.75411509485, 121983.55743965405, 103261.8490101382, 35551.82519964994, 93740.19327161298, 86879.32694308397, 97095.03823190193, 139535.15203359982, 38544.99761693775, 69091.70388630789, 102686.08751107371, 46919.83486837024, 134013.44699827937, 95690.72296089075, 111142.81752962484, 69595.40793156675, 110031.41613515666, 118862.50053720266, 91592.50430702975, 91637.91226883008, 92713.9382131032, 62503.85831149359, 80703.9447363641, 80566.87315522315, 96152.97815404538, 116435.42431596291, 58018.625011424985, 81323.91238981234, 134227.18574860724, 65353.18294412963, 63473.13909354876, 90684.07021528545, 111068.1174422927, 85145.30279924204, 128398.10367898077, 111490.13982705105, 110981.01597365977, 101506.63657932024, 162600.62229667962, 79131.0269063098, 39328.769916627, 139058.1717585195, 72466.61478253704, 87915.64979514152, 127669.43907143168, 46507.592042856646, 53768.757275404176, 46527.130187464165, 64141.32259565586, 97895.16105344072, 100553.94829896104, 92892.29532863476, 50360.79085444246, 35304.89239419655, 86371.14519180064, 72105.82960419745, 98511.90036855359, 106302.70969265813, 88799.65910423898, 108231.86962320813, 91483.23570087929, 100740.5409769207, 66295.38860191635, 79825.91727981874, 90520.38132568823, 110259.86171638168, 74119.92283835335, 100458.1344579589, 77496.16572668687, 81530.14457388344, 110563.97882582298, 39466.0826299142, 52808.22315374363, 48930.047933149675, 34996.288426991, 66939.41022291561, 107875.30722697773, 76987.4483785308, 90550.38037040342, 119602.92936476531, 128350.1683643039, 82875.17224120902, 129326.83769586952, 87459.2260107893, 63114.82557410505, 69009.53990821102, 48963.77282590067, 61923.43432174808, 75053.49096075358, 109688.3009063084, 143757.83690457695, 50998.26562861287, 96443.73378052491, 58423.978159305116, 98991.8457571423, 81156.29677997754, 42126.08559366422, 113943.66886190302, 68745.76678355032, 70526.78536800492, 57766.746920857455, 67527.47964815816, 97529.57710526114, 79563.47801234975, 94477.61046274041, 95493.3683376526, 128086.19139595133, 75453.71883039405, 49039.05894838315, 118818.02164514699, 75751.46646367716, 120512.98083328844, 96152.4623836158, 81154.89449780554, 95091.0248526306, 153386.51962048077, 157005.28721309864, 86802.96343808148, 89442.35271016158, 119139.38510380322, 62919.88322953685, 94611.82665919224, 84089.66118063725, 94029.34125513733, 63210.01980617107, 46760.5535293772, 38417.09240261429, 56704.09036123923, 72441.56767762161, 76766.20612441626, 152797.14171307976, 120204.03701659576, 60210.539367260404, 95058.40457577359, 73773.25407911059, 77001.31618547515, 90182.07007013506, 103598.53241562349, 75546.60848567785, 118698.05090705187, 56160.680992669404, 85000.78960608627, 168592.3799931615, 91300.7009938429, 132363.01830810966, 87441.685823173, 102360.43005438754, 83220.74185025366, 80077.17933117837, 64491.25150722512, 97604.53891307286, 62781.465044531775, 105108.83310393107, 119462.40021860423, 95634.71612089871, 76951.07769564715, 98342.3759967348, 76354.97635953121, 114194.52587917518, 42116.79498031085, 75642.82399652676, 39495.59256399753, 48667.135544623416, 129715.82623794113, 112802.85938426523, 65935.93142432832, 48515.50727031886, 26715.55900332833, 70284.8067198026, 164659.00912176986, 97747.14031794798, 69880.51270586549, 98690.21373843556, 47333.424789890734, 76656.31933491703, 87672.00338916763, 82402.21727314545, 109258.580977346, 94964.83590267034, 105198.4843752557, 66692.47203451084, 112893.19369353064, 140044.23946508855, 60025.59275005315, 61933.66709717659, 128654.97858296648, 79506.34810518021, 131236.3799295387, 72856.50715252264, 133204.3010119899, 88602.45819414967, 92350.33427447708, 137489.24202954202, 74955.0528931786, 60693.346635759146, 72701.34656460538, 98291.38287783327, 47237.035917056484, 104192.2213202969, 70403.88030322544, 121711.77169628152, 34200.33349818131, 64321.96207410257, 44850.9929242774, 63378.89360667561, 92034.06779853073, 79836.41184667722, 77830.15916376733, 80384.23581355845, 90716.12124877976, 59149.11848690385, 106464.13859351014, 105013.40104362724, 96203.60835227356, 101583.83822532305, 93499.76384701459, 156000.14799222525, 82374.56973881873, 76397.14291116977, 65113.82464033666, 58611.0962987532, 53923.41277514281, 61907.943141625496, 82832.09389103249, 94649.13779556012, 86279.0430152404, 64825.35535939652, 112974.59846241126, 107542.07213186978, 80371.54127174008, 67561.09816581276, 101325.0895492698, 90260.23118604287, 49629.194609644255, 82907.51400999734, 92464.49597156997, 61653.82227440348, 90315.45040456578, 49491.33077567391, 128670.11414380987, 125376.45627671578, 77853.24911896116, 95540.3450915207, 33994.77419887664, 55843.16716726809, 76750.57965006013, 57713.36787158404, 106713.29832698204, 155093.272142495, 55398.30404464047, 63113.28639945166, 91669.15379490214, 139331.79036237678, 54401.252995378236, 92075.05338214856, 147905.33113088278, 45527.94794800657, 53137.20172020511, 73345.03239359337, 70863.33358873795, 109992.19498818119, 91854.55517724922, 43171.422842434265, 100275.69641070811, 69430.37694271278, 126359.13800306917, 68185.77293912311, 67962.72444367586, 101092.55505809766, 108325.09607250152, 98159.12269927024, 44867.68073841109, 100993.95708458268, 58564.84816404839, 91664.01566223128, 50133.23778928927, 98103.64998518137, 63844.60976992388, 53103.7152603813, 106694.25611055543, 91854.1012290251, 68522.89050778348, 133055.01249108234, 72905.02093531608, 85734.47117453547, 92670.97501076973, 68381.8566084141, 98880.08969816417, 70538.09296072066, 73654.95566057926, 129669.617476499, 58423.02747355268, 33957.25815655044, 139324.64150944844, 167519.5872683494, 73820.21530660767, 40204.000716860064, 76306.96388942751, 76951.76477505518, 79544.98643569833, 56792.809530594364, 102321.38405552001, 100564.08756706081, 48680.49631193684, 106211.88464477612, 156423.41077665178, 89788.23483545917, 75597.54653908967, 80855.78114684868, 103471.84145105002, 44008.02387400774, 89565.68255747331, 74205.26187454411, 149014.245426623, 79974.33106627334, 141610.677054306, 57007.32184618919, 102568.7494773444, 94196.04246186039, 62370.06455392122, 89948.27423461451, 124070.96783864978, 75954.71979006683, 44745.77389566759, 84323.89782609984, 61590.29607883147, 75465.43811067006, 82527.87609445426, 44484.16163624297, 46241.33194860201, 99223.4164505993, 70809.41000753788, 31962.730513605056, 109058.4901303236, 92774.85472010238, 66071.87169983578, 52375.159999116935, 110777.05176933546, 95108.59124756738, 163819.9446527596, 97290.36524153118, 96285.72270999628, 80172.30361320957, 110133.0963660998, 103790.14666337223, 125516.12373307497, 70844.73829870379, 73040.23671067228, 71918.47318144434, 109258.4332004647, 134885.4466372814, 72437.3278309716, 73314.85267262571, 94034.46839166681, 78034.73579560728, 114767.09330304684, 36070.42306062501, 63367.63595060994, 64421.0996785954, 35170.32733743185, 60175.00133588305, 61294.32617651312, 79241.10872973179, 120454.49982539074, 78053.57844983038, 58643.871256118604, 83215.9428562035, 118176.65267204003, 59892.469835088494, 61400.717504475055, 101648.24802732981, 78687.7146758672, 104518.07257639049, 84434.55903311033, 106293.1539477949, 58547.44172316861, 84478.72890650934, 78981.1797351446, 54541.899698138826, 47282.823302713376, 105769.61637920777, 75238.96147756206, 58837.11015017009, 82122.03558938368, 120996.47941755658, 35690.31577949351, 48634.96861440087, 61115.04709398934, 133441.3459825513, 93082.38548463344, 108471.74436935167, 56199.91494031921, 56656.35051267629, 98150.20529804454, 86483.67332066374, 101335.00595381822, 79606.30484552357, 92948.56400985284, 89381.56703546009, 108821.32210475794, 109803.61386447243, 46157.765290835676, 36129.60021115127, 116502.87090739622, 123163.18803167494, 58874.68120437457, 41590.46668383226, 87659.18080259979, 114031.55265539562, 146919.54159344066, 100303.79672076022, 74694.6159826257, 61806.82023492633, 85146.02011186183, 76604.72244761659, 59000.71968017022, 156328.95062359376, 146404.71541395108, 121286.2954257628, 61162.23655517559, 111429.71580482867, 104262.30344905207, 97985.8423159388, 125439.90415878741, 104123.9825982628, 107562.05589921467, 104173.8691301617, 94847.20514753282, 43008.982987577874, 87213.44297222538, 69965.40191291197, 53163.48346799749, 142173.93946235094, 144093.94490897525, 129540.02367173205, 92259.97625851228, 129214.91963121232, 85163.12939544886, 90698.6155707765, 57236.17130281196, 96572.25530425225, 86544.31708051733, 52676.55459420383, 83377.29145609643, 82579.65254433085, 146918.15784947205, 112769.50349938813, 85145.8537574714, 92067.61009237108, 86080.52657587627, 79192.00316010976, 57482.87278955112, 80607.22436661249, 65292.68724630753, 53797.44076269293, 100143.09834777124, 96395.52547556354, 42950.903031408954, 81388.0755542984, 116290.77373589412, 118533.48519969982, 117350.9848203209, 85928.91993504023, 62934.39712296947, 57454.43658138644, 94963.60466027517, 96026.36838617684, 126838.9318719851, 119988.31102019786, 81124.82586146123, 53929.148809959916, 76078.61411331005, 91126.81741294556, 79214.5471910026, 69421.49510071824, 92190.23866409804, 71285.16941764549, 68173.93836739693, 93954.87623118951, 73905.32591411375, 91927.5934613003, 92799.94026962871, 56216.076509099534, 71863.86184933514, 132538.51880964686, 55717.148531275896, 37843.91035726178, 41553.38163181825, 85648.91020709969, 85700.488332932, 81528.24591133375, 124132.3186815949, 30544.04806552394, 96539.60567983559, 137359.6688929102, 56473.63792900665, 74483.2043646545, 65129.116913757614, 61778.47427166485, 75889.44534021844, 132142.87281939984, 148577.1459298398, 75634.07562093713, 151427.85253904172, 85833.54667419141, 145106.51614909878, 82202.04671892266, 88589.9745173638, 95602.29385014827, 181488.7631451656, 111302.66226493908, 66232.39782111847, 115356.92416035074, 74953.42613970306, 71646.76155691675, 113264.1318144764, 85705.29262712119, 92961.57499897723, 85218.06459300841, 94718.86592926363, 97438.69718853784, 40202.30900824142, 105141.12610120868, 59753.770872212874, 49749.37298539239, 83175.1514578835, 87223.8345071521, 66567.25961068009, 110615.20866797313, 51838.76507909513, 73776.744763988, 69247.10875767842, 83506.62449874032, 92970.2570313885, 59163.74068493949, 107040.29692978936, 86619.49792374813, 40999.8669822621, 39918.48734478896, 84472.09339783386, 78703.08757857024, 81921.10418054237, 84029.91059188372, 91374.50291982075, 114614.13334601029, 56843.534386984946, 55500.0433001768, 57239.46239935013, 93273.2425870973, 125265.44558492333, 73145.2181747256, 32790.18954540453, 44515.83133070579, 63217.86898883822, 69926.7976566232, 73739.24766463577, 85919.42495139684, 76273.50660549365, 118182.54002608433, 66994.38316692135, 62527.981382297774, 99123.09542652019, 47843.45877367585, 96347.02046130817, 87761.1332682544, 80706.31179719152, 138422.54374856382, 68318.9093304982, 156606.47297755408, 78582.48653002987, 53223.94907340572, 86818.46172324527, 57621.22944535577, 65156.452897907206, 96573.552126759, 101553.44544261249, 68319.8934516355, 116000.08147751348, 122063.21407300876, 132481.7554445986, 100719.85047068383, 129699.39943275956, 41204.43787338712, 76110.36888270789, 62417.95931962317, 88245.31374933822, 69582.7490152723, 80193.36545436081, 150459.3357167808, 80095.9758186863, 97092.00206228466, 78397.98396124154, 86985.33801816129, 84991.63660915646, 98166.13788230206, 122346.47300843654, 140784.92156327257, 93899.31929359226, 102642.34040977345, 55963.868861165975, 82352.79662295287, 114358.8205114209, 111802.8832582854, 90959.8911547306, 112501.3219562173, 99497.25150904927, 123623.23407917678, 93286.59454448562, 75114.32741375921, 94696.25325496664, 27160.948816932323, 96137.33365967573, 17739.581669055966, 44144.93783372257, 98273.71820981523, 99080.79698985195, 55709.47486116915, 66114.89948341953, 129969.0857219961, 71792.65852214725, 160720.40173222224, 84766.50515543169, 96913.72293329124, 139561.7071046075, 88589.07881357601, 59289.99618240771, 81746.34194134169, 83815.10005378383, 51363.734050735824, 77764.30046887549, 65386.846519815896, 113807.53119881565, 85805.98836893243, 77043.12647130585, 81844.55101973392, 91301.95869355046, 103522.23632037743, 59349.93076193185, 58400.4199783407, 120156.87192277616, 73636.84417545168, 50276.16044204533, 98025.35811209338, 98636.63204847214, 47943.056233928546, 91491.28912319032, 107414.91451244896, 95875.90557669527, 104013.8885974554, 50537.4511274055, 94549.99938619604, 76515.60330747094, 71824.30964735751, 111959.4707448634, 134142.49778706214, 146785.82093958298, 127866.50551618471, 81746.15559734963, 95211.6236974389, 108455.22597005966, 88302.11688129882, 88581.41031658213, 110368.8731049062]  # Truncate for embedding
baseline = 85610.0
mean = 87479.33074659818
std = 28618.57515676219
p5 = 45090.703410425085
p50 = 84448.10943919866
p95 = 140597.88743449724
display_name = "Annual QALYs Gained from Peace Dividend"
units = "QALYs/year"

# Create figure with two subplots

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---

# Handle edge case where all samples are identical (zero variance)

if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax1.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key statistics with formatted values in legend (use format_parameter_value for full units)

ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {format_parameter_value(p50, units)}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {format_parameter_value(p5, units)}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {format_parameter_value(p95, units)}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {format_parameter_value(baseline, units)}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---

sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax2.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key percentiles

ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"

exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title

fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark

add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from

output_path = get_figure_output_path('mc-distribution-treaty_qalys_gained_annual_global.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Simulation Results Summary: Annual QALYs Gained from Peace Dividend**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 85.6k |
| Mean (expected value) | 87.5k |
| Median (50th percentile) | 84.4k |
| Standard Deviation | 28.6k |
| 90% Confidence Interval | [45.1k, 141k] |

*The histogram shows the distribution of Annual QALYs Gained from Peace Dividend across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
