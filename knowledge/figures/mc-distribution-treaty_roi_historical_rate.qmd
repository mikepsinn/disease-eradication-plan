```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Treaty ROI - Historical Rate (Conservative Floor) (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)

setup_chart_style()

# Simulation results
samples = [259313.99912087078, 277604.38478859514, 247384.8353662129, 241734.2824924208, 290904.36856016354, 276734.9297475119, 263422.8148610516, 271770.02187342674, 266470.8852776366, 277178.7541432284, 243583.61352794254, 246590.40929040953, 264761.41008575866, 235925.7511793939, 255198.22262242177, 277206.17722245137, 257731.2517133154, 277521.51978295215, 243612.04040355273, 267126.47139616817, 269623.159267733, 276083.3262322889, 232874.6877715948, 269086.89989357285, 273364.219805565, 272305.00243899465, 253478.69226319806, 257814.1609760933, 256616.61616157336, 256151.88281660393, 188129.68635446148, 273070.4237112317, 274406.2237947387, 276986.2005653148, 251194.9223952781, 235870.8151099503, 268346.5112744082, 277119.39649570774, 277042.1449006691, 250230.15977883237, 247592.88285335797, 253186.63887521622, 275954.09437602735, 261047.59964233558, 263668.25916275213, 261362.280865274, 243822.44289685242, 261247.936388308, 249432.40284076642, 264728.52340486454, 259692.13500470162, 250769.63443523663, 275347.79691976553, 271822.10616119695, 273902.9573141383, 275719.2545930929, 271129.80087229, 223889.8844082179, 277233.92120146187, 240887.19768331153, 273398.8923054098, 272050.7344751206, 262643.7977631132, 252015.10094678073, 248513.1979133796, 246135.58590011808, 272255.17468109, 273802.7420944585, 244224.4814868246, 269735.1321791568, 276905.13654613856, 277498.884671377, 277424.3318679166, 254416.8748707052, 263099.34855308145, 249104.3114111143, 273350.0109502131, 262738.67333537806, 250928.18615826877, 271664.6428272335, 255478.75617702087, 275923.34871842427, 272463.24995948025, 272729.04746546934, 277303.81992771605, 254686.4016292069, 273890.89850708307, 265877.5992772895, 254850.56170937736, 255745.317448251, 249814.4100822721, 268057.6260363256, 273297.5690164841, 267702.0216763123, 273686.2927868473, 275458.391989351, 276589.896417691, 277580.5676585714, 256947.30007540237, 277381.1290356652, 272678.67119427066, 230382.28178563857, 272365.10707330424, 247758.44721968306, 277463.46607850597, 269978.4196543787, 277502.8812811817, 272112.36344089743, 244750.29613705835, 276266.67170304724, 256058.88947129197, 260916.729962341, 275292.1236394836, 275469.835792965, 264631.67993849836, 274603.7520277368, 261035.5278271669, 265685.45030830737, 220277.39136099626, 270548.84198342223, 277600.4846772377, 262269.4905412878, 261331.82905653495, 228412.27342425796, 244904.48533471403, 258028.52236599647, 224951.05786324642, 277330.9963287531, 275727.1911411709, 277444.6007450432, 272841.9299333913, 276152.5723416323, 250661.97162185787, 270263.0910844539, 275192.7853822346, 277596.2442481616, 259099.44428052037, 244815.04877722467, 196875.27245636808, 145347.25171709535, 256573.68787568435, 277571.5432385425, 302971.930207136, 260206.30323911703, 276981.74862023006, 273191.3841350306, 275468.39272439777, 268839.1639039508, 237857.69092751548, 262772.19374861626, 269160.3443212914, 277604.00705064356, 272872.2635659463, 274098.44193378, 267201.73376757023, 211371.47099355128, 263369.0311393789, 240442.97877929296, 274254.1874517296, 277345.1183459564, 277533.51412888325, 276426.6944993793, 188911.27018814886, 277026.2417521568, 244804.28779769395, 277372.74797871104, 242007.90809920972, 257323.24842315548, 269124.6529125867, 266946.7518874201, 275861.313473868, 255757.23368091887, 273709.61178048176, 277175.0605056697, 276891.41576095554, 262421.4280123803, 221048.08625117183, 262706.0058686814, 268433.4175477068, 259771.59627990137, 230160.64117211304, 261346.12972487937, 273131.64315195964, 236589.1992540455, 256205.10990283437, 222514.94569424304, 262179.2753880534, 277180.4084536475, 276227.06385137385, 218601.70124621573, 214275.49975002708, 269529.77415988274, 272749.4040049544, 225013.26629019057, 277550.7279246755, 277344.7933962249, 250433.6248676576, 272908.4310491626, 266235.8614946611, 269246.0170953048, 258507.88304972847, 226812.88193182324, 264235.94972595543, 250416.50664628358, 297490.9920086457, 267102.8608503866, 277133.8953703591, 277206.5078268086, 277283.5444131015, 272039.38629899564, 242483.33369804578, 276562.56246172905, 265504.036210285, 274072.48880294524, 271942.8624731884, 239825.60649972412, 253322.4820264365, 229130.2501479733, 269086.47327797627, 276204.3564804779, 270290.5900132697, 260804.63980178683, 262330.9537657843, 277581.4465231679, 264238.00156287075, 261139.70006867294, 166956.6461508615, 204364.26486744842, 277179.64306964003, 271323.5256025489, 275277.0859520603, 275257.56533843576, 259048.30409140023, 233412.77751324617, 276454.621042855, 275855.68887891417, 303996.1818874241, 269232.19756633823, 277598.9272453739, 274603.15080583637, 277278.50590212404, 267978.08233086334, 278236.548318187, 275236.0362563277, 188865.0881236422, 276832.0955195496, 277566.2426063288, 206910.59564328406, 145880.89739773958, 277391.57652408176, 272537.78471839445, 258409.34487000105, 213943.72192910797, 277568.0684536112, 270646.47489402274, 246603.6636194033, 256050.04300805012, 272650.2989703931, 268712.37301837053, 276168.3824467441, 270529.2872648282, 270989.6802080181, 261047.39882242662, 274888.7193395307, 255092.60025914016, 239517.45386294855, 262808.56082858564, 258156.00364447894, 265033.57093803387, 266130.4508870008, 276399.84580833203, 259026.541027654, 268035.0716553544, 191018.42718832078, 221242.6563395608, 257300.6053760158, 276686.69877032225, 277541.55253353115, 233885.80018109732, 260324.67991279784, 254866.44619006704, 277384.36700422945, 242133.52394946304, 255540.1341741169, 277545.02469203726, 273917.2528386904, 260301.6121859239, 265048.0597299874, 271398.59686418006, 268151.5022199788, 270756.21226385416, 262872.862310246, 224676.79053629315, 354195.32823203434, 270507.36204943573, 262332.3386768487, 259525.83675850343, 272590.0844772887, 278171.23509530904, 258744.2190857942, 214032.52261194875, 274405.7900464351, 244049.76656265743, 271955.65578122274, 267348.26383062, 277602.76417813974, 272044.34547477297, 230355.58342757216, 252112.8361580857, 213705.69850311612, 234326.19173284734, 255938.31236215006, 212941.66855749648, 255940.7329630475, 245115.46803464397, 271467.2353249451, 264750.47295011894, 276216.03993774566, 240232.2119417372, 277368.76270649355, 246457.3370116749, 269723.8079957054, 234523.55326772854, 247372.7442150476, 207955.44817472677, 247952.55920620833, 273871.79592075996, 267457.06588434585, 277390.120738041, 274476.01084115304, 223342.0060618814, 250595.48502241567, 276227.87610311655, 277595.02505967626, 265459.42811746587, 277216.66755235824, 276001.85942506575, 259136.20211445194, 235032.65703389628, 251394.6588768575, 318573.625364788, 259322.52498191275, 264633.72462676425, 256586.98193234156, 219786.23777131143, 298363.2765611117, 275261.5564271466, 251886.57297708557, 273731.29439941037, 224527.3966028214, 257741.14138296424, 244563.8048928913, 275054.59787345544, 245535.55372059534, 237779.59527853027, 261030.7954053515, 260995.06742282267, 260143.39747820102, 277223.4884840448, 268961.0357421608, 269050.89776654803, 257362.5947342131, 239916.25521094393, 277600.762457509, 268550.8941773956, 224342.71337154927, 276556.75608973217, 277030.700118296, 261741.80489873476, 244629.17964549948, 265899.44935134467, 229407.6450770096, 244259.73403083743, 244705.39704026052, 252890.21305954334, 177384.07943382964, 269973.7022061251, 294384.4963600809, 220193.1898715162, 273744.058278444, 263860.8172041751, 230044.41877711553, 273417.91286225966, 277043.10634524794, 273433.09304392786, 276876.97419615806, 255924.07655213762, 253696.60617458264, 260001.321212121, 275814.6296228293, 320893.0710816864, 265008.34104868764, 273920.366631645, 255410.64504406354, 248777.9520395009, 263192.43823607126, 247104.24812105834, 261116.6980889176, 253538.98461063206, 276272.5520966801, 269531.3895226108, 261869.13972488538, 245335.97885173533, 272896.4807150306, 253777.4817137368, 270980.85481853556, 268413.140142303, 245070.15912660182, 293689.52811142744, 276773.21362647094, 275059.4144951173, 323814.71341292554, 276061.34586974187, 247414.27012354834, 271284.1810444104, 261845.82146000455, 237127.70056226305, 229449.51385467694, 267499.16657408164, 228597.07316350096, 264202.67696341185, 277106.20434513496, 275294.6276787201, 275078.9751324746, 277321.1882757083, 272390.52019431914, 245835.13405323512, 214466.63138083255, 276103.47963978996, 257123.79450349242, 277604.39991142845, 255009.67865351026, 268662.3723390638, 283003.20798761246, 242107.4510785554, 275399.47514691437, 274653.2941368917, 277594.43079958734, 275856.8898186245, 256227.42238895776, 269699.3994009899, 258727.80977874662, 257902.33422407086, 229680.13759407547, 272167.8622456715, 275122.328557627, 237818.75718352688, 272000.0402353041, 236326.59521596855, 257363.01786811932, 268663.3031378063, 258230.15148155292, 199703.7594832236, 191991.24232666256, 264690.2060889163, 262701.52675897884, 237535.8118447315, 277145.20982486376, 258619.14576894807, 266651.84995234775, 259089.80392982892, 277086.624075759, 273611.92437818943, 299014.4616380061, 277532.39667195326, 273756.4012231836, 271414.5453368934, 200562.99129914312, 236598.53132770336, 277527.80856031715, 258256.6815475816, 273079.445328406, 271275.97798936744, 262131.5373038611, 251106.44081821185, 272115.70370339684, 237924.38697929218, 277477.93699848116, 266003.2901839219, 162709.89267632447, 261259.97038748336, 225956.3102284563, 264215.769418098, 252164.24521487742, 267260.1363589565, 269369.4595563758, 276789.90186036995, 256165.28433399423, 277172.0086762326, 249808.7713637976, 237251.42153136688, 257786.91199966203, 271305.67728815123, 255551.9800545123, 271654.3068938293, 241887.0461989839, 283035.9181920637, 272061.48833535245, 293540.2554750616, 274903.9317306407, 228257.94076871476, 243109.0341012165, 276384.5093514053, 274811.83190229896, 412530.1356228545, 274759.83490785357, 172221.5934012213, 256046.98917147337, 274934.2886540092, 255261.81638699927, 274031.3080048012, 271478.9398104376, 264043.58736004535, 267823.5644426555, 246210.0250894732, 258332.74056170337, 249731.5106531573, 276143.92021086265, 243029.77296515144, 219352.47056049624, 277542.52049514325, 277319.58384160436, 229183.33238355245, 269735.8194801713, 226934.48702791403, 273549.96787311323, 225227.32275595126, 263342.2368649276, 260432.25102288966, 221535.3818140748, 272444.762897055, 277482.28600322106, 273627.64595170657, 255594.46336726032, 273962.66172523034, 250597.2409791767, 274707.60528229765, 235271.72488743666, 331469.233218296, 276832.5817705419, 273630.5169046688, 277051.0344347706, 260682.6241652207, 269524.64708054485, 270779.05168508936, 269170.16390763334, 261716.84375326222, 277591.18752903544, 248638.26117296147, 249890.98670702183, 257321.04992867666, 252824.69368700075, 259515.56104349927, 194528.94947974486, 267842.4281285639, 271629.876457793, 276624.12271835376, 277603.38919408974, 277081.2747074468, 277323.6090575614, 267528.84605887806, 258588.9153941525, 265075.9166949995, 276702.6468989682, 242958.33914426004, 247703.74578974067, 269178.43372257904, 275844.8738361782, 253044.188122704, 262071.00863067425, 275447.3500345403, 267476.8669636659, 260341.67369692583, 277361.9148240726, 262028.21222884775, 275373.751747075, 229170.11825920697, 232052.4036557531, 270765.0237551802, 257863.98843437844, 333474.24744789995, 277438.77185889933, 271423.71699484467, 277592.6836216667, 248422.51639458322, 196840.48796458796, 277374.592997508, 277106.51806929184, 260970.47570492062, 219959.67910502374, 277190.17349889275, 260650.2243402337, 207913.44171601374, 272614.0356818281, 276872.10056261317, 273301.66796794196, 274502.5105813053, 245569.80904337467, 260824.36716652883, 279355.83350453264, 253931.35841124726, 275123.19770053757, 231191.137650633, 275615.28381085274, 275698.62851749425, 253241.199348134, 247023.1433985028, 255704.58564947263, 273574.45347334933, 253324.66352993023, 277603.79569044657, 260974.52074829754, 275704.5469828151, 255750.744684001, 276947.29018682934, 276862.3454079968, 248439.0106326828, 260824.72526174688, 275486.48029067524, 225356.59162879427, 273525.56235483737, 265473.42415021046, 260177.58351220595, 275540.77793009963, 255103.1522725462, 274648.27699502045, 273141.2568281669, 228298.2153672201, 277604.4007366687, 333841.4377379347, 219965.777882653, 165258.77386590108, 273054.81937668304, 289965.87175202806, 271682.0811056401, 271305.2714393283, 269711.193748248, 277539.80401946855, 252197.5099206699, 253688.04524841334, 274911.9616050429, 248856.51536896706, 193459.07405973863, 262435.65595926205, 272087.025146741, 268861.1453930041, 251214.94254195492, 276483.44791416504, 262606.8585835263, 272851.0261857603, 206212.19234344998, 269435.8680915813, 217981.70106049167, 277556.0162041184, 251986.66897639353, 258955.3557621202, 277247.2092891742, 262312.2503081481, 233198.04906707225, 271884.42856465536, 273984.37381576153, 266486.14273008675, 277371.07453796343, 272161.2916715615, 267737.68889323296, 274866.9564154804, 273207.75740800274, 254815.78625682587, 274526.872057647, 353934.9401718627, 246384.46491322297, 260094.9007401902, 276342.675428018, 276632.56343824434, 244883.82872521566, 258215.86173052993, 174310.44149437617, 256425.49506199043, 257253.6362683675, 269307.8835089158, 245446.73482593283, 250942.2290085678, 231929.93187110667, 274510.92018691415, 273457.2450898994, 274010.6557491518, 246210.15395071972, 223774.4871842149, 273758.4890626034, 273317.1696131432, 259085.67179906162, 270654.4223580855, 241383.7959387233, 313754.97680210555, 277053.44080912817, 276807.7138238226, 322163.89550973155, 277530.7536898116, 277411.53386870475, 269904.1813287849, 236378.06879128524, 270642.9046443479, 277603.0390498023, 267263.46724303626, 238383.45758673028, 277552.163215515, 277397.41186978173, 252770.01123334948, 270251.5382070435, 250317.25474832143, 266407.6072489061, 248786.21878744714, 277603.92208886263, 266376.2157504551, 270067.9995725672, 277219.65958605165, 273995.36652250506, 249238.7468243104, 272287.75859596714, 277599.93251016113, 268014.21372025844, 235901.07470867675, 317279.8704299615, 274884.5425665613, 277434.25148500106, 225022.1490459347, 259849.62313001137, 246895.52473934426, 277482.3973809526, 277528.2397659063, 255712.0069926073, 264925.6448198837, 253035.78139275583, 269672.0613001843, 259956.4464568009, 262748.13153171295, 246591.12538803753, 245734.47572382216, 273140.5300505977, 313209.6134179541, 239856.89769981208, 233995.5227930642, 277599.1224713801, 284897.5240588052, 264053.18847507, 242030.24178442315, 209443.5340363851, 253907.66741289204, 272587.26729602145, 277339.1700959188, 265898.9332702907, 271509.0941489556, 277595.91790794145, 193697.3461924555, 210249.3440435644, 235646.0534000217, 277428.4036596956, 244312.64599758785, 250537.05296699976, 255848.71641042046, 231996.76497872692, 250655.82998049105, 247686.39360245378, 250612.9995057687, 258428.27346951145, 279918.34085577825, 264385.82749085495, 274898.03089817223, 276879.7078614765, 217051.2730091731, 213924.10672018962, 228411.1834779483, 260503.8669999868, 228694.6876156763, 265886.6218437296, 261730.478215015, 277570.6860218981, 257018.07057805685, 264881.01728849515, 276731.7195008865, 267151.30362661055, 267702.23842795705, 209445.69366986753, 243138.29893818128, 265899.0529569615, 260656.10942715371, 265221.2304982965, 269935.21917191765, 277583.4973810535, 269024.4752951579, 276573.9703321205, 277050.29432698817, 254043.10002199915, 257163.42503196298, 280119.8439565402, 268508.10578628216, 240043.55142717538, 238069.28129193606, 239110.3748772488, 265331.89249669906, 277142.35655269213, 277582.17839387077, 258333.7409994481, 257466.4136157247, 230771.00742778118, 236788.43098306222, 268683.25457391585, 277082.66264060396, 271813.5431471621, 261396.1829859883, 269920.9750625499, 275126.86789407086, 260559.0939385929, 274309.3061699243, 275619.7436866666, 259149.79608419133, 273010.06069230696, 260766.7286989019, 260074.92112059728, 277484.2106343748, 274036.80872931605, 225804.13201930365, 277421.7018652568, 301938.8568642858, 285029.3260999938, 265535.5563279163, 265498.11222025735, 268414.41132795764, 233144.1763622638, 368932.3927330693, 257044.93837136385, 221646.4710598639, 277511.2192416284, 272701.8630958352, 276619.878424212, 277343.4567777525, 271921.6492546266, 226147.27643314152, 206880.2706505178, 272066.42579417524, 202580.73660975965, 265401.3676836425, 212302.06959488362, 267959.88749858283, 263351.70642818155, 257813.39912572314, 127261.1409005686, 244423.88699535158, 276292.4816969329, 240865.1309779299, 272445.65755030024, 274140.0351013602, 242704.212646103, 265494.6228132836, 259946.06654473976, 265847.0671535423, 258532.39382045955, 256302.7120500447, 289974.3865763021, 249780.94437157712, 277561.3605904118, 275510.36076149583, 267291.7668022588, 264378.0975167678, 276185.03751613793, 245025.3657136799, 276441.4961095811, 273077.616578087, 275198.47500140656, 267061.1371814424, 259939.13945172745, 277590.665658847, 248139.12610601026, 264825.6331225219, 287006.51410054637, 291404.3704051862, 266380.93321621587, 270241.96131342, 268150.2259208387, 266694.0037572248, 261202.0776332298, 241518.26215535434, 277543.8540262337, 277390.23856017244, 277570.8773581475, 259697.03041935462, 232149.76064763154, 273403.9054819321, 345461.0770503897, 274759.90422272636, 277084.9940598336, 274914.54416039883, 273097.246571076, 265338.81404819177, 271701.40817331313, 238378.274069283, 276042.6970443053, 277219.13585879985, 254899.81802334462, 274381.85580143257, 257203.28485359007, 263976.800935386, 268959.4813025577, 220736.2996540824, 275564.82139069797, 192998.11227806922, 270316.9800023469, 276897.0464180701, 264678.7482937699, 277589.3321161928, 276612.2711015743, 257017.00327059842, 252850.49039568435, 275564.44640432554, 240299.34146866636, 234962.59684867453, 225853.34618354606, 253556.4704216237, 228272.2576686655, 286273.592725374, 271795.3247119444, 277238.79980195273, 263612.51649065776, 275059.88705827785, 269294.2296710866, 204026.33945440926, 269357.303946358, 256589.49031034662, 270431.2467510404, 264555.2053850478, 266009.85830106307, 255698.74708513473, 234713.49122213662, 218722.4568188965, 259194.5285652026, 251923.8979521171, 277454.30620675586, 267857.2759264967, 241742.6675232851, 243985.79077164913, 261526.69556579343, 243373.542478093, 254586.1550201689, 233591.2995462023, 259686.34484941445, 272356.89378682, 258550.72736659882, 407213.36355947616, 257375.42860088727, 464252.84119163593, 276017.27328208374, 255609.17683009084, 254935.23298820746, 277420.63421301777, 276329.305471259, 228037.26166408093, 274070.79517513775, 182213.23703597783, 266171.0775595674, 256736.68198818722, 219763.5967319926, 263352.385807991, 277585.7453517275, 268268.03512420855, 266845.15907874086, 276256.3459995692, 270819.0088440679, 276547.12220672437, 242227.0399159667, 265421.422378283, 271251.2239915928, 268201.88753092015, 261258.9842008785, 251171.78981119095, 277583.15060095733, 277604.40747926326, 236640.04891887156, 273150.6919127965, 275774.12181809853, 255815.8626930846, 255306.55593642208, 274447.8468271281, 261110.37030031174, 247814.1361248638, 257589.65840438043, 250750.3222233331, 275897.54299812246, 258669.21812938657, 271561.0536271325, 274055.7033260834, 243848.5807187183, 224415.87852214655, 209652.38867281124, 229872.13609796696, 268268.1604964242, 258132.0056255439, 246909.9019645039, 263569.61744878086, 263358.2019281056, 245240.71289028536]  # Truncate for embedding
baseline = 250919.99999999997
mean = 260507.1229279057
std = 25426.484719650343
p5 = 218881.42306201335
p50 = 266397.9796588827
p95 = 277602.22295841476
display_name = "Treaty ROI - Historical Rate (Conservative Floor)"
units = "ratio"

# Create figure with two subplots
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
# Handle edge case where all samples are identical (zero variance)
if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Mark key statistics
ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {p50:,.2g}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {p5:,.2g}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {p95:,.2g}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {baseline:,.2g}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---
sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Mark key percentiles
ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"
exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title
fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark
add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from
output_path = get_figure_output_path('mc-distribution-treaty_roi_historical_rate.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 2.509e+05 |
| Mean (expected value) | 2.605e+05 |
| Median (50th percentile) | 2.664e+05 |
| Standard Deviation | 2.543e+04 |
| 90% Confidence Interval | [2.189e+05, 2.776e+05] |

*The histogram shows the distribution of Treaty ROI - Historical Rate (Conservative Floor) across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
