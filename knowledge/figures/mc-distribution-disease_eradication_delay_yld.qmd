```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Years Lived with Disability During Disease Eradication Delay (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)

setup_chart_style()

# Simulation results
samples = [1017391913.3446726, 450027756.16945, 1302692535.2503202, 1443494789.3726716, 237693806.93601415, 377831638.9916953, 919778763.4687414, 708447093.385232, 845880403.8106222, 507919754.58903, 1396847686.8445196, 1322192639.459343, 887568740.2437971, 1594159488.3618574, 1114761685.5748742, 505892709.98148, 1054802296.4324207, 474454144.89105207, 1396135184.68602, 829670994.037168, 766274524.4496604, 566388287.2481086, 1676121572.819596, 780164144.5593206, 661995724.4968026, 693290660.523789, 1155641569.0250719, 1052842554.8159709, 1081161105.1503153, 1092161162.6404529, 2672332354.8556933, 670874691.5086476, 628878331.3915147, 520809913.40351033, 1210290071.771151, 1595617115.1530352, 799071880.2580576, 512121161.97224295, 517269147.40529126, 1233527199.5595267, 1297600173.6531665, 1162605221.0807807, 571881649.6609329, 976352770.949831, 913894993.211748, 968886978.3296815, 1390865723.9616454, 971600576.5900266, 1252819499.092401, 888363987.1736268, 1008449808.0096294, 1220521327.9367435, 339680682.6264208, 706987556.0344131, 645228780.4526796, 581471195.6663738, 726137027.370635, 1930637646.8436131, 503778534.2222189, 1465062431.520632, 289578688.2520083, 700540939.0606147, 938398931.8786286, 1190609874.2541902, 1275142658.2252352, 1333397174.835958, 694718477.3729, 648400271.7382939, 1380816916.6345127, 763351171.4718541, 384678140.64852405, 423180969.64604807, 486707837.3701305, 1133313811.167415, 927519790.9202566, 1260775425.2868378, 662429121.7780935, 936135237.8737975, 1216704818.3158312, 711390195.6307092, 1108108981.3590796, 573164550.8899434, 688732348.3553313, 680990390.1621181, 405908319.3186695, 1126910177.299218, 645611772.6232431, 860434149.8279341, 1123012080.7210233, 1101791180.768329, 1243572225.404912, 806374866.9768312, 664025094.3207892, 815313193.7617849, 288649310.88619447, 342057275.0242957, 372595164.91928107, 462770573.9798476, 1073338137.1898764, 491110786.3668217, 682466321.3379031, 1744672126.342923, 691563650.7506346, 1293551844.7714612, 482276779.21358144, 756969784.6588742, 477185899.3809818, 698791678.004456, 1367713570.309365, 280428051.5596506, 1094363228.9349587, 979455747.5828379, 597870672.3773837, 342307586.9687717, 890704534.6951584, 622241363.8743671, 976639044.1596462, 865126776.0329283, 2039174618.747152, 741834619.2372682, 454909798.8649238, 947320058.9016764, 969609745.1161342, 1799932764.6082053, 1363879446.6583893, 1047775959.2980139, 1899467918.233868, 407833781.118337, 581154542.5476879, 484475426.1004011, 677667863.4544584, 359091371.5344009, 1223114398.734925, 749448280.498604, 336471278.6681249, 457269624.31225806, 1022464313.8257691, 1366102954.1532853, 2487567417.7917786, 3460695109.6196795, 1082176893.320406, 465099492.96647763, 206903034.36933273, 996283966.687853, 521085710.25036156, 667239623.9316403, 591245861.3644311, 786523250.1411833, 1543303417.2001648, 935335204.0726563, 778272193.4106022, 451305989.4412196, 291288893.3206904, 638965535.2645916, 827800637.2212131, 2218439561.2268496, 921066889.0966325, 1476425169.0879254, 633897650.9959469, 408875975.6470853, 472539650.37193155, 550845183.3090001, 2655050806.6206694, 518290354.99559385, 1366370568.954089, 491918326.17880076, 1436555525.53988, 1064447719.7291038, 779192008.8161266, 834129029.6745579, 575726835.0515345, 1101508830.2495553, 651324968.1936473, 397888114.1132931, 384092577.24084926, 943700628.9320111, 2015696138.3539844, 936914787.0684994, 796867152.0870563, 1006570237.0701213, 1750840853.9370682, 969270331.2214388, 669038430.8080546, 1576606924.972614, 1090900904.2793915, 1971498070.8061485, 949468043.2174997, 398192069.7821851, 361198196.15807945, 2090848353.6283104, 2169398816.4780006, 768706246.6784179, 680392800.3624101, 1897650414.4215093, 430598878.5967802, 494520497.6301997, 1228618269.8497555, 675700337.5762928, 851657907.3495418, 776061224.3840468, 1036446651.4487689, 1845529725.3970895, 900249904.8542533, 1229031101.6327837, 220431264.77540812, 830257319.3712838, 511116546.86239463, 399707178.9682718, 499813983.6795006, 700862498.3935899, 1424529858.902335, 371658842.59302074, 869548545.1462879, 639803148.8185023, 703590832.9960983, 1492278319.4202669, 1159365386.8436453, 1779679433.7422996, 780175124.3823547, 561081060.0168803, 748718438.0222173, 982112638.1917194, 945856179.0373875, 437086731.82354516, 900200486.7587084, 974168383.7149664, 3048538907.680828, 2343217944.432645, 507854960.4433037, 720830765.9464726, 338199755.3328355, 599148465.7301918, 1023673229.7133245, 1661514348.146035, 549508077.2887913, 575957470.1538002, 204772649.6316404, 776418162.0395458, 443453009.20983225, 622261775.8562593, 500228389.27683544, 808379017.299115, 274297928.06894916, 337353169.8194004, 2656067554.6611824, 381633207.9548672, 433527205.2459876, 2296782118.6223392, 3452975858.1587167, 412542977.7573076, 686572477.9987005, 1038775509.4249502, 2174926021.758177, 465911673.24586177, 739217738.6302329, 1321866568.22413, 1094572727.732681, 683295763.507738, 789764799.952792, 359532921.6405644, 742357776.8053087, 729951725.9272708, 976357534.0832807, 612408485.9108535, 1117267523.9576044, 1500218286.154616, 934467078.0868547, 1044762989.5136144, 880978853.7649195, 854243875.6508539, 552118968.0704033, 1024187681.7649324, 806943425.212585, 2609235415.621767, 2009796922.6522388, 1064983094.7647063, 537845976.514391, 429073725.7773305, 1648728263.8985572, 993481611.490117, 1122634977.1492493, 276934577.70339996, 1433374284.9267137, 1106653955.6836867, 429636236.51645255, 644774258.1326452, 994027746.0649472, 880627589.3884048, 718764048.7235807, 804005933.3150502, 736266560.6361581, 932931737.3918933, 1907493809.2291486, 181492508.0589551, 742943972.5303372, 945823189.8039764, 1012382838.6853279, 685051840.2869393, 274499189.59389126, 1030860903.4404924, 2173444773.495762, 321952634.61540276, 1385180628.0227728, 703229903.7469343, 824153192.6174791, 446232858.05846393, 700721998.0270153, 1745414554.1855466, 1188268986.007047, 2178903211.7602496, 1636869747.8899145, 1097218990.5922666, 2191737044.84277, 1097161653.7186618, 1358639077.8138454, 716869143.1646551, 887833239.3916092, 560559634.763311, 1481829254.3921502, 410692951.2967385, 1325467770.5557697, 763647202.7820086, 1631569462.1319382, 1302988669.3349433, 2278094921.666551, 1288810129.8315043, 313402526.3475859, 821439611.5459292, 412421793.84392583, 626548996.6844645, 1946854611.464905, 1224716354.513614, 560029674.5521171, 457825866.9096249, 870634566.7818073, 400311955.2106114, 569870751.5880659, 1021595358.7541931, 1617937049.2166207, 1205491332.6017642, 195347515.78929257, 1017190329.9531533, 890655137.2260302, 1081862318.7945457, 2054230990.1971273, 218228893.57017148, 599001230.9439912, 1193689637.8006148, 311290819.7295804, 1911874323.6601193, 1054568527.3449527, 1372355920.533912, 606526418.1021651, 1348225431.2300446, 1545344216.306046, 976751267.2190378, 977598459.6276655, 997772911.7134999, 504581457.1480931, 783399232.1552967, 781090429.0875641, 1063517430.012553, 1489946087.5376797, 444584297.4571194, 793880956.9388067, 1917298201.5501454, 544504347.932905, 518005286.8688438, 959873176.008266, 1370727912.217906, 859899912.3620154, 1771889507.5086608, 1379937040.7459328, 1368830746.9698424, 1169680030.9919066, 2853135813.3015285, 757093922.8077688, 228431575.22918698, 2041750611.4381533, 650245675.1326854, 909272575.5546188, 1754080423.1736944, 306761160.17525566, 390974983.47990066, 306975155.77046454, 527353546.7581773, 1097556191.2846112, 1150449894.3355708, 1001135207.8079555, 350283533.2693664, 194369634.89271304, 881590414.1208862, 644675183.3712159, 1109723835.0699983, 1268702336.7073734, 925293472.1740198, 1309569815.7703803, 974713983.4432286, 1154204784.7627254, 558013309.7898934, 768664231.2053479, 956846317.7678117, 1353169398.9148796, 676054471.2519065, 1148523970.8048658, 730191356.1595324, 797381900.4768306, 1359763874.8269246, 230255522.9440679, 379298315.9283996, 333814088.20833355, 193154102.14748287, 567334664.3624502, 1301971703.814391, 721911554.3024623, 957400717.7565547, 1562428226.917199, 1770715416.187753, 820388363.8923459, 1794707173.49116, 901051160.7106272, 513024003.9021605, 597777828.8820465, 334198107.2979013, 496620740.5290663, 690831873.779326, 1340815369.4275005, 2166223407.7575154, 357738714.8724429, 1069164005.2029445, 449862716.43517655, 1119235221.6756516, 791040778.2716067, 259967898.70497426, 1434034356.9430106, 593858097.2830999, 620554763.3359226, 441318843.13612205, 575908248.6414059, 1090372644.895969, 764284985.2592179, 1031248744.5607944, 1050758467.3284327, 1764256113.7491603, 697212073.1238954, 335056105.63209057, 1544320680.3499844, 701976099.1248634, 1583543353.3020916, 1063507426.6854751, 791017037.6549531, 1043010565.1774001, 2431634071.477609, 2588457797.03264, 889290278.5413423, 937021663.5588988, 1551722772.232104, 510323220.8839157, 1033817021.1086751, 841420228.1615062, 1022692208.0426306, 514345234.43099964, 309537053.51587105, 216597131.48362812, 427664165.928492, 649858237.8159674, 718324211.8002676, 2414989375.3897953, 1576360696.5575328, 473468042.2440255, 1042383549.6243639, 670604533.8071706, 722136688.8806294, 950604342.0143162, 1212417157.0468154, 698696725.4581479, 1541561490.3871517, 420757950.16464525, 857359214.5593665, 3134702239.6059947, 971315030.9108272, 1870228304.9809332, 900735898.8259708, 1187038022.4266176, 826347832.9921682, 772867748.9025016, 532279944.7025211, 1091843843.6991308, 508409523.74585027, 1243708599.4447932, 1559179185.6065, 1053486635.0399873, 721321255.4662828, 1106373160.2316895, 711678163.7905183, 1439619000.4401193, 259871956.0745545, 700236066.4773, 230648944.32169744, 330827307.52224296, 1804303567.5103784, 1408762602.971642, 552841577.574047, 329110358.35984826, 163118861.2664388, 616895899.8270222, 2947152958.944766, 1094645050.1998267, 610804961.5668532, 1113253239.510122, 315865856.55717516, 716545505.1751492, 904879581.4866073, 812264251.2141658, 1331561316.4006689, 1040585974.0801828, 1245577531.8616045, 563752158.7881262, 1410756242.6282568, 2067589582.5727062, 470998629.4197449, 496760582.15806514, 1778187249.7884793, 763333200.7906463, 1842039255.001213, 656290374.3927836, 1891404623.0072603, 921708461.5149388, 990934523.1612443, 2000942938.8462303, 689266767.5705184, 479942499.7349752, 653881757.103914, 1105366181.15229, 314796889.73884165, 1224674038.952571, 618695119.499067, 1611555155.0372863, 190052400.24831226, 529894007.1413211, 288829458.4542261, 516692935.7956346, 985003985.9512504, 768839590.8004274, 735650998.6247301, 778018998.0842375, 960466361.6495327, 459376796.2445358, 1272099311.2919908, 1241720565.0249724, 1064499701.3180264, 1171244753.167669, 1012625841.784382, 2535336298.1039886, 811790491.4883689, 712358325.8970187, 541096816.7823234, 452308995.4077557, 392870247.06659025, 496409072.54288125, 819646853.0576717, 1034531503.0051186, 879952097.6608379, 537003227.0300505, 1412553913.539769, 1294888979.5941162, 777805721.4423105, 576400168.5055343, 1166004211.7490811, 952044778.8650519, 341816553.1376531, 820945267.8888865, 993079264.1050959, 492942748.7790916, 953063020.7824676, 340231670.3637267, 1778558643.313906, 1698573787.048954, 736029131.7753016, 1051664810.6652943, 189259131.31550553, 416746602.8367052, 718071146.3838984, 440628237.5696549, 1277350583.0420523, 2488266389.91392, 411156115.5361811, 513002654.04561496, 978181540.1576765, 2048905723.4416766, 398752666.4520754, 985771613.1802619, 2278842157.195366, 296119224.181067, 383279194.52698874, 663900553.3005269, 625660132.2255908, 1347377448.42482, 981645091.3864161, 270869814.58869725, 1144860925.638653, 604056140.3623376, 1722262117.9787154, 585575831.4296026, 582291879.7409406, 1161303790.284004, 1311559747.8265562, 1102756357.1127896, 289010639.73284763, 1159313369.7060523, 451703804.3770894, 978085633.0285798, 347639801.5735996, 1101662583.5159986, 523192867.2013446, 382873111.51214015, 1276948903.0505695, 981636602.7674818, 590555358.1965847, 1887638892.3293753, 657044309.6515217, 870293873.9649645, 996963765.8339477, 588469799.3178728, 1117017154.1936, 620725984.8044263, 668749424.7979254, 1803162372.546606, 449850303.4619708, 189114695.19283223, 2048718637.7589505, 3082499447.980773, 671341615.3850925, 240247425.9221539, 710904067.1870723, 721332406.0857564, 763976856.4690455, 428796612.99753755, 1186241643.9605224, 1150653789.0995235, 330978793.56716067, 1266792919.6925511, 2557544030.361821, 943361568.9275947, 699511483.4216146, 785960387.8663062, 1209808899.0358298, 279747338.99968475, 939280007.6117442, 677399188.8798126, 2309391091.348054, 771145861.4071158, 2108939883.9871898, 431540425.0293363, 1191291022.0604374, 1025870369.7963364, 502741260.47732985, 946301683.8487709, 1667335461.3046412, 705236768.0883213, 287688324.62127805, 845504757.0251703, 492077970.0230101, 697399301.720965, 814419109.9114085, 284860335.7110977, 303851722.1910497, 1123837716.2045107, 624840826.9821104, 181585494.61485052, 1327262351.4539082, 998920693.3691077, 554794826.9592032, 374087076.2682773, 1364392883.8433616, 1043348290.3792739, 2908493227.3084693, 1085683960.881486, 1066093674.2035072, 774461891.55003, 1350424949.8177364, 1216366917.4818604, 1701931464.9567108, 625377543.2979348, 659147750.385348, 641791122.2171781, 1331558139.9365115, 1934046267.9357145, 649792664.9762952, 663429247.2505641, 1022789888.1655958, 739004360.8274453, 1452402791.9341824, 197416539.092905, 516536278.5700758, 531290637.7674221, 193838713.4089006, 472993076.12500757, 488058163.1605622, 758921463.3548312, 1582182581.3009567, 739313577.3788034, 452738105.00904983, 826264936.8150694, 1529596109.2434905, 469224846.2306971, 489501403.1298973, 1172550944.4995232, 749754727.814778, 1231425332.3176086, 847437585.5575083, 1268501384.9294868, 451476125.7937968, 848209631.2222344, 754609468.7632344, 400491743.01915246, 315304471.6947785, 1257513921.4789732, 693785180.4247638, 455271913.64114726, 807469015.0470958, 1594814152.9096982, 195898008.11735028, 330462725.8007302, 485630611.77122945, 1897390978.401945, 1004724407.1770701, 1314692773.3901172, 421254843.6177658, 427055366.59633523, 1102580497.5053887, 883593968.096495, 1166204856.403807, 764998838.2445704, 1002197034.2295794, 935909511.2763044, 1322175022.0921118, 1343303631.2108955, 302941205.8575556, 197653961.8901974, 1491473075.015811, 1645769651.9808588, 455765312.7298853, 254464000.06594774, 904648658.967439, 1435989718.30389, 2251840104.8997636, 1145424784.2885227, 685133859.7811949, 495028371.48934543, 859912532.092608, 715711019.5944483, 457422299.2433196, 2552574655.587076, 2237796395.847389, 1601587516.680031, 486269047.2667422, 1378616774.3024778, 1226124632.282724, 1099341383.5401697, 1700098732.759289, 1223262358.605216, 1295313226.668044, 1224294307.7970731, 1038328151.3924499, 269161814.55545837, 896638165.7304102, 612081561.3167219, 383598046.95242584, 2123899559.5870416, 2175253400.2061973, 1799963610.596794, 989238489.3406672, 1791950459.6582778, 860213560.8787352, 960142353.9811097, 434476496.2426672, 1071664306.4841911, 884674591.8963239, 377710384.9911963, 829054112.1126066, 815307762.3954567, 2251802301.826482, 1408026779.7283216, 859909605.0601234, 985632187.5081495, 876425647.2492721, 758105978.9157524, 437651859.7665601, 781769769.9399745, 543642193.9905368, 391326174.10363466, 1142201951.9814079, 1068226834.6266036, 268552364.1688686, 794969414.6833184, 1486673614.0124915, 1537780332.8840735, 1510735290.1833694, 873736884.894971, 510524073.77949053, 437285306.98275197, 1040562329.1027244, 1061062914.7545878, 1733882241.8868804, 1571354104.8195853, 790508038.7729623, 392940621.5502826, 707227739.3285514, 968082242.1490566, 758480312.1340034, 603923323.2204084, 987930414.9841212, 632086482.8129447, 585401376.2150619, 1021273992.4135771, 672678424.550987, 983011087.9210048, 999393529.9731954, 421459606.41381216, 640951586.0907345, 1874636950.6840913, 415159431.5955015, 209397243.36630565, 254084984.0784652, 868780866.0929108, 869692797.6215585, 797349636.3422171, 1668797567.5441015, 176405069.72703102, 1071028875.3837537, 1997589504.0906086, 424729018.89451313, 681787355.1357659, 541314224.9545481, 494641661.5113725, 704188850.7194027, 1864704837.8245914, 2297327630.4657984, 700096037.3871368, 2376519140.831579, 872047376.4608396, 2202560486.8235707, 808837052.7457328, 921481729.9016675, 1052860563.0784334, 3701283330.1058497, 1375842532.3654268, 557105421.429214, 1465626019.5682619, 689240916.5314023, 637619122.9727407, 1418956192.0168304, 869777761.2968984, 1002442632.7579819, 861180449.4359041, 1035867357.4121119, 1088590256.716992, 240224148.46223727, 1244381653.7227006, 467380044.7141554, 343200881.62882, 825560475.8338724, 896824542.5476568, 561939607.6202971, 1360876186.5012724, 367678363.78643745, 670659309.0319718, 601318318.212465, 831292966.0540452, 1002606532.9087737, 459569586.4812388, 1284257404.9312692, 886015096.1608781, 248459692.00270206, 236343118.1856707, 848093628.2069998, 750008680.3811567, 804038167.8146204, 840379776.6204852, 972688629.0378965, 1448982578.9695837, 429444704.37059844, 412431585.02788943, 434518786.68971294, 1008334016.9996747, 1695907188.100486, 660782993.5688798, 184673698.954805, 285201976.0757921, 514454245.7544175, 611500862.000953, 670071016.2144682, 873568617.3976842, 710364872.6824515, 1529730976.716276, 568133617.605301, 504913573.6345828, 1121842760.9550116, 321549859.07467175, 1067284277.0137593, 906485476.2738773, 783439128.585052, 2025172884.1409154, 587540054.134934, 2567196308.963082, 748017467.4431806, 384332082.8043735, 889567205.5844517, 439437343.0699203, 541702957.1030325, 1071689550.1870021, 1170628636.8565881, 587554585.2219923, 1480107140.8518643, 1619809674.6047668, 1873210513.3550718, 1153788143.1065767, 1803897845.9648342, 250531786.16801435, 707738452.3264785, 503399649.02169275, 915232041.546188, 606336768.0674905, 774815061.9804122, 2349477722.5723863, 773182631.1951962, 1081802963.7466846, 744975907.3886379, 892551488.5499389, 857198412.3863155, 1102894712.262784, 1626476735.3363235, 2087095508.7943132, 1020216477.2191671, 1192795103.372544, 418269418.5196479, 811417481.7611637, 1443281943.7838292, 1386779736.7387743, 964983458.3209015, 1402117142.7100885, 1129291393.5210671, 1656682802.0770507, 1008586760.8439542, 691799951.9922026, 1035434057.2767186, 164614033.05689386, 1063213999.1955956, 135602312.88334224, 281213093.2253473, 1105017449.6935425, 1121002112.530037, 415062874.0040647, 555413729.7612932, 1810564032.4103177, 639857742.733075, 2769650344.6318984, 853247588.057553, 1078320353.187936, 2054926830.22355, 921465463.6729437, 461235784.74814105, 801059614.5105884, 836644118.1335797, 362045324.5306298, 734572955.3601589, 544984375.2603017, 1431007779.0244472, 871559468.7517201, 722815644.5231154, 802732810.7275311, 971338432.1050174, 1210846098.6259315, 462027714.98551846, 449555161.7400828, 1575265463.1970956, 668465617.0673763, 349299214.6971204, 1100119724.025688, 1112192143.595865, 322665234.3401058, 974864069.3569747, 1292190979.283894, 1058149353.439435, 1220986374.3052087, 352342327.2160297, 1032633570.4165858, 714270736.3198113, 640343869.1764643, 1390211618.7458954, 1915148306.499607, 2248188567.726853, 1758888779.8131356, 801056442.2361678, 1045330167.0883464, 1314339701.541848, 916260699.133754, 921326201.6545137, 1355531515.2184718]  # Truncate for embedding
baseline = 873290340.3
mean = 972499470.2571281
std = 567614191.4535311
p5 = 291412330.63901836
p50 = 847674398.964348
p95 = 2082162095.1488566
display_name = "Years Lived with Disability During Disease Eradication Delay"
units = "years"

# Create figure with two subplots
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
# Handle edge case where all samples are identical (zero variance)
if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Mark key statistics
ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {p50:,.2g}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {p5:,.2g}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {p95:,.2g}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {baseline:,.2g}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---
sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Mark key percentiles
ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"
exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title
fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark
add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from
output_path = get_figure_output_path('mc-distribution-disease_eradication_delay_yld.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 8.733e+08 |
| Mean (expected value) | 9.725e+08 |
| Median (50th percentile) | 8.477e+08 |
| Standard Deviation | 5.676e+08 |
| 90% Confidence Interval | [2.914e+08, 2.082e+09] |

*The histogram shows the distribution of Years Lived with Disability During Disease Eradication Delay across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
