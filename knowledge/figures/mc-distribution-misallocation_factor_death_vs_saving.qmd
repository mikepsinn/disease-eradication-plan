```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Misallocation Factor: Cost to Kill vs Cost to Save (10,000 simulations)"

import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Simulation results

samples = [2971.8855366671582, 2706.0593826163117, 2731.7549274754456, 3118.951990243225, 2494.704920720297, 2683.3333982073573, 2877.4653259991446, 2835.110445337755, 2896.04496248755, 2776.612768510471, 3040.392163222353, 3313.2382478577306, 2773.7241946100157, 3251.6751033756536, 3039.5742142409563, 2916.7988345777608, 2840.012443117058, 2698.359265605638, 3053.5218909359587, 2680.614586738759, 2925.765586856772, 2477.2195267284724, 3037.364320622292, 2811.4317683039562, 2886.609822487142, 2867.493296135719, 3032.989347014087, 2695.757027473412, 2858.970431739482, 2897.8694470950404, 3267.7050061528494, 2476.5330711342, 2727.0967485226492, 2753.422065293926, 2935.9092235615326, 3326.2766575454543, 2599.5128149366865, 2474.4566727257416, 2645.1883204252713, 2931.684831796396, 3164.852382434387, 3070.3573362632337, 2599.4458271294598, 2697.8903489842605, 2780.1618972301817, 2983.1942187382983, 3211.96823004918, 2816.1824085477638, 2746.6440542249325, 2638.316980638642, 2986.505102918414, 2934.952559057133, 2444.481419722566, 2597.015622173861, 2557.920322312633, 2824.429152531332, 2839.5681349759216, 3111.1875721633896, 2622.81293652011, 3148.4639086259203, 2749.2588857555343, 2580.3711362254694, 2916.110203354699, 3164.6115230622718, 3352.530328685993, 2934.8659558442337, 2673.6042248191093, 2829.5117227661685, 2823.9831963291845, 2838.5614177644507, 2825.1282162050593, 2626.272855206735, 2309.3704125275053, 2825.315628838265, 2763.49943059361, 3248.9318400986763, 2692.331575270413, 2614.6938009586856, 2992.6464828698013, 2773.410678698895, 2865.9956026327313, 2509.939652916878, 3053.0845108229346, 2892.259485742871, 2712.8972662875253, 2934.7162943151675, 2601.7968814489755, 2755.3131339839083, 2750.7357160661713, 3290.3834461751553, 2991.707594521501, 3073.1701677292976, 2651.495843999646, 2890.7784473295674, 2492.642275019906, 2309.3074877419335, 2816.160002751792, 2516.745271308732, 2754.326493792322, 2716.9923130096636, 2731.404392407884, 3249.8847316639067, 2754.081131515833, 2716.225324018814, 2463.447661831334, 2633.4301180359703, 2759.342263472438, 2747.7858710491073, 3164.0913193774395, 2405.7299464464245, 3056.0712598747723, 2866.8687149043312, 2639.6461067616874, 2531.123542396059, 2866.9811314424346, 3006.6222812165724, 2748.9575110123387, 2607.960236605007, 3318.4221463351932, 2647.422408779136, 2286.1453528895336, 2703.6233110767316, 3222.0481801742635, 3031.351418605811, 2778.8426420794594, 3263.1529720222707, 3018.207698990393, 2841.862646531066, 2604.9048447427645, 2898.832889912568, 2687.1534947527025, 2587.4793245827827, 2980.3401097791552, 2731.027288810421, 2536.393063415402, 2657.7815953855697, 2945.2040218717125, 3074.1476530398295, 3257.7356321781617, 3419.949978594338, 3280.5999301078896, 2461.898954528686, 2587.7956893676646, 3152.239425505756, 2709.32173197754, 2901.8240794275875, 2501.6261142952976, 2842.5230714321574, 3070.152296715646, 2827.935673544909, 3094.7861106439946, 2532.577946138469, 2513.6305837104187, 2448.977156378168, 3141.4884751792392, 3488.690375102242, 2854.719002626955, 3042.4551926657864, 2809.459609763739, 2764.7851351890504, 2888.5958216055897, 2799.42821971179, 3455.695910871161, 2807.4560151897986, 3228.2345682450555, 2613.4563543616773, 3249.379934650316, 3082.8437431969346, 2777.7319544122347, 2731.129697252562, 2779.806942533469, 2780.5013789394234, 2524.610722805918, 2591.8454366292212, 2636.2426282176325, 2935.19247416362, 3334.5941398553514, 2568.0828240473984, 2912.5859435573802, 3225.8308498382858, 3366.8165294021824, 3053.3593743075635, 2765.895882370466, 3190.4476318091733, 2920.285088466834, 3317.1001945175217, 2705.210917758487, 2822.0390501793595, 2391.5213815238503, 3453.4295669290336, 3596.778465645814, 2947.8474685469423, 3047.4231674361863, 2886.3091527352126, 2486.191318962339, 2856.0960044591657, 2797.6189398263145, 2599.1319324980377, 2930.0809051745687, 2797.7009089143603, 3012.233190822544, 3233.31792189109, 2898.189789267685, 2882.6883605381727, 2555.358751937326, 2749.5933976652213, 2571.981141279326, 2688.690577183978, 2415.2358829831437, 2420.5656554589013, 3244.280870243408, 2554.801303947159, 3115.234515187065, 2580.909400239511, 2728.06467690261, 3130.149942671912, 2872.0875155578547, 3024.651265197131, 2946.6533388458206, 2446.1999172658752, 2605.211253724638, 2872.3712549479274, 3066.202510954609, 2478.50111127332, 2743.18561610017, 2858.0917046441905, 3523.1908041408565, 3260.59274232443, 2815.298012475557, 2977.0178021317, 2478.1631656985815, 2989.7265837955447, 2929.376180722582, 3397.574701461209, 2703.1546852520078, 2718.5637409849464, 2325.219064224692, 2609.4330570378343, 2519.0926954056763, 2909.178969401575, 2668.8837980537087, 2756.211411727467, 2555.018584774368, 2690.070707401818, 3442.421113518983, 2565.756935598674, 2576.1205977911204, 3297.077214359675, 3283.5784381317535, 2418.6032363468094, 2849.8763233883515, 3149.354100643867, 3224.207648018304, 2530.8610274707344, 2496.951953915668, 2733.9126037417627, 3243.082031991213, 2614.8932483187496, 3118.3478126219466, 2427.516395453094, 2531.7120712125343, 2778.9803272730837, 3052.0336476490133, 2811.7121755197477, 3144.864777203174, 2941.446613688114, 3153.4089234381727, 3227.893974747944, 3152.030622678643, 2879.2331644684664, 2586.017188031405, 2836.732041729745, 2565.3056801573784, 3329.715111523912, 2861.580998174977, 2670.6604475050212, 2679.1219044913864, 2516.9109840664028, 3196.089364195519, 3042.716113554177, 3037.5203597632776, 2501.3973754123444, 3072.8657273284257, 2823.344463515343, 2376.1924827267603, 2623.1338956997524, 2889.1087747569704, 2854.403326501062, 2929.4128562414476, 2775.3049064304455, 2868.1137883296187, 2642.720046211126, 3274.920699717232, 2578.063174011195, 3040.98926613062, 2833.038746736526, 2563.2637960133516, 2683.5744210610405, 2572.380550560055, 2725.4126415038127, 3332.0547446176097, 2314.2014868198194, 3420.359189638953, 2673.1389030630826, 2611.814641291536, 2485.740150521, 2787.3727992679246, 3289.076352511745, 3266.077199568833, 3158.720492962616, 3315.796633059174, 2684.4270210386458, 3091.9605200668457, 2719.361105827532, 2916.7512341591782, 2889.4705193208074, 2743.4239542675327, 2579.3887325249016, 3162.2931473023705, 2628.579540172831, 2971.3307540215815, 2613.418885607251, 3507.7931463876694, 2963.5963663768157, 3241.7487270921843, 2996.9615544981784, 2580.1544592076402, 2581.9404195798734, 2845.1114197164716, 2639.8075938542815, 3363.51078447754, 2793.288956600582, 2680.2522634108873, 2876.1709599621304, 3166.723540190303, 2643.123624751961, 2521.3814702235895, 3170.2644390977634, 2864.0350538737084, 2841.24377392634, 2533.014493649849, 2659.044905881631, 2759.6645615092107, 3102.9787609181963, 3117.6689411230154, 2674.0542613959324, 2989.617505718059, 3069.847195185427, 2622.1975579922096, 3510.6066631249682, 2852.9373697812275, 3232.6009118322195, 2607.338333814535, 3119.571598712508, 3333.914051439219, 2753.1220406176294, 2557.693403494415, 2749.2804861947557, 2822.256829471311, 2625.5328738088924, 3000.003956303715, 2779.693662363333, 3068.3748960865632, 2565.056861743475, 2630.5310482250493, 3180.2009588861392, 2412.7077936322603, 2563.4304365882285, 2867.8104311672128, 2717.0607840946377, 2681.3699447744225, 3245.1515869233804, 2872.068254477353, 3155.8634424551897, 3092.815655414742, 3503.6437248657107, 2927.4047146123494, 2289.335717923541, 3480.252169398151, 2550.959219524924, 2878.225007323316, 3543.5655647560952, 2419.317433579555, 2536.1906118348124, 2330.361815450001, 2934.311756266795, 2793.0131174919225, 3103.5083368722694, 3168.486144671808, 2637.0482263882413, 2604.194370476676, 2860.9211894103396, 2512.144343176539, 3294.3074034788865, 3074.920580632681, 2870.2803707504686, 2852.738363155134, 2903.9697335420865, 2966.258734227793, 2958.543681696629, 2785.717979018088, 2892.1041552215142, 2870.9413223209585, 2606.538056445024, 3075.3788771997893, 2497.3613887004394, 2998.027964489933, 3281.8627704359064, 2382.8496665741054, 2585.3233482428423, 2732.6575883656747, 2524.881378542307, 2603.394359507468, 3000.0069104795257, 2802.4235202934806, 2775.4342538056176, 3055.0293206997335, 3242.845888525388, 2729.8558531685144, 2983.7332264511133, 2575.0769749218143, 2622.692678422315, 2915.2021495791355, 2562.980592979303, 2434.947413168815, 2614.318849607399, 2992.6480634286613, 3653.77286305368, 2804.8960461663855, 3274.044090963945, 2592.7019040781975, 3298.987835219195, 2678.0321515767455, 2409.120173521262, 3284.657660441815, 2724.55043297581, 2753.43809128982, 2301.236230660238, 2509.38095403316, 2936.456668779913, 2665.4756976111826, 2702.088942648816, 2826.0597073900217, 3242.385652726583, 2879.201829892361, 2245.8571389420936, 3124.0835382791356, 2726.1623870655953, 3183.017965470453, 2749.427706588191, 2620.6645720626625, 3188.7879571686217, 2963.018880850755, 3274.2685054020467, 2777.943873946653, 2818.3901653564335, 3003.71599191687, 2700.859699368208, 2996.807230740151, 2797.7958425505585, 2807.0981832136426, 2580.896441771762, 2489.97616475847, 2415.1528029343904, 2654.965667041338, 2902.845175940133, 3048.3319315602052, 3700.400356419234, 3074.2015099621876, 2607.4670243401756, 2894.6580760497877, 2695.546213481724, 2716.11593571415, 2881.907940383527, 3250.880197081726, 2798.8331942642067, 2923.747145303275, 2724.55680025386, 2872.0324387955643, 3553.884920476093, 2946.18332013458, 3281.6370485094885, 2928.362436611787, 2716.2050476180916, 2906.643899191465, 2667.348303523173, 2552.863665625227, 2947.6850411338755, 2918.877378612481, 2841.0432976615784, 3123.5564051664146, 2883.734743493968, 2936.154411669448, 2902.85624574912, 2790.65598846778, 2915.6274075499, 2660.8524425545497, 2526.729885023807, 2586.000998551641, 2531.90903546708, 3273.314033241732, 2843.549781780494, 2596.007559852029, 2646.1105866513803, 2840.740740740741, 2671.4257091213335, 3622.268554637283, 2974.2524588422466, 2676.030939583364, 2882.800655319037, 2483.7678051491516, 2880.370456534092, 3007.110943568864, 2612.0233189388587, 2958.032711336175, 2749.0892940762287, 3025.0571343742104, 2598.075323601968, 3149.7536032062635, 3346.086868091492, 2300.7638799543693, 2311.3758671999485, 3187.0943337882536, 3019.959991274238, 3107.417094259343, 2628.074104857024, 3437.9937496322796, 3026.683799686972, 2740.0931234589552, 3396.3996081082546, 2611.9724533668054, 2506.3115783137837, 2562.396460219571, 2748.468219349819, 2500.3262511455605, 2778.0120690526946, 2718.0227947143244, 3168.5816863314917, 2521.4608549379054, 2555.43675265255, 2367.106664905247, 2456.71530271349, 3206.9085404479874, 2749.173256315172, 2724.545838434151, 2639.8339634335557, 3163.478666104819, 2483.3062646048334, 3074.0227931036643, 3099.959839595011, 2956.4176277690067, 2753.6720909152214, 3040.9051121246753, 3302.947570344084, 2963.379846721389, 2641.738740635148, 2626.5872012444515, 2659.0091240085485, 2767.0727644590506, 2715.591413976945, 2911.278475284821, 3061.8223502715505, 2711.003744953803, 2791.456596178921, 3030.2171361978053, 2990.098097534141, 2803.179885129119, 2602.8055174697347, 2811.5922141737587, 2882.0890554875104, 2464.2946235766235, 2765.4703451972805, 2883.585672073952, 2317.3267630642804, 2834.756963035744, 2757.363837531491, 3483.9730592748347, 3175.1613586383514, 2765.363050329575, 2589.723511737607, 2461.9629378447225, 2673.2189020809487, 2688.379333233522, 2755.702859956343, 3232.013865264317, 3288.3043875882763, 2565.5608011959466, 2907.413695565938, 2667.824160943503, 3181.188308213101, 2326.560449861737, 2752.056661551475, 3681.6074038118327, 2412.840884087576, 2272.6339712123063, 2562.424922176092, 2459.796715029102, 3085.63173891287, 2976.800810628702, 2596.5919388545212, 3099.5044444199825, 2474.542242545309, 3249.998186166548, 2645.196008941235, 2859.608834949437, 3132.4682916632532, 3388.436044232336, 2794.384070052353, 2312.2629365082653, 2890.4015906885093, 2554.5667612502584, 2777.8530602058413, 2375.1162484682086, 3010.2413903543907, 2545.596926488152, 2420.1410725634387, 2798.287230525161, 2567.1886128412484, 2934.3861973319667, 3514.2569612443003, 2864.974049501556, 2940.2479457528916, 2802.615493383369, 2774.9850029998506, 2770.790925142321, 2708.0675430506053, 2595.194397154477, 3316.6357525156513, 2870.851567585606, 2398.080153416676, 3149.5903389887835, 3456.0155738127696, 2461.922834653529, 2280.9613804462824, 3062.3502574353342, 2811.2957712264374, 2675.439287992109, 2551.4673240317948, 2902.487887801859, 2992.9967029700024, 2425.0512379341158, 3001.876679885805, 3589.9372429066784, 2993.2880758269407, 3038.970576615261, 2863.1482432903995, 3004.403781679574, 2739.8873523455345, 2835.8529107929758, 2424.6463035127654, 3494.947353699727, 2831.14799759283, 3262.4443762536594, 2708.6738389469815, 2912.079262826394, 2600.046778374856, 2765.8865287632693, 2764.7085398501267, 2984.6902736032143, 2449.538385120899, 2591.4631198206357, 2479.8856295313635, 2837.530166553944, 2682.1441690938013, 2966.9352938342245, 2526.6110653500828, 2761.5672352226525, 3036.2368705266144, 2929.350333053222, 2459.3911206582907, 2791.5031956795506, 3102.447651036814, 2416.4333948417575, 2654.3337626761545, 2876.315706801138, 2977.514544337003, 3833.625423530786, 3077.3227383912104, 2897.0166069522356, 2867.1201206570336, 2960.8152482898677, 3345.339389082621, 3032.226952139714, 2677.082396712515, 2822.208648236815, 2770.5595950613215, 3144.6440433737594, 3127.851640564438, 2668.3428185514063, 2896.950489679805, 3091.0558107395, 2836.258840535223, 3394.0762048228175, 2719.6561311308183, 2773.4661339090267, 2398.813709985883, 2608.3758501287584, 2617.1660139598316, 2886.874166250284, 2399.8726856819285, 3104.6952303545204, 2783.576894175065, 2409.4011694799447, 2665.090636020171, 3460.2202900864067, 2665.297689473645, 2903.0945767898984, 2949.8857742584296, 2555.1973741008414, 2949.102085566639, 2742.485817866308, 3167.6387456924053, 2687.990436883334, 2925.9631824161957, 3096.29731746475, 2776.413521848367, 2357.450283712764, 3230.987144688637, 2744.254246604117, 2539.2625563466095, 3096.0462239030085, 2975.3506502543714, 2712.0838800678516, 2623.482418369809, 2453.930717295943, 2936.1755511490555, 2891.914296674303, 2626.6101819239707, 2761.4925575691436, 2619.0375209280096, 3265.4086805871416, 2901.1218768674416, 3315.671872184255, 2681.566300678217, 3005.8324760204346, 2803.551490260211, 3024.5131057790995, 3072.513044954128, 2533.092488928812, 2435.88951586721, 3206.296488065052, 3161.9109057339224, 2375.8333058363373, 2238.121769281326, 3088.094887689113, 2742.194674690373, 3265.610640541065, 2734.9243945233075, 3050.64720924763, 2704.836239302056, 2896.143644873704, 2620.34793665444, 2375.1293102779373, 3472.7992140378615, 3291.342673435121, 2951.2913916088874, 2430.607110943432, 2870.0733493646403, 2806.9374427332195, 2841.1565798134593, 3236.5825415544855, 3105.881474999943, 3027.21198575096, 3031.717150738542, 3031.4547961781695, 2195.346034350612, 2892.678039460913, 2947.1793875462718, 2192.1078347650796, 3232.282311482603, 3532.581839688571, 3159.6112515622326, 3021.649360721956, 3256.0604931603275, 2646.337154452392, 2724.998584253146, 2855.1077997582715, 3110.1884847354318, 2828.16770291086, 2487.8350590757186, 2683.5286490726016, 2884.2555014735062, 3158.2701508606974, 3011.36610541173, 2726.8631762817636, 3052.6095161571066, 2816.6010636031, 2802.9751757307304, 2393.200869575028, 2684.28460912923, 2668.069531214763, 2312.9696933851756, 2929.919045467264, 2934.7949480159023, 2277.206314241516, 3003.8391741226064, 3180.1840538229994, 3094.939146717443, 2988.2899571419757, 2591.776456186665, 2791.722769193215, 2490.414827438751, 2696.83023168038, 2807.1026990273967, 3272.090490371948, 3182.3703807566626, 2624.0625611123105, 2744.511621722325, 2530.055498188168, 3176.8778175612156, 2813.4349479945827, 2617.5783896125076, 2853.5573429176793, 2714.1437120500427, 2766.250339571564, 2640.2497377729314, 2602.3918727409723, 2905.450873861776, 3150.2047526284496, 2763.943568562216, 3020.0128588389553, 3456.39935480588, 2423.0078115295764, 2537.0565772140253, 2665.821884971764, 3034.3560690860527, 2802.883936013789, 2895.233064524501, 3071.9310022856234, 2336.6031154975144, 2916.4265799682094, 3205.3931977902485, 2475.3875080690477, 2831.7545842540317, 2598.614766311986, 2671.9791034850537, 2889.2646622375228, 3574.5791385797784, 3287.7069959532596, 2980.620158869011, 3396.062106453653, 2893.395329827212, 3269.8167428849947, 2831.036033408833, 2825.305504172274, 3134.258450792987, 3293.560090308779, 2817.9848375994807, 2561.9202425605076, 2984.3883224416804, 2646.4835856460136, 2679.517689069653, 2985.3587239782655, 2811.4539851037507, 2812.592028136494, 2912.5592196571824, 3257.0249488359864, 2985.6456695865145, 2418.6704049062937, 2665.8241198659284, 2884.1185699143575, 2545.8575609215086, 2786.34590079653, 2525.791136233754, 2633.584157886018, 3086.6066480536806, 2437.273799749832, 2519.886175273181, 2470.0929016593855, 3143.5777552720483, 2924.598370561122, 2491.9773654263117, 3038.2324259215566, 2842.2220089949606, 2282.7036845883495, 2660.782653954169, 2793.974744491858, 2793.00151975215, 3112.025338282211, 2615.906865604677, 2759.3412864284123, 3159.1328358963333, 2720.8328602667107, 2451.5485358591277, 2472.298791850737, 3033.613566094568, 3526.775975871078, 2731.190660137813, 2428.4667472298215, 2309.426054739846, 2594.276994312446, 2846.1373817266385, 3040.3527571702275, 2786.3661600153373, 2762.240182495635, 3476.7904846344736, 2709.914516451858, 2647.8827452228707, 3280.715557788651, 2502.895359704027, 2770.202220180147, 3109.253028812829, 2549.747024309233, 3479.5531869995834, 2669.2182950683095, 3376.0735726507123, 2715.4534794989845, 2506.056411936771, 2772.2908288973026, 2641.525301640678, 2571.13056955254, 2644.1738584837312, 2982.980580429017, 2853.6394425188682, 2791.937860495787, 3145.5292039617816, 3121.8755653235175, 3169.7989355774257, 3143.066403223062, 2611.0697581041595, 2869.7064349965212, 2732.589677948795, 3192.1410230046504, 2644.8405425643437, 2797.543096608809, 3425.338359167411, 2802.170416080021, 2896.130443105904, 2623.421769946145, 2853.2552400498985, 2599.571003529202, 2643.1749512952388, 2950.1665046448275, 3408.60730977707, 2958.817883119568, 3129.6163230999286, 2444.437241515064, 3016.866956344127, 2856.9278017667775, 2883.0983205894786, 3097.6260242476587, 3108.9315614394695, 3102.174044608087, 3204.9387666054363, 2810.4992130789788, 2551.5050820979336, 2640.0195412891217, 2840.740740740741, 2677.732726378917, 2815.060449438915, 2472.9295436707516, 3005.6476566324773, 2999.6623075673997, 2644.544067023318, 2524.0496146538635, 2848.0193763980074, 2609.46317411251, 3544.812606610197, 2655.5450009181563, 3165.6846586309034, 3228.346613449764, 2677.0097554118774, 2602.5564589094733, 2883.9949962565947, 2918.8586044026333, 2166.315076210684, 2371.521604347311, 2835.538749862469, 2842.677866891911, 3047.653468804851, 2981.4601816467484, 2612.9217843916263, 2721.6107518412855, 3150.8367827661314, 2513.0047797286757, 2816.5751278521398, 3490.8030286452395, 2542.2668209242647, 2386.77285178704, 2969.831298360885, 2630.386725950001, 2247.639853764659, 2739.550244123129, 3379.8400709121224, 2979.651993329233, 2887.8130936665425, 2358.864996327853, 2722.4409777645474, 2653.7606547702303, 2600.699950908354, 3028.284321388398, 3325.9066989832, 3279.9652016321425, 3357.145862019988, 2748.4106654969705, 3261.898177668709, 3203.815150197148, 2904.2297192936217, 2960.3380383208146, 2956.9365493905607]  # Truncate for embedding
baseline = 2888.550922140456
mean = 2859.139636315566
std = 291.87990870250195
p5 = 2415.8533708904883
p50 = 2836.1388827122387
p95 = 3379.325726288359
display_name = "Misallocation Factor: Cost to Kill vs Cost to Save"
units = "ratio"

# Create figure with two subplots

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---

# Handle edge case where all samples are identical (zero variance)

if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax1.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key statistics with formatted values in legend (use format_parameter_value for full units)

ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {format_parameter_value(p50, units)}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {format_parameter_value(p5, units)}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {format_parameter_value(p95, units)}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {format_parameter_value(baseline, units)}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---

sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax2.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key percentiles

ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"

exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title

fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark

add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from

output_path = get_figure_output_path('mc-distribution-misallocation_factor_death_vs_saving.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Simulation Results Summary: Misallocation Factor: Cost to Kill vs Cost to Save**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 2.89k |
| Mean (expected value) | 2.86k |
| Median (50th percentile) | 2.84k |
| Standard Deviation | 292 |
| 90% Confidence Interval | [2.42k, 3.38k] |

*The histogram shows the distribution of Misallocation Factor: Cost to Kill vs Cost to Save across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
