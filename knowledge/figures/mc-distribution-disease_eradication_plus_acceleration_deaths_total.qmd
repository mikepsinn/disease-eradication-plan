```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Total Deaths from Disease Eradication + Innovation Acceleration (10,000 simulations)"

import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Simulation results

samples = [945455160.9590353, 743253232.9202484, 1016849306.4366862, 1047962013.7590388, 617510719.280617, 706133796.3257971, 917727397.8955468, 849621276.2953492, 895307530.7640669, 770178352.3867536, 1037908691.1990521, 1021299343.4846828, 908118680.8402505, 1078897339.3941393, 971277748.1903882, 769272190.0569469, 955577752.1540862, 754887341.5809016, 1037753254.5223074, 890205335.9395956, 869545278.5420986, 795306449.1100743, 1094837245.0876756, 874172160.116523, 832772795.2568605, 844211229.7270222, 981637234.7564182, 955053919.0863714, 962556508.0098572, 965432805.642466, 1253671614.429965, 836055876.6266446, 820248883.4038395, 775883247.2636577, 995081525.7520181, 1079185994.0812218, 880378169.8018808, 772048640.1485273, 774325959.4841276, 1000665682.0674379, 1015679264.2904425, 983375518.9164807, 797573523.6016247, 934039643.8424923, 915990250.792133, 931926266.1372837, 1036601896.1011342, 932695757.2107064, 1005244416.4235084, 908358874.378953, 942996244.9569162, 997549669.0401925, 684547511.5746667, 849103851.0844706, 826488160.1661016, 801495157.475213, 855833887.4616514, 1140947264.892127, 768324412.6694834, 1052530493.8286895, 653578799.0198727, 846809436.0039607, 923173284.3539882, 990291316.8544848, 1010479319.568844, 1023834810.4785991, 844724402.7088827, 827685581.2330405, 1034397457.4918821, 868563939.2222362, 709850291.4938856, 729957881.5980277, 760569688.27441, 976012382.2878996, 920000882.3899813, 1007117802.12369, 832933760.5791844, 922515348.8180048, 996630743.1686944, 850662372.6668558, 969566136.6092864, 798100793.4132413, 842567950.6824794, 839759415.7690636, 721097765.6266251, 974384469.6996974, 826632979.2839086, 899829884.1249017, 973390247.8932972, 967933841.6722808, 1003056120.8541074, 882747437.783026, 833525875.6108052, 885626700.4146032, 652971858.8378618, 685938456.2506748, 703260493.4488026, 749374970.3149767, 960498153.1270939, 762587471.6980176, 840296555.3411831, 1107736121.1161597, 843589533.1814647, 1014746728.6386547, 758526338.0939128, 866412538.3842769, 756162761.7609512, 846184303.506719, 1031505369.6509117, 647545769.5091835, 966006101.8091048, 934914625.5580661, 808098970.1701467, 686084578.7390504, 909064919.9391925, 817683958.0301049, 934120450.4029433, 901276476.4096372, 1159253835.4268224, 861258356.7586088, 745612425.0944299, 925755226.8083376, 932131370.0335689, 1117866230.663414, 1030655324.9049466, 953696386.4942886, 1135550022.9390414, 722097966.0841167, 801366381.1806173, 759541830.3158677, 838547250.9041991, 695723116.7481256, 998172837.0040946, 863860298.2073393, 682658771.7390808, 746746587.5212319, 946843113.3327459, 1031148498.8374147, 1228013731.0625067, 1379987367.0152917, 962822994.5523224, 750481303.6158844, 593609991.3404012, 939625701.3417863, 776004240.493395, 834715471.8679297, 805446591.8496813, 876271116.9452382, 1068703336.0745127, 922282550.353362, 873545352.7734963, 743872607.1916472, 654692308.9872987, 824111302.5974123, 889612079.8475848, 1187972068.5890007, 918106653.43673, 1054917695.5866338, 822176152.1821426, 722638009.4034423, 753990488.2420948, 788808313.5906363, 1251328933.464689, 774775855.1816705, 1031207816.8035564, 762956202.5911354, 1046481575.1464967, 958145829.5854391, 873850223.2757095, 891615566.9471843, 799151443.1844987, 967860735.2867453, 828786205.1242071, 716896647.5509384, 709534184.5430444, 924709793.133363, 1155355866.8819823, 922742050.4850367, 879659896.5522758, 942477415.610823, 1108878520.9184685, 932035065.8315005, 835379405.2054228, 1075406159.426979, 965104330.9735652, 1147926088.2907808, 926374303.2878137, 717056904.9903063, 696911491.7122464, 1167717475.7267256, 1180291722.7159307, 870359574.7001911, 839541701.6170688, 1135233302.8215518, 733687568.9490634, 764141558.9088265, 999492375.2381028, 837827471.8424476, 897109353.0162693, 872811490.5387102, 950643734.7153939, 1126054165.3923821, 911930782.4999322, 999591177.990921, 604376229.3613719, 890391117.1517086, 771602391.5739738, 717854498.923413, 766539720.206031, 846924232.016099, 1043903627.1593974, 702743860.4327571, 902634486.4277686, 824430110.0604179, 847896761.4667938, 1058226034.2656518, 982567718.9201131, 1114180350.2940304, 874175794.8791511, 793101680.721198, 863611685.3829111, 935662247.7867484, 925332744.0547235, 736913942.3518602, 911916001.3276057, 933422495.766258, 1321284177.5499234, 1206961361.4383945, 770149425.4690897, 853981621.7444266, 683677474.2741312, 808608208.4796, 947173180.2169751, 1092038873.9757147, 788243409.6240382, 799245854.3043997, 591613714.9738673, 872930064.8018131, 740048292.8752774, 817691875.5490072, 766726724.5677956, 883394980.6606863, 643431134.8268448, 683178963.430191, 1251467078.4824517, 708202967.1068852, 735147879.4774517, 1199984290.1303203, 1379457670.2675035, 724530782.1451412, 841786652.2523227, 951273183.8516809, 1181163738.4211109, 750866232.1165826, 860359709.6646302, 1021225324.1027403, 966060600.9960752, 840598059.6922587, 877336452.9009752, 695972564.8659232, 861437743.6584774, 857159622.0442795, 934040988.2544743, 813848680.1022258, 971920548.6542429, 1059873382.1612443, 922029777.6059223, 952886866.5001984, 906122389.452379, 897913029.9103429, 789345584.237994, 947313554.712805, 882931254.7731632, 1245062631.850414, 1154371195.0967224, 958287883.1345664, 783275635.3805141, 732924320.3575469, 1089574564.1446009, 938845145.0419441, 973293934.6074648, 645208248.4971778, 1045801142.5606605, 969190803.8133175, 733206037.749095, 826316215.0048879, 938997386.2988328, 906015682.7202027, 853257597.677791, 881980565.1253653, 859343574.6719737, 921582321.4336026, 1136945958.400822, 572685270.2154069, 861638640.222723, 925323217.8738697, 944079670.1573112, 841235552.7124012, 643567181.4243844, 949129868.8874592, 1180930206.0398717, 673960669.5699376, 1035356164.8088742, 847768258.4776387, 888452417.3235224, 741407293.5641519, 846874077.8675817, 1107873770.0149734, 989717748.1290033, 1181790196.9701211, 1087276494.2894864, 966748351.9794153, 1183805930.4504673, 966733463.3323689, 1029490699.7610953, 852592477.5883894, 908198586.4317876, 792884288.7430084, 1056048349.6725273, 723577298.978825, 1022042075.6366633, 868663434.3223507, 1086245408.1487937, 1016917245.7195174, 1197146933.0715413, 1013651781.7177691, 668715270.0739517, 887587307.8026845, 724468414.205053, 819350845.3605016, 1143729981.2478127, 998557342.9797564, 792663194.4779475, 747013342.5805846, 902967275.0238632, 718172297.5552164, 796745397.1352478, 946605693.119253, 1083582135.6214254, 993918710.6561975, 581731139.6425524, 945399900.2325566, 909050032.4145515, 962740486.406701, 1161736125.9980085, 602653139.475857, 808549569.5121368, 991044689.0033665, 667405121.3193113, 1137706033.3928854, 955515303.3207268, 1032532291.331141, 811533875.6182022, 1027166652.015846, 1069117098.1630456, 934152123.062218, 934391143.0154912, 940039787.3608657, 768684681.478223, 875241471.2097175, 874478649.1999266, 957898870.6192087, 1057740940.2745008, 740602051.6596982, 878684789.9995049, 1138645369.4856074, 786120951.3232906, 774650329.2033241, 929359144.1667886, 1032172451.7507434, 899664840.6355205, 1112754466.3343859, 1034203882.147237, 1031752728.339469, 985133889.1282254, 1286941380.4595737, 866454511.0167435, 610543381.8384614, 1159679487.655485, 828380447.3682334, 914619920.2960799, 1109477281.3933382, 664574753.2703133, 713229176.9765561, 664709091.2982069, 778742149.6495906, 966835903.6767856, 980336363.5887536, 940973244.5537782, 690703604.6051667, 581113102.1066177, 906308096.6758882, 826278724.4132965, 969982284.4219109, 1008975875.5616074, 919348416.9498186, 1018424215.3500743, 933576734.8572758, 981277643.2632192, 791820661.7097397, 870345520.6848743, 928493241.999731, 1028271630.6719376, 837957132.5204958, 979852712.2625087, 857242739.4137214, 879827720.5573968, 1029740950.0732226, 611929729.8046927, 706933756.6305103, 681085868.2611657, 580340710.4629831, 795698095.2752565, 1016683887.104549, 854359669.7196131, 928651986.7193295, 1072565246.6890593, 1112539159.1918125, 887251619.3637072, 1116918159.7334836, 912170363.5124727, 772449167.1565088, 808061939.6106257, 681313701.4411083, 765095153.6910518, 843325776.7651937, 1025504984.2034082, 1179790000.3277562, 694957665.8678005, 959395462.9355018, 743173174.5127857, 972424578.832006, 877754957.3792555, 633570678.4018657, 1045942414.8056552, 806494906.5430784, 817029118.5146459, 739001003.4214222, 799225707.6645124, 964966563.5961702, 868877698.4587798, 949235172.2892038, 954496080.807567, 1111352762.271165, 845618857.5773978, 681822109.2043046, 1068909631.189856, 847321500.8041604, 1076789182.3188858, 957896213.9995514, 877747174.8830117, 952415258.4791437, 1219966898.0241938, 1242193727.2296786, 908638455.5957953, 922773120.7735649, 1070407752.611097, 771249570.4842032, 949931774.0857059, 893910567.7459652, 946905355.8575711, 773034430.2332857, 666312545.2369821, 601369222.6843956, 732217276.101359, 828234676.3999443, 853103323.1323512, 1217545738.880672, 1075356983.1520143, 754425707.84832, 952246380.41045, 835956432.6792343, 854438369.0141066, 926701395.7814014, 995595891.0801443, 846150338.7266353, 1068349853.3547854, 728729973.0197241, 898878939.5392437, 1335912635.6421719, 932614857.8919737, 1130427372.1726162, 912076116.1970477, 989415808.2721108, 889150611.9148711, 871748908.62801, 780878385.9748352, 965350125.2621274, 770396923.5011644, 1003088477.8553331, 1071911604.205481, 955226156.9872822, 854153239.1802745, 969118329.6082702, 850764076.4162431, 1047135783.5574062, 633503471.7706244, 846700562.2721286, 612227826.9024447, 679307840.8183568, 1118657666.968092, 1040499510.2234318, 789649993.0203239, 678280882.4834619, 559615227.6769018, 815604256.8878486, 1303674764.1684692, 966079412.7970064, 813219175.1550367, 970890299.2627467, 670236170.7037356, 852478755.8877804, 913313003.7740808, 884647077.8013752, 1023420435.5718511, 951761822.0222362, 1003531657.2397627, 794213125.269198, 1040931456.9605436, 1163927279.8252628, 753266780.6587973, 765158548.8209808, 1113907573.4737048, 868557898.7280289, 1125432665.7201257, 830646911.0256484, 1134143199.7672281, 918295407.3327926, 938134323.8123479, 1152889314.0739036, 842761003.5189744, 757444720.6265901, 829745553.0232267, 968858318.1754491, 669577146.1105223, 998547191.1205243, 816305655.4828728, 1082329705.3791265, 578348548.9840195, 779845481.4619364, 653089606.9577808, 774071838.3834447, 936474204.5338976, 870404174.117089, 859131266.295913, 873461387.315713, 929528610.5114292, 747755946.3939369, 1009769559.6778531, 1002616528.3786472, 958159624.2029673, 985521749.7577119, 944146510.6156915, 1234779982.902664, 884494625.495954, 851004179.5690634, 784667835.1143394, 744357780.0364847, 714238965.768321, 764999173.4591478, 887014654.0218472, 950125345.3147364, 905810398.0482482, 782913773.1701564, 1041320564.8267785, 1015054972.3121815, 873390644.087371, 799427001.5629936, 984221262.0208097, 927115636.0709352, 685797864.0456623, 887429490.078028, 938732947.8535058, 763423366.0710853, 927408192.4502139, 684870566.2268972, 1113975481.195294, 1099103888.8727746, 859261699.5678697, 954738774.8205885, 577834063.4234741, 726686544.008255, 853014529.2683553, 738661366.1123955, 1010993478.7165734, 1228113431.903602, 723816281.9276408, 772439701.3449378, 934555562.5646272, 1160859709.2082593, 717352257.3211683, 936689486.075, 1197260720.105543, 657814134.1695386, 709094552.071227, 833479705.9952577, 819007544.315595, 1026976832.4921262, 935530789.2672449, 641103667.2661539, 978931211.3175862, 810557076.122808, 1103560859.065154, 803160039.2963246, 801828685.9926996, 983051223.2758256, 1018878795.3159556, 968183643.1887113, 653207981.9645249, 982554736.1482776, 744065125.8347589, 934528523.0452151, 689180454.9369744, 967900546.9100577, 776927206.9830166, 708874828.4351447, 1010899987.0223814, 935528402.5341207, 805168948.8806949, 1133484670.6784647, 830928575.0693177, 902862908.5151772, 939814813.3261621, 804329000.7380217, 971856370.5225804, 817095653.3111604, 835272818.6844637, 1118451162.7992976, 743167152.2687845, 577740166.1289663, 1160828888.4052527, 1327085913.9721982, 836227683.1578606, 619400485.9543204, 850490618.1348498, 854157139.2435097, 868774197.6483713, 732785443.5695989, 989220346.4629865, 980387532.4346392, 679398277.9850959, 1008529075.8711623, 1237893295.8897421, 924611713.2253468, 846441672.3531138, 876085816.6096894, 994965079.9050319, 647091809.9961593, 923429060.6463394, 838449048.4973592, 1201889096.475169, 871174691.1372594, 1170644131.450008, 734157838.2814202, 990458060.5347586, 947772344.2216384, 767858406.2425587, 925461367.9830188, 1093156201.377566, 848482184.6626827, 652342915.1753002, 895190076.1854992, 763029048.0245415, 845685926.0926015, 885339700.9882537, 650483967.0222268, 662742107.1856389, 973601035.7466406, 818690807.6282884, 572748148.3711944, 1022448486.4179643, 940358692.7932112, 790471451.0654393, 704081878.4447001, 1030769257.3979411, 952506190.4399388, 1296842324.6000535, 963741676.2604154, 958582394.1435995, 872279722.7437184, 1027658607.4408638, 996549284.6574951, 1099738397.543868, 818898330.2575897, 831713211.8943545, 825185596.5969138, 1023419718.0495825, 1141533586.3588705, 828209998.985104, 833304929.4384178, 946932031.6308591, 860286336.169523, 1049854897.4940853, 583029116.0031643, 774002715.0406893, 780450489.9931046, 580776304.9931151, 754203122.1884521, 761189842.6660951, 867071872.7398938, 1076518213.4339814, 860392660.3665334, 744565124.3280336, 889124263.5225499, 1065913851.2338448, 752431752.0548086, 761851368.5372243, 985845240.3131307, 863964634.8336306, 1000163718.2473389, 895794023.2169865, 1008928875.9626894, 743954956.7770537, 896034989.9038916, 865613552.0271845, 718266710.0707129, 669890258.7705712, 1006350850.5743374, 844389049.4183054, 745786722.8490515, 883101098.9075167, 1079027006.8008282, 582077761.7795323, 679090071.8128085, 760074111.4344518, 1135188075.278297, 941967225.5587866, 1019593492.5586228, 728982173.7867332, 731911407.6913041, 968138139.5521481, 906915857.8643899, 984271130.6835499, 869117369.0501789, 941267568.1767613, 922449680.1203607, 1021295344.5983608, 1026063705.1508366, 662166182.8241085, 583177227.957053, 1058058609.4537994, 1089002348.43615, 746024059.5323222, 629688670.2798257, 913244179.4187582, 1046360635.3822937, 1193131226.008541, 979073197.0712975, 841265299.4619517, 764372408.3123939, 899668740.1256337, 852185363.5560143, 746819827.3164921, 1237198392.1653068, 1190968949.0129948, 1080366307.6949992, 760367913.6971798, 1033913251.370825, 998895062.1363349, 967299091.9455091, 1099392175.3613384, 998208365.880332, 1015152723.3720914, 998456077.256802, 951152349.2796152, 639936805.5524493, 910848960.0999185, 813720430.9990983, 709266966.3459386, 1173050153.533687, 1181215336.9222524, 1117871821.0881078, 937660283.5330468, 1116417196.0394676, 899761746.222434, 929436054.443589, 735619833.7756816, 960056343.9328644, 907243249.7895132, 706067567.8141187, 890009772.6858909, 885624957.4866846, 1193125419.4834619, 1040339972.5418062, 899667835.7829927, 936650392.5089495, 904736872.2881151, 866796523.4341016, 737193429.1503464, 874703266.6236421, 785753887.4461101, 713416539.3520886, 978260970.9536556, 959147464.1571585, 639519266.210531, 879040512.4674581, 1057059346.8191283, 1067581552.4033996, 1062045647.581775, 903916295.0308015, 771338932.8828185, 737012176.7876366, 951755444.4275008, 957246537.9667718, 1105730774.0914762, 1074355863.0052035, 877580283.7612736, 714276397.606007, 849189050.8404033, 931697772.2439642, 866922943.3965204, 810504478.9441763, 937294281.2520695, 821481948.9079827, 803089443.8584763, 946517851.0545558, 836719104.8297234, 935914735.7024462, 940489991.5068651, 729086043.38216, 824866748.461463, 1131203504.484434, 725874331.2780839, 595628374.0096933, 629419326.4413455, 902399069.6564234, 902678706.5743518, 879817203.8920316, 1093436395.387603, 569197388.8725685, 959888491.4329938, 1152326789.855295, 730739883.5633308, 840049558.7127281, 784760735.5981663, 764196647.5203463, 848109574.4896387, 1129453075.8118377, 1200066859.890939, 846650545.3669165, 1211901939.695666, 903399759.7933288, 1185499117.4563103, 883542812.8799478, 918228712.4942739, 955058735.6597811, 1395946462.8399098, 1033301898.3645762, 791440614.4545615, 1052649215.0587215, 842751667.6841516, 823598227.9590112, 1042703428.4213505, 902704749.8918018, 941335613.1783501, 900060319.1655993, 950487004.7333533, 964501372.911215, 619383319.3436557, 1003248134.3658603, 751560994.3968587, 686605466.6757888, 888900276.0113537, 910904861.1355596, 793459321.3525039, 1029988275.0324605, 700537717.3084583, 835976597.5085518, 809471233.6386013, 890719041.192281, 941381016.1867642, 747848136.9263799, 1012597729.0336801, 907648982.5678624, 625390505.1440873, 616505814.9163213, 895998793.681435, 864051076.3619008, 881991010.631052, 893583935.6468742, 933003864.3167435, 1049129129.324703, 733110142.5249491, 724473453.7588329, 735640842.8552635, 942964302.6296215, 1098599320.0425205, 832321991.5006303, 574819160.1193553, 650709186.4024243, 773082672.4277686, 813492510.193084, 835759965.3530251, 903864882.03684, 850300017.3695956, 1065941386.2297977, 796028379.7910792, 768833586.2879798, 973091525.5229948, 673715668.8176819, 958897882.2908256, 913791280.2277378, 875254639.3699716, 1156933239.4974732, 803953884.5084885, 1239240172.357335, 863372747.273626, 709663517.2077876, 908721999.6019366, 738074835.2251539, 784926780.1564363, 960063010.3971251, 985369072.8054639, 803959750.1628809, 1055688372.2089801, 1083948947.848761, 1130952530.6836789, 981173308.0853292, 1118584260.7473164, 626881406.6414618, 849370146.9653016, 768154270.6267906, 916385702.8914031, 811458982.1025298, 872397216.1378875, 1207894028.6103036, 871853818.3625765, 962724916.6602501, 862334147.8092362, 909621138.5423988, 898829143.5733551, 968219438.8789414, 1085252387.4977129, 1167108036.9937494, 946228651.2046556, 990826012.7507844, 727463852.0280979, 884374550.0669106, 1047916681.8514981, 1035706939.6413194, 930816647.9624912, 1039056471.414777, 974990590.5306456, 1091109309.490998, 943034021.7897824, 843674662.639468, 950369732.5546486, 560729974.7532364, 957818286.4111906, 537149638.6916944, 648068402.7023839, 968768232.5489422, 972876629.6443354, 725824851.1525097, 790731319.2604147, 1119788820.6801345, 824450879.1321163, 1271738717.7481086, 897603604.4487911, 961810297.5605834, 1161850521.1985407, 918223926.9805323, 748643797.7708019, 881024549.7179228, 892408823.3677437, 697388008.3888041, 858759146.3621112, 786325150.4938135, 1045294259.9373711, 903250459.2653769, 854675604.8710151, 881567769.2696166, 932621488.3389796, 995216045.5303441, 749021279.811918, 743023931.2218906, 1075138178.487033, 835168117.4025338, 690137407.4100703, 967500872.487734, 970617527.0872732, 674393631.2192724, 933619153.1300868, 1014432778.1655978, 956470800.7645245, 997661499.44744, 691884417.6569717, 949610936.7542415, 851678415.7221106, 824635761.1407619, 1036458755.5196381, 1138273273.677217, 1192569971.893357, 1110364501.8920364, 881023518.7358414, 953039382.6063462, 1019513012.0980139, 916689664.9043857, 918182955.3114028, 1028798531.2879833]  # Truncate for embedding
baseline = 897899999.9999999
mean = 902284751.4869366
std = 153798674.67349946
p5 = 654772510.9219596
p50 = 895867952.5990059
p95 = 1166305647.5144215
display_name = "Total Deaths from Disease Eradication + Innovation Acceleration"
units = "deaths"

# Create figure with two subplots

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---

# Handle edge case where all samples are identical (zero variance)

if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax1.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key statistics with formatted values in legend (use format_parameter_value for full units)

ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {format_parameter_value(p50, units)}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {format_parameter_value(p5, units)}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {format_parameter_value(p95, units)}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {format_parameter_value(baseline, units)}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---

sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax2.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key percentiles

ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"

exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title

fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark

add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from

output_path = get_figure_output_path('mc-distribution-disease_eradication_plus_acceleration_deaths_total.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Simulation Results Summary: Total Deaths from Disease Eradication + Innovation Acceleration**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 898M |
| Mean (expected value) | 902M |
| Median (50th percentile) | 896M |
| Standard Deviation | 154M |
| 90% Confidence Interval | [655M, 1.17B] |

*The histogram shows the distribution of Total Deaths from Disease Eradication + Innovation Acceleration across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
