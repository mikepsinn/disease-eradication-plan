```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Annual Savings from 1% Reduction in Direct War Costs (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Simulation results

samples = [80596273056.23067, 70342906659.41287, 70566005155.71565, 86405077432.69026, 59975166602.67104, 69447607003.64052, 76874873649.406, 75284724949.41046, 77637775385.0833, 73012974836.2384, 83178616405.99547, 94447506707.66943, 72789573339.63889, 91881411128.44658, 83288774936.44858, 78277555848.66795, 75280630597.45299, 70066138363.69211, 83722084022.4426, 69180164528.2682, 78807249065.13896, 61679244460.211876, 82818774685.64046, 74343994480.04727, 77266031109.54953, 76536631702.66595, 83008319025.34554, 69484682021.17932, 76019725845.68867, 77578887403.19957, 88091435738.31119, 61476589436.66315, 71144335455.88391, 72146621020.58177, 79028373145.85384, 95009539992.58745, 66040906871.727455, 61653602801.56544, 68071997769.789696, 78836838268.10631, 88350090362.45789, 84522345147.35422, 66311092109.435295, 69677925774.0854, 73020742601.52927, 81061644775.62291, 90275410404.47514, 74401343456.72427, 71252569931.93126, 67435847311.21274, 81184426890.46344, 78981055096.5343, 60716718719.81124, 66071635443.71514, 64645804959.199646, 74856899666.16177, 75455309959.81007, 85713806001.84903, 67235440295.36639, 87620384443.27597, 71677109863.86043, 65436366019.42366, 78400632709.02158, 88349123746.8326, 96042866473.70297, 78877045724.06093, 69046159657.30206, 75068616350.25926, 74250349437.5921, 75408427539.96748, 74660393960.52805, 67373186208.65571, 55506070550.731766, 74608626538.86517, 72346688537.64622, 91796144729.34718, 69792942416.13159, 66425538597.46572, 81336711203.40123, 72895543604.87161, 76278913526.00215, 62911222387.5031, 83700430031.72676, 77489874154.6154, 70562986452.15503, 79042252507.64688, 66329166447.398186, 72087199601.17293, 71603081815.64142, 93418102555.89305, 81281168821.88736, 84583802079.62636, 68220715577.365776, 77437711506.50954, 62465461234.8796, 55799036257.04123, 74306081910.87082, 63291667798.17707, 71812905481.65599, 70768384733.39127, 71285977395.3293, 91749203961.24252, 72156708432.95383, 69943188221.20973, 61280336588.97601, 67422194685.6742, 72346243514.26053, 71910038546.92699, 88303023529.63861, 59375631190.69046, 83959863846.15819, 76417169183.22984, 67820116058.30789, 63866818016.5149, 76474418587.48451, 81838601554.34071, 71714913042.39435, 66272374633.7104, 94532975889.25243, 67984416863.93651, 54713923718.34171, 69944634604.84595, 90584117374.9709, 82439422334.7142, 72410774609.34244, 92285375301.87833, 81769726558.63698, 75322332926.15979, 66510665644.67779, 77571393725.28355, 69582790324.29697, 65926271676.77996, 80830633667.16025, 71228349958.63745, 64056914275.362206, 68548659649.600365, 79525193530.68054, 84592248743.63416, 89205719725.36406, 94606759333.94469, 93010607485.85233, 61244194783.4156, 61553012668.09539, 87812620368.20576, 70485962506.91582, 77853467460.90128, 62569381599.24796, 75556106275.91998, 84309315262.02634, 74898757229.79419, 85407351289.20001, 63889958327.598465, 63215691434.13102, 60476986604.11313, 87280037547.58688, 101831519467.66858, 75971850813.2264, 83205707929.26866, 74298180381.18301, 72480370528.50398, 77169932286.1502, 73895320637.62906, 96136506505.73132, 74179613746.93001, 90950098569.2565, 66888852375.24194, 91818373562.8569, 85041840404.49722, 73028603768.68867, 71159983043.37239, 73159309718.87016, 72833363030.64926, 63358316979.418594, 66098273971.11043, 67725238997.88819, 79157243728.40543, 95240385379.73018, 64572149912.63418, 78293977203.71077, 90761260514.40909, 96698981094.98428, 83858813439.82033, 72620784930.6911, 89322019305.60632, 78483928764.995, 94509446674.64989, 70005033857.80103, 74573463037.7074, 58769152845.3744, 100335404035.61543, 106529719357.25632, 79668669480.92015, 83472848760.6866, 76136434213.63222, 62183612971.5016, 75984363034.10959, 73368908651.83284, 66192250203.209335, 78976391256.90271, 73809893983.08752, 82208299635.6294, 90993578202.95604, 77704915140.72137, 76840715904.38348, 61179561657.58606, 71888908505.96768, 65321484929.09213, 69665222093.45781, 59447788540.52922, 59257083965.21175, 91608290027.05557, 64735081241.02471, 86278456089.64906, 65534499121.38552, 71144788436.82619, 86845141001.86354, 76477762959.7418, 82176416051.72621, 79624413485.46136, 60511663418.87548, 66334542647.56247, 76634985800.78949, 84367060807.89929, 61892527742.720146, 71569413874.37537, 76070693486.20338, 99024950463.20795, 91318121910.08284, 74466544211.98354, 80784199862.48448, 61941415144.9142, 81164904954.4877, 78890251847.72986, 98003914088.2076, 70252437347.23564, 70832790839.79774, 52606143417.58335, 66461138358.02916, 63394101111.5474, 78111353677.5503, 68965608515.68625, 72166567182.30576, 64739943288.3353, 69640534884.74387, 95568411553.04489, 65137535553.61264, 65515270694.72938, 93448281154.05379, 88770739259.8484, 59702637159.607475, 75855837076.5986, 87711452273.89131, 90370933271.12387, 63815514313.71986, 62140851923.78295, 70624370374.03761, 91504935773.86252, 66791088702.90918, 86338354003.44055, 60085383690.91206, 63486153340.18602, 73103354817.55663, 83806418477.76389, 74381580094.40752, 87544768674.03474, 78978469618.04689, 87829020335.65817, 90867274954.79988, 87738926344.70131, 76973411994.26346, 65818647521.69454, 75176629801.28047, 64689176132.15694, 90731198582.76735, 74906227695.9842, 68457040683.497475, 69345978774.60233, 63322922453.63653, 89524370116.08118, 83434657201.29393, 83203365243.73502, 62813721894.39725, 84499095163.83096, 74557555070.91536, 58109167146.9002, 67148843620.1675, 77295771969.99005, 75982472903.44984, 78938136378.57796, 72917675370.58212, 76562421117.56976, 67543944845.72973, 92734777324.63202, 61139632122.87782, 83282266940.83232, 75093667621.51111, 64238302449.8366, 69439103634.42091, 65360743590.26019, 70705948144.31317, 95049249572.25055, 56008201047.92689, 98887169480.84792, 69020662533.94475, 66486079755.10979, 62152524500.268005, 73439649456.51651, 93408253887.33072, 92476598671.0314, 87526865503.3543, 94564082702.47498, 68961404106.3818, 84616591437.9779, 70371270134.13005, 78105595715.59491, 77389936976.08495, 71591555350.23222, 65560215292.476105, 88188175189.11339, 67455325851.27951, 80384506881.10129, 66634034178.32331, 102635764913.82587, 80085283452.9832, 91049418637.37575, 81465402727.35252, 65627680527.43882, 65317810527.81634, 75450962526.46315, 67804225666.241356, 96509221439.00832, 73197272249.7973, 69382963953.71086, 76682768476.29095, 88310724827.72542, 67987352350.89436, 63349966957.12925, 88544194408.7233, 75593623060.7843, 75175741512.78424, 59619239160.6824, 68065540651.477325, 72230876476.40218, 85852421426.89168, 85873113733.92757, 65101925126.21811, 81160561399.42429, 84492476360.95653, 67143563543.13096, 102810374540.48404, 75800394401.24399, 91129873568.05258, 66580811404.303085, 86473679267.43227, 95331800781.09073, 71880933783.02042, 64082408860.39704, 71703158218.1518, 74725130514.37181, 67080338258.61383, 81708156231.6327, 72845851494.82481, 84274345653.03322, 65101041436.53945, 67261804768.17211, 88678161230.0597, 59273383826.0525, 64994462112.99393, 76467753936.38812, 69850561553.05727, 69173576274.8327, 91535850613.94319, 76237664909.43541, 87963148977.99461, 85432547638.55925, 98188433205.62808, 78869716329.74384, 52488508893.71945, 101501500567.1623, 64371796388.402435, 76910302186.2601, 104186074485.57706, 59820539987.7216, 64051041073.773186, 56612192018.66156, 78967872532.76093, 73343065295.00604, 85869617340.88104, 88464276305.98302, 67727896410.53542, 62021560003.587814, 76239446503.1643, 62890003957.640854, 93581704582.3734, 84671685333.98296, 76586821504.69206, 75525465432.6996, 77900302503.29887, 80302273424.29298, 79926221899.21602, 73346253200.58258, 77436990714.79071, 76222920070.58455, 66477242857.50208, 84729490942.08427, 62173395830.24529, 81637306897.38914, 93162280542.3945, 55776157522.69161, 65854852781.043945, 71180778592.69261, 59344746525.80287, 66464675846.33791, 81581075634.00873, 74015780212.08733, 72791022232.9852, 83661861218.47351, 91438647752.97533, 71122933159.39987, 80422710455.15726, 64913691276.87995, 67227231620.737785, 78322744395.99461, 65021455166.03736, 60192397679.47213, 66760274682.17644, 81249530726.86214, 109000468627.83414, 73861488919.45406, 92737876827.9599, 66126971225.5707, 93776969536.61876, 69122891407.431, 58651219847.588646, 93281600315.73814, 71057112375.99576, 72154463037.20673, 55306350562.23081, 62886230950.86425, 79136496238.14445, 68662106744.54086, 69769946583.51538, 74723684167.67992, 91422304869.311, 76989574886.94379, 53506498922.6936, 86562466003.9674, 71072223913.90724, 89007546960.44725, 71628236094.54068, 66879809631.002914, 89296032221.43993, 77244252384.08002, 88342955047.40459, 72954877616.79942, 74518177117.31325, 81524968887.52774, 70166726701.17747, 81590044805.48822, 73774855227.19183, 73990341770.39308, 65654446397.45811, 62369400018.50376, 56212587141.79224, 68436571989.00462, 77884794183.17801, 83546369390.84122, 109497975541.57832, 84453377026.83333, 66670897676.53539, 77486058088.01794, 69911170721.34781, 70669469270.97502, 77034599742.722, 91865359154.82135, 73883261477.2839, 78193147540.8077, 71007679231.27509, 76688603965.28355, 100338505171.77441, 79585348998.96413, 93040232888.23035, 78899117083.58766, 70110329341.87929, 78058338893.53609, 68725668032.3439, 64583588513.96171, 79588485613.8453, 78359385812.28236, 75123890158.67204, 86531323062.63017, 77039186743.06502, 79200318694.85713, 77769247185.19579, 73563146240.07553, 77971846682.6568, 67523891446.81855, 63362921638.75553, 62757229966.07223, 63892370440.52807, 92716262176.06506, 75022346115.38998, 66196202510.43302, 68032879603.28292, 70005000000.0, 69020468999.81413, 103264982795.70251, 80658737887.17648, 69199982847.38419, 76953385046.55919, 62146078277.68422, 77037324275.26707, 82016664465.85904, 66511610960.74772, 79832175709.13068, 71643515773.4279, 82642942118.70998, 66265827953.56559, 87696311391.13641, 95711234125.83383, 55220936626.95606, 55557733400.69772, 89069671949.0987, 82477673726.63187, 85633824738.41696, 67327278404.5362, 99707898469.40472, 82793797797.13611, 71344148739.84305, 97903085288.4515, 66671500812.21997, 62886220315.7169, 64806207017.46005, 71535022705.08871, 62744343507.50024, 72573983797.64127, 70800816087.35478, 88387713655.43228, 59229303854.1543, 64682889020.06089, 57958051326.67347, 60979733447.73576, 89990830234.98715, 71921029240.09175, 70986625202.21889, 67645766451.07246, 88244212273.59052, 62048692241.0466, 84633473409.29462, 85705609504.73114, 79955131914.36494, 71656293646.28786, 83361280831.66045, 90239307620.68065, 80284041602.96881, 67796466528.460526, 67360424726.78937, 68593488152.53507, 72541793128.17467, 70717407621.4922, 78241107205.5463, 84198339340.36015, 70319001541.62589, 73587553891.14227, 82746269728.7536, 81179461201.19945, 74022904955.08601, 66434889689.805565, 74015182218.11583, 77040986813.3565, 61436203467.89021, 72519833417.70285, 77075657608.91327, 55789698702.50782, 75156522056.19888, 72091569749.57167, 101664843576.93295, 88614460842.93199, 72571659881.46407, 65225293363.82166, 57221249152.259384, 69106701760.5738, 69597623812.54863, 72180559995.08566, 91105381421.49057, 90514770605.01315, 65129183791.39652, 77934981212.78165, 68475744000.389885, 88615141109.09729, 56330154270.56311, 71828095101.73598, 110225747473.27156, 59591182255.03967, 54379044399.53659, 64793872728.62671, 60916058615.38655, 85075587288.93088, 80803694512.04434, 66174385373.395096, 85708034642.08563, 61516995164.485405, 91763898037.2643, 68039740162.258675, 76194970178.06114, 87043464383.39249, 97534391017.6308, 73392377920.69254, 55988293498.51621, 77220961857.70886, 64707751416.39687, 72866229552.0999, 58186253812.66584, 82108188209.04657, 64318314518.1159, 59793492000.37883, 73332612007.39635, 64453687426.55259, 79046878709.53802, 102964780491.34021, 76432564135.6739, 79374790939.52188, 73836246595.51721, 72977801780.20343, 72421892451.40974, 70419362632.49919, 66048894587.759476, 94557466716.66812, 76471536740.38116, 55065205177.812805, 87253895199.41345, 96150186481.31749, 60913049941.50387, 52733543579.62684, 84082117578.15973, 74359911078.36491, 69050763735.24399, 64603148772.58349, 77688012070.53648, 81388617226.88902, 60015909235.57791, 81681815439.41403, 102118372403.97008, 81467352593.89824, 83166281293.45847, 76362261749.69926, 81820095160.23416, 71350138324.0502, 75210428429.13277, 59464699911.08426, 101992719631.47824, 75117030338.9149, 92075928981.15666, 70428436473.72816, 78073783664.2429, 65686821058.534515, 72607181339.84604, 72375543766.86794, 80607827660.02829, 60368460759.47123, 66015218859.19597, 61263276198.25526, 75285699213.6963, 69373866304.07521, 80423827371.57683, 63695234852.74061, 72155488091.16318, 83151069788.04971, 78884931456.2467, 57134450322.21731, 72985047180.31723, 85822796580.51404, 59395223219.90051, 68381318608.472466, 76431391059.83064, 80812488535.53392, 112310000000.0, 84818158222.55107, 77563997577.22122, 76519667219.08461, 79930073611.17204, 95717954668.92067, 82576876919.94171, 69231610162.53691, 74788808237.39023, 72806531549.69806, 87511775185.5072, 86424060082.90405, 68879923698.32776, 77664364081.78441, 85370270198.4415, 75324617144.85666, 97824910031.58766, 65918394425.66511, 72899324585.7205, 58773486211.33604, 62162684941.84559, 67033275919.84766, 77129074169.68039, 58322779869.79076, 85726515163.93768, 73277580055.05504, 59305513763.37642, 68574655582.94786, 100605093699.96254, 68830499403.18546, 77738717343.87596, 79625533998.73958, 64387312319.91284, 79549692479.35231, 71593984932.84789, 88468494511.2852, 69671480910.37053, 78814722276.57166, 85444120386.53236, 72897147774.99939, 57580854534.661476, 91061425592.35225, 71776102051.31827, 64136111991.489395, 85480730908.21495, 80293622094.59987, 65662830952.29, 67213878275.62424, 60919719825.853485, 78267328505.75475, 77401189816.90053, 66225681364.559944, 72374317237.48549, 67105936109.743225, 92410254990.26184, 77826866158.45276, 94481682022.35464, 69288513673.77234, 81959144102.88495, 73929502511.67378, 82574252162.07094, 84537231441.39948, 63921201975.19633, 56341271160.51832, 90016307246.08772, 88087805570.02657, 58051091608.92172, 52235970412.34507, 85223749951.3642, 70782685389.39067, 92109811857.03604, 70931882760.21643, 83602428062.69766, 70313788365.76518, 77637823795.81468, 66964168700.20344, 58021932233.318, 97196493124.91243, 93240004453.6591, 79277002993.05627, 60045699525.45343, 76156853437.22289, 73752400857.49573, 75284224764.3642, 91206800452.15407, 85952406926.84532, 82702179018.44656, 82926115309.35179, 82979327627.05562, 51724339014.7759, 77488207321.8801, 79555601060.65811, 51422557370.18576, 90760855586.14214, 103745489929.6665, 87887983222.20445, 82593203281.12987, 91989085334.48865, 67792497368.46643, 70779389602.55736, 75860679197.83287, 86142504951.06708, 74943573442.2063, 62280494984.73612, 69295333739.34187, 77181935499.13669, 87436264086.42609, 81969364453.72942, 70966458710.62074, 83829823205.99948, 74492163027.16216, 74023872921.16934, 58726887518.620056, 69377201464.9959, 68926944018.59956, 55844167891.86224, 78837182746.49599, 79082965667.49997, 54600986522.75967, 81863759582.82896, 88930821568.16467, 85348924463.3305, 80920138571.33719, 65620131130.35741, 73582483234.44734, 62334368192.81384, 69545634825.96883, 73951137815.59473, 92693556085.9388, 88986180482.85094, 67013360198.79102, 71712154213.73499, 63480180332.3846, 88782390732.34303, 74431097206.32622, 66973863460.74515, 75879612096.38258, 70647021120.0631, 72645179887.75046, 67306026664.2868, 66321422851.14026, 77954963135.94533, 87732492844.14891, 72465221469.43394, 82373804287.57599, 100494946222.39192, 59862063784.742485, 59973273584.78523, 67192922170.46131, 83087423946.25996, 73955497781.39207, 77614945032.00903, 84282318994.03209, 52990355148.04112, 78341814649.2656, 89697409736.58617, 61788727262.623344, 75156591955.62857, 66303421259.83625, 69081878371.4137, 77379884705.61096, 105535012572.5855, 93038998656.90001, 80910964115.7825, 96778164998.46548, 77525625073.12694, 92329263773.45094, 75098023064.21199, 74804703628.9019, 87108446362.33023, 89197904064.7642, 74009351926.1908, 64901671417.95422, 80800511941.65509, 68003858452.11633, 69317173064.82538, 80883270780.50371, 74293550515.07117, 74229933801.26605, 78284481945.95372, 92031089257.12938, 81121095104.89197, 57478000645.98506, 67962041636.59112, 76994558865.39922, 64403023209.71383, 73335781380.07466, 62970904060.64691, 67613322970.75759, 85109003700.63264, 60435379411.58736, 63146500816.02867, 61351875689.121475, 87365221554.98172, 78709841706.98512, 62371552038.03881, 83160725324.81471, 75498168700.76462, 53365794577.49155, 65619671981.30078, 73619889986.05603, 73639167189.8566, 86103816662.59474, 66622908368.23241, 72133553248.25336, 88070343171.75998, 70877382664.29652, 60919234576.46278, 61664979152.22222, 83069767751.69621, 103457701286.445, 71288479236.44742, 56090752719.00648, 55903472187.76025, 66157706657.25801, 75696145934.74568, 83188904739.90355, 73300737950.74538, 72463532678.88635, 101296962708.39104, 70505754004.4242, 68176547288.934105, 93039603019.3494, 62838672674.27901, 72459483571.10039, 86062542460.71875, 64119680466.69904, 101473629273.43991, 68952675640.50354, 92766104820.16406, 70623630489.54276, 62946040509.50119, 72731126797.80803, 67941369950.95309, 65264640357.31162, 67380094028.670296, 80971115824.14848, 75970971155.35715, 72779675253.10437, 87414879790.02571, 86222604642.05312, 88557834631.05962, 87182100381.51918, 64969719005.915146, 76623638737.13774, 71357349757.8265, 89352835583.06653, 68012157002.581604, 73804360802.91002, 98413816225.47469, 73985720214.77505, 77516660425.8455, 67047649187.11724, 75930632050.55403, 65954150001.69969, 67286958705.92048, 79201161026.01117, 98401167334.00716, 80071694651.08226, 86925032960.72208, 60650364295.67872, 82380371412.265, 75531875373.00203, 76685281585.20795, 85622452924.2451, 86010603717.30704, 85817889360.73044, 89892913848.55873, 74140355166.9603, 64333359152.323524, 67273497261.865654, 70005000000.0, 68744334231.69162, 69138290168.56339, 61781148256.16205, 81921417317.96832, 81672822647.79884, 68046373287.73924, 63469277868.48067, 74635101524.3723, 66629371672.62591, 99950255499.88336, 68164696565.273636, 88378552406.99965, 90642579280.95726, 68921542064.80576, 66491034582.66402, 77174562294.48802, 78536757416.68408, 50540142319.98236, 57278700391.92916, 75257762487.51723, 74956900010.04855, 83612921245.2597, 80957549508.53633, 66560499984.69992, 70630540928.14209, 87787553852.51326, 63152869459.80846, 74452575630.77017, 101901525962.80475, 64011609613.86285, 58608993684.849815, 80477560065.16829, 66754238562.948204, 53597264551.92495, 71341707007.93507, 97171185661.47989, 80892558407.40343, 77057826470.57709, 57588267598.54722, 70584396471.54828, 68260030718.64971, 66292807603.03002, 82682710935.9053, 94911312661.7258, 92737461331.193, 96287917280.0805, 71866856303.93857, 92233288106.8909, 89948303552.98819, 77937901396.70262, 80161737305.23535, 79765597048.7239]  # Truncate for embedding
baseline = 76550000000.0
mean = 76110607363.1399
std = 11372916064.091146
p5 = 58945670592.02504
p50 = 75109321666.97942
p95 = 96425538349.95354
display_name = "Annual Savings from 1% Reduction in Direct War Costs"
units = "USD/year"

# Create figure with two subplots

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
# Handle edge case where all samples are identical (zero variance)

if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax1.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key statistics with formatted values in legend (use format_parameter_value for full units)

ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {format_parameter_value(p50, units)}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {format_parameter_value(p5, units)}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {format_parameter_value(p95, units)}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {format_parameter_value(baseline, units)}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---

sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax2.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key percentiles

ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"

exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title

fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark

add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from

output_path = get_figure_output_path('mc-distribution-peace_dividend_direct_costs.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 7.655e+10 |
| Mean (expected value) | 7.611e+10 |
| Median (50th percentile) | 7.511e+10 |
| Standard Deviation | 1.137e+10 |
| 90% Confidence Interval | [5.895e+10, 9.643e+10] |

*The histogram shows the distribution of Annual Savings from 1% Reduction in Direct War Costs across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
