```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: 1% treaty ROI at 5% Discount Rate (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)

setup_chart_style()

# Simulation results
samples = [377.99537965326107, 345.7370189022263, 351.17700709369154, 363.02762015633886, 428.4041674282497, 384.87632457733105, 363.53360410566654, 350.8186605045704, 361.07090840169553, 454.6614129748447, 444.7744060005664, 353.21064704934383, 406.80155303363165, 432.94089994025245, 382.0346827990651, 460.85200407275676, 372.6641145931859, 382.75373928863615, 365.04868341935617, 424.47261445136763, 413.12958230098604, 454.8014252225846, 337.3258021126899, 446.25498411321536, 398.71241890701737, 441.00672406861224, 408.70530956850916, 327.9742294011845, 427.4806087094798, 384.4559396304702, 427.12001414317933, 390.76933996383, 493.67402408643835, 385.54883716536096, 320.52136663336705, 421.6574295039097, 351.6105868570373, 361.7249382091994, 487.4477575948801, 377.8050252500338, 398.8421541584648, 428.8967961764262, 461.5381372303971, 388.03142176908415, 297.378132521239, 346.2979390150387, 349.4255912215411, 453.6802961860471, 453.8540223611871, 335.5247852472033, 381.7370413452663, 463.9451411161515, 445.68775234311556, 443.12955430009157, 445.9215368903116, 446.23102637460465, 394.5511596135847, 288.79240435043226, 452.14723380364063, 412.22619843183094, 401.42349921726174, 520.5771058700198, 262.52331549118185, 256.57123659130247, 312.8360762553928, 356.9716826702776, 415.632663301096, 405.98741203842764, 382.3215189956765, 383.3831009069875, 529.0867410420622, 399.1012423510734, 411.3185210525638, 338.46022371822943, 396.4818484226851, 440.5689182859835, 494.3482365197584, 426.60244968106895, 394.66586025620575, 389.3491045912501, 419.6596899244385, 386.2562048807181, 438.2012266768011, 413.3176757436255, 454.64801156121996, 447.6380775579695, 355.73094991674424, 412.4307701531762, 480.0775720631448, 360.0651587149935, 384.9684662698312, 403.26233856710974, 393.8232274096981, 312.7761838942609, 382.67774737584585, 462.43608294664483, 605.3814287956168, 363.0483134119178, 373.5213772563147, 504.88103363973147, 397.4405751208938, 364.3868300862001, 377.42512524006844, 377.4001920903933, 512.1560250716399, 289.8134193121986, 386.74324980052154, 385.4472572789419, 403.4346456939207, 382.03759524574315, 376.8742611271306, 358.0371180640166, 423.4455725995798, 421.5967767189496, 349.6449363371193, 462.77603556963834, 459.17158865508503, 427.4288890420924, 424.39175853453884, 376.42448559791575, 459.7996606639929, 364.5287824978441, 432.8576769614096, 370.2544588339882, 405.1155503071173, 339.4825105824426, 407.58623413730214, 500.6887543054461, 292.2043775281453, 525.92340502711, 517.3181540528291, 372.0102362680368, 388.8017095078415, 477.4125324943428, 442.04980275036286, 475.6666274323286, 396.50852116830623, 341.3301798505704, 323.18696757419787, 362.4842702485702, 373.0754726796001, 433.5974488818903, 467.9459325915831, 366.70823162180443, 420.2565751664295, 452.6715895564485, 497.1206098469622, 408.45382804998394, 425.64630357495554, 314.73937987651703, 476.991914744072, 490.57553302870576, 538.5436034429365, 385.0119957101249, 393.5081344948649, 416.2631024308003, 488.73143956210754, 390.00971803330805, 358.22707687969137, 428.83737339206033, 421.6870464903957, 447.8624569240203, 407.72396506715904, 420.47957154944646, 452.5550970476273, 515.4031015065466, 442.6615820563067, 334.9043735639686, 443.75339417520365, 327.8248670765846, 387.47921201911134, 447.06227605741077, 365.6461671714715, 375.78392786834183, 512.0270764074838, 382.27775193133414, 320.4897138325811, 369.2866946313518, 470.39953893485927, 338.1653797269466, 438.32002687392077, 465.9145170246658, 405.49841633890117, 343.1970765709821, 344.39148645555736, 438.31029079804125, 352.36108050117826, 372.68101588627906, 452.15323977479596, 438.147174864132, 422.1862011085335, 347.4714232723467, 398.0066631704198, 273.97266409673125, 371.57138082803147, 446.1750093941117, 393.3886873749477, 303.1605691286843, 410.9102311932613, 362.27789039741185, 330.0452601142499, 363.5767996362698, 386.37823179150723, 467.39783568972877, 441.79909841095053, 358.81779736609855, 479.0844014546415, 432.2400749298286, 461.65417220219064, 385.75778379291694, 402.0048980978069, 360.25752227768317, 429.6349501274441, 400.3896228874757, 334.05761761391045, 379.70056125006727, 290.95060615734275, 354.4695568625574, 428.77622249033817, 512.5388747856339, 372.58396365540256, 420.2239884875408, 365.410945167225, 538.5677417957785, 402.7392329688924, 445.1376343062333, 273.7250231531517, 293.7753519981891, 422.3210850294531, 366.47623115427893, 466.05039327719504, 402.96401716132425, 423.39857922112594, 355.84007046416724, 425.15457477257587, 403.47541458669724, 440.5960164945293, 397.49620200493445, 464.68267142573643, 337.38452614644405, 416.1909115360279, 402.8225165888485, 541.8956987760073, 493.0599914282287, 331.0777383407245, 540.7058314456699, 442.1668032487326, 392.48266624792234, 386.1787677925954, 535.4686074104907, 420.84956041021076, 457.97643473007463, 319.11651587792034, 500.81824007656405, 431.8766697040893, 393.47566786602687, 366.71845412310205, 487.94204426461476, 426.8032123899484, 457.5508676947329, 405.98028922663406, 412.44529473901343, 353.99358054907464, 418.6315038067074, 395.13412396103763, 317.995157517803, 389.10191305194667, 403.27734631456264, 456.7797047934542, 403.0411354204704, 434.2624711093211, 409.4553484016348, 462.8122639939323, 369.19240195234465, 421.48801094588265, 384.7208473686273, 484.0406180230317, 483.1470231840961, 418.8765138217762, 374.67103177547807, 409.939909394935, 444.7316071450156, 321.0195334572029, 388.3698562832958, 451.3816563897967, 376.39749021803163, 395.9169594833039, 478.0859965037482, 350.73460717050796, 449.16308760701025, 501.0653114203176, 353.1676181014205, 317.1759050713845, 502.02575726895645, 360.11212146624194, 356.6438445082115, 368.6969217274825, 489.77015243940383, 410.8707054421102, 327.6483269778454, 342.93841821015434, 529.6727057994062, 396.0639710965989, 420.2749881586692, 505.01949092136874, 408.33503753932104, 433.27863986112465, 327.2371154267771, 394.30268967148277, 388.46593820582024, 371.60318922696575, 398.78798958318464, 319.1112552263531, 345.52187308124275, 332.12379929784277, 503.0047997864317, 377.83108410878117, 410.96384508077045, 414.78573015250095, 411.78816143356397, 360.35710729033843, 394.63074406130676, 372.920357742939, 417.1359659527893, 305.5092835417723, 455.0025870989957, 469.3374287998362, 373.23324392318426, 508.09496977979984, 473.2871306256588, 402.79176555949243, 501.44314330665804, 480.7299286637866, 446.125432416847, 450.96202597989867, 505.1371302933647, 323.21130528551595, 308.40514708917226, 324.47909072732074, 424.61813411487833, 415.1391704729872, 298.34600406329764, 376.5201585352907, 397.8826303843404, 391.420311353272, 395.8545487325757, 436.46827186906484, 398.0298750927924, 548.6695150841443, 369.06354034149973, 546.5669602901166, 370.0969520500041, 411.03652460997864, 413.2167261377428, 439.1809887064733, 354.1323671761692, 352.9265846816143, 399.30806797690315, 460.5833804853467, 338.2056238666344, 415.0103816044238, 472.012933811606, 380.84100814696274, 462.49214858122247, 519.9746332100351, 386.9303784797823, 465.0966796523748, 504.31080947178765, 428.9863237723332, 372.0366295509423, 441.6765107076935, 380.517273943118, 394.4350572423558, 497.36061259166127, 434.81943642213656, 380.40375006302844, 450.6076577842373, 380.46652106778043, 395.36191248914326, 416.63098801687175, 377.4201279233826, 361.62929478212067, 441.43890478623683, 542.8950806522021, 405.4859868896035, 317.26071123195, 433.1223517113496, 398.2521385595891, 386.3906430605471, 315.5776930603167, 478.0907392447752, 421.8177377285845, 457.9995355673137, 399.0282029003352, 414.3886172154532, 446.24411505321024, 353.18945718164235, 343.47904413423885, 433.3861355017863, 447.13504125979875, 427.9113230659742, 303.0670030294631, 414.8690193054068, 368.03323503106344, 435.05604852814696, 504.30443945714, 446.2076158378653, 374.8875810804731, 428.12248780798194, 395.1508882571114, 400.75911791730226, 423.86642962070283, 493.45009320317547, 344.4858326474316, 452.8727147727786, 431.3076512395325, 323.77501055053, 377.9284625618915, 432.07293411950866, 354.2716012201204, 483.3040633144386, 461.7693343588813, 432.80566650455836, 459.69969465529715, 493.2275921609906, 373.31417167609135, 376.57153859127425, 369.9527915642712, 457.4671408069196, 326.8533261128204, 459.4375484589143, 243.05520859655215, 421.21418672719574, 357.4802431506851, 399.8179727182933, 421.4528070740846, 482.0663644007173, 409.7916417092719, 476.9343787467772, 428.6880385176904, 358.8115243460233, 372.28256331376025, 371.9714029593937, 365.01036882114926, 355.0897507832615, 480.00461391574254, 341.0466717012954, 345.05699420278927, 358.9993523981514, 438.78813794886696, 361.488436798578, 432.05011803768554, 441.31962274991866, 378.34995519937314, 400.90898790369425, 408.40840449554076, 402.1463952963401, 347.2423292908913, 499.2244159493671, 419.61219324879414, 435.252497433099, 430.249745975663, 414.2996316799551, 429.973626066416, 446.74261605854707, 440.0165760082401, 469.0232664988348, 319.32388150310703, 386.622760891095, 482.75933176265323, 479.6747411715861, 334.2673451062192, 390.781649679429, 425.99905042922495, 409.684498809539, 536.4068825717312, 416.41601879455175, 437.3311175616089, 450.6189620450755, 292.48960023704393, 451.8762444625064, 402.80141102509157, 350.2455223719301, 383.565142959537, 409.3572570262354, 499.17083152529347, 420.3053235635824, 383.4432142898039, 469.85359184728924, 373.83620551763875, 359.815224514817, 477.76140870350383, 373.42552290543455, 447.7043946697672, 425.19230619470267, 354.30360399815777, 435.6577139693992, 432.60617108186767, 490.7010128514682, 480.4096277893099, 356.8782087681429, 366.8919595318272, 441.33060796442766, 366.631316280844, 463.9181955100453, 335.46154409870263, 317.1681884137745, 468.7648826548246, 376.76831341061717, 383.2043330608102, 400.69935124717426, 382.47428356213806, 446.0951347454431, 404.87071340058293, 341.5939983205484, 416.69518023033163, 433.70450080143354, 363.2735969182092, 381.54564193779936, 442.402267529568, 434.07627947206544, 357.9913194697526, 324.7580562102074, 439.50960317855987, 293.4391948275731, 499.4375432815389, 416.2782599534853, 437.77873808000123, 364.66692180218223, 361.9405950486099, 514.1041128305669, 467.28074534136647, 353.24446928468615, 346.79601218202106, 464.06735756618104, 379.2916618539689, 469.3085328343998, 300.83516288183347, 453.9781276927687, 441.16579487673806, 448.0830343259949, 326.09273616733685, 403.5955567463393, 395.53377705125195, 368.21985772353094, 393.880971648237, 332.22473486433813, 352.6923054550345, 386.9132080357949, 361.6841108848468, 387.14020223152227, 521.4982961060932, 332.36547091209206, 385.0330374191309, 359.9739296942226, 411.803713817694, 398.535627252781, 490.6655605861152, 430.8664682945937, 509.59330333561365, 428.72737508298076, 392.9808245097134, 353.46898810897306, 484.22236746512925, 364.22781516504955, 412.9268942332048, 502.7236078405366, 501.9754736526256, 422.86656176929, 384.3489217106646, 414.64269873344625, 305.7715917997523, 390.1281219522197, 336.2270467404203, 414.5613947935031, 412.6798464055009, 370.55347079946404, 360.93018133616346, 427.74178518173073, 393.21617125911, 555.7374502789079, 534.0299600742028, 355.4702836434221, 449.8963162459743, 411.44010171444677, 273.92103659015345, 408.32598642939683, 418.2856721097952, 434.97954365074764, 384.4603717171892, 498.3058398174809, 521.107832219536, 385.9558864818656, 482.97317312532897, 486.5875057494515, 375.36262346923536, 486.6156458447213, 424.0197788088725, 403.6306115423166, 462.3569056954309, 403.9834337265442, 468.96017155143386, 446.4474502794417, 538.23265144707, 387.75604301948704, 394.591444044705, 355.8179357826018, 347.82382061423687, 383.9178963328302, 287.7423782719213, 377.78194399472494, 274.3353633226745, 367.6047290597883, 445.71379466495193, 393.4985445195377, 360.2220564949666, 419.9939425712935, 437.7839882487964, 468.70690794163266, 395.0420596881027, 522.4642232906631, 358.7698370584634, 384.7064719617857, 462.10508558180624, 433.6604225458625, 308.2880879446385, 470.10030430038825, 358.8602862788111, 474.795843059826, 443.0425687390295, 398.20274207844216, 311.76788266478474, 405.8556522267775, 472.89406366884475, 379.53589463651707, 414.10290044679164, 435.56250582520613, 355.0499235125276, 346.7629151713057, 418.317464660898, 474.5432323144793, 302.6060625406731, 335.52924313866026, 311.29025549854435, 433.9337981907367, 337.93607205099806, 363.8047403470037, 387.8297922763754, 346.6056824135844, 406.6052565717842, 347.665886909229, 321.96002631241043, 377.93499057268855, 418.1948896512475, 336.22460979326416, 448.2679571440446, 398.4731426096807, 438.6638623165878, 345.1206481047191, 329.6020787948426, 463.25938999166317, 377.59151276489484, 392.16795335654217, 353.1123956565909, 440.1167891401666, 403.5498663480856, 464.6664465134182, 420.63165125022743, 430.5097643669444, 605.1086747652623, 371.9458827806015, 343.3402162918629, 452.17879899184794, 455.71788626574806, 309.15520508271675, 396.5242935041401, 348.27948706676455, 407.63340691149847, 404.9775739067787, 370.7453712150809, 334.9736827179204, 421.14004686175355, 292.24534531278454, 527.0080737776593, 383.6423319905076, 368.0790074256786, 425.10873723238655, 397.5319573525344, 407.020877002849, 415.35530673761895, 391.0877531694647, 350.30518218342195, 461.49099995914787, 504.7146804597301, 469.299484682494, 476.5138401364, 419.88435901020114, 330.2988502533899, 336.4190088300333, 414.4174191745191, 284.97932503048577, 430.14253284292266, 364.5240215638749, 409.03982113291295, 361.9595677712103, 383.2846646699733, 443.39277045221513, 455.1752575786926, 487.18311610429544, 346.86950496875767, 402.32778835927917, 380.79625747096634, 485.0113194358612, 331.67589710860966, 458.5982302964653, 400.23508020398447, 453.73355217959636, 395.4338328468065, 394.87760652121085, 414.4296139083511, 358.0175065146284, 407.0951196248243, 353.83303284073185, 334.8215945660429, 477.1636894266227, 376.54506445025453, 360.39247562715144, 373.0640149593403, 440.9961835934688, 404.2011179144307, 410.361656867453, 374.27858993713664, 354.30998866384476, 407.9066532414351, 349.28434068327056, 250.54150191532662, 410.4125610474251, 410.6953734859511, 473.81644615795113, 394.0214109491178, 507.1970476267841, 441.60743230201376, 490.4848477142792, 444.26230249359566, 413.45822674225707, 443.3964834077181, 366.12050973275626, 330.6624192195945, 362.5764873097587, 463.1638168169247, 396.08419188244534, 403.42878160444474, 435.14633646271216, 261.86882798471254, 361.3973450747172, 348.49611941678694, 314.75273051659065, 343.90576511656633, 343.993196502496, 400.66530117595664, 352.64390134566486, 328.68798801111495, 259.77527021652816, 356.73276485898504, 332.3727384005979, 461.01816164993687, 420.62939879717067, 419.3770520713039, 433.9295603120454, 330.0034558167961, 327.7743530193881, 342.53581564219604, 376.21995594879667, 371.65292995839945, 449.02513195912144, 376.5037018950309, 470.54151846050655, 467.50580523561763, 354.48798857816314, 364.89503912238183, 407.9124386032444, 385.4464397583938, 391.1001184999622, 411.50488606023316, 436.95797098356144, 409.91813372156355, 433.1000080930961, 352.55509957249336, 432.5261539041976, 407.6633278101424, 421.1945303147323, 351.0156876252578, 355.3981579702078, 387.08649446636315, 437.84810662687875, 375.6580957871405, 357.02644209292214, 330.9645333296783, 385.6002375362614, 422.880891190665, 450.67277082774854, 353.0784055123071, 461.6591035748536, 461.8464519295308, 390.6497809646691, 385.5362759237891, 451.1668593618782, 376.1575016891917, 463.7421326240336, 427.56831654256, 444.6083025103898, 391.20728910686506, 426.95717342949905, 364.79780841806104, 468.928961523846, 289.1320123613492, 424.9080522054645, 463.9020407736346, 353.68473944664447, 503.34400394961204, 424.1516422415106, 383.8792871784598, 510.54945293982024, 334.93280930103776, 469.89328630504457, 382.37713492210423, 430.0361279220544, 337.0657715814241, 352.5398172674332, 439.24773314401995, 343.44814555438137, 358.6822817288761, 425.85693221354984, 449.9685352753883, 416.22621398144145, 385.0712277527564, 384.5896590168698, 316.429949883296, 319.40245849641735, 419.479421039826, 345.34467174587405, 396.5602606617052, 426.6693273501704, 403.847547882484, 383.3190472281451, 343.41017201489456, 413.2845867576767, 456.4863505514302, 411.4953577134237, 391.3309411492511, 433.03319121776207, 357.4738496034918, 432.6418235454732, 344.37197233791846, 392.44190149515464, 382.52525146664357, 343.0141144649026, 427.42099342878856, 495.32869420627145, 304.70473958791786, 396.3028209523575, 473.4692948141825, 450.3462452416746, 398.79708551213486, 382.1660735635341, 455.61179486482206, 576.015678995732, 450.5576835211521, 403.921119787269, 469.28587882861746, 447.9356931755318, 474.54239906512356, 397.4946836868899, 417.1381509956656, 511.76764720463535, 414.3886937782401, 509.5095897685555, 497.1586928189869, 283.03706562750455, 349.410926945964, 400.58000693158215, 422.6997271728096, 368.16732413783416, 483.521981936668, 398.8599791095924, 406.33616160374015, 369.94556193579854, 376.5606413606739, 458.6393132096919, 433.54303249966307, 374.1270689207192, 301.88809961733176, 443.2941067793618, 403.4164172465046, 423.0409078740438, 312.7700247111341, 420.2863145756598, 430.37942383613745, 360.9866140074594, 527.789713090203, 413.56894857914114, 390.7862224055852, 421.0140103833762, 288.50511274321997, 295.4009620645048, 284.9011035080626, 436.46332211358924, 472.9130498733121, 503.7707386507526, 396.56896570176906, 446.8213309869174, 442.46792957778615, 375.68461549914696, 392.33753677452336, 360.0013437735406, 315.097973900938, 457.10796936642043, 368.69362743096286, 406.35037914741685, 560.5867709843571, 494.06588594327314, 381.8341002493135, 391.1969529036473, 431.7552194830462, 473.1573468922496, 356.00370803198945, 387.1201943667748, 376.9389201420435, 267.8301780865595, 418.82776447051333, 438.6382454310049, 384.0874251021363, 417.5395883068643, 339.9857586976849, 433.19253347623453, 381.7795029188401, 402.3781333011997, 369.7939439957345, 409.814915927909, 384.15151601226466, 388.6546175440236, 402.62297283425045, 372.829769961688, 372.41652004151103, 463.78669721323445, 359.529658370499, 348.07083876649807, 517.5209392906756, 435.84813035545966, 419.96584418879286, 420.6115755616883, 355.26062343312293, 436.6107965891813, 409.81399389229057, 388.8700019721882, 410.3710357109849, 339.40938416240743, 343.26915553233215, 323.6211800700019, 353.63213497508224, 324.4962168379123, 290.94026804914864, 458.34839138245826, 411.6893980478257, 345.9799126737471, 481.49886315580835, 365.5787027681385, 470.38158654359125, 323.89331034113076, 433.5261663967004, 345.15353602885665, 411.51356458373164, 405.3087346761271, 332.4621476025272, 399.8771426124976, 430.4004206721114, 297.5974846769641, 424.603519301008, 476.69751106252505, 363.94629277291676, 351.7595372296161, 492.6555017073422, 407.2998824574046, 368.51367076676866, 274.15542049335, 373.08439390507795, 342.55094043344036, 410.31406682926325, 542.0960548869023, 431.37911104464337, 403.0199036064027, 355.80380872760287, 331.991261117603, 356.08289821256733, 395.46351618993805, 453.65168939208814, 346.53248028704814, 446.2554359238867, 373.6322644635634, 407.58603015726175]  # Truncate for embedding
baseline = 396.4967613007316
mean = 401.44408779768713
std = 57.44340345899735
p5 = 308.80054938314044
p50 = 400.38749655071183
p95 = 498.50362589958615
display_name = "1% treaty ROI at 5% Discount Rate"
units = ""

# Create figure with two subplots
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
# Handle edge case where all samples are identical (zero variance)
if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Mark key statistics
ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {p50:,.2g}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {p5:,.2g}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {p95:,.2g}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {baseline:,.2g}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---
sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Mark key percentiles
ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"
exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title
fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark
add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from
output_path = get_figure_output_path('mc-distribution-roi_discount_5pct.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 396.5 |
| Mean (expected value) | 401.4 |
| Median (50th percentile) | 400.4 |
| Standard Deviation | 57.44 |
| 90% Confidence Interval | [308.8, 498.5] |

*The histogram shows the distribution of 1% treaty ROI at 5% Discount Rate across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
