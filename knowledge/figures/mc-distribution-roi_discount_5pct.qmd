```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: 1% treaty ROI at 5% Discount Rate (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata
)

setup_chart_style()

# Simulation results
samples = [315.94584350263483, 315.6560624402115, 285.01167529060467, 290.94718716504553, 414.87292993193375, 357.44073426664346, 307.423874441268, 305.47107550967496, 308.2653645543812, 410.0675440052849, 357.9085018424005, 286.1442782366528, 345.41797406988746, 342.7179045116722, 315.90830903081735, 415.82074232375567, 310.17594343076894, 347.6076763540533, 293.7718940827145, 363.1861318790215, 356.6338599866339, 405.6008027539164, 265.3489000865274, 384.46139967726486, 349.739030338461, 384.90774740041, 336.5188494577022, 273.039239136794, 354.7691005797421, 318.6817388379193, 315.91170798448366, 342.2788498589251, 435.4276044357573, 346.84199545429567, 262.45492925592845, 333.7476072743921, 302.11469603472136, 325.97169647629346, 438.81801404391166, 308.65392560551106, 323.8503234493408, 352.8911044725608, 411.19329452840515, 325.89084550747066, 251.66418375591604, 291.09928650892516, 281.32991767933396, 381.2418608046489, 370.08981222433744, 284.8673163244468, 319.4018951860991, 379.51147747401666, 418.1037060463278, 385.9365963465528, 392.23033581081745, 396.8629824738761, 342.62392263958145, 223.10951812549348, 408.14091921092233, 329.77184823996066, 382.1307219620354, 453.84171753280003, 221.4936210661749, 210.50376013428988, 254.5539856369439, 288.8938005887216, 362.6802238167147, 356.9165765612904, 308.0892114752694, 331.09549204566093, 490.52558875138806, 366.6001717224679, 372.58895553852517, 279.3285016132933, 334.964460019876, 358.98187794213254, 433.5974069481337, 360.0288845481013, 322.96199052037565, 338.8674039717304, 347.2669262415739, 344.0423961159264, 382.73355836753495, 361.4430229162007, 419.3280983886454, 369.680831423753, 312.87922861783255, 351.43521758545916, 396.6339966082687, 298.1543192772015, 314.19880773728596, 346.14304212516606, 345.3363385006267, 268.14216052520186, 364.392648290077, 433.53292544047406, 562.9776591607372, 330.5383226350876, 310.25332119917454, 456.92443062780137, 347.47702898054047, 285.183796425118, 329.50353428568803, 306.5562762200797, 464.3610375557992, 250.52005103270034, 351.027730904915, 336.126425921623, 325.48318256031797, 364.737744009232, 312.3228463431149, 300.5893691905793, 375.4962339884424, 395.21911462313636, 296.7666042617432, 408.6371892813584, 385.62530327048034, 363.99076402249335, 325.5559245022812, 326.11479991271494, 419.34344968043314, 307.2217686186534, 363.8303176653715, 288.62758263114824, 326.9516876512335, 282.77990246120834, 315.5455222417103, 461.5794219672253, 259.8916960766872, 476.62439561466414, 452.6304732093194, 347.1682981185495, 317.9622485653987, 413.13996095435033, 415.05822061298136, 433.59029536808754, 331.22762188973064, 275.4182592667524, 241.3821060422429, 254.94841343630745, 309.58362233613497, 394.571434454471, 458.46275936471136, 307.2609240700486, 378.04472091336953, 396.73250826127713, 441.3473732565138, 351.57667285838824, 338.31275208465127, 265.6487550040898, 411.0531526873885, 447.7663721486229, 512.385283216902, 339.00887673726385, 336.7778947372024, 315.8134901412192, 413.2316867687849, 311.7006953795717, 315.6932200725725, 395.24214192532975, 383.12185313019717, 400.57247516967385, 301.8256392187705, 378.45426067975467, 365.15653853034723, 466.36929876987324, 354.9806977513997, 278.4497636439818, 382.3592450572618, 280.3234502015811, 344.9704155599795, 370.2040754379729, 321.29589482563745, 347.2627552069247, 474.77877239036843, 322.3225690064693, 246.22122293861162, 311.62772010891933, 404.3066364011608, 283.0066948425557, 342.89303805521865, 391.6314839878956, 355.28543415088893, 272.0534227903699, 285.510591072397, 337.7067959117447, 296.88941317066417, 344.3698743068656, 421.7259492599707, 335.01529515388864, 321.2594680321192, 299.84908872063494, 348.08679444520516, 212.13054841402538, 340.7291361903733, 403.51112313858357, 321.5396569680824, 265.3356065850039, 350.5460795740711, 312.29582095760287, 275.2693323024383, 282.51693574117843, 327.545927292416, 382.01622127274305, 430.56923121068786, 306.9863225753252, 431.8179966703499, 399.25748651297823, 417.05824424115053, 336.28873380394674, 322.7116090369238, 335.1038000375923, 365.6578540772301, 352.4996498893521, 291.09513979521904, 303.0596953165765, 239.47036145946743, 276.7217115449443, 369.4023693936018, 457.5417430924349, 322.45882847416505, 352.68744002717483, 308.02013313255253, 493.13520258509124, 341.4178432529467, 373.9488959981479, 197.55010288238975, 221.24926529119415, 380.90416860925853, 318.50011123307576, 437.3843830058315, 357.25330576256835, 353.64170784799336, 280.22216885081116, 380.35835512526035, 359.1966511163638, 432.09109779715806, 342.63768442614116, 424.87383633301533, 297.9138333191523, 375.9550163625557, 345.6694213827513, 518.3835374389848, 462.8408156899448, 245.07431686873403, 501.6805440745682, 405.1937603187815, 296.3868851049262, 271.7688068905161, 493.0901989123242, 367.70371494597515, 381.86806295101434, 242.74841960393263, 455.66227263682003, 374.3014315284218, 318.7735009026099, 303.89966388438785, 426.54505456970554, 367.2025055391707, 426.947093583215, 351.6930965464065, 357.95694235615485, 297.30376357173924, 370.28374650612363, 326.65342175941527, 253.64202343359565, 328.44785847144516, 336.0327411780244, 388.1839679637182, 343.715094425112, 388.3152763900188, 341.97561740255315, 397.22678877554654, 273.91146129146324, 323.93781572008305, 319.8497938097943, 434.0036892950924, 443.1983979502312, 330.1845049179407, 314.0356710095013, 338.700646474973, 425.0728104906503, 257.50352951379847, 321.42468772435177, 414.00608306547485, 331.10236552487754, 331.82204403785835, 406.3090750036547, 304.91518460046683, 385.66924366942345, 434.45756988291765, 298.1714364536897, 245.41839889718509, 502.02575726895645, 311.93121962508593, 300.6311862467568, 308.35122338721635, 428.02388927245886, 393.0179295372536, 273.4430414045669, 260.89276544781586, 499.3678097032768, 319.0398556332259, 366.24477153886085, 432.42784970790353, 373.1218431947501, 377.7238370919375, 256.09508956264244, 323.58174422778825, 295.43102280399756, 293.1871749848259, 330.38141019943305, 242.4983863435103, 286.25412930876627, 268.1694547358919, 437.419497497763, 320.8080611469099, 366.90163288558875, 331.3518649915961, 379.3645280834685, 291.84579135486854, 340.79448452255605, 294.3465183617724, 338.5339394185479, 230.96188756321513, 369.75627687288807, 443.58020416714254, 319.70305102618653, 467.8964061824816, 417.61140090841104, 310.84533525737555, 410.0158855962656, 429.22995994511444, 406.6128533694483, 383.7547303910779, 466.5236433826581, 288.0614364214234, 257.6551090206484, 256.382126492039, 347.8591877663234, 410.9188165259418, 249.37701480498575, 319.5793895506739, 330.18029272798276, 299.97622849354264, 386.1173380591879, 386.9670186634827, 326.4623629092851, 518.8794513258582, 285.48273739965737, 454.9306671270779, 298.4630425984903, 363.9383253535553, 333.96107566516065, 349.012844545795, 297.40643115216636, 296.36401989045817, 334.51788619686636, 415.68845892102854, 291.2396125294999, 357.49607475151237, 392.48637192069134, 304.02897337992715, 422.7640478666693, 447.1036541232343, 299.1941685715158, 416.4871388203309, 453.932513404759, 360.99730834919643, 300.07093253775906, 376.3822031390093, 297.22228160488413, 317.87561529685394, 401.22068355460397, 357.50512615537014, 277.96122995362765, 389.5064818206271, 369.6863107347558, 303.2370551581385, 366.16187810984457, 319.587304373866, 282.8322190222019, 418.02980315308906, 502.5412356416197, 383.9590393676792, 285.0433134828765, 358.8131541991658, 328.08794192159246, 323.56974108387914, 295.1948255501251, 473.8040698866197, 358.4440238539072, 402.8911812665878, 330.1375146608995, 337.39385932490524, 377.10972497819364, 286.46147822967566, 288.5293681729582, 356.89341440153635, 399.38418004266373, 369.26662129224616, 255.1276760534577, 335.14645058044204, 322.09591886625196, 358.47926072280603, 437.66474376694623, 383.4861037820859, 302.66791487199384, 415.7139818999289, 366.8467576041605, 376.56651191510866, 420.70240186810196, 439.99164579579536, 279.5999963147644, 393.52161604191366, 363.058858114556, 256.94771464990947, 295.22507767557835, 370.15702046448297, 276.2708125791391, 409.67160990595204, 416.05258050356304, 383.80272559629236, 431.9028454027635, 445.8723649277598, 325.9520708182524, 304.5494757885327, 281.5668529664105, 427.0709692846331, 271.61458605757446, 419.47935834942365, 200.88938897279203, 362.32870918759033, 343.59238012229997, 320.6929166649839, 373.99498281924923, 425.79385315447183, 374.86456712936234, 424.5977844670969, 355.4152178605162, 309.83312017359646, 310.6794380062543, 309.73899263353655, 285.26657883056174, 309.7297420357835, 450.8724131811438, 271.04887286684925, 300.7552831624675, 284.4235351426341, 364.85982149585544, 310.95362252454447, 360.078626453322, 330.7031999242398, 280.97895323450985, 340.33940517983854, 344.6365980122738, 319.41750635136196, 313.03318215090695, 416.49449418125977, 358.45902063378736, 363.5833523987618, 387.55143553382555, 392.0074968455899, 419.66048648557086, 409.93686844825686, 386.7393900331485, 407.77814278083514, 239.5108056606592, 306.48309442585315, 438.5221772490048, 399.7980455888086, 292.80092577320073, 339.5562667802235, 358.88517197411454, 335.3942860867138, 467.77657585893195, 331.02296737304545, 401.94322474712925, 384.1313637229622, 209.99263556961208, 379.7387794783229, 312.46333553289685, 296.8967023496612, 314.80912387410774, 350.4113463555177, 430.49937903382573, 377.2621000626045, 317.85318207955476, 423.72791824869336, 305.10897985320827, 285.6235233789718, 397.70883247644736, 324.51545713570175, 370.5425774649673, 370.04691922528104, 284.0496547158112, 418.74624707582274, 377.1661157585651, 476.41032397580886, 451.7857493801646, 278.1141591047161, 294.92852956735373, 394.58189942767086, 344.9529947046686, 463.9181955100453, 296.48898452162604, 230.35653874871372, 388.46252943460996, 333.34810146379164, 316.9263507201241, 378.4372875688383, 332.6210439583181, 377.94838457301825, 347.2404086567328, 276.4952548831074, 347.3762402643784, 353.9067665165707, 324.1324248684186, 306.65461281370386, 338.7619759042488, 394.50761914577794, 323.6109837655926, 253.55410400393933, 379.56818545245477, 228.0718813118935, 438.5009507764006, 322.4510453095075, 370.1206553395845, 305.7417623867663, 278.33139866588505, 448.9907816968217, 423.88123887677483, 310.2676949737135, 287.05667966196677, 438.4209838666919, 310.1373613629692, 414.65770000667374, 237.81829872269014, 452.35209189298615, 396.1697829672076, 426.6484900354439, 293.5939742581077, 338.6159625080896, 341.31773733578166, 319.3009524837117, 339.4436450904344, 279.55128048099226, 321.3462917362013, 314.9215045519596, 295.24794031149963, 321.8783847361574, 428.70333009820376, 277.9584691182972, 286.6927591451604, 308.7545368502282, 358.3573227500153, 357.1149014076831, 447.74949619080115, 398.6536821165404, 460.6867589537763, 367.32817818349486, 327.8307579301501, 300.4275286793268, 434.23704780232714, 292.6901004664133, 335.3719841125148, 433.2566162009515, 446.8509675328656, 347.8082801882054, 323.74025944147263, 388.75231278356074, 261.9346556860089, 327.00663539278867, 304.1752432932794, 349.14541702457757, 387.0801010049659, 289.3010702260761, 283.43938403052687, 370.89427099678977, 327.3962961282158, 554.3055399018306, 491.27827229871104, 309.06485376064927, 411.6149492476833, 334.7176853341783, 204.57746097741762, 376.1335962250009, 376.87555642102666, 365.2413395445587, 294.7417155559499, 460.38870575972356, 437.1690337780026, 291.7658265609126, 458.82871415300826, 451.28173292604555, 329.1552361472848, 429.43701677744184, 342.71843575471496, 338.7795853283002, 442.7896153837599, 333.0025523238367, 415.40440585504643, 349.9816448373777, 478.33221324158166, 344.80617129673493, 324.7084688145611, 288.5400484215096, 287.98796996745983, 365.53187444723903, 236.831058765146, 344.7852412940833, 230.35509523249556, 344.1063534694237, 369.0813299873244, 353.82757151077334, 334.1191041226789, 341.6894885486269, 367.4459331496386, 416.1727436739883, 306.07977406130783, 458.6614372842045, 305.31559593039486, 322.3158946149157, 410.46385989727895, 358.51225185854486, 272.293043070305, 411.9068816929921, 279.68137748858163, 433.5031024551231, 441.98234902485996, 305.2807543292271, 224.5394693263785, 355.4663635997238, 457.5431284922471, 330.3512319675085, 359.8644336617409, 376.1242678843486, 325.71363111469293, 284.62675545163864, 344.61087673426704, 446.2499310527823, 246.42578428625472, 249.54969072982618, 262.47938008722895, 378.3662994282325, 290.9017119819986, 297.9112103014751, 370.34889709419247, 292.40320177940373, 355.77687317068643, 262.3495581341115, 277.73643250677316, 288.6514745126798, 383.40007849637124, 275.8364338791495, 374.3199669398654, 359.7663960892196, 369.7480117130453, 271.66075546387367, 287.13938503341006, 441.2578995735559, 322.3860514230782, 354.84666322386937, 307.9959708762726, 377.35735004802973, 384.72935124902585, 440.40735460971877, 347.49022671128125, 379.9768105422005, 605.1086747652623, 301.1816220869818, 287.5927035734014, 404.1326640810988, 423.63563284041703, 249.49463878767898, 330.45820433061334, 253.57711136772824, 338.1312491744317, 336.6495921145056, 319.6683590897928, 270.67124040708165, 344.6377897836016, 229.44364262712313, 465.1056325453047, 336.67640588316976, 323.9459587407682, 344.09440283945554, 307.0475329498812, 357.74268719728315, 364.2527000316875, 326.68717841512984, 303.6142255202606, 369.5792156216311, 498.31414554534933, 422.5417186697773, 427.7964306010788, 416.394382825927, 300.0625632253782, 304.6564469139841, 358.1279717558632, 225.80418434937513, 372.7931561249176, 332.60949003189006, 350.1435702344734, 288.01342209416856, 348.4780802240981, 401.4102841949617, 374.1319246313639, 421.5761272358867, 283.4388829134465, 343.417196578827, 310.0490143655335, 442.67108842963046, 283.0813372089282, 396.55770599456196, 369.6243750054695, 428.5949469542515, 322.30607731170824, 344.61981995260993, 377.9353483229691, 307.260172774365, 322.24168085913055, 349.9980300913057, 314.9043863555711, 432.3311309159841, 291.5550559889275, 301.67276808061274, 302.43740966724647, 405.2647995840959, 370.95223934183423, 339.7738828355027, 317.9649794481216, 291.4144256813653, 352.1902282023311, 292.46024585423703, 211.44904163623818, 332.48543807764565, 332.0716762316567, 449.2021239864703, 388.91169221713614, 404.84871175343454, 348.1812170950589, 447.2448771673969, 427.7701750463902, 350.30740314995444, 355.587321698036, 277.214802320428, 272.548244790495, 316.86165561986115, 418.8317514979137, 337.5293666930815, 350.88901146800276, 396.6411044284252, 194.81403385738534, 273.8684038679418, 275.7102293657915, 285.14179270354, 277.1865488765314, 281.2346088155091, 331.86087597621366, 276.90069251835195, 268.79730205267, 210.97652697056958, 291.7023992374646, 277.1516748369561, 441.75474261413416, 356.74549951254977, 370.9642230935856, 402.4123983644468, 251.81083796947286, 249.32942378744926, 267.0192507384574, 315.4907448967001, 289.8820944750866, 382.62864953154707, 316.8222695874495, 431.1027091014532, 388.38977508127306, 301.11015318376604, 338.89420935671063, 349.04617259504585, 330.44241757983866, 296.1292347737441, 330.8121930510183, 372.36074324710665, 343.89514998899796, 368.2772548355286, 304.7045378944132, 395.9884593147353, 351.13323639931883, 377.2353766382704, 324.8962535219266, 293.03490797845535, 321.7014453393032, 419.6369101439948, 322.96271174836943, 285.0953649010375, 263.17534428824666, 307.2987703822483, 359.71321982990787, 406.25765300628143, 323.2788650165046, 384.86125622314336, 384.1370982636908, 305.97922927265745, 305.7435177425611, 388.12318318426344, 348.02889097699233, 403.87380832729036, 359.45000989436403, 384.24282021899995, 346.5390568686238, 358.09299981462203, 321.5821140941279, 416.75446528523014, 241.56236586269114, 372.0732441846645, 389.3044578706512, 296.2412979166707, 462.5388812082891, 373.3477947698229, 297.6949810781569, 469.85285164832334, 327.8200704508065, 452.5059567246737, 325.4698414032966, 365.9924013118786, 289.6871751912485, 277.4700300529859, 439.24773314401995, 285.34632140377835, 275.88569961495017, 391.0366892608638, 393.4440028769266, 372.9513519276796, 348.2415038389901, 335.09728878023907, 245.55595815710203, 241.19198392330054, 365.7295799403671, 259.5917986976291, 337.3983891751375, 324.0200838629447, 346.52703263655417, 324.08677666436233, 285.88912007115005, 285.72502037477955, 368.016904169185, 367.612919359861, 313.0411975475151, 378.1893563829238, 314.83221561795534, 347.4733955536881, 293.08264897220886, 328.5872527174144, 325.92049542739863, 286.1045343868925, 354.43318625136897, 479.25343192896923, 248.67062657384471, 360.4565975975669, 443.73795203666117, 385.5393985713413, 338.22098771662274, 341.10396015960697, 367.80432130416665, 536.3471268487202, 394.6617697683415, 357.96495813855427, 401.4408780491359, 375.04445268112056, 432.3486492403023, 323.1613813354258, 354.26553961394035, 493.75169070474755, 401.49365368186295, 434.8669476831209, 430.1922422766638, 243.02576141161646, 298.5303697807754, 336.57639898412964, 338.6123891986179, 337.6969501002555, 445.2665085864112, 365.42570115925326, 339.98868939894237, 290.57695735685627, 330.37343440408563, 458.6393132096919, 413.27875773494554, 336.9910990559972, 267.0650890451232, 388.3361449715649, 343.16375243986096, 368.24890570751757, 248.87027002636174, 374.699001109479, 388.40252556180076, 298.27942331270185, 497.64996314648806, 343.74629112920286, 331.0215027706718, 362.5464901909351, 221.51373177472308, 262.43297503165377, 211.79231514722696, 377.78331931258913, 438.483899472948, 427.64556319464214, 362.9224692547804, 400.3357464377131, 367.58804105463906, 308.85502820526324, 348.5501135192903, 287.6287936836522, 248.93358970953923, 354.5178142076146, 303.6322099319231, 316.67677157141793, 540.4780039895132, 430.24888995936954, 344.6976290141725, 331.00543648977987, 382.2956595148546, 407.95052842188267, 268.0183564137387, 333.8485593534718, 312.8023156553271, 231.9261946885287, 355.4026633177158, 373.92630962024197, 318.00845642427726, 329.69416839390675, 260.02015855326357, 361.9650084800007, 313.16201349461954, 370.0336436121618, 317.19363619336326, 328.45068053062874, 309.40024134727264, 326.85704456218514, 323.83944971367987, 307.82340691872975, 293.38378347178093, 388.0472427866466, 313.86858923373126, 290.336512931919, 517.5209392906756, 362.42691284455543, 419.96584418879286, 401.4635671918631, 294.0741512520644, 360.79896823628434, 377.1557334374397, 347.510395551197, 319.6595292120434, 298.8104306226598, 252.21846923082836, 276.0218750602152, 293.5727722193119, 248.67607054176975, 245.9833009952971, 417.44335732483734, 353.638037323789, 295.74750385917696, 448.99711197897454, 317.0618386230352, 421.1812114629183, 259.86167855943756, 368.8728822085522, 299.87837974198993, 353.40451985354565, 340.6043510721069, 272.2174685933793, 364.12780515420457, 392.9943971869008, 235.9316182250766, 372.0591779818076, 446.02605062701855, 301.422230370833, 290.95302970770194, 464.3738487386047, 342.13406617327126, 299.37614980255313, 228.10026456435838, 305.1725489239757, 320.2492236509576, 342.363967756646, 471.6011862551161, 379.748167861861, 324.49857517819623, 275.16527976739934, 251.42799171040411, 278.39740380079354, 339.70027964427027, 377.98335090057185, 280.93787727667825, 377.5437592406049, 315.9029566624486, 329.1927562554245]  # Truncate for embedding
baseline = 338.1197615877601
mean = 344.5740426604378
std = 62.57580312369067
p5 = 248.05289825780028
p50 = 341.1554052157628
p95 = 452.9181932855121
display_name = "1% treaty ROI at 5% Discount Rate"
units = ""

# Create figure with two subplots
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
# Handle edge case where all samples are identical (zero variance)
if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Mark key statistics
ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {p50:,.2g}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {p5:,.2g}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {p95:,.2g}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {baseline:,.2g}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---
sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Mark key percentiles
ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"
exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title
fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark
add_watermark(fig)

# Save PNG
project_root = Path.cwd()
while project_root.name != 'decentralized-institutes-of-health' and project_root.parent != project_root:
    project_root = project_root.parent

output_path = project_root / 'knowledge' / 'figures' / 'mc-distribution-roi_discount_5pct.png'
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 338.1 |
| Mean (expected value) | 344.6 |
| Median (50th percentile) | 341.2 |
| Standard Deviation | 62.58 |
| 90% Confidence Interval | [248.1, 452.9] |

*The histogram shows the distribution of 1% treaty ROI at 5% Discount Rate across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
