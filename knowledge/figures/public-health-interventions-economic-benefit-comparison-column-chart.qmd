```{python}
#| echo: false
from dih_models.parameters import *
```

```{python}
import matplotlib.pyplot as plt
from pathlib import Path

# Find project root dynamically

# Import centralized style

from dih_models.plotting.chart_style import setup_chart_style, add_watermark, clean_spines, add_png_metadata, get_figure_output_path
from dih_models.plotting.chart_style import COLOR_BLACK, COLOR_WHITE

setup_chart_style()

# Data - using parameters

peace_dividend = float(PEACE_DIVIDEND_ANNUAL_SOCIETAL_BENEFIT) / 1_000_000_000  # Convert to billions
dfda_savings = float(DFDA_BENEFIT_RD_ONLY_ANNUAL) / 1_000_000_000  # Convert to billions
childhood_vacc_benefit = float(CHILDHOOD_VACCINATION_ANNUAL_BENEFIT) / 1_000_000_000  # Convert to billions
water_fluoridation_benefit = float(WATER_FLUORIDATION_ANNUAL_BENEFIT) / 1_000_000_000  # Convert to billions
smoking_cessation_benefit = float(SMOKING_CESSATION_ANNUAL_BENEFIT) / 1_000_000_000  # Convert to billions
total_benefit = peace_dividend + dfda_savings

interventions = [
    'Water\nFluoridation',
    'Smoking\nCessation',
    'Childhood\nVaccinations',
    '1% Treaty &\nDecentralized Drug\nAssessment'
]

values = [water_fluoridation_benefit, smoking_cessation_benefit, childhood_vacc_benefit, total_benefit]

# Create figure - taller for vertical layout

fig, ax = plt.subplots(figsize=(8, 10))

# Create vertical bars - white with black edge for traditional interventions

for i in range(3):
    ax.bar(i, values[i], color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=2, width=0.6)

# Create stacked bar for 1% treaty

x_pos = 3
# Peace dividend portion (bottom)

bar1 = ax.bar(x_pos, peace_dividend, color=COLOR_WHITE, edgecolor=COLOR_BLACK,
              linewidth=2, width=0.6, label='Peace Dividend')
# Decentralized framework savings portion (stacked on top)

bar2 = ax.bar(x_pos, dfda_savings, bottom=peace_dividend, color=COLOR_WHITE,
              edgecolor=COLOR_BLACK, linewidth=2, width=0.6, hatch='///', label='R&D Savings from Decentralized Drug Assessment')

# X-axis labels

ax.set_xticks(range(len(interventions)))
ax.set_xticklabels(interventions, fontsize=15)

# Value labels for traditional interventions (positioned above bars)

for i in range(3):
    ax.text(i, values[i] + 3, f'${values[i]:,.1f}B',
            ha='center', va='bottom', fontsize=20, color=COLOR_BLACK, weight='bold')

# Value labels for stacked 1% treaty bar
# Peace dividend label (in middle of bottom segment)

ax.text(x_pos, peace_dividend/2, f'${peace_dividend:.1f}B\nPeace\nDividend\nfrom 1%\nLess\nConflict',
        ha='center', va='center', fontsize=14, color=COLOR_BLACK, weight='bold',
        bbox=dict(boxstyle='round,pad=0.4', facecolor=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1))
# Decentralized framework benefit label (in middle of top segment)

ax.text(x_pos, peace_dividend + dfda_savings/2, f'${dfda_savings:.0f}B\nBenefit from a\nDecentralized\nDrug Assessment\nFramework',
        ha='center', va='center', fontsize=13, color=COLOR_BLACK, weight='bold',
        bbox=dict(boxstyle='round,pad=0.4', facecolor=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1))
# Total label (above bar)

ax.text(x_pos, total_benefit + 3, f'${total_benefit:.1f}B\ntotal',
        ha='center', va='bottom', fontsize=20, color=COLOR_BLACK, weight='bold')

# Add title

ax.set_title('Gross Annual Economic Benefit of a 1% treaty and decentralized framework for drug assessment', fontsize=18, color=COLOR_BLACK, weight='bold', pad=20)

# Add annotations

# Note about self-funding (arrow to 1% treaty bar)

ax.annotate('Only a 1% treaty\nis self-funding\n(generates wealth\nwhile saving lives)',
           xy=(x_pos, total_benefit/2), xytext=(x_pos - 1.2, total_benefit * 0.55),
           ha='center', fontsize=12, color=COLOR_BLACK, weight='bold',
           bbox=dict(boxstyle='round,pad=0.5', facecolor=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1.5),
           arrowprops=dict(arrowstyle='->', lw=1.5, color=COLOR_BLACK))

# Axis formatting

ax.set_ylabel('')
ax.set_xlabel('')
ax.set_ylim(0, total_benefit * 1.18)

# Clean spines - remove y-axis too since all values are labeled

clean_spines(ax, ['top', 'right', 'left'])
ax.tick_params(left=False, labelleft=False)  # Remove y-axis ticks and labels

# Add watermark

add_watermark(fig)

# Save figure

output_path = get_figure_output_path('public-health-interventions-economic-benefit-comparison-column-chart.png')

# Save the figure

plt.savefig(output_path, dpi=200, bbox_inches=None, facecolor=COLOR_WHITE)

# Add metadata for attribution

add_png_metadata(output_path, title="Public Health Interventions Economic Benefit Comparison")

plt.show()
```
