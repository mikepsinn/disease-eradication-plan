```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: dFDA Present Value of Annual OPEX Over 10 Years (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Simulation results
samples = [356298204.8054594, 268282509.13931885, 391436742.9401901, 407459510.8593807, 225200318.89713576, 253844571.6939778, 343245422.5076181, 312543418.89564484, 332927808.1432548, 279075482.0205925, 402234046.6156488, 393701619.35225374, 338797820.11222005, 423830914.17335176, 368750018.9376529, 278707801.67764014, 361145085.9807141, 272912641.8473263, 402153616.6570626, 330608948.97973555, 321328665.37001914, 289396165.15885407, 432440763.2128952, 323391844.3858794, 305238610.306682, 310185499.7698821, 373826790.70569295, 360893184.0299878, 364512346.04400253, 365906296.4541828, 499016865.95138633, 306653151.19717735, 299881739.49480426, 281397437.7978956, 380485542.97503024, 423985768.671645, 326172889.92762065, 279835346.9345253, 280762376.0925143, 383274765.6761072, 390842719.7176283, 374683258.1169583, 290339233.21436274, 350884863.7689437, 342438481.0553768, 349888767.2336461, 401558194.288903, 350251231.3189875, 385572126.08776456, 338908528.16253805, 355127464.91938937, 381716647.4109238, 245678952.41008517, 312317396.925906, 302542736.29377323, 291975268.1371786, 315265610.1932193, 458027695.0397939, 278323568.9371186, 409849385.52545893, 234253955.9552943, 311316441.9294078, 345783376.6152785, 378103888.2131517, 388210165.03479064, 394996049.54978096, 310408658.7962009, 303055181.09053004, 400419856.5536376, 320892194.779831, 255267412.74310464, 263052906.3147254, 275192538.68168855, 371064454.1428854, 344303419.8037111, 386514781.02671444, 305307863.77042085, 345476094.6558538, 381257973.86281747, 312998516.5941779, 367915735.2849021, 290558854.16979134, 309471609.1943037, 308253990.189473, 259604094.3681724, 370267576.72028947, 302604682.5664415, 334992143.8994974, 369781465.57424134, 367121300.1588965, 384472994.3182039, 327238766.94174, 305562702.7958303, 328537178.73008776, 234033411.6826521, 246200075.57490015, 252747975.21280262, 270712525.3372891, 363516998.0517, 276005048.092377, 308486619.8015661, 439495899.1552594, 309915289.0008565, 390369717.0413203, 274371297.8793712, 319936684.40781736, 273423315.08326364, 311044088.80811995, 398929775.4605788, 232067431.868664, 366184563.8789735, 351297823.4381388, 294743748.05467194, 246254861.077482, 339234092.41388345, 298792262.14421403, 350922987.90292895, 335654266.1714786, 468471777.9728107, 317655169.86962044, 269217332.02964884, 346991010.7019633, 349985355.61564064, 445092221.7588082, 398492531.2334956, 360240921.0624774, 454979769.71205616, 259991979.98083675, 291921450.3560632, 274779236.7876981, 307729436.32406056, 249885512.2020424, 382027909.0864237, 318805582.62470627, 244972433.52724642, 269667479.0202651, 356960179.8144606, 398746169.10698384, 496278594.013924, 499016865.95138633, 364641343.6623832, 271153176.1683337, 221320582.52574962, 353526878.80253667, 281446817.4837269, 306075110.755154, 293629768.58502334, 324330670.4137199, 418387085.36751854, 345367412.2601991, 323111833.1663518, 268527733.63327146, 234658907.11346024, 301527219.35809445, 330340021.7517063, 483300657.4814843, 343421763.2772058, 411102000.31323737, 300702066.76334876, 260201565.5238413, 272553910.9594547, 286704028.32673484, 499016865.95138633, 280945748.6447982, 398776683.5874289, 276153692.5166287, 406687114.24474365, 362381740.62265295, 323248006.7746242, 331248799.43971145, 290996796.64863086, 367085746.5122705, 303526700.3796275, 257978868.1721096, 255146197.65822154, 346501698.2107459, 466234167.37050354, 345581952.70591277, 325850210.33368206, 354880770.03575927, 440124557.6722845, 349940001.4165821, 306361338.3155892, 421961086.83959126, 365746925.15555185, 461989818.74315494, 347280985.471074, 258040746.2516713, 250335460.10790277, 473356110.1842622, 480678290.9150925, 321691137.3564691, 308159733.1672442, 454801351.6638808, 264513339.32151875, 276631886.362062, 382687564.32163095, 307418234.9043915, 333749277.07589006, 322784201.27572954, 358777089.4377974, 449651581.0680566, 340557707.5995582, 382736988.26792896, 223057502.478627, 330693194.7700537, 279653923.3591377, 258348850.20821783, 277600971.2695399, 311366472.4077806, 405344503.8917078, 252551119.11485985, 336276634.5328031, 301663301.1106968, 311790532.5641202, 412842294.94434273, 374285083.21940917, 443050294.3620361, 323393468.59658134, 288480919.3151264, 318695543.47401154, 351650931.875033, 346793213.18151784, 265780838.340353, 340550872.0167293, 350593787.8581742, 499016865.95138633, 489398839.8124559, 279063739.951692, 314452376.0489668, 245353340.43130907, 294957937.9374451, 357117724.57675, 430920580.79104084, 286470760.15859336, 291036170.97431517, 221000444.24039242, 322837123.7417697, 267015879.80556846, 298795621.215318, 277676630.2245526, 327530481.5806344, 230583438.9326058, 245166894.13224941, 499016865.95138633, 254636124.3829497, 265086553.2458387, 487146475.3389725, 499016865.95138633, 260936977.03006265, 309132567.3898697, 359078599.9210093, 481138791.9707545, 271306599.9695342, 317258481.4966242, 393663873.81264615, 366211024.208123, 308617248.6028886, 324807864.5262203, 249979917.22668976, 317734395.4301766, 315848520.087128, 350885498.0331481, 297168003.02434975, 369063666.03856677, 413710737.32414967, 345249430.69897115, 359852343.12110686, 337878637.22922677, 334116115.16508347, 286925999.5770298, 357184741.1082469, 327321558.03347707, 499016865.95138633, 465670104.1897614, 362450229.41456366, 284424671.8991491, 264214056.07954082, 429584933.7663731, 353156903.5951151, 369734397.4260954, 231223656.15481973, 406332445.5262569, 367732958.86461264, 264324497.36875108, 302469197.6238503, 353229043.9076083, 337829551.4152977, 314134869.7571419, 326893517.37016404, 316810323.6619635, 345040646.75453126, 455766723.0394137, 213255070.9193959, 317823136.0990647, 346788754.0935661, 355642986.9449032, 308893566.06644374, 230632411.95967844, 358052634.12076545, 481052192.6299392, 241735127.25213623, 400914646.56306064, 311734478.6130078, 329814757.348012, 267552506.19164926, 311344613.5427943, 439571613.8692016, 377819393.61838526, 481337174.6166792, 428341966.6707239, 366545050.4186399, 481976242.9797924, 366537817.14030236, 397894005.47896856, 313843380.36702186, 338834646.8734746, 288390776.88798124, 411696193.8869044, 260566349.53191006, 394080505.7886122, 320936429.4171496, 427785086.30391634, 391471254.1789014, 486234425.08526933, 389814833.5583008, 239795829.15442717, 329423270.2813736, 260912723.8445754, 299499995.09116983, 459604690.34251165, 382220049.12729096, 288299117.9815128, 269773423.33267444, 336429266.653403, 258471677.98462707, 289994515.06678563, 356846885.2546936, 426348988.8373641, 379906468.05357623, 218025248.49104184, 356271865.6327597, 339227225.4875169, 364601400.8186161, 469900628.6196058, 222778337.57999384, 294933268.74929893, 378477787.2636862, 239312965.29163766, 456195610.5796986, 361115049.2447577, 399458438.333989, 296190457.66426826, 396701463.12954926, 418607101.12997264, 350937931.66309273, 351050719.5468396, 353723256.5475376, 278469583.2362673, 323869903.50552326, 323528819.3990735, 362262694.1435097, 412586803.7946693, 267234458.78555068, 325412488.03890425, 456726037.88654673, 285595420.083389, 280894577.88396543, 348681356.20906687, 399273137.2111555, 334916656.77752477, 442262120.01438755, 400320002.76454306, 399057072.84347004, 375550972.2248229, 499016865.95138633, 319955307.9138978, 224060363.3001045, 468716575.0174933, 303352813.6195878, 341802827.2731166, 440454302.12176085, 238271879.34042925, 256565358.5294255, 238321228.75679988, 282565703.3799671, 366587587.1778229, 373186707.6311646, 354166211.1891741, 247990602.5212231, 217643025.54016078, 337964075.11905044, 302453164.94331247, 368118459.1209619, 387451277.9026221, 343999563.63716155, 392237285.34982574, 350666519.06791407, 373649782.42540956, 287950002.4127805, 321684879.13060296, 348274720.5607026, 397268157.8158863, 307474279.36743224, 372948920.1042805, 315885089.41296625, 325925585.2642568, 398022562.6327287, 224286598.83997616, 254150409.02418664, 244385029.60552153, 217167425.12962148, 289558942.01100826, 391352723.25467753, 314618245.2262839, 348349244.78399295, 420443732.9464887, 442143190.9689934, 329271444.5324606, 444566381.1071396, 340668515.0730364, 279998246.7104001, 294728176.63386786, 244470059.78420576, 277016968.7767438, 309800698.0018385, 395850306.45883644, 480384620.63495576, 249595962.80948502, 362984529.79097205, 268250822.60186577, 369309727.72881246, 324995451.4205586, 227856339.98694146, 406406064.8410873, 294069725.7848985, 298514526.3199842, 266602806.3702223, 291027768.49257743, 365680096.2915263, 321031703.00679874, 358102994.8619107, 360625059.58494127, 441488259.4186471, 310797874.1658039, 244659870.5348373, 418496771.73702615, 311539651.0874883, 422701133.3639292, 362261413.66413385, 324991962.40710574, 359626096.4049854, 493634067.34969133, 499016865.95138633, 339037420.79687256, 345596462.6251817, 419293911.11710876, 279510536.5242571, 358436260.5303847, 332291843.27636135, 356989885.3232682, 280236390.79229546, 238910751.94144514, 222570617.43739137, 263937003.63344973, 303290359.6191891, 314067242.97919756, 492841985.6367029, 421934789.37961596, 272727956.03717273, 359545103.0057942, 306610242.16417676, 314652781.9034927, 347434260.6459918, 380741884.7097307, 311029295.7618089, 418199185.85947025, 262573217.45566562, 334557358.6368557, 499016865.95138633, 350213112.367222, 452099994.94135785, 340624922.3293301, 377669687.3755566, 330130935.35591793, 322310201.7855342, 283440694.10141337, 365866176.68541616, 279164215.0824227, 384489230.98519546, 420095149.7527988, 360975997.105653, 314527666.3579396, 367697673.0431354, 313042997.9885668, 407028313.8198074, 227845142.30093908, 311268997.37697905, 224335283.0373743, 243722082.24748117, 445531516.5401568, 403576274.4304498, 287051814.13077456, 243339687.35265833, 213255070.9193959, 297910783.33262837, 499016865.95138633, 366220157.9729737, 296901954.769927, 368561054.63526535, 240357126.60963032, 313793559.543494, 341197322.8039366, 328095032.9246361, 394784300.86878794, 359312778.3872113, 384711664.2517746, 288942068.9171865, 403800351.12157696, 471164424.2639253, 272264656.3377234, 277042581.30092776, 442899438.44683635, 320889509.35929716, 449304373.53168154, 304324936.3887905, 454187635.72204524, 343509549.8694037, 352820207.9772081, 464822115.9325391, 309555421.348122, 273937222.23599803, 303938086.08586067, 367571098.983787, 240113809.39149415, 382214975.3367817, 298207880.8191808, 425674800.9942254, 215951353.83488956, 283017404.3772493, 234076187.85140446, 280658833.1612471, 352034695.3502462, 321710997.9227303, 316716739.48847866, 323074335.7694718, 348760976.31601524, 270068495.4173524, 387851776.6125, 384252454.00523597, 362388391.08953595, 375742555.2245184, 355674807.82104534, 498516609.05105424, 328026260.1011666, 313148026.5462061, 284997125.7480702, 268719924.49151844, 256954059.95612898, 276978194.30470747, 329164297.3604462, 358528905.15877444, 337735132.4349845, 284276000.57738286, 404002277.6119917, 390526021.87777007, 323042745.40290976, 291111728.42659557, 375100442.7465862, 347628438.0904395, 246147370.7345285, 329351886.43049437, 353103744.69593453, 276342091.2291157, 347765619.2410698, 245799924.57943526, 442936990.65898204, 434765696.0579158, 316774231.4843753, 360741693.7590158, 215639763.18215302, 261776172.52702224, 314028324.22164595, 266468933.55637723, 388469926.89520967, 496311475.9337481, 260659213.00815445, 279994396.13289076, 351128319.35141146, 469395800.22707605, 258154811.31403443, 352136493.1278794, 486270957.71035606, 235796533.8575829, 254977675.56676346, 305542826.9635692, 299354145.9303767, 396604168.66963226, 351588825.6591478, 229746607.1022445, 372496147.1300629, 295778581.9110257, 437203557.21059483, 292671629.61059767, 292114685.223059, 374523374.24653906, 392468560.34921616, 367242803.0399598, 234119196.63373512, 374278686.18505865, 268603985.2877256, 351115556.93226844, 247417388.046203, 367105107.7119401, 281823681.6118249, 254893476.33431682, 388422684.52115333, 351587698.1397336, 293513318.85947263, 453817170.4691897, 304445888.6104402, 336381394.42565984, 353616554.92384946, 293161208.1495927, 369032342.9658158, 298542737.9202382, 306315376.1260918, 445416865.3007206, 268248439.13782483, 215583004.2893458, 469378053.9132536, 499016865.95138633, 306727293.19316167, 225510791.85369992, 312923407.04709, 314529377.49290687, 320985678.53911185, 264159623.19260782, 377572795.9582486, 373211870.8280194, 243755775.10025755, 387225943.38103235, 499016865.95138633, 346455815.84613085, 311156198.4327447, 324247716.48971665, 380427526.68548554, 231903417.53937703, 345902883.5519062, 307686965.6948242, 487760031.9903367, 322054244.6304713, 475053324.92995423, 264697847.4599611, 378186621.6185342, 357403831.852419, 278134772.9121912, 346853424.21097267, 431527112.2529732, 312045982.1944797, 233805007.54179558, 332874306.07665443, 276183064.3602523, 310827071.42343, 328407602.70278454, 233130726.82226694, 237599285.8756515, 369884491.37999487, 299219623.5013671, 213255070.9193959, 394287931.41960865, 353874545.34034073, 287391507.128626, 253061151.78627643, 398551116.5799062, 359669712.1729937, 499016865.95138633, 365086283.96451175, 362592250.83641255, 322546931.3303529, 396953697.10248446, 381217332.63959897, 435112182.229574, 299307756.7683692, 304782993.1225418, 301985937.6141451, 394783934.27671146, 458359655.7565388, 303279787.67782474, 305467594.0218651, 357002616.95739096, 317226106.760332, 408448558.3270338, 218832826.0719669, 280630672.75550556, 283265290.5997911, 217435358.7305694, 272638934.7661329, 275442095.4546506, 320229317.5577813, 422556069.30979794, 317273021.10948706, 268802086.249683, 330118999.81760937, 416905867.1713927, 271931152.43582386, 275708460.3931389, 375902393.3545844, 318851770.77945584, 383023474.51559186, 333149472.49071294, 387427570.39452946, 268560348.48428184, 333259302.2992084, 319582305.6963767, 258508175.1225939, 240229393.99850655, 386128675.20771325, 310262814.7419444, 269286479.28650534, 327398068.08064616, 423900471.98699355, 218240266.28964335, 243640963.1650192, 274993217.44498056, 454775877.59061795, 354638295.1529897, 392832362.18435615, 262671695.64663583, 263817207.55019, 367220668.15560937, 338243786.9317333, 375125051.56375456, 321138295.80698866, 354305954.0670273, 345445434.789297, 393699580.09191835, 396136361.03983796, 237388161.47024333, 218925398.09513277, 412754102.73455405, 429275204.4389155, 269380653.5112132, 227210682.36148766, 341165455.7890487, 406624060.10281676, 484947460.02909833, 372565886.58867586, 308906463.5701678, 276725076.8689107, 334918440.18482023, 313665050.0463265, 269696564.25762004, 499016865.95138633, 484256356.5622136, 424619376.9624077, 275111373.6834745, 400170115.9247353, 382388863.60729176, 366812681.368833, 434923097.00395197, 382045660.33814955, 390575598.58683896, 382169439.6502909, 359020706.121006, 229327771.6183537, 340057658.15753853, 297113788.41521955, 255043757.88846454, 476451802.0893513, 481155127.7178265, 445095323.7264572, 352595788.3482372, 444288699.3565779, 334960977.8090455, 348717489.33638614, 265271977.6238202, 363303593.6208649, 338394527.3759865, 253819261.89861682, 330520282.7255991, 328536391.7215368, 484945602.40649873, 403493534.1874689, 334918026.58883536, 352118005.92432547, 337241659.2061159, 320107087.4956782, 265890817.74363512, 323629228.95410067, 285444211.7150047, 256637452.48315278, 372167062.85092634, 362864848.2616809, 229178013.56679645, 325572125.6611126, 412228003.01301754, 417790983.16878176, 414857820.8199631, 336864783.8208212, 279546849.01976734, 265819490.76508993, 359309721.281785, 361948364.0514755, 438393868.50296533, 421399676.6465289, 324917148.4949989, 256968475.86553547, 312354606.54820216, 349781184.95199317, 320163202.64662755, 295756414.4357174, 352422581.4218118, 300406416.11637986, 292642080.17977536, 356804974.0179932, 306939427.7910362, 351770237.7911182, 353936846.08266723, 262712260.98095912, 301849743.5529252, 452535492.0291315, 261459793.56622747, 221644875.77447632, 227165971.41274017, 336168689.4149408, 336296913.2674555, 325920861.56719446, 431679305.5860771, 213255070.9193959, 363222538.9638363, 464500500.75336593, 263358689.21180227, 308379633.8322911, 285035351.6152118, 276654122.99456364, 311883377.7215579, 451553718.28038925, 487173050.71305186, 311247202.8036802, 491002083.03695416, 336627692.8530446, 482513924.0233343, 327597103.3413333, 343478529.3944107, 360895499.695298, 499016865.95138633, 399854948.4206153, 287792613.87790334, 409911619.0879143, 309551367.93706024, 301308299.4854249, 404720470.3424564, 336308856.74552, 354338266.6395152, 335097558.5375343, 358702041.1658568, 365454500.1824363, 225507969.05824414, 384569353.0672413, 271583656.90588146, 246450218.9479014, 330017547.43655473, 340083485.22935635, 288629256.0415778, 398149644.8618243, 251711583.4930162, 306618942.761546, 295321164.3586168, 330841932.48939365, 354359828.2940886, 270105141.50287056, 389281181.5019003, 338581400.19908136, 226498525.36259714, 225035444.27353105, 333242802.9484899, 318890040.40033007, 326898218.36423165, 332143261.0099741, 350396433.7509947, 408069144.13566226, 264286900.40041438, 260914683.536095, 265280233.72046438, 355112273.54098517, 434490302.39547306, 305044711.8744454, 213833942.38901076, 233212354.68349317, 280256026.3944445, 297017455.5691273, 306525480.09633684, 336841180.15155256, 312840069.7579399, 416920470.6202741, 289696261.65191215, 278529947.62899566, 369635493.6190529, 241644330.36305097, 362744429.5816188, 341418828.915403, 323875793.5305201, 467138749.51872385, 293004046.01715815, 499016865.95138633, 318589810.0592956, 255195787.46408898, 339075942.61883307, 266237844.95038095, 285103682.39881104, 363306813.0557231, 375667132.8472506, 293006503.1246664, 411506950.72130865, 426546584.57414204, 452394635.73911566, 373598434.2321676, 445490759.0161455, 226745227.95851734, 312433707.03391385, 278254628.7177458, 342622065.50351804, 296158864.99269485, 322599345.8973111, 489700966.835678, 322356979.75062364, 364593863.7123296, 318130483.9905574, 339490716.6752729, 334534601.55759835, 367260216.20311105, 427249237.2694039, 473003221.3360585, 356667014.2416214, 378369232.3061324, 262079182.43098772, 327972099.54495275, 407435844.7098943, 401095786.2817805, 349366530.59794486, 402828300.6297716, 370564142.9095232, 430416423.80108386, 355145431.67981964, 309952280.0777326, 358645893.6916909, 213255070.9193959, 362223854.25354636, 213255070.9193959, 232256346.46558693, 367527251.9884452, 369530507.90610564, 261440527.55074638, 287499023.0545395, 446159897.15528876, 301672167.6996098, 499016865.95138633, 333974846.31026876, 364151293.0355535, 469966549.8471788, 343476303.67323077, 270421551.6428831, 326463452.5605028, 331609076.6895741, 250516023.83213323, 316552755.29706293, 285679560.3108429, 406068375.76242995, 336559184.2206111, 314756906.40727973, 326707774.64110786, 350216236.46318763, 380552571.6294733, 270571747.5164436, 268191759.55838227, 421817795.28151023, 306270231.2806755, 247777425.64660516, 366910769.1902366, 368428059.0183106, 241895634.1333889, 350686523.11158955, 390210562.190371, 361574809.82251257, 381772492.0968117, 248435556.03843164, 358282740.83514875, 313443082.0759537, 301751103.74491197, 401484211.63099444, 456515870.30639005, 484767947.29638296, 440943219.5992327, 326462988.9740478, 359925530.86169434, 392791383.7918415, 342763221.2699302, 343457248.32593775, 397538576.35903823]  # Truncate for embedding
baseline = 341634623.61287224
mean = 340010913.3452176
std = 68583080.56045264
p5 = 234688090.9938212
p50 = 333183166.10110706
p95 = 472538887.1651448
display_name = "dFDA Present Value of Annual OPEX Over 10 Years"
units = "USD"

# Create figure with two subplots
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
# Handle edge case where all samples are identical (zero variance)
if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)
ax1.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key statistics with formatted values in legend (use format_parameter_value for full units)
ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {format_parameter_value(p50, units)}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {format_parameter_value(p5, units)}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {format_parameter_value(p95, units)}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {format_parameter_value(baseline, units)}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---
sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)
ax2.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key percentiles
ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"
exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title
fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark
add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from
output_path = get_figure_output_path('mc-distribution-dfda_npv_pv_annual_opex.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 3.416e+08 |
| Mean (expected value) | 3.4e+08 |
| Median (50th percentile) | 3.332e+08 |
| Standard Deviation | 6.858e+07 |
| 90% Confidence Interval | [2.347e+08, 4.725e+08] |

*The histogram shows the distribution of dFDA Present Value of Annual OPEX Over 10 Years across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
