```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: dFDA Present Value of Annual OPEX Over 10 Years (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata
)

setup_chart_style()

# Simulation results
samples = [272579105.296829, 232829804.03270784, 287728896.7431641, 294523096.2165973, 213935574.8024732, 226011542.72532067, 266857114.37925825, 253175530.4504807, 262295261.18714398, 237865369.05281118, 292314756.5901773, 288693427.20295024, 264894947.54735515, 301396866.48928547, 277988701.2802735, 237694653.96992284, 274690351.3239598, 234996270.3989013, 292280710.42152584, 261265110.1240974, 257123874.1752367, 242634193.4161631, 304985352.1684634, 258047136.85662234, 249871048.76022992, 252111043.1127368, 280181059.1435074, 274580801.84727883, 276152901.1079453, 276757361.68723226, 325581975.72170484, 250512500.90515974, 247434972.38579628, 238942136.04392296, 283045316.2795216, 301461566.4580422, 259289284.67302272, 238217994.5188621, 238647863.50808513, 284241364.14081466, 287475693.1441274, 280550179.2538577, 243067767.0440486, 270212558.1489571, 266501591.3019443, 269776097.58827484, 292028614.1529253, 269934954.98101383, 285224863.055918, 264943867.6399996, 272068064.66065234, 283573496.0367281, 222111387.02109522, 253073580.96975055, 248646451.98908356, 243819079.82593697, 254401937.15148482, 315547452.10109985, 237516192.01371294, 295530734.1097933, 216597895.56990373, 252621864.71710318, 267973918.31246835, 282022301.5258295, 286352402.79146045, 289244057.4943014, 252211876.5293776, 248879442.24453416, 291546393.3989959, 256928363.45035028, 226687814.02143002, 230371283.61518633, 236059584.73500177, 278989101.1118802, 267322928.76114264, 285627989.2959456, 249902470.71325222, 267838811.8655182, 283376761.54621446, 253380750.0753486, 277627701.83914876, 243168685.72592705, 251788350.9591948, 251237527.14858457, 228743084.57820317, 278644832.9750365, 248674622.06778458, 263210815.42013225, 278434731.343948, 277283754.2245603, 284754508.48167443, 259764644.74133587, 250018081.6738512, 260343181.71287927, 216490792.74321306, 222361277.19582725, 225489669.71324363, 233968006.53256774, 275720932.00404733, 236437983.09877786, 251342806.2816708, 307912694.0240162, 251988924.90610582, 287274006.1253626, 235676829.41350335, 256500120.85182503, 235234638.73657727, 252498891.97059456, 290914651.49990547, 215534901.47743726, 276877957.9224942, 270393413.5803389, 245088003.40174958, 222387540.15731612, 265087705.83950633, 246938174.22082144, 270229256.8339415, 263504171.2558975, 319816650.9929328, 255476272.8772229, 233267979.791744, 268504600.90358025, 269818433.4952595, 310226493.1650478, 290729163.8984054, 274297050.3208093, 314297067.8078229, 228926482.81542537, 243794382.31008062, 235866993.90229845, 251000060.29873955, 224124665.0074789, 283706968.8884946, 255992762.04478723, 221772377.5750028, 233478836.29224506, 272867877.65226996, 290836768.24368215, 327718039.5982533, 305779061.8555444, 276208862.84372485, 234174123.4433442, 214168441.09463325, 271368705.1990096, 238965010.3035296, 250250467.88018796, 244577781.5186892, 258466762.72835225, 299118630.7474419, 267791018.8870801, 257921920.89300334, 232944784.91474244, 216794484.2062616, 248184435.9533023, 261145521.42765334, 325330651.547235, 266934778.6963682, 296058288.06993526, 247808735.76313627, 229025548.83611384, 234828756.32902592, 241394499.4772682, 325937536.8724027, 238732851.4533032, 290849712.67977345, 236507178.27805337, 294197118.4078961, 275227881.2400251, 257982818.70456925, 261549545.07662472, 243369867.9234596, 277268357.04913, 249093736.61274996, 227973886.45788684, 226630238.72068977, 268289633.65100795, 318903973.28436935, 267885359.19772875, 259145298.46326315, 271960325.66346914, 308172973.74823785, 269798554.5437718, 250380234.15414053, 300615168.3107225, 276688282.59088904, 317169824.9276502, 268631958.0474747, 228003195.270545, 224339493.9712502, 321805171.0029867, 324776806.15075755, 257286187.1446417, 251194864.33172753, 314223809.66291916, 231059107.58015612, 236729716.7778231, 283989747.38587296, 250859130.01873636, 262659762.50604427, 257775374.92284632, 273659774.6692056, 312106259.89533013, 265672136.67100522, 284010929.34640384, 214049379.16813564, 261302568.15059248, 238133824.75444487, 228149103.1598862, 237180401.23859838, 252644451.4829714, 293630124.23093915, 225395923.86760044, 263779780.71986598, 248246370.17992505, 252835860.73986265, 296790572.2160138, 280378600.24804175, 309383094.7219961, 258047863.0942062, 242213066.16948465, 255943379.34557825, 270548014.761069, 268417712.69441977, 231655275.95064268, 265669119.952692, 270085049.4392781, 315695906.9814208, 326431654.4283744, 237859918.06440628, 254035839.92803073, 221955179.603342, 245186049.69576958, 272936583.32409954, 304353052.17048836, 241286942.981169, 243387951.93232638, 214193116.29493627, 257799049.08289376, 232235477.23572317, 246939706.65452087, 237215570.38529834, 259894675.36250022, 214811977.13139063, 221865710.80241203, 325916544.722697, 226387884.72293466, 231328809.34924653, 326020544.2183314, 305993655.7223175, 229372998.2603936, 251635031.3788395, 273791089.89123636, 324949747.36111677, 234245868.15442884, 255298065.79066876, 288677364.0760041, 276889424.16905344, 251401914.96164417, 258679935.63270655, 224169747.20452332, 255511857.16539404, 254664200.8545287, 270212835.9656435, 246196659.74939957, 278124365.23870504, 297155710.0888768, 267739132.31810236, 274127947.3652883, 264488619.52879864, 262822462.2625291, 241496826.39049393, 272965807.09390026, 259801551.51596126, 326893077.0571438, 318673733.414344, 275257637.41443884, 240342561.04573596, 230918232.86663938, 303797051.8601366, 271206935.13599104, 278414384.3896525, 215124004.4147123, 294047384.51135504, 277548586.0064807, 230970223.11448124, 248613008.360353, 271238481.5216491, 264466913.12905514, 253892841.51693425, 259610713.2294988, 255096668.7144461, 267647301.2317143, 314620105.2069879, 213255070.9193959, 255551712.5081917, 268415753.76880106, 272293147.72910064, 251526925.869025, 214835853.3516448, 273344143.14195746, 324928251.8317083, 220215785.868638, 291756037.40205884, 252810563.29959932, 260911871.6388861, 232487360.64335218, 252634583.19050065, 307944046.5994169, 281899992.240729, 324984488.7088669, 303279247.8620357, 277034152.30576175, 325096697.31436926, 277031018.5942171, 290475175.28152263, 253761528.2922543, 264911221.1439357, 242171570.9811845, 296308400.25296515, 229197924.6035324, 288854646.2060361, 256948180.78750736, 303047138.1440941, 287743604.28068405, 325855539.8077385, 287037327.6110393, 219280745.84394455, 260737667.8968177, 229361543.7124415, 247260950.54875237, 316193596.79025835, 283789347.3402161, 242129374.3191708, 233528449.29730508, 263847352.61434546, 228207257.895713, 242909325.29604504, 272818464.8941385, 302448222.1600019, 282796728.48368007, 214465188.99139956, 272567612.6104105, 265084672.3087062, 276191535.373788, 320398891.6562603, 214066857.42699862, 245174758.19888934, 282183012.36442876, 219047628.87817022, 314796101.9825287, 274677289.6753107, 291138853.08397514, 245749888.59333852, 289968827.55559814, 299210849.0010335, 270235802.199498, 270285201.01911426, 271454553.2148405, 237584017.69461888, 258260852.82695642, 258108379.6072192, 275176156.01793045, 296683114.29468036, 232338090.18012637, 258949920.14767617, 315013709.97535425, 240883137.05090845, 238709136.69242156, 269246625.4173671, 291060276.81542134, 263177361.2611624, 309057290.5969299, 291504077.2312203, 290968644.03491473, 280923931.0650869, 320628369.1424781, 256508470.66776505, 213991689.46219525, 319916433.9417691, 249014719.0553702, 266221385.52368307, 308309459.17557746, 218544600.8684606, 227303879.05596843, 218568458.09750763, 239483039.81207654, 277052580.41774285, 279905057.998338, 271648150.17541385, 223218840.48347613, 214505950.54203376, 264526399.4011711, 248605716.80591768, 277715440.4981174, 286028238.9694567, 267189184.14841905, 288069977.9830573, 270116912.56893367, 280104745.76216036, 241968621.9454377, 257283385.13867018, 269068204.2400189, 290209490.60417247, 250884512.91919544, 279802494.810403, 254680650.08532846, 259178935.52278325, 290529737.4356936, 213979761.8072629, 226156988.10301504, 221490331.5944296, 214558590.0952627, 242709055.4528996, 287693089.0062694, 254110529.47742653, 269100907.4619473, 299980193.8103442, 309008116.99361074, 260670094.4521613, 310009391.13865477, 265721036.72482693, 238293558.4547575, 245080874.8123541, 221531170.20045367, 236908852.20916104, 251937128.84332484, 289607198.5749579, 324657837.3103528, 223986366.20459166, 275489725.2805328, 232814944.88213786, 278230775.7762192, 258763713.02680102, 213842126.25426874, 294078467.75577116, 244779348.3816688, 246811453.84990925, 232041499.13370773, 243384092.85691848, 276659313.53723073, 256990861.4779487, 273366089.55521965, 274464176.2764882, 308737263.8840338, 252387697.71977514, 221622320.02113464, 299164606.61744285, 252722627.6355652, 300924653.8419942, 275175599.6315309, 258762154.92493877, 274029467.25309265, 327218236.6740044, 327332738.3461975, 265000818.12389985, 267891739.14128673, 299498643.9027715, 238067291.90208086, 273511301.90975404, 262012915.4090223, 272880832.88335454, 238404005.5703065, 218853355.87752688, 214080269.53769276, 230787785.86859858, 248986335.91936776, 253862379.0465737, 327069813.6364987, 300604168.30800235, 234910035.9941102, 273994208.86282176, 250493054.0164054, 254126079.8068327, 268699265.7988232, 283155329.55401075, 252492211.83883476, 299039864.30275756, 230145149.81169304, 263018102.4533974, 313648268.26236224, 269918250.50922394, 313113770.98459125, 265701799.44436896, 281835621.61114264, 261052526.21480602, 257563293.69884154, 239887783.91315517, 276739972.58352154, 237906559.462785, 284761459.12724286, 299834240.32206655, 274616818.49078417, 254069743.7842425, 277533311.1985599, 253400804.24171138, 294341135.26866746, 213842414.5696422, 252600444.5420863, 213977246.7185016, 221171803.29305235, 310407814.81294173, 292882674.7021287, 241554816.88727435, 220987971.491061, 213255070.9193959, 246535885.08679718, 318202713.44003856, 276893382.12143886, 246075103.86717984, 277906953.27225024, 219551577.11096695, 253739081.38363904, 265954347.74784815, 260146238.64218405, 289154013.74099857, 273893061.2494527, 284856671.7057886, 242425295.0507178, 292977439.3297887, 320913512.43887675, 234693644.0001909, 236920764.5689796, 309320747.15472054, 256927160.3463281, 311963276.33629394, 249456323.1059506, 313971764.92708033, 266973438.07495424, 271059679.36527586, 318327471.8411647, 251826245.4407228, 235474401.56503737, 249280632.5244681, 277478515.78495985, 219434194.29808268, 283787172.12764055, 246671508.2054051, 302166883.89313763, 214703076.4118382, 239692022.87775636, 216511568.14947125, 238599868.04717413, 270715993.30960095, 257295079.25784427, 255054603.92463085, 257905150.64748067, 269281554.5184988, 233666603.2615307, 286199334.46387106, 284660091.59690285, 275230770.71560746, 281006422.74852103, 272307038.41367465, 328146024.71371996, 260115599.43152007, 253448152.85845855, 240606954.16346332, 233034880.57697284, 227488218.85219377, 236890817.70424, 260622401.46343356, 273551663.50947654, 264425157.56105763, 240273873.5942693, 293062825.1743386, 287340660.81296384, 257891021.86532643, 243422652.53495514, 280729900.8403421, 268784524.2294732, 222336010.23908976, 260705897.89915416, 271183688.13399285, 236594865.7094261, 268844749.7894046, 222169408.0159553, 309336267.67928404, 305951315.9861307, 255080446.1539347, 274514911.09304154, 214742434.62734506, 229769174.25984782, 253844847.3442964, 231978616.3199241, 286463325.48873234, 327724294.8482802, 229241796.60616213, 238291772.4261311, 270319185.8492862, 320193229.4110288, 228057217.93928024, 270760543.8605615, 325862132.6818729, 217346292.3704758, 226550181.64459857, 250009065.63186038, 247194448.90715274, 289927500.07684267, 270520825.6799329, 214403787.30154496, 279607158.18464303, 245561535.0587, 306962829.36131537, 244138542.45774594, 243883054.31742015, 280481288.5976331, 288168483.28725976, 277336370.50978285, 216532455.54438797, 280375843.305531, 232980532.31301054, 270313596.678435, 222944476.317153, 277276741.8272118, 239139552.13035235, 226510177.38000304, 286443153.57580906, 270520332.05928224, 244524417.0701327, 313819579.3570575, 249511242.68535572, 263826159.89367113, 271407909.28141123, 244363025.37348267, 278110818.15221554, 246824327.1075101, 250359398.46917, 310360496.05472136, 232813827.15738297, 214749708.4112414, 320185998.74615914, 314880068.15800506, 250546101.31743893, 213921994.91639152, 253346885.7500852, 254070514.2987003, 256970243.82434934, 230892606.5297216, 281793956.8752588, 279915910.50152355, 221187997.17210057, 285931955.2744408, 327994372.76114506, 268269472.45596683, 252549514.96291736, 258429697.32018876, 283020415.06209296, 215455060.91725314, 268026455.22672912, 250980829.2386228, 326132025.168759, 257448738.13654616, 322494965.3749336, 231145936.48492712, 282057865.7653992, 273061335.95570946, 237428480.13320392, 268444163.430198, 304605397.02766323, 252951131.870064, 216379845.50926593, 262271513.42803845, 236520849.98077843, 252400884.8111557, 260285472.18063602, 216052150.76743883, 218219318.70896834, 278479265.8073442, 247133104.50858378, 213255070.9193959, 288942890.98678374, 271520682.07740283, 241711355.9313189, 225638770.47114068, 290754019.89467746, 274048453.4278274, 319187941.8513242, 276401848.6995151, 275319336.64969873, 257669223.28466496, 290075956.4719817, 283359326.8389614, 306095164.7248478, 247173295.49366316, 249664279.12293968, 248393181.76120558, 289153857.84138846, 315683512.260553, 248981531.1984994, 249974937.23922428, 272886385.3483383, 255283519.36845434, 294940283.91790676, 214383511.23092526, 238586814.0155116, 239806673.19707337, 214528671.71405864, 234868464.40611985, 236175837.6125351, 256631308.17057237, 300863999.0178948, 255304598.51975244, 233073391.51275054, 261047217.20427325, 298497473.78005886, 234537816.9806623, 236299890.63291276, 281075237.68959683, 256013488.7955618, 284133697.2638334, 262393640.22487926, 286018109.5932425, 232960075.34148288, 262442378.74451178, 256341212.2967856, 228224536.67049035, 219489959.25849694, 285462900.9277728, 252145979.6255691, 233300375.40966135, 259835656.2139792, 301425929.2583408, 214442856.445665, 221132812.4646025, 235966714.07142657, 314213349.47525024, 271854411.30792785, 288323405.504443, 230191582.80863145, 230731370.37069586, 277326785.42133355, 264650068.60378712, 280740500.66352963, 257038609.147233, 271709213.30489415, 267825329.6026225, 288692559.3778354, 289728755.52697223, 218117165.04851094, 214374529.03128317, 296753481.01097757, 303668057.34896475, 233344492.78114536, 213860184.21309525, 265940290.54197073, 294170500.60948247, 325624171.55691385, 279637249.25720304, 251532760.23354593, 236773073.66105673, 263178151.6482912, 253681176.9009138, 233492457.20932457, 328101578.80450565, 325500641.88650644, 301726234.26421666, 236021769.23096496, 291440553.0589202, 283861716.60770476, 277150088.579658, 306016666.77239704, 283714580.0248889, 287361800.9309781, 283767649.95046294, 273765877.8691954, 214199343.80373684, 265451411.65680972, 246171891.6631459, 226581575.92821565, 323062890.9848644, 324952606.49067754, 310227773.67608935, 270961508.5066974, 309894720.0806572, 263197003.5554038, 269262477.16044044, 231416020.9952866, 275628278.4072444, 264716704.88764894, 225999504.26880836, 261225684.02900448, 260342831.2187035, 325623838.8467077, 292847679.5860581, 263177968.3470483, 270752453.4031823, 264206877.45077607, 256576516.1817918, 231706970.37394503, 258153269.44369304, 240813350.64735284, 227338074.683196, 279465146.364185, 275437745.81979114, 214126219.99529055, 259021182.45694184, 296532177.1104738, 298868717.71604, 297637711.5401187, 264040118.23965135, 238084142.06957012, 231673444.65735433, 273891730.16209817, 275039560.32295173, 307456204.948696, 300380298.30466366, 258728743.97560662, 227495054.15085188, 253090366.03156373, 269728939.45185333, 256601671.54155982, 245551395.82962325, 270885729.5495577, 247674059.2523603, 244124990.30806944, 272800184.5545827, 250642227.19699097, 270600241.54067326, 271547911.88300973, 230210708.2835257, 248331213.2802598, 313292835.136455, 229619853.16199422, 214144324.28228468, 213861543.42910424, 263731987.56962708, 263788758.78167555, 259176827.56834587, 304668702.65278065, 213255070.9193959, 275593083.4046929, 318196105.2001833, 230515379.87465075, 251294391.09107062, 240624604.301474, 236740062.71042538, 252877759.70284316, 312889097.3318404, 326025364.9158911, 252590604.49224907, 326727365.6036557, 263935186.4701331, 325191448.7193687, 259924367.6314562, 266959777.59141546, 274581808.99291945, 299425433.65582806, 291306961.26272035, 241896135.17847952, 295556953.9792277, 251824412.8081523, 248084785.08645722, 293366431.35609436, 263794046.48767316, 271723331.9941899, 263257529.58039823, 273627084.99351, 276561512.06065965, 213922115.14454284, 284795756.9766687, 234375400.42135262, 222481178.17927277, 261002088.51860112, 265462813.8960462, 242281342.68946156, 290583669.2885147, 224995913.283549, 250496997.2874751, 245352276.61238408, 261368695.1958419, 271732752.9859798, 233683758.40986094, 286809625.7656678, 264799303.44006664, 213883529.7534869, 213943079.95776567, 262435057.18511236, 256030661.55909413, 259612809.47102484, 261946930.49091944, 269998581.3406403, 294780273.8622507, 230952524.96336675, 229362469.26618162, 231419903.76617754, 272061430.6776228, 305836962.1223726, 249783062.75813016, 213833942.38901076, 216091834.20323682, 238413111.1528338, 246127878.9095128, 250454636.7965913, 264029672.5589771, 253309309.40235344, 298503600.4854952, 242772201.21841598, 237612055.14082974, 278371627.4316494, 220172050.99997774, 275385441.85915154, 266052049.5695636, 258263485.4597417, 319273063.8483401, 244290973.37836552, 327786816.3424503, 255895924.87540576, 226653793.96463272, 265017837.71299654, 231870050.19239572, 240656153.3619902, 275629676.2876721, 280973948.68739337, 244292099.93098488, 296228752.41076356, 302530657.8904569, 313234923.6358095, 280082606.37901694, 310390993.7476079, 213875031.15066814, 253126046.15144438, 237484165.1570251, 266582493.67255944, 245735443.41761833, 257692674.61526033, 326487186.5098721, 257584227.03981894, 276188265.673777, 255689727.25045732, 265201060.96764615, 263008013.92914256, 277343910.84530866, 302823723.75348276, 321661671.2907574, 272740007.10354006, 282136356.91698134, 229912142.17823565, 260091469.0368789, 294513110.5741872, 291832770.7312776, 269547143.67985713, 292566253.0754983, 278772977.60343325, 304143232.9215647, 272075910.5440971, 252005644.1346572, 273602627.0409609, 213255070.9193959, 275159279.31670463, 213255070.9193959, 215626845.21817374, 277459532.796327, 278326238.07580274, 229610758.70088604, 241760892.12209848, 310667106.21725607, 248250405.34068683, 322869940.1133761, 262759812.15227896, 275996242.68906534, 320425743.3307222, 266958797.4388361, 233831854.84629774, 259418908.79056814, 261709639.23677507, 224425676.7424857, 254980887.6982966, 240921965.7621772, 293935878.53868985, 263904862.4301422, 254172959.81779048, 259527881.74145913, 269919619.56652933, 283074084.51897067, 233902138.8078262, 232787246.5355937, 300555228.6174094, 250338932.53073704, 223116824.2785085, 277192574.3769602, 277849411.6235548, 220293088.16736728, 270125675.93504, 287206129.2332459, 274877189.36554015, 283597444.93035007, 223431701.22533253, 273444413.6789752, 253581147.2239972, 248286327.59230122, 291997284.0903982, 314927496.08959305, 325592036.60846823, 308511781.9407391, 259418702.00133, 274159801.0140451, 288305956.9595898, 266644691.05002782, 266950405.8694566, 290324301.3941726]  # Truncate for embedding
baseline = 268738760.02760494
mean = 264486472.25884277
std = 29256213.49802892
p5 = 216808648.497462
p50 = 262408592.66671437
p95 = 318538335.4812255
display_name = "dFDA Present Value of Annual OPEX Over 10 Years"
units = "USD"

# Create figure with two subplots
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
# Handle edge case where all samples are identical (zero variance)
if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Mark key statistics
ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {p50:,.2g}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {p5:,.2g}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {p95:,.2g}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {baseline:,.2g}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---
sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Mark key percentiles
ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"
exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title
fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark
add_watermark(fig)

# Save PNG (same directory as the QMD file)
output_path = Path('mc-distribution-dfda_npv_pv_annual_opex.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 2.687e+08 |
| Mean (expected value) | 2.645e+08 |
| Median (50th percentile) | 2.624e+08 |
| Standard Deviation | 2.926e+07 |
| 90% Confidence Interval | [2.168e+08, 3.185e+08] |

*The histogram shows the distribution of dFDA Present Value of Annual OPEX Over 10 Years across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
