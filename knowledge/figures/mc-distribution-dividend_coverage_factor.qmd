```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Coverage Factor of Treaty Funding vs dFDA OPEX (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)

setup_chart_style()

# Simulation results
samples = [668.2139199025927, 781.8316499475967, 634.9249198079634, 621.2231245123359, 931.2651339553678, 826.9169316450317, 681.8896310151468, 717.4379891664411, 693.2753055304306, 762.8240016808265, 625.5997874605534, 632.9364605573287, 686.732607080248, 600.7414169851385, 655.8635394768329, 763.368442336203, 663.3291512564525, 772.0971154290279, 625.6678320007873, 695.9087180665639, 706.7372187086564, 747.9754058549453, 588.5790801032542, 704.2888259048583, 726.6918637391888, 720.3886160134779, 651.0095587791002, 663.5805481908418, 659.9941957405504, 658.6273744860572, 498.3333333333333, 724.8736202523523, 733.6959989076852, 759.4109190272375, 644.7937814258431, 600.5182846679457, 701.0260694425428, 761.7023011177479, 760.3401211548196, 642.2393264919477, 635.4493615419849, 650.2006085028052, 746.6589438948771, 673.7911389280151, 682.7611595118066, 674.831741197846, 626.1722136657321, 674.4525584177217, 640.1565966380957, 686.6108793020188, 669.4090755440365, 643.6627786381925, 854.7696173306382, 717.7193498077695, 730.1930409607224, 744.3905761703626, 714.0735569584311, 555.1461910822424, 763.938566694544, 619.2499604327053, 896.1661863770695, 718.9691273256655, 679.1688406595615, 646.9977533998723, 637.7883086246536, 631.8078505657185, 720.1078946836806, 729.5238576320788, 627.1396907551817, 707.2582640232075, 822.2465388080647, 797.5885585594217, 768.6296365996134, 653.6380742959013, 680.7516876063464, 639.30749331122, 726.6025460427236, 679.4966325165394, 644.0835042100871, 716.8724089236898, 656.6709982933079, 746.3533049302882, 721.2887268817404, 722.8313109990149, 808.3284627976783, 654.4019165149846, 730.1120555198152, 690.9544276937563, 654.8691114797737, 657.4424972211461, 641.150666760556, 699.7868198275428, 726.274141057942, 698.2855236133605, 896.8138848035254, 852.9367128799993, 830.5524428383889, 775.4854745012555, 660.9750742861585, 767.4044849915208, 722.5358768489481, 578.9698877342042, 720.728939221238, 635.8678314717677, 769.8735825974976, 708.402714346164, 771.3165985832384, 719.3102468723122, 628.4124939789859, 902.6281692997288, 658.3554759941555, 673.3610517877358, 740.5959818087651, 852.7444723089837, 686.2532608506027, 735.143934761285, 673.7514011726225, 690.2146474216179, 542.5542899701032, 711.1566245225124, 779.079718687473, 677.884904456298, 674.7306389766695, 571.5653426728238, 628.787362215819, 664.2327524634758, 558.9304582431882, 807.1062845999603, 744.4648855593265, 769.2549613298818, 723.4987343732945, 840.1931139581336, 643.3777091580323, 709.7642491047657, 857.2670913599734, 777.7614050427632, 667.5407939648873, 628.5698309829697, 501.1433453458888, 498.3333333333333, 659.8673732056002, 774.8034738476512, 935.923866503931, 671.0528266794473, 759.3388024962403, 725.6150784922419, 742.1162740294292, 703.1826026395844, 608.690997512536, 679.6126757957136, 704.6197154693484, 781.1078979879959, 894.9792888319545, 731.5243000478494, 696.2159529617736, 523.7237743478172, 681.699593077323, 618.2227752639801, 732.6110634577657, 806.4474285835327, 772.6467379299015, 751.769797443174, 498.3333333333333, 760.0714867387619, 628.5436746608518, 767.1809459040137, 621.8646331129946, 662.0988549606441, 704.4587442355694, 695.1792569563862, 745.7448879519808, 657.4770840869236, 728.9096434006929, 813.4894362790004, 822.6423839019853, 678.4043086285438, 545.2043338828213, 679.3836585241927, 701.4024567532981, 669.6616841142059, 578.128668510415, 674.7781073869785, 725.2476642930125, 603.4486719165627, 658.7832406036322, 550.3018900174299, 677.5776250878154, 813.2917454583858, 838.6630548243626, 536.8571669267845, 528.5345242505215, 706.3053323293334, 722.9511122363397, 559.1535594507111, 793.1253278467676, 766.4630587355739, 642.7747356912884, 723.8955182326124, 692.3491208755853, 705.0074354065039, 665.7030488499767, 565.6697395595173, 684.8047125202993, 642.7296225933245, 935.0806695376695, 695.8125503657542, 761.9696924967234, 812.3088156400428, 765.0140208205814, 718.9065142439802, 622.9841772319245, 831.2084268230611, 689.5213151178186, 731.345510736643, 718.3764203563935, 616.8035994189433, 650.57634030785, 574.2452522738685, 704.286907851027, 749.2593131880973, 709.8971000559287, 672.9939109338745, 678.0947311576439, 789.2916137752825, 684.8121711780584, 674.0947525558475, 498.3333333333333, 512.3408868080205, 762.8413717419992, 715.0739910260388, 855.9188308101999, 740.3046744897234, 667.3808765440946, 590.6909982110524, 752.1011366655426, 745.6902552409796, 936.0791074451918, 704.9447661699081, 785.5911997552171, 735.1394580961448, 764.9012159583529, 699.4487307301107, 907.0658755539393, 856.5782522512591, 498.3333333333333, 824.3122437351707, 791.3870123312462, 516.48693309168, 498.3333333333333, 804.1439789224842, 721.7173210326655, 665.3994573207269, 527.9635310676465, 774.5664152136166, 711.6385357477592, 632.9694559574813, 658.3296377380287, 722.3701305838161, 702.6221970793406, 839.8716292588538, 711.0604886772965, 713.3588897423865, 673.7904777642801, 737.3176517233658, 655.5606994314558, 615.6876949200993, 679.738711285789, 664.6221545609286, 687.745638296777, 691.9366455002352, 751.4548868761325, 667.3128834343947, 699.6908204560021, 498.71188599514016, 545.8764044896038, 662.0309059892148, 755.0252184276484, 794.0359345951533, 592.5589463935635, 671.4343997414805, 654.91439793518, 905.14617828538, 622.1598256661312, 656.8482719532649, 793.6996622624829, 730.2892146254413, 671.3599500330013, 687.7998542693275, 715.4656588675889, 700.1875502633588, 712.1840832434361, 679.9619091956001, 557.9485146406571, 940.1435122563264, 710.9528502724771, 678.0994635370932, 668.882060941923, 722.0198826447273, 906.9187493158721, 666.4341021308866, 528.116369506435, 868.89793144328, 626.7186506546244, 718.4464270427299, 696.8171435597558, 783.9940498739041, 718.9338686946502, 578.8684444366812, 647.262443430046, 527.5538177296954, 594.3077948443604, 658.0037097210696, 526.2632657425183, 658.0107628218536, 629.3015255796356, 715.8257660551267, 686.6921078835762, 749.3861017439273, 617.7371901867699, 805.3032246479225, 632.6055235112425, 707.2054087336866, 595.0946355117029, 634.8944885030706, 518.1849857101903, 636.3597320030427, 876.0162276450426, 697.2661724151834, 804.2197368020437, 734.2024281938667, 553.2080161098121, 643.2019147047953, 749.5150853916599, 777.4517751855628, 689.351579025802, 811.9176193110327, 747.1393894607434, 667.6558615028277, 597.1332923170663, 645.3277093667879, 937.5191899587466, 668.2407423179984, 686.260798458329, 659.9066352210258, 540.8753476845233, 935.21629659606, 740.3382091569075, 646.6503455869312, 877.8065989213535, 557.4147914677252, 663.3591136899825, 627.9600872900144, 738.6346560227869, 630.3295150135032, 608.3656813722102, 673.735826711988, 673.6183113275345, 670.8505409533666, 763.7217691645017, 703.7249139490211, 704.1271218672131, 662.2170098828861, 617.0113735825879, 784.9398708357335, 701.9139465254376, 556.756102067783, 753.3481742823271, 760.1464231712366, 676.0991897181141, 628.1185556034577, 691.0389104102538, 575.286337554975, 627.2247575888026, 628.3034746014276, 649.3839148643365, 498.3333333333333, 708.3803583673149, 933.8955160974672, 542.2659156932459, 729.1359833285943, 683.4499048341448, 577.6883964516695, 881.6915205161233, 818.0314337631614, 881.506599329421, 757.7098909666895, 657.9622368390519, 651.6159832223615, 670.3948900830574, 846.6979243111962, 937.7038426026903, 687.6512996624947, 730.3101868647458, 656.4745352528844, 638.4670681741305, 681.0779564066216, 634.220072783881, 674.0188524264119, 651.1771001522253, 750.0069399613817, 706.3127827109699, 676.5275568466493, 629.8404269577749, 723.8240158583206, 651.8416722160874, 713.3141217265925, 701.3144852108417, 629.1909888466458, 933.3725350191692, 825.9086119663363, 859.3545340493471, 937.9334905333677, 747.7477121458941, 634.9990238134714, 714.8696192493426, 676.4489926643107, 605.663378524172, 575.4437526922175, 697.4405335236908, 572.2531122388484, 684.6838366813852, 761.4624366486523, 740.6171722151163, 859.0517415408249, 765.886331554682, 720.8734004919733, 631.0661210164753, 528.8634106104645, 841.180660435056, 661.5014902459155, 781.9252659945925, 655.3233914866713, 702.4022439539756, 917.8022732804902, 622.0985195234938, 741.5147954087192, 735.5143421574821, 786.8250159206855, 745.7019129143914, 658.8486305630423, 707.0916055982946, 666.3832095885356, 663.8484301182185, 576.3121507968601, 719.619021397431, 858.3765870243151, 608.5287718677337, 718.6899000290562, 602.3743077323484, 662.218281095363, 702.406333190102, 664.8491774909903, 504.7672547074327, 499.11831861547654, 686.4692334486938, 679.3681773494077, 607.3523684278903, 762.1812109589953, 666.0467003646554, 693.9947421957436, 667.5106328279988, 761.1121608912815, 879.30347451137, 935.3171876758666, 794.8807482568824, 729.2173250654188, 715.5491597509251, 506.1302754090153, 603.4869189896144, 772.3799402386649, 664.9305018670018, 724.9285866761736, 714.8270864164434, 677.4153614844876, 644.5578218665099, 719.3287880860285, 608.9690987430919, 799.0654044218788, 691.4414245580765, 498.3333333333333, 674.4924073699472, 562.5530726385107, 684.7313832443915, 647.4018506125448, 696.4550872784376, 705.5694329691805, 756.4429014964976, 658.6666020878762, 762.6927748142488, 641.1359504636889, 606.1744360897208, 663.4978715359044, 714.9812034375537, 656.8825109626841, 716.8171963636673, 621.5810225166941, 917.8759460805367, 719.0285183343725, 933.260055335197, 861.7225576136304, 570.9920210945508, 624.4673135063582, 751.2765590405946, 863.094344025399, 940.7692307692307, 736.3213546908762, 498.3333333333333, 658.3207193677206, 737.675430534103, 656.0461830643944, 873.9441075750201, 715.8873660654863, 684.1078065552382, 698.795737282605, 631.992086242732, 665.1639314025731, 640.9344410958489, 748.6116355284839, 624.2788151727623, 539.3988806601835, 773.0907191984252, 765.8480158371048, 574.4442269612047, 707.26147314962, 566.1144754823114, 727.8731559595556, 559.9223201678341, 681.6050433321695, 671.7821816713808, 546.8898516943218, 721.1828877393896, 770.5333840741542, 728.3749508409078, 657.0053713522813, 874.841159147633, 643.2065551238844, 735.9239177146884, 598.0951245416384, 938.5200909803194, 757.0550790672004, 896.6881876813221, 760.4919264021003, 672.5955356019066, 706.2816899075228, 712.2981532055005, 704.6640594677002, 676.0154039671935, 776.5906907214733, 638.1086031833878, 641.3506503102568, 662.0922560509636, 649.2039856020581, 668.8495689642662, 500.1673987019399, 698.8751920820451, 716.686877170885, 754.2038888482846, 780.5415951826993, 816.7774308487373, 765.9443475287258, 697.563658452992, 665.9532390461283, 687.904175237155, 755.2389382681308, 624.1090871336792, 635.7294613283659, 704.7014239855822, 745.5854493013986, 649.8075930918388, 677.2099541153793, 853.1217334889101, 697.3481364008976, 671.4892752779557, 766.8978862966675, 677.064945054524, 854.3434368403875, 574.3946839215537, 585.3778661650679, 712.2280699782966, 663.7318640187121, 938.6702556085688, 801.5313209973651, 715.5972264102974, 787.225706471624, 637.5564400239404, 501.11073262257025, 805.0124564655832, 761.4681040346354, 673.5374924521449, 541.4673623659847, 812.9275745431305, 672.4899732886986, 518.1167542518684, 891.066704598365, 823.1933441397847, 726.2997395165813, 734.3961749588178, 630.4135929048009, 673.0584443622575, 909.5871171927353, 652.272017440304, 739.1915491128793, 582.0579079121073, 743.4309525707289, 744.1981720708701, 650.3514071150433, 634.0168536021079, 657.3243369276237, 896.5618416329567, 650.582381763973, 780.8831202413907, 673.5507824176394, 848.685335648054, 657.4582487249714, 758.7890476092008, 823.4688959867773, 637.5985918568371, 673.059616108087, 742.2757064809906, 560.3873886197392, 727.716465293748, 689.4048031452498, 670.9604313587945, 742.758373278005, 655.5909255372953, 735.4766932190407, 725.3066279998815, 571.141542286655, 781.9323086990227, 938.697603233434, 541.4881968440575, 498.3333333333333, 724.7786721369496, 930.5508138501814, 716.9656659280635, 714.9790950336836, 707.1465748137136, 794.2017759836292, 647.4921214395456, 651.5921131889573, 861.601896334909, 638.6690023551454, 499.72706383630884, 678.4530701783206, 719.1697754290857, 703.2801504013518, 644.8472184897404, 903.1165541623332, 679.0414773693301, 723.552848559757, 515.3508767711753, 705.8734342445794, 534.9050917171214, 792.5649682266923, 646.9208365001892, 667.0907361385744, 764.2191429519067, 678.0308389849586, 589.8465796631464, 718.0576286182787, 897.4856284271618, 693.3357488915831, 767.1367967734833, 719.5823859657734, 698.4349389370456, 899.4744405195875, 884.2195311190887, 654.7700163223752, 734.5750031725069, 940.1258406452649, 632.424554436834, 670.694817755458, 750.7956787827684, 829.5109539765317, 628.7370979799111, 664.8053950914499, 498.3333333333333, 659.4304612396595, 661.8900665246935, 705.2885967319017, 630.1116915770359, 644.12082035809, 584.9037308247628, 734.4578287992491, 727.2802562498645, 730.9221109367205, 631.9924053337327, 554.7370874036187, 729.2310967741382, 726.3966564925776, 667.4977070889681, 711.6779063890788, 620.4043897972775, 937.128778471699, 760.5332274346057, 756.6964070589723, 937.8041322055166, 772.5163704792811, 768.2527521201337, 708.051662228692, 602.5846068221628, 711.6208562466202, 780.2997481791018, 696.4687450656942, 610.8901126816903, 773.6035145922873, 767.8510588385905, 649.0539775581773, 709.7085067424218, 642.4682996441222, 693.0250408518127, 638.4883052679979, 781.0117389208623, 692.9011345097524, 708.8284961158516, 811.8014508164653, 874.4147994608767, 639.6548974966472, 720.2913232484178, 778.8769245128962, 699.6021371895122, 600.6411697559464, 937.4152783291902, 862.0131996384682, 768.9310298743101, 559.1854276254558, 669.9102333554613, 633.697554829772, 798.7617724295886, 795.2465927699599, 657.3458584187762, 687.3427029851056, 649.7844308487231, 706.9643429841993, 670.2513226116926, 679.5293632732497, 632.9382430604593, 630.8182941931416, 885.0160265849763, 937.0840027380674, 616.8752981055205, 592.9937819534134, 778.6008995961217, 922.0688652592775, 684.1424806256144, 621.9170845954058, 520.6001791920145, 652.2056803545395, 722.0035460311427, 766.323377460391, 691.0369141433948, 716.0463282281344, 777.6763770415037, 499.8253752186294, 521.9064800571672, 599.6070119020088, 768.7523257783945, 627.3525092352115, 643.0475730069693, 657.7428948956716, 585.1623829408048, 643.3614623567305, 635.6855908360656, 643.2482056554337, 665.4577204588359, 910.8541362824956, 685.350947201154, 737.390519221397, 822.9772098478022, 533.3071192963715, 527.9297694035166, 571.5612903218886, 672.0142727453767, 572.6169642831006, 690.9893042339902, 676.0611625163532, 790.8263121147595, 661.1859113578703, 687.1765578531102, 827.0004851069499, 696.0099722607378, 698.2864308482974, 520.6036816238172, 624.5369569408932, 691.0373771029117, 672.5091406905437, 688.4501268530939, 708.198233671235, 788.9606960127601, 704.0086511630378, 753.5641822717888, 817.7985611313926, 652.58530322712, 661.6199740063057, 911.3080043433063, 701.727284064613, 617.3034953065082, 609.5741265378704, 613.9567712202721, 688.8679043688268, 762.1276285597494, 789.1752809234906, 665.1670045859911, 662.5292715176173, 580.4503854039807, 604.2662297972881, 702.4940336563363, 816.7309963890776, 717.6730084733666, 674.9444013491534, 708.1309329050472, 739.2215551411001, 672.1935550040698, 733.0015585143517, 743.4716023700621, 667.6984427783351, 724.5072008638739, 672.8699912348774, 670.6307205170109, 798.6367661461732, 731.1007556954069, 562.0022647135464, 802.5143239554744, 935.7665556943009, 922.3657310486728, 689.6414277056202, 689.4987571611568, 701.319997415699, 589.6350689837672, 940.7692307692307, 661.2660405293839, 547.2751930791754, 796.6499442536207, 722.6717042140189, 754.1491339781676, 766.4297221885695, 718.2605068490855, 563.2455021834324, 516.4376223544471, 719.0558053818412, 509.43012357513106, 689.1310931137687, 525.229321503089, 699.3715825420722, 681.6384494290254, 663.5782359458873, 498.3333333333333, 627.6213719781857, 750.2289763042864, 619.1988135077918, 721.1880054347542, 731.8121841090854, 623.5064650771781, 689.4854722727862, 670.2181380094063, 690.8364997731803, 665.7786757654645, 659.0695043811024, 930.5573043908703, 641.0633447770387, 774.1388466039461, 852.0596657679355, 696.5848670962051, 685.3227046326768, 749.0508039881338, 629.0817739669983, 834.0175689403467, 724.9174402703057, 739.8114093745003, 695.6428556711166, 670.1959970377823, 776.4838812651443, 636.8338225949245, 686.9707448842415, 926.8192621531339, 931.6448302391964, 692.9197445438717, 709.6623302446554, 700.1820894849023, 694.1631296565048, 674.3008268070398, 620.7181103263622, 793.8141060900712, 804.2136149339972, 790.801364995699, 669.4246233303659, 585.7552598208338, 726.942103601114, 939.539397274394, 899.2332198418064, 761.0833000350169, 737.5200461533633, 725.0372013507615, 688.8940935147258, 717.0691786561138, 610.8683547921557, 747.5557802573641, 763.6321927111449, 655.0095866283863, 869.2286489684064, 661.7392478775528, 683.8669254964352, 703.7179740930733, 544.1299474083359, 742.9740942569994, 499.5364708105973, 710.0248187405963, 822.4803957405954, 686.4269160841086, 787.9183219314128, 754.0512846663266, 661.1827292472378, 649.2748033850077, 742.9707202669935, 617.891726468967, 596.8519707001697, 562.1803002865228, 651.2257248169016, 571.0451657241671, 925.1683399133514, 717.5745237573631, 764.0409874090105, 682.5626053123748, 738.6773302433747, 705.2264590532375, 511.7898146080415, 705.5139144892898, 659.9140445946616, 710.5804060495853, 685.9717396867565, 691.4669410913457, 657.3074077054843, 595.8537060066161, 537.264815368774, 667.8386621787578, 646.7511551808175, 800.5920886881439, 698.9377829263467, 621.2427526281041, 626.5647091007195, 675.3791235267097, 625.0976870360715, 654.117351202559, 591.394710261942, 669.3906885746854, 720.6823231635452, 665.8352719791691, 940.7692307692307, 662.2555717439154, 940.7692307692307, 902.0662763769698, 657.0479469733435, 655.1106714073155, 802.5742613953015, 750.6436567157846, 570.1738968622119, 731.3338657569278, 498.3333333333333, 692.0954071954258, 660.3495261197495, 540.7981359175719, 681.640846496115, 775.9367484212975, 700.6876314916145, 694.7694703794494, 838.0505936489504, 712.4981582010007, 753.2280518231768, 622.3798684302914, 689.2071956174665, 714.6988975094811, 700.4034092485505, 674.489141239675, 644.7320588600114, 775.7037156102166, 782.0998235963152, 603.6571334990244, 725.36455632259, 847.4359597091751, 657.6473780838588, 656.1748159785858, 868.3139122959436, 673.9979810218584, 636.0088117353338, 662.900907325832, 643.611607026068, 845.1615533500806, 666.2016547435061, 716.3211301577711, 731.2302177524194, 626.2349642266632, 557.0169060312403, 520.9388576847629, 577.0368159311242, 700.6881710953116, 664.5487624495629, 633.7334978144884, 682.4100500876601, 681.661369780916, 629.6074172227059]  # Truncate for embedding
baseline = 679.5
mean = 698.7208404742511
std = 95.24955462847971
p5 = 537.8021352026143
p50 = 692.9870222396996
p95 = 894.8938706475473
display_name = "Coverage Factor of Treaty Funding vs dFDA OPEX"
units = "ratio"

# Create figure with two subplots
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
# Handle edge case where all samples are identical (zero variance)
if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Mark key statistics
ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {p50:,.2g}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {p5:,.2g}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {p95:,.2g}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {baseline:,.2g}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---
sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Mark key percentiles
ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"
exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title
fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark
add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from
output_path = get_figure_output_path('mc-distribution-dividend_coverage_factor.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 679.5 |
| Mean (expected value) | 698.7 |
| Median (50th percentile) | 693 |
| Standard Deviation | 95.25 |
| 90% Confidence Interval | [537.8, 894.9] |

*The histogram shows the distribution of Coverage Factor of Treaty Funding vs dFDA OPEX across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
