```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Drug Cost Increase: 1980s to Current (10,000 simulations)"

import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Simulation results

samples = [13.9477667140579, 10.79482827971174, 15.184276954073075, 15.744472648806736, 9.074363180033096, 10.26871642513232, 13.48547251514827, 12.391200240029182, 13.118841194825858, 11.186316714382825, 15.562017256224863, 15.263596119386907, 13.327562553300652, 16.31464652520953, 14.387241714766377, 11.173004549398009, 14.119007668335172, 10.962958930758807, 15.559207120255174, 13.036290634673867, 12.705347453092541, 11.559298671550676, 16.613640614689228, 12.779001718800469, 12.129337466390123, 12.30673928638342, 14.566004701438764, 14.110113473749681, 14.237841637266408, 14.287004223563924, 19.793885253091762, 12.180093075283665, 11.936917438505573, 11.270345724408285, 14.800114860252798, 16.320029344252163, 12.878211140695525, 11.213822839749273, 11.24737026433915, 14.898060230518366, 15.163466037170144, 14.596139206492937, 11.593315310698197, 13.756244344045479, 13.456837307974675, 13.720971549050988, 15.538402002460018, 13.73380790169943, 14.978681422231968, 13.331495626113371, 13.906370433268805, 14.843354479637085, 9.96988507443428, 12.383106797984253, 12.032542467365843, 11.652301933555972, 12.488632451526076, 17.49882671197235, 11.1590912669229, 15.827842853158357, 9.550141783984213, 12.347257537559129, 13.575492001676125, 14.716426188826649, 15.071200394486162, 15.30890892893184, 12.314735538385444, 12.050948164493871, 15.49861809051012, 12.689759825924881, 10.320690763135868, 10.604589728891543, 11.045645047356151, 14.468766982364622, 13.523006795822573, 15.011748437360898, 12.131822904521504, 13.56459635162301, 14.827246249516266, 12.407494747203398, 14.3578421329086, 11.60123553571627, 12.281155342235351, 12.237505854296739, 10.478930589988067, 14.4407028223727, 12.034767578914702, 13.192283751127922, 14.423580238048267, 14.329840754522841, 14.940115479150135, 12.916212780030458, 12.140968352419408, 12.962488704328736, 9.54201992218119, 9.988984759150343, 10.228640017297261, 10.883102560667934, 14.202725979149118, 11.075096597134511, 12.24584650833091, 16.858211882758702, 12.297056323619431, 15.146892733301367, 11.015868413818673, 12.655628582891172, 10.98148557950442, 12.337501256148713, 15.446524406908583, 9.469586923283952, 14.296816122956242, 13.770864809035086, 11.752045349768212, 9.990992474224464, 13.343061069970794, 11.89774243339543, 13.75759416478022, 13.215830635988501, 17.858744544724487, 12.574091729100306, 10.828796398514937, 13.618303355445278, 13.724392269615665, 17.051940287739573, 15.431234625028289, 14.08708045925017, 17.39364092649137, 10.493071450423367, 11.65036206588781, 11.030660586117506, 12.218696361056098, 10.123948096641385, 14.854284655318507, 12.615212318519934, 9.943984162381444, 10.845149037695803, 13.97116767857909, 15.440104163947405, 19.254736663250338, 20.61855670103093, 14.242391961278043, 10.899101648276497, 8.766686604799913, 13.849753685094774, 11.272131986690727, 12.159354972401628, 11.711921648657187, 12.812502103866303, 16.12529407496961, 13.56074244915377, 12.769008171640671, 10.803739971929952, 9.565052762389465, 11.99605875138931, 13.026713283091363, 18.433243704192336, 13.491729289228923, 15.8715210997467, 11.96640531372923, 10.500711302953542, 10.949942564038984, 11.46213335617315, 19.744240550141967, 11.254004891942314, 15.4411711969511, 11.080483694231711, 15.71751760990877, 14.162662921110838, 12.773868286997926, 13.059074693646915, 11.617027386976366, 14.328587460788613, 12.067881249130735, 10.419658546083596, 10.316264049583594, 13.600958683565539, 17.781699705083852, 13.568349988749816, 12.866704286946899, 13.897645837443427, 16.879986135543977, 13.722786041898678, 12.169624308416264, 16.249635261092124, 14.28138435572719, 17.6354602319537, 13.628580974966232, 10.421915904521324, 10.140412209404326, 18.026796383254116, 18.2784098876823, 12.71829081066955, 12.234126208252526, 17.38748148717824, 10.657752950649364, 11.097812245860062, 14.877446055120716, 12.207535802879141, 13.14807176086654, 12.757313982150812, 14.035374165339165, 17.209596621918266, 13.390070472280785, 14.879181241074182, 8.904539769480628, 13.039290738557533, 11.20725620199017, 10.433154983512495, 11.13292054056933, 12.349049647881461, 15.67065142570856, 10.221443892680547, 13.237959642749983, 12.00094835102428, 12.364238515983562, 15.932183079563961, 14.582130397417743, 16.98128234767696, 12.779059684115428, 11.52627527732974, 12.611279681599889, 13.783364968700198, 13.61129230864432, 10.703869792457201, 13.389827746033989, 13.745938057768871, 20.61855670103093, 18.81982861102649, 11.185891609624546, 12.459533915153681, 9.95794907207591, 11.759758423879441, 13.976736298754744, 16.560891729157863, 11.453710014510794, 11.618447080013471, 8.741258729473628, 12.759203025835932, 10.748785135256997, 11.897863238897962, 11.135661033641274, 12.926611161670634, 9.414872397416584, 9.951113791951002, 19.7471656967128, 10.297634190854039, 10.678611491603506, 18.67716364914968, 20.61855670103093, 10.52751393705009, 12.269002973847412, 14.046025966397211, 18.295945566685152, 10.904671544428, 12.559909062262863, 15.262274582029077, 14.29774909443904, 12.2505297781631, 12.82952633419176, 10.127402724005883, 12.57692404764038, 12.509485205091723, 13.756266800881527, 11.83931213904807, 14.398292747762422, 15.96244532228279, 13.556558662575876, 14.07335688479217, 13.294902342265114, 13.161122804832127, 11.47014814606053, 13.979105010891743, 12.91916402065197, 19.611862928919912, 17.762272346625306, 14.165080225762564, 11.379796874385315, 10.646860660802108, 16.51453109084176, 13.836663187969254, 14.421922212162876, 9.438481262573317, 15.705138738330254, 14.351400351656538, 10.650880265404783, 12.029900899118424, 13.83921576789284, 13.293157992604517, 12.448171156471254, 12.903904941295227, 12.543884149600128, 13.549154559081561, 17.420805726681323, 8.069869377523686, 12.580096450311919, 13.611134249225058, 13.924600449621046, 12.260435604945384, 9.416678567911417, 14.009776952100607, 18.29124827761181, 9.825211643643101, 15.515911921243056, 12.362230906534185, 13.008004763363823, 10.768294585454262, 12.34826665866215, 16.860834502556745, 14.706425943797296, 18.308550187111184, 16.47137478513038, 14.30952604567329, 18.349147022191275, 14.309271028950679, 15.41030241884296, 12.437738494327693, 13.328870894196859, 11.523022257558788, 15.892235891893895, 10.51400705374687, 15.276860913108331, 12.691339666631704, 16.452035726015346, 15.185485920888569, 18.619354416833197, 15.127447956767554, 9.753987414829684, 12.994059151151045, 10.526630128359342, 11.923192398622627, 17.55322300685555, 14.861031357123599, 11.519714410382138, 10.84899732602185, 13.243386040715894, 10.437635156947719, 11.580882510996664, 13.967162990308504, 16.402152338910433, 14.779771521924756, 8.504647902520595, 13.94683553094617, 13.342817138334139, 14.240983014949572, 17.907923605090392, 8.882395503208837, 11.758870103066974, 14.729567968545558, 9.736244679961118, 17.435608549090773, 14.11794715814204, 15.465008784697202, 11.804131443605417, 15.368586560969574, 16.132951505320303, 13.758123258737282, 13.762116519498221, 13.856701399045875, 11.164378746212403, 12.796061613102374, 12.783890024345455, 14.158461082434883, 15.923278908531962, 10.75673219575676, 12.851093203016648, 17.453914087135832, 11.422095427210403, 11.252153517948948, 13.678202787278739, 15.458530114201174, 13.189598934554624, 16.954000238911135, 15.495127762716269, 15.45097550081154, 14.626662586412193, 20.508082993234797, 12.656293917222227, 8.984052206789928, 17.8671711560251, 12.061636968566559, 13.434275810113345, 16.891405972096614, 9.69797834180797, 10.368078302880699, 9.699792603860312, 11.312598444053675, 14.311025713284575, 14.543479216119467, 13.872371461776451, 10.05457948294004, 8.474211072928838, 13.297938467284814, 12.029324984029465, 14.364986577593964, 15.04459166364249, 13.5122281238839, 15.212318169818715, 13.748513370070912, 14.559775889828014, 11.507114360294581, 12.718067350390767, 13.66379574868409, 15.388411406379678, 12.209545796042129, 14.535110158042057, 12.51079329467959, 12.869392279379749, 15.414798698998773, 9.001981310926954, 10.279890606606784, 9.92244446706309, 8.436325770413458, 11.565170831398266, 15.181333608292848, 12.465469515701743, 13.666436252916212, 16.19685838544506, 16.949883181456148, 12.988650357300019, 17.033747357571094, 13.394005093643715, 11.219718654756504, 11.751484594646866, 9.925562776001648, 11.11176455478508, 12.292949724287753, 15.338805117045167, 18.268325663731762, 10.113351627228669, 14.183936775567833, 10.793676702938694, 14.40696183848966, 12.83621796014491, 9.284493018249128, 15.707708332634152, 11.727769946009088, 11.887753495964331, 10.733764948441818, 11.618144119063915, 14.279027716303526, 12.694742292319772, 14.0115565133861, 14.100645828927972, 16.92720898328937, 12.328680596841977, 9.932523319259378, 16.129111649247456, 12.355252756302264, 16.275368984301203, 14.15841588618252, 12.836093502998361, 14.065365767905407, 19.08771247318416, 19.55145716979801, 13.336074576607915, 13.56886448952379, 16.156852725580205, 11.20206601344273, 14.023332268937548, 13.09620665509171, 13.972217675895818, 11.228337179245036, 9.721462776527625, 8.86591548295552, 10.636776382630314, 12.059394157940282, 12.445750818408335, 19.037649240773806, 16.248720735664925, 10.956257908489073, 14.062504932473223, 12.17855377748322, 12.46670536658353, 13.634013192761188, 14.809119376007626, 12.336971313258218, 16.118754108572354, 10.587121665785185, 13.17681913167027, 20.61855670103093, 13.732458012775599, 17.294195048270083, 13.392457189980458, 14.701163338242786, 13.019266529254812, 12.740393439003247, 11.344233151154201, 14.285589513238179, 11.189529111367058, 14.940685263549586, 16.18473128459392, 14.113037517782598, 12.462228203900935, 14.350156700527181, 12.409087253866906, 15.729425381015561, 9.28360795613893, 12.345558030187759, 9.005839131019712, 9.898128602064416, 17.067137316179288, 15.608905182973118, 11.474690706354606, 9.884100037749196, 7.731958762886598, 11.866036394125238, 20.61855670103093, 14.29807114265633, 11.829738494781305, 14.380583310363983, 9.774607814181019, 12.435955268865913, 13.412780616423468, 12.946732449144548, 15.301497447067185, 14.054298452763316, 14.948490755712674, 11.54291549345806, 15.616731354292385, 17.951409560357273, 10.939445895307268, 11.112692481050175, 16.976060940763677, 12.689663915409941, 17.197596162181323, 12.096541475766527, 17.36629267300605, 13.494843942314597, 13.824749032531756, 17.733061779084654, 12.284159244594166, 11.000126155678926, 12.082652741736231, 14.345695493801037, 9.765669638282061, 14.860853203023497, 11.87672375463099, 16.378728528931973, 8.33939150411775, 11.328930580330582, 9.54359527456414, 11.243623777175733, 13.796948942294755, 12.71899996215168, 12.540537554347853, 12.767669832732537, 13.681023523997213, 10.859714658705467, 15.058634913581752, 14.932375947566962, 14.16289765058353, 14.633400932003783, 13.925725622953493, 19.39594049825214, 12.94428148344415, 12.412847360664056, 11.400481459475124, 10.810723818227293, 10.382265115739985, 11.110359763235952, 12.984833092181773, 14.026605625638691, 13.289802580793767, 11.374424243089594, 15.623783538711713, 15.152369636324789, 12.76654231295943, 11.621171350910018, 14.610815272177303, 13.640894691037227, 9.987053252782033, 12.991516130948753, 13.834782205250105, 11.087311141388017, 13.64575605933433, 9.9743191758816, 16.977360709633686, 16.694278676878383, 12.542593494999972, 14.104764340006186, 8.31453922934743, 10.55809009128199, 12.444357907091877, 10.728896576551636, 15.080307216907155, 19.256812256612204, 10.517391479033135, 11.219579295045557, 13.764863872030352, 17.89054977747509, 10.426076945103642, 13.800552009268936, 18.621670438337752, 9.606928720195562, 10.310109368464476, 12.140255092002088, 11.917948164652811, 15.36518260330865, 13.781166475929284, 9.384003499945802, 14.519173136894842, 11.789305145884935, 16.778788460661776, 11.677399224346487, 11.65732707562937, 14.590514258076912, 15.22041817968821, 14.33412373655643, 9.545179165397284, 14.581905321588321, 10.806510868582498, 13.76441203391411, 10.033585188727837, 14.329269959621175, 11.285763678108449, 10.307034137329238, 15.078651021297887, 13.781126562614128, 11.707726468194833, 17.35350084676572, 12.100883560773184, 13.241684106532178, 13.852926413175458, 11.69504045584569, 14.397189152607384, 11.88876818450892, 12.16797532967838, 17.063171195095247, 10.79359008070124, 8.310011509880695, 17.889938999406073, 20.61855670103093, 12.182752759856141, 9.098946853563259, 12.404805652616842, 12.46228943670575, 12.69309857481124, 10.644879469533203, 14.697757217671178, 14.544364817800387, 9.89936455771371, 15.036689821068434, 19.461145736846614, 13.599332168096542, 12.341517367411909, 12.809542416691729, 14.79807684019926, 9.4635414219959, 13.579729242166861, 12.217173309544712, 18.71604024815088, 12.73125543116122, 18.085151650496027, 10.664467451109896, 14.719334206160957, 13.986848513435532, 11.152254173195873, 13.613426564374821, 16.581939963768235, 12.373387169570918, 9.533607825519256, 13.11693717215169, 11.081548140582598, 12.329726626445892, 12.957871362280873, 9.508769487954936, 9.67324774365978, 14.42720936062235, 11.913110980708732, 8.072813473946118, 15.28412234731522, 13.86205363990155, 11.486954425146081, 10.240087144105404, 15.433283362389414, 14.066906330864873, 20.61855670103093, 14.25808579773518, 14.170092715144298, 12.748844367479244, 15.377410875814382, 14.825818872917822, 16.70629261622424, 11.916280117930377, 12.112984449617237, 12.012540255772949, 15.301484615527666, 17.51027875648068, 12.059014500274314, 12.137555255789858, 13.972667696948445, 12.558751503031372, 15.778981091163882, 8.568926398215641, 11.242604827800925, 11.337892316120408, 8.457670522036322, 10.953027759864735, 11.054691790103881, 12.666082617333304, 16.27032500113586, 12.560428922622473, 10.813709270395579, 13.018841423119886, 16.07373152794147, 10.927342132921478, 11.064346970643262, 14.639022493092476, 12.616862975692493, 14.889238828967736, 13.126729431778234, 15.043760329634571, 10.80492516713394, 13.130637690489479, 12.64296750305449, 10.438966359175087, 9.769915709491698, 14.99820533622549, 12.30950970594262, 10.8313085065435, 12.921891297335035, 16.317064412943502, 8.52176601440485, 9.895152840893731, 11.03841883227644, 17.38660203896441, 13.889069910770251, 15.233158774294296, 10.590708041634803, 10.63241567293453, 14.333343491160209, 13.30787779759179, 14.611680931848493, 12.698549058807394, 13.877314641327883, 13.563509157728284, 15.263524721631141, 15.348814684229723, 9.665483505747774, 8.576292023672673, 15.92910953660904, 16.50377830581617, 10.834729739191259, 9.233448905972955, 13.411649245957692, 15.71531693127611, 18.53774228713022, 14.5216279981215, 12.260897952194782, 11.101188898079712, 13.189662364880082, 12.431355430378707, 10.84620553546396, 19.44657886381052, 18.493897275245068, 16.342051888867914, 11.042702543590975, 15.489888401289909, 14.866958745318103, 14.318961307914572, 16.69973645731688, 14.854907977046512, 15.154106753780773, 14.859254315265746, 14.043980754337971, 9.368549474723729, 13.372312852594474, 11.837361314798367, 10.312522841688315, 18.133220171507205, 18.296983531835107, 17.052047602785503, 13.816807208888838, 17.02413933417614, 13.191175287917137, 13.67948289931649, 10.685357914972572, 14.195195900410035, 13.313233904255465, 10.267791638849667, 13.033133031905072, 12.962460660419284, 18.53762445368364, 15.606015264904483, 13.189647654542831, 13.799897674102734, 13.27226430442366, 12.661716180395876, 10.707870287451927, 12.787473269613653, 11.416633293156476, 10.370709743507462, 14.507588614207386, 14.179713205250671, 9.363023096423385, 12.856786812571828, 15.910773367218173, 16.10454535830545, 16.002407776354058, 13.258868290129755, 11.203380445184585, 10.705275790703151, 14.054190462170974, 14.147365909806478, 16.82003456251425, 16.230110348274554, 12.833424772919972, 10.382791227033659, 12.38443924709703, 13.717161366462644, 12.663720807772169, 11.788507126030813, 13.81067737816703, 11.955778617322975, 11.676334362959194, 13.96568149825741, 12.190362286783953, 13.787588162905394, 13.864257628573197, 10.592185310775752, 12.007647129452414, 17.30923781032186, 10.546563919294819, 8.792438237026632, 9.229913298801094, 13.234121818544427, 13.23868060889071, 12.869223826447477, 16.58722101981679, 7.908229499215599, 14.1923357347799, 17.721981775533077, 10.615723320195807, 12.242010731499628, 11.401862538127151, 11.098617975038222, 12.367563749674348, 17.27532378772195, 18.678847752115676, 12.34477732014314, 18.921293314629256, 13.250440157964436, 18.383294264711463, 12.928985816653272, 13.493743350084069, 14.110195238383548, 20.61855670103093, 15.478870957095262, 11.501433510876268, 15.83001322258703, 12.284013968546212, 11.988192216781698, 15.648863290855273, 13.239105231200723, 13.87845761960168, 13.19603288774439, 14.032722714980245, 14.271072031531602, 9.098723365702432, 14.943496909290408, 10.914729041144628, 9.998151367904265, 13.015227949718636, 13.373230078729152, 11.531628171941984, 15.419243254780728, 10.190748329569422, 12.178865900178904, 11.772837126167852, 13.044587303727116, 13.879220304789504, 10.861045604115724, 15.10874465105383, 13.319873543690468, 9.177120233550214, 9.06130592685634, 13.130050574354884, 12.618230625271574, 12.904072536022165, 13.0909178766476, 13.738949757782144, 15.76574407191964, 10.64951191011283, 10.526701541641865, 10.685658291584927, 13.905833192974868, 16.684729109062083, 12.122378352183347, 8.170385523630678, 9.511776767297329, 11.229047767338166, 11.83389484910996, 12.175513002674988, 13.258029250534, 12.40182191246365, 16.074239974191485, 11.570124375109161, 11.166564586770102, 14.418438152785345, 9.821878205885035, 14.175463484001174, 13.420644434919677, 12.796271787730374, 17.812850375535966, 11.689377665541752, 19.48940051894387, 12.607500800903544, 10.318075068894496, 13.337443043310431, 10.72049232971607, 11.404331245277609, 14.195309502926277, 14.63074822066623, 11.689466201129052, 15.885638807744849, 16.40901687092757, 17.304372564378447, 14.557968925016718, 17.065727405825548, 9.196636640086096, 12.387271725822355, 11.156594705504583, 13.463352580917276, 11.80299427275494, 12.750715415897504, 18.838954748225355, 12.742063397713244, 14.240717148914054, 12.59108320759894, 13.352176707462668, 13.1760096447713, 14.334737540042816, 16.433424717802634, 18.014660462527274, 13.960804731501847, 14.72575261613453, 10.569127938678447, 12.942351242999349, 15.743646823230183, 15.522242571469084, 13.702474713807716, 15.582778155804917, 14.45114787638019, 16.543393961893646, 13.907005821549445, 12.298381941857318, 14.030738993222986, 7.731958762886598, 14.15709016904242, 7.731958762886598, 9.476549723924327, 14.344150035556801, 14.414739748375565, 10.545861984956147, 11.490835710065761, 17.088873071479345, 12.001266931995175, 20.17959697752255, 13.156097030488706, 14.225104846478946, 17.91019217057379, 13.493664382145198, 10.872536541661256, 12.888571746196293, 13.07190171000093, 10.14701843549326, 12.534673203537624, 11.425134721887796, 15.695921325488145, 13.24800469908159, 12.470431249112895, 12.897282855882018, 13.732568645488366, 14.802469432702505, 10.877990686202796, 10.791530152609889, 16.24465205956834, 12.166355651248963, 10.046772314436431, 14.322419201742072, 14.375896836608339, 9.831104055649872, 13.749221676684952, 15.14131574675082, 14.134179033711895, 14.845315569444418, 10.070872898148576, 14.017907868995291, 12.423409929666063, 12.004103103417307, 15.535816706963981, 17.446661256957796, 18.526354919022396, 16.908336817862736, 12.888555216786877, 14.07594179792239, 15.231723739762023, 13.46836186110855, 13.492988301938377, 15.397870566586795]  # Truncate for embedding
baseline = 13.402061855670103
mean = 13.365704889363032
std = 2.5386144821263903
p5 = 9.566127264672824
p50 = 13.127928421405356
p95 = 17.998690569975903
display_name = "Drug Cost Increase: 1980s to Current"
units = "ratio"

# Create figure with two subplots

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---

# Handle edge case where all samples are identical (zero variance)

if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax1.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key statistics with formatted values in legend (use format_parameter_value for full units)

ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {format_parameter_value(p50, units)}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {format_parameter_value(p5, units)}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {format_parameter_value(p95, units)}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {format_parameter_value(baseline, units)}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---

sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax2.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key percentiles

ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"

exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title

fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark

add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from

output_path = get_figure_output_path('mc-distribution-drug_cost_increase_1980s_to_current_multiplier.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Simulation Results Summary: Drug Cost Increase: 1980s to Current**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 13.4 |
| Mean (expected value) | 13.4 |
| Median (50th percentile) | 13.1 |
| Standard Deviation | 2.54 |
| 90% Confidence Interval | [9.57, 18] |

*The histogram shows the distribution of Drug Cost Increase: 1980s to Current across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
