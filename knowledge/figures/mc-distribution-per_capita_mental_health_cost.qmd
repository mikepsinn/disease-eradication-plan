```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: US Per Capita Mental Health Cost (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata
)

setup_chart_style()

# Simulation results
samples = [1076.8189766756389, 903.8563354171395, 1141.1667553346597, 1169.7689605068936, 802.7478819493098, 873.518627091891, 1052.3016861435444, 993.1783111555719, 1032.6680452947337, 926.1278302937184, 1160.4891756241964, 1145.2366529623378, 1043.866372099747, 1198.5515287633218, 1099.8884877494243, 925.3746077343861, 1085.8349780711885, 913.4519836883642, 1160.3459819336076, 1028.2234937818773, 1010.3150491215912, 947.1179334506634, 1213.5172773913348, 1014.3133848855865, 978.7883022831846, 988.5475895359572, 1109.208295386666, 1085.3675459642532, 1092.0713514257495, 1094.6465654921453, 1323.5294117647059, 981.5850759200704, 968.1515716285123, 930.8757874823076, 1121.3590392936837, 1198.8217223658196, 1019.6874714155861, 927.6832701269318, 929.5787039701222, 1126.4244935933837, 1140.0978249079144, 1110.7757807113944, 949.0215117243581, 1066.6934997723797, 1050.7743680487358, 1064.8238292927713, 1159.2855784397348, 1065.5044092409705, 1130.586081429612, 1044.0768540209078, 1074.6341720539426, 1123.5965734976457, 856.0678928375521, 992.7350078495899, 973.4443332490973, 952.3182282116412, 998.5078068095277, 1257.3328775948594, 924.5870692063191, 1173.9978691333781, 831.2736433307035, 990.7703263811894, 1057.096387773033, 1117.02248416806, 1135.3530900583448, 1147.558664368703, 988.986428628126, 974.4615412753049, 1157.2566032573602, 1009.4679316811113, 876.5372332571689, 892.941659419324, 918.1539787155463, 1104.1433291488295, 1054.3021002216515, 1132.2909161159437, 978.9253429568516, 1056.516590329405, 1122.763257420018, 994.0705345724814, 1098.3522379756387, 949.4644751672563, 987.142920270198, 984.7442329975298, 885.6981234044778, 1102.67950674209, 973.5673322877761, 1036.614778321094, 1101.7859527645792, 1096.8881235519525, 1128.596232224892, 1021.7425104856364, 979.4295229279958, 1024.2424196359075, 830.7905208806945, 857.1881597929743, 871.1877332136631, 908.9002306437368, 1090.2302133400517, 919.8260636168797, 985.2027893434373, 1225.6956271717181, 988.0160618442076, 1139.2462225597455, 916.4620014082655, 1007.6119003246121, 914.5064861143837, 990.2353309337149, 1154.5973351826935, 826.4761241373176, 1095.1601921327, 1067.4680272261676, 957.8808131728425, 857.3058802661521, 1044.6956752208923, 965.9793950947503, 1066.7650182139369, 1037.878691170077, 1274.9465327164537, 1003.1715569976508, 905.7987768511568, 1059.3731111635707, 1065.0052146733103, 1235.3025944338103, 1153.816286523142, 1084.15661785489, 1252.16369817446, 886.514632008769, 952.2098946928079, 917.3027077160048, 983.7097524725905, 865.0850272515909, 1124.1618537183099, 1005.4120428631676, 854.547622327123, 906.7332020204803, 1078.053119434726, 1154.2693994389508, 1323.5294117647059, 1323.5294117647059, 1092.3098227316182, 909.8130116401279, 787.8787878787879, 1071.6427265136842, 930.9765961215594, 980.4427962281252, 955.6449613535691, 1016.1295437681316, 1189.028821536156, 1056.3114747562565, 1013.7713120825288, 904.3661309406299, 832.1602723582316, 971.4265688242834, 1027.7072695525935, 1302.8303500569618, 1052.63526736728, 1176.2106077252217, 969.7851269130891, 886.9556203654759, 912.7107787107642, 941.6707424643012, 1323.5294117647059, 929.9533491022291, 1154.3239047703128, 920.1317587144912, 1168.4001646670308, 1088.1279180522329, 1014.0349526063029, 1029.45108392733, 950.3473982706824, 1096.8225711240889, 975.3969295220484, 882.2718865834877, 876.2803229947061, 1058.4509887313316, 1271.1856422911249, 1056.7163517562694, 1019.0648292453862, 1074.1734444288907, 1226.7771471154117, 1064.920045446561, 981.0085206805849, 1195.2860187731776, 1094.3523301538403, 1264.0328351387461, 1059.9193411251244, 882.4024866830821, 866.046073683874, 1283.1320905244443, 1295.3427909860955, 1011.0182122974326, 984.5583970723071, 1251.8606964686164, 895.9980249075792, 921.1147620795122, 1125.359265872794, 983.0957080593615, 1034.2397042355913, 1013.1368219237463, 1081.4359462371442, 1243.095262368697, 1047.2092163503635, 1125.4489487922708, 791.9743163876037, 1028.3851762328966, 927.3120441991858, 883.0525934331754, 923.1048749994068, 990.86858398578, 1166.0184953685168, 870.7688915699077, 1039.0658474567697, 971.6971051542232, 991.701176136448, 1179.2805454170998, 1110.0472219649982, 1231.8027008211127, 1014.3165286648415, 945.2682394645674, 1005.1978703466443, 1068.1300238036663, 1059.000416523251, 898.6453835068119, 1047.1962452294374, 1066.147361723188, 1323.5294117647059, 1321.4387229346178, 926.1037816088592, 996.9175142565995, 855.3674571756308, 958.3103390391884, 1078.3467062670072, 1210.8832397923304, 941.1978335319632, 950.4267547428925, 787.8787878787879, 1013.2393279980874, 901.2202993193953, 965.9860969994132, 923.260136094184, 1022.3044966236158, 823.2101779166145, 854.9662254318561, 1323.5294117647059, 875.198731227989, 897.1958675184737, 1314.585728628519, 1323.5294117647059, 888.5019219527453, 986.4753780497442, 1081.996679865751, 1296.1917991396936, 910.130686120248, 1002.3982658912571, 1145.1688993117737, 1095.2090248765141, 985.4602249604793, 1017.0519032331968, 865.2867224492643, 1003.3259523131745, 999.646729270486, 1066.6946896359009, 962.7353368798566, 1100.4656927835592, 1180.8106508097105, 1056.08878091843, 1083.434822270185, 1042.1177709069614, 1034.9410708374278, 942.1206120304399, 1078.4715774435335, 1021.9020264330043, 1323.5294117647059, 1270.236495127514, 1088.2548186338622, 937.0434159638867, 895.3722187509754, 1208.5660073616657, 1070.950516206282, 1101.6994096947462, 824.6201419544576, 1167.771307785329, 1098.0154952473333, 895.6031849073746, 973.2983040912939, 1071.0855099451333, 1042.024341595835, 996.2961977684627, 1021.077141502807, 1001.5241959306485, 1055.694623279594, 1253.499612807186, 787.8787878787879, 1003.4988732171505, 1058.9920136680728, 1075.5965656579535, 986.0046377188004, 823.3180852031918, 1080.0879026782563, 1295.964400279574, 847.5600597728943, 1158.1387891654306, 991.5911457140629, 1026.6985237367976, 902.3376790808177, 990.8256549046018, 1225.8259152546282, 1116.5037726744092, 1296.8019057672466, 1206.4070841210976, 1095.8253565930966, 1298.7660275870203, 1095.8120123203626, 1152.7466080524987, 995.7255808464945, 1043.936391320194, 945.0859417935211, 1177.2593441050087, 887.7228368554897, 1145.9166203046168, 1009.553803920923, 1205.4390535405685, 1141.228838353598, 1311.8041123677076, 1138.2466961870946, 843.3570046107345, 1025.9462904981744, 888.4509530228173, 967.390802617969, 1260.002230824995, 1124.5107098132241, 944.9005549069727, 906.9530366599502, 1039.3568618041033, 883.3116801448166, 948.3259750195102, 1077.841962760153, 1202.9404392353356, 1120.3056101532627, 787.8787878787879, 1076.7698534772564, 1044.6826251570033, 1092.23598589424, 1277.3444875994492, 790.5493575021579, 958.2608747544314, 1117.7039769752025, 842.3084671887594, 1254.2273105111765, 1085.7792481288038, 1155.5412466856699, 960.7796543145998, 1150.6134691072377, 1189.4146054097882, 1066.7930509414841, 1067.0046129210098, 1072.0100293952682, 924.8863949103858, 1015.2384423811418, 1014.5784888341304, 1087.9073189493674, 1178.8301616702688, 901.6755348999905, 1018.2198229273491, 1255.1269290447865, 939.4219225535643, 929.8488124797956, 1062.5547843080208, 1155.2104517015855, 1036.4706215796202, 1230.450104864916, 1157.0785182645934, 1154.824664603257, 1112.3624493910409, 1323.5294117647059, 1007.6480958440369, 797.082795465997, 1275.3575598499153, 975.0520421577945, 1049.5702787519256, 1227.3441899839254, 840.0449896217839, 879.2852504685397, 840.1523681423341, 933.258988159254, 1095.9038282510878, 1108.0359322400975, 1072.83824024103, 861.0303787476254, 787.8787878787879, 1042.2803798867178, 973.2664654449914, 1098.7256563267613, 1133.9830360563337, 1053.7278240218316, 1142.6063288355258, 1066.2838416562345, 1108.884167647611, 944.1942359842712, 1011.0060744772227, 1061.7899305520552, 1151.6274402427562, 983.206309294952, 1107.6002091028788, 999.7181536271287, 1019.2102937716727, 1152.9764159341164, 798.2329647264489, 874.1680174730607, 853.2823808747459, 787.8787878787879, 947.4466673126916, 1141.0156017191564, 997.2420019774472, 1061.9301311118586, 1192.6319971946914, 1230.2459290112852, 1025.6544686701482, 1234.401885372256, 1047.4194693789868, 928.0165143729308, 957.8495823466353, 853.4656041146363, 921.9058868081231, 987.7905979148679, 1149.0894740333665, 1294.8544359631271, 864.466226246503, 1089.2444904805698, 903.7904494645168, 1100.9183887101779, 1017.4143441464042, 815.4034099440805, 1167.9018582014633, 956.5283807700051, 965.4251660570553, 900.3595989402054, 950.4098204158248, 1094.2289343831208, 1009.7387421394834, 1080.1816461476883, 1084.869873782858, 1229.1211734889737, 989.7515259206431, 853.874520705898, 1189.2211594415094, 991.2086523901506, 1196.5791152481738, 1087.9049460057486, 1017.4076036759755, 1083.0144243511454, 1323.5294117647059, 1323.5294117647059, 1044.3218758917985, 1056.7437311446822, 1190.6183839838561, 927.0185831152993, 1080.8018726793928, 1031.4502772117585, 1078.1084798582979, 928.5035522896268, 841.4344430167048, 789.4882484114705, 894.7926553538507, 974.9281522685135, 996.163830303123, 1323.6515845377162, 1195.2400527633392, 913.0704349952118, 1082.8639026897763, 981.5003107167722, 997.3095573825608, 1060.2079973132873, 1121.825169299764, 990.2062671495406, 1188.699289927186, 891.9363581230419, 1035.7843039610234, 1323.5294117647059, 1065.4328479767717, 1247.267484906131, 1047.3367569096922, 1116.2307571048304, 1027.3058025817395, 1012.2184399709982, 935.0414507966558, 1094.5724999839686, 926.3095500785932, 1128.6256426634754, 1192.0217678415904, 1085.5212286390838, 997.0648118408496, 1097.950478139733, 994.1577140898918, 1169.004941257024, 815.3502966102723, 990.6771418271658, 798.4803646800992, 851.8530215082988, 1236.054746899669, 1162.877196819214, 942.3755414016467, 851.0278746499044, 787.8787878787879, 964.2196990244355, 1323.5294117647059, 1095.2258809967593, 962.2033238329793, 1099.5406457285233, 844.5748439245046, 995.628031741762, 1048.4225013922871, 1023.3915560625707, 1147.1790191497669, 1082.4320683663793, 1129.028501314772, 946.200494498404, 1163.2755655254734, 1279.4631116364976, 912.1128523442554, 921.9584909826805, 1231.5438865112776, 1009.462718356171, 1242.5028985836543, 976.9791817552526, 1250.8180940040825, 1052.8013074848334, 1070.3203291785014, 1268.808758346229, 987.3078954956563, 915.5669045985254, 976.2125714151489, 1097.7172350600947, 844.0470558992441, 1124.5014985282262, 964.8130173888084, 1201.7663313354617, 787.8787878787879, 934.179421831498, 830.8842396339584, 929.3671158595, 1068.8492025937692, 1011.0567312382082, 1001.3416131237503, 1013.6987073261564, 1062.704504229852, 907.5651374279803, 1134.7062029460858, 1128.1967072994473, 1088.1402408819042, 1112.7125812330473, 1075.6559523952521, 1323.5294117647059, 1023.2591704352437, 994.3635417420784, 938.2068881989901, 904.7655504938958, 880.107173656239, 921.8262464753453, 1025.448491771136, 1080.9742503763327, 1041.8446110823797, 936.7411051777649, 1163.6344825051747, 1139.5276802782041, 1013.637537616758, 950.5790245030872, 1111.5388041113863, 1060.5736128094659, 857.0749006726668, 1025.8090911701704, 1070.851034982794, 920.5191199985316, 1060.831863153077, 856.3280297783323, 1231.6083157145392, 1217.5388595613501, 1001.4537825089197, 1085.0863786812304, 787.8787878787879, 890.2644044111005, 996.0876487611197, 900.0805452377058, 1135.821814231316, 1323.5294117647059, 887.9180822743338, 928.0086381000002, 1067.150155697862, 1276.4975839883714, 882.6432013674781, 1069.0399227901582, 1311.9156052982191, 834.6479418537509, 875.9230697908157, 979.3902058752378, 967.1000453080792, 1150.4393269834345, 1068.013607499864, 821.3649411947974, 1106.7702509175979, 959.9549128622747, 1221.7469356941779, 953.7192927135293, 952.5988348796095, 1110.4832695896157, 1143.022008797497, 1097.1121274613888, 830.9784614060598, 1110.0355145955014, 904.5246136130016, 1067.1262199136436, 859.8015015815258, 1096.8582688511863, 931.7457411572352, 875.7445403279663, 1135.7365772371504, 1068.011493924513, 955.4110492857664, 1250.1884730282322, 977.2187927033503, 1039.2655921979895, 1071.8104654938666, 954.7035495258136, 1100.4080573595102, 965.4814720523792, 980.917690764926, 1235.8584705811309, 903.7854933969439, 787.8787878787879, 1276.467806297248, 1323.5294117647059, 981.7315299699756, 804.2332449082068, 993.9233158606468, 997.0681593396697, 1009.6494053903747, 895.2583695004448, 1116.0540365109484, 1108.0820351886618, 851.9257014890972, 1133.5760312091475, 1323.5294117647059, 1058.3644966033937, 990.4555746303444, 1015.9691506410073, 1121.2535261764683, 826.1155584150758, 1057.321827053347, 983.625965944079, 1316.4548269224852, 1011.7223034487564, 1285.9688299171967, 896.3836992273773, 1117.1733017205795, 1078.879744192817, 924.1999527869367, 1059.1138761554596, 1211.934610294697, 992.2025119069575, 830.2899967234772, 1032.5656320115452, 920.1921559973141, 989.8089054058478, 1023.9931095529562, 828.8112856777071, 838.580654706083, 1101.9753690950256, 966.831820243497, 787.8787878787879, 1146.288769895073, 1072.292945068195, 943.063624130404, 871.8538070060692, 1153.9209564873108, 1083.095476411261, 1323.5294117647059, 1093.1321131050006, 1088.5179360655145, 1012.6771720935725, 1151.0648529089112, 1122.6894020952361, 1218.1374917387402, 967.0075549041248, 977.8864170730778, 972.3383334370457, 1147.178361817407, 1257.8950743051455, 974.9071797595976, 979.2413761823964, 1078.132206521365, 1002.3351393055209, 1171.5202407398958, 787.8787878787879, 929.3095654041825, 934.6843017051331, 787.8787878787879, 912.8864875567697, 918.6677493726634, 1008.1805510937537, 1196.3257106757242, 1002.4266154690911, 904.9362692898828, 1027.2828822040829, 1186.4295707368171, 911.4231547851939, 919.2159267544286, 1113.0046446578688, 1005.5019318182084, 1125.9687090338878, 1033.0922864497954, 1133.9402192344855, 904.4339202853197, 1033.3024485231608, 1006.9229973367975, 883.3886562714193, 844.2978001218297, 1131.5928189771103, 988.6996420389115, 905.9423531746954, 1022.0494267640463, 1198.6728994781329, 787.8787878787879, 851.6780210225921, 917.7435013155316, 1251.8174309412818, 1073.7204784285352, 1143.675694646697, 892.1427998100229, 894.5419828593127, 1097.071321486986, 1042.812628950986, 1111.5838030445361, 1009.9456274596768, 1073.0994409472469, 1056.4587286691137, 1145.2329925316824, 1149.6017944651162, 838.1206783521343, 787.8787878787879, 1179.125090906261, 1208.028259357293, 906.1378723934157, 812.3375821831809, 1048.362073551214, 1168.2883798454598, 1307.8725069709312, 1106.8981124309475, 986.0300443843007, 921.3062541114348, 1036.474027472177, 995.3763829117527, 906.7935572362159, 1323.5294117647059, 1305.7580420472634, 1199.9268624678268, 917.9868432117966, 1156.8111694813051, 1124.8171597374378, 1096.3190231010606, 1217.8108274815806, 1124.1940863236116, 1139.6169439097241, 1124.4188280216529, 1081.8890259706398, 820.4404306515477, 1046.260064894992, 962.626939484258, 876.0631697497905, 1288.3033378924208, 1296.2420452223473, 1235.3079065634004, 1069.9001590246112, 1233.9260813013543, 1036.555262366713, 1062.6227316960255, 897.5831354714614, 1089.8352185028677, 1043.0993951420894, 873.4648728785849, 1028.0533106272894, 1024.240905509967, 1307.866826471564, 1162.7300778736064, 1036.473237600797, 1069.0052882109233, 1040.9049503970516, 1007.9430553507303, 898.8748633212296, 1014.7727959984807, 939.1149361919686, 879.4377317630431, 1106.1667783231821, 1089.0228557978467, 820.1097073356374, 1018.5280477560882, 1178.1974815537903, 1187.9832026071801, 1182.829806935052, 1040.186957711, 927.0929071383578, 898.7260386755095, 1082.4263852459671, 1087.324715909838, 1223.79830376236, 1194.3044766951991, 1017.2630630322594, 880.1376474492898, 992.8079965916518, 1064.6217756369626, 1008.0520926585586, 959.9105121531531, 1069.5758018722856, 969.1965813319149, 953.6598658623957, 1077.7638427241595, 982.1504884148005, 1068.35363717976, 1072.4094362968174, 892.2278290584521, 972.0676847502667, 1248.0086858472, 889.6001984395457, 787.8787878787879, 812.1250269182535, 1038.8600045230921, 1039.1045145984108, 1019.201177984747, 1212.1983355092877, 787.8787878787879, 1089.6851693952638, 1268.2670017002458, 893.5821330325838, 984.9919165144738, 938.284547671054, 921.1604571546299, 991.8834087317373, 1246.3373538208298, 1314.666721977487, 990.6343338741553, 1323.9758894857914, 1039.7351132757394, 1300.4170452157014, 1022.4328160472456, 1052.7426370200897, 1085.371843508444, 1323.5294117647059, 1156.2488891410258, 943.8757054439469, 1174.1078656014654, 987.2999171852282, 970.9912485572252, 1164.9104870079611, 1039.1272877982742, 1073.1598324410888, 1036.8160664040965, 1081.29634726285, 1093.8123198873782, 804.2197473425394, 1128.770765575055, 910.704177095772, 857.7255742528155, 1027.0880455807396, 1046.3091007499536, 945.5681776549326, 1153.203559285083, 868.9812438602069, 981.5174987916791, 959.038462293091, 1028.6705914710396, 1073.2001295293016, 907.6411385726373, 1137.2848998982995, 1043.4548310194282, 808.9481144577873, 801.9584353252131, 1033.2708782994991, 1005.5764063587245, 1021.0862031215065, 1031.1656379161454, 1065.7769725438375, 1170.8486144639044, 895.5245624223397, 888.4550714515136, 897.6003763233066, 1074.605804165171, 1217.0629250864736, 978.4045472823964, 787.8787878787879, 828.9903843177912, 928.5437027588958, 962.434311632003, 981.33285303208, 1040.1419796546782, 993.7599544843061, 1186.4552142222335, 947.7239343209835, 925.0101228480081, 1101.5175438856722, 847.363564013555, 1088.799827724263, 1048.8424726890842, 1015.2498364756456, 1272.70686091246, 954.3876568754647, 1323.5294117647059, 1004.9920515093424, 876.3854321502856, 1044.3950980399593, 899.5987217923384, 938.4233581897386, 1089.8411780845431, 1112.5747495320888, 954.3925961106202, 1176.925397796374, 1203.2844201674177, 1247.768983259555, 1108.7901306724364, 1235.9849745846193, 810.1232200399841, 992.9631455186349, 924.4457225447854, 1051.1219640085608, 960.7164086103512, 1012.7787230603255, 1322.3562052343068, 1012.30909607525, 1092.2220527355369, 1004.0976312245028, 1045.183297259242, 1035.7408247436776, 1097.1442282129572, 1204.507125734507, 1282.5417796532822, 1077.506669110899, 1117.506144224747, 890.9002550174068, 1023.1549054966441, 1169.7270355293351, 1158.461647865272, 1063.8427773382093, 1161.546817395498, 1103.2244243738999, 1210.00889484787, 1074.6677220009647, 988.0888369470243, 1081.1918987648708, 787.8787878787879, 1087.8353406712506, 787.8787878787879, 826.8913090969864, 1097.6364292688181, 1101.3244741652845, 889.5597414208873, 943.2813436233358, 1237.130154607318, 971.7147306879109, 1323.5294117647059, 1034.6710104675014, 1091.4037191250893, 1277.4550517519683, 1052.7384273321811, 908.2971844256847, 1020.2479387378921, 1030.1418967021466, 866.4315546651471, 1001.0216299462061, 939.5927188095603, 1167.3029536476085, 1039.6045278297108, 997.5132127310085, 1020.7190645214732, 1065.4387130000196, 1121.4809353479968, 908.6084980807085, 903.6676314639282, 1195.0355424422307, 980.828470989173, 860.5734900044655, 1096.499919287115, 1099.2957888451326, 847.9073474451914, 1066.3213772914407, 1138.959588432646, 1086.6320901318818, 1123.6980056571406, 861.9835352975535, 1080.5161911908915, 994.941629486324, 971.8716357101192, 1159.15377867334, 1254.770527291455, 1307.3234933590886, 1228.1846542344463, 1020.2470446766167, 1083.5707935980115, 1143.6020755165973, 1051.3891776096377, 1052.7023859724632, 1152.11109722384]  # Truncate for embedding
baseline = 1044.7761194029852
mean = 1041.060302901851
std = 130.0521807656107
p5 = 832.2241468926143
p50 = 1033.156762818728
p95 = 1281.764786218911
display_name = "US Per Capita Mental Health Cost"
units = "USD/person/year"

# Create figure with two subplots
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
# Handle edge case where all samples are identical (zero variance)
if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Mark key statistics
ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {p50:,.2g}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {p5:,.2g}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {p95:,.2g}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {baseline:,.2g}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---
sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Mark key percentiles
ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"
exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title
fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark
add_watermark(fig)

# Save PNG (same directory as the QMD file)
output_path = Path('mc-distribution-per_capita_mental_health_cost.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 1,045 |
| Mean (expected value) | 1,041 |
| Median (50th percentile) | 1,033 |
| Standard Deviation | 130.1 |
| 90% Confidence Interval | [832.2, 1,282] |

*The histogram shows the distribution of US Per Capita Mental Health Cost across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
