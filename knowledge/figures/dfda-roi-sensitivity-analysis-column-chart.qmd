```{python}
#| warning: false
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path
from dih_models.parameters import *

# --- Import centralized style ---

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines,
    COLOR_BLACK, COLOR_WHITE, PATTERN_DIAGONAL, PATTERN_HORIZONTAL, get_figure_output_path)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# --- Data from current parameters ---
# Three-tier ROI based on different health benefit scenarios (all use $1B campaign cost)

scenarios = ['Historical Rate\n(Existing Drugs Only)', 'Lag Elimination\n(PRIMARY)', 'Innovation Acceleration\n(With Cascading Effects)']
roi_parameters = [
    TREATY_ROI_HISTORICAL_RATE,        # Conservative: $251T / $1B = 250,920:1
    TREATY_ROI_LAG_ELIMINATION,        # PRIMARY: $1,286T / $1B = 1,286,242:1
    TREATY_ROI_INNOVATION_ACCELERATION # Optimistic: $2,572T / $1B = 2,572,484:1
]
roi_values = [float(roi) for roi in roi_parameters]

# Format benefit labels with parameter formatter

benefit_historical = format_parameter_value(HISTORICAL_PROGRESS_ECONOMIC_LOSS_TOTAL)
benefit_primary = format_parameter_value(DISEASE_ERADICATION_DELAY_ECONOMIC_LOSS)
benefit_optimistic = format_parameter_value(DISEASE_ERADICATION_PLUS_ACCELERATION_ECONOMIC_LOSS_TOTAL)

benefits = [
    f'{benefit_historical} benefit',
    f'{benefit_primary} benefit',
    f'{benefit_optimistic} benefit'
]

# --- Create figure ---

fig, ax = plt.subplots(figsize=(10, 7))

# Create bars with patterns to distinguish

bars = ax.bar(
    range(len(scenarios)),
    roi_values,
    color=COLOR_WHITE,
    edgecolor=COLOR_BLACK,
    linewidth=2.5,
    width=0.7
)

# Different patterns for each bar - match investment returns chart

bars[0].set_hatch(PATTERN_DIAGONAL)  # Diagonal for historical rate (conservative)
bars[1].set_facecolor(COLOR_BLACK)   # Black fill for PRIMARY (lag elimination)
bars[1].set_hatch(None)
bars[2].set_hatch(PATTERN_DIAGONAL)  # Diagonal for innovation acceleration (optimistic)

# --- Add value labels above bars ---

for i, (roi_param, roi, benefit) in enumerate(zip(roi_parameters, roi_values, benefits)):
    # ROI value above bar (all are large values)
    roi_formatted = format_parameter_value(roi_param)
    ax.text(
        i, roi + max(roi_values)*0.05,
        f'{roi_formatted}:1',
        ha='center', va='bottom',
        fontsize=22,
        color=COLOR_BLACK
    )

    # Benefit label - place inside bar
    # All columns use black text on white background
    ax.text(
        i, roi/2,
        benefit,
        ha='center', va='center',
        fontsize=16,
        color=COLOR_BLACK,
        bbox=dict(boxstyle='round,pad=0.6', facecolor=COLOR_WHITE,
                  edgecolor=COLOR_BLACK, linewidth=2.5)
    )

# --- Styling ---

ax.set_title(
    '1% treaty Return on Investment\nThree Health Benefit Scenarios',
    fontsize=19, fontweight='bold',
    color=COLOR_BLACK, pad=25
)

ax.set_ylabel(
    'Return on Investment\n(Total Benefit รท $1B Campaign Cost)',
    fontsize=18,
    color=COLOR_BLACK, labelpad=15
)

ax.set_xticks(range(len(scenarios)))
ax.set_xticklabels(scenarios, fontsize=14)

# Set y-axis limits to give space for labels above

ax.set_ylim(0, max(roi_values) * 1.15)

# Remove y-axis (data is labeled)

ax.set_yticks([])
ax.spines['left'].set_visible(False)

# Clean up chart

clean_spines(ax)
ax.spines['bottom'].set_linewidth(2.5)
ax.tick_params(axis='x', length=0)  # Remove x-axis ticks

# Add watermark

add_watermark(fig)

# --- Save figure ---

output_path = get_figure_output_path('dfda-roi-sensitivity-analysis-column-chart.png')

plt.savefig(output_path, dpi=200, bbox_inches=None, facecolor=COLOR_WHITE)

# Add metadata

from dih_models.plotting.chart_style import add_png_metadata, get_figure_output_path
add_png_metadata(
    output_path,
    title="1% treaty Return on Investment - Three Health Benefit Scenarios",
    description=f"ROI analysis across three health benefit tiers based on $1B campaign cost. Historical Rate (existing drugs only): {float(TREATY_ROI_HISTORICAL_RATE):,.0f}:1 ({benefit_historical}). Lag Elimination PRIMARY: {float(TREATY_ROI_LAG_ELIMINATION):,.0f}:1 ({benefit_primary}). Innovation Acceleration: {float(TREATY_ROI_INNOVATION_ACCELERATION):,.0f}:1 ({benefit_optimistic}). All scenarios show total one-time benefits divided by campaign investment."
)

plt.show()
```
