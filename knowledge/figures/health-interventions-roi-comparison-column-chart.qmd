```{python}
#| echo: false
from dih_models.parameters import *
```

```{python}
#| echo: false
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

# Find project root dynamically

# Import centralized style

from dih_models.plotting.chart_style import setup_chart_style, add_watermark, clean_spines
from dih_models.plotting.chart_style import COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
from dih_models.parameters import format_parameter_value

setup_chart_style()

# ROI Data from intervention-comparison-table.qmd
# Using central/conservative estimates where ranges exist

interventions = {
    'Decentralized Framework for Drug Assessment': {
        'roi': float(TREATY_COMPLETE_ROI_ALL_BENEFITS),  # PRIMARY: includes R&D + disease eradication delay
        'category': 'proposed',
        'note': 'Leverages all global R&D'
    },
    'Smallpox Eradication': {
        'roi': float(SMALLPOX_ERADICATION_ROI),
        'category': 'historical',
        'note': 'One-time historical achievement'
    },
    'Tobacco Control': {
        'roi': 100,  # Conservative from 20:1 to 1,057:1 (no parameter exists)
        'category': 'current',
        'note': 'Highly variable by program'
    },
    'Childhood Vaccinations': {
        'roi': float(CHILDHOOD_VACCINATION_ROI),
        'category': 'current',
        'note': 'US programs'
    },
    'Clean Water & Sanitation': {
        'roi': float(WATER_FLUORIDATION_ROI),
        'category': 'current',
        'note': 'Low/middle-income countries'
    },
    'Statins (High-Risk)': {
        'roi': 3,  # From intervention table (no parameter exists)
        'category': 'current',
        'note': 'Pharmaceutical intervention'
    }
}

# Create figure - adjusted for tighter layout

fig, ax = plt.subplots(figsize=(14, 8))

# Prepare data

names = list(interventions.keys())
rois = [interventions[name]['roi'] for name in names]
categories = [interventions[name]['category'] for name in names]

# Define colors and patterns for categories

category_styles = {
    'proposed': {'color': COLOR_WHITE, 'hatch': '///', 'edge': COLOR_BLACK},
    'historical': {'color': COLOR_WHITE, 'hatch': '...', 'edge': COLOR_BLACK},
    'current': {'color': COLOR_WHITE, 'hatch': '', 'edge': COLOR_BLACK}
}

# Create bars

x_pos = np.arange(len(names))
bars = []
for i, (name, roi, cat) in enumerate(zip(names, rois, categories)):
    style = category_styles[cat]
    bar = ax.bar(x_pos[i], roi, width=0.7,
                 color=style['color'], edgecolor=style['edge'],
                 linewidth=2, hatch=style['hatch'])
    bars.append(bar)

    # Add value labels above bars
    ax.text(x_pos[i], roi + max(50, roi * 0.01),
            format_parameter_value(roi, "USD"),
            ha='center', va='bottom',
            fontsize=24, color=COLOR_BLACK, weight='bold')

    # Add intervention name below the bar (on x-axis area)
    label_lines = name.replace(' ', '\n')
    ax.text(x_pos[i], -80,
            label_lines,
            ha='center', va='top',
            fontsize=14, color=COLOR_BLACK, weight='bold',
            linespacing=1.1)

# Axis formatting - remove both x-axis and y-axis

ax.set_ylabel('')
ax.set_xlabel('')
ax.set_xticks([])  # Remove x-axis ticks and labels
ax.set_yticks([])  # Remove y-axis ticks

# Y-axis formatting - add space below for labels, increase top space for values

ax.set_ylim(-400, max(rois) * 1.15)

# Title - positioned higher to avoid overlap with labels

ax.set_title('Return on Investment Comparison: Health Interventions',
            fontsize=24, color=COLOR_BLACK, weight='bold', pad=15, y=0.98)

# Add explanatory callout in the empty space above smaller bars

callout_text = ('For every $1 invested, the intervention generates\nthe shown dollar amount in benefits.\n\nA decentralized framework for drug assessment\nachieves the highest ROI through:\n• $50B annual R&D cost savings\n• Faster access to new treatments\n• Better prevention via real-world data\n• New therapies for rare/neglected diseases')
ax.text(0.72, 0.65, callout_text,
        transform=ax.transAxes, ha='center', va='center',
        fontsize=16, color=COLOR_BLACK,
        bbox=dict(boxstyle='round,pad=0.6', facecolor=COLOR_WHITE,
                  edgecolor=COLOR_BLACK, linewidth=1.5, alpha=0.95),
        linespacing=1.3)

# Clean spines - remove all spines since no axes

clean_spines(ax, ['top', 'right', 'left', 'bottom'])

# Add watermark

add_watermark(fig)

# Save figure with tight bbox to minimize whitespace

output_path = get_figure_output_path('health-interventions-roi-comparison-column-chart.png')

# Save the figure

plt.savefig(output_path, dpi=200, bbox_inches=None, pad_inches=0.1, facecolor=COLOR_WHITE)

# Add metadata for attribution

add_png_metadata(output_path, title="Decentralized Framework for Drug Assessment ROI Comparison")

plt.show()
```
