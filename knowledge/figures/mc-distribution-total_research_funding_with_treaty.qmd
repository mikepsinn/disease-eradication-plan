```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Total Global Research Funding (Baseline + 1% Treaty Funding) (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata
)

setup_chart_style()

# Simulation results
samples = [96446504235.90692, 87586832422.50783, 99661168623.36755, 101077271709.28636, 82237520199.46948, 85996171337.81139, 95210730586.14072, 92204376914.29535, 94216576285.93198, 88747145100.74944, 100618664446.26299, 99863139209.14581, 94784107067.31955, 102494691549.02228, 97603703331.69133, 88708003602.11923, 96899397788.30984, 88087508558.58261, 100611581549.9751, 93990954565.6582, 93079685755.45154, 89835132450.63225, 103228747869.45273, 93283444310.0745, 91466815662.61444, 91967285089.90079, 98069690552.79031, 96875937884.42413, 97212183983.09308, 97341230336.26201, 108180000000.0, 91610348930.45592, 90920106840.45154, 88993714784.34212, 98675942075.88646, 102507961974.17024, 93557036240.58385, 88827952136.25446, 88926382301.61383, 98928254543.37038, 99608096383.10194, 98147980130.26738, 89933539353.59258, 95936890756.62021, 95133540646.93466, 95842675270.84042, 100559124078.7261, 95876974888.54254, 99135359659.03209, 94794761513.60948, 96336632261.49586, 98787425245.00458, 85075743355.68805, 92181690357.63943, 91192308329.9083, 90103863693.45932, 92476947241.71933, 105366618951.97691, 88667071420.14145, 101286000747.43192, 83760898578.11224, 92081118876.34552, 95452893820.83435, 98459738594.76344, 99372389638.22296, 99978299878.72942, 91989763931.79399, 91244585260.98228, 100458722777.21573, 93036493350.22403, 86154976581.18442, 87015919266.35928, 88332426779.50583, 97816550491.79347, 95311793579.84076, 99220154180.07997, 91473850814.2441, 95423623094.1098, 98745911676.7974, 92250030771.4797, 97526808743.9645, 89956432495.33124, 91895318459.7895, 91772372719.48746, 86636191154.099, 97743343461.59853, 91198630199.9719, 94416749203.62672, 97698645620.2561, 97453502917.61398, 99036353853.07954, 93661573913.62225, 91499731662.67462, 93788679782.89017, 83735194141.68863, 85134953401.57147, 85873463809.61928, 87850153777.05534, 97119882116.531, 88419456516.40128, 91795881272.28455, 103824626489.87585, 91940055501.94495, 99565806673.16594, 88244326431.38501, 92941831257.68497, 88142459539.2456, 92053725071.18286, 100327073987.61246, 83505502482.4701, 97366960707.0534, 95975909784.63025, 90390962241.97977, 85141174360.8272, 94826083089.79663, 90808299967.97925, 95940493961.16154, 94480817934.36655, 106221425964.58165, 92715208286.9212, 87688277325.48346, 95567798948.84274, 95851817132.28821, 104293777010.54298, 100288395092.73795, 96815152468.20691, 105115258773.13083, 86679028829.58118, 90098268707.49474, 88288105992.18893, 91719329800.3396, 85551852801.08868, 98815582159.47218, 92829583872.4033, 84995364645.34186, 87737061185.22705, 96508546711.06265, 100310834732.46326, 108180000000.0, 108180000000.0, 97224136790.01349, 87897772236.25314, 81232497592.31647, 96186115836.50871, 88998946970.6453, 91551736778.02512, 90275608365.40671, 93375939338.59676, 102026569914.54181, 95413267117.30908, 93255830116.15462, 87613461333.50198, 83808063018.83696, 91088574917.54099, 93964735342.33984, 107569405435.74585, 95227586368.23126, 101395150896.52858, 91004153562.09308, 86702161457.90645, 88048875472.62665, 89553296786.92139, 108180000000.0, 88945832489.88354, 100313533885.85388, 88435363791.99625, 101009675868.99759, 97014446006.66364, 93269260856.03555, 94053292790.25345, 90002056581.95474, 97450220314.66093, 91292646746.84924, 86456341378.81836, 86141465495.94754, 95521266379.92867, 106039124157.47289, 95433708326.11087, 93525354010.81842, 96313456434.0494, 103877481876.17769, 95847524627.63821, 91580766844.7413, 102334255926.9739, 97326489289.34288, 105692080338.05975, 95595358886.15019, 86463199622.48819, 85602532481.43942, 106617799619.1886, 107208060672.50685, 93115532285.11725, 91762844891.93414, 105100517774.88133, 87175941205.12715, 88486507938.86726, 98875215699.91127, 91687838953.64359, 94296308667.33492, 93223503914.42776, 96678527772.174, 104673742178.80666, 94953264117.58568, 98879681532.26399, 81684792544.89967, 93999165887.12251, 88808669177.06586, 86497335583.3883, 88590013969.2382, 92086149688.89, 100892019616.01495, 85851406724.54164, 94540980299.01291, 91102485938.91165, 92128774232.22173, 101546510807.22977, 98111594558.69926, 104122954373.1646, 93283604450.61935, 89739469753.16193, 92818652889.6536, 96009254848.8141, 95548992924.88022, 87314452471.53088, 94952607971.54141, 95909373776.45145, 108180000000.0, 108180000000.0, 88745895509.09605, 92395647067.33281, 85038714272.63953, 90413115951.75365, 96523303540.87804, 103099694736.04509, 89528811881.5132, 90006156787.46994, 81180000000.0, 93228726725.10458, 87449088032.16579, 90808645014.65381, 88598087068.51189, 93690153558.51065, 83331454532.50406, 85017499857.6465, 108180000000.0, 86084574359.31161, 87238624047.89575, 108135799280.19336, 108180000000.0, 86783254922.86552, 91861109856.4176, 96706692418.08276, 107249056139.73824, 87914342404.96007, 92675719251.53142, 99859778186.68143, 97369406869.37573, 91809078033.37859, 93422900293.77142, 85562489984.76651, 92723091872.1651, 92535154745.71011, 95936950704.13051, 90641218605.65558, 97632588367.14188, 101621918836.45009, 95402023143.14304, 96778913170.12396, 94695575959.77325, 94331881402.60988, 89576586334.84659, 96529579791.77988, 93669686400.48897, 108180000000.0, 105993097502.52971, 97020811693.8632, 89313600855.86609, 87143185628.3782, 102986112591.89091, 96151273783.78047, 97694316095.51997, 83406612429.12712, 100978614959.38762, 97509950474.16284, 87155275304.61766, 91184802537.75276, 96158069010.69215, 94690844751.72774, 92363875949.63739, 93627732325.05328, 92631075812.90787, 95382120567.36867, 105180241581.98096, 81180000000.0, 92731921078.69997, 95548568903.47668, 96385036226.29709, 91836983445.16211, 83337207505.13853, 96610804904.75734, 107238076463.97878, 84625520244.5487, 100502381363.96957, 92123141674.57892, 93913492458.7772, 87507486729.54008, 92083951723.20361, 103830994389.38565, 98433865430.18565, 107278512313.86127, 102880247376.10924, 97400278521.22313, 107373320299.46782, 97399610155.51154, 100235413465.9624, 92334693550.58919, 94787651442.90897, 89730039448.32861, 101446867384.14798, 86742400830.34149, 99896867615.03604, 93040872121.94519, 102832765482.52318, 99664250702.57634, 108001876593.21765, 99516162398.65753, 84402736339.12619, 93875272900.74493, 86780582425.32524, 90880954566.48404, 105496332423.31635, 98832957327.92711, 89720448930.19937, 87748536573.11417, 94555725949.02837, 86510938240.9369, 89897588065.31033, 96497932602.8531, 102710169960.22958, 98623439082.21976, 81180000000.0, 96444034407.16069, 94825422603.88177, 97220435955.0977, 106337600821.11458, 81612358498.95023, 90410564836.59544, 98493727252.0069, 84347120620.2693, 105215632570.8519, 96896600879.54431, 100373810510.95712, 90540434109.75584, 100129726124.31308, 102045550328.43399, 95941906276.9189, 95952564711.42712, 96204601843.76155, 88682629719.67224, 93330561013.63266, 93296948023.36732, 97003379754.3562, 101524310521.39638, 87472882356.47578, 93482350346.49478, 105259378592.57068, 89436839917.25787, 88940405507.60245, 95728286166.09714, 100357432586.2755, 94409440702.20197, 104056908550.64098, 100449908629.6594, 100338330664.20868, 98227203272.17558, 108180000000.0, 92943677680.64874, 81944189126.29675, 106241342577.06058, 91274927149.58588, 95072669266.75919, 103905189984.61952, 84227011394.40971, 86299442640.88962, 84232710926.17926, 89117374972.1639, 97404208843.001, 98011119943.67981, 96246279839.1243, 85337899992.95088, 81180000000.0, 94703810166.64182, 91183166021.91177, 97545501776.8856, 99304288734.32666, 95282784839.20303, 99732626087.25946, 95916250559.97899, 98053498664.37549, 89683905554.72337, 93114913557.81616, 95689715664.31284, 100179969117.15817, 91693511379.25858, 97989348009.69809, 92538804584.81134, 93532756137.33194, 100246796852.65723, 82002531974.55078, 86030345089.57874, 84928445847.6015, 81180000000.0, 89852129676.67194, 99653664527.57784, 92412238079.74686, 95696786235.86795, 102203792423.8946, 104046937483.86565, 93860444334.42003, 104249825357.7972, 94963899550.19016, 88845260739.76407, 90389351361.12689, 84938137891.4866, 88527660280.58562, 91928504262.84338, 100054192889.36942, 107184477154.41695, 85519214533.82088, 97070450834.84875, 87583390663.83554, 97655240286.16583, 93441351043.3198, 82914805643.11255, 100985063491.13976, 90321193490.27855, 90779763749.7135, 87404093636.35304, 90005281827.66693, 97320306963.83188, 93050302160.4044, 96615514976.01707, 96850957839.2106, 103992002801.71152, 92028949628.26973, 84959766901.82452, 102036033031.43298, 92103560430.5462, 102397797631.287, 97003260714.06982, 93441007919.85017, 96757803759.86003, 108180000000.0, 108180000000.0, 94807163756.97507, 95435090579.9701, 102104767118.25699, 88793424441.79468, 96646675550.62009, 94154779044.3855, 96511329410.99585, 88870554897.98586, 84300749745.21375, 81558397618.27911, 87112846003.60547, 91268561609.97804, 92357106759.17807, 108180000000.0, 102331996918.59634, 88067622332.85782, 96750245191.56136, 91606000007.5182, 92415692030.01552, 95609921731.04906, 98699170595.31854, 92052236802.15958, 102010356024.81213, 86963258641.8168, 94374642522.28409, 108180000000.0, 95873368595.4223, 104876962994.67374, 94959715680.87054, 98420246445.92299, 93944342695.35864, 93176706073.31973, 89209818819.88556, 97337519771.93187, 88756587197.87012, 99037817459.54074, 102173786473.21785, 96883651292.43279, 92403178518.63684, 97506695408.39124, 92254491148.66394, 101039543945.57034, 82911967997.92685, 92076347704.52617, 82015078573.10822, 84852820756.92587, 104330474225.9316, 100736756810.39406, 89589782837.2737, 84809150957.53949, 81180000000.0, 90717684146.3656, 108180000000.0, 97370251231.84622, 90613806180.46033, 97586294696.70805, 84467313089.37985, 92329704344.44958, 95014630474.98778, 93745425922.36098, 99959474772.40657, 96728559004.41924, 99057864827.03334, 89787689336.30917, 100756451773.11267, 106440203180.29163, 88017705361.63823, 88530396345.47308, 104110317971.34804, 93036227511.28958, 104644877229.79668, 91373922056.50586, 105049789329.89845, 95235975902.14893, 96119549364.33849, 105923848622.91974, 91903771936.02316, 88197704858.62369, 91334547292.32838, 97495017803.61948, 84439329272.08882, 98832498564.69476, 90748241199.68327, 102652542680.54794, 81180000000.0, 89165116227.2799, 83740180684.94632, 88915396673.85252, 96045475092.49654, 93117495783.46182, 92621749256.08153, 93252131250.38011, 95735835622.00082, 87780485088.53511, 99340237233.02112, 99016470724.5118, 97015064161.28447, 98244682201.39693, 96388022795.71492, 108180000000.0, 93738695360.33934, 92265021597.19485, 89373893100.57475, 87634322521.35289, 86342632813.15448, 88523517937.6447, 93849977317.6399, 96655335221.9849, 94681743038.55634, 89297932146.49295, 100774195019.44066, 99579784341.85783, 93249014900.76285, 90014024081.46838, 98186081343.59332, 95628365967.6, 85128968027.19887, 93868301400.82344, 96146266043.02805, 88455519025.16629, 95641393108.24686, 85089494014.88455, 104113463729.91016, 103425665026.3869, 92627479051.75275, 96861825344.70135, 81180000000.0, 86875648095.84851, 92353210793.09723, 87389503671.89474, 99395684263.09142, 108180000000.0, 86752639951.89842, 88844851664.23618, 95959896848.66, 106296575925.05841, 86475839766.8576, 96055079505.06247, 108007245683.60226, 83940336648.95175, 86122675869.32678, 91497713522.33041, 90865989234.5236, 100121096285.21121, 96003391234.55147, 83233052013.31781, 97947872016.56297, 90497918309.31013, 103631561871.36667, 90176210465.36584, 90118355241.22252, 98133372210.0817, 99753255925.5797, 97464719812.6321, 83745193868.77753, 98111009828.44278, 87621738927.6424, 95958691029.4866, 85273012065.70398, 97452007919.12436, 89038863188.83138, 86113285537.92221, 99391448316.43228, 96003284777.4628, 90263536781.25052, 105019150273.9827, 91386227608.56491, 94551101429.87004, 96194558152.6445, 90227020657.65976, 97629704269.93265, 90782663003.50415, 91576106167.44838, 104320898453.87543, 87583131765.9392, 81180000000.0, 106295133354.42952, 108180000000.0, 91617862638.57198, 82317132441.40776, 92242498407.11566, 92403349676.28726, 93045746907.97174, 87137226060.63968, 98411430608.53537, 98013423476.82655, 84856666805.41736, 99284054393.47816, 108180000000.0, 95516901320.119, 92065002778.83917, 93367772142.49605, 98670683779.11954, 83486294694.0213, 95464274041.20981, 91715033118.63472, 108180000000.0, 93151420667.23686, 106755035602.1122, 87196125454.57826, 98467260834.01381, 96550093882.91286, 88646948318.77249, 95554718205.99225, 103151213363.61844, 92154436340.20578, 83708560407.84846, 94211379802.4423, 88438506513.25555, 92031888144.7929, 93776006856.08646, 83629855209.95801, 84149270245.77368, 97708121367.57065, 90852182770.05222, 81180000000.0, 99915325492.72289, 96218839779.47742, 89625397774.22745, 85908535892.72688, 100293578864.0231, 96761873760.30458, 108180000000.0, 97265347769.67003, 97034009881.81801, 93200082770.6291, 100152093707.1513, 98742232078.40529, 103454964953.7688, 90861228530.52737, 91420510907.716, 91135454622.32103, 99959442176.71236, 105393943106.58284, 91267484011.9367, 91490073948.98804, 96512522025.69498, 92672495323.27512, 101163730762.15279, 81180000000.0, 88912408567.0629, 89191299084.11618, 81180000000.0, 88058034388.49321, 88359171521.68439, 92970837866.45424, 102385346719.4703, 92677167074.08109, 87643238338.78854, 93943178394.71887, 101898652721.74977, 87981745643.6082, 88387703731.95564, 98259261378.78445, 92834171492.63695, 98905561877.10727, 94238101222.38736, 99302160160.70192, 87617002028.63153, 94248763606.01083, 92906685850.45285, 86514979499.49231, 84452624442.82874, 99185435821.57997, 91975073986.74844, 87695773778.85054, 93677182478.81915, 102500652692.46005, 81180000000.0, 84843559861.20755, 88311056701.7518, 105098412848.37015, 96290668920.70569, 99785694477.39354, 86974073718.75662, 87099722193.67912, 97462676509.07451, 94730760276.8627, 98188328165.69452, 93060850839.21515, 96259422766.07124, 95420701790.36548, 99862957629.04819, 100079587287.33421, 84124844107.48477, 81180000000.0, 101538848363.05336, 102959747381.95848, 87705981874.2352, 82750943842.67029, 95011574481.57135, 101004154786.96918, 107812481113.68294, 97954262158.34575, 91838285653.28943, 88496469586.12018, 94409613377.71756, 92316833124.60504, 87740211793.39722, 108180000000.0, 107710570532.33612, 102562233586.5768, 88323725702.8349, 100436675899.35944, 98848219438.40346, 97425003218.32, 103438976829.52892, 98817187589.83885, 99584217168.0449, 98828381166.60974, 96701285403.01479, 83183731698.58224, 94905246464.3648, 90635633605.95439, 86130044584.66548, 106867925012.35931, 107251482153.62433, 104294036204.30873, 96098395195.99431, 104226604850.41759, 94413731872.94354, 95731712364.24995, 87258885785.21674, 97100075387.6517, 94745279264.67993, 85993342308.27899, 93982311216.73938, 93788602818.89383, 107812207379.64275, 100729483019.8034, 94409573332.0004, 96053335382.04402, 94634152200.85358, 92958723754.70096, 87326454782.30646, 93306845041.21393, 89420937672.49411, 86307455847.909, 97917710057.57687, 97059335122.12227, 83166085493.73615, 93498037282.16985, 101493121366.12863, 101975119113.23099, 101721396054.73415, 94597781822.0711, 88797285530.57057, 87318670994.65343, 96728273592.52669, 96974151385.04573, 103731877036.88731, 102286013729.07782, 93433649962.72375, 86344233971.47299, 92185425792.59338, 95832491323.54822, 92964285574.43906, 90495629206.15115, 96082063652.45549, 90973876348.48196, 90173142312.43317, 96494005666.53914, 91639355615.62668, 96020517334.95561, 96224702046.31252, 86978528076.16734, 91121539828.36365, 104913049905.24234, 86840833665.07071, 81317238786.56319, 82739578226.76202, 94530549726.21805, 94542939608.78912, 93532292277.00706, 103164134737.2106, 81180000000.0, 97092550873.41705, 105897567589.41016, 87049462396.95248, 91785070869.23006, 89377916907.25162, 88488885093.05653, 92138102584.75435, 104831671000.16483, 108139697828.85547, 92074155848.13469, 108180000000.0, 94574890542.60425, 107452990553.85674, 93696678725.04721, 95233011483.7921, 96876153583.49333, 108180000000.0, 100408843018.58278, 89667423537.62616, 101291427722.6446, 91903363127.44986, 91066188903.65482, 100837265287.5514, 94544093546.29715, 96262461406.47066, 94426953795.51764, 96671515469.95909, 97299432786.2445, 82316409145.72762, 99045039359.48515, 87944252980.05225, 85163351646.07202, 93933280928.82928, 94907727425.4207, 89754984767.7206, 100258047766.64543, 85757239357.7821, 91606881857.2893, 90450665504.04291, 94013660503.02112, 96264488961.97556, 87784451629.37836, 99468383105.9423, 94763273792.76678, 82569626914.69725, 82195194477.66315, 94247161949.35896, 92837972346.82092, 93628193243.87808, 94140332352.56787, 95890710091.72826, 101130576545.32938, 87151159971.23766, 86780798371.66626, 87259787776.7629, 96335205343.78198, 103402368267.68433, 91447113982.7065, 81180000000.0, 83639389463.36508, 88872639970.45828, 90625708429.92325, 91597408262.64151, 94595503247.41737, 92234139827.02328, 101899915015.90318, 89866464801.31238, 88689060507.74554, 97685217579.97755, 84615110325.95895, 97048149027.53412, 95035868455.5759, 93331141299.82257, 106112876420.80093, 90210714609.6233, 108180000000.0, 92808147784.53046, 86146993362.39005, 94810869910.55255, 87364309826.32748, 89385108980.63873, 97100374238.18745, 98237801649.38652, 90210969576.84233, 101430400534.0616, 102727050822.25568, 104901379998.02344, 98048800828.56165, 104327070268.06767, 82632507023.7197, 92193365841.53793, 88659724145.55801, 95151110135.81564, 90537174046.90198, 93205257430.67737, 108180000000.0, 93181326034.1488, 97219737594.02914, 92762490629.2345, 94850761178.77902, 94372437837.50768, 97466327202.35664, 102787046562.42137, 106589233192.92706, 96481077629.63225, 98483861041.10564, 86908970963.20953, 93733394336.57155, 101075201566.40222, 100518357535.02557, 95793224149.67914, 100670973461.0055, 97770597743.92963, 103056843168.81973, 96338319828.4808, 91943783880.61617, 96666268708.74835, 81180000000.0, 96999768891.18855, 81180000000.0, 83527617639.65378, 97490972034.84021, 97675558187.98401, 86838712922.51453, 89636665681.97858, 104382934465.09335, 91103392217.3252, 108180000000.0, 94318184786.96844, 97178717470.04228, 106342956225.79724, 95232798781.24153, 87818688002.7904, 93585551181.99207, 94088365798.05518, 85622856926.9663, 92605403221.66354, 89445686867.40143, 100955479332.81425, 94568274436.42259, 92426104143.73505, 93609518040.45947, 95873664162.24371, 98682016689.6641, 87834932310.97092, 87576974735.41766, 102321945989.61493, 91571528018.12564, 85313777436.04935, 97434062578.89894, 97574039492.52025, 84643917502.44113, 95918141825.84071, 99551571160.15518, 96939398880.58691, 98792477863.59544, 85388215224.74734, 96632323216.54378, 92294594879.75536, 91111459879.19228, 100552603298.03044, 105242048556.30153, 107786023838.99342, 103946253474.35535, 93585505697.48862, 96785740305.71211, 99782041398.94463, 95164615777.71805, 95230977714.85583, 100203931262.21411]  # Truncate for embedding
baseline = 94680000000.0
mean = 94535724650.86603
std = 6563047295.417644
p5 = 83811460414.41083
p50 = 94241372422.9881
p95 = 106551628414.21606
display_name = "Total Global Research Funding (Baseline + 1% Treaty Funding)"
units = "USD"

# Create figure with two subplots
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
n, bins, patches = ax1.hist(samples, bins=50, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Mark key statistics
ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {p50:,.2g}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {p5:,.2g}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {p95:,.2g}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {baseline:,.2g}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---
sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Mark key percentiles
ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"
exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title
fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark
add_watermark(fig)

# Save PNG
project_root = Path.cwd()
while project_root.name != 'decentralized-institutes-of-health' and project_root.parent != project_root:
    project_root = project_root.parent

output_path = project_root / 'knowledge' / 'figures' / 'mc-distribution-total_research_funding_with_treaty.png'
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 9.468e+10 |
| Mean (expected value) | 9.454e+10 |
| Median (50th percentile) | 9.424e+10 |
| Standard Deviation | 6.563e+09 |
| 90% Confidence Interval | [8.381e+10, 1.066e+11] |

*The histogram shows the distribution of Total Global Research Funding (Baseline + 1% Treaty Funding) across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
