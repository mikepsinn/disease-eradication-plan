```{python}
#| echo: false
#| fig-cap: "Probability of Exceeding Threshold: ROI from dFDA R&D Savings Only"

import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Monte Carlo samples

samples = [429.54020415143304, 392.8829760252571, 399.0647807882858, 412.5313865412942, 486.82291753210194, 437.3594597469671, 413.1063683018938, 398.6575687551936, 410.3078504564722, 516.6606965623236, 505.42546136427995, 401.37573528334525, 462.2744920836723, 491.97829538665053, 434.13032136257397, 523.6954591735872, 423.4819484013476, 434.9474310098138, 414.8280493401775, 482.355243694736, 469.4654344329387, 516.8198013893007, 383.32477512805673, 507.10793649229015, 453.08229421251974, 501.14400462342303, 464.43785178239676, 372.6979879558915, 485.7734189880452, 436.88174958007977, 485.36365243543105, 444.0560681407159, 560.9932091891345, 438.1236785970011, 364.22882571973526, 479.1561698908065, 399.55748506481507, 411.0510661468175, 553.9179063578183, 429.3238923295838, 453.22972063461907, 487.3827229277571, 524.4751559436331, 440.9447974648683, 337.92969604686255, 393.52038524436216, 397.07453547902395, 515.545791120508, 515.7432072286217, 381.27816505364007, 433.7920924378026, 527.2103876319903, 506.4633549353586, 503.5563117046495, 506.72901919353586, 507.08071178932346, 448.3535904699826, 328.1731867618548, 513.8036747768643, 468.4388618543533, 456.1630672923429, 591.5648930341133, 298.32194942179757, 291.55822339920735, 355.49554119931, 405.64963939804267, 472.30984466033635, 461.3493318618496, 434.45627158599603, 435.6626146670313, 601.2349330023434, 453.52413903531067, 467.4074102870043, 384.61389058889705, 450.54755502577854, 500.64649805225395, 561.7593596815436, 484.77551100121474, 448.4839321093247, 442.4421643082388, 476.88601127777105, 438.92750554627054, 497.9559394054558, 469.67917698139263, 516.6454676832045, 508.6796335886017, 404.23971581448205, 468.6713297195184, 545.5426955263009, 409.1649530852199, 437.4641662157173, 458.2526574626247, 447.52639478374783, 355.4274816980237, 434.8610765634612, 525.4955488030055, 687.933441813201, 412.554901604452, 424.4561105185394, 573.7284473178767, 451.63701718283386, 414.07594327977284, 428.892187772805, 428.8638546481742, 581.9954830359544, 329.33343103658933, 439.48096568241084, 438.0082469078885, 458.44846101581896, 434.13363096107173, 428.26620582628476, 406.8603614363825, 481.1881506813407, 479.0872462715337, 397.32379129218106, 525.8818586018617, 521.7858961989602, 485.7146466387414, 482.26336197106684, 427.7550972703588, 522.499614390901, 414.2372528384592, 491.88372381978365, 420.74370322044115, 460.35857989445145, 385.7755802073211, 463.1661751560252, 568.964493528916, 332.05042900925605, 597.6402329853522, 587.8615386963967, 422.7389048500418, 441.820124440729, 542.5142414708441, 502.32932130723054, 540.5302584458279, 450.5778649639844, 387.8752043756482, 367.2579176979521, 411.91394346428433, 423.94940077227284, 492.72437372942073, 531.7567415813444, 416.7138995702323, 477.5642899618517, 514.3995335868733, 564.9097839170025, 464.1520773295272, 483.6889813351768, 357.6583862233148, 542.0362667546273, 557.4721966235293, 611.9813675487915, 437.5136314887783, 447.1683346532556, 473.0262527622731, 555.3766358660313, 443.1928614014864, 407.076223726922, 487.3151970364322, 479.18982555726785, 508.93461014093214, 463.3226875763171, 477.8176949425528, 514.2671557359402, 585.6853426210756, 503.02452506398487, 380.573151777237, 504.2652206536405, 372.5282580415734, 440.3172863853538, 508.0253137016031, 415.50700814939944, 427.02719075947937, 581.8489504630498, 434.406536285607, 364.19285662793305, 419.64397117199064, 534.5449306077946, 384.27884059880296, 498.0909396294554, 529.4483148007566, 460.7936549305695, 389.9966779215706, 391.3539618813152, 498.079875906865, 400.41031875133893, 423.5011544162262, 513.8104997440863, 497.8945168910591, 479.7570467142426, 394.8538900822122, 452.2802990572952, 311.3325728371946, 422.24020548639936, 507.0170561296724, 447.03259928971335, 344.50064673714127, 466.94344453779695, 411.6794209061498, 375.05143194801127, 413.15545413212476, 439.0661724903491, 531.1339041928736, 502.0444300124438, 407.7474970069302, 544.4140925620926, 491.1819033293507, 524.6070138661257, 438.3611179464965, 456.8237478384169, 409.38354804282176, 488.2215342357319, 454.9882078266769, 379.6109291067164, 431.4779105114401, 330.6256888151622, 402.8063146165425, 487.24570737538426, 582.4305395291294, 423.3908677902302, 477.5272596449327, 415.2397104173011, 612.0087974952029, 457.65821928283225, 505.8382208025378, 311.05116267403605, 333.8356272706694, 479.9103238971058, 416.450262675317, 529.6027196331762, 457.9136558651412, 481.13474911491585, 404.36371643655366, 483.13019860519984, 458.49478930306503, 500.67729147105604, 451.70022955106185, 528.0484902565187, 383.3915069845955, 472.94421765457713, 457.7528597600551, 615.7905667909174, 560.2954448048054, 376.2247026599142, 614.4384448246249, 502.4622764190143, 446.0030298271845, 438.83950885522205, 608.4870538755575, 478.23813682978493, 520.4277667387212, 362.63240440672763, 569.111636450641, 490.768942845556, 447.1314407568487, 416.7255160489796, 554.4795957552441, 485.00365044312315, 519.9441678349237, 461.3412377575387, 468.6878349306971, 402.26543244213025, 475.71761796216754, 449.01604995572455, 361.358133542958, 442.1612648317576, 458.26971172109387, 519.067846356198, 458.00129025053457, 493.4800808060467, 465.29016863822136, 525.9230272658322, 419.53682040039166, 478.9636488021394, 437.1827811007128, 550.0461568443542, 549.0307081637455, 475.9960384338366, 425.7625361084978, 465.840806130608, 505.37682630115404, 364.7949243831851, 441.32938214010886, 512.9337004429508, 427.7244207023087, 449.9056357764817, 543.2795414815321, 398.56205360284997, 510.41259955342076, 569.39239934127, 401.3268387516142, 360.42716485384597, 570.4838150783596, 409.21831984800224, 405.2770960320585, 418.973774690321, 556.5569914084134, 466.8985289114888, 372.32764429300613, 389.7027479660845, 601.9008020447798, 450.07269442795325, 477.5852138166695, 573.885785137919, 464.0170881128648, 492.362090751278, 371.8603584395194, 448.0712382630486, 441.43856614297755, 422.27635139427923, 453.1681699808916, 362.6264263935831, 392.6384921377758, 377.41340829300316, 571.5963633936724, 429.35350466906954, 467.00436940996644, 471.347420627842, 467.9410925381409, 409.49671282993, 448.44402734239407, 423.77313379879433, 474.0181431281697, 347.1696403883776, 517.0483944306769, 533.3379872725411, 424.1286862763458, 577.3806474770453, 537.826284801885, 457.7179154085141, 569.821753757566, 546.284009845212, 506.96071865550795, 512.4568477044303, 574.0194662424599, 367.2855741880863, 350.46039441951393, 368.7262394628645, 482.52060694872534, 471.7490573556673, 339.0295500719291, 427.86381651737577, 452.13935270947775, 444.7958083559909, 449.83471446883607, 495.9866725784828, 452.30667624180955, 623.4880853228913, 419.3903867517042, 621.0988185114961, 420.56471823864103, 467.08695978406666, 469.56446152016224, 499.06930534826506, 402.4231445183741, 401.0529371381981, 453.75916815557173, 523.3902050969849, 384.32457257572094, 471.6027063686634, 536.378333876825, 432.7738728942758, 525.5592597513892, 590.8802650114035, 439.6936119088435, 528.5189541504259, 573.0804653088496, 487.4844588321968, 422.76889721697984, 501.9051258041972, 432.40599311717955, 448.2216559572225, 565.182514308706, 494.1129959342461, 432.27698870798685, 512.0541565729969, 432.34831939520507, 449.2749005558446, 473.444304564627, 428.88650900384386, 410.942380434228, 501.63511907526913, 616.926228013866, 460.7795305563676, 360.5235354908523, 492.1844905810791, 452.55924836316944, 439.0802762051672, 358.61101484126897, 543.2849309599718, 479.3383383279369, 520.4540176901293, 453.44113965947184, 470.8961559266514, 507.0955852877389, 401.3516558882299, 390.3170956070896, 492.48424488839356, 508.1080014315895, 486.26286712042526, 344.3943216243899, 471.44206739250774, 418.2195852625721, 494.38187332743973, 573.0732266558409, 507.05410890666514, 426.008614864174, 486.5028270545249, 449.035100292172, 455.40808854238895, 481.6663972962532, 560.7387422763358, 391.4611734629905, 514.6280849690665, 490.1223309540142, 367.926148352875, 429.4641620021494, 490.9919705903508, 402.5813650228641, 549.2091628573166, 524.7378799532742, 491.82462102790726, 522.3860166537468, 560.4859001829439, 424.220649631922, 427.9222029446298, 420.4008995048536, 519.8490236442268, 371.4242342191141, 522.0881232487662, 276.19910067790016, 478.6524849172679, 406.2275490348694, 454.3386053616969, 478.9236444023689, 547.8026868189969, 465.67232012417264, 541.9708849395196, 487.1454983155573, 407.7403685750265, 423.0483674020003, 422.6947760902201, 414.78451002403324, 403.5110804355244, 545.4597885406165, 387.5530360241993, 392.1102206849878, 407.9538095433539, 498.62288403280337, 410.7823145438386, 490.96604322464265, 501.4995713067258, 429.9431309083786, 455.5783953451071, 464.1004596540236, 456.98454010947734, 394.59355601237644, 567.3004726697353, 476.8320377827206, 494.6051107194307, 488.92016588143525, 470.795035999949, 488.6063932572909, 507.6620637028944, 500.0188363730001, 532.9809846577668, 362.8680471626216, 439.3440464671534, 548.5901497302877, 545.0849331495297, 379.8492558025218, 444.0700564538966, 484.08983003321015, 465.5505668290216, 609.5532756496946, 473.20002135744517, 496.9671790472828, 512.0670023239494, 332.37454572391357, 513.4957323437573, 457.7288761648768, 398.00627542264783, 435.86948063583753, 465.1787011661766, 567.2395812787425, 477.6196858677073, 435.7309253293226, 533.9245361901014, 424.81386990640766, 408.88093694865563, 542.9106917085271, 424.34718511981197, 508.7549939429173, 483.17307522125304, 402.6177318160884, 495.06558405613544, 491.5979216839405, 557.6147873312138, 545.9200315787613, 405.54341905470784, 416.92268128616723, 501.5120545050314, 416.6264957736863, 527.1797676250515, 381.20630011216207, 360.4183959247437, 532.6873666532098, 428.14581069388316, 435.4594693872843, 455.3401718717889, 434.62986768424776, 506.92628948345805, 460.08035613702606, 388.17499809153225, 473.5172502617405, 492.8460236379927, 412.8109055888741, 433.57459311113564, 502.72984946541817, 493.26849940007435, 406.8083175792643, 369.04324569341753, 499.44273088472715, 333.45363048587853, 567.5426628199306, 473.04347721986966, 497.47583872727415, 414.3942293206616, 411.2961307370567, 584.2092191256443, 531.0008469788255, 401.4141696416888, 394.08637747956936, 527.3492699615693, 431.01325210678283, 533.3051509481816, 341.85813963844714, 515.8842360145098, 501.32476690538414, 509.18526627953963, 370.5599274628828, 458.6313144844765, 449.4702011946045, 418.43165650401244, 447.59201323663297, 377.52810780038425, 400.7867107443574, 439.674100040676, 411.0046714600532, 439.9320479903662, 592.6117001205605, 377.68803512737736, 437.5375425217396, 409.0612837434348, 467.958765701925, 452.88139460543294, 557.57450066604, 489.6209866984019, 579.0832992450155, 487.1901989579327, 446.56911876103794, 401.66930466928756, 550.2526903012832, 413.8952445057381, 469.23510708318724, 571.2768270915188, 570.4266746052564, 480.53018382873864, 436.7601383075734, 471.18488492437075, 347.46771795426395, 443.32741130934056, 382.07618947775035, 471.0924940835263, 468.9543709153419, 421.08348954484546, 410.1479333365494, 486.0702104337849, 446.83655824898864, 631.5198298623953, 606.8522273570486, 403.94350414025234, 511.24581391587986, 467.54557013005314, 311.27390521608345, 464.0068027606782, 475.32462739749457, 494.29493596675866, 436.8867860422605, 566.2566361562283, 592.1679911585636, 438.58623463848363, 548.8331512787829, 552.9403474425585, 426.5484357604947, 552.972324823547, 481.8406577373551, 458.67114947990524, 525.4055746538987, 459.07208378016384, 532.9092858539021, 507.3266480448201, 611.628013008034, 440.6318670675989, 448.3993682326193, 404.33856338932026, 395.2543416070873, 436.2703367418525, 326.97997530900153, 429.29766363036924, 311.74473104849375, 417.7326466588504, 506.4929484828999, 447.1574369540201, 409.34324601700746, 477.26584383101533, 497.4818048281777, 532.6214862973098, 448.91143146375305, 593.7093446484807, 407.6929966573448, 437.16644541112015, 525.1194154338707, 492.7959347112074, 350.3273726643619, 534.2048912504412, 407.7957798622853, 539.5407307498023, 503.4574644761699, 452.5031159982297, 354.2816848463463, 461.19960480315626, 537.3796178055054, 431.29078935967846, 470.57147778044504, 494.9573929831888, 403.4658221733268, 394.04876724012007, 475.360755296475, 539.2536730846356, 343.8705256144013, 381.28323083938665, 353.7389267028913, 493.1065888531099, 384.018263694316, 413.41447766704965, 440.71567304133566, 393.87009365180046, 462.05142792248205, 395.0748714877602, 365.86366626410273, 429.47158019623697, 475.2214655127812, 382.07342021961836, 509.39540584550525, 452.81038932918256, 498.48166172339523, 392.18255466445356, 374.5478168123211, 526.4311249905263, 429.08126450556233, 445.6454015415252, 401.2640859733987, 500.1327149320075, 458.57939357736996, 528.030052856157, 477.99051278434933, 489.2156413260732, 687.6234940514345, 422.6657758870472, 390.15933669529875, 513.8395443089181, 517.8612343928955, 351.31273304854176, 450.5957880728865, 395.7721443940506, 463.21978058124824, 460.2017885304303, 421.3015581989556, 380.651912179455, 478.56823507017447, 332.0969833099824, 598.8728111109765, 435.9571954437586, 418.27159934736204, 483.07811049134835, 451.74086062788, 462.52372386687387, 471.9946667472943, 444.41790132893715, 398.07407066297947, 524.421590862668, 573.5394096133297, 533.2948689573795, 541.493000155, 477.14131705704676, 375.33960256067036, 382.29432821594696, 470.9288854255899, 323.84014208009745, 488.7983327760485, 414.23184268622146, 464.8179785601283, 411.3176906491026, 435.55075530678783, 503.8554209684263, 517.2446108848779, 553.6171773912448, 394.1698920099519, 457.19066859008996, 432.72301985337083, 551.1492266316604, 376.90442853251096, 521.1343526096197, 454.8125911408914, 515.6063092949959, 449.3566282350074, 448.7245528650123, 470.9427430776717, 406.838075584805, 462.60809048275485, 402.082991864468, 380.47908473413963, 542.2314652575258, 427.89211869347105, 409.536904121763, 423.93638063561394, 501.13202681076, 459.31945217548946, 466.3200646221057, 425.3165794740189, 402.6249871180054, 463.53028777435804, 396.9140235037165, 284.7062521765075, 466.3779102811649, 466.6992880522172, 538.4277797249445, 447.75160335127026, 576.3602813940729, 501.82662761592474, 557.3691451298628, 504.84352556090414, 469.8388940252921, 503.85964023604333, 416.046033787223, 375.7527491131755, 412.01873557927127, 526.3225191101417, 450.0956725936879, 458.4417972777781, 494.484473253082, 297.5782136189915, 410.6788012212695, 396.01831751907605, 357.6735574052166, 390.80200581427994, 390.9013596619273, 455.3014786090416, 400.7317060746192, 373.5090772853579, 295.1991707006002, 405.37814188521025, 377.696293637043, 523.884274602201, 477.98795317860305, 476.56483189920897, 493.10177308186974, 375.003927064541, 372.47085570385013, 389.24524504795005, 427.52267721454166, 422.3328749527266, 510.2558317717289, 427.8451157898078, 534.7062709778484, 531.2565968586564, 402.82725974791265, 414.65345354816117, 463.5368620491414, 438.0073179072657, 444.43195284086613, 467.6191887048104, 496.5431488449562, 465.8160610472313, 492.159100105791, 400.63079496874246, 491.5069930729518, 463.2537816024345, 478.63014808492306, 398.8814632105202, 403.8615431479634, 439.871016439049, 497.5546666214531, 426.8841997581142, 405.71186601468423, 376.0960606019072, 438.1820881093879, 480.54646726211934, 512.1281486678961, 401.2254608094399, 524.6126176986972, 524.825513556285, 443.92020564166944, 438.10940445885126, 512.6896129112253, 427.45170646499054, 526.9796961636746, 485.8730869801818, 505.23670739817027, 444.55373762143756, 485.17860616988526, 414.542964111433, 532.8738199134614, 328.55910495607867, 482.8500593243915, 527.1614099700394, 401.91447664391416, 571.9818226700137, 481.99050254717116, 436.2264627027952, 580.1698328861594, 380.6054651148156, 533.9696435284598, 434.5194715023912, 488.6774180932436, 383.0292858879819, 400.6134287129923, 499.14515130002263, 390.28198358452426, 407.5935019646319, 483.9283320608521, 511.3278809947595, 472.9843340698198, 437.5809406281322, 437.0337034282611, 359.57948850374544, 362.9573392004743, 476.6811602725295, 392.4371269839478, 450.63665984284677, 484.8515083524664, 458.9176680482773, 435.5898263956194, 390.2388318351075, 469.6415758609963, 518.7344892629889, 467.60836103798147, 444.69425130596716, 492.083171838366, 406.22028364033156, 491.6384358471286, 391.3317867476346, 445.9567062444939, 434.6877857575495, 389.7887664373893, 485.70567435089606, 562.8735161434903, 346.2553858953612, 450.34411471858806, 538.033289561571, 511.75709686553927, 453.1785062637896, 434.27962904947054, 517.7406759827524, 654.563271586059, 511.9973676376728, 459.0012724855329, 533.2794077597925, 509.01783315401343, 539.2527262103677, 451.6985041896476, 474.0206261314382, 581.554144550722, 470.8962429298183, 578.9881701915403, 564.953060021576, 321.63302912216426, 397.0578715295045, 455.20455333134333, 480.3405990600109, 418.3719592475388, 549.4567976553045, 453.24997626090044, 461.74563818606833, 420.3926840179529, 427.90981972803854, 521.1810377382862, 492.6625369314353, 425.14439650081727, 343.0546586560588, 503.7433031583657, 458.4277468710279, 480.72830440232246, 355.4204826262888, 477.5980847450679, 489.0675270865198, 410.212061372113, 599.7610376025034, 469.96471429447854, 444.07525273361955, 478.42501179929116, 327.8467190263863, 335.6829114369373, 323.7512539864348, 495.9810478563514, 537.4011930378547, 572.4667484667643, 450.6465519338285, 507.75151248513345, 502.8044654293024, 426.91433579448517, 445.8381099710493, 409.09243610629613, 358.06587943288406, 519.4408742800232, 418.9700311715487, 461.76179448570093, 637.0304215731331, 561.4385067537195, 433.90238664694715, 444.5419919359628, 490.6309312307343, 537.6788032866473, 404.5496682181698, 439.9093117804259, 428.3396819795949, 304.3524750983631, 475.9406414437651, 498.45255162614194, 436.4629830706094, 474.47680489416393, 386.347453065551, 492.26424258663013, 433.84034422595465, 457.24787875136326, 420.22039090424374, 465.6987680998966, 436.5358136503007, 441.652974481845, 457.5261054934664, 423.67019313828183, 423.20059095626254, 527.0303377423119, 408.5564299664762, 395.5350440528387, 588.0919764666769, 495.28196631302234, 477.233913850901, 477.96769950191856, 403.7052539012761, 496.14863248770604, 465.6977203321484, 441.89772951385027, 466.3307223988465, 385.69248200273574, 390.07858583219564, 367.75134098863856, 401.85469883532073, 368.7457009521731, 330.61394096494166, 520.8504447527935, 467.8288614179838, 393.1589916747126, 547.1577990406913, 415.43034405470286, 534.5245301631719, 368.0605799331031, 492.6433709053413, 392.2199273055189, 467.6290506633314, 460.57810758650805, 377.7978950028718, 454.4058438778382, 489.09138712739934, 338.17895986018647, 482.50399920569095, 541.7017171165057, 413.57533269649633, 399.7267468518365, 559.835797394707, 462.84077551977794, 418.7655349622371, 311.540250560625, 423.95953852849766, 389.26243231072766, 466.2659850332537, 616.0182441896617, 490.2035352780038, 457.977163189094, 404.32250991773054, 377.2627967245489, 404.6396570597356, 449.39035930674777, 515.5132834001001, 393.78690941710016, 507.1084499135076, 424.58211870859475, 463.1659433605247, 379.56458850048074, 513.1066417777064, 452.87740800350485, 362.8161718999374, 415.2554904461118, 462.5943864869474, 454.6207986111793, 370.61688407437254, 456.8284840487179, 429.0293874687496, 455.6384817062672, 371.92011228558556, 496.00771225335956, 496.8867815762075, 433.7799465416634, 466.6726130413653, 434.0954549518667, 444.658155149688, 389.0374505967669, 327.6634101493769, 413.50973568431385, 486.04981887490806, 444.4609340424155, 456.5934337625805, 487.5079683701804, 482.66307021576745, 461.937164572943, 424.28937544122505, 454.33524974166806, 486.0136622454729, 364.3852137581218, 412.6224315582619, 455.74030652093245, 556.8304413609235, 473.6568368857635, 451.52281170559513, 409.4162573148212, 307.2917446938558, 479.4747893625708, 360.06756224261306, 484.8470903901017, 358.73290044869054, 482.65195739155604, 480.0708343995313, 376.5650894083152, 444.9013082259618, 481.39362528561776, 291.5395548670747, 347.76607822042064, 431.30735402619496, 535.3760023863355, 463.9684580302818, 509.3532849730103, 390.25158278347203, 490.7678739844153, 455.3805625553664, 365.29255153553385, 474.43278570604684, 502.2686774727831, 436.03042195001154, 376.2624279666876, 264.4442689445169, 422.9631356239791, 397.4563336787874, 469.3304691348141, 438.97082852031167, 427.4127575453542, 398.31452977687235, 345.62302561424355, 368.8925993936044, 474.8764035182279, 546.6481109012789, 408.83993260391503, 549.1876936917126, 453.15525942984, 491.72841508449136, 460.90846803213856, 401.4893295701111, 392.01584519252674, 349.2659587617364, 434.3098165829803, 388.84805311819235, 491.5602289346617, 429.83816852148806, 471.5422151383551, 484.24423613454644, 595.8067857065673, 473.0067080284296, 433.574851074197, 477.3930174875406, 448.3830077684561, 446.2300190577, 408.3169552641648, 469.8051838138829, 490.00321707265914, 435.61767122106187, 491.07797941044015, 461.12615286412284, 375.632714164068, 408.06506157965975, 350.30269839441416, 405.65347418110684, 516.5186692808559, 464.000858126312, 471.9351869107708, 530.8081323157073, 396.52630222205636, 471.80614160659525, 471.7080447577708, 481.7777220198032, 364.37934967295445, 422.923411880832, 466.40440084724514, 443.65631548679715, 480.0184069867139, 398.07884087535024, 393.20785598349175, 448.8698337125067, 460.418429786524, 463.1665438357588, 416.55098439488717, 530.7539855175177, 425.62482831752624, 416.16374716028355, 473.33946159753214, 385.2077707147051, 386.39398342774905, 483.99824213543275, 500.39783164067046, 497.14764106208156, 501.60169261589846, 426.4123903837873, 466.9375906475849, 431.5319539002652, 487.503529924005, 434.42595076183244, 380.5377219442471, 466.908970865029, 565.5773268661129, 488.48907273860226, 343.1562212033, 577.3567665187995, 527.5807995830856, 530.539298667731, 406.95849778659385, 508.8837104426723, 444.64746079400766, 486.3660519576175, 386.1484458496474, 408.12944662046965, 519.311355481202, 479.3119479783292, 453.98968885772615, 466.9383326675521, 281.49259167179315, 419.2412927974128, 427.2662707688101, 395.9405920780529, 478.2478047529987, 466.78363126231596, 422.5210786806504, 543.5731640893194, 444.0741486118089, 439.11878081107614, 466.16479731040283, 437.6913701805596, 311.54752502674705, 321.11328009405446, 400.8693151798341, 431.1885231248555, 476.8258327391646, 539.3837451978344, 461.36996187187134, 468.46321040981496, 433.907514531454, 506.28107237336826, 428.5749456088167, 436.7325181908918, 487.7239330016146, 457.8421447521995, 503.99531533076566, 402.84986557444165, 494.70526569523463, 490.7597418035611, 546.8318383302657, 532.8922925841592, 412.8371496602441, 461.0158431423412, 424.01371066448803, 572.6572322942797, 421.85610390948204, 377.55955909019514, 535.243776834399, 455.93967735944267, 294.4799847266411, 420.07214466866657, 518.644964852179, 595.9586321279943, 352.45763927096306, 483.60804619591454, 457.8663986033535, 389.6670974788605, 395.2570123605057, 509.6299200377772, 472.34327209357417, 572.7306968069688, 402.6098731969544, 533.9064356412691, 467.28890768643686, 400.4261551167558, 505.31368618103454, 448.252727867089, 324.93021542594937, 404.3327743402882, 463.616470471657, 522.8900366574463, 627.6066838133864, 504.69365313919616, 423.40221510965364, 456.64763538039864, 486.00787668931247, 353.45914423974455, 433.9408392329376, 450.5152849593125, 528.9919726632043, 377.6441991228256, 498.7554227480948, 378.9009174564489, 491.42544126339607, 484.9294477445378, 541.0223066007219, 363.3400210697024, 503.47909592705776, 372.3245317504535, 489.9223825943176, 434.9257259110925, 472.4316491976143, 506.5048028831499, 378.6623713816436, 503.7002975417017, 344.08374775162594, 546.6424576244297, 363.99950398629034, 599.8726731107231, 449.0088147861978, 523.3497934263078, 457.92645639491326, 468.5137440683429, 434.86415742161597, 523.1264562153216, 423.1238711843507, 462.021523294509, 533.8996700521567, 488.3814022157075, 535.824316222671, 516.7338238874465, 429.8241327222739, 410.32687874756823, 382.7441689458333, 494.272655662732, 414.49628275596444, 490.41685369789695, 390.263272727844, 504.1100848601713, 471.24431225128757, 420.6320737281618, 443.7684133360805, 524.5021481012562, 453.61399244357995, 383.34342962597674, 490.0134647432106, 313.51032133608845, 350.9098452128796, 505.3824270287957, 493.0523975991435, 500.48338616964526, 577.1539501819193, 392.7607468688505, 487.2189707737077, 448.8528725773234, 417.6210249190802, 589.9196415338092, 496.3410179863375, 456.6470389520287, 437.4740860470403, 403.2643729457139, 577.5347754194246, 382.54102876397377, 327.9894217428472, 510.2385500768853, 373.163035592407, 435.007690358147, 466.1293872462362, 429.5571043308337, 510.1913211829943, 450.59619446735934, 462.8203271253075, 531.3483081316847, 519.8986816785673, 532.5812935044634, 467.88074702267113, 354.55496776491924, 376.09103008432965, 409.6965786577486, 463.6357657050886, 428.8064368935873, 537.0899945326786, 430.00280819729664, 394.3677420258249, 625.3359438558214, 467.0742586375256, 438.1118857117002, 525.4509717699427, 441.84432180471003, 523.6835538807214, 412.28281896786575, 420.98821686369143, 459.71828277105357, 559.5334139064197, 348.8016267084947, 597.6802832908078, 474.867127175651, 458.9516448265694, 346.9009170207609, 426.00480359119, 447.81480550273193, 474.6725444351051, 483.5374563507735, 388.54219275382, 445.30671582210266, 417.00300591178376, 559.0182196540674, 340.5064602923889, 508.69073378883877, 411.55879130394004, 444.32052350876484, 388.937200080946, 362.25799820085064, 398.8299917245399, 499.8609848226221, 543.6322584569909, 423.68402690231517, 396.0502292593542, 409.0359628978187, 455.85469215828533, 297.2412808700367, 418.36323600888693, 541.0157568316494, 431.95543646582075, 472.3527068703382, 470.0327067570152, 447.4305692702584, 420.79409937683147, 383.4215469555585, 362.361607905425, 445.3611233758349, 488.5769127179028, 479.8951859272595, 529.1095772081397, 400.9302720196894, 413.9232182434745, 387.4037761312635, 577.5677062209352, 478.12641939554703, 428.69392010659925, 439.1620798823886, 423.9270183918995, 355.5338532877663, 398.20109342034004, 478.19170091008, 539.4618869791902, 384.9982327244512, 408.44694097411264, 432.29881025291553, 438.33443593507945, 430.43938355720474, 452.62492945407604, 434.2186198677976, 330.24528623012367, 342.547248188138, 466.5969229768718, 504.8459685981223, 462.7808734729642, 479.64971320741955, 477.6939484593624, 502.28265844184006, 426.88542840796373, 457.4038448468392, 559.0165532551989, 484.24891328502486, 538.2854740576776, 457.82412471687564, 422.09574546329765, 414.3992708052333, 607.177136294632, 383.9786322211445, 443.23824698301655, 434.3422763924984, 466.14599215721415, 471.31418176387643, 469.719932379212, 485.0752195441246, 490.97028730804584, 528.2047686949459, 481.92753527162637, 418.67579860430055, 361.97211941275924, 485.7143612248519, 515.7856845447578, 539.438707758648, 499.5945696519677, 348.93755206183624, 600.6189615374353, 403.8460146918852, 383.5178503386382, 512.7673587736751, 346.4247177004747, 454.0174330244758, 409.6928556452074, 521.8560260798293, 500.0341439448066, 366.1649928507895, 490.86240950735225, 393.7306323120598, 563.7210251937397, 354.83034556788544, 434.6211080051196, 385.7797135186864, 541.6017184865151, 352.7943004084732, 521.1034367811286, 395.10678768811664, 513.1979860310801, 541.6946339182791, 445.395587543149, 474.44658737382923, 387.0054779091461, 494.74835085312714, 386.07883111095543, 379.207449722985, 438.01794680041036, 480.90350324113444, 462.58345531152105, 338.29792629085085, 432.61481058969486, 527.1509061460569, 357.443853042375, 416.3570806377103, 549.1033617028564, 620.0444644635915, 537.3021609860414, 533.6476909558784, 467.38549148326047, 572.401415562768, 369.90254547123243, 542.7054237869985, 351.15038575706416, 569.8843494366175, 409.1167622211455, 394.14588051338853, 334.3935002973528, 429.93752453078116, 526.2248121740058, 418.8472740304379, 355.6278388653756, 479.4248516806364, 629.2602327056063, 448.23644550649857, 534.8950904265786, 404.4395417852215, 445.35083763950917, 416.2960130590016, 434.84672499490284, 368.96845472825476, 494.5669975701983, 477.77331856325014, 427.66248080110785, 477.9159575012784, 488.2143640990007, 390.34585447771434, 503.15514244495756, 425.73335205729995, 544.2735111160247, 452.3549613117856, 403.4012099939768, 482.8247617104708, 397.5711373082602, 508.2421827150617, 413.21599117780795, 430.0896717690751, 429.6505823672431, 434.80081040843896, 493.1114865455137, 411.4760875712403, 440.18932374945933, 536.9650647394327, 465.50873633779116, 525.427905798935, 580.9191100481762, 464.3293423153624, 508.0991059150934, 454.75811819298883, 499.38722716113193, 424.7443178621991, 455.1610690648211, 419.8292347131211, 533.7669564562857, 412.01602755240594, 386.251969977298, 413.76187083834685, 480.86939842263445, 505.8805026053242, 437.37970765721116, 619.9808423361486, 496.30013341453804, 348.2710716041014, 426.4469008110506, 416.3169504253105, 635.4886195972731, 471.26126627785465, 387.29588885128595, 416.1071747029996, 511.84286837712364, 515.2208612953099, 438.2460223046069, 383.80341770275646, 420.4830509649639, 344.8718926359837, 402.7419301762723, 439.42751252412984, 459.38826621296585, 418.201077437323, 414.674944010462, 463.8245974771558, 342.76583259939144, 568.66139981615, 359.09519932455913, 426.16516213712106, 607.5626752849594, 466.21511482673657, 424.25434390108967, 452.8998683040836, 428.5789970139967, 514.3686035034858, 382.4572820031623, 400.0293937189347, 494.2247225628305, 561.5269215325497, 345.5196493710697, 493.31595878866386, 486.5064070613539, 435.7372374109845, 553.5619541733695, 394.71831436119305, 544.4275483739824, 549.5820813165071, 505.19249622899963, 564.5525992123843, 378.7085499176918, 399.72436498119987, 500.2072234871438, 517.7524599870577, 588.0991296189279, 366.9962369493594, 354.77956492669, 416.1537137936322, 549.2919014136043, 492.2783718113047, 497.181581492481, 568.7522434474862, 397.12894503136573, 532.4551200967037, 455.09425741351805, 420.0181151545064, 569.0010459045543, 500.52811178424946, 427.1565646698251, 427.6246658502111, 541.8196878574001, 510.39895882829114, 510.1219229767107, 544.6877055885994, 470.22090848190226, 477.15888042115347, 450.0265626451033, 493.08749303547006, 480.53572606288674, 453.42090661861033, 478.8563962980226, 468.7811592132662, 460.6181280563538, 532.1020862164936, 516.528558651416, 382.52848492068705, 515.2115345001458, 548.5848951317383, 323.92320622408124, 468.93836655391954, 474.0276618250578, 513.2994210850053, 451.0830247490381, 379.6949923474045, 480.5023548996527, 408.80568634426044, 528.4348145432127, 477.28753027070877, 429.7459246135026, 386.23848271312033, 493.1996882121223, 471.7831943776183, 460.38743070428364, 493.8459072753115, 438.8715857919381, 453.5305814350151, 510.3656823045641, 452.12899023256455, 516.9527080726606, 601.5023915354075, 456.6350604684169, 393.0299053384246, 457.21290664066237, 499.562958197319, 372.62943722995016, 445.99187219891655, 430.78910446349613, 531.2579385941573, 455.98296185944537, 487.878591326355, 423.0181582730351, 428.2789289659137, 469.517482564512, 416.98941799153187, 400.9751186031662, 444.5425211770857, 468.69856578123364, 482.31903433738904, 486.52107358812555, 493.3823546986477, 539.1184659164711, 484.5744780374512, 511.17416153505854, 470.06628647139445, 420.92479547804004, 386.95686020666267, 483.48325609893675, 397.8687738466792, 491.2332943982987, 421.4460735889721, 564.6829561064922, 409.43532592116594, 472.6269323089199, 392.037213957341, 500.8559213092909, 579.8353589297328, 422.6922268625345, 402.93267880449395, 428.00255345596014, 371.0559591605524, 449.92080542839193, 497.10708031869774, 377.18828461584076, 496.4011755896353, 474.46231416942146, 472.56690053864145, 506.5233096638211, 382.38642747142615, 410.05147592354353, 413.3454885197332, 504.60478827178684, 514.3418056816163, 469.2257828051867, 549.2564745491987, 586.0516527641895, 375.83183197940735, 422.09792832335575, 440.5559053354682, 378.94705064962204, 409.6180155321421, 456.47552913840565, 420.72979560597406, 558.0093127569779, 499.0857215253147, 396.761347498115, 370.7508381053747, 414.43253781988915, 618.019489196591, 460.42574515458745, 451.43355109199047, 333.35086453551526, 403.389093218449, 560.2594484579179, 459.10135223347197, 578.7469328716319, 440.1836556432153, 499.2791680995789, 467.3888927441776, 447.7791338649955, 380.6340273124564, 569.8859641173532, 515.3831615308999, 584.8443272929725, 445.65540781597133, 487.0871827806643, 458.97353403449404, 542.500314939246, 377.7230649358906, 506.7504806908387, 420.010620632323, 396.1805749075618, 373.7911030525162, 525.7618088614898, 404.4446307347843, 483.5397636751054, 512.3322407024922, 511.76678790163913, 547.1669381405667, 540.0147001437199, 377.37798995116293, 449.4976456633194, 559.6491875900201, 410.8351843849694, 484.339513257846, 496.10555598500775, 393.2037298280309, 396.1406015745388, 358.66086189028584, 591.6816588393606, 466.4422399536209, 475.20786420878, 414.60298894195853, 499.7636786800665, 456.4487901642644, 279.93509278922375, 490.97884860645144, 499.79338853120595, 510.5730341888319, 582.2486691643159, 410.6189060118866, 480.20982282893254, 416.8060451893906, 442.7197441641872, 418.06870783400853, 490.3053060161347, 560.9224982008938, 506.7884564859972, 511.8556774327686, 459.84024298779013, 455.15781909684324, 447.9694511617923, 521.7954098085903, 485.98000923546493, 543.6555075473099, 537.6923041521353, 504.7604188073009, 374.4902085400176, 415.3750850659093, 395.3384243151525, 332.6416793409067, 476.80297938536, 501.37490351324067, 513.0422259956048, 380.97288425126834, 477.46457024195786, 581.3097971231167, 412.3809578953562, 474.94181488891587, 527.0307019125981, 412.1957897337279, 475.009661350182, 429.62890910102305, 539.8507525852069, 456.26120438692925, 437.747538020691, 364.54265372039964, 374.05155445785925, 408.59128872614974, 544.9829933819473, 500.6525247283591, 443.75406898299707, 444.8605541210435, 451.8760730089595, 420.88434252476986, 475.23251719688204, 457.1773358392081, 580.1084829692585, 396.5346365494839, 405.69622653803134, 635.1823613201371, 425.6831848746556, 521.6384780763452, 480.39700731027347, 463.40358983599356, 471.1231357437977, 539.7002297061053, 432.38963127155415, 449.0795263653662, 366.65140990273744, 441.15181230163046, 456.95701634711367, 483.76616454636064, 469.9806971913208, 435.5761902452032, 522.8676670227144, 439.93559802847574, 341.44126061980734, 465.6372677092136, 439.37618361683536, 414.92037350705374, 448.3242231856255, 400.25327745229333, 581.467271624511, 502.99888012627645, 472.32858145034504, 530.7391911051953, 376.6128568460117, 463.62230384844634, 439.614969185501, 424.19653022329516, 462.9585414319351, 372.23951218242166, 454.6441497902324, 458.8114794102164, 359.3419984133114, 484.9772748849592, 535.1348746171266, 416.0407293846789, 435.03474034208176, 394.42786428844084, 479.00955378523855, 387.19218843604574, 446.9963304084348, 519.261243297699, 494.88879310932157, 442.6959382348078, 447.1649492740873, 468.06541758891944, 513.967037985993, 456.8704254108243, 405.05826508266506, 532.6225251174542, 416.2481512346479, 435.6351563129536, 393.06784906668867, 592.9640434434004, 505.0138526090633, 489.5800914263806, 435.2062838307287, 466.64014370199624, 390.89068896324034, 443.98943648248354, 482.06575456375015, 368.95001434600454, 541.9659245093251, 387.79202883145604, 465.3668336567345, 479.42497635954317, 487.4455836192478, 362.4642984253259, 473.507743628775, 554.2741307052987, 395.7503470460091, 420.3791082837071, 399.9413957508875, 427.09934934101284, 441.1939144271799, 380.85860077635385, 447.49790559889607, 421.29053482239897, 469.2542952920337, 464.2650361790587, 464.03976350866026, 577.9775450114846, 490.32332154597964, 548.9587306778155, 592.2774545849447, 540.2321916776684, 420.4076533049391, 359.84752613877765, 403.192382730836, 650.9825132319704, 393.8893532097996, 441.35182379116424, 464.90697724649436, 501.1833068805782, 416.24898431876363, 426.5320149646118, 521.1630648868606, 398.2708284271918, 506.2903881343423, 367.0808573416007, 483.8875534433991, 517.913617339502, 455.2066616847644, 554.2815476855424, 457.0624063315971, 486.16537337459374, 576.1689057266917, 447.5815559203666, 469.79079773526456, 428.2606045411453, 476.17092689999066, 349.2517674896864, 399.81680108993186, 409.60575976020516, 352.59466447248656, 500.2796809689225, 464.1734894970218, 365.5399057309152, 441.88987610117397, 443.76997620681266, 424.7561801519838, 481.4881698802612, 486.5258230603453, 489.0048034668482, 427.6865031437522, 494.0442153788908, 435.85031785079366, 370.2283547354091, 346.96001807868623, 575.4938156440282, 481.7377028504946, 519.4349910208149, 477.05386140464435, 376.55460348982314, 463.60628639955195, 427.84730698778264, 543.9826871568189, 504.1788457933828, 372.50246991281637, 376.2176372611184, 480.58647282390166, 443.81126751672434, 395.7214840992811, 540.8859472271698, 430.9408205314273, 403.5279649261314, 430.6132397908521, 407.96901905392065, 361.6108122851588, 561.6571433550566, 466.7330411709999, 400.34451393296786, 479.41006447767415, 560.0160221558576, 417.39490169970134, 504.10370125060257, 518.9956230612249, 491.067960449758, 472.6895860162009, 458.09780886016705, 361.17068345059715, 382.5861367253981, 344.11362285586046, 587.1225500533251, 485.7510708513746, 464.6858720449409, 428.7347697389528, 526.0703086942063, 542.846187399425, 484.11788814035043, 430.58834763797023, 430.3108650831334, 487.0122598481394, 402.8513377773009, 411.56003886123165, 440.36900858915794, 471.1959362006461, 365.891843232009, 511.0135414253489, 384.3705473442624, 450.64019967688705, 388.7936591072649, 360.3009955544667, 406.71821344054064, 425.19531354460935, 356.9839316520142, 530.1933221427361, 512.2459816850168, 418.8461334135127, 499.9224084623001, 352.0819544979768, 575.2115134111508, 383.8774256316737, 456.63247542835927, 610.6450729962874, 432.99461133310007, 534.9401493106606, 467.5315633793098, 449.8061894001882, 518.6899677888681, 452.1648811178291, 436.2926715768609, 569.9320155070068, 347.77562112303525, 458.9923598949427, 382.68231298903015, 491.9833505693227, 407.0293354851875, 528.9433006167259, 448.35185321835803]
thresholds = [372.9893041579573, 454.9882078266769, 541.4045869301331]
display_name = "ROI from dFDA R&D Savings Only"
units = "ratio"

# Calculate exceedance probabilities (1 - CDF)

sorted_samples = np.sort(samples)
exceedance = 1 - np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

# Create figure

fig, ax = plt.subplots(figsize=(10, 6))

# Plot exceedance curve

ax.plot(sorted_samples, exceedance * 100, color=COLOR_BLACK, linewidth=2.5)
ax.fill_between(sorted_samples, 0, exceedance * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Annotate thresholds

for thresh in thresholds:
    exceed_pct = (np.array(samples) >= thresh).sum() / len(samples) * 100
    ax.axvline(thresh, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
    ax.axhline(exceed_pct, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.3)

    # Add label with formatted threshold value (use format_parameter_value for full units)

    ax.annotate(f'{exceed_pct:.0f}% chance\nâ‰¥ {format_parameter_value(thresh, units)}',
                xy=(thresh, exceed_pct), xytext=(thresh * 1.05, exceed_pct + 5),
                fontsize=10, ha='left', weight='bold',
                bbox=dict(boxstyle='round,pad=0.3', facecolor=COLOR_WHITE, edgecolor=COLOR_BLACK, alpha=0.9))

ax.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=12)
ax.set_ylabel('Probability of Exceeding Value (%)', fontsize=12)
ax.set_title(f'Exceedance Probability: {display_name}', fontsize=14, weight='bold', pad=15)
ax.set_ylim(0, 100)
ax.set_xlim(left=min(sorted_samples) * 0.95)

clean_spines(ax)
add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from

output_path = get_figure_output_path('exceedance-dfda_roi_rd_only.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Exceedance: {display_name}',
    description=f'Probability of {display_name} exceeding various thresholds'
)

plt.show()
```

*This exceedance probability chart shows the likelihood that ROI from dFDA R&D Savings Only will exceed any given threshold. Higher curves indicate more favorable outcomes with greater certainty.*
