```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Expected Cost per DALY (Risk-Adjusted) (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Simulation results
samples = [10.075942425560429, 99.59876847752378, 135.9056673145141, 23.027869732580417, 28.681688072485912, 0.9543633842596584, 76.07237279394948, 8.212097500591428, 64.8890699008447, 102.74244064832406, 6.8464351134434835, 136.5681401624373, 11.117743421089978, 145.31558517482733, 34.35357499938951, 25.653277050229168, 126.99473604022829, 100.9444966925258, 43.1365124220462, 117.9518903828651, 115.20092083772266, 67.17773625584618, 147.79003870951587, 2.7103569976003388, 6.095314962154333, 111.90098949779473, 130.7355829666269, 10.009118313225159, 23.022386131871006, 128.4006484412983, 173.4829926663259, 28.863558441723296, 1.4630698976108911, 54.24315487597808, 60.33150390641752, 7.04750582561224, 116.63675398536427, 1.9676699161221796, 103.23578615812225, 1.8162884954176852, 2.2510525687099525, 10.154899803121808, 106.04510923017, 123.96024085842784, 121.4585258857615, 123.66535224637165, 9.39652551899962, 123.77266255496949, 134.18751494497596, 120.41235481052328, 125.21570996052972, 133.05592251168906, 93.10982346281773, 18.221380705333267, 1.5350464336514857, 106.52631299180182, 113.40474567213626, 25.197178013267198, 5.668553217988254, 19.627653455793315, 4.328308980862569, 112.23563945590513, 122.44954581034582, 29.031496542375308, 47.94845242361659, 136.94648105715518, 81.85132687144244, 109.79304643754122, 3.38164219752784, 16.930186788301654, 20.417134959225574, 13.903304567810315, 67.03849631913663, 129.92184699707215, 2.521587555039836, 47.44977098077149, 31.39943023262808, 122.35851964188892, 132.92119732544472, 112.73350237119159, 6.842364762160444, 23.90708338153094, 65.56341112541197, 45.160352019350285, 97.09002989280177, 11.043076393501451, 6.72569111204766, 119.2513917802913, 129.54367966769007, 8.598938132718981, 14.169023192886149, 24.9367562176, 110.53392941165579, 79.43125434265049, 89.83529139211808, 14.080736894805005, 95.12261453306499, 100.30446427648589, 127.69532528672697, 101.84577005509176, 2.7765258555479853, 149.80832679161097, 3.42437440541007, 135.59335380829563, 101.36938255235727, 10.037089597647212, 1.0109319965500694, 35.51862207799551, 30.155946590294583, 89.28829706371594, 128.48276581492058, 102.14811535083741, 67.68903019585112, 93.27315163656795, 12.994815989336667, 5.442946914895971, 123.97152631710065, 2.5364559021419493, 158.0015852080847, 114.11249329745866, 99.87009282889069, 5.900817039911991, 123.69394848667692, 11.606356286356348, 137.96740740450434, 38.348799128244316, 9.2879886000932, 97.20174272441476, 106.51047825994108, 101.4882853967961, 34.90759456864666, 13.884259276854936, 133.14733648392976, 5.3565807990394925, 32.70684236545835, 100.00081402535409, 24.440659029320308, 138.0414062326031, 169.2247674287428, 33.89922835929126, 11.20867441925997, 100.43257111755271, 9.01646694426627, 9.861259695873475, 103.43609472333812, 71.75362002086455, 107.01328213702375, 116.09066446761135, 11.7777118590561, 21.211637934935073, 115.72939764432672, 6.666500958545554, 18.168001670089602, 109.34184036023939, 6.482313049706646, 31.02295279660136, 121.74988585937, 141.63579230253316, 96.9341555795419, 97.26212154787906, 1.4543790570999708, 11.062734587887398, 173.09281891489138, 7.562634832780441, 6.8230087953927265, 24.331711398280312, 65.7556449295576, 127.36005346383116, 92.34899523847902, 118.14159199761494, 106.23847660577518, 128.7486667566364, 31.357854662690112, 6.301725633104291, 95.80920457134047, 122.66232186930105, 157.37468064218862, 122.38987849346685, 116.54109816193368, 125.14273320676661, 10.444328333834829, 112.67874927191527, 6.8720407758443995, 144.7766063824068, 128.3536151071644, 19.818454669783442, 3.7411066219421887, 38.70181487417442, 94.43378149547438, 23.453908638902778, 161.4033516430728, 3.3900211459557874, 111.30175168229717, 10.859189717705654, 98.50686686556061, 102.02868680710857, 133.3410362336478, 3.43890662327706, 10.345977792348217, 10.343346484462131, 126.29493251137639, 152.69804592648077, 11.648776054268893, 21.628799250553694, 1.8552681243815021, 117.97686753256647, 102.91155504779903, 3.7506054340716477, 36.37052932415027, 57.316234580068624, 139.96350255649745, 3.91405132902124, 119.63218535946754, 4.256740546879324, 112.37594608619786, 8.733031818322464, 13.303406654405286, 150.82183083781678, 5.449148516986121, 105.49894678361504, 114.42070322966396, 124.18700054635447, 44.0497470828289, 76.78365663047038, 64.62354502104134, 123.87407394668702, 4.756704014916766, 165.75750208082084, 3.738392074218986, 2.1619492577396837, 5.701054354611575, 107.40443326046108, 125.80434116966532, 147.35403601353823, 1.8449870009125324, 15.62328463831043, 83.92371953583863, 115.64797728318733, 1.9449983372388568, 29.342450367639294, 78.98402719586961, 92.33297875400886, 13.26825052194065, 92.96470604491361, 173.11581969769927, 2.675523408565079, 1.3927738544634813, 164.61412238060947, 204.74895986458904, 79.28221245701472, 14.94751810897914, 2.924010045917184, 18.68733237367426, 100.47718474030489, 33.56053510261942, 5.266699843123394, 7.612829397372609, 111.43706584637485, 116.2321137875717, 94.33242728995761, 98.84450462190745, 21.779105006253427, 84.54195852004283, 108.05573813978191, 129.33204535254876, 67.36350246574585, 122.2913728446145, 126.61274169249204, 120.10707814570826, 118.99167976108252, 105.0423133859063, 73.17755165405849, 116.97727772149658, 172.0504889881131, 155.86584121202378, 127.38028271902878, 104.3084783946267, 7.045523894122736, 146.9706391093883, 79.5428662522854, 129.52980337050704, 26.244458608975176, 140.25078514292687, 4.753789639718898, 98.45225082487417, 10.397931682813018, 106.29135451260748, 120.09252784520399, 113.06992437791969, 1.7395043045512242, 6.087491650296146, 117.32913706526789, 6.945735179994783, 34.208801203030646, 28.576150574649706, 122.7473463345217, 125.3681999879836, 1.5342674701073888, 23.82693590358168, 126.08076760772447, 161.50706077017315, 23.53187205280063, 3.160352423018513, 1.9092096087516013, 117.71643112064757, 99.38702997514666, 7.1740775666709675, 35.16297126097332, 69.23586190671053, 5.358594232135609, 146.61357893543192, 17.585484737676623, 161.9744988395266, 128.58700345659273, 69.20356720195672, 112.98362170724178, 42.03355765473092, 105.47246558343576, 8.736612511260986, 2.951819364256922, 136.67890344644894, 115.08468499636908, 146.4535243005101, 135.91576646394716, 3.6436821670461677, 135.4308897280538, 91.44859625799789, 13.923744359650085, 1.7084892704299528, 44.067091799078725, 74.78398541096512, 126.75201400636904, 98.09902483030085, 100.03158663891035, 33.23700322349438, 96.76412748798393, 30.31704262099625, 125.72425190982153, 1.850190496158305, 100.16989279684802, 33.08335724247906, 18.704698147593195, 120.50681812833886, 55.199758686408074, 88.66314099879314, 84.94534269263119, 53.31384296611092, 6.266587223210415, 14.405894674724655, 17.52958512790226, 108.97134461742283, 57.25960731945623, 107.76759169235308, 137.44463082936244, 143.80843869836286, 7.776644574726921, 66.62155745407706, 124.80027719706675, 40.45398632003077, 69.15702268880315, 115.85299019555251, 10.210947247324098, 67.72214305723983, 9.422495645926281, 4.149200689098631, 90.39367142571625, 50.32338436705911, 3.9390024306850324, 6.262278105420651, 138.19512282336936, 35.33643147445365, 150.5972853304309, 138.50038659449038, 138.13210115296943, 131.24315371098692, 136.15607617361502, 114.79395635345605, 26.709804792001638, 107.46969493206208, 109.88096017910485, 19.717319958010176, 150.08182895313755, 48.31758439534967, 96.21632471967075, 91.03438508595508, 2.8477141149691625, 128.60168880412647, 8.910184183801485, 5.770947192637585, 93.76613117341051, 3.636190460508899, 3.0104909881666706, 9.877922720088018, 68.41367883282521, 11.093462874141203, 10.407334919492081, 1.6978908074189047, 123.8956048661728, 130.68345950406245, 4.758293957991497, 115.30648559895275, 15.759428115194467, 17.176681400614967, 111.09904905684989, 1.5066869368861122, 7.004169219013892, 5.355455918418925, 1.7946918395126144, 25.937727104176947, 95.5239021637224, 17.396973294676673, 1.9521526772758362, 105.81572423094303, 135.88108022210537, 7.655701091599998, 39.62472599217258, 69.0333307645522, 150.5633934855161, 11.900455721325931, 151.25343832624293, 120.93399667002544, 14.234314640507247, 10.267562833622778, 49.17072138937213, 67.73948464537699, 76.22778170056486, 49.66194758815019, 161.32187538180932, 53.43397209391823, 127.53808437430858, 52.52529914840074, 28.51847584579878, 18.210508138303094, 7.234919720764888, 140.27218733086448, 23.10335179753675, 108.45280784984095, 60.59694201354127, 5.017361412572891, 35.67691579121749, 115.11291820195673, 88.04281939036447, 126.84108572728475, 150.37670898238528, 112.08218416763516, 86.42678488691074, 4.068162020054609, 38.726698321730396, 10.501278672494788, 127.32451255767843, 116.28668506689274, 74.66142976621732, 11.412065547817962, 31.724650034544783, 70.11228081233322, 2.8586573550647016, 3.0378390383583636, 1.0286962865097455, 126.19417995348233, 101.98018721433476, 125.76653844848695, 36.117823096963335, 91.19987120835363, 1.066722338142921, 98.34021026005679, 1.7528666802692099, 113.04990155909546, 167.49755478722372, 144.7690220341793, 65.82825322950634, 3.804591179498582, 110.84358134673218, 41.573464662714485, 118.03206953914417, 132.76958230048143, 112.1506647358737, 45.92154532311895, 6.741515661536238, 6.8135998668281, 190.42818304606448, 123.76137749895626, 5.243376806308941, 66.74865542889485, 131.86649211481043, 1.1781017033578258, 43.380416910867815, 31.391662162868915, 128.38880865576078, 102.7683789782656, 133.86984172620092, 6.612436119986263, 126.94477809025386, 113.18622805486567, 2.0507950365603853, 112.74667005607061, 2.6589381105766887, 87.89453671967497, 95.72722473467245, 85.84380563334663, 33.63425577403488, 11.315917059641908, 11.91716703997434, 105.07924862072232, 8.58016662498527, 65.28245494328071, 81.47751657442208, 6.007805239516911, 116.97587509272702, 107.97730656524793, 129.18383185810532, 4.444989598817515, 5.854096993917211, 121.09071680584884, 22.065710286423272, 136.8846042998062, 3.923724524773508, 11.346603470183753, 4.219283954478462, 139.51421207602527, 158.7546290147804, 3.1060674081954565, 102.14857091456427, 150.77886176872408, 115.07078099365033, 152.59956322870036, 110.16815204566676, 153.9825806441959, 121.77589699102671, 3.499369901956707, 21.494989143114267, 29.48392099299438, 9.451146529928293, 6.693850896114809, 54.039878166469286, 61.816675720460765, 133.2022708200218, 108.36236664380998, 29.997765716380904, 78.2318233266674, 70.2550197957056, 40.14852098257802, 103.20549033144033, 124.30058593896099, 115.31422599675021, 113.83451850592877, 33.17205989853729, 117.00761948710182, 27.66969159238468, 15.160333616280566, 4.633243223951137, 127.362017734066, 131.29953594189953, 72.30935926705368, 170.34439185779166, 88.04079001271886, 110.44089402530678, 104.47634176146015, 99.7256999379473, 12.894504471024028, 18.26251053592558, 36.92542652944046, 2.336906456476616, 120.06453973434823, 1.0426489110664765, 139.5729835499306, 2.4976686788606965, 115.70892056883135, 11.517034180401744, 11.09947077965403, 1.819768983722871, 7.5658024377226845, 27.764975542217474, 33.700027943112, 7.194844215427009, 123.03666599190915, 14.384616200989903, 27.64989858288131, 5.321803651053784, 113.85154730117806, 2.8723297185401733, 77.84193142398554, 19.49134918517242, 2.701986492327223, 99.07296641613742, 18.523921769560314, 169.24124699008345, 12.902766629656718, 103.0111235723153, 124.03230776734993, 41.404818610754866, 96.67299993520842, 25.265294223718303, 2.1860238510194767, 90.3273633487516, 95.7609002179311, 110.52805491976495, 14.442310389954049, 137.41622099330712, 29.6799831124627, 15.205162097914315, 15.975939549201325, 3.7147321288573734, 6.57037212359996, 106.73123301414999, 106.56733491803226, 4.732286712497097, 136.20754824848666, 128.79500118863038, 89.85920037981168, 16.54644588479385, 42.065482619748266, 124.02852993099164, 4.389199728691326, 128.7543788354507, 45.15536933935326, 95.7367688150489, 135.02312704905643, 4.838331834769753, 5.36508661037425, 96.55565196571435, 1.5096775794047792, 119.66324118206693, 124.76870570459916, 106.87533767152962, 58.84459777633305, 39.26267527869413, 110.75641128385902, 44.801765429084654, 12.68612212113607, 77.77099580919078, 158.2552052767002, 7.6210022084586, 8.069505540533573, 86.52686377449145, 112.7112683704363, 113.18673451378422, 34.62142816868791, 71.0983284511806, 131.8379953593965, 130.554496003512, 60.89527992935805, 8.468730275776375, 170.86037516771106, 8.988398259178464, 8.15804502289926, 33.81236193232521, 132.67721782689352, 5.658385321829176, 8.386714695871099, 111.16194150579103, 164.92598285901312, 115.41595128799179, 48.35228268863709, 98.56023753352405, 28.059579695108305, 17.538722172725464, 102.46753930158167, 122.76650079543603, 122.42783995285002, 112.45155107766678, 45.113213615785945, 118.62351780161156, 11.408216893670113, 112.09082386044604, 76.31479587365273, 89.5839119757826, 90.83192858688501, 8.774445731566695, 9.707412249901626, 74.09659109797896, 112.30088866158799, 22.832981195349443, 105.17898352086964, 95.2121722797986, 42.811824032466276, 126.55876718996855, 27.942510164772436, 128.15862701274906, 3.0978677734115765, 18.754723209244297, 30.767219437379197, 15.88490176119133, 5.127277133510309, 108.68680385746052, 20.086627822797105, 12.961675264485304, 3.016355468976958, 155.1605625277766, 109.85938929506925, 110.5058193638955, 4.818838324637199, 2.3132435055839724, 140.86567032173537, 14.406814435415045, 103.19725088366683, 18.581522390124167, 3.795385896854762, 3.7556260006528333, 15.664612433645352, 25.35138856229276, 8.764815631230912, 52.87791726595292, 99.74954697507172, 11.167490519920428, 10.94380312288197, 7.808292283263107, 101.75924925003217, 33.19072906536871, 4.475351229905074, 133.43965489932478, 11.948874853843291, 18.74093059431212, 51.057583248497224, 27.72858849649647, 114.68343494177125, 45.13818540938709, 91.5705548456233, 3.9449061388023794, 111.92386496160742, 1.6180544656869857, 1.9794093345098192, 145.33562450992437, 6.549479051062521, 64.75305745484498, 1.8351997245200573, 154.14887522871064, 125.07100168010292, 15.880009556573587, 97.97462082818312, 12.398513826660091, 128.78847098862184, 120.21531663691076, 131.1177948029139, 11.79214891449629, 124.97267997312063, 8.755434633967718, 4.858209363488009, 5.440037985280711, 90.7727645333477, 81.9934747415852, 142.11477688105552, 146.88168905949914, 0.9991751564206935, 3.199523391211108, 1.6665306284103747, 140.33555760409035, 163.49397228361264, 39.19996303336479, 32.53012271650535, 6.483849175100675, 2.423895909819237, 112.93082479405504, 6.033479596519387, 170.74516160289983, 163.14115347473037, 145.54269248825278, 71.20594114877129, 138.45668850096865, 133.25333193235977, 2.2630205659584646, 148.50115088439492, 133.15254946026604, 135.65362473399588, 133.18889891954498, 126.36694388259342, 1.0547724263011322, 15.588506178418553, 108.03975516438014, 17.004256845010097, 160.22899888555153, 1.615533835198422, 151.40392212395042, 124.46664412368759, 151.17441769368688, 25.5372674103766, 123.31854738580704, 64.26535280087154, 6.924983995210652, 120.25999877500016, 95.42909331992139, 4.072567605426731, 3.2695773127514394, 25.27327811641522, 108.05859068284997, 119.22941885133744, 56.129084651633654, 119.9182587034164, 114.83893030739392, 81.76432591496717, 48.409586364321875, 81.40754028296455, 2.385567935843512, 43.145459379440446, 127.50273902663541, 8.589834551684294, 116.45866344862061, 4.553446339756762, 54.042724274485884, 61.79800188789248, 24.374279932160942, 3.824816403529307, 98.8848648222198, 2.2696326686058685, 127.2320423478778, 149.4936365541201, 144.6146712761872, 13.149096339207606, 10.60813374628131, 2.0905180405797164, 80.67942860239867, 6.428096072782488, 107.63968333821009, 29.047455548927587, 5.898435797087722, 55.219826797056314, 12.23832881701868, 110.94090474620198, 5.159624838677305, 12.149520991608592, 93.31443670124513, 17.54988443991433, 25.975033865305857, 1.6887762930375938, 37.18353382299113, 87.49513142130627, 119.60018528541593, 119.63819696449141, 5.951350621609911, 147.5716944694372, 71.59531460594981, 6.400623336490279, 64.41335241443802, 1.9473270920586259, 55.4300971842889, 54.93155793703458, 102.03517690980846, 112.403424974067, 153.23717212759553, 11.751063729400247, 60.51861830661463, 166.56890973870998, 3.648322859398442, 162.24997263199282, 117.05896574102923, 121.76670569737047, 3.703432968851442, 225.13618934256777, 138.36479528711956, 30.418649496234494, 141.29042654577248, 80.81829525436434, 109.27721003922811, 139.78197141004702, 8.816230857503593, 3.839542630229401, 119.2826432431249, 102.34607367272193, 3.623425104031397, 78.87120901286151, 25.56680250559687, 100.55776158486984, 21.166487200856782, 117.7765534142645, 120.76060712482214, 98.56561433167786, 47.96325357012764, 94.82646638699003, 110.84615360350634, 9.13948330835437, 11.566282454006801, 6.395538251882094, 36.01823077073396, 5.7592409074437985, 8.626412204570592, 26.49613492784072, 86.2501779864921, 118.73276791494584, 114.47832700791506, 61.30007630447416, 118.40678031206198, 123.81564944543379, 61.15207330760057, 1.7839013378920578, 7.879295099376349, 5.607447251135626, 2.2930563528793817, 148.37724474967214, 110.38084164470364, 12.472944387196064, 89.6066280175745, 103.08764884027272, 2.3459416357055187, 32.6610328392796, 114.39245724761916, 7.313133308004788, 11.924635298454296, 2.1838692270884827, 102.58300113385876, 9.203535287755408, 12.564803893498098, 11.818248108055572, 121.15636161862238, 115.95583435020038, 157.6282362465392, 106.82907485498686, 171.08375597001705, 114.38937817795117, 80.4114050129997, 80.7186996790908, 4.167954623144814, 14.618311201136137, 22.996060247893094, 131.27733993936144, 32.821151351704145, 6.289612648290569, 77.25002014310253, 153.4752978799981, 85.65509517380907, 4.271426224501776, 4.027673048938678, 26.407503111155425, 102.50255552660059, 121.51292631410118, 20.749863910901624, 115.57750430035078, 1.6591056635545727, 26.37748279472472, 128.01326848668324, 114.25330017264108, 120.58491642931268, 119.11574717243869, 128.80013836115722, 17.757707667987248, 159.26802720386584, 77.09078032979312, 132.07220885520164, 50.74552573869697, 117.17013790667508, 140.57148129763223, 27.658621401230317, 123.51072967536423, 11.011373343959484, 4.324558059938351, 21.353733610621255, 125.22102469714672, 111.83198854429739, 6.453062591704819, 1.3702879757191442, 127.31341833990301, 6.465427080903051, 3.4527868059687212, 6.123446191723386, 11.390950789338346, 97.61929267751941, 105.21055392001571, 32.06030386072738, 109.38463492268313, 3.2974696417042098, 118.94979791812334, 127.88261019390973, 25.61013973268466, 20.778176250930976, 100.21989448366563, 52.297111692263286, 54.6274137508067, 2.907637820939681, 7.097450409074584, 104.67651982437918, 3.526853941422528, 45.79244140537116, 4.445345257510719, 40.15782660402966, 123.76230234179826, 114.37468158146501, 52.88840565041294, 99.57243986670132, 144.73527948755773, 110.74306574337659, 48.18177071354046, 128.69704335399265, 1.2914460966140775, 92.03996662940585, 123.90152685257488, 14.60073506073144, 48.37141939516384, 133.0723241725301, 17.118138511613004, 126.14879551495805, 112.86511027655355, 109.40794078059719, 15.724282209865612, 154.6403781401775, 163.40236410251043, 150.22128989749228, 116.72275245333613, 5.560282726276907, 8.822218010784507, 121.55475384185402, 121.7603998789759, 137.68901787518683]  # Truncate for embedding
baseline = 12.590044674178746
mean = 68.5170457932924
std = 54.06221884717537
p5 = 2.336036672291084
p50 = 71.25756179659558
p95 = 148.48511367353723
display_name = "Expected Cost per DALY (Risk-Adjusted)"
units = "USD/DALY"

# Create figure with two subplots
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
# Handle edge case where all samples are identical (zero variance)
if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)
ax1.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key statistics with formatted values in legend (use format_parameter_value for full units)
ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {format_parameter_value(p50, units)}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {format_parameter_value(p5, units)}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {format_parameter_value(p95, units)}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {format_parameter_value(baseline, units)}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---
sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)
ax2.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key percentiles
ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"
exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title
fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark
add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from
output_path = get_figure_output_path('mc-distribution-treaty_expected_cost_per_daly.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 12.59 |
| Mean (expected value) | 68.52 |
| Median (50th percentile) | 71.26 |
| Standard Deviation | 54.06 |
| 90% Confidence Interval | [2.336, 148.5] |

*The histogram shows the distribution of Expected Cost per DALY (Risk-Adjusted) across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
