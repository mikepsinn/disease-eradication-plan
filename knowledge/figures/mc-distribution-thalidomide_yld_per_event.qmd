```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Thalidomide YLD Per Event (10,000 simulations)"

import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Simulation results

samples = [14102.209087039015, 8718.70124042235, 16502.494026419874, 17637.380615817558, 6264.367456880194, 7929.138678456123, 13230.021743923931, 11302.954054537655, 12569.306681953962, 9332.6247154075, 17268.951588096515, 16669.449423780236, 12957.83483523766, 18820.646675311997, 14926.693569920339, 9301.481414640042, 14424.68721677308, 8971.039490826419, 17265.897145586285, 12444.69161068343, 11836.380249413229, 9909.675951022735, 19487.204908159438, 11972.927559528665, 10849.31347311787, 11160.654764805655, 15292.261463785002, 14390.31710856201, 14646.376293422383, 14747.475547396663, 24024.0, 10937.884490283632, 10529.354845343518, 9462.599434031325, 15746.477460179254, 18856.09986256987, 12157.124207923222, 9375.438922298285, 9423.307518423946, 15929.128208760785, 16453.009223197387, 15349.577808002963, 9980.261512598421, 13738.602808616231, 13178.190306700628, 13679.315193733026, 17215.29058592175, 13691.8500889245, 16094.570055928407, 12961.580389743423, 14010.99265551858, 15818.302751858804, 7503.681114889419, 11295.722719312398, 10699.12997683812, 10072.228859919975, 11480.39711333763, 21415.636990310635, 9290.135982732552, 17814.36342760064, 6916.075792630031, 11218.993740494478, 13414.615441381435, 15579.634540674357, 16273.440343392944, 16745.507073286513, 11167.757636872115, 10715.16022565364, 17144.19361651132, 11822.156254965448, 8005.945170606011, 8433.393001957478, 9097.424762349983, 15087.847397201069, 13314.9512681368, 16156.433998524722, 10851.491037283744, 13379.564856995363, 15801.488241675414, 11339.96797261339, 14870.908850970587, 9986.939913578432, 11115.697152335908, 11032.690472900465, 8240.344196450502, 15033.127905448364, 10701.067941096018, 12709.763371414356, 15015.668101839457, 14816.642867234383, 16027.043296294776, 12215.618320372605, 10881.486350431836, 12305.362901408831, 6892.951991914947, 7517.761211365324, 7880.240842982944, 8847.779059408149, 14585.359409343057, 9161.365148134379, 11062.224540767995, 20010.708734531076, 11152.053502793937, 16408.093636405873, 9053.41676535533, 11745.219292248124, 9005.81322771592, 11210.31063706294, 17032.08788729632, 6807.229677933536, 14757.395972426464, 13777.774639019877, 10220.550334391693, 7537.403665223502, 12996.706921990552, 10473.955186583395, 13739.923258987383, 12755.870907406843, 22231.96443959041, 11602.842425670447, 8765.226046997297, 13480.650548439773, 13682.655603305226, 20419.88653510018, 16987.770879502707, 14367.3079017305, 21195.752048679606, 8270.292026539952, 10070.586416416783, 9085.336098470725, 11016.080221686501, 7709.234807423875, 15829.71195800913, 11685.65469912149, 7466.507627038131, 8797.872948605593, 14150.607600325895, 17025.153722376792, 24024.0, 24024.0, 14650.961201863021, 8880.297136994528, 5893.724181917774, 13930.107920965958, 9464.06843295708, 10897.62747518367, 10165.148045773756, 12026.843601898989, 18432.496315947046, 13375.84144719844, 11963.756271919472, 8725.751357039351, 6926.652557672114, 10623.901839265172, 12412.18373028088, 23560.98940356486, 13260.409878968752, 17919.674465676882, 10576.504865250019, 8276.19001186838, 8940.738074075922, 9765.743234892481, 24024.0, 9428.752169279902, 17026.30617239449, 9165.729995352674, 17579.495034060426, 14493.93434760676, 11968.21651998367, 12465.995414921757, 10000.255457712788, 14815.373563830532, 10751.76064678975, 8156.836459055087, 8002.58167461882, 13463.832974503493, 22042.179599312964, 13383.191375573144, 12123.215130114038, 14002.382580007028, 20066.382180016793, 13681.087088406946, 10928.676055436667, 18688.690404811336, 14741.793457461392, 21737.85143591575, 13515.233539533512, 8158.567357413067, 7739.94318223862, 22631.11834301384, 23203.029691889325, 11871.19722384562, 11029.706020151349, 21188.40006007042, 8513.500348142075, 9179.770004306823, 15880.713399817361, 10984.123477556908, 12620.505444359334, 11929.94874628556, 14264.977366744433, 20790.42243354201, 13065.751540215577, 15882.527623642902, 6052.1596605163695, 12423.92204016619, 9349.735824146772, 8167.185149287595, 9248.601115826354, 11242.940476099922, 17499.92424303209, 7856.237835197115, 12800.718069967055, 10649.877795639339, 11256.485196678495, 18044.131866663036, 15308.843908120085, 20275.93197717832, 11972.980755083647, 9861.052850647342, 11682.08651330137, 13790.0245552981, 13473.852617577682, 8569.012881326651, 13065.519548705415, 13728.520686286744, 24024.0, 23990.399999999998, 9332.277326005973, 11431.64791579169, 7476.778153591382, 10248.427195505044, 14156.132087167269, 19367.008072921282, 9737.950403761753, 10001.452511672007, 5872.0, 11931.679058261077, 8643.25275130071, 10474.05935511868, 9250.8310820781, 12225.25097904338, 6717.294252478573, 7471.751167240158, 24024.0, 7969.717793171701, 8549.206352897017, 23933.36997824273, 24024.0, 8315.99825475418, 11104.923410809131, 14275.58138578629, 23224.833298573194, 8884.742276097495, 11590.023417260998, 16668.03575405354, 14758.339255878605, 11066.368398861036, 12065.69934510931, 7711.8115129657535, 11605.402382258564, 11499.173055819572, 13738.624776842089, 10380.673842718285, 14963.90281392754, 18106.442697156894, 13371.799298569451, 14328.193547308365, 12902.703518094728, 12656.5663978322, 9772.431794655511, 14158.482012720715, 12218.35225171972, 24024.0, 22018.590920215378, 14496.35747215271, 9635.129732600759, 8485.648294721168, 19284.188274400836, 13892.225266044567, 15013.977399545824, 6768.148958962573, 17565.93343992146, 14864.373633461142, 8508.122908144429, 10696.829289451965, 13894.735549208606, 12901.04533137066, 11398.908714608096, 12204.216609010167, 11575.53893720126, 13364.645790977174, 21228.175678617168, 5712.0, 11631.031018858932, 13473.699361889176, 14054.124571290802, 11075.133180930601, 6718.556491384632, 14214.20212839435, 23218.992800100033, 7289.808210569935, 17190.883877479588, 11254.69492425404, 12394.72297996607, 8678.164084382603, 11219.891851589504, 20013.757958630486, 15542.741245262185, 23273.37743652451, 19175.550772942974, 14770.246267204499, 23356.86738088968, 14769.988436304602, 16965.199375207896, 11389.551203785983, 12959.08080048263, 9858.326849737876, 17942.582618686796, 8305.547367454508, 16683.63884760398, 11823.59790476655, 19123.894493862717, 16503.78101066832, 23860.808242275507, 16387.46136757186, 7184.822089941836, 12358.212438514925, 8315.314420354098, 10517.496282874921, 21543.92822377949, 15863.550796192452, 9855.554887783775, 8800.930768650214, 12805.857640547198, 8170.620360111576, 9948.788875578191, 14121.417805247516, 19037.581277717658, 15698.623738419905, 5728.0, 14101.286894507533, 12996.474193366952, 14649.54155014379, 22356.264122040622, 6037.417028958025, 10247.668910039652, 15593.261810539974, 7172.020431619319, 21277.17979357869, 14423.625958350078, 17079.91438576577, 10307.688498738327, 16864.829361553348, 18470.11093087662, 13740.440839815647, 13744.347193726775, 13936.952643789227, 9294.447633229804, 12011.727425749037, 11977.413606384895, 14489.722372418853, 18034.254062220814, 8649.512037334362, 12108.80749528559, 21330.428635245386, 9690.914892662937, 9427.232861539957, 13588.137695969992, 17045.0544583431, 12707.229779028166, 20213.53601938366, 17140.41184712128, 17036.895243762207, 15407.40055732736, 24024.0, 11745.824104871008, 6154.191788358482, 22242.239432083006, 10746.311393313083, 13132.274505126428, 20079.67930065384, 7109.1280136438545, 8079.616428413347, 7110.430694547707, 9517.85887211836, 14771.762482140433, 15242.861768243658, 13952.39015928508, 7620.939693631493, 5712.0, 12905.589661714997, 10696.327691882243, 14878.156853548244, 16218.176846940085, 13280.14389513756, 16559.761089488245, 13731.039999511171, 15259.591767366137, 9824.137907288472, 11870.992923114107, 13574.118792367786, 16913.865655017533, 10985.894952382358, 15208.049254605885, 11522.98933192882, 12125.695870643172, 16970.047832886485, 6166.221416668137, 7937.589996945136, 7432.625273546901, 5712.0, 9935.56797760314, 16499.360730925324, 11436.982165318395, 13576.688182369642, 18570.926743449756, 20208.72804821473, 12353.173757819659, 20398.546719445985, 13069.512138193992, 9380.267099091643, 10220.072653331721, 7434.913215698453, 9211.230038049544, 11126.153310329428, 16805.17775773076, 23190.490921192195, 7701.331098244342, 14540.859234323681, 8717.790209395913, 14972.727687367573, 12071.863519972081, 6558.551754267842, 17568.748560659562, 10199.870825291444, 10443.80819511506, 8631.42225054185, 10001.197061911176, 14739.41071213719, 11826.702885468294, 14215.97063785554, 14380.85934308309, 20151.807499945073, 11202.46011737991, 7440.020199927654, 18436.77063259472, 11248.47215864864, 18746.971637110237, 14489.67706699581, 12071.748873457847, 14320.224480129644, 24024.0, 24024.0, 12965.940999684688, 13383.688450952346, 18496.913282187405, 9345.494621975906, 14252.989289369934, 12524.388915657086, 14151.649279486095, 9387.324852450103, 7143.672336629173, 6010.288213548282, 8477.775730170555, 10744.35412511845, 11396.737821903898, 24024.0, 18687.660172833734, 8965.668399927665, 14317.371515975055, 10936.530518308948, 11438.092802404897, 13495.882590803085, 15755.86128134067, 11209.838983155592, 18425.173846420792, 8400.562686514873, 12671.351332995911, 24024.0, 13690.531912996612, 20983.7843240365, 13068.03269907759, 15537.29337661637, 12381.694358304068, 11914.44976055392, 9564.497141511296, 14746.04517798595, 9335.249830569297, 16027.642002250335, 18586.439415215897, 14393.238075099824, 11434.069245642931, 14863.111936590523, 11341.393620100363, 17620.869682915985, 6541.037459284768, 11217.481186793882, 6168.809777441863, 7396.786865843523, 20468.39913620727, 17376.147660524228, 9776.22264200464, 7386.518217272641, 5712.0, 10425.11976417427, 24024.0, 14758.664863345102, 10351.02103943238, 14919.927101727806, 7217.476463669563, 11387.951734802115, 13111.69296264565, 12267.300990472171, 16737.566259580475, 14309.187549469729, 16035.84364448484, 9895.918557161182, 17384.68125327093, 22441.681503305736, 8952.192718982074, 9211.983482835309, 20269.8253277394, 11822.068733760701, 20745.30514185356, 10798.675094303358, 21131.894377834837, 13263.408362870641, 13880.50840494001, 21951.262884941007, 11118.360242940002, 9040.74401422315, 10786.53056272845, 14858.585978005918, 7211.011847526539, 15863.364522696136, 10434.316751028025, 18981.476481728372, 5712.0, 9551.85964228012, 6894.066660219223, 9420.232966430976, 13828.25209972013, 11871.84557199245, 11572.513993457807, 11962.528039092393, 13590.88240475915, 8809.446560869286, 16260.150554049349, 15991.988329948672, 14494.16964258497, 15414.353026931078, 14055.236927452916, 24024.0, 12265.026256243611, 11344.759736693703, 9652.283737166892, 8731.276254780028, 8090.445094557897, 9210.089392304992, 12349.617674775409, 14256.248037288877, 12897.855649092198, 9630.67403268396, 17392.37082197791, 16441.21590567241, 11961.49327911358, 10024.810073970728, 15364.694868396875, 13527.194381934107, 7516.337349299526, 12355.843437554673, 13890.37544550931, 9171.26181081103, 13531.916377237083, 7506.949939362783, 20271.345464316717, 19669.93802805838, 11574.372333323812, 14410.433702768534, 5712.0, 8358.827016650313, 11395.488463164458, 8608.112285869956, 16283.071965798934, 24024.0, 8308.166076399528, 9380.152975805508, 13747.034741088752, 22302.882363334884, 8161.757941914605, 13831.789295855096, 23863.715384664756, 6991.311069929087, 7997.905188852703, 10880.860187985532, 10512.965141935296, 16861.17057648901, 13787.870091139455, 6678.639891915275, 15191.716066909272, 10295.007037532005, 19827.823406639858, 10114.638012304003, 10076.483511677794, 15317.465086836546, 16568.39774470868, 14820.98054322922, 6895.1873662512835, 15308.612459773083, 8727.943412989584, 13746.592739471911, 7587.11456676677, 14816.064781237415, 9475.278801992756, 7976.843542482398, 16281.320337273213, 13787.830977092162, 10161.581551508103, 21085.45634884286, 10802.471824334367, 12804.245671485316, 13933.23362607129, 10129.604852845194, 14962.779379460444, 10444.681357888609, 10927.225582002977, 20463.740123059102, 8717.721681061073, 5712.0, 22302.136559466424, 24024.0, 10940.22395029334, 6297.562612335949, 11337.560626641742, 11434.124274816122, 11825.20295442642, 8484.101636233836, 15533.76732674773, 15243.770927774289, 7397.691548119438, 16209.833196961861, 24024.0, 13462.25586567642, 11213.884998469593, 12024.12235284707, 15744.353574512157, 6785.75021045472, 13418.716614587653, 11014.73522534741, 23968.626163064302, 11883.050128174302, 22767.83227125088, 8518.753949929354, 15582.650008915307, 14166.164043517972, 9264.332843252665, 13475.922005585515, 19420.950304475125, 11264.64337245466, 6886.999800993523, 12567.519814461444, 9166.5924483354, 11203.39110550436, 12301.069481092325, 6852.120845311407, 7091.370390066291, 15019.368733331092, 10487.207050178695, 5712.0, 16718.949912089873, 13942.225496420044, 9807.279028279772, 7888.87891554808, 16989.98002924574, 14321.7607994694, 24024.0, 14692.5052705271, 14526.957632206751, 11922.190747986257, 16902.022439253906, 15799.99826238902, 19683.803073677216, 10489.939663951633, 10834.985894395651, 10659.953682932157, 16737.552511537433, 21429.36494757874, 10744.022802659858, 10878.490028534143, 14152.095734947305, 11588.97714384782, 17732.07809667792, 5776.0, 9419.396762727554, 9559.260658735333, 5712.0, 8963.079304955425, 9124.777484953282, 11777.635995574892, 18741.280762387913, 11590.4932984674, 8733.638013802021, 12381.298358640199, 18316.889417870952, 8922.662537947605, 9132.583617005608, 15420.15317381605, 11687.152377374985, 15919.889606968507, 12576.709496291496, 16217.299035658856, 8726.688966208234, 12604.113777412118, 11733.7097950968, 8171.641064837501, 7214.082871852799, 16115.118106186448, 11163.115670405441, 8767.21774711596, 12220.878698925211, 18852.744417626425, 5744.0, 7394.608688873148, 9091.59507955724, 21187.350334640847, 13993.919114195827, 16609.435857023083, 8403.3500172554, 8474.371376799882, 14820.19033602778, 12915.037905016388, 15365.586530172995, 11830.176634494888, 13982.317823998841, 13378.514477551063, 16669.37304851885, 16843.577088554834, 7068.212526213938, 5776.0, 18040.722257590765, 19242.19473008717, 8769.930222507513, 6472.794155266926, 13110.60966225305, 17577.084110570002, 23758.36141265676, 15194.23197564218, 11075.542267202018, 9182.505796735632, 12707.289636717764, 11383.825875306451, 8798.712435749598, 24024.0, 23703.319424538055, 18910.432316895538, 9095.050933843228, 17134.73496739279, 15869.748299775127, 14805.624369851404, 19676.236767972525, 15830.362592508209, 16443.06213560764, 15861.692763372275, 14273.545360963735, 6667.8664975803795, 13048.779035900769, 10378.998430446229, 7999.739014997479, 22859.668259168953, 23226.12387581836, 20420.012411364918, 13847.747084548617, 20387.276579017966, 12708.717344457107, 13589.383306308033, 8554.49671661496, 14577.784960381028, 12920.129314704265, 7928.439230555438, 12418.175193827023, 12305.33682496653, 23758.213490921997, 17344.884850676124, 12707.2757549229, 13831.146924573206, 12857.196043375825, 11773.659062557024, 8591.58779968192, 11980.701964042886, 9686.375610105282, 8081.625006215827, 15153.671198828828, 14536.61813858547, 6646.970316561659, 12114.062229439032, 17991.73164746215, 18380.273849377725, 18179.653097176215, 12820.521295267952, 9346.568723711089, 8570.115379580755, 14309.079854479893, 14478.600310608344, 19936.068258490566, 18666.694924750915, 12069.290506928053, 8090.846664721373, 11296.913243698093, 13675.594445748487, 11775.484872515293, 10294.324453420782, 13841.729452624366, 10567.304937199964, 10113.73456788353, 14119.950658222833, 10968.98763418271, 13794.163152985942, 13944.396781838153, 8404.498144969526, 10655.700515879404, 21001.661993926482, 8349.888742525865, 5919.004773997579, 6470.366442541366, 12773.163297123783, 12801.400929921072, 12125.540406225748, 19427.008708546105, 5712.0, 14549.292967523912, 21937.828363412926, 8442.065472010367, 11058.830538546958, 9674.100215835231, 9180.422814509295, 11259.450438680142, 20930.302337916735, 23935.483783179014, 11216.786357033958, 24024.0, 12812.538828231523, 23432.445350097318, 12250.830192242618, 13262.348821744987, 14390.398787309006, 24024.0, 17094.910079530164, 9819.387320737582, 17816.75611173237, 11118.231449687386, 10617.07789327385, 17447.903977693044, 12801.803108744047, 13983.44583953451, 12713.30131757955, 14262.337784661706, 14705.61270011396, 6297.411103084774, 16030.596356820972, 8912.5744151169, 7542.693713119196, 12401.464475071785, 13025.489691034132, 9865.538493199385, 16974.840486310826, 7814.610059765465, 10936.805062857124, 10259.591258096134, 12428.865158404378, 13984.198539344647, 8810.504093183292, 16367.615338163641, 12950.51235141195, 6400.690021865069, 6239.032844721992, 12603.561757874098, 11711.222166564268, 12204.371866579453, 12519.434733899252, 13696.871122844284, 17689.114024433977, 8487.7180388313, 8315.369675409129, 8554.732262281164, 14010.46247031936, 19628.903304492505, 10843.216343399532, 5712.0, 6854.243487518546, 9387.906751681658, 10354.583276226176, 10933.855831355491, 12819.726627306223, 11312.444168201226, 18317.456941122142, 9939.736272896895, 9296.230054556934, 14984.410062466202, 7287.385665936682, 14532.350757263583, 13119.22260865276, 12011.920672899272, 22144.001614147786, 10124.800585690644, 24024.0, 11678.657813091195, 8003.9577229991455, 12967.24420709708, 8601.507497750586, 9676.151884050605, 14577.899232900401, 15411.616028376187, 10124.875698959895, 17935.287076686935, 19045.385394136654, 20995.879895122973, 15257.736774640303, 20466.742913250226, 6430.769406674799, 11299.444014545197, 9288.100158731217, 13208.765365876665, 10306.715847521713, 11923.904600151127, 23956.8, 11915.979438616372, 14649.273663694346, 11640.980573118215, 12981.275080303974, 12670.588856986215, 14821.602182849265, 19102.70427843583, 22583.83990075513, 14115.121089798942, 15589.305535175634, 8386.577672325546, 12263.234799414116, 17636.47446962678, 17197.75410535257, 13636.503682088272, 17319.58768524986, 15069.8508665744, 19317.200180950218, 14011.619699273084, 11153.231042094609, 14260.362935644005, 5712.0, 14488.348146291934, 5712.0, 6812.132247842495, 14857.018081592058, 14980.6452728772, 8349.3444025588, 9810.524825563738, 20524.65732756623, 10650.15471448275, 24024.0, 12651.832363714184, 14633.54253775956, 22359.03813504604, 13262.272799171431, 8839.365088686152, 12166.704099803597, 12477.988739081344, 7763.322348364079, 11544.532433152412, 9693.440665907105, 17527.564953435136, 12810.232132841267, 11441.441172743524, 12174.75866988285, 13690.639946710444, 15748.931227724453, 8843.708373846124, 8716.092033364028, 18683.07670989766, 10925.800877761376, 7615.1434669464, 14809.126477800803, 14915.164529478163, 7294.090424528144, 13731.732902600737, 16429.46759332013, 14439.8691072633, 15847.118583277965, 7633.03601359429, 14222.282511331676, 11354.215430439071, 10652.619981606565, 17212.485005817838, 21290.391124204758, 23744.06623761955, 20129.800588902337, 12166.688816077974, 14356.18047707212, 16607.903247843497, 13213.579147809309, 13261.6219351945, 16951.79362950489]  # Truncate for embedding
baseline = 12960.0
mean = 13283.872102036923
std = 4501.551069756469
p5 = 6927.414718437325
p50 = 12589.700701038582
p95 = 22564.229729544615
display_name = "Thalidomide YLD Per Event"
units = "years"

# Create figure with two subplots

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---

# Handle edge case where all samples are identical (zero variance)

if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax1.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key statistics with formatted values in legend (use format_parameter_value for full units)

ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {format_parameter_value(p50, units)}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {format_parameter_value(p5, units)}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {format_parameter_value(p95, units)}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {format_parameter_value(baseline, units)}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---

sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax2.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key percentiles

ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"

exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title

fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark

add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from

output_path = get_figure_output_path('mc-distribution-thalidomide_yld_per_event.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 1.296e+04 |
| Mean (expected value) | 1.328e+04 |
| Median (50th percentile) | 1.259e+04 |
| Standard Deviation | 4,502 |
| 90% Confidence Interval | [6,927, 2.256e+04] |

*The histogram shows the distribution of Thalidomide YLD Per Event across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
