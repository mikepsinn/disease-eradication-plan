```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: ROI from dFDA R&D Savings Only (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Simulation results

samples = [429.54020415143304, 392.8829760252571, 399.0647807882858, 412.5313865412942, 486.82291753210194, 437.3594597469671, 413.1063683018938, 398.6575687551936, 410.3078504564722, 516.6606965623236, 505.42546136427995, 401.37573528334525, 462.2744920836723, 491.97829538665053, 434.13032136257397, 523.6954591735872, 423.4819484013476, 434.9474310098138, 414.8280493401775, 482.355243694736, 469.4654344329387, 516.8198013893007, 383.32477512805673, 507.10793649229015, 453.08229421251974, 501.14400462342303, 464.43785178239676, 372.6979879558915, 485.7734189880452, 436.88174958007977, 485.36365243543105, 444.0560681407159, 560.9932091891345, 438.1236785970011, 364.22882571973526, 479.1561698908065, 399.55748506481507, 411.0510661468175, 553.9179063578183, 429.3238923295838, 453.22972063461907, 487.3827229277571, 524.4751559436331, 440.9447974648683, 337.92969604686255, 393.52038524436216, 397.07453547902395, 515.545791120508, 515.7432072286217, 381.27816505364007, 433.7920924378026, 527.2103876319903, 506.4633549353586, 503.5563117046495, 506.72901919353586, 507.08071178932346, 448.3535904699826, 328.1731867618548, 513.8036747768643, 468.4388618543533, 456.1630672923429, 591.5648930341133, 298.32194942179757, 291.55822339920735, 355.49554119931, 405.64963939804267, 472.30984466033635, 461.3493318618496, 434.45627158599603, 435.6626146670313, 601.2349330023434, 453.52413903531067, 467.4074102870043, 384.61389058889705, 450.54755502577854, 500.64649805225395, 561.7593596815436, 484.77551100121474, 448.4839321093247, 442.4421643082388, 476.88601127777105, 438.92750554627054, 497.9559394054558, 469.67917698139263, 516.6454676832045, 508.6796335886017, 404.23971581448205, 468.6713297195184, 545.5426955263009, 409.1649530852199, 437.4641662157173, 458.2526574626247, 447.52639478374783, 355.4274816980237, 434.8610765634612, 525.4955488030055, 687.933441813201, 412.554901604452, 424.4561105185394, 573.7284473178767, 451.63701718283386, 414.07594327977284, 428.892187772805, 428.8638546481742, 581.9954830359544, 329.33343103658933, 439.48096568241084, 438.0082469078885, 458.44846101581896, 434.13363096107173, 428.26620582628476, 406.8603614363825, 481.1881506813407, 479.0872462715337, 397.32379129218106, 525.8818586018617, 521.7858961989602, 485.7146466387414, 482.26336197106684, 427.7550972703588, 522.499614390901, 414.2372528384592, 491.88372381978365, 420.74370322044115, 460.35857989445145, 385.7755802073211, 463.1661751560252, 568.964493528916, 332.05042900925605, 597.6402329853522, 587.8615386963967, 422.7389048500418, 441.820124440729, 542.5142414708441, 502.32932130723054, 540.5302584458279, 450.5778649639844, 387.8752043756482, 367.2579176979521, 411.91394346428433, 423.94940077227284, 492.72437372942073, 531.7567415813444, 416.7138995702323, 477.5642899618517, 514.3995335868733, 564.9097839170025, 464.1520773295272, 483.6889813351768, 357.6583862233148, 542.0362667546273, 557.4721966235293, 611.9813675487915, 437.5136314887783, 447.1683346532556, 473.0262527622731, 555.3766358660313, 443.1928614014864, 407.076223726922, 487.3151970364322, 479.18982555726785, 508.93461014093214, 463.3226875763171, 477.8176949425528, 514.2671557359402, 585.6853426210756, 503.02452506398487, 380.573151777237, 504.2652206536405, 372.5282580415734, 440.3172863853538, 508.0253137016031, 415.50700814939944, 427.02719075947937, 581.8489504630498, 434.406536285607, 364.19285662793305, 419.64397117199064, 534.5449306077946, 384.27884059880296, 498.0909396294554, 529.4483148007566, 460.7936549305695, 389.9966779215706, 391.3539618813152, 498.079875906865, 400.41031875133893, 423.5011544162262, 513.8104997440863, 497.8945168910591, 479.7570467142426, 394.8538900822122, 452.2802990572952, 311.3325728371946, 422.24020548639936, 507.0170561296724, 447.03259928971335, 344.50064673714127, 466.94344453779695, 411.6794209061498, 375.05143194801127, 413.15545413212476, 439.0661724903491, 531.1339041928736, 502.0444300124438, 407.7474970069302, 544.4140925620926, 491.1819033293507, 524.6070138661257, 438.3611179464965, 456.8237478384169, 409.38354804282176, 488.2215342357319, 454.9882078266769, 379.6109291067164, 431.4779105114401, 330.6256888151622, 402.8063146165425, 487.24570737538426, 582.4305395291294, 423.3908677902302, 477.5272596449327, 415.2397104173011, 612.0087974952029, 457.65821928283225, 505.8382208025378, 311.05116267403605, 333.8356272706694, 479.9103238971058, 416.450262675317, 529.6027196331762, 457.9136558651412, 481.13474911491585, 404.36371643655366, 483.13019860519984, 458.49478930306503, 500.67729147105604, 451.70022955106185, 528.0484902565187, 383.3915069845955, 472.94421765457713, 457.7528597600551, 615.7905667909174, 560.2954448048054, 376.2247026599142, 614.4384448246249, 502.4622764190143, 446.0030298271845, 438.83950885522205, 608.4870538755575, 478.23813682978493, 520.4277667387212, 362.63240440672763, 569.111636450641, 490.768942845556, 447.1314407568487, 416.7255160489796, 554.4795957552441, 485.00365044312315, 519.9441678349237, 461.3412377575387, 468.6878349306971, 402.26543244213025, 475.71761796216754, 449.01604995572455, 361.358133542958, 442.1612648317576, 458.26971172109387, 519.067846356198, 458.00129025053457, 493.4800808060467, 465.29016863822136, 525.9230272658322, 419.53682040039166, 478.9636488021394, 437.1827811007128, 550.0461568443542, 549.0307081637455, 475.9960384338366, 425.7625361084978, 465.840806130608, 505.37682630115404, 364.7949243831851, 441.32938214010886, 512.9337004429508, 427.7244207023087, 449.9056357764817, 543.2795414815321, 398.56205360284997, 510.41259955342076, 569.39239934127, 401.3268387516142, 360.42716485384597, 570.4838150783596, 409.21831984800224, 405.2770960320585, 418.973774690321, 556.5569914084134, 466.8985289114888, 372.32764429300613, 389.7027479660845, 601.9008020447798, 450.07269442795325, 477.5852138166695, 573.885785137919, 464.0170881128648, 492.362090751278, 371.8603584395194, 448.0712382630486, 441.43856614297755, 422.27635139427923, 453.1681699808916, 362.6264263935831, 392.6384921377758, 377.41340829300316, 571.5963633936724, 429.35350466906954, 467.00436940996644, 471.347420627842, 467.9410925381409, 409.49671282993, 448.44402734239407, 423.77313379879433, 474.0181431281697, 347.1696403883776, 517.0483944306769, 533.3379872725411, 424.1286862763458, 577.3806474770453, 537.826284801885, 457.7179154085141, 569.821753757566, 546.284009845212, 506.96071865550795, 512.4568477044303, 574.0194662424599, 367.2855741880863, 350.46039441951393, 368.7262394628645, 482.52060694872534, 471.7490573556673, 339.0295500719291, 427.86381651737577, 452.13935270947775, 444.7958083559909, 449.83471446883607, 495.9866725784828, 452.30667624180955, 623.4880853228913, 419.3903867517042, 621.0988185114961, 420.56471823864103, 467.08695978406666, 469.56446152016224, 499.06930534826506, 402.4231445183741, 401.0529371381981, 453.75916815557173, 523.3902050969849, 384.32457257572094, 471.6027063686634, 536.378333876825, 432.7738728942758, 525.5592597513892, 590.8802650114035, 439.6936119088435, 528.5189541504259, 573.0804653088496, 487.4844588321968, 422.76889721697984, 501.9051258041972, 432.40599311717955, 448.2216559572225, 565.182514308706, 494.1129959342461, 432.27698870798685, 512.0541565729969, 432.34831939520507, 449.2749005558446, 473.444304564627, 428.88650900384386, 410.942380434228, 501.63511907526913, 616.926228013866, 460.7795305563676, 360.5235354908523, 492.1844905810791, 452.55924836316944, 439.0802762051672, 358.61101484126897, 543.2849309599718, 479.3383383279369, 520.4540176901293, 453.44113965947184, 470.8961559266514, 507.0955852877389, 401.3516558882299, 390.3170956070896, 492.48424488839356, 508.1080014315895, 486.26286712042526, 344.3943216243899, 471.44206739250774, 418.2195852625721, 494.38187332743973, 573.0732266558409, 507.05410890666514, 426.008614864174, 486.5028270545249, 449.035100292172, 455.40808854238895, 481.6663972962532, 560.7387422763358, 391.4611734629905, 514.6280849690665, 490.1223309540142, 367.926148352875, 429.4641620021494, 490.9919705903508, 402.5813650228641, 549.2091628573166, 524.7378799532742, 491.82462102790726, 522.3860166537468, 560.4859001829439, 424.220649631922, 427.9222029446298, 420.4008995048536, 519.8490236442268, 371.4242342191141, 522.0881232487662, 276.19910067790016, 478.6524849172679, 406.2275490348694, 454.3386053616969, 478.9236444023689, 547.8026868189969, 465.67232012417264, 541.9708849395196, 487.1454983155573, 407.7403685750265, 423.0483674020003, 422.6947760902201, 414.78451002403324, 403.5110804355244, 545.4597885406165, 387.5530360241993, 392.1102206849878, 407.9538095433539, 498.62288403280337, 410.7823145438386, 490.96604322464265, 501.4995713067258, 429.9431309083786, 455.5783953451071, 464.1004596540236, 456.98454010947734, 394.59355601237644, 567.3004726697353, 476.8320377827206, 494.6051107194307, 488.92016588143525, 470.795035999949, 488.6063932572909, 507.6620637028944, 500.0188363730001, 532.9809846577668, 362.8680471626216, 439.3440464671534, 548.5901497302877, 545.0849331495297, 379.8492558025218, 444.0700564538966, 484.08983003321015, 465.5505668290216, 609.5532756496946, 473.20002135744517, 496.9671790472828, 512.0670023239494, 332.37454572391357, 513.4957323437573, 457.7288761648768, 398.00627542264783, 435.86948063583753, 465.1787011661766, 567.2395812787425, 477.6196858677073, 435.7309253293226, 533.9245361901014, 424.81386990640766, 408.88093694865563, 542.9106917085271, 424.34718511981197, 508.7549939429173, 483.17307522125304, 402.6177318160884, 495.06558405613544, 491.5979216839405, 557.6147873312138, 545.9200315787613, 405.54341905470784, 416.92268128616723, 501.5120545050314, 416.6264957736863, 527.1797676250515, 381.20630011216207, 360.4183959247437, 532.6873666532098, 428.14581069388316, 435.4594693872843, 455.3401718717889, 434.62986768424776, 506.92628948345805, 460.08035613702606, 388.17499809153225, 473.5172502617405, 492.8460236379927, 412.8109055888741, 433.57459311113564, 502.72984946541817, 493.26849940007435, 406.8083175792643, 369.04324569341753, 499.44273088472715, 333.45363048587853, 567.5426628199306, 473.04347721986966, 497.47583872727415, 414.3942293206616, 411.2961307370567, 584.2092191256443, 531.0008469788255, 401.4141696416888, 394.08637747956936, 527.3492699615693, 431.01325210678283, 533.3051509481816, 341.85813963844714, 515.8842360145098, 501.32476690538414, 509.18526627953963, 370.5599274628828, 458.6313144844765, 449.4702011946045, 418.43165650401244, 447.59201323663297, 377.52810780038425, 400.7867107443574, 439.674100040676, 411.0046714600532, 439.9320479903662, 592.6117001205605, 377.68803512737736, 437.5375425217396, 409.0612837434348, 467.958765701925, 452.88139460543294, 557.57450066604, 489.6209866984019, 579.0832992450155, 487.1901989579327, 446.56911876103794, 401.66930466928756, 550.2526903012832, 413.8952445057381, 469.23510708318724, 571.2768270915188, 570.4266746052564, 480.53018382873864, 436.7601383075734, 471.18488492437075, 347.46771795426395, 443.32741130934056, 382.07618947775035, 471.0924940835263, 468.9543709153419, 421.08348954484546, 410.1479333365494, 486.0702104337849, 446.83655824898864, 631.5198298623953, 606.8522273570486, 403.94350414025234, 511.24581391587986, 467.54557013005314, 311.27390521608345, 464.0068027606782, 475.32462739749457, 494.29493596675866, 436.8867860422605, 566.2566361562283, 592.1679911585636, 438.58623463848363, 548.8331512787829, 552.9403474425585, 426.5484357604947, 552.972324823547, 481.8406577373551, 458.67114947990524, 525.4055746538987, 459.07208378016384, 532.9092858539021, 507.3266480448201, 611.628013008034, 440.6318670675989, 448.3993682326193, 404.33856338932026, 395.2543416070873, 436.2703367418525, 326.97997530900153, 429.29766363036924, 311.74473104849375, 417.7326466588504, 506.4929484828999, 447.1574369540201, 409.34324601700746, 477.26584383101533, 497.4818048281777, 532.6214862973098, 448.91143146375305, 593.7093446484807, 407.6929966573448, 437.16644541112015, 525.1194154338707, 492.7959347112074, 350.3273726643619, 534.2048912504412, 407.7957798622853, 539.5407307498023, 503.4574644761699, 452.5031159982297, 354.2816848463463, 461.19960480315626, 537.3796178055054, 431.29078935967846, 470.57147778044504, 494.9573929831888, 403.4658221733268, 394.04876724012007, 475.360755296475, 539.2536730846356, 343.8705256144013, 381.28323083938665, 353.7389267028913, 493.1065888531099, 384.018263694316, 413.41447766704965, 440.71567304133566, 393.87009365180046, 462.05142792248205, 395.0748714877602, 365.86366626410273, 429.47158019623697, 475.2214655127812, 382.07342021961836, 509.39540584550525, 452.81038932918256, 498.48166172339523, 392.18255466445356, 374.5478168123211, 526.4311249905263, 429.08126450556233, 445.6454015415252, 401.2640859733987, 500.1327149320075, 458.57939357736996, 528.030052856157, 477.99051278434933, 489.2156413260732, 687.6234940514345, 422.6657758870472, 390.15933669529875, 513.8395443089181, 517.8612343928955, 351.31273304854176, 450.5957880728865, 395.7721443940506, 463.21978058124824, 460.2017885304303, 421.3015581989556, 380.651912179455, 478.56823507017447, 332.0969833099824, 598.8728111109765, 435.9571954437586, 418.27159934736204, 483.07811049134835, 451.74086062788, 462.52372386687387, 471.9946667472943, 444.41790132893715, 398.07407066297947, 524.421590862668, 573.5394096133297, 533.2948689573795, 541.493000155, 477.14131705704676, 375.33960256067036, 382.29432821594696, 470.9288854255899, 323.84014208009745, 488.7983327760485, 414.23184268622146, 464.8179785601283, 411.3176906491026, 435.55075530678783, 503.8554209684263, 517.2446108848779, 553.6171773912448, 394.1698920099519, 457.19066859008996, 432.72301985337083, 551.1492266316604, 376.90442853251096, 521.1343526096197, 454.8125911408914, 515.6063092949959, 449.3566282350074, 448.7245528650123, 470.9427430776717, 406.838075584805, 462.60809048275485, 402.082991864468, 380.47908473413963, 542.2314652575258, 427.89211869347105, 409.536904121763, 423.93638063561394, 501.13202681076, 459.31945217548946, 466.3200646221057, 425.3165794740189, 402.6249871180054, 463.53028777435804, 396.9140235037165, 284.7062521765075, 466.3779102811649, 466.6992880522172, 538.4277797249445, 447.75160335127026, 576.3602813940729, 501.82662761592474, 557.3691451298628, 504.84352556090414, 469.8388940252921, 503.85964023604333, 416.046033787223, 375.7527491131755, 412.01873557927127, 526.3225191101417, 450.0956725936879, 458.4417972777781, 494.484473253082, 297.5782136189915, 410.6788012212695, 396.01831751907605, 357.6735574052166, 390.80200581427994, 390.9013596619273, 455.3014786090416, 400.7317060746192, 373.5090772853579, 295.1991707006002, 405.37814188521025, 377.696293637043, 523.884274602201, 477.98795317860305, 476.56483189920897, 493.10177308186974, 375.003927064541, 372.47085570385013, 389.24524504795005, 427.52267721454166, 422.3328749527266, 510.2558317717289, 427.8451157898078, 534.7062709778484, 531.2565968586564, 402.82725974791265, 414.65345354816117, 463.5368620491414, 438.0073179072657, 444.43195284086613, 467.6191887048104, 496.5431488449562, 465.8160610472313, 492.159100105791, 400.63079496874246, 491.5069930729518, 463.2537816024345, 478.63014808492306, 398.8814632105202, 403.8615431479634, 439.871016439049, 497.5546666214531, 426.8841997581142, 405.71186601468423, 376.0960606019072, 438.1820881093879, 480.54646726211934, 512.1281486678961, 401.2254608094399, 524.6126176986972, 524.825513556285, 443.92020564166944, 438.10940445885126, 512.6896129112253, 427.45170646499054, 526.9796961636746, 485.8730869801818, 505.23670739817027, 444.55373762143756, 485.17860616988526, 414.542964111433, 532.8738199134614, 328.55910495607867, 482.8500593243915, 527.1614099700394, 401.91447664391416, 571.9818226700137, 481.99050254717116, 436.2264627027952, 580.1698328861594, 380.6054651148156, 533.9696435284598, 434.5194715023912, 488.6774180932436, 383.0292858879819, 400.6134287129923, 499.14515130002263, 390.28198358452426, 407.5935019646319, 483.9283320608521, 511.3278809947595, 472.9843340698198, 437.5809406281322, 437.0337034282611, 359.57948850374544, 362.9573392004743, 476.6811602725295, 392.4371269839478, 450.63665984284677, 484.8515083524664, 458.9176680482773, 435.5898263956194, 390.2388318351075, 469.6415758609963, 518.7344892629889, 467.60836103798147, 444.69425130596716, 492.083171838366, 406.22028364033156, 491.6384358471286, 391.3317867476346, 445.9567062444939, 434.6877857575495, 389.7887664373893, 485.70567435089606, 562.8735161434903, 346.2553858953612, 450.34411471858806, 538.033289561571, 511.75709686553927, 453.1785062637896, 434.27962904947054, 517.7406759827524, 654.563271586059, 511.9973676376728, 459.0012724855329, 533.2794077597925, 509.01783315401343, 539.2527262103677, 451.6985041896476, 474.0206261314382, 581.554144550722, 470.8962429298183, 578.9881701915403, 564.953060021576, 321.63302912216426, 397.0578715295045, 455.20455333134333, 480.3405990600109, 418.3719592475388, 549.4567976553045, 453.24997626090044, 461.74563818606833, 420.3926840179529, 427.90981972803854, 521.1810377382862, 492.6625369314353, 425.14439650081727, 343.0546586560588, 503.7433031583657, 458.4277468710279, 480.72830440232246, 355.4204826262888, 477.5980847450679, 489.0675270865198, 410.212061372113, 599.7610376025034, 469.96471429447854, 444.07525273361955, 478.42501179929116, 327.8467190263863, 335.6829114369373, 323.7512539864348, 495.9810478563514, 537.4011930378547, 572.4667484667643, 450.6465519338285, 507.75151248513345, 502.8044654293024, 426.91433579448517, 445.8381099710493, 409.09243610629613, 358.06587943288406, 519.4408742800232, 418.9700311715487, 461.76179448570093, 637.0304215731331, 561.4385067537195, 433.90238664694715, 444.5419919359628, 490.6309312307343, 537.6788032866473, 404.5496682181698, 439.9093117804259, 428.3396819795949, 304.3524750983631, 475.9406414437651, 498.45255162614194, 436.4629830706094, 474.47680489416393, 386.347453065551, 492.26424258663013, 433.84034422595465, 457.24787875136326, 420.22039090424374, 465.6987680998966, 436.5358136503007, 441.652974481845, 457.5261054934664, 423.67019313828183, 423.20059095626254, 527.0303377423119, 408.5564299664762, 395.5350440528387, 588.0919764666769, 495.28196631302234, 477.233913850901, 477.96769950191856, 403.7052539012761, 496.14863248770604, 465.6977203321484, 441.89772951385027, 466.3307223988465, 385.69248200273574, 390.07858583219564, 367.75134098863856, 401.85469883532073, 368.7457009521731, 330.61394096494166, 520.8504447527935, 467.8288614179838, 393.1589916747126, 547.1577990406913, 415.43034405470286, 534.5245301631719, 368.0605799331031, 492.6433709053413, 392.2199273055189, 467.6290506633314, 460.57810758650805, 377.7978950028718, 454.4058438778382, 489.09138712739934, 338.17895986018647, 482.50399920569095, 541.7017171165057, 413.57533269649633, 399.7267468518365, 559.835797394707, 462.84077551977794, 418.7655349622371, 311.540250560625, 423.95953852849766, 389.26243231072766, 466.2659850332537, 616.0182441896617, 490.2035352780038, 457.977163189094, 404.32250991773054, 377.2627967245489, 404.6396570597356, 449.39035930674777, 515.5132834001001, 393.78690941710016, 507.1084499135076, 424.58211870859475, 463.1659433605247]  # Truncate for embedding
baseline = 450.8790407651613
mean = 456.1864634064626
std = 65.27659483976971
p5 = 350.90971520811416
p50 = 454.98579153489976
p95 = 566.4813930677116
display_name = "ROI from dFDA R&D Savings Only"
units = "ratio"

# Create figure with two subplots

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
# Handle edge case where all samples are identical (zero variance)

if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax1.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key statistics with formatted values in legend (use format_parameter_value for full units)

ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {format_parameter_value(p50, units)}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {format_parameter_value(p5, units)}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {format_parameter_value(p95, units)}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {format_parameter_value(baseline, units)}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---

sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)

ax2.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key percentiles

ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"

exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title

fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark

add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from

output_path = get_figure_output_path('mc-distribution-dfda_roi_rd_only.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 450.9 |
| Mean (expected value) | 456.2 |
| Median (50th percentile) | 455 |
| Standard Deviation | 65.28 |
| 90% Confidence Interval | [350.9, 566.5] |

*The histogram shows the distribution of ROI from dFDA R&D Savings Only across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
