```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: ROI from dFDA R&D Savings Only (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata
)

setup_chart_style()

# Simulation results
samples = [359.0293676166305, 358.70007095478576, 323.8769037393235, 330.6218035966426, 471.44651128628834, 406.1826525757312, 349.3453118650773, 347.12622217008516, 350.30155062997864, 465.98584546055105, 406.71420663909146, 325.1639525416509, 392.5204250794176, 389.4521642178093, 358.986714807747, 472.52357082244964, 352.4726629895102, 395.00872312960604, 333.83169782126646, 412.71151349888805, 405.2657499848113, 460.91000312945044, 301.5328410074175, 436.88795417871006, 397.4307162937057, 437.3951675004659, 382.4077834746616, 310.2718626554477, 403.1467052042524, 362.1383395885446, 358.99057725509505, 388.9532384760513, 494.8040959497242, 394.13863119806325, 298.2442377908278, 379.25864462999107, 343.3121545849106, 370.4223823594244, 498.6568341408087, 350.74309727898986, 368.0117311924327, 401.0126187188191, 467.26510741864223, 370.3305062584894, 285.98202699535915, 330.7946437601422, 319.6930882719704, 433.22938727801017, 420.55660480038347, 323.71285945959863, 362.9566990751126, 431.2630425841098, 475.1178477799179, 438.56431403017365, 445.71629069411074, 450.98066190213194, 389.345366635888, 253.53354332442441, 463.79649910332085, 374.74073663631896, 434.23945677504025, 515.7292244690909, 251.69729666610786, 239.20881833442033, 289.26589276925444, 328.2884097599109, 412.13661797353944, 405.5870188196482, 350.1013766764425, 376.24487732461466, 557.415441762941, 416.5911042300772, 423.3965403846877, 317.4187518332879, 380.6414318407682, 407.9339522069688, 492.7243260774247, 409.12373244102423, 367.0022619549723, 385.07659542242095, 394.62150709269764, 390.95726831355273, 434.9244981449261, 410.73070785931895, 476.5092027143698, 420.0918538906284, 355.5445779748097, 399.35820180165814, 450.72045069121447, 338.81172645136536, 357.04409970146133, 393.3443660513251, 392.4276573870758, 304.7070005968203, 414.08255487508745, 492.65105163690237, 639.7473399553832, 375.611730267145, 352.56059227178923, 519.2323075315925, 394.86026020515965, 324.0724959376341, 374.43583441555455, 348.3594047955451, 527.6829972224991, 284.6818761735231, 398.89514875558524, 381.961847638208, 369.86725290945225, 414.47470910140004, 354.9123253899033, 341.5788286256583, 426.7002658959573, 449.1126302535641, 337.23477757016275, 464.36044236518, 438.21057189827314, 413.6258682073788, 369.94991420713774, 370.5849999008124, 476.52664736412856, 349.1156461575607, 413.4435428015585, 327.98588935357753, 371.53600869458353, 321.3407982513731, 358.5744570928526, 524.5220704173015, 295.3314728144173, 541.6186313803001, 514.3528104651357, 394.5094296801699, 361.3207370061349, 469.4772283572163, 471.6570688783879, 492.7162447364631, 376.3950248746939, 312.9752946213095, 274.297847775276, 289.7141061776221, 351.79957083651703, 448.3766300618989, 520.9804083689902, 349.1601409886916, 429.5962737651926, 450.83239575145126, 501.5311059733111, 399.5189464299866, 384.4463091871037, 301.87358523192023, 467.10585532657785, 508.82542289616237, 582.2560036555706, 385.2373599287089, 382.7021531104573, 358.87896606956724, 469.5814622372556, 354.2053356586042, 358.74229553701423, 449.1387976424202, 435.3657421934059, 455.195994510993, 342.98368093042103, 430.0616598633576, 414.95061196630365, 529.9651122384923, 403.38715653568147, 316.4201859590702, 434.49914211052476, 318.5493752290694, 392.01183586361304, 420.68644936133285, 365.10897139276983, 394.6167672805962, 539.5213322617823, 366.27564659826055, 279.7968442484223, 354.12240921468106, 459.43935954677363, 321.5985168665406, 389.651179608203, 445.03577725897225, 403.73344789873744, 309.1516168072385, 324.44385349136024, 383.75772262698257, 337.374333148482, 391.3294026214382, 479.2340332499667, 380.69919903850985, 365.06757730922635, 340.73760081890333, 395.55317550591496, 241.0574413795743, 387.19220021633333, 458.53536720293584, 365.38597382736634, 301.51773475568626, 398.34781769780807, 354.8816147245487, 312.8060594345889, 321.0419724331573, 372.2112810141091, 434.1093423553898, 489.2832172848726, 348.8480938355968, 490.70226894357944, 453.7016892192934, 473.9298230013074, 382.14628841357586, 366.71773754195885, 380.79977276999125, 415.5202887241251, 400.56778396517285, 330.78993158547615, 344.38601740520056, 272.1254107493948, 314.4564903919822, 419.7754197654566, 519.933798968676, 366.43048690246025, 400.7811818490623, 350.0228785597188, 560.3809120285127, 387.9748218783485, 424.9419272706226, 224.4887532754429, 251.41961964908427, 432.8456461468847, 361.9319445830406, 497.02770796117215, 405.9696656392822, 401.86557709999244, 318.43428278501267, 432.2254035514322, 408.17801263223157, 491.01261113313416, 389.3610050297059, 482.8111776511538, 338.53844695358214, 427.2216095029042, 392.8061606622174, 589.07220163521, 525.9554723749372, 278.49354189628866, 570.0915273574639, 460.44745490770623, 336.8032785283252, 308.82818964831375, 560.3297714912775, 417.8451306204263, 433.9409806261527, 275.8504768226507, 517.7980370872955, 425.34253582775204, 362.2426146620567, 345.3405271413498, 484.7102892837563, 417.27557447633035, 485.16715179910796, 399.6512460754619, 406.7692526774487, 337.8451858769764, 420.7769846660496, 371.1970701811537, 288.2295720836314, 373.2362028084604, 381.85538770230045, 441.11814541331614, 390.5853345739909, 441.2673595341123, 388.60865613926495, 451.3940781540301, 311.2630241948446, 368.1111542273671, 363.46567478385714, 493.18601056260496, 503.6345431252627, 375.20966467947807, 356.85871705625146, 384.8870982670148, 483.0372846484662, 292.617647174771, 365.2553269594906, 470.4614580289487, 376.2526880964518, 377.0705045884754, 461.71485795869853, 346.49452795507597, 438.2605041697994, 493.701783957861, 338.83117778828375, 278.88454420134667, 570.4838150783596, 354.4672950285067, 341.62634800767813, 350.39911748547314, 486.3907832641578, 446.61128356506094, 310.730728868826, 296.4690516452453, 567.46342011736, 362.5452904923022, 416.1872403850691, 491.3952837589813, 424.0020945394888, 429.23163305901994, 291.0171472302755, 367.70652753157754, 335.71707136817906, 333.16724430093853, 375.4334206811739, 275.56634811762535, 325.2887833054162, 304.7380167453317, 497.06761079291255, 364.55461493967033, 416.9336737336236, 376.5362102177228, 431.0960546403051, 331.6429447214415, 387.26645968472275, 334.48467995655955, 384.6976584301681, 262.4566904127445, 420.17758735555464, 504.06841382629835, 363.2989216206665, 531.7004615710018, 474.5584101231944, 353.2333355197449, 465.9271427230291, 487.7613181194482, 462.06006064710033, 436.08492089895213, 530.1405038439297, 327.34254138798116, 292.78989661437316, 291.3433255591352, 395.2945315526402, 466.9532005976611, 283.38297136930197, 363.15839721667487, 375.2048780999804, 340.88207783357115, 438.7697023399862, 439.7352484812303, 370.9799578514603, 589.6357401430207, 324.4122015905197, 516.9666671898613, 339.1625484073753, 413.56627881085825, 379.50122234677343, 396.60550516567616, 337.9618535820072, 336.7772953300661, 380.13396158734815, 472.3732487738961, 330.95410514715894, 406.245539490355, 446.00724081896743, 345.48746974991724, 480.4136907575787, 508.0723342309481, 339.99337337672245, 473.2808395685579, 515.832401596317, 410.22421403317776, 340.9896960656353, 427.70704902160145, 337.7525927328229, 361.2222901100613, 455.93259494841357, 406.255825176557, 315.86503403821325, 442.62100206889437, 420.0980803804043, 344.58756267970284, 416.09304330664156, 363.16739133393867, 321.4002488888658, 475.0338672194194, 571.069585956386, 436.31709019054455, 323.9128562305415, 407.7422206808702, 372.8272067290823, 367.6928875953172, 335.4486653978694, 538.4137157802496, 407.32275437943997, 457.8308878029407, 375.1562666601131, 383.4021128692105, 428.53377838431095, 325.5244070791769, 327.8742820147252, 405.560698183564, 453.8456591393906, 419.62116055937065, 289.917813697111, 380.84823929595683, 366.01808962074085, 407.36279627591597, 497.34629973516616, 435.7796633887339, 343.9408123545385, 472.4022521590101, 416.87131545927326, 427.91649081262346, 478.07091121375225, 499.99050658613106, 317.72726853950496, 447.1836545930837, 412.56688422108635, 291.98603937489713, 335.4830428131572, 420.6329778005488, 313.9441052035671, 465.5359203476728, 472.78702329950346, 436.1394609048777, 490.7986879576858, 506.67314196336343, 370.40008047528687, 346.07894975969623, 319.9623329163756, 485.30791964162853, 308.65293870178914, 476.68108903343597, 228.28339655999096, 411.73716953135266, 390.44588650261363, 364.4237689374817, 424.99429865823777, 483.8566513118998, 425.98246264700265, 482.4974823489738, 403.8809293869502, 352.08309110635963, 353.0448159161981, 351.97612799265517, 324.16656685291105, 351.96561594975395, 512.3550149785725, 308.01008280323776, 341.7673672300767, 323.2085626620842, 414.61343351801753, 353.35638923243687, 409.18025733332047, 375.7990908229998, 319.2942650392157, 386.7493240679983, 391.6324977412202, 362.9744390356386, 355.7195251714852, 473.28919793324974, 407.33979617475836, 413.16290045313843, 440.3993585611654, 445.4630645972613, 476.88691646087597, 465.8373505093828, 439.4765795831233, 463.3842531600399, 272.1713700689309, 348.27624366574224, 498.3206559647782, 454.3159608963734, 332.72832474227357, 385.8593940684358, 407.8240590614938, 381.1298705530839, 531.5642907487863, 376.16246292391526, 456.75366448537414, 436.51291332154796, 238.62799496546828, 431.521340316276, 355.07197219647367, 337.3826163064332, 357.7376407660315, 398.19471176763375, 489.2038398111656, 428.70693188932324, 361.1967978176759, 481.5089980098788, 346.7147498331912, 324.5721856579225, 451.941855086872, 368.7675649269338, 421.0711107556446, 420.5078627560012, 322.78369854069456, 475.84800804070767, 428.5978588165513, 541.3753681543283, 513.3928970229143, 316.0388171644501, 335.1460563265383, 448.3885220768987, 391.99203943712337, 527.1797676250515, 336.9193005927569, 261.7687940326292, 441.4346925393295, 378.80466075430866, 360.1435803637774, 430.0423722373163, 377.97845904354335, 429.48680065115707, 394.59137347356005, 314.1991532762584, 394.74572757315724, 402.1667801324667, 368.3323009868393, 348.4711509246635, 384.9567908002827, 448.30411266565676, 367.7397542790825, 288.12966364084014, 431.3274834686986, 259.17259239987897, 498.2965349731825, 366.4216423971676, 420.5916537949824, 347.43382089405264, 316.2856803021421, 510.21679738275196, 481.683225996335, 352.57692610649264, 326.200772343144, 498.20566348487716, 352.4288197306468, 471.2019318257656, 270.2480667303297, 514.0364680602115, 450.1929351900086, 484.8278295857317, 333.6295162023951, 384.79086648646546, 387.86106515429736, 362.8419914587633, 385.73141487549367, 317.6719096374912, 365.16624060931963, 357.86534608177226, 335.5090230812496, 365.7708917456334, 487.1628751115952, 315.8618967253377, 325.78722630131864, 350.8574282388957, 407.2242303977447, 405.8123879632762, 508.80624567136493, 453.01554785970495, 523.5076806292913, 417.41838429942595, 372.5349521933524, 341.39491895378046, 493.45119068446263, 332.60238689365144, 381.10452740058497, 492.3370638647176, 507.78519037825635, 395.2366820320516, 367.88665845621887, 441.76399179950084, 297.6530178250101, 371.59844930998713, 345.6536855605447, 396.75615570974725, 439.8637511420067, 328.7512161659956, 322.09020912559873, 421.470762496352, 372.04124560024525, 629.8926589793529, 558.270763975808, 351.2100610916469, 467.744260508731, 380.3610060615663, 232.4743874743382, 427.4245411647737, 428.2676777511667, 415.0469767551803, 334.93376767721577, 523.1689838178677, 496.7829929295484, 331.5520756374007, 521.396266082964, 512.8201510523245, 374.04004107646006, 487.99660997436575, 389.4527679030852, 384.97680150943205, 503.1700174815453, 378.41199127708717, 472.0504611989164, 397.7064145879292, 543.55933322907, 391.8251946553806, 368.9868963801831, 327.8864186608063, 327.2590567812044, 415.37713005368073, 269.12620314221135, 391.8014105614583, 261.7671536732904, 391.02994712434514, 419.4106022583232, 402.076785807697, 379.68080013940784, 388.2835097143488, 417.552196760953, 472.92357235680487, 347.817925069668, 521.2061787320506, 346.9495408299942, 366.26806206240417, 466.43620442872606, 407.4002862028919, 309.42391257989203, 468.0760019238547, 317.8197471461155, 492.6171618808217, 502.2526693464318, 346.9099481013944, 255.15848787088467, 403.93904954514073, 519.9353732866444, 375.3991272358051, 408.9368564337965, 427.41394077766887, 370.1291262666965, 323.43949483140756, 391.60326901621255, 507.1021943781617, 280.02930032528946, 283.5791940111661, 298.27202282639655, 429.96170389571876, 330.5701272522711, 338.5354662516762, 420.85101942521874, 332.27636565841334, 404.2919013303255, 298.1244978796721, 315.6095823940604, 328.0130392189543, 435.68190738224, 313.4504930444881, 425.36359879530164, 408.8254501013859, 420.1681951284606, 308.7054039362201, 326.2947557197842, 501.42943133358625, 366.3477857080434, 403.2348445725788, 349.9954214503098, 428.8151705091247, 437.19244460116573, 500.4629029655895, 394.87525762645595, 431.79183016159146, 687.6234940514345, 342.25184328066115, 326.8098904243198, 459.24166372852136, 481.40412822774664, 283.51663498599885, 375.52068673933337, 288.15580837241845, 384.240055880036, 382.55635467557454, 363.2594989656736, 307.58095500804734, 391.63385202681997, 260.7314120762763, 528.5291278923917, 382.58682486723836, 368.12040765996386, 391.01636686301765, 348.91765107941046, 406.52578090600355, 413.9235227632812, 371.235430017193, 345.01616536393254, 419.97638138821713, 566.2660744833515, 480.16104394292876, 486.1323075012259, 473.1754350294625, 340.98018548338433, 346.20050785680013, 406.96360426802636, 256.59566403338084, 423.62858650558815, 377.96532958169325, 397.8904207209925, 327.2879796524643, 395.99781843647514, 456.1480502215474, 425.1499143538226, 479.0637809498713, 322.089639674371, 390.2468142941216, 352.32842541537894, 503.0353277609437, 321.68333773741836, 450.6337568120022, 420.0276988698517, 487.03971244801306, 366.2569060360321, 391.61343176432945, 429.4719867306467, 349.15928724359657, 366.183728249012, 397.7250341946655, 357.84589358587624, 491.28537604089104, 331.3125636237813, 342.80996372796903, 343.678874621871, 460.5281813455635, 421.5366356157207, 386.106685040344, 361.32384028195634, 331.15275645609694, 400.2161684117399, 332.3411884707239, 240.28300185936158, 377.82436145187006, 377.3541775359735, 510.4569590755344, 441.94510479220014, 460.05535426526654, 395.66047397165784, 508.232814962951, 486.1024716436252, 398.0765944885846, 404.07650192958636, 315.0168208186682, 309.71391453465344, 360.0700632043877, 475.94517215672005, 383.5560985148653, 398.7375130318213, 450.7285277595741, 221.37958392884698, 311.2140953044794, 313.3070788247631, 324.0247644358409, 314.984714632422, 319.5847827448967, 377.1146317911519, 314.65987786176356, 305.45147960530676, 239.74605337564725, 331.47999913348247, 314.9450850419955, 501.9940256978797, 405.3926130824429, 421.55025351543816, 457.286816323235, 286.1486795107646, 283.328890667556, 303.43096674824704, 358.5122101098865, 329.4114709944166, 434.8052835585762, 360.02530634937443, 489.88944216074225, 441.35201713781026, 342.17062861791595, 385.10705608717115, 396.6433779489157, 375.50274724981665, 336.51049406107285, 375.9229466488844, 423.13720823534845, 390.78994316931585, 418.49688049491886, 346.2551566981968, 449.9868855849264, 399.0150413628623, 428.6765643616709, 369.20028809309844, 332.9942136118811, 365.5698242492082, 476.8601251636304, 367.00308153223796, 323.97200556936076, 299.0628912366439, 349.2031481616458, 408.7650225339862, 461.65642387077435, 367.3623466096643, 437.34233661720833, 436.51942984510316, 347.70366962801984, 347.4358156165467, 441.0490718002994, 395.4873761102186, 458.94750946282994, 408.4659203345046, 436.6395684306818, 393.7943828052543, 406.9238634257069, 365.434220561509, 473.58461964230696, 274.50268848033085, 422.81050475530054, 442.3914293984673, 336.6378385416713, 525.6123650094195, 424.25885769298054, 338.2897512251783, 533.9236950549129, 372.52280733046194, 514.2113144598565, 369.8520925037461, 415.9004560362257, 329.1899718082369, 315.30685233293855, 499.14515130002263, 324.2571834133845, 313.50647683517064, 444.3598741600725, 447.0954578146893, 423.8083544632723, 395.72898163521603, 380.792373613908, 279.0408615421614, 274.0817999128415, 415.6017953867808, 294.9906803382149, 383.40726042629257, 368.20464075334627, 393.7807189051752, 368.2804280276845, 324.87400008085234, 324.68752315315857, 418.201027464983, 417.7419538180239, 355.7286335767217, 429.76063225332246, 357.7638813840402, 394.85613131100916, 333.0484647411464, 373.39460536069816, 370.3641993493166, 325.1187890760142, 402.7649843765556, 544.6061726465559, 282.58025747027807, 409.6097699972351, 504.2476727689331, 438.1129529219787, 384.3420314961622, 387.6181365450079, 417.9594560274621, 609.4853714190002, 448.4792838276608, 406.7783615210844, 456.18281596492716, 426.1868780467279, 491.3052832276162, 367.22884242662025, 402.57447683402313, 561.0814667099404, 456.24278827484426, 494.16698600354647, 488.8548207689362, 276.16563796774597, 339.23905656906294, 382.4731806637837, 384.7868059075203, 383.74653420483577, 505.98466884819453, 415.2564785900605, 386.350783407889, 330.2010879055185, 375.42435727737, 521.1810377382862, 469.634951971529, 382.94443074545137, 303.48305573309455, 441.2910738313238, 389.9588095907511, 418.4646655767245, 282.8071250299565, 425.79431944258977, 441.36650632022815, 338.95389012807027, 565.5113217573728, 390.62078537409417, 376.16079860303614, 411.98464794424444, 251.7201497440035, 298.21928980869745, 240.67308539457608, 429.29922649157857, 498.27715849198637, 485.9608672666388, 412.41189688043227, 454.92698458831035, 417.7136830166353, 350.9716229605264, 396.07967445373896, 326.8509019132411, 282.8790792153855, 402.86115250865294, 345.03660219536715, 359.8599676947931, 614.1795499880832, 488.9191931356472, 391.70185115246875, 376.14254146565895, 434.4268858123348, 463.58014593395757, 304.56631410652125, 379.37336290167246, 355.45717688105356, 263.55249396423716, 403.86666286104065, 424.9162609320931, 361.3732459366787, 374.6524640839849, 295.47745290143587, 411.32387327272806, 355.865924425704, 420.49277683200205, 360.4473138560946, 373.2394096938963, 351.59118334917343, 371.42845972975584, 367.9993746746362, 349.7993260440111, 333.3906630361147, 440.9627758939166, 356.66885140196734, 329.9278556044534, 588.0919764666769, 411.84876459608574, 477.233913850901, 456.2085990816626, 334.17517187734586, 409.9988275412322, 428.58606072436334, 394.8981767627239, 363.2494650136857, 339.55730752574976, 286.61189685321403, 313.66122165933547, 333.6054229764908, 282.5864437974656, 279.5264784037467, 474.36745150549694, 401.8614060497602, 336.0767089308829, 510.22399088519836, 360.29754388981274, 478.6150130260435, 295.2973619993609, 419.17372978244566, 340.7708860704431, 401.5960452881201, 387.05039894557603, 309.3380324924765, 413.78159676614155, 446.58454225784186, 268.1041116194052, 422.79452043387226, 506.84778480343016, 342.5252617850375, 330.62844284966127, 527.6975553847781, 388.78871156053555, 340.200170230174, 259.2048460958618, 346.78698741360876, 363.9195723306336, 389.04996335982497, 535.9104389262683, 431.53200893393296, 368.7483808843139, 312.6878179174993, 285.71362694364103, 316.36068613726536, 386.02304505030713, 429.52653511428616, 319.2475878144071, 429.026999137051, 358.98063257096436, 374.0826775629824]  # Truncate for embedding
baseline = 384.4665427184302
mean = 391.56141211413376
std = 71.10886718601213
p5 = 281.87829347477305
p50 = 387.67659683609406
p95 = 514.6797650971729
display_name = "ROI from dFDA R&D Savings Only"
units = "ratio"

# Create figure with two subplots
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
# Handle edge case where all samples are identical (zero variance)
if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Mark key statistics
ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {p50:,.2g}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {p5:,.2g}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {p95:,.2g}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {baseline:,.2g}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---
sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Mark key percentiles
ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"
exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title
fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark
add_watermark(fig)

# Save PNG (same directory as the QMD file)
output_path = Path('mc-distribution-dfda_roi_rd_only.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 384.5 |
| Mean (expected value) | 391.6 |
| Median (50th percentile) | 387.7 |
| Standard Deviation | 71.11 |
| 90% Confidence Interval | [281.9, 514.7] |

*The histogram shows the distribution of ROI from dFDA R&D Savings Only across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
