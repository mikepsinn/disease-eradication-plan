```{python}
#| echo: false
#| fig-cap: "Monte Carlo Distribution: Trial Capacity Multiplier (10,000 simulations)"
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path

from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines, get_tick_formatter,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata, get_figure_output_path
)
from dih_models.parameters import format_parameter_value

setup_chart_style()

# Simulation results
samples = [21.95481462620426, 28.237792855698455, 20.219338722021945, 19.52148148831168, 36.42367344769962, 30.425597354817118, 22.68405049718785, 24.623396361838598, 23.298338989636118, 27.190120273612088, 19.743341928149345, 20.117463855339064, 22.94454890118581, 18.63252725337935, 21.304366955428222, 27.221520573587533, 21.696628889150443, 27.72690330614043, 19.746799020315983, 23.441342113043348, 24.03299836232857, 26.339292804708627, 18.13373936229201, 23.898710670162, 25.138529619732058, 24.787189267418206, 21.050845022620916, 21.709887077640087, 21.521052685432085, 21.449256198715865, 14.819875776397515, 25.036980476557833, 25.531231953150307, 26.993600589501142, 20.727948997203754, 18.623345917685562, 23.72022059336958, 27.12547219547161, 27.047046470749, 20.59582235861183, 20.24624129741493, 21.0087103506966, 26.264377786186433, 22.25107359850277, 22.73084225379749, 22.3065234647255, 19.772432232440224, 22.28631189260102, 20.488342113794445, 22.937986890611324, 22.018168528216457, 20.669407872786326, 31.79756015765333, 24.638996479316216, 25.334529316072707, 26.13549192554564, 24.437157831004406, 16.780365004067438, 27.254417582098874, 19.42178191876036, 33.90702241579187, 24.7083380235779, 22.538218578364386, 20.842215049888825, 20.366395269624793, 20.059732027703955, 24.771587571052077, 25.29702108515243, 19.82163712988866, 24.061614711800075, 30.197052241727338, 28.997704470804955, 27.525697467492833, 21.187982834440454, 22.623012512771602, 20.444587432533922, 25.133537410996997, 22.555768222056173, 20.69117715222352, 24.592049452059218, 21.346656475374616, 26.246997100871994, 24.83724111793386, 24.923111521954734, 29.51857263931427, 21.227900761408527, 25.329988849604305, 23.17259472120791, 21.252330704166507, 21.3870935782654, 20.539613885856223, 23.652565906170423, 25.115185342183484, 23.570707713916047, 33.95011856980704, 31.706805362553368, 30.60380235410285, 27.924079744120494, 21.572634731369885, 27.454745292094824, 24.90665661971263, 17.742071025794786, 24.806108685233024, 20.267717899235187, 27.59781244109189, 24.124516426914756, 27.681561872129024, 24.727277804610182, 19.88644402681186, 34.338541149297015, 21.43498519641311, 22.228171771362852, 25.920450252039974, 31.697290535794124, 22.918712955247837, 25.612714375741305, 22.248957201133678, 23.13257030713005, 16.277532388063864, 24.276144219302434, 28.105600345524753, 22.46952995192865, 22.301133707031177, 17.441732127327448, 19.905546965555928, 21.744297986236674, 16.93222749202827, 29.45918069337573, 26.13971010931589, 27.561939900268595, 24.960301090210603, 31.07764039709319, 20.65466288209626, 24.199434280537027, 31.921326333715175, 28.042329127875576, 21.919164712516096, 19.894460894334348, 14.820084740450495, 14.819875776397515, 21.514386954163538, 27.884347961624904, 37.136954220003375, 22.105419780487573, 26.989454342696174, 25.07837135224816, 26.006521428052853, 23.83813505546321, 18.96037078451677, 22.56198235586692, 23.916841653995935, 28.20301130171193, 33.82813922681136, 25.409212865811707, 23.458048544324438, 15.525286605426015, 22.673852556537984, 19.36996020698388, 25.470244801215088, 29.427176049434504, 27.758849405524295, 26.555690908352734, 14.819875776397515, 27.031590835962827, 19.893128050460636, 27.441807321231114, 19.55393881182964, 21.63179159221579, 23.90802060883241, 23.401695265029204, 26.212412007316278, 21.388907111153046, 25.26261330054831, 29.769704488695087, 30.216405933815977, 22.497307298744516, 16.383038103127724, 22.549719099149456, 23.740783946029065, 22.031568267438196, 17.707885365965293, 22.30366418306662, 25.0578575792901, 18.744014318569683, 21.457438758372746, 16.586464571555158, 22.45310326880868, 29.760074978875696, 31.00231508993639, 16.051292961593877, 15.722221402064614, 24.009288933502276, 24.929785361502528, 16.94119121761654, 28.78193732957803, 27.400273898607367, 20.62348824436556, 24.982420737052156, 23.248126382855723, 23.93809356393727, 21.82195115593328, 17.203519924711983, 22.84070864191089, 20.621156576331828, 36.81267912701297, 23.436113795010254, 27.140877482829147, 29.712208234566397, 27.31651577829482, 24.704862218504935, 19.61063338596547, 30.635985350924877, 23.095083722974493, 25.399177732418504, 24.675443174300884, 19.298452283216626, 21.028276427651978, 17.55028469869027, 23.898605586905912, 26.412436753357337, 24.206749270175592, 22.208629163563085, 22.480749693717176, 28.596929304928803, 22.841110021150673, 22.267246415448703, 14.819875776397515, 15.114899348925855, 27.19112185970717, 24.492478466366656, 31.854496064025277, 25.903970838428464, 21.910698574882478, 18.22010717086763, 26.574620861926146, 26.209307328987617, 37.19763998647807, 23.934657998408674, 28.41864095380381, 25.61246229334081, 27.309999637692812, 23.634121797265717, 34.636893327559115, 31.887177678467488, 14.819875776397515, 30.298083420505797, 28.698011984616482, 15.223285829604613, 14.819875776397515, 29.31535277439259, 24.861087715048125, 21.805908120673106, 15.699707340136788, 27.87054273496055, 24.30271647436308, 20.119152654611693, 21.43362923176175, 24.897426875685532, 23.80747106610394, 31.06180975763089, 24.270844731830667, 24.397669480447536, 22.25103838486168, 25.73523319458109, 21.28851467429372, 19.25009897076147, 22.568732340629357, 21.764853469362013, 22.999187425437018, 23.225778046167637, 26.53770451082353, 21.907099364691096, 23.647328178653467, 14.819904064379033, 16.40982221955259, 21.628212877660786, 26.741910343121653, 28.825925895365902, 18.29658335379476, 22.125693395008184, 21.25469935358586, 34.50762815664373, 19.568881308376604, 21.355945367010484, 28.80967964970891, 25.33992173255113, 22.121737180854193, 23.002113049511756, 24.514149871436445, 23.67443472367316, 24.332811479203908, 22.580687936101352, 16.89278923894358, 37.22282418196974, 24.26491170952351, 22.481002766526725, 21.990223165635364, 24.87792743237563, 34.62697550175708, 21.860602167503263, 15.70573291563354, 32.49931100286779, 19.80021753411632, 24.679327595547893, 23.490752950197912, 28.34177650687337, 24.706380707038914, 17.737947673982728, 20.85595471179776, 15.683557459202973, 18.3682561480578, 21.41652777947343, 15.631731716431984, 21.41689779880217, 19.93176001647173, 24.5340816888128, 22.9423656181958, 26.419664236777763, 19.34548133342331, 29.371616046736733, 20.10052864042981, 24.058711230045017, 18.400526018949087, 20.21777810382538, 15.293969219770398, 20.292974569608347, 32.85434175674675, 23.515191609496483, 29.319028801753344, 25.559719499314724, 16.702718953600836, 20.645572124720793, 26.42701765453177, 28.027473969491783, 23.085910220679914, 29.693163174455574, 26.29170837289459, 21.925257266117605, 18.484201310256868, 20.75560800601278, 37.22268546167582, 21.956235661944522, 22.919119130383056, 21.516450459596975, 16.21077733127931, 36.864239230985646, 25.9058677011553, 20.8241870561789, 32.943791728470195, 16.871362731682847, 21.698208882048682, 19.863399432098536, 25.809577200466897, 19.98420969965791, 18.94692652688472, 22.248127740970826, 22.24186953433699, 22.09467498090747, 27.24190618973299, 23.867823844945796, 23.889852131055072, 21.638015094566946, 19.30891487409275, 28.38728873174669, 23.768739720333496, 16.84492879987534, 26.645914127140376, 27.03590188230787, 22.374134795723236, 19.87147025811444, 23.177167240180996, 17.592500418439943, 19.825965848228083, 19.88088985767946, 20.96620617445074, 14.819875776397515, 24.123287066514305, 36.62914631183049, 16.266061692230398, 25.275290520847747, 22.767847475365116, 17.69000007641328, 33.138100864592154, 29.991161994068268, 33.12884523688371, 26.895869519760446, 21.41435208282156, 21.082452864680747, 22.070479762280122, 31.398390448564996, 37.222695247712025, 22.994097037067828, 25.341097697494085, 21.33636395147242, 20.401316292642356, 22.640506548853605, 20.18320402638233, 22.263202950399663, 21.05957568349264, 26.45506596106932, 24.00969786137083, 22.397004084856526, 19.959248857841345, 24.978434096101342, 21.094220927304956, 24.39519670223597, 23.735977122059715, 19.92612349046939, 36.58809855666188, 30.376218415484985, 32.024866209902946, 37.22270741298747, 26.326329538909018, 20.22313921981165, 24.481173369024248, 22.39280907751847, 18.835341686404654, 17.59888576940287, 23.524684025478155, 17.46957486395181, 22.83420423412097, 27.11165577668179, 25.921649166990232, 32.00984203720363, 27.3669253901537, 24.814141377138025, 20.021825950233843, 15.73519293744933, 31.12628221667219, 21.600337790673514, 28.242292580987183, 21.27609595310762, 23.795440051140723, 35.36554656341068, 19.565777652531203, 25.972455256730335, 25.633575537991973, 28.47805565142905, 26.209969801280035, 21.460871925612267, 24.0524601917377, 21.857910588051027, 21.7240181736847, 17.634121698464227, 24.744426668345078, 31.976348180508783, 18.953666227466517, 24.692838928638594, 18.699751128703404, 21.638082056213626, 23.795663702570813, 21.776840936065785, 14.91703416533414, 14.819934387970768, 22.93035208575579, 22.548890219145775, 18.905064933933236, 27.15306620854476, 21.840116751245088, 23.33737243550936, 21.917567862419748, 27.09148458265004, 33.01862547717141, 36.90274135068079, 28.866751404286727, 25.279847058750263, 24.51877104719598, 14.95360121864605, 18.745590559728516, 27.743340309480963, 21.781135732457535, 25.04004797104485, 24.478820868517484, 22.444430821965774, 20.7157302490693, 24.72830742228737, 18.97186569950709, 29.069189757914238, 23.198957704130564, 14.819875776397515, 22.288435619954722, 17.077923068827765, 22.836762658301094, 20.863192566014604, 23.471055147473184, 23.96891133404669, 26.823167183343273, 21.451315428173046, 27.18255399135106, 20.538854485576103, 18.85643185273149, 21.705526517546804, 24.487345540990884, 21.357739627052503, 24.58899017992962, 19.539586826125444, 35.37058016857743, 24.711635142505255, 36.57928296438924, 32.14242608751516, 17.418531053320592, 19.685840145114017, 26.527521301626376, 32.210577972335045, 37.222857142857144, 25.67904939677709, 14.819875776397515, 21.43316121288243, 25.755421156034664, 21.313929758151755, 32.750892202502186, 24.537491872219643, 22.803217742258074, 23.598514521260775, 20.06915177267511, 21.793465165716956, 20.52845717771814, 26.37552862843417, 19.676275492085466, 16.152129501045938, 27.78466590793033, 27.364710404102865, 17.558351102949064, 24.061791002123343, 17.22146086903959, 25.20459220413228, 16.97208746070603, 22.668779441499332, 22.144178027575222, 16.450231953648426, 24.831353718105547, 27.636093346535482, 25.23267536780555, 21.364178489332865, 32.795666895149154, 20.64581207174808, 25.656650469248238, 18.523712085539607, 37.22273846029343, 26.858285381693403, 33.94175230343921, 27.055781996722303, 22.187431655924378, 24.00799129405151, 24.33910598713734, 23.919271882232817, 22.36966279533244, 27.98617206502986, 20.38287093832544, 20.549934670102814, 21.631444032710807, 20.95684646627414, 21.98850071203117, 14.820012431170221, 23.60284600057363, 24.581769923031008, 26.694879243310563, 28.175803893541286, 29.929978122140508, 27.37027936004432, 23.53138799908841, 21.835175746794807, 23.007742873526027, 26.75415378608438, 19.667664836333387, 20.260615509816223, 23.921319682938712, 26.20335180492825, 20.98825193199919, 22.433454384746366, 31.715963525380445, 23.519653632778706, 22.128609628045545, 27.425427901889897, 22.425706754715577, 31.77645230574983, 17.556342548669935, 18.003020749903527, 24.335238640002114, 21.717868724373552, 37.222746401896266, 29.188649282836185, 24.521431348927536, 28.497357749845182, 20.35447143388129, 14.820082328675957, 29.357501227044565, 27.111982191216054, 22.237565980683218, 16.234308109888048, 29.742338297748464, 22.18181603772395, 15.291126899690031, 33.60820266103184, 30.24334875629712, 25.116615655389115, 25.570621428771528, 19.988501893991902, 22.21206373311652, 34.80713271510935, 21.116667529334087, 25.84103901249019, 17.867704136013916, 26.081043002612216, 26.12457133201297, 21.016562261688318, 20.172790524815767, 21.380898401910606, 33.9333441605229, 21.02859109269393, 28.192211301700375, 22.23827364027102, 31.49655529407044, 21.387919487439714, 26.95785520324484, 30.256825956718373, 20.356638885721292, 22.212126097194577, 26.015554232307935, 16.990785250755476, 25.195825483663146, 23.088786599192222, 22.100511767288165, 26.042907782281357, 21.290096662350145, 25.63145486093661, 25.061149241589618, 17.424581104228796, 28.242631101179228, 37.22274784792858, 16.2351363724029, 14.819875776397515, 25.031682086729468, 36.36829347587992, 24.597217070715452, 24.487228910948634, 24.055479489340456, 28.83393900472911, 20.86787984815439, 21.08120836521931, 32.136433251629555, 20.411710017376503, 14.819979713668376, 22.499915726554622, 24.71947779464473, 23.84347422104964, 20.730716535849474, 34.371295426910336, 22.531401133839637, 24.963317355281816, 15.19302912474735, 23.985588127518056, 15.973956343458127, 28.75487656222659, 20.838223079337563, 21.895341642798776, 27.270613031593296, 22.477333050974604, 18.185561967153863, 24.657757620833113, 33.99485124223244, 23.301617383864958, 27.439252348956714, 24.742391746409144, 23.57884955322228, 34.127508862790364, 33.264697924781544, 21.247148023854496, 25.580685542167217, 37.22282325044767, 20.091270194313037, 22.086404846939622, 26.500068906656832, 30.552723850745444, 19.90298512672315, 21.77452889590541, 14.819875776397515, 21.49142931707201, 21.620795934902052, 23.95350940037543, 19.973091457467568, 20.69310840954907, 17.983680038490043, 25.57409101290668, 25.171426293817866, 25.3754193034654, 20.069168088920858, 16.763968223912418, 25.280618543796034, 25.122031181297277, 21.91688353665003, 24.304887853157567, 19.480088232505956, 37.22266475834147, 27.058158829241002, 26.837707579985103, 37.2227005611452, 27.751270644206365, 27.503863224222737, 24.10521485389847, 18.70841326510393, 24.301741435384855, 28.164186640062383, 23.4717980856453, 19.051315739243517, 27.814495652873827, 27.480599292627154, 20.949044485722116, 24.19636527602519, 20.607652160571398, 23.284766797932562, 20.402409285722257, 28.198390974565044, 23.278048347635487, 24.147934998390046, 29.687508205822045, 32.7743839947969, 20.46248486739977, 24.781781570507484, 28.09586508263897, 23.64249002589503, 18.62840219074042, 37.22267995297595, 32.15686245274047, 27.54316318906275, 16.942471709122824, 22.04475582172127, 20.156433072536405, 29.05448910827251, 28.88443532968397, 21.382026726757278, 22.977448680548314, 20.987046466884646, 24.045470605801, 22.062858450547395, 22.55752089012775, 20.1175550875362, 20.009167066758923, 33.30460997233898, 37.22266238280305, 19.30206246046936, 18.314397592087523, 28.08261570308826, 35.6578159899103, 22.805082500054453, 19.5565935504331, 15.394692604031107, 21.1132068040737, 24.87701806764091, 27.39219552893641, 23.177059190673724, 24.54629290239263, 28.03824952824882, 14.819987023341293, 15.449262675827022, 18.585861110798366, 27.53280676701399, 19.83246732976989, 20.637592043345325, 21.402846701489533, 17.994230211198882, 20.65382265437904, 20.258363890039107, 20.647965788827168, 21.808986625017805, 34.89288573547753, 22.870111021460833, 25.739344293713096, 30.23277872429764, 15.910718062303062, 15.698376382162355, 17.44156811038044, 22.15651707728478, 17.48430905799855, 23.174482326084558, 22.372105079111822, 28.670954785765687, 21.583728514342038, 22.96848735960547, 30.429690005651235, 23.446847465502366, 23.57075714699425, 15.394838830047217, 19.68937440801885, 23.17708424870237, 22.18283564785608, 23.037214788222972, 24.113272911849098, 28.580973986565674, 23.88336284387209, 26.65827102402817, 29.979797547174634, 21.133014294575645, 21.606575028949884, 34.923636758700184, 23.758536064886183, 19.323628615423484, 18.99687968879789, 19.17832013354697, 23.05977760304879, 27.149978323884834, 28.59132001794933, 21.793627505504187, 21.65446606560701, 17.80227592114313, 18.777714809593782, 23.80046047952372, 29.927713152970746, 24.6364268022009, 22.312529981918804, 24.109572785343932, 25.842734641858144, 22.16605042235209, 25.492188923566815, 26.083348553744383, 21.92751201339887, 25.016535626184204, 22.202034552773593, 22.083001131877097, 29.048437349913144, 25.38544260485329, 17.05575034378487, 29.236304699751603, 37.07577534218193, 35.6782094802189, 23.101576160285664, 23.093864479834643, 23.736278301310165, 18.176911629090554, 37.222857142857144, 21.587945325884963, 16.465603405266112, 28.952294928484687, 24.914221310681285, 26.69174502945138, 27.39834581662927, 24.669012079844446, 17.10580698930769, 15.221234846695236, 24.713150053812157, 15.039318147365172, 23.07399606257252, 15.588363591068518, 23.62991385380083, 22.670571811470055, 21.709765119731358, 14.819875776397515, 19.846152921825546, 26.46773158492431, 19.419200254694093, 24.83163838190509, 25.42537459935345, 19.637104572536973, 23.09314645202185, 22.061096986425692, 23.166212620136285, 21.82594832095353, 21.47247006142318, 36.36879587733363, 20.53510800011335, 27.8456499298839, 31.663402348003203, 23.4781151135109, 22.868590431408986, 26.40055255357954, 19.920554986266236, 30.773900527246408, 25.03942591492885, 25.876076038520665, 23.426889184465555, 22.059921757594413, 27.981050025508463, 20.317328527951922, 22.957388403440515, 35.98505264992176, 36.453183063043404, 23.279057372048275, 24.193823055564504, 23.674136662190847, 23.346512126125322, 22.278226174435304, 19.49594509449511, 28.815208487014967, 29.318731743771494, 28.669751085523984, 22.018993174742892, 18.018418941772378, 25.152518297716757, 37.222792317433196, 34.11140152108533, 27.08982284941132, 25.746652694588704, 25.046109834938836, 23.061192285249877, 24.602953489870583, 19.050415401891723, 26.31540426376851, 27.23673739544439, 21.259678414751438, 32.51578411995269, 21.61285457877185, 22.790264918747944, 23.867443830699344, 16.340243194726078, 26.055136743153774, 14.819965534451496, 24.21378249412637, 30.20848561512397, 22.92807134693022, 28.530730283251756, 26.68614441784431, 21.583561061935708, 20.960530127003484, 26.054945458224907, 19.353270352655766, 18.472648995342734, 17.06291636131799, 21.06210980554566, 17.42068137526836, 35.87110817092185, 24.630966070710517, 27.26032907780185, 22.720178663983404, 25.81198755342179, 23.950102106110656, 15.100592200423677, 23.965866216953273, 21.516839885020584, 24.244387038788055, 22.90354481001987, 23.200339337539493, 21.380010856236883, 18.431670432047202, 16.067454818440538, 21.934937504566694, 20.829417722699972, 29.143134237143027, 23.606258362695375, 19.52247426361663, 19.792388336819254, 22.335713345545162, 19.717839434965754, 21.213026085015198, 18.248908613153898, 22.017193308645535, 24.803516844077173, 21.828939831507366, 37.222857142857144, 21.64004639307678, 37.222857142857144, 34.30088149295392, 21.366409969565257, 21.264966388263467, 29.239211068881655, 26.49139264741137, 17.38543675037948, 25.398524174437767, 14.819875776397515, 23.23437891024128, 21.53973302215508, 16.20770902854803, 22.670700425808377, 27.950382268949586, 23.701736568741733, 23.379434656884577, 30.97217641437503, 24.350144042312202, 26.639043416410214, 19.580022687581888, 23.078108056102884, 24.47173125294453, 23.686217978707088, 22.288261550381183, 20.72475252877075, 27.936798711086077, 28.250683307169353, 18.75260585556309, 25.06438327016117, 31.434835401396086, 21.397837217600294, 21.320665701895003, 32.47022604348543, 22.26209110864501, 20.27495527316594, 21.674051499696258, 20.666760756318094, 31.322557246181166, 21.848309672584385, 24.561510414996704, 25.392707370777174, 19.775622199544223, 16.855393909519226, 15.408834529832657, 17.66353905898193, 23.701766035034662, 21.760978711589836, 20.15827414502984, 22.71198684806159, 22.67180161192704, 19.947361421953396]  # Truncate for embedding
baseline = 22.846315789473685
mean = 23.776908061735995
std = 4.916911138847169
p5 = 16.088763913743303
p50 = 23.282705271483902
p95 = 33.82246668918449
display_name = "Trial Capacity Multiplier"
units = "ratio"

# Create figure with two subplots
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
fig.subplots_adjust(wspace=0.3)

# --- Left: Histogram ---
# Handle edge case where all samples are identical (zero variance)
if std == 0 or (max(samples) == min(samples)):
    n_bins = 1
else:
    n_bins = min(50, max(1, int(np.sqrt(len(samples)))))
n, bins, patches = ax1.hist(samples, bins=n_bins, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=1)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)
ax1.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key statistics with formatted values in legend (use format_parameter_value for full units)
ax1.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=2, label=f'Median: {format_parameter_value(p50, units)}')
ax1.axvline(p5, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'5th %-ile: {format_parameter_value(p5, units)}')
ax1.axvline(p95, color=COLOR_BLACK, linestyle=':', linewidth=1.5, alpha=0.7, label=f'95th %-ile: {format_parameter_value(p95, units)}')
ax1.axvline(baseline, color=COLOR_BLACK, linestyle='-', linewidth=1.5, alpha=0.5, label=f'Baseline: {format_parameter_value(baseline, units)}')

ax1.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax1.set_ylabel('Frequency', fontsize=11)
ax1.set_title('Distribution of Outcomes', fontsize=12, weight='bold')
ax1.legend(loc='upper right', fontsize=9)
clean_spines(ax1)

# --- Right: CDF (Cumulative Probability) ---
sorted_samples = np.sort(samples)
cumulative = np.arange(1, len(sorted_samples) + 1) / len(sorted_samples)

ax2.plot(sorted_samples, cumulative * 100, color=COLOR_BLACK, linewidth=2)
ax2.fill_between(sorted_samples, 0, cumulative * 100, alpha=0.1, color=COLOR_BLACK)

# Apply tick formatter for readable labels (K, M, B suffixes, $ for USD)
ax2.xaxis.set_major_formatter(get_tick_formatter(unit=units))

# Mark key percentiles
ax2.axhline(50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)
ax2.axhline(5, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axhline(95, color=COLOR_BLACK, linestyle=':', linewidth=1, alpha=0.5)
ax2.axvline(p50, color=COLOR_BLACK, linestyle='--', linewidth=1, alpha=0.5)

ax2.set_xlabel(f'{display_name} ({units})' if units else display_name, fontsize=11)
ax2.set_ylabel('Cumulative Probability (%)', fontsize=11)
ax2.set_title('Probability of Exceeding Value', fontsize=12, weight='bold')
ax2.set_ylim(0, 100)
clean_spines(ax2)

# Add annotation for "probability of exceeding baseline"
exceed_baseline_pct = (np.array(samples) > baseline).sum() / len(samples) * 100
ax2.annotate(f'{exceed_baseline_pct:.0f}% chance of\nexceeding baseline',
             xy=(baseline, exceed_baseline_pct), xytext=(baseline * 1.1, exceed_baseline_pct + 10),
             fontsize=9, ha='left',
             arrowprops=dict(arrowstyle='->', color=COLOR_BLACK, lw=1))

# Main title
fig.suptitle(f'Monte Carlo Analysis: {display_name}', fontsize=14, weight='bold', y=1.02)

# Add watermark
add_watermark(fig)

# Save PNG to knowledge/figures/ regardless of where Quarto renders from
output_path = get_figure_output_path('mc-distribution-trial_capacity_multiplier.png')
plt.savefig(output_path, dpi=150, bbox_inches='tight', facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title=f'Monte Carlo: {display_name}',
    description=f'Monte Carlo simulation results showing uncertainty distribution for {display_name}'
)

plt.show()
```

**Key Statistics:**

| Statistic | Value |
|:----------|------:|
| Baseline (deterministic) | 22.85 |
| Mean (expected value) | 23.78 |
| Median (50th percentile) | 23.28 |
| Standard Deviation | 4.917 |
| 90% Confidence Interval | [16.09, 33.82] |

*The histogram shows the distribution of Trial Capacity Multiplier across 10,000 Monte Carlo simulations. The CDF (right) shows the probability of the outcome exceeding any given value, which is useful for risk assessment.*
