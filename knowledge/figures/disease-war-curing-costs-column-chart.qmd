{{< include ../includes/setup-parameters.qmd >}}

```{python}
#| fig-cap: "Cost of Disease vs War Costs vs Curing Diseases"
from pathlib import Path

import matplotlib.pyplot as plt
import numpy as np
from dih_models.plotting.chart_style import (
    setup_chart_style, add_watermark, clean_spines,
    COLOR_BLACK, COLOR_WHITE, PATTERN_DIAGONAL, PATTERN_HORIZONTAL,
    add_png_metadata, get_figure_output_path)

# Setup styling

setup_chart_style(style='light', dpi=150)

# Constant for converting USD to billions

BILLION = 1_000_000_000

# Disease burden (from parameters.py)

disease_medical = float(GLOBAL_DISEASE_DIRECT_MEDICAL_COST_ANNUAL) / BILLION
disease_productivity = float(GLOBAL_DISEASE_PRODUCTIVITY_LOSS_ANNUAL) / BILLION
disease_lives = float(GLOBAL_DISEASE_HUMAN_LIFE_VALUE_LOSS_ANNUAL) / BILLION
disease_total = float(GLOBAL_DISEASE_ECONOMIC_BURDEN_ANNUAL) / BILLION

# War costs breakdown

war_direct = float(GLOBAL_MILITARY_SPENDING_ANNUAL_2024) / BILLION  # Direct military spending
war_infrastructure = float(GLOBAL_ANNUAL_INFRASTRUCTURE_DESTRUCTION_CONFLICT) / BILLION  # Infrastructure destruction
war_lives_trade = (float(GLOBAL_ANNUAL_HUMAN_LIFE_LOSSES_CONFLICT) + float(GLOBAL_ANNUAL_TRADE_DISRUPTION_CONFLICT)) / BILLION  # Human life losses + trade disruption
war_longterm = (float(GLOBAL_ANNUAL_LOST_ECONOMIC_GROWTH_MILITARY_SPENDING) + float(GLOBAL_ANNUAL_VETERAN_HEALTHCARE_COSTS) + float(GLOBAL_ANNUAL_REFUGEE_SUPPORT_COSTS) + float(GLOBAL_ANNUAL_ENVIRONMENTAL_DAMAGE_CONFLICT) + float(GLOBAL_ANNUAL_PSYCHOLOGICAL_IMPACT_COSTS_CONFLICT) + float(GLOBAL_ANNUAL_LOST_HUMAN_CAPITAL_CONFLICT)) / BILLION  # Lost growth, veterans, refugees, environment
war_indirect_total = war_infrastructure + war_lives_trade + war_longterm

# Cure research spending

cure_total = float(GLOBAL_MED_RESEARCH_SPENDING) / BILLION  # Global government clinical trials

categories = [
    'Cost of\nDisease',
    'War\'s Hidden\nCosts',
    'War Direct\nSpending',
    'Curing\nDiseases'
]

# Create figure

fig, ax = plt.subplots(figsize=(28, 12))

# Column 1: Disease Burden (SOLID BLACK for emphasis) - WITH KEY COMPONENTS

bar1 = ax.bar(0, disease_total, color=COLOR_BLACK, edgecolor=COLOR_BLACK, linewidth=3, width=0.8)
ax.text(0, disease_total * 0.75, '$109T', ha='center', va='center',
        fontsize=96, weight='bold', color=COLOR_WHITE)
ax.text(0, disease_total * 0.65, 'Disease Burden', ha='center', va='center',
        fontsize=40, weight='bold', color=COLOR_WHITE)
# Add breakdown - simple and clear

disease_breakdown = (
    'Medical: $10T\n'
    'Lost Work: $5T\n'
    'Lost Lives: $94T\n\n'
    '55M Deaths/Year'
)
ax.text(0, disease_total * 0.35, disease_breakdown, ha='center', va='center',
        fontsize=32, weight='bold', color=COLOR_WHITE, linespacing=1.4)

# Column 2: War Indirect Costs (diagonal pattern)

bar2 = ax.bar(1, war_indirect_total, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=3, width=0.8, hatch='///')
ax.text(1, war_indirect_total + (disease_total * 0.005), '$7T\nWar\'s Hidden Costs',
        ha='center', va='bottom', fontsize=48, weight='bold', color=COLOR_BLACK, linespacing=1.2)

# Column 3: War Direct Spending (horizontal pattern)

bar3 = ax.bar(2, war_direct, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=3, width=0.8, hatch='---')
ax.text(2, war_direct + (disease_total * 0.005), '$2.7T\nDirect Military',
        ha='center', va='bottom', fontsize=48, weight='bold', color=COLOR_BLACK, linespacing=1.2)

# Column 4: Cure Research Spending (solid black)

bar4 = ax.bar(3, cure_total, color=COLOR_WHITE, edgecolor=COLOR_BLACK, linewidth=3, width=0.8)
ax.text(3, cure_total + (disease_total * 0.005), f'${cure_total:.0f}B\nCuring Diseases',
        ha='center', va='bottom', fontsize=44, weight='bold', color=COLOR_BLACK, linespacing=1.2)

# Remove all axis labels and ticks (all columns are labeled with amounts)

ax.set_xticks([])
ax.set_xticklabels([])
ax.set_yticks([])
ax.set_yticklabels([])

# Remove all spines for ultra-clean look

clean_spines(ax, ['top', 'right', 'left', 'bottom'])

# Add branding

add_watermark(fig)

# Save in brain/figures directory

output_path = get_figure_output_path('disease-war-curing-costs-column-chart.png')

# Save the figure

plt.savefig(output_path, dpi=150, bbox_inches=None, facecolor=COLOR_WHITE)

# Add metadata for attribution

add_png_metadata(output_path, title="Disease War Curing Costs Column Chart")
plt.show()
```
