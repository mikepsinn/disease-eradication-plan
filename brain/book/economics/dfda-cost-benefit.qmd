---
title: "dFDA Cost-Benefit Analysis"
description: "Financial Modeling of the Decentralized FDA"
jupyter: python3
---

This analysis models the health and economic benefits generated by the Decentralized FDA (dFDA) platform, which is funded by the "Captured Dividend" from the Peace Dividend analysis.

The model is based on the data in the full [dFDA Cost Benefit Analysis document](./dfda-cost-benefit-analysis.qmd).

Key outputs of this model include:

- Projected annual R&D savings
- Return on Investment (ROI) for the dFDA Infrastructure
- Estimated health gains in Quality-Adjusted Life Years (QALYs)
- Sensitivity analysis on the key drivers of these benefits
- Rigorous Net Present Value (NPV) analysis

```{python}
import matplotlib.pyplot as plt
import seaborn as sns
import numpy as np
import pandas as pd
import os
import numpy_financial as npf

# Set plot style for consistent visualizations
sns.set_style("whitegrid")

# Create a directory to save charts if it doesn't exist
charts_dir = '../../../assets/charts'
os.makedirs(charts_dir, exist_ok=True)

print("Plotting libraries imported and charts directory configured.")
```

```{python}
# --- Modern Design System Setup ---

import matplotlib.font_manager as fm

# Modern color palette - sophisticated and professional
colors = {
    'dark': '#2C2C2C',      # Sophisticated off-black
    'primary': '#6366F1',   # Modern indigo - our main accent
    'secondary': '#8B5CF6', # Purple accent for variety
    'success': '#10B981',   # Clean emerald green
    'warning': '#F59E0B',   # Warm amber
    'danger': '#EF4444',    # Clean red
    'slate': '#64748B',     # Medium slate
    'slate_light': '#94A3B8', # Light slate for secondary data
    'grid': '#E5E7EB',      # Subtle gray for grids
    'text': '#374151',      # Readable dark gray
    'text_light': '#6B7280' # Lighter text
}

# Set modern typography globally
plt.rcParams.update({
    'font.family': 'sans-serif',
    'font.sans-serif': ['Inter', 'Helvetica Neue', 'Segoe UI', 'Arial', 'sans-serif'],
    'font.size': 12,
    'axes.titlesize': 20,
    'axes.labelsize': 14,
    'xtick.labelsize': 12,
    'ytick.labelsize': 12,
    'legend.fontsize': 12,
    'figure.titlesize': 24
})

def apply_modern_style(ax, remove_spines=['top', 'right'], grid_axis='y'):
    """Apply consistent modern styling to any axis"""
    ax.set_facecolor('white')
    
    # Remove specified spines
    for spine in remove_spines:
        ax.spines[spine].set_visible(False)
    
    # Style remaining spines
    for spine in ax.spines.values():
        if spine.get_visible():
            spine.set_color(colors['grid'])
            spine.set_linewidth(0.5)
    
    # Add subtle grid
    if grid_axis:
        ax.grid(True, axis=grid_axis, color=colors['grid'], 
                linestyle='-', linewidth=0.5, alpha=0.7)
        ax.set_axisbelow(True)
    
    # Remove tick marks
    ax.tick_params(axis='both', which='both', length=0)
    ax.tick_params(axis='x', colors=colors['text'])
    ax.tick_params(axis='y', colors=colors['text'])

def add_modern_watermark(fig):
    """Add consistent watermark styling"""
    fig.text(0.98, 0.02, 'WarOnDisease.org', ha='right', va='bottom', 
             fontsize=10, color=colors['grid'], alpha=0.8, fontweight='500')

print("âœ… Modern design system loaded")
```

## Core dFDA Model Parameters

```{python}
# Core parameters for the dFDA model (in billions of USD)
# Source: brain/book/economics/dfda-cost-benefit-analysis.md

global_clinical_trial_market = 100.0
dfda_rd_cost_reduction_pct = 0.50
dfda_annual_operational_cost = 0.040 # $40 million

# Baseline QALYs generated annually
qaly_gains_annual_baseline = 840000 # in QALYs, not dollars

# Value of a QALY (standard economic value, can be debated)
value_per_qaly = 150000 # Using a common benchmark of ~$150k per QALY

# --- Calculations for dFDA Benefits ---

# Gross R&D savings
gross_rd_savings = global_clinical_trial_market * dfda_rd_cost_reduction_pct

# Net R&D savings (after operational costs)
net_rd_savings = gross_rd_savings - dfda_annual_operational_cost

# ROI Calculation
# ROI = (Net Benefit / Cost)
# Here, the cost is the operational cost, and the benefit is the gross savings it unlocks.
dfda_roi = gross_rd_savings / dfda_annual_operational_cost

# Monetized value of QALY gains
monetized_qaly_value = (qaly_gains_annual_baseline * value_per_qaly) / 1_000_000_000 # Convert to billions

# --- Connecting to the Peace Dividend ---
# The captured dividend must cover the operational cost.
# We'll use the values from the peace dividend analysis
captured_dividend = 27.18  # From peace dividend analysis
funding_coverage_ratio = captured_dividend / dfda_annual_operational_cost

print(f"--- dFDA Cost-Benefit Analysis (Baseline) ---")
print(f"Annual Gross R&D Savings: ${gross_rd_savings:,.1f} Billion")
print(f"Annual dFDA Operational Cost: ${dfda_annual_operational_cost:,.3f} Billion")
print(f"Return on Investment (ROI): {dfda_roi:,.0f}:1")
print("-" * 45)
print(f"Annual QALYs Gained: {qaly_gains_annual_baseline:,.0f}")
print(f"Monetized Value of Annual QALYs: ${monetized_qaly_value:,.1f} Billion")
print("-" * 45)
print(f"Funding Coverage (Captured Dividend / OpEx): {funding_coverage_ratio:,.1f}x")
```

## dFDA Investment Returns Visualization

This chart shows the dramatic return on investment for the dFDA Infrastructure, comparing the small operational cost to the massive benefits it generates.

```{python}
# --- Modern Visualization: dFDA Investment Returns ---

# Data for the bar chart
investment_return_data = {
    'Label': ['Investment\n(OpEx)', 'R&D Savings\n(Financial)', 'Health Gains\n(Monetized)'],
    'Value ($B)': [dfda_annual_operational_cost, gross_rd_savings, monetized_qaly_value]
}
investment_return_df = pd.DataFrame(investment_return_data)

# Create modern figure
fig, ax = plt.subplots(figsize=(12, 8))
fig.patch.set_facecolor('white')

# Modern color scheme - progress from cost (red) to benefits (greens/blues)
bar_colors = [colors['danger'], colors['success'], colors['primary']]

# Create bars with modern styling
bars = ax.bar(investment_return_df['Label'], investment_return_df['Value ($B)'], 
              color=bar_colors, width=0.6, alpha=0.9)

# Apply modern styling
apply_modern_style(ax)

# Smart labeling for log scale
for i, bar in enumerate(bars):
    height = bar.get_height()
    # Position labels differently based on log scale
    if height < 1:  # Very small values
        y_pos = height * 3
    else:
        y_pos = height * 1.2
    
    ax.text(bar.get_x() + bar.get_width()/2, y_pos,
            f'${height:,.1f}B',
            ha='center', va='bottom', fontsize=14, fontweight='600', color=colors['text'])

# Modern title and labels
ax.set_title('dFDA Investment vs. Returns', fontsize=22, fontweight='700', 
             color=colors['dark'], pad=30)
ax.set_ylabel('Value (Billions USD)', fontsize=14, color=colors['text'], labelpad=15)
ax.set_xlabel('')

# Use log scale for dramatic difference visualization
# ax.set_yscale('log')  # Changed to linear scale for better readability
ax.set_ylim(0.01, monetized_qaly_value * 1.5)

# Clean tick formatting
from matplotlib.ticker import FuncFormatter
ax.yaxis.set_major_formatter(FuncFormatter(lambda x, p: f'${x:,.0f}B' if x >= 1 else f'${x:,.2f}B'))

# Modern layout
plt.tight_layout()
plt.subplots_adjust(left=0.12, right=0.95, top=0.9, bottom=0.15)

# Add modern watermark
add_modern_watermark(fig)

# Save with high quality
file_path = os.path.join(charts_dir, 'dfda_roi_comparison.png')
plt.savefig(file_path, dpi=300, bbox_inches='tight', facecolor='white', edgecolor='none')

plt.show()
print(f'Modern chart saved to {file_path}')
```

## Sensitivity Analysis

This sensitivity analysis explores how the dFDA's financial viability, specifically its Return on Investment (ROI), changes under different assumptions. We test the two most critical drivers of the financial model:

1. **R&D Cost Reduction %**: The actual savings achieved could be lower or higher than our 50% baseline. We model a range from 30% to 70%.
2. **Annual Operational Cost**: The platform could be cheaper or more expensive to run than the estimated $40M. We model a range from $20M to $80M.

```{python}
# Define the ranges for the dFDA sensitivity analysis
rd_reduction_scenarios = [0.3, 0.4, 0.5, 0.6, 0.7]
operational_cost_scenarios = [0.020, 0.040, 0.060, 0.080] # In billions of USD

# Create an empty list to store results
dfda_results = []

# Loop through each combination of parameters
for redux_pct in rd_reduction_scenarios:
    for op_cost in operational_cost_scenarios:
        
        # Recalculate gross savings for this scenario
        gross_savings = global_clinical_trial_market * redux_pct
        
        # Recalculate ROI for this scenario
        # Handle case where op_cost is zero to avoid division error, though not in our scenarios
        if op_cost > 0:
            roi = gross_savings / op_cost
        else:
            roi = float('inf')

        # Store the result
        dfda_results.append({
            "R&D Reduction %": f"{redux_pct:.0%}",
            "Annual OpEx ($B)": f"${op_cost:.3f}",
            "ROI (x:1)": f"{roi:,.0f}"
        })

# Create and pivot the DataFrame
dfda_df = pd.DataFrame(dfda_results)
dfda_pivot = dfda_df.pivot(index="Annual OpEx ($B)", columns="R&D Reduction %", values="ROI (x:1)")

print("--- Sensitivity Analysis: dFDA Return on Investment (ROI) ---")
print(dfda_pivot)
```

## Rigorous Financial Model: Net Present Value (NPV) Analysis

The simple ROI calculation is useful for a high-level summary, but a more rigorous financial analysis uses **Net Present Value (NPV)**. This method accounts for the "time value of money" by using a discount rate to value future savings and costs in today's dollars. It provides a much more accurate picture of the investment's long-term value.

This model calculates:

1. The NPV of all costs (upfront and operational) over a 10-year horizon
2. The NPV of all savings (ramping up as the platform is adopted)
3. A more robust ROI and Net Benefit based on these NPV figures

```{python}
# NPV Model Parameters
# Source: brain/book/economics/dfda-cost-benefit-analysis.md -> "Example Parameterization" section

# Costs (in billions USD)
# Combines core platform build + medium broader initiative setup costs
C0 = 0.26975  # Upfront Costs
# Combines core platform ops + medium broader initiative annual costs
Cop = 0.04005   # Annual Operational Costs (constant)

# Savings (in billions USD)
Rd = 100.0  # Annual Global R&D Spend on clinical trials
alpha = 0.50  # Fraction of R&D cost saved

# Financial Parameters
r = 0.08  # Annual discount rate
T = 10    # Time horizon in years

# Adoption Curve p(t)
# Linear ramp from 0% to 100% over 5 years, then constant at 100%
def adoption_rate(t):
    if t == 0:
        return 0
    elif t <= 5:
        return t / 5
    else:
        return 1.0

# Calculate the annual savings for each year, considering the adoption rate
# This is needed for the NPV visualization
annual_savings_stream = [(adoption_rate(t) * alpha * Rd) for t in range(1, T + 1)]

print("NPV Model Parameters Loaded.")
print(f"Upfront Cost (C0): ${C0:.4f}B")
print(f"Annual OpEx (Cop): ${Cop:.4f}B")
print(f"Discount Rate (r): {r:.0%}")
print(f"Time Horizon (T): {T} years")
```

```{python}
# --- NPV of Costs ---
# Create a stream of operational costs over the time horizon
operational_costs_stream = [Cop] * T
# The npv function in numpy_financial takes the rate and a stream of cash flows.
# It assumes the first cash flow is at t=1.
npv_of_ops = npf.npv(r, operational_costs_stream)
# Total NPV of costs is the upfront cost plus the discounted stream of operational costs
npv_costs = C0 + npv_of_ops

# --- NPV of Savings ---
# Calculate the NPV of this savings stream
npv_savings = npf.npv(r, annual_savings_stream)

# --- Final ROI and Net Benefit ---
robust_roi = npv_savings / npv_costs
net_benefit = npv_savings - npv_costs

# --- Display Results ---
print("--- Rigorous Financial Analysis Results ---")
print(f"NPV of Total Costs over {T} years: ${npv_costs:,.3f} Billion")
print(f"NPV of Total Savings over {T} years: ${npv_savings:,.3f} Billion")
print("-" * 40)
print(f"Net Benefit (NPV Savings - NPV Costs): ${net_benefit:,.3f} Billion")
print(f"Robust ROI (NPV Savings / NPV Costs): {robust_roi:,.0f}:1")
```

## NPV Analysis Over Time

This chart shows how the investment pays back over time, accounting for the time value of money and the gradual adoption of the platform.

```{python}
# --- Modern Visualization: NPV Analysis Over Time ---

# Calculate cumulative NPV streams for plotting
years = np.arange(1, T + 1)
cumulative_npv_costs = [C0] # Start with upfront cost at year 0
cumulative_npv_savings = [0] # No savings at year 0

# We need non-cumulative discounted streams first
discounted_ops_stream = [Cop / ((1+r)**t) for t in years]
discounted_savings_stream = [s / ((1+r)**t) for t, s in enumerate(annual_savings_stream, 1)]

# Now calculate cumulative sums
cumulative_npv_costs.extend(C0 + np.cumsum(discounted_ops_stream))
cumulative_npv_savings.extend(np.cumsum(discounted_savings_stream))

# Create a DataFrame for plotting
npv_df = pd.DataFrame({
    'Year': np.arange(0, T + 1),
    'Cumulative NPV of Costs ($B)': cumulative_npv_costs,
    'Cumulative NPV of Savings ($B)': cumulative_npv_savings
})
npv_df['Net Benefit ($B)'] = npv_df['Cumulative NPV of Savings ($B)'] - npv_df['Cumulative NPV of Costs ($B)']

# Create modern figure
fig, ax = plt.subplots(figsize=(14, 9))
fig.patch.set_facecolor('white')

# Modern line styling
line_width = 3
marker_size = 8

# Plot lines with modern styling
savings_line = ax.plot(npv_df['Year'], npv_df['Cumulative NPV of Savings ($B)'], 
                      label='Cumulative Savings', color=colors['success'], 
                      linewidth=line_width, marker='o', markersize=marker_size, alpha=0.9)

costs_line = ax.plot(npv_df['Year'], npv_df['Cumulative NPV of Costs ($B)'], 
                    label='Cumulative Costs', color=colors['danger'], 
                    linewidth=line_width, marker='o', markersize=marker_size, alpha=0.9)

# Modern area fills
ax.fill_between(npv_df['Year'], npv_df['Cumulative NPV of Costs ($B)'], npv_df['Cumulative NPV of Savings ($B)'], 
                where=(npv_df['Cumulative NPV of Savings ($B)'] > npv_df['Cumulative NPV of Costs ($B)']),
                color=colors['success'], alpha=0.15, interpolate=True, label='Net Benefit')
                
ax.fill_between(npv_df['Year'], npv_df['Cumulative NPV of Costs ($B)'], npv_df['Cumulative NPV of Savings ($B)'], 
                where=(npv_df['Cumulative NPV of Savings ($B)'] <= npv_df['Cumulative NPV of Costs ($B)']),
                color=colors['danger'], alpha=0.15, interpolate=True, label='Investment Period')

# Apply modern styling
apply_modern_style(ax, remove_spines=['top', 'right'], grid_axis='both')

# Modern title and labels
ax.set_title(f'NPV Analysis: Investment Payback Over {T} Years', fontsize=22, fontweight='700', 
             color=colors['dark'], pad=30)
ax.set_xlabel('Year', fontsize=14, color=colors['text'], labelpad=15)
ax.set_ylabel('Cumulative NPV (Billions USD)', fontsize=14, color=colors['text'], labelpad=15)

# Clean axis formatting
ax.set_xticks(np.arange(0, T + 1, 1))
ax.tick_params(axis='both', labelsize=12, colors=colors['text'])

# Modern legend
legend = ax.legend(loc='upper left', frameon=True, fancybox=True, shadow=False, 
                  fontsize=12, facecolor='white', edgecolor=colors['grid'])
legend.get_frame().set_alpha(0.9)

# Modern layout
plt.tight_layout()
plt.subplots_adjust(left=0.1, right=0.95, top=0.9, bottom=0.1)

# Add modern watermark
add_modern_watermark(fig)

# Save with high quality
file_path = os.path.join(charts_dir, 'npv_over_time.png')
plt.savefig(file_path, dpi=300, bbox_inches='tight', facecolor='white', edgecolor='none')

plt.show()
print(f'Modern chart saved to {file_path}')
```

## Key Findings

The dFDA cost-benefit analysis reveals:

1. **Exceptional ROI**: The platform generates a 1,250:1 return on investment ($50B savings from $40M cost)
2. **Massive Health Benefits**: 840,000 QALYs gained annually, worth $126 billion in monetized value
3. **Robust Financial Model**: NPV analysis confirms strong returns even with conservative assumptions
4. **Self-Funding**: The captured peace dividend ($27.2B) easily covers operational costs ($40M)
5. **Sensitivity Resilience**: ROI remains strong even under conservative scenarios (30% cost reduction, higher operational costs)

This analysis demonstrates that the dFDA represents one of the most compelling investment opportunities in human history, combining massive financial returns with unprecedented health benefits.
