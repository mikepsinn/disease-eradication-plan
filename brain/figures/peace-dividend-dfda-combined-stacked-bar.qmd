---
jupyter: python3
echo: false
---

```{python}
import matplotlib.pyplot as plt
from pathlib import Path
import sys

# Find project root dynamically
project_root = Path.cwd()
if project_root.name != 'decentralized-institutes-of-health':
    while project_root.name != 'decentralized-institutes-of-health' and project_root.parent != project_root:
        project_root = project_root.parent
sys.path.insert(0, str(project_root))

# Import centralized style
from brain.figures._chart_style import setup_chart_style, add_watermark, clean_spines
from brain.figures._chart_style import COLOR_BLACK, COLOR_WHITE

setup_chart_style()

# Data
peace_dividend = 97.1  # $97.1B
dfda_savings = 50.0    # $50B
total = peace_dividend + dfda_savings

# Create figure
fig, ax = plt.subplots(figsize=(8, 6))

# Create stacked bar - use black with different alphas
bar_width = 0.5
x_pos = 0

# Bottom segment (Peace Dividend)
ax.bar(x_pos, peace_dividend, bar_width, color=COLOR_BLACK)

# Top segment (dFDA R&D Savings) - lighter black
ax.bar(x_pos, dfda_savings, bar_width, bottom=peace_dividend, color=COLOR_BLACK, alpha=0.6)

# Add value labels on bars (white text on black bars)
ax.text(x_pos, peace_dividend/2, f'${peace_dividend:.1f}B\nPeace Dividend',
        ha='center', va='center', fontsize=14, color=COLOR_WHITE, weight='bold')

ax.text(x_pos, peace_dividend + dfda_savings/2, f'${dfda_savings:.1f}B\ndFDA R&D Savings',
        ha='center', va='center', fontsize=14, color=COLOR_WHITE, weight='bold')

# Total label above (black text)
ax.text(x_pos, total + 5, f'${total:.1f}B\nTotal Annual Benefit',
        ha='center', va='bottom', fontsize=16, color=COLOR_BLACK, weight='bold')

# Clean up axes
ax.set_ylabel('Annual Value (Billions USD)', fontsize=12, color=COLOR_BLACK)
ax.set_ylim(0, total * 1.15)
ax.set_xticks([])
ax.set_xlim(-0.5, 0.5)

# Remove spines
clean_spines(ax, ['top', 'right', 'bottom'])

# Add watermark
add_watermark(fig)

# Save figure
output_dir = project_root / 'brain' / 'figures'
output_dir.mkdir(parents=True, exist_ok=True)
plt.savefig(output_dir / 'peace-dividend-dfda-combined-stacked-bar.png', dpi=200, bbox_inches=None, facecolor=COLOR_WHITE)

plt.show()
```
