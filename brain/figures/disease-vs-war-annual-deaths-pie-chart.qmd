```{python}
#| echo: false
import sys
import os

# Quarto executes from project root (execute-dir: project in _quarto.yml)
appendix_path = os.path.join(os.getcwd(), 'brain', 'book', 'appendix')
if appendix_path not in sys.path:
    sys.path.insert(0, appendix_path)

from economic_parameters import *
```

```{python}
#| label: annual-deaths
#| fig-cap: "Annual Deaths from War and Disease"

import sys
import os
from pathlib import Path

# Add project root to path (find it relative to current working directory)
project_root = Path.cwd()
if project_root.name != 'decentralized-institutes-of-health':
    while project_root.name != 'decentralized-institutes-of-health' and project_root.parent != project_root:
        project_root = project_root.parent
sys.path.insert(0, str(project_root))

import matplotlib.pyplot as plt
from brain.figures._chart_style import (
    setup_chart_style, add_watermark,
    COLOR_BLACK, COLOR_WHITE,
    add_png_metadata)

# Setup styling
setup_chart_style(style='light', dpi=150)

# Data
sizes = [55, 14]
labels = ['Disease\n55M', 'War\n14M']
colors = [COLOR_WHITE, COLOR_WHITE]  # Use white fill with black outline per DESIGN_GUIDE
explode = (0.05, 0.05)

# Create chart
fig, ax = plt.subplots(figsize=(10, 10))
wedges, texts, autotexts = ax.pie(
    sizes,
    explode=explode,
    labels=labels,
    colors=colors,
    autopct='',
    startangle=90,
    textprops={'fontsize': 32, 'weight': 'bold', 'color': COLOR_BLACK},
    wedgeprops={'edgecolor': COLOR_BLACK, 'linewidth': 3}  # Black outline on white fill
)

# Add title - MANDATORY per DESIGN_GUIDE for standalone readability
ax.set_title('Annual Deaths: Disease vs War', fontsize=36, pad=20, weight='bold', color=COLOR_BLACK)

# Add branding
add_watermark(fig)

#plt.tight_layout()  # Disabled - using rcParams margins instead

# Save in brain/figures directory
output_dir = project_root / 'brain' / 'figures'
output_dir.mkdir(parents=True, exist_ok=True)
output_path = output_dir / 'disease-vs-war-annual-deaths-pie-chart.png'

# Save the figure
plt.savefig(output_path, dpi=200, bbox_inches=None, facecolor=COLOR_WHITE)

# Add metadata for attribution
add_png_metadata(output_path, title="Disease Vs War Annual Deaths Pie Chart")
plt.show()
```
