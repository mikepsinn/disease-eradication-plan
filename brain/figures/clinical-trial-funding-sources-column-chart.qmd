```{python}
#| label: clinical-trial-funding-sources-column-chart
#| echo: false
import matplotlib.pyplot as plt
from pathlib import Path
import sys

# --- Find project root dynamically to import shared modules ---
project_root = Path.cwd()
while project_root.name != 'decentralized-institutes-of-health' and project_root.parent != project_root:
    project_root = project_root.parent
if str(project_root) not in sys.path:
    sys.path.append(str(project_root))

# --- Import centralized style and constants ---
from brain.figures._chart_style import (
    setup_chart_style, add_watermark, clean_spines,
    COLOR_BLACK, COLOR_WHITE, add_png_metadata
)

# --- Setup Chart Style ---
setup_chart_style()
fig, ax = plt.subplots(figsize=(8, 6))

# --- Data ---
# Source: Global clinical trial funding by source 2024
categories = ['Private\nIndustry', 'Government', 'Nonprofits']
spending_mid = [82.5, 22, 3.5]  # Midpoint estimates in billions
percentages = ['~90%', '~10%', '~3%']

# --- Create Column Chart ---
# Solid black for Private Industry (dominates), white for others
colors = [COLOR_BLACK, COLOR_WHITE, COLOR_WHITE]
edgecolor = COLOR_BLACK
bars = ax.bar(categories, spending_mid, color=colors, edgecolor=edgecolor, linewidth=2, width=0.6)

# --- Add Title ---
ax.set_title(
    "Who Pays for Clinical Trials? (2024)",
    fontsize=28, weight='bold', color=COLOR_BLACK, pad=30, loc='center'
)

# --- Remove Y-Axis (Tufte principle - data labels make it redundant) ---
ax.get_yaxis().set_visible(False)
clean_spines(ax, positions=['top', 'right', 'left'])

# --- Customize X-Axis ---
ax.tick_params(axis='x', which='major', length=0)  # No ticks
ax.set_xticklabels(categories, fontsize=18, color=COLOR_BLACK, linespacing=1.5)

# --- Add Direct Data Labels ---
for i, (bar, val, pct) in enumerate(zip(bars, spending_mid, percentages)):
    # For Private Industry (solid black), use white text inside
    if i == 0:
        ax.annotate(
            f'${val}B\n{pct}',
            xy=(bar.get_x() + bar.get_width() / 2, val / 2),
            xytext=(0, 0),
            textcoords="offset points",
            ha='center', va='center',
            fontsize=36, weight='bold',
            color=COLOR_WHITE,
            fontname='Courier New',
            linespacing=1.3
        )
    # For white bars, place black text above
    else:
        ax.annotate(
            f'${val}B\n{pct}',
            xy=(bar.get_x() + bar.get_width() / 2, val),
            xytext=(0, 10),
            textcoords="offset points",
            ha='center', va='bottom',
            fontsize=30, weight='bold',
            color=COLOR_BLACK,
            fontname='Courier New',
            linespacing=1.3
        )

# --- Adjust plot limits for visual balance ---
ax.set_ylim(0, max(spending_mid) * 1.25)

# --- Add Watermark ---
add_watermark(fig)

# --- Save and Show Plot ---
output_dir = project_root / 'brain' / 'figures'
output_dir.mkdir(parents=True, exist_ok=True)
filename = Path(__file__).stem if '__file__' in locals() else 'clinical-trial-funding-sources-column-chart'
output_path = output_dir / f'{filename}.png'

plt.savefig(output_path, dpi=200, bbox_inches=None, facecolor=COLOR_WHITE)

add_png_metadata(
    output_path,
    title="Who Pays for Clinical Trials? (2024)",
    description="Private industry spends $82.5B (90%) on clinical trials, dwarfing government ($22B, 10%) and nonprofit ($3.5B, 3%) contributions."
)

plt.show()
```
